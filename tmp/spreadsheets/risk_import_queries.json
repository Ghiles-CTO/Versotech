[
  "\ninsert into public.risk_grades (code, label, points, color, sort_order)\nselect code, label, points, color, sort_order\nfrom jsonb_to_recordset($$[{\"code\": \"A1\", \"label\": \"Capital Preservation\", \"points\": 0, \"color\": \"Dark Green\", \"sort_order\": 0}, {\"code\": \"A2\", \"label\": \"Very Low Risk\", \"points\": 1, \"color\": \"Green\", \"sort_order\": 1}, {\"code\": \"A3\", \"label\": \"Low Risk\", \"points\": 2, \"color\": \"Light Green\", \"sort_order\": 2}, {\"code\": \"A4\", \"label\": \"Moderate Risk\", \"points\": 3, \"color\": \"Yellow\", \"sort_order\": 3}, {\"code\": \"B\", \"label\": \"Elevated Risk\", \"points\": 5, \"color\": \"Orange\", \"sort_order\": 5}, {\"code\": \"C\", \"label\": \"High Risk\", \"points\": 10, \"color\": \"Red\", \"sort_order\": 10}, {\"code\": \"D\", \"label\": \"Very High Risk\", \"points\": 15, \"color\": \"Dark Red\", \"sort_order\": 15}, {\"code\": \"E\", \"label\": \"Extreme / Speculative\", \"points\": 20, \"color\": \"Black\", \"sort_order\": 20}]$$::jsonb)\n  as x(code text, label text, points int, color text, sort_order int)\non conflict (code) do update set\n  label = excluded.label,\n  points = excluded.points,\n  color = coalesce(excluded.color, risk_grades.color),\n  sort_order = excluded.sort_order;\n",
  "\ninsert into public.country_risks (country_name, country_code, country_risk_grade, business_climate_grade, needs_review)\nselect country_name, country_code, country_risk_grade, business_climate_grade, false\nfrom jsonb_to_recordset($$[{\"country_name\": \"Albania\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Algeria\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Angola\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Argentina\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Armenia\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Australia\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Austria\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Azerbaijan\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Bahamas\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Bahrain\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Bangladesh\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Barbados\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Belarus\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Belgium\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Belize\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Benin\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Bolivia\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Bosnia & Herzegovina\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Botswana\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Brazil\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Bulgaria\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Burkina Faso\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Burundi\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Cambodia\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Cameroon\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Canada\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Cabo Verde\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Central African Republic\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Chad\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Chile\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"China\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Colombia\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Congo (Republic)\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Congo (DRC)\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Costa Rica\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Croatia\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A2\"}, {\"country_name\": \"Cuba\", \"country_code\": null, \"country_risk_grade\": \"E\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Cyprus\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Czechia\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A2\"}, {\"country_name\": \"C\\u00f4te d\\u2019Ivoire\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Denmark\", \"country_code\": null, \"country_risk_grade\": \"A1\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Djibouti\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Dominican Republic\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Ecuador\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Egypt\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"El Salvador\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Estonia\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Ethiopia\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Fiji\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Finland\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"France\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Gabon\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Georgia\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Germany\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Ghana\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Greece\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A2\"}, {\"country_name\": \"Guatemala\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Guinea\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Guyana\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Honduras\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Hong Kong\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Hungary\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Iceland\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"India\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Indonesia\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Iran\", \"country_code\": null, \"country_risk_grade\": \"E\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Iraq\", \"country_code\": null, \"country_risk_grade\": \"E\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Ireland\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Israel\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Italy\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A2\"}, {\"country_name\": \"Jamaica\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Japan\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Jordan\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Kazakhstan\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Kenya\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"South Korea\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Kuwait\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Kyrgyzstan\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Laos\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Latvia\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Lebanon\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Lesotho\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Liberia\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Libya\", \"country_code\": null, \"country_risk_grade\": \"E\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Lithuania\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Luxembourg\", \"country_code\": null, \"country_risk_grade\": \"A1\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Madagascar\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Malawi\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Malaysia\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Maldives\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Mali\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Malta\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Mauritania\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Mauritius\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Mexico\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Moldova\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Mongolia\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Montenegro\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Morocco\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Mozambique\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}]$$::jsonb)\n  as x(country_name text, country_code text, country_risk_grade text, business_climate_grade text)\non conflict (country_name) do update set\n  country_risk_grade = excluded.country_risk_grade,\n  business_climate_grade = excluded.business_climate_grade,\n  country_code = coalesce(excluded.country_code, country_risks.country_code);\n",
  "\ninsert into public.country_risks (country_name, country_code, country_risk_grade, business_climate_grade, needs_review)\nselect country_name, country_code, country_risk_grade, business_climate_grade, false\nfrom jsonb_to_recordset($$[{\"country_name\": \"Myanmar\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Namibia\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Nepal\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Netherlands\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"New Zealand\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Nicaragua\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Niger\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Nigeria\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"North Macedonia\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Norway\", \"country_code\": null, \"country_risk_grade\": \"A1\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Oman\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Pakistan\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Panama\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Papua New Guinea\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Paraguay\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Peru\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Philippines\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Poland\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A2\"}, {\"country_name\": \"Portugal\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A2\"}, {\"country_name\": \"Qatar\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Romania\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Russia\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Rwanda\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Saudi Arabia\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Senegal\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Serbia\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Sierra Leone\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Singapore\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Slovakia\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A2\"}, {\"country_name\": \"Slovenia\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"South Africa\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Spain\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Sri Lanka\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Sudan\", \"country_code\": null, \"country_risk_grade\": \"E\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Suriname\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Eswatini\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Sweden\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Switzerland\", \"country_code\": null, \"country_risk_grade\": \"A1\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Taiwan\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Tajikistan\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"Tanzania\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Thailand\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Timor-Leste\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Togo\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Trinidad & Tobago\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Tunisia\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"T\\u00fcrkiye\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Turkmenistan\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Uganda\", \"country_code\": null, \"country_risk_grade\": \"C\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Ukraine\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"D\"}, {\"country_name\": \"United Arab Emirates\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A2\"}, {\"country_name\": \"United Kingdom\", \"country_code\": null, \"country_risk_grade\": \"A3\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"United States\", \"country_code\": null, \"country_risk_grade\": \"A2\", \"business_climate_grade\": \"A1\"}, {\"country_name\": \"Uruguay\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A3\"}, {\"country_name\": \"Uzbekistan\", \"country_code\": null, \"country_risk_grade\": \"B\", \"business_climate_grade\": \"B\"}, {\"country_name\": \"Venezuela\", \"country_code\": null, \"country_risk_grade\": \"E\", \"business_climate_grade\": \"E\"}, {\"country_name\": \"Vietnam\", \"country_code\": null, \"country_risk_grade\": \"A4\", \"business_climate_grade\": \"A4\"}, {\"country_name\": \"Zambia\", \"country_code\": null, \"country_risk_grade\": \"D\", \"business_climate_grade\": \"C\"}, {\"country_name\": \"Zimbabwe\", \"country_code\": null, \"country_risk_grade\": \"E\", \"business_climate_grade\": \"E\"}]$$::jsonb)\n  as x(country_name text, country_code text, country_risk_grade text, business_climate_grade text)\non conflict (country_name) do update set\n  country_risk_grade = excluded.country_risk_grade,\n  business_climate_grade = excluded.business_climate_grade,\n  country_code = coalesce(excluded.country_code, country_risks.country_code);\n",
  "\ninsert into public.industry_risks (sector_code, sector_name, risk_grade)\nselect sector_code, sector_name, risk_grade\nfrom jsonb_to_recordset($$[{\"sector_code\": \"energy\", \"sector_name\": \"Energy\", \"risk_grade\": \"C\"}, {\"sector_code\": \"materials\", \"sector_name\": \"Materials\", \"risk_grade\": \"B\"}, {\"sector_code\": \"industrials\", \"sector_name\": \"Industrials\", \"risk_grade\": \"B\"}, {\"sector_code\": \"consumer_discretionary\", \"sector_name\": \"Consumer Discretionary\", \"risk_grade\": \"B\"}, {\"sector_code\": \"consumer_staples\", \"sector_name\": \"Consumer Staples\", \"risk_grade\": \"A3\"}, {\"sector_code\": \"health_care\", \"sector_name\": \"Health Care\", \"risk_grade\": \"A3\"}, {\"sector_code\": \"financials\", \"sector_name\": \"Financials\", \"risk_grade\": \"B\"}, {\"sector_code\": \"information_technology\", \"sector_name\": \"Information Technology\", \"risk_grade\": \"A4\"}, {\"sector_code\": \"communication_services\", \"sector_name\": \"Communication Services\", \"risk_grade\": \"B\"}, {\"sector_code\": \"utilities\", \"sector_name\": \"Utilities\", \"risk_grade\": \"A3\"}, {\"sector_code\": \"real_estate\", \"sector_name\": \"Real Estate\", \"risk_grade\": \"B\"}]$$::jsonb)\n  as x(sector_code text, sector_name text, risk_grade text)\non conflict (sector_code) do update set\n  sector_name = excluded.sector_name,\n  risk_grade = excluded.risk_grade;\n",
  "\ninsert into public.investment_type_risks (investment_type, category, key_risk_drivers, risk_grade, risk_grade_range)\nselect investment_type, category, key_risk_drivers, risk_grade, risk_grade_range\nfrom jsonb_to_recordset($$[{\"investment_type\": \"Central bank reserves / sovereign cash (AAA)\", \"category\": null, \"key_risk_drivers\": \"Counterparty, inflation erosion\", \"risk_grade\": \"A1\", \"risk_grade_range\": null}, {\"investment_type\": \"Money market funds (government-only)\", \"category\": null, \"key_risk_drivers\": \"Interest rate, liquidity\", \"risk_grade\": \"A1\", \"risk_grade_range\": null}, {\"investment_type\": \"Money market funds (prime / corporate)\", \"category\": null, \"key_risk_drivers\": \"Credit spread, liquidity stress\", \"risk_grade\": \"A2\", \"risk_grade_range\": null}, {\"investment_type\": \"Bank deposits (OECD banks)\", \"category\": null, \"key_risk_drivers\": \"Bank solvency, bail-in\", \"risk_grade\": \"A2\", \"risk_grade_range\": null}, {\"investment_type\": \"Short-term T-Bills (OECD)\", \"category\": null, \"key_risk_drivers\": \"Rate risk\", \"risk_grade\": \"A1\", \"risk_grade_range\": null}, {\"investment_type\": \"Sovereign bonds (AAA\\u2013AA)\", \"category\": null, \"key_risk_drivers\": \"Duration, fiscal\", \"risk_grade\": \"A2\", \"risk_grade_range\": \"A1-A2\"}, {\"investment_type\": \"Sovereign bonds (BBB)\", \"category\": null, \"key_risk_drivers\": \"Debt sustainability\", \"risk_grade\": \"A3\", \"risk_grade_range\": null}, {\"investment_type\": \"Emerging market sovereign debt\", \"category\": null, \"key_risk_drivers\": \"FX, political risk\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"High-yield bonds\", \"category\": null, \"key_risk_drivers\": \"Default risk\", \"risk_grade\": \"C\", \"risk_grade_range\": \"B-C\"}, {\"investment_type\": \"Distressed debt\", \"category\": null, \"key_risk_drivers\": \"Recovery uncertainty\", \"risk_grade\": \"D\", \"risk_grade_range\": \"C-D\"}, {\"investment_type\": \"Structured credit (ABS, CLO mezzanine)\", \"category\": null, \"key_risk_drivers\": \"Complexity, correlation\", \"risk_grade\": \"C\", \"risk_grade_range\": \"B-C\"}, {\"investment_type\": \"Developed market equities\", \"category\": null, \"key_risk_drivers\": \"Market volatility\", \"risk_grade\": \"A4\", \"risk_grade_range\": null}, {\"investment_type\": \"Emerging market equities\", \"category\": null, \"key_risk_drivers\": \"FX, governance\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Sector ETFs (cyclical sectors)\", \"category\": null, \"key_risk_drivers\": \"Sector concentration\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Volatility products / leveraged ETFs\", \"category\": null, \"key_risk_drivers\": \"Path dependency\", \"risk_grade\": \"D\", \"risk_grade_range\": \"C-D\"}, {\"investment_type\": \"Listed REITs\", \"category\": null, \"key_risk_drivers\": \"Rate sensitivity\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Residential real estate (core, OECD)\", \"category\": null, \"key_risk_drivers\": \"Rates, liquidity\", \"risk_grade\": \"A3\", \"risk_grade_range\": null}, {\"investment_type\": \"Residential real estate (leveraged)\", \"category\": null, \"key_risk_drivers\": \"Leverage, cycles\", \"risk_grade\": \"A4\", \"risk_grade_range\": null}, {\"investment_type\": \"Commercial real estate \\u2013 core (office, retail prime)\", \"category\": null, \"key_risk_drivers\": \"Demand shifts\", \"risk_grade\": \"B\", \"risk_grade_range\": \"A4-B\"}, {\"investment_type\": \"Logistics / data centers\", \"category\": null, \"key_risk_drivers\": \"Tenant concentration\", \"risk_grade\": \"A3\", \"risk_grade_range\": null}, {\"investment_type\": \"Hospitality / retail secondary\", \"category\": null, \"key_risk_drivers\": \"Cyclicality\", \"risk_grade\": \"C\", \"risk_grade_range\": \"B-C\"}, {\"investment_type\": \"Real estate development\", \"category\": null, \"key_risk_drivers\": \"Execution risk\", \"risk_grade\": \"C\", \"risk_grade_range\": null}, {\"investment_type\": \"Distressed real estate\", \"category\": null, \"key_risk_drivers\": \"Liquidity, legal\", \"risk_grade\": \"D\", \"risk_grade_range\": \"C-D\"}, {\"investment_type\": \"Private equity funds \\u2013 buyout\", \"category\": null, \"key_risk_drivers\": \"Leverage, exit risk\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Growth equity\", \"category\": null, \"key_risk_drivers\": \"Valuation risk\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Venture capital (early stage)\", \"category\": null, \"key_risk_drivers\": \"Failure probability\", \"risk_grade\": \"D\", \"risk_grade_range\": \"C-D\"}, {\"investment_type\": \"Venture capital (late stage)\", \"category\": null, \"key_risk_drivers\": \"Liquidity, repricing\", \"risk_grade\": \"C\", \"risk_grade_range\": null}, {\"investment_type\": \"Fund-of-funds (PE/VC)\", \"category\": null, \"key_risk_drivers\": \"Layered fees\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Core infrastructure (regulated utilities)\", \"category\": null, \"key_risk_drivers\": \"Regulatory risk\", \"risk_grade\": \"A3\", \"risk_grade_range\": null}, {\"investment_type\": \"Renewable energy (subsidy-backed)\", \"category\": null, \"key_risk_drivers\": \"Policy risk\", \"risk_grade\": \"A4\", \"risk_grade_range\": null}, {\"investment_type\": \"Transport infrastructure\", \"category\": null, \"key_risk_drivers\": \"Demand elasticity\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Natural resources / mining\", \"category\": null, \"key_risk_drivers\": \"Commodity volatility\", \"risk_grade\": \"C\", \"risk_grade_range\": null}, {\"investment_type\": \"Timberland / farmland\", \"category\": null, \"key_risk_drivers\": \"Climate, liquidity\", \"risk_grade\": \"A4\", \"risk_grade_range\": null}, {\"investment_type\": \"Market-neutral hedge funds\", \"category\": null, \"key_risk_drivers\": \"Model risk\", \"risk_grade\": \"A4\", \"risk_grade_range\": null}, {\"investment_type\": \"Global macro\", \"category\": null, \"key_risk_drivers\": \"Event risk\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Long/short equity\", \"category\": null, \"key_risk_drivers\": \"Beta leakage\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Event-driven\", \"category\": null, \"key_risk_drivers\": \"Deal failure\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"CTA / trend-following\", \"category\": null, \"key_risk_drivers\": \"Regime shifts\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"G10 FX (unleveraged)\", \"category\": null, \"key_risk_drivers\": \"Volatility\", \"risk_grade\": \"A4\", \"risk_grade_range\": null}, {\"investment_type\": \"EM FX\", \"category\": null, \"key_risk_drivers\": \"Political / liquidity\", \"risk_grade\": \"C\", \"risk_grade_range\": \"B-C\"}, {\"investment_type\": \"Leveraged FX trading\", \"category\": null, \"key_risk_drivers\": \"Margin risk\", \"risk_grade\": \"D\", \"risk_grade_range\": \"C-D\"}, {\"investment_type\": \"Gold\", \"category\": null, \"key_risk_drivers\": \"Price volatility\", \"risk_grade\": \"A4\", \"risk_grade_range\": null}, {\"investment_type\": \"Industrial commodities\", \"category\": null, \"key_risk_drivers\": \"Cyclicality\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Cryptoassets (BTC/ETH)\", \"category\": null, \"key_risk_drivers\": \"Volatility, regulation\", \"risk_grade\": \"D\", \"risk_grade_range\": null}, {\"investment_type\": \"Altcoins / DeFi\", \"category\": null, \"key_risk_drivers\": \"Counterparty, hacks\", \"risk_grade\": \"E\", \"risk_grade_range\": null}, {\"investment_type\": \"Structured notes (capital protected)\", \"category\": null, \"key_risk_drivers\": \"Issuer risk\", \"risk_grade\": \"A3\", \"risk_grade_range\": null}, {\"investment_type\": \"Structured notes (yield-enhanced)\", \"category\": null, \"key_risk_drivers\": \"Optionality risk\", \"risk_grade\": \"B\", \"risk_grade_range\": null}, {\"investment_type\": \"Trade finance (insured)\", \"category\": null, \"key_risk_drivers\": \"Counterparty\", \"risk_grade\": \"A3\", \"risk_grade_range\": null}, {\"investment_type\": \"Trade finance (uninsured)\", \"category\": null, \"key_risk_drivers\": \"Default risk\", \"risk_grade\": \"C\", \"risk_grade_range\": \"B-C\"}, {\"investment_type\": \"Litigation finance\", \"category\": null, \"key_risk_drivers\": \"Binary outcomes\", \"risk_grade\": \"C\", \"risk_grade_range\": null}, {\"investment_type\": \"Special situations\", \"category\": null, \"key_risk_drivers\": \"Legal, timing\", \"risk_grade\": \"D\", \"risk_grade_range\": \"C-D\"}]$$::jsonb)\n  as x(investment_type text, category text, key_risk_drivers text, risk_grade text, risk_grade_range text)\non conflict (investment_type) do update set\n  key_risk_drivers = excluded.key_risk_drivers,\n  risk_grade = excluded.risk_grade,\n  risk_grade_range = excluded.risk_grade_range,\n  category = coalesce(excluded.category, investment_type_risks.category);\n",
  "select public.recalculate_all_investor_risks();",
  "select public.calculate_deal_risk(id) from public.deals;"
]