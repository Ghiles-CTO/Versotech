with sheet(row_num, raw_name, stripped_name) as (
  values
    (2, '1982772 Ontario Ltd', '1982772 Ontario Ltd'),
    (3, '777 WALNUT LLC', '777 WALNUT LLC'),
    (4, 'Adam Smith Singapore Pte Ltd', 'Adam Smith Singapore Pte Ltd'),
    (5, 'Albert NOCCIOLINO', 'Albert NOCCIOLINO'),
    (6, 'Alberto RAVANO', 'Alberto RAVANO'),
    (7, 'Alexandre BARBARANELLI', 'Alexandre BARBARANELLI'),
    (8, 'ALPHA GAIA CAPITAL FZE', 'ALPHA GAIA CAPITAL FZE'),
    (9, 'Anatoliy KOGAN', 'Anatoliy KOGAN'),
    (10, 'Andrey GORYAINOV', 'Andrey GORYAINOV'),
    (11, 'Antonio PERONACE', 'Antonio PERONACE'),
    (12, 'Ayman JOMAA', 'Ayman JOMAA'),
    (13, 'Bahama Global Towers Limited', 'Bahama Global Towers Limited'),
    (14, 'Bernard DUFAURE', 'Bernard DUFAURE'),
    (15, 'BSV SPV III LLC', 'BSV SPV III LLC'),
    (16, 'CARTA INVESTMENTS LLC (on behalf of Kavel BATHELA)', 'CARTA INVESTMENTS LLC'),
    (17, 'Caspian Enterprises Limited', 'Caspian Enterprises Limited'),
    (18, 'CINCORIA LIMITED', 'CINCORIA LIMITED'),
    (19, 'CLOUD IN HEAVEN SAS', 'CLOUD IN HEAVEN SAS'),
    (20, 'Dario SCIMONE', 'Dario SCIMONE'),
    (21, 'Daryl YONGJIE', 'Daryl YONGJIE'),
    (22, 'Divya Bagrecha', 'Divya Bagrecha'),
    (23, 'DRussell Goman RD LLC', 'DRussell Goman RD LLC'),
    (24, 'Eddie BEARNOT', 'Eddie BEARNOT'),
    (25, 'Ellen STAUDENMAYER', 'Ellen STAUDENMAYER'),
    (26, 'Emma Graham-Taylor & Gregory SOMMERVILLE', 'Emma Graham-Taylor & Gregory SOMMERVILLE'),
    (27, 'EMPIRE GROUP Limited', 'EMPIRE GROUP Limited'),
    (28, 'FINALMA SUISSE SA', 'FINALMA SUISSE SA'),
    (29, 'Frederic SAMAMA', 'Frederic SAMAMA'),
    (30, 'Georges CYTRON', 'Georges CYTRON'),
    (31, 'Giovanni ALBERTINI', 'Giovanni ALBERTINI'),
    (32, 'Guillaume SAMAMA', 'Guillaume SAMAMA'),
    (33, 'Han CHIH-HENG', 'Han CHIH-HENG'),
    (34, 'Hayden RUSHTON', 'Hayden RUSHTON'),
    (35, 'Hossein JAVID (CORRECTED TYPO IN FN)', 'Hossein JAVID'),
    (36, 'Imran HAYAT (CORRECTED TYPO IN FN)', 'Imran HAYAT'),
    (37, 'Ivan BELGA', 'Ivan BELGA'),
    (38, 'Jean-Pierre Bettin', 'Jean-Pierre Bettin'),
    (39, 'Jeremy LOWY', 'Jeremy LOWY'),
    (40, 'John ACKERLEY', 'John ACKERLEY'),
    (41, 'Kamyar BADII', 'Kamyar BADII'),
    (42, 'Kevin FOSTER WILTSHIRE (UPDATED LN)', 'Kevin FOSTER WILTSHIRE'),
    (43, 'Kian JAVID', 'Kian JAVID'),
    (44, 'L1 SC Invest 6', 'L1 SC Invest 6'),
    (45, 'Laurent CUDRE-MAUROUX', 'Laurent CUDRE-MAUROUX'),
    (46, 'Lesli SCHUTTE', 'Lesli SCHUTTE'),
    (47, 'Liudmila and Alexey ROMANOVA & ROMANOV', 'Liudmila and Alexey ROMANOVA & ROMANOV'),
    (48, 'LPP Investment Holdings Ltd', 'LPP Investment Holdings Ltd'),
    (49, 'Lubna QUNASH', 'Lubna QUNASH'),
    (50, 'Eduardo Luiz FONTES WILLIAMS (ADDED FN)', 'Eduardo Luiz FONTES WILLIAMS'),
    (51, 'MARSAULT INTERNATIONAL LTD', 'MARSAULT INTERNATIONAL LTD'),
    (52, 'Mathieu MARIOTTI', 'Mathieu MARIOTTI'),
    (53, 'MONFIN LTD', 'MONFIN LTD'),
    (54, 'Mrs Nalini Yoga & Mr Aran James WILLETTS', 'Mrs Nalini Yoga & Mr Aran James WILLETTS'),
    (55, 'Mrs Nilakantan & Mr Subbiah MAHESWARI & SUBRAMANIAN', 'Mrs Nilakantan & Mr Subbiah MAHESWARI & SUBRAMANIAN'),
    (56, 'N SQUARE PATEL LLC', 'N SQUARE PATEL LLC'),
    (57, 'Naweed AHMED', 'Naweed AHMED'),
    (58, 'Neville TATA', 'Neville TATA'),
    (59, 'Nicki ASQUITH', 'Nicki ASQUITH'),
    (60, 'ODIN (ANIM X II LP)', 'ODIN'),
    (61, 'Peter HOGLAND', 'Peter HOGLAND'),
    (62, 'Prometheus Capital Finance Ltd', 'Prometheus Capital Finance Ltd'),
    (63, 'Raphael GHESQUIERES', 'Raphael GHESQUIERES'),
    (64, 'René ROSSDEUTSCHER', 'René ROSSDEUTSCHER'),
    (65, 'Rosario RIENZO', 'Rosario RIENZO'),
    (66, 'ROSEN INVEST HOLDINGS Inc', 'ROSEN INVEST HOLDINGS Inc'),
    (67, 'Sahejman KAHLON', 'Sahejman KAHLON'),
    (68, 'Sandra KOHLER CABIAN', 'Sandra KOHLER CABIAN'),
    (69, 'SC TBC INVEST 3', 'SC TBC INVEST 3'),
    (70, 'Scott LIVINGSTONE', 'Scott LIVINGSTONE'),
    (71, 'Shaham SOLOUKI', 'Shaham SOLOUKI'),
    (72, 'Sherri Lipton Grace 2020 Irrevocable Family Trust', 'Sherri Lipton Grace 2020 Irrevocable Family Trust'),
    (73, 'Shrai and Aparna MADHVANI', 'Shrai and Aparna MADHVANI'),
    (74, 'Signet Logistics Ltd', 'Signet Logistics Ltd'),
    (75, 'SMR3T Capital Pte Ltd', 'SMR3T Capital Pte Ltd'),
    (76, 'SOUTH SOUND LTD', 'SOUTH SOUND LTD'),
    (77, 'STRUCTURED ISSUANCE Ltd', 'STRUCTURED ISSUANCE Ltd'),
    (78, 'SWISS TRUSTEES OF GENEVA SA as Trustees of the LUTEPIN TRUST', 'SWISS TRUSTEES OF GENEVA SA as Trustees of the LUTEPIN TRUST'),
    (79, 'Tan GEOK', 'Tan GEOK'),
    (80, 'Tartrifuge SA', 'Tartrifuge SA'),
    (81, 'TEKAPO Group Limited', 'TEKAPO Group Limited'),
    (82, 'Tobias JOERN', 'Tobias JOERN'),
    (83, 'Tom ROAD', 'Tom ROAD'),
    (84, 'Xavier GODRON', 'Xavier GODRON'),
    (88, 'Valoris Gestion', 'Valoris Gestion'),
    (89, 'Stableton', 'Stableton'),
    (90, 'Barclays Bank', 'Barclays Bank'),
    (91, 'Stanhope Capital', 'Stanhope Capital'),
    (92, 'SAFE', 'SAFE'),
    (93, 'Anyma Capital', 'Anyma Capital'),
    (94, 'BTG Pactual', 'BTG Pactual'),
    (95, 'UBS', 'UBS')
)
select sheet.row_num, sheet.raw_name, sheet.stripped_name, inv.id as investor_id, inv.legal_name, inv.display_name, inv.email
from sheet
left join public.investors inv
  on lower(inv.legal_name)=lower(sheet.raw_name)
  or lower(inv.display_name)=lower(sheet.raw_name)
  or lower(inv.legal_name)=lower(sheet.stripped_name)
  or lower(inv.display_name)=lower(sheet.stripped_name)
order by sheet.row_num;
