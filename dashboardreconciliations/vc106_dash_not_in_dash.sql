with dash(commitment, num_shares, contract_date) as (values
  (150000.00,7500.00,'2020-12-06'::date),
  (50000.00,2500.00,'2021-01-28'::date),
  (100000.00,5000.00,'2020-12-22'::date),
  (50000.00,2500.00,'2021-01-26'::date),
  (100800.00,5600.00,'2021-01-08'::date),
  (220000.00,10000.00,'2020-12-15'::date),
  (100000.00,5000.00,'2020-12-16'::date),
  (50000.00,2631.00,'2020-12-31'::date),
  (100000.00,5555.00,'2020-12-29'::date),
  (50000.00,2500.00,'2020-12-22'::date),
  (30040.00,1756.00,'2021-01-09'::date),
  (165006.00,9167.00,'2020-12-24'::date),
  (25000.00,1388.00,'2020-12-24'::date),
  (80064.00,4448.00,'2020-12-24'::date),
  (50000.00,2512.00,'2021-01-14'::date),
  (100000.00,5025.00,'2021-01-20'::date),
  (250000.00,11904.00,'2021-01-20'::date),
  (250000.00,11905.00,'2022-01-01'::date),
  (30000.00,1507.00,'2021-01-22'::date),
  (300000.00,13698.00,'2021-01-26'::date),
  (225200.00,10000.00,'2021-01-27'::date),
  (50000.00,2512.00,'2021-01-27'::date),
  (50000.00,2392.00,'2021-01-27'::date),
  (200000.00,8880.00,'2021-01-27'::date),
  (200000.00,9132.00,'2021-01-27'::date),
  (25000.00,1141.00,'2021-01-27'::date),
  (50000.00,2220.00,'2021-01-29'::date),
  (250000.00,11101.00,'2021-01-30'::date),
  (149500.00,6500.00,'2021-02-04'::date),
  (100000.00,4440.00,'2021-02-05'::date),
  (100000.00,4440.00,'2021-02-05'::date),
  (50000.00,2220.00,'2021-02-05'::date),
  (50000.00,2272.00,'2021-02-07'::date),
  (50000.00,2500.00,'2021-02-10'::date),
  (619989.00,32631.00,'2021-02-13'::date),
  (100000.00,4440.00,'2021-02-10'::date),
  (155000.00,6733.00,'2021-02-12'::date),
  (49989.00,2631.00,'2021-02-16'::date),
  (24985.00,1315.00,'2021-02-15'::date),
  (199994.00,10526.00,'2021-02-15'::date),
  (34998.00,1842.00,'2021-02-16'::date),
  (99997.00,5263.00,'2021-02-15'::date),
  (49989.00,2631.00,'2021-02-16'::date),
  (49989.00,2631.00,'2021-02-15'::date),
  (24985.00,1315.00,'2021-02-16'::date),
  (100007.04,4252.00,'2021-03-06'::date),
  (24978.24,1062.00,'2021-03-09'::date),
  (24978.24,1062.00,'2021-03-05'::date),
  (24978.24,1062.00,'2021-03-05'::date),
  (4999999.20,212585.00,'2021-03-18'::date),
  (241300.00,12700.00,'2021-02-19'::date),
  (500000.00,21258.00,'2021-02-22'::date),
  (160000.00,6802.00,'2021-02-26'::date),
  (360000.00,15306.00,'2021-02-22'::date),
  (50000.00,2125.00,'2021-02-25'::date),
  (100000.00,4251.00,'2021-02-24'::date),
  (100000.00,4251.00,'2021-02-24'::date),
  (75000.00,3188.00,'2021-02-25'::date),
  (50000.00,2125.00,'2021-02-25'::date),
  (50000.00,2125.00,'2021-06-07'::date),
  (50000.00,2125.00,'2021-02-27'::date),
  (914481.12,38881.00,'2021-03-26'::date),
  (200000.00,8503.00,'2021-02-27'::date),
  (100000.00,4251.00,'2021-02-27'::date),
  (150000.00,6550.00,'2021-03-04'::date),
  (100000.00,4251.00,'2021-03-03'::date),
  (50000.00,2125.00,'2021-03-03'::date),
  (400000.00,17006.00,'2021-03-24'::date),
  (400000.00,17006.00,'2021-03-04'::date),
  (10000.00,425.00,'2021-03-05'::date),
  (100000.00,4251.00,'2021-04-04'::date),
  (30000.00,1332.00,'2021-03-22'::date),
  (170000.00,7227.00,'2021-05-13'::date),
  (200000.00,8503.00,'2021-03-24'::date),
  (588000.00,25000.00,'2021-03-23'::date),
  (164640.00,7000.00,'2021-03-23'::date),
  (500000.00,21258.00,'2021-03-25'::date),
  (150000.00,6377.00,'2021-06-07'::date),
  (1360000.00,68000.00,'2021-03-19'::date),
  (245200.00,10000.00,'2021-04-02'::date),
  (125000.00,5314.00,'2021-06-07'::date),
  (7236.00,452.00,'2021-05-21'::date),
  (100000.00,4251.00,'2021-03-31'::date),
  (100000.00,4251.00,'2021-03-31'::date),
  (200000.00,8503.00,'2021-03-31'::date),
  (100000.00,4251.00,'2021-03-31'::date),
  (200000.00,8503.00,'2021-06-07'::date),
  (100000.00,4251.00,'2021-04-05'::date),
  (100000.00,4251.00,'2021-04-08'::date),
  (100000.00,4251.00,'2021-04-10'::date),
  (100000.00,4251.00,'2021-04-11'::date),
  (125000.00,5314.00,'2021-04-17'::date),
  (100000.00,4251.00,'2021-06-07'::date),
  (100000.00,4251.00,'2021-05-25'::date),
  (100000.00,4251.00,'2021-05-17'::date),
  (100000.00,4251.00,'2021-04-19'::date),
  (300000.00,12755.00,'2021-05-05'::date),
  (400000.00,17006.00,'2021-04-20'::date),
  (100000.00,4251.00,'2021-04-20'::date),
  (100000.00,4251.00,'2021-06-07'::date),
  (250000.00,10629.00,'2021-04-25'::date),
  (100000.00,4251.00,'2021-04-20'::date),
  (100000.00,4251.00,'2021-06-02'::date),
  (4661508.64,198193.00,'2021-04-27'::date),
  (62892.48,2674.00,'2021-04-27'::date),
  (36361.92,1546.00,'2021-04-27'::date),
  (46569.60,1980.00,'2021-04-27'::date),
  (124444.32,5291.00,'2021-04-27'::date),
  (3763.20,160.00,'2021-04-27'::date),
  (129407.04,5502.00,'2021-04-27'::date),
  (15052.80,640.00,'2021-04-27'::date),
  (50000.00,2125.00,'2021-04-30'::date),
  (100000.00,4251.00,'2021-06-11'::date),
  (200000.00,8503.00,'2021-04-30'::date),
  (100000.00,4251.00,'2021-04-30'::date),
  (150000.00,6377.00,'2021-05-11'::date),
  (50000.00,2125.00,'2021-05-04'::date),
  (250000.00,10629.00,'2021-05-21'::date),
  (750000.00,31887.00,'2021-05-21'::date),
  (100000.00,4251.00,'2021-05-11'::date),
  (100000.00,4251.00,'2021-05-11'::date),
  (75000.00,3188.00,'2021-05-11'::date),
  (500000.00,20391.00,'2021-05-12'::date),
  (100000.00,4251.00,'2021-05-12'::date),
  (450000.00,19132.00,'2021-05-18'::date),
  (85000.00,3863.00,'2021-05-13'::date),
  (250000.00,10629.00,'2021-05-18'::date),
  (250000.00,10629.00,'2021-05-19'::date),
  (100000.00,4251.00,'2021-05-20'::date),
  (350000.00,14880.00,'2021-05-21'::date),
  (100000.00,4251.00,'2021-05-27'::date),
  (100000.00,4251.00,'2021-05-27'::date),
  (100000.00,4251.00,'2021-05-27'::date),
  (1000000.00,42517.00,'2021-05-27'::date),
  (100000.00,4251.00,'2021-05-27'::date),
  (400000.00,17006.00,'2021-05-29'::date),
  (500000.00,21258.00,'2021-05-31'::date),
  (500000.00,21258.00,'2021-06-04'::date),
  (100000.00,4251.00,'2021-04-30'::date),
  (100000.00,4251.00,'2021-04-30'::date),
  (500000.00,21258.00,'2021-06-28'::date),
  (500000.00,21258.00,'2021-05-31'::date),
  (50000.00,2125.00,'2021-06-04'::date),
  (250000.00,10629.00,'2021-06-10'::date),
  (100000.00,4251.00,'2021-06-10'::date),
  (100000.00,4251.00,'2021-06-10'::date),
  (100000.00,4251.00,'2021-06-10'::date),
  (500000.00,21258.00,'2021-06-16'::date),
  (100000.00,4251.00,'2021-07-12'::date),
  (100000.00,4251.00,'2021-06-22'::date),
  (100000.00,4251.00,'2021-06-22'::date),
  (561423.00,23870.00,'2021-06-22'::date),
  (500000.00,21258.00,'2021-06-22'::date),
  (100000.00,4251.00,'2021-06-22'::date),
  (100000.00,4251.00,'2021-06-22'::date),
  (200000.00,8503.00,'2021-06-22'::date),
  (100000.00,4251.00,'2021-06-22'::date),
  (100000.00,4251.00,'2021-06-22'::date),
  (200000.00,8503.00,'2021-06-22'::date),
  (200000.00,8503.00,'2021-06-22'::date),
  (100000.00,4251.00,'2021-06-22'::date),
  (650000.00,27636.00,'2021-06-27'::date),
  (500000.00,21258.00,'2021-06-28'::date),
  (600000.00,25510.00,'2021-07-12'::date),
  (200000.00,8503.00,'2021-07-12'::date),
  (250000.00,10629.00,'2021-08-31'::date),
  (49980.00,2125.00,'2021-09-07'::date),
  (19992.00,850.00,'2021-09-07'::date),
  (49980.00,2125.00,'2021-09-07'::date),
  (24978.24,1062.00,'2021-09-07'::date),
  (49980.00,2125.00,'2021-09-07'::date),
  (250000.00,10629.00,'2021-09-03'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (250000.00,10629.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (100000.00,4251.00,'2021-09-23'::date),
  (1000000.00,42517.00,'2021-09-23'::date),
  (550000.00,23384.00,'2021-10-21'::date),
  (700000.00,29761.00,'2021-10-14'::date),
  (75000.00,3188.00,'2021-11-02'::date),
  (100000.00,4078.00,'2021-12-14'::date),
  (434863.00,38827.00,'2021-02-09'::date),
  (234607.00,20947.00,'2021-02-09'::date),
  (70902.00,3636.00,'2022-03-03'::date)
)
select s.id, s.commitment::numeric(18,2) as commitment, s.num_shares::numeric(18,2) as num_shares, s.contract_date, i.display_name
from subscriptions s
join investors i on s.investor_id=i.id
where s.vehicle_id='ba584abd-ea2b-4a3f-893a-c7e0999f4039'
  and not exists (
    select 1 from dash d where d.commitment=round(s.commitment::numeric,2) and d.num_shares=round(s.num_shares::numeric,2) and coalesce(d.contract_date, date '1900-01-01') = coalesce(s.contract_date, date '1900-01-01')
  )
order by commitment;