<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VC{{ $json.body.payload.series_number }}SH{{ $json.body.payload.subscription_number }} - {{ $json.body.payload.investor_name }}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    @page {
      size: A4 landscape;
      margin: 0;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      width: 297mm;
      height: 210mm;
      font-family: 'League Spartan', Arial, sans-serif;
      font-size: 10.5pt;
      line-height: 1.35;
      color: #111;
      background: #fff;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    .page {
      width: 297mm;
      height: 210mm;
      min-height: 210mm;
      max-height: 210mm;
      padding: 8mm;
      position: relative;
      overflow: hidden;
    }

    .certificate-border {
      width: 100%;
      height: 100%;
      border: 2pt solid #2a2a2a;
      box-sizing: border-box;
      padding: 12mm;
      position: relative;
      overflow: hidden;
      z-index: 1;
      display: flex;
      flex-direction: column;
      background: transparent;
    }

    .watermark {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 95%;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      font-family: 'League Spartan', Arial, sans-serif;
      font-weight: 700;
      font-size: 94pt;
      letter-spacing: 0.12em;
      line-height: 1;
      color: rgba(194, 194, 194, 0.36);
      z-index: 0;
      pointer-events: none;
      user-select: none;
    }

    .header-section {
      flex-shrink: 0;
      border-bottom: none;
      z-index: 1;
    }

    .header-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    .header-table td {
      width: 25%;
      text-align: center;
      vertical-align: middle;
      height: 82px;
      padding: 2px 12px 14px;
      position: relative;
    }

    .header-table td + td::before {
      content: '';
      position: absolute;
      left: 0;
      top: 6px;
      bottom: 6px;
      width: 1.2px;
      background: #b8b8b8;
    }

    .logo-cell {
      text-align: center;
      padding-left: 0;
      padding-right: 0;
    }

    .logo-text {
      display: inline-block;
      font-family: 'League Spartan', Arial, sans-serif;
      font-weight: 700;
      font-size: 22pt;
      letter-spacing: 0.2em;
      line-height: 1;
    }

    .cert-number,
    .units-value,
    .date-value {
      font-family: Arial, sans-serif;
      font-size: 14pt;
      font-weight: 700;
      color: #111;
    }

    .cert-label,
    .units-label,
    .date-label {
      margin-top: 3px;
      font-family: 'League Spartan', Arial, sans-serif;
      font-weight: 600;
      font-size: 9.5pt;
      color: #444;
    }

    .content-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 16px 26px 6px;
      z-index: 1;
    }

    .title-section {
      margin-bottom: 18px;
    }

    .main-title,
    .sub-title {
      font-family: 'League Spartan', Arial, sans-serif;
      font-weight: 700;
      font-size: 26pt;
      line-height: 1.15;
      letter-spacing: 0.03em;
    }

    .issuer-section {
      margin-bottom: 14px;
      max-width: 92%;
    }

    .issuer-name,
    .company-number {
      font-family: 'League Spartan', Arial, sans-serif;
      font-weight: 500;
      font-size: 11.5pt;
      line-height: 1.3;
    }

    .company-number {
      margin-top: 2px;
    }

    .certification-section {
      max-width: 90%;
      margin-bottom: 12px;
    }

    .certification-text {
      font-family: 'League Spartan', Arial, sans-serif;
      font-size: 11pt;
      line-height: 1.45;
      color: #191919;
    }

    .highlight {
      font-weight: 700;
    }

    .auth-section {
      margin-bottom: 2px;
    }

    .auth-text {
      font-family: 'League Spartan', Arial, sans-serif;
      font-size: 11pt;
      font-weight: 500;
      color: #222;
    }

    .signature-section {
      margin-top: auto;
      flex-shrink: 0;
      padding: 4px 0 8px;
      z-index: 1;
    }

    .signature-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    .signature-table td {
      width: 33.33%;
      text-align: center;
      vertical-align: bottom;
      padding: 6px 18px;
      position: relative;
    }

    .sig-cell-center::before,
    .sig-cell-center::after {
      content: '';
      position: absolute;
      top: 8px;
      bottom: 8px;
      width: 1px;
      background: #b8b8b8;
    }

    .sig-cell-center {
      vertical-align: middle !important;
      padding-top: 0;
      padding-bottom: 0;
    }

    .sig-cell-center .center-info {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: calc(100% - 36px);
    }

    .sig-cell-center::before {
      left: 0;
    }

    .sig-cell-center::after {
      right: 0;
    }

    .signature-box {
      height: 94px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      overflow: visible;
      margin-bottom: 6px;
    }

    .signature-img {
      width: auto;
      height: 100%;
      max-width: 310px;
      object-fit: contain;
      object-position: center bottom;
      display: block;
      margin: 0 auto;
    }

    .signatory-name {
      font-family: 'League Spartan', Arial, sans-serif;
      font-size: 11pt;
      font-weight: 600;
      line-height: 1.1;
      color: #111;
      margin-top: 2px;
    }

    .signatory-title {
      font-family: 'League Spartan', Arial, sans-serif;
      font-size: 10pt;
      font-weight: 500;
      line-height: 1.1;
      color: #222;
      margin-top: 2px;
    }

    .center-info {
      font-family: 'League Spartan', Arial, sans-serif;
      font-size: 10.5pt;
      line-height: 1.35;
      color: #222;
    }

    .center-vehicle-name {
      font-weight: 700;
      margin-bottom: 3px;
    }

    .center-address,
    .center-series {
      font-size: 10pt;
      font-weight: 500;
    }

    .center-address {
      margin-bottom: 4px;
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="certificate-border">
      <div class="watermark">V E R S O</div>

      <div class="header-section">
        <table class="header-table">
          <tr>
            <td class="logo-cell">
              <div class="logo-text">{{ $json.body.payload.logo_text }}</div>
            </td>
            <td>
              <div class="cert-number">VC{{ $json.body.payload.series_number }}SH{{ $json.body.payload.subscription_number }}</div>
              <div class="cert-label">(Certificate No)</div>
            </td>
            <td>
              <div class="units-value">{{ $json.body.payload.units_display || new Intl.NumberFormat('en-US').format(Number($json.body.payload.units || 0)) }} Units</div>
              <div class="units-label">(No of Certificates)</div>
            </td>
            <td>
              <div class="date-value">{{ $json.body.payload.close_at }}</div>
              <div class="date-label">(Date)</div>
            </td>
          </tr>
        </table>
      </div>

      <div class="content-section">
        <div class="title-section">
          <div class="main-title">EQUITY CERTIFICATE</div>
          <div class="sub-title">&amp; STATEMENT OF HOLDINGS</div>
        </div>

        <div class="issuer-section">
          <div class="issuer-name">{{ $json.body.payload.vehicle_name }}, the Issuer, in the name and on behalf of Series {{ $json.body.payload.series_number }} "{{ $json.body.payload.company_name }}"</div>
          <div class="company-number">Company Number: {{ $json.body.payload.vehicle_registration_number || '-' }}</div>
        </div>

        <div class="certification-section">
          <p class="certification-text">
            This is to certify that <span class="highlight">{{ $json.body.payload.investor_name }}</span>
            the registered holder of <span class="highlight">{{ $json.body.payload.num_shares_display || new Intl.NumberFormat('en-US').format(Number($json.body.payload.num_shares || 0)) }}</span> Certificates
            only as issued by the Issuer and ultimately backed by
            <span class="highlight">{{ $json.body.payload.num_shares_display || new Intl.NumberFormat('en-US').format(Number($json.body.payload.num_shares || 0)) }} {{ $json.body.payload.structure }}</span>.
          </p>
        </div>

        <div class="auth-section">
          <p class="auth-text">This certificate was authorised by:</p>
        </div>
      </div>

      <div class="signature-section">
        <table class="signature-table">
          <tr>
            <td class="sig-cell-left">
              <div class="signature-box">
                <img src="{{ $json.body.payload.signatory_1_signature_url }}" alt="Signature 1" class="signature-img">
              </div>
              <div class="signatory-name">Mr Julien Machot</div>
              <div class="signatory-title">Managing Partner</div>
            </td>
            <td class="sig-cell-center">
              <div class="center-info">
                <div class="center-vehicle-name">{{ $json.body.payload.vehicle_name }}</div>
                <div class="center-address">{{ $json.body.payload.vehicle_address }}</div>
                <div class="center-series">acting in the name and on behalf of its<br>Series {{ $json.body.payload.series_number }}</div>
              </div>
            </td>
            <td class="sig-cell-right">
              <div class="signature-box">
                <img src="{{ $json.body.payload.signatory_2_signature_url }}" alt="Signature 2" class="signature-img">
              </div>
              <div class="signatory-name">Mr Frederic Dupont</div>
              <div class="signatory-title">General Counsel</div>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
