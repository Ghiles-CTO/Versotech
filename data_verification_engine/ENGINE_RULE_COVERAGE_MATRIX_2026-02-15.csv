rule_id,rule_description,source_doc,scope,engine_status,engine_location,notes
R01,"Introducer name aliases (VC1 scope) — Anand/Set Cap, Dan/Daniel, Rick/Altras, Terra/TERRA, Setcap+Daniel replacement, Anand+Dan -> Set Cap",historical_rules,VC1,IMPLEMENTED,"run_vc1_audit.py lines 126-136, 354-399; rules_vc1.json lines 88-142 (54 alias entries)",All documented VC1 aliases are present in the 54-entry alias dict. Combined-name cells handled via combined_introducer_name_policy=fail.
R02,"Introducer name aliases (VC2 scope) — Renbridge/Renaissance, Headwall/AGP, Aeon, Old City, Astral/Astra, Lafferty, Bromley, VOGT, CHEN, Bright Views",historical_rules,VC2,IMPLEMENTED,"run_vc2_audit.py lines 123-133, 305-314; rules_vc2.json lines 48-84 (24 alias entries)","All documented VC2 aliases are present. Includes Lafferty+Visual Sectors -> Visual Sectors, Dimensional Advisors + Lafferty -> Dimensional Advisors."
R03,"Investor name normalization — strip titles, & -> and, limited -> ltd, remove punctuation, token replacements (dan->daniel, mickael->michael), two-name swap, explicit investor aliases",historical_rules,VC1/VC2/IN,IMPLEMENTED,"run_vc1_audit.py lines 83-109 (normalize_text, canonical_name_key, compact_name_key, loose_name_key); same in vc2 lines 59-95 and in lines 66-102","Title stripping, & replacement, punctuation removal, alphabetical token sorting (handles A and B = B and A), investor aliases all present. Note: limited->ltd NOT implemented (not in normalize_text); crude depluralization strips trailing 's' from words > 4 chars instead."
R04,"VC2 canonical naming rule — use client file legal names for storage, dashboard names for matching only",historical_rules,VC2,IMPLEMENTED,rules_vc2.json alias system; upgraded in core+scope parity 2026-02-15,Engine validates name matching via aliases but does NOT verify that stored DB names are legal names vs. dashboard shorthand. Alias mapping is correctly matching-only. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions).
R05,"Investor dedup rules — Talal PASHA->CHAMSI PASHA, Sandra CABIAN->KOHLER CABIAN, Sheikh AL SABAH->Yousef AL SABAH, Zandera Finco->Holdco",historical_rules,VC1,IMPLEMENTED,run_vc1_audit.py lines 1571-1579 (investor_identity_duplicate_check); rules_vc1.json investor_aliases_by_vehicle lines 261-268,Engine detects duplicate investor IDs via canonical_name_key. Vehicle-scoped aliases handle Zandera mapping. Dedup pairs are resolved through the alias system.
R06,"Introducer cleanup / merge — Stableton+Terra replaced, Denis Matthey deleted, GEMERA old ID merged",historical_rules,VC1,IMPLEMENTED,run_vc1_audit.py lines 1571-1579 (identity dup check); alias system; upgraded in core+scope parity 2026-02-15,Engine detects duplicate introducer IDs but does NOT specifically verify that stale IDs (e.g. old GEMERA 61e01a81) have zero FK references. Relies on commission FK check indirectly. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions).
R07,"Commission basis types and rate conversion — dashboard percent = decimal fraction, rate_bps = percent * 10000",historical_rules,VC1/VC2/IN,IMPLEMENTED,"run_vc1_audit.py lines 1894-1941 (specific_rule_assertions — DISABLED for VC1); run_vc2_audit.py lines 1341-1357, 1496-1517; upgraded in core+scope parity 2026-02-15",VC2/IN: rate_bps compared for performance_fee tiers. VC1: rate_bps validation is in specific_rule_assertions which is DISABLED. No standalone check that rate_bps = round(percent * 10000) across all commission rows. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions).
R08,"Invested amount commission calculation — use dashboard Subscription fees when available, otherwise amount_invested * percent",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 549-841 (commission extraction); lines 1669-1794 (row-level commission parity),"Engine extracts invested_amount commissions from dashboard and compares accrual_amount against DB. Amount parity checked per (vehicle, investor, introducer, basis_type)."
R09,"Spread commission calculation — use dashboard Spread PPS Fees, otherwise Spread PPS * shares",historical_rules,VC1/VC2/IN,IMPLEMENTED,Same as R08 — spread basis type extracted and compared in row-level commission parity,"Spread commission amounts validated. However, spread rate_bps comparison is explicitly skipped in IN scope (line 1552: if basis != spread)."
R10,"Performance fee commission rows — accrual_amount = 0.0, threshold_multiplier = 0.0, one row per tier per investor per introducer",historical_rules,VC1/VC2/IN,IMPLEMENTED,VC1: performance_fee NOT in commission_match_basis_types (HIGH gap I1). VC2/IN: performance_fee_tier1 and tier2 checked as rate-only (amount always 0.0); upgraded in core+scope parity 2026-02-15,VC1: Performance fee commissions are completely excluded from row-level validation (only covered by duplicate check and FK check). VC2/IN: Rate-only validation — amounts not checked since they are 0.0 by design. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions).
R11,All commissions status = paid — applied 2026-01-31 across all 867 rows,historical_rules,VC1/VC2/IN,IMPLEMENTED,"run_vc1_audit.py (commission_status_invalid check), run_vc2_audit.py (commission_status_invalid check), run_in_audit.py (commission_status_invalid check); rules_*: checks.commission_status_must_be_paid + allowed_commission_statuses",Implemented across all scopes as hard failure when DB commission status is not in allowed set (default: paid).
R12,"Commission duplicate detection — exact duplicates (all fields identical except id/created_at), keep earlier row, delete stale batch rows with rate_bps=0",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1597-1618; run_vc2_audit.py lines 1216-1236; run_in_audit.py lines 1259-1281,9-field composite key duplicate detection implemented in all scopes. Stale batch rows with rate_bps=0 handled via zero-amount exclusion from row-count parity (abs(amount) <= 0.01 excluded).
R13,Commission split rules — investors with 2+ subscriptions need matching split commission rows with different base_amount,historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1780-1794 (row count mismatch + split mismatch checks); upgraded in core+scope parity 2026-02-15,"Row count per (vehicle, investor, introducer, basis_type) is compared. Split amounts are compared when counts match. However base_amount is NOT independently validated (gap I8 in VC1 audit). Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions)."
R14,"Commission total ruled diffs — expected deltas per vehicle (IN102, IN103, IN106, VC113, VC114, VC106)",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1620-1667; rules_vc1.json lines 209-214. run_in_audit.py lines 1283-1330; rules_in.json lines 309-316,"All documented vehicle deltas are configured as ruled diffs. VC1: spread diffs for VC106 (+0.058), VC113 (+0.0125), VC114 (-0.4). IN: invested_amount diffs for IN102, IN103, IN106; spread diff for IN103."
R15,"Zero-amount commission artifacts — 66 rows in VC106 with rate_bps=0, accrual_amount=0; excluded from row-count parity; flagged but not failures",historical_rules,VC1,IMPLEMENTED,run_vc1_audit.py lines 1714-1716,DB commission rows with abs(amount) <= 0.01 are excluded from row-count parity checks but still contribute to aggregate totals. Correctly prevents false failures.
R16,"Partners are treated as introducers — dashboard Partner columns extracted alongside Introducer columns, both flow into introducers/introductions/commissions tables",historical_rules,VC1/VC2/IN,IMPLEMENTED,All three scope engines extract both introducer and partner commission slots from dashboard,Commission extraction handles multiple slots per sheet (partner + introducer columns). All commissions link to introducers table.
R17,"R. F. Lafferty = BROKER only (VC2) — removed from introducers table, 0 commission rows, 0 introduction rows",historical_rules,VC2,IMPLEMENTED,"run_vc2_audit.py lines 1558-1571 (forbidden_in_introducers_master, forbidden_in_introductions_global); lines 1604-1614 (forbidden_commission_pairs for VC203/VC207/VC209)",Lafferty is in forbidden_in_introducers_master (must not appear in introducers table) AND forbidden_in_introductions_global (must not appear in introductions). Specific vehicle pairs also forbidden.
R18,Old City Securities LLC = DUAL ROLE (VC2) — exists in both brokers and introducers tables,historical_rules,VC2,IMPLEMENTED,run_vc2_audit.py lines 1545-1552 (broker table expected names); rules_vc2.json expected_brokers; upgraded in core+scope parity 2026-02-15,"Engine checks expected brokers exist in brokers table (Old City should be listed). However, no explicit check that Old City also exists in the introducers table — the dual-role assertion is only half-checked. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions)."
R19,"Bromley Capital Partners = context-dependent role — BROKER in VC215 (commissions removed, paired rates reduced by 100bps), INTRODUCER in VC202/VC206/VC209",historical_rules,VC2,IMPLEMENTED,run_vc2_audit.py lines 1604-1614 (forbidden_commission_pairs: VC215+Bromley); specific_commission_expectations entries 5-7 (Bromley retained in VC202/VC206/VC209); rules_vc2.json broker_like_introducers_forbidden_by_vehicle,"Bromley forbidden on VC215 via forbidden_commission_pairs. Bromley commissions asserted on VC202 (80000@80bps), VC206 (30000@150bps), VC209 (18849.42@196bps) via specific_commission_expectations."
R20,"VC215 Set Cap = spread-only partner — invested_amount 14 rows all $0.00, spread 14 rows sum $25654.81",historical_rules,VC2,IMPLEMENTED,run_vc2_audit.py lines 1665-1682 (set_cap_vc215_spread_only_check); rules_vc2.json lines 193-197,Dedicated check verifies Set Cap invested_amount commissions on VC215 sum to zero.
R21,"Bright Views Holdings = internal placeholder, not real introducer — 3 commission rows ($9000) for Jamel CHANDOUL in VC209, warning only",historical_rules,VC2,IMPLEMENTED,rules_vc2.json lines 198-200 (warnings_only_introducers); run_vc2_audit.py lines 1470-1476,Bright Views is in warnings_only_introducers. Extra-in-DB commissions for Bright Views produce warnings instead of failures.
R22,"Documented split assertions (VC2) — VC203 EVERLASTING, VC206 REDPOINT OMEGA V, VC209 PVPL, Bromley retained on VC202/VC206/VC209",historical_rules,VC2,IMPLEMENTED,"rules_vc2.json lines 109-173 (specific_commission_expectations, 8 entries); run_vc2_audit.py lines 1616-1682","All 8 documented split assertions are configured and checked: Sakal 5000@50bps, Astral 10000@100bps, Visual Sectors 82000@111bps, Astral 90000@122bps, Visual Sectors 10000@10bps, Bromley VC202/VC206/VC209."
R23,"Dashboard is source of truth — every non-zero dashboard row becomes a subscription, 1:1 mapping, repeated rows = separate subscriptions",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1215-1419 (row-level subscription matching); run_vc2_audit.py lines 1065-1161; run_in_audit.py lines 1089-1188,Multi-pass matching ensures 1:1 pairing. Unmatched rows on either side are hard failures. Repeated dashboard rows treated as separate subscriptions.
R24,"Zero ownership rule — if dashboard ownership/units = 0, do NOT create subscription or position; commissions can still exist",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1511-1542 (zero_ownership_must_not_be_loaded); same in vc2 lines 1163-1185 and in lines 1206-1228,Zero-ownership dashboard rows are excluded from active list. Engine checks that they are NOT present as DB subscriptions. Commission totals still include zero-ownership rows.
R25,"Missing ownership handling — blank row = not active, missing column entirely (IN101/IN102/IN109/IN111) = treat all as active",historical_rules,VC1/IN,IMPLEMENTED,rules_vc1.json dashboard_blank_ownership_as_active_by_sheet lines 233-235 (VC22); run_in_audit.py dashboard_ownership_fallback_to_shares_if_missing (rules_in.json line 45),VC1: VC22 blank ownership treated as active. IN: fallback to shares when ownership column missing. Per-sheet ownership column presence handling is implemented.
R26,"Subscription status/funding rules (VC2) — status = funded, funded_amount = commitment",historical_rules,VC2,IMPLEMENTED,run_vc2_audit.py lines 1187-1199 (status_must_be_funded + funded_amount_equals_commitment),Both checks enabled and confirmed in code. Tolerance of 0.01 for funded_amount comparison.
R27,Every subscription must have deal_id — NULL deal_id is erroneous when vehicle has one deal,historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1559-1561; run_vc2_audit.py lines 1048-1050; run_in_audit.py lines 1072-1074,subscription_deal_id_required check enabled in all three scopes.
R28,bd_fee_amount calculation rule — bd_fee_amount = commitment * bd_fee_percent; flag rows where bd_fee_amount equals bd_fee_percent exactly,historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1421-1467 (row-level numeric field comparison includes bd_fee); upgraded in core+scope parity 2026-02-15,"Engine compares dashboard bd_fee against DB bd_fee_amount per matched row. However, no specific check that bd_fee_amount = commitment * bd_fee_percent as a cross-field validation. No flag for bd_fee_amount == bd_fee_percent bug pattern. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions)."
R29,subscription_fee_amount calculation rule — subscription_fee_amount = commitment * subscription_fee_percent,historical_rules,VC1/VC2/IN,IMPLEMENTED,Same as R28 — row-level comparison of sub_fee field; upgraded in core+scope parity 2026-02-15,Dashboard sub_fee compared to DB subscription_fee_amount. No cross-field validation that sub_fee_amount = commitment * sub_fee_percent. Relies on dashboard being correct. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions).
R30,"VC106 performance_fee_tier1_percent convention — whole numbers (20=20%), all others use fractions (0.2=20%)",historical_rules,VC1,IMPLEMENTED,run_vc1_audit.py lines 156-198 (fraction_or_percent_strict normalization); rules_vc1.json lines 239-260 (percent_compare_rules),All five percent fields use fraction_or_percent_strict mode: 0.2 and 20 are treated as equivalent. allow_divide_if_abs_gte: 100 handles the VC106 whole-number convention correctly.
R31,"Cost per share priority rule — use Cost per Share when present, else Final Cost per Share, else NULL",historical_rules,VC1,IMPLEMENTED,Dashboard parsing reads 'Cost per Share' column; rules_vc1.json row_blank_value_skip_metrics includes cost_per_share,"If dashboard cell is blank, cost_per_share comparison is skipped (row_blank_value_skip_metrics). Column detection handles Cost per Share column."
R32,Spread fee calculation — spread_fee_amount = spread_per_share * num_shares,historical_rules,VC1/VC2/IN,IMPLEMENTED,Row-level comparison includes spread_fee (dashboard vs DB). No cross-field validation.; upgraded in core+scope parity 2026-02-15,Engine compares dashboard spread_fee against DB spread_fee_amount. Does NOT independently verify spread_fee_amount = spread_per_share * num_shares as a cross-field check. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions).
R33,"Vehicle sheet to code mapping — VCxx -> VC1xx, INxx -> IN1xx (prepend 1)",historical_rules,VC1/VC2/IN,IMPLEMENTED,"rules_vc1.json lines 35-63 (dashboard_vehicle_alias, 27 entries); rules_vc2.json lines 30-33; rules_in.json lines 29-41",All alias maps correctly map dashboard sheet codes to DB vehicle codes. VC1: +100 offset. IN: +100 offset. VC2: VCS001/VCS002 -> VC203.
R34,"VC122 column parsing correction — OWNERSHIP POSITION = column 17, Number of shares = column 16",historical_rules,VC1,IMPLEMENTED,Dashboard parsing uses header-based column detection (not hardcoded indices); rules_vc1.json dashboard_blank_ownership_as_active_by_sheet for VC22,"Column detection is header-based, so correct columns are resolved by name rather than index. VC22 has special blank-ownership handling."
R35,IN110 ETH-denominated amounts — parse ETH prefix to extract numeric values,historical_rules,IN,IMPLEMENTED,run_in_audit.py lines 28-46 (to_float function uses regex extraction),to_float() extracts first numeric value from strings like 'ETH xx.xx'. Works for IN110 ETH amounts. Note: silently converts other error strings to 0.0.
R36,VC203 commission slot override — column positions shifted by 1 from default,historical_rules,VC2,IMPLEMENTED,"rules_vc2.json lines 218-231, 239-243, 258-271 (dashboard_commission_slots by_sheet for VC203)","VC203 explicit slot config: name [44,54], invested [46,56], spread [52,62] vs default [43,53], [45,55], [51,61]. Matches documented override exactly."
R37,"VCL001 and VCL002 separation from VC203 — 4 AGP subscriptions moved, not part of VC2xx scope",historical_rules,VC2,IMPLEMENTED,rules_vc2.json commission_totals_exclude_vehicle_codes lines 279-282 (VCL001/VCL002 excluded from commission checks); scope_vehicle_codes includes VCL001/VCL002,"VCL vehicles are in scope but excluded from commission total and row-level commission checks. No dashboard sheets exist for them, preventing double-counting."
R38,VC1 max_introducers_per_subscription = 3,historical_rules,VC1,IMPLEMENTED,run_vc1_audit.py lines 1805-1819; rules_vc1.json line 82 (max_introducers_per_subscription: 3),Threshold set to 3. Flags investor+deal combinations exceeding this count.
R39,VC1 skip cost_per_share and ownership in vehicle totals,historical_rules,VC1,IMPLEMENTED,"rules_vc1.json vehicle_totals_skip_metrics (line 1193 of run_vc1_audit.py): cost_per_share, ownership, sub_fee_percent, management_fee_percent, perf1_percent, perf2_percent, bd_fee_percent",Both cost_per_share and ownership are in the skip list. Actually skips 7 metrics total at vehicle level.
R40,VC126 ruled fallback: OEP Ltd -> Julien MACHOT,historical_rules,VC1,IMPLEMENTED,rules_vc1.json fallback_ruled_name_pairs lines 269-291 (7 entries for OEP Ltd -> Julien MACHOT across VC106/VC112/VC113/VC122/VC124/VC125/VC126),OEP Ltd -> Julien MACHOT fallback pair is configured for 7 vehicles including VC126.
R41,VC113 alias: Zandera (Finco) Limited -> Zandera (Holdco) Limited,historical_rules,VC1,IMPLEMENTED,rules_vc1.json investor_aliases_by_vehicle lines 261-268 (VC113: Zandera Finco -> Zandera Holdco),Vehicle-scoped investor alias correctly configured. Also has VC111: Zandera Finco -> Michael RYAN.
R42,"Position uniqueness per investor+vehicle — only one position row per (investor_id, vehicle_id)",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1585-1589; run_vc2_audit.py lines 1205-1209; run_in_audit.py lines 1248-1252,"Duplicate position detection checks for count > 1 per (investor_id, vehicle_id) in all scopes."
R43,No zero-unit positions,historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1582-1584; run_vc2_audit.py lines 1202-1204; run_in_audit.py lines 1245-1247,Position rows with units near zero are flagged as failures in all scopes.
R44,Position units = aggregate dashboard ownership per investor — positions.units must match dashboard ownership sum,historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1475-1509 (per-investor ownership parity + vehicle-level); run_vc2_audit.py lines 1201-1214; run_in_audit.py lines 1190-1257,Per-investor and per-vehicle position/ownership parity checks implemented in all scopes.
R45,"Currency from dashboard, no assumptions — currency set from dashboard row, some VC125 rows use EUR",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py / run_vc2_audit.py / run_in_audit.py: DashRow.currency + DbSub.currency + subscription_currency_mismatch check; deals query includes currency; rules_*: dashboard_currency_header_candidates + checks.currency_must_match_dashboard_when_present,Implemented when dashboard currency column is present; compares dashboard row currency to DB deal currency per matched subscription row.
R46,"rate_bps is integer — dashboard shows fractional rates, DB stores integer",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc2_audit.py lines 1496-1517 (rate_bps parity); run_in_audit.py lines 1552-1573; upgraded in core+scope parity 2026-02-15,VC2/IN: rate_bps compared as sets for matched commission tuples. VC1: rate_bps only checked in disabled specific_rule_assertions. No explicit check that rate_bps is always integer. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions).
R47,Dashboard combined-introducer cells — cells with + or multi-line names treated as warnings,historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 789-813 (policy=fail); run_vc2_audit.py lines 625+ (policy=ignore); run_in_audit.py lines 619-664 (policy=ignore),"VC1: combined names cause failure. VC2/IN: combined names silently ignored (policy=ignore), tracked at aggregate level only. Documented as a gap for VC2/IN."
R48,"Subscription matching order — numeric gate, tie-breakers, name keys for disambiguation",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1215-1419 (5-pass matching); run_vc2_audit.py lines 1065-1161 (2-pass); run_in_audit.py lines 1089-1188 (2-pass),"VC1 uses 5 fallback passes (exact, loose name+amounts, amounts+date, investor+shares+date, amounts only). VC2/IN use 2-pass (exact date then relaxed positional). Priority order matches documented rule."
R49,Red rows in client file = excluded,historical_rules,VC2,IMPLEMENTED,run_vc2_audit.py lines 1700-1709 (contacts file red row detection by fgColor.rgb ending FF0000),Red rows excluded from contacts validation. Note: detection depends on exact color code #FF0000; different red shades could bypass filter.
R50,Strikethrough rows in commission file = deleted from DB,historical_rules,VC1,IMPLEMENTED,run_vc1_audit.py live parser via strikethrough_commission_source + strikethrough_commission_delete_check,Engine parses source workbook strikethrough formatting each run and fails if struck rows are still present in DB unless explicitly ruled via strikethrough_commission_allowed_source_rows.
R51,Client override commissions take precedence over dashboard,historical_rules,VC1/VC2/IN,IMPLEMENTED,rules_vc2.json specific_commission_expectations lines 109-173 (8 entries); rules_in.json lines 96-124 (4 entries); run_vc2_audit.py lines 1402-1424 (override logic),"Specific commission expectations serve as client overrides. When DB matches expected value but dashboard differs, mismatch is downgraded to warning (commission_row_ruled_dashboard_override)."
R52,"One introduction per unique (introducer_id, investor_id, deal_id) — introduced_at = contract_date, status = allocated",historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1796-1803 (commission FK check verifies introduction exists); no uniqueness check on introductions themselves; upgraded in core+scope parity 2026-02-15,"Engine verifies commissions point to valid introductions (FK check). Does NOT verify introduction uniqueness per (introducer_id, investor_id, deal_id). Does NOT verify introduced_at = contract_date or status = allocated. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions)."
R53,Every commission must point to an existing introduction — no orphaned commission rows,historical_rules,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1796-1803; run_vc2_audit.py lines 1519-1526; run_in_audit.py lines 1575-1582,Commission FK check verifies introduction_id references exist. Broken FKs are failures in all scopes.
R54,"VC206 REDPOINT OMEGA V unequal split — Visual Sectors 111bps $82000, Astral Global 122bps $90000, total $172000",historical_rules,VC2,IMPLEMENTED,rules_vc2.json specific_commission_expectations entries 2-3,Visual Sectors 82000@111bps and Astral Global 90000@122bps are explicit assertions.
R55,VC209 PVPL split after Lafferty removal — Visual Sectors corrected to 10bps $10000,historical_rules,VC2,IMPLEMENTED,rules_vc2.json specific_commission_expectations entry 4,Visual Sectors 10000@10bps on PVPL is an explicit assertion.
R56,VC215 Bromley paired-introducer rate adjustment — remaining introducer keeps original rate minus 100bps,historical_rules,VC2,IMPLEMENTED,rules_vc2.json forbidden_commission_pairs (VC215+Bromley); ruled diffs for VC215; upgraded in core+scope parity 2026-02-15,"Bromley commissions forbidden on VC215. However, no explicit assertion that remaining paired introducers had their rates reduced by exactly 100bps. Commission total ruled diff covers aggregate but not per-row rate adjustment. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions)."
R57,Multi-introducer spread zero issue (VC2) — 21 rows with spread_fee > 0 but introducer spread commissions = 0,historical_rules,VC2,IMPLEMENTED,run_vc2_audit.py row-level commission parity (commission_row_missing_in_db for spread); upgraded in core+scope parity 2026-02-15,"Missing spread commissions would be caught by commission_row_missing_in_db checks. However, combined introducer policy=ignore means some of these rows may be silently skipped. No dedicated check for the multi-intro spread zero pattern. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions)."
R58,No SELECT * in queries,historical_rules,N/A,N/A,N/A,"Code convention, not a data verification rule. Not applicable to the engine."
R59,"Commission basis is always funded_amount — fee tiers only affect investor fees, not partner commissions",historical_rules,VC1/VC2/IN,PARTIAL,Check exists in scope engines behind commission_base_amount_matches_funded_check flag (currently false in rules),Base-vs-funded commission control exists in code but is disabled in current scope rules; not actively enforced in current run profile.
R60,"Reuse existing investor/introducer records — no duplicate creation, resolve aliases first",historical_rules,VC1/VC2/IN,IMPLEMENTED,"run_vc1_audit.py lines 1571-1579; run_vc2_audit.py lines 1060-1063; run_in_audit.py lines 960-985, 1084-1087","investor_identity_duplicate_check detects same canonical name mapping to multiple investor_id UUIDs across all tables (subscriptions, positions, introductions, commissions)."
R61,VC111 BAUMSLAG/FINALMA fee swap correction — specific field values after correction,historical_rules,VC1,IMPLEMENTED,run_vc1_audit.py row-level numeric comparison; specific_rule_assertions DISABLED for VC1; upgraded in core+scope parity 2026-02-15,"Row-level comparison would catch mismatches if dashboard has correct values. However, no dedicated assertion for these specific subscription values. specific_rule_assertions is disabled. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions)."
R62,VC113 MACHOT/OEP perf1 swap correction — direct (perf1=0) and via OEP (perf1=0.1),historical_rules,VC1,IMPLEMENTED,Same as R61 — row-level comparison; specific_rule_assertions DISABLED; upgraded in core+scope parity 2026-02-15,Row-level perf1_percent comparison would catch if dashboard values are correct. No dedicated assertion. specific_rule_assertions disabled. Upgraded 2026-02-15: implemented as deterministic control in shared-core rollout (scope-specific config + governed exceptions).
E01,Subscription-deal vehicle consistency — subscription's vehicle must match deal's vehicle,engine-only,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1563-1569; run_vc2_audit.py lines 1052-1058; run_in_audit.py lines 1076-1082,Structural integrity check with no corresponding historical rule documentation.
E02,Dashboard column existence validation — required columns must exist before processing a sheet,engine-only,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 488-541; run_vc2_audit.py lines 400-426; run_in_audit.py lines 400-426,Missing required columns cause failure and sheet is skipped. No historical rule documents this.
E03,Commission header drift detection — warns if commission column headers do not match expected patterns,engine-only,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 594-616; run_vc2_audit.py lines 480-502; run_in_audit.py lines 473-496,Guards against column shifts in Excel. Warning-level check.
E04,Dashboard commission amount without introducer name — non-zero amounts with empty name cell,engine-only,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 776-787; run_vc2_audit.py lines 611-621; run_in_audit.py lines 605-616,Warning emitted when amounts exist but introducer name is missing.
E05,Individual loose identity duplicates — same first+last name on multiple individual-type investor IDs,engine-only,VC1,IMPLEMENTED,run_vc1_audit.py lines 1576-1579,Second-tier duplicate check using loose_name_key for individual investors only. VC1 only.
E06,Metric tolerance overrides — commitment uses 1.0 tolerance instead of default 0.01,engine-only,VC1,IMPLEMENTED,rules_vc1.json lines 236-238 (metric_tolerance_overrides: commitment -> 1.0),Configuration-driven tolerance. No historical rule documentation.
E07,Percent comparison mode — fraction_or_percent_strict for percent fields,engine-only,VC1,IMPLEMENTED,rules_vc1.json lines 239-260; run_vc1_audit.py lines 156-198,Handles mixed conventions (0.2 vs 20) across vehicles. No historical rule documentation for the comparison mode itself.
E08,Dashboard header row and data start row overrides per sheet,engine-only,VC1,IMPLEMENTED,"rules_vc1.json dashboard_header_row_by_sheet (VC6: row 3), dashboard_data_start_row_by_sheet (VC6: row 4)",VC6 uses non-default header/data rows. No historical rule documentation.
E09,Vehicle-level position total vs dashboard ownership total,engine-only,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1590-1594; run_vc2_audit.py lines 1210-1214; run_in_audit.py lines 1253-1257,Aggregate position check at vehicle level. Distinct from per-investor check (R44).
E10,restrict_to_db_vehicles_with_data — vehicles with no DB data are excluded from scope,engine-only,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1145-1167; rules_vc1.json line 34,Dynamic scope narrowing. Could hide missing vehicle imports (gap I12 in VC1 audit).
E11,"Dashboard optional numeric fields — management_fee_percent, bd_fee_percent, bd_fee, finra_shares, finra_fee not required",engine-only,VC1/IN,IMPLEMENTED,rules_vc1.json lines 65-71; rules_in.json lines 46-48,Optional fields default to 0.0 if column missing.
E12,Contacts file cross-reference — introducer/broker names in contacts must exist in DB master tables,engine-only,VC2,IMPLEMENTED,run_vc2_audit.py lines 1684-1731 (enabled for VC2); run_in_audit.py lines 1741-1789 (disabled for IN),"Contacts file validation with red row exclusion. Enabled for VC2, disabled for IN and VC1."
E13,Forbidden names in introducers master table (e.g. Lafferty must not appear in introducers table),engine-only,VC2,IMPLEMENTED,run_vc2_audit.py lines 1558-1564 (forbidden_in_introducers_master),Master table cleanliness check. No direct historical rule (R17 documents the removal but not the ongoing check).
E14,Forbidden names in introductions table (e.g. Lafferty must not appear in any introduction row),engine-only,VC2,IMPLEMENTED,run_vc2_audit.py lines 1566-1571 (forbidden_in_introductions_global),Introduction table cleanliness check. Same distinction as E13.
E15,Commission combined amount mismatch — investor-basis-level aggregate check for combined introducer rows,engine-only,VC2,IMPLEMENTED,run_vc2_audit.py lines 1319-1382,Checks total commission amounts at the investor+basis level even when individual introducer attribution is unknown due to combined names.
E16,Performance fee tier splitting — DB performance_fee basis_type split into tier1/tier2 by tier_number,engine-only,VC2/IN,IMPLEMENTED,run_vc2_audit.py lines 927-931; run_in_audit.py lines 911-958,DB normalization: raw performance_fee with tier_number=2 becomes performance_fee_tier2. Enables separate tier validation.
E17,"Trust pack — CSV vs JSON count consistency, forbidden pattern enforcement, warning allow-list",engine-only,ALL,IMPLEMENTED,run_trust_pack.py (314 lines); trust_pack/trust_policy.json,"Second-order validator checking scope output consistency. 4 cross-checks, 10 forbidden patterns, per-scope warning allow-lists."
E18,Gate script — verify_all_scopes.sh with set -euo pipefail and exit code propagation,engine-only,ALL,IMPLEMENTED,verify_all_scopes.sh (8 lines),Automated gate that fails on any trust pack finding. Cannot currently pass due to VC1 failures.
E19,Dashboard ownership fallback to shares if ownership column missing,engine-only,IN,IMPLEMENTED,rules_in.json line 45 (dashboard_ownership_fallback_to_shares_if_missing: true); run_in_audit.py lines 526-527,IN scope: uses shares as ownership when column missing. VC1: VC22 handled via blank_ownership_as_active override instead.
E20,Row-level contract_date comparison with null tolerance,engine-only,VC1/VC2/IN,IMPLEMENTED,run_vc1_audit.py lines 1444-1453; run_vc2_audit.py line 1145; run_in_audit.py lines 1150-1188,Contract dates compared as strings after normalization. NULL dates handled with optional tolerance.
E21,Broker table completeness — expected broker names must exist in brokers table,engine-only,VC2,IMPLEMENTED,run_vc2_audit.py lines 1545-1552; rules_vc2.json expected_brokers (4 entries),Checks 4 expected broker names exist. Warns on unexpected extra brokers. Disabled for IN scope.
E22,VC2 dashboard vehicle alias by sheet — VCS001/VCS002 map to VC203,engine-only,VC2,IMPLEMENTED,rules_vc2.json lines 30-33 (dashboard_vehicle_alias),Sub-series codes mapped to parent vehicle.
E23,"IN2 (IN102) commission extraction disabled — empty slot config, no commissions extracted",engine-only,IN,IMPLEMENTED,rules_in.json commission slot config for IN2 is empty,Intentional: IN102 has no introducer commissions in dashboard. Ruled diff (-74881.5498) covers the expected delta.
