{"version":3,"sources":["../../../../../versotech-portal/src/components/shared/kyc-documents-tab.tsx","../../../../../versotech-portal/src/components/shared/bank-details-tab.tsx","../../../../../versotech-portal/src/components/staff/shared/staff-entity-members-tab.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Button } from '@/components/ui/button'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Label } from '@/components/ui/label'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { FileText, Upload, Download, Trash2, CheckCircle2, Circle, Loader2, AlertCircle, Clock, AlertTriangle, Calendar } from 'lucide-react'\r\nimport { useState, useEffect, useRef, useCallback } from 'react'\r\nimport { toast } from 'sonner'\r\nimport { differenceInDays } from 'date-fns'\r\nimport {\r\n  getValidationStatusColor,\r\n  getValidationStatusLabel,\r\n  formatExpiryCountdown,\r\n  isIdDocument,\r\n  isProofOfAddress,\r\n  type ValidationStatus,\r\n} from '@/lib/validation/document-validation'\r\n\r\nexport type EntityType = 'investor' | 'introducer' | 'arranger' | 'lawyer' | 'partner' | 'commercial_partner'\r\n\r\ninterface RequiredDocument {\r\n  label: string\r\n  value: string\r\n}\r\n\r\ninterface Member {\r\n  id: string\r\n  full_name?: string\r\n  first_name?: string\r\n  last_name?: string\r\n  role: string\r\n}\r\n\r\ninterface Document {\r\n  id: string\r\n  name: string\r\n  type: string\r\n  file_name: string\r\n  file_key: string\r\n  created_at: string\r\n  file_size_bytes?: number\r\n  document_date?: string | null\r\n  document_expiry_date?: string | null\r\n  validation_status?: ValidationStatus | null\r\n  investor_member_id?: string | null\r\n  arranger_member_id?: string | null\r\n  partner_member_id?: string | null\r\n  introducer_member_id?: string | null\r\n  lawyer_member_id?: string | null\r\n  commercial_partner_member_id?: string | null\r\n  created_by?: {\r\n    display_name?: string\r\n    email?: string\r\n  }\r\n}\r\n\r\n// Required documents by entity type\r\nconst REQUIRED_DOCUMENTS: Record<EntityType, RequiredDocument[]> = {\r\n  investor: [\r\n    { label: 'Certificate of Incorporation', value: 'certificate_of_incorporation' },\r\n    { label: 'Memorandum & Articles of Association', value: 'memorandum_articles' },\r\n    { label: 'Register of Members/Directors', value: 'register_members_directors' },\r\n    { label: 'Passport/ID (Authorized Signatories)', value: 'signatory_id' },\r\n    { label: 'Proof of Address (Signatories)', value: 'signatory_proof_of_address' },\r\n    { label: 'Source of Funds Declaration', value: 'source_of_funds' },\r\n    { label: 'Tax Forms (W-8BEN-E/W-9)', value: 'tax_forms' },\r\n  ],\r\n  introducer: [\r\n    { label: 'Introducer Agreement', value: 'introducer_agreement' },\r\n    { label: 'Company Registration', value: 'company_registration' },\r\n    { label: 'Proof of Address', value: 'proof_of_address' },\r\n  ],\r\n  arranger: [\r\n    { label: 'Certificate of Incorporation', value: 'certificate_of_incorporation' },\r\n    { label: 'FCA Authorization Letter / SEC Form ADV', value: 'regulatory_license' },\r\n    { label: 'Professional Indemnity Insurance', value: 'insurance_certificate' },\r\n    { label: 'AML/CTF Policy Document', value: 'aml_policy' },\r\n    { label: 'Latest Financial Statements', value: 'financial_statements' },\r\n    { label: 'Beneficial Ownership Declaration', value: 'beneficial_ownership' },\r\n    { label: 'Proof of Registered Address', value: 'proof_of_address' },\r\n  ],\r\n  lawyer: [\r\n    { label: 'Bar Registration Certificate', value: 'bar_registration' },\r\n    { label: 'Professional Indemnity Insurance', value: 'professional_insurance' },\r\n    { label: 'Firm Registration', value: 'firm_registration' },\r\n    { label: 'Practice License', value: 'practice_license' },\r\n  ],\r\n  partner: [\r\n    { label: 'Accreditation Certificate', value: 'accreditation_certificate' },\r\n    { label: 'Certificate of Incorporation', value: 'certificate_of_incorporation' },\r\n    { label: 'Beneficial Ownership Declaration', value: 'beneficial_ownership' },\r\n    { label: 'Source of Funds Declaration', value: 'source_of_funds' },\r\n    { label: 'Tax Forms', value: 'tax_forms' },\r\n  ],\r\n  commercial_partner: [\r\n    { label: 'Certificate of Incorporation', value: 'certificate_of_incorporation' },\r\n    { label: 'Regulatory License', value: 'regulatory_license' },\r\n    { label: 'Professional Indemnity Insurance', value: 'insurance_certificate' },\r\n    { label: 'AML/CTF Policy Document', value: 'aml_policy' },\r\n    { label: 'Partnership Agreement', value: 'partnership_agreement' },\r\n  ],\r\n}\r\n\r\n// Member-specific required documents\r\nconst MEMBER_REQUIRED_DOCUMENTS: RequiredDocument[] = [\r\n  { label: 'ID Document (Passport/National ID)', value: 'member_id' },\r\n  { label: 'Proof of Address', value: 'member_proof_of_address' },\r\n]\r\n\r\ninterface KYCDocumentsTabProps {\r\n  entityType: EntityType\r\n  entityId: string\r\n  entityName?: string\r\n  readOnly?: boolean\r\n  /** Optional: Filter documents to a specific member */\r\n  memberId?: string\r\n  /** Optional: Member name for display */\r\n  memberName?: string\r\n  /** Optional: List of members for member selector during upload */\r\n  members?: Member[]\r\n  /** Optional: Show member documents section */\r\n  showMemberDocuments?: boolean\r\n}\r\n\r\nexport function KYCDocumentsTab({\r\n  entityType,\r\n  entityId,\r\n  entityName,\r\n  readOnly = false,\r\n  memberId,\r\n  memberName,\r\n  members = [],\r\n  showMemberDocuments = false,\r\n}: KYCDocumentsTabProps) {\r\n  const [documents, setDocuments] = useState<Document[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [uploading, setUploading] = useState<string | null>(null)\r\n  const fileInputRefs = useRef<{ [key: string]: HTMLInputElement | null }>({})\r\n\r\n  // Upload dialog state for date fields and member selection\r\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false)\r\n  const [uploadDocType, setUploadDocType] = useState<string | null>(null)\r\n  const [uploadFile, setUploadFile] = useState<File | null>(null)\r\n  const [selectedMemberId, setSelectedMemberId] = useState<string>('')\r\n  const [documentDate, setDocumentDate] = useState<string>('')\r\n  const [documentExpiryDate, setDocumentExpiryDate] = useState<string>('')\r\n  const [staffOverride, setStaffOverride] = useState(false)\r\n  const [overrideReason, setOverrideReason] = useState('')\r\n  const [validationError, setValidationError] = useState<{ error: string; canOverride: boolean } | null>(null)\r\n\r\n  const requiredDocuments = REQUIRED_DOCUMENTS[entityType] || []\r\n\r\n  const fetchDocuments = useCallback(async () => {\r\n    if (!entityId) return\r\n\r\n    setLoading(true)\r\n    try {\r\n      // Build the query parameter based on entity type\r\n      // Map entity types to their correct API parameter names\r\n      const paramMapping: Record<string, string> = {\r\n        investor: 'owner_investor_id',\r\n        arranger: 'arranger_entity_id',\r\n        introducer: 'introducer_id',\r\n        lawyer: 'lawyer_id',\r\n        partner: 'partner_id',\r\n        commercial_partner: 'commercial_partner_id',\r\n      }\r\n      const paramName = paramMapping[entityType] || `${entityType}_id`\r\n      const response = await fetch(`/api/documents?${paramName}=${entityId}&limit=100`)\r\n      if (!response.ok) throw new Error('Failed to fetch documents')\r\n\r\n      const data = await response.json()\r\n      setDocuments(data.documents || [])\r\n    } catch (error) {\r\n      console.error('Error fetching documents:', error)\r\n      toast.error('Failed to load documents')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, [entityId, entityType])\r\n\r\n  useEffect(() => {\r\n    fetchDocuments()\r\n  }, [fetchDocuments])\r\n\r\n  // Open upload dialog for documents that need validation\r\n  const openUploadDialog = (file: File, documentType: string) => {\r\n    setUploadFile(file)\r\n    setUploadDocType(documentType)\r\n    setDocumentDate('')\r\n    setDocumentExpiryDate('')\r\n    setStaffOverride(false)\r\n    setOverrideReason('')\r\n    setValidationError(null)\r\n    setSelectedMemberId(memberId || '')\r\n    setUploadDialogOpen(true)\r\n  }\r\n\r\n  // Perform the actual upload\r\n  const handleUpload = async (file: File, documentType: string) => {\r\n    if (!entityId) return\r\n\r\n    // Validate file size (50MB limit)\r\n    const maxSize = 50 * 1024 * 1024\r\n    if (file.size > maxSize) {\r\n      toast.error('File size exceeds 50MB limit')\r\n      return\r\n    }\r\n\r\n    // Validate file type\r\n    const allowedTypes = [\r\n      'application/pdf',\r\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n      'application/msword',\r\n      'image/jpeg',\r\n      'image/png',\r\n      'text/plain'\r\n    ]\r\n\r\n    if (!allowedTypes.includes(file.type)) {\r\n      toast.error('Invalid file type. Please upload PDF, DOC, DOCX, JPG, PNG, or TXT files')\r\n      return\r\n    }\r\n\r\n    // For ID documents or proof of address, open the dialog to collect dates\r\n    if (isIdDocument(documentType) || isProofOfAddress(documentType)) {\r\n      openUploadDialog(file, documentType)\r\n      return\r\n    }\r\n\r\n    // For other documents, upload directly\r\n    await performUpload(file, documentType, '', '', '', false, '')\r\n  }\r\n\r\n  // Perform the upload with all fields\r\n  const performUpload = async (\r\n    file: File,\r\n    documentType: string,\r\n    docDate: string,\r\n    expiryDate: string,\r\n    targetMemberId: string,\r\n    override: boolean,\r\n    reason: string\r\n  ) => {\r\n    setUploading(documentType)\r\n    setValidationError(null)\r\n\r\n    try {\r\n      const formData = new FormData()\r\n      formData.append('file', file)\r\n      formData.append('type', documentType)\r\n      formData.append('name', file.name.replace(/\\.[^/.]+$/, '')) // Remove extension\r\n\r\n      // Set the entity relationship based on type\r\n      const paramName = entityType === 'arranger' ? 'arranger_entity_id' : `${entityType}_id`\r\n      formData.append(paramName, entityId)\r\n\r\n      // Add member ID if provided (Phase 4)\r\n      if (targetMemberId) {\r\n        const memberParamName = `${entityType}_member_id`\r\n        formData.append(memberParamName, targetMemberId)\r\n      }\r\n\r\n      // Add validation fields (Phase 5)\r\n      if (docDate) {\r\n        formData.append('document_date', docDate)\r\n      }\r\n      if (expiryDate) {\r\n        formData.append('document_expiry_date', expiryDate)\r\n      }\r\n      if (override) {\r\n        formData.append('staff_override', 'true')\r\n        formData.append('override_reason', reason)\r\n      }\r\n\r\n      const response = await fetch('/api/documents/upload', {\r\n        method: 'POST',\r\n        body: formData\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        // Check if it's a validation error that can be overridden\r\n        if (response.status === 422 && data.validation?.canOverride) {\r\n          setValidationError({\r\n            error: data.error,\r\n            canOverride: true\r\n          })\r\n          return\r\n        }\r\n        throw new Error(data.error || 'Upload failed')\r\n      }\r\n\r\n      const docTypeLabel = requiredDocuments.find(d => d.value === documentType)?.label ||\r\n        MEMBER_REQUIRED_DOCUMENTS.find(d => d.value === documentType)?.label ||\r\n        documentType\r\n      toast.success(`${docTypeLabel} uploaded successfully`)\r\n\r\n      // Close dialog and refresh\r\n      setUploadDialogOpen(false)\r\n      await fetchDocuments()\r\n    } catch (error: any) {\r\n      console.error('Upload error:', error)\r\n      toast.error(error.message || 'Failed to upload document')\r\n    } finally {\r\n      setUploading(null)\r\n      // Reset file input\r\n      if (fileInputRefs.current[documentType]) {\r\n        fileInputRefs.current[documentType]!.value = ''\r\n      }\r\n    }\r\n  }\r\n\r\n  // Handle dialog submit\r\n  const handleDialogSubmit = () => {\r\n    if (!uploadFile || !uploadDocType) return\r\n    performUpload(\r\n      uploadFile,\r\n      uploadDocType,\r\n      documentDate,\r\n      documentExpiryDate,\r\n      selectedMemberId,\r\n      staffOverride,\r\n      overrideReason\r\n    )\r\n  }\r\n\r\n  const handleDelete = async (document: Document) => {\r\n    if (!confirm(`Delete \"${document.name}\"? This action cannot be undone.`)) {\r\n      return\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`/api/staff/documents/${document.id}`, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const error = await response.json()\r\n        throw new Error(error.error || 'Delete failed')\r\n      }\r\n\r\n      toast.success('Document deleted successfully')\r\n\r\n      // Refresh document list\r\n      await fetchDocuments()\r\n    } catch (error: any) {\r\n      console.error('Delete error:', error)\r\n      toast.error(error.message || 'Failed to delete document')\r\n    }\r\n  }\r\n\r\n  const handleDownload = async (doc: Document) => {\r\n    try {\r\n      const response = await fetch(`/api/documents/${doc.id}/download`)\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Download failed')\r\n      }\r\n\r\n      const blob = await response.blob()\r\n      const url = window.URL.createObjectURL(blob)\r\n      const a = document.createElement('a')\r\n      a.href = url\r\n      a.download = doc.file_name || doc.name\r\n      document.body.appendChild(a)\r\n      a.click()\r\n      window.URL.revokeObjectURL(url)\r\n      document.body.removeChild(a)\r\n\r\n      toast.success('Document downloaded')\r\n    } catch (error) {\r\n      console.error('Download error:', error)\r\n      toast.error('Failed to download document')\r\n    }\r\n  }\r\n\r\n  const formatFileSize = (bytes?: number) => {\r\n    if (!bytes) return 'Unknown size'\r\n    if (bytes < 1024) return `${bytes} B`\r\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`\r\n    return `${(bytes / (1024 * 1024)).toFixed(1)} MB`\r\n  }\r\n\r\n  const uploadedCount = documents.filter(d => requiredDocuments.some(req => req.value === d.type)).length\r\n  const completionPercentage = requiredDocuments.length > 0\r\n    ? Math.round((uploadedCount / requiredDocuments.length) * 100)\r\n    : 0\r\n\r\n  // Helper to render expiry/validation badge\r\n  const renderValidationBadge = (doc: Document) => {\r\n    // Check expiry date\r\n    if (doc.document_expiry_date) {\r\n      const expiryDate = new Date(doc.document_expiry_date)\r\n      const today = new Date()\r\n      const daysUntilExpiry = differenceInDays(expiryDate, today)\r\n\r\n      if (daysUntilExpiry < 0) {\r\n        return (\r\n          <Badge className=\"bg-red-500/20 text-red-400 text-xs gap-1\">\r\n            <AlertCircle className=\"h-3 w-3\" />\r\n            Expired\r\n          </Badge>\r\n        )\r\n      } else if (daysUntilExpiry <= 30) {\r\n        return (\r\n          <Badge className=\"bg-amber-500/20 text-amber-400 text-xs gap-1\">\r\n            <Clock className=\"h-3 w-3\" />\r\n            {formatExpiryCountdown(daysUntilExpiry)}\r\n          </Badge>\r\n        )\r\n      }\r\n    }\r\n\r\n    // Check validation status\r\n    if (doc.validation_status && doc.validation_status !== 'valid') {\r\n      return (\r\n        <Badge className={`${getValidationStatusColor(doc.validation_status)} text-xs`}>\r\n          {getValidationStatusLabel(doc.validation_status)}\r\n        </Badge>\r\n      )\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  // Get member name for display\r\n  const getMemberName = (member: Member) => {\r\n    if (member.full_name) return member.full_name\r\n    if (member.first_name && member.last_name) return `${member.first_name} ${member.last_name}`\r\n    return member.id.slice(0, 8)\r\n  }\r\n\r\n  return (\r\n    <>\r\n    {/* Upload Dialog with Date Fields */}\r\n    <Dialog open={uploadDialogOpen} onOpenChange={setUploadDialogOpen}>\r\n      <DialogContent className=\"sm:max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle>Upload Document</DialogTitle>\r\n          <DialogDescription>\r\n            {isIdDocument(uploadDocType || '') && 'ID documents require an expiry date for compliance tracking.'}\r\n            {isProofOfAddress(uploadDocType || '') && 'Proof of address must be dated within the last 3 months.'}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4 py-4\">\r\n          {/* File info */}\r\n          {uploadFile && (\r\n            <div className=\"flex items-center gap-3 p-3 rounded-lg bg-white/5\">\r\n              <FileText className=\"h-5 w-5 text-muted-foreground\" />\r\n              <div className=\"flex-1 min-w-0\">\r\n                <p className=\"text-sm font-medium truncate\">{uploadFile.name}</p>\r\n                <p className=\"text-xs text-muted-foreground\">{formatFileSize(uploadFile.size)}</p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Member selector (if members available) */}\r\n          {members.length > 0 && (\r\n            <div className=\"space-y-2\">\r\n              <Label>Associate with Member (Optional)</Label>\r\n              <Select value={selectedMemberId} onValueChange={setSelectedMemberId}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Entity-level document\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"\">Entity-level document</SelectItem>\r\n                  {members.map(member => (\r\n                    <SelectItem key={member.id} value={member.id}>\r\n                      {getMemberName(member)} ({member.role})\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          )}\r\n\r\n          {/* Document date for proof of address */}\r\n          {isProofOfAddress(uploadDocType || '') && (\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"document_date\">\r\n                Document Date <span className=\"text-red-400\">*</span>\r\n              </Label>\r\n              <Input\r\n                id=\"document_date\"\r\n                type=\"date\"\r\n                value={documentDate}\r\n                onChange={(e) => setDocumentDate(e.target.value)}\r\n                max={new Date().toISOString().split('T')[0]}\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Date shown on the document (utility bill date, bank statement date, etc.)\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Expiry date for ID documents */}\r\n          {isIdDocument(uploadDocType || '') && (\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"expiry_date\">\r\n                Document Expiry Date <span className=\"text-red-400\">*</span>\r\n              </Label>\r\n              <Input\r\n                id=\"expiry_date\"\r\n                type=\"date\"\r\n                value={documentExpiryDate}\r\n                onChange={(e) => setDocumentExpiryDate(e.target.value)}\r\n                min={new Date().toISOString().split('T')[0]}\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Expiry date shown on the ID document\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Validation error with override option */}\r\n          {validationError && (\r\n            <div className=\"p-3 rounded-lg border border-red-500/50 bg-red-500/10 space-y-3\">\r\n              <div className=\"flex items-start gap-2\">\r\n                <AlertTriangle className=\"h-5 w-5 text-red-400 flex-shrink-0 mt-0.5\" />\r\n                <p className=\"text-sm text-red-400\">{validationError.error}</p>\r\n              </div>\r\n\r\n              {validationError.canOverride && (\r\n                <div className=\"space-y-2 pt-2 border-t border-red-500/30\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      id=\"staff_override\"\r\n                      checked={staffOverride}\r\n                      onChange={(e) => setStaffOverride(e.target.checked)}\r\n                      className=\"rounded\"\r\n                    />\r\n                    <Label htmlFor=\"staff_override\" className=\"text-sm\">\r\n                      Staff Override (requires reason)\r\n                    </Label>\r\n                  </div>\r\n                  {staffOverride && (\r\n                    <Textarea\r\n                      placeholder=\"Enter reason for override...\"\r\n                      value={overrideReason}\r\n                      onChange={(e) => setOverrideReason(e.target.value)}\r\n                      className=\"min-h-[60px]\"\r\n                    />\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => setUploadDialogOpen(false)}>\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            onClick={handleDialogSubmit}\r\n            disabled={\r\n              uploading === uploadDocType ||\r\n              (isIdDocument(uploadDocType || '') && !documentExpiryDate) ||\r\n              (isProofOfAddress(uploadDocType || '') && !documentDate) ||\r\n              (validationError?.canOverride && staffOverride && !overrideReason)\r\n            }\r\n          >\r\n            {uploading === uploadDocType ? (\r\n              <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n            ) : (\r\n              <Upload className=\"h-4 w-4 mr-2\" />\r\n            )}\r\n            Upload\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n    <div className=\"space-y-6\">\r\n      {/* Summary Card */}\r\n      <Card>\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle>KYC Documents</CardTitle>\r\n              <CardDescription>\r\n                {entityName ? `Compliance documents for ${entityName}` : 'Required compliance and verification documents'}\r\n              </CardDescription>\r\n            </div>\r\n            <div className=\"text-right\">\r\n              <div className=\"text-2xl font-bold text-foreground\">\r\n                {uploadedCount}/{requiredDocuments.length}\r\n              </div>\r\n              <div className=\"text-sm text-muted-foreground\">\r\n                {completionPercentage}% complete\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {/* Progress bar */}\r\n          <div className=\"w-full bg-white/10 rounded-full h-2\">\r\n            <div\r\n              className={`h-2 rounded-full transition-all ${\r\n                completionPercentage === 100 ? 'bg-green-500' :\r\n                completionPercentage >= 50 ? 'bg-yellow-500' : 'bg-red-500'\r\n              }`}\r\n              style={{ width: `${completionPercentage}%` }}\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Required Documents Checklist */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base\">Required Documents</CardTitle>\r\n          <CardDescription>\r\n            Upload all required documents to complete KYC verification\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {loading ? (\r\n            <div className=\"flex items-center justify-center py-8\">\r\n              <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {requiredDocuments.map((docType) => {\r\n                const uploaded = documents.find(d => d.type === docType.value)\r\n                const isUploading = uploading === docType.value\r\n\r\n                return (\r\n                  <div\r\n                    key={docType.value}\r\n                    className=\"flex items-center justify-between gap-4 py-3 px-4 rounded-lg border border-white/10 hover:bg-white/5 transition-colors\"\r\n                  >\r\n                    <div className=\"flex items-center gap-3 flex-1 min-w-0\">\r\n                      {uploaded ? (\r\n                        <CheckCircle2 className=\"h-5 w-5 text-green-400 flex-shrink-0\" />\r\n                      ) : (\r\n                        <Circle className=\"h-5 w-5 text-muted-foreground flex-shrink-0\" />\r\n                      )}\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"text-sm font-medium text-foreground truncate\">{docType.label}</p>\r\n                        {uploaded && (\r\n                          <p className=\"text-xs text-muted-foreground truncate\">\r\n                            {uploaded.file_name} • {formatFileSize(uploaded.file_size_bytes)}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n                      {/* Validation badge */}\r\n                      {uploaded && renderValidationBadge(uploaded)}\r\n\r\n                      {uploaded ? (\r\n                        <>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleDownload(uploaded)}\r\n                            className=\"h-8 w-8 p-0\"\r\n                          >\r\n                            <Download className=\"h-4 w-4\" />\r\n                          </Button>\r\n                          {!readOnly && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleDelete(uploaded)}\r\n                              className=\"h-8 w-8 p-0 text-red-400 hover:text-red-300\"\r\n                            >\r\n                              <Trash2 className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          )}\r\n                        </>\r\n                      ) : !readOnly && (\r\n                        <>\r\n                          <Input\r\n                            ref={(el) => { fileInputRefs.current[docType.value] = el }}\r\n                            type=\"file\"\r\n                            className=\"hidden\"\r\n                            accept=\".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt\"\r\n                            onChange={(e) => {\r\n                              const file = e.target.files?.[0]\r\n                              if (file) handleUpload(file, docType.value)\r\n                            }}\r\n                            disabled={isUploading}\r\n                          />\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => fileInputRefs.current[docType.value]?.click()}\r\n                            disabled={isUploading}\r\n                          >\r\n                            {isUploading ? (\r\n                              <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                            ) : (\r\n                              <Upload className=\"h-4 w-4 mr-2\" />\r\n                            )}\r\n                            Upload\r\n                          </Button>\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                )\r\n              })}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Other Documents */}\r\n      {documents.filter(d => !requiredDocuments.some(req => req.value === d.type)).length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base\">Additional Documents</CardTitle>\r\n            <CardDescription>\r\n              Other documents uploaded for this entity\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              {documents\r\n                .filter(d => !requiredDocuments.some(req => req.value === d.type))\r\n                .map((doc) => (\r\n                  <div\r\n                    key={doc.id}\r\n                    className=\"flex items-center justify-between gap-4 py-2 px-3 rounded-lg hover:bg-white/5 transition-colors\"\r\n                  >\r\n                    <div className=\"flex items-center gap-3 flex-1 min-w-0\">\r\n                      <FileText className=\"h-5 w-5 text-muted-foreground flex-shrink-0\" />\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"text-sm font-medium text-foreground truncate\">{doc.name}</p>\r\n                        <p className=\"text-xs text-muted-foreground truncate\">\r\n                          {doc.file_name} • {formatFileSize(doc.file_size_bytes)}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleDownload(doc)}\r\n                        className=\"h-8 w-8 p-0\"\r\n                      >\r\n                        <Download className=\"h-4 w-4\" />\r\n                      </Button>\r\n                      {!readOnly && (\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleDelete(doc)}\r\n                          className=\"h-8 w-8 p-0 text-red-400 hover:text-red-300\"\r\n                        >\r\n                          <Trash2 className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Helper Text */}\r\n      <div className=\"text-xs text-muted-foreground space-y-1 border-t border-white/10 pt-4\">\r\n        <p>• Supported formats: PDF, DOC, DOCX, JPG, PNG, TXT</p>\r\n        <p>• Maximum file size: 50MB per file</p>\r\n        <p>• Documents are stored securely and linked to this entity</p>\r\n        <p>• Upload actions are logged for audit trail</p>\r\n        {isIdDocument('signatory_id') && <p>• ID documents must have a valid expiry date</p>}\r\n        {isProofOfAddress('proof_of_address') && <p>• Proof of address must be dated within the last 3 months</p>}\r\n      </div>\r\n    </div>\r\n    </>\r\n  )\r\n}\r\n\r\n// Export the required documents config for external use\r\nexport { REQUIRED_DOCUMENTS }\r\n","'use client'\n\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'\nimport { Switch } from '@/components/ui/switch'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Building2, Plus, Edit2, Trash2, Star, Loader2, AlertCircle } from 'lucide-react'\nimport { useState, useEffect, useCallback } from 'react'\nimport { toast } from 'sonner'\n\nexport type EntityType = 'investor' | 'introducer' | 'arranger' | 'lawyer' | 'partner' | 'commercial_partner'\n\ninterface BankDetail {\n  id: string\n  entity_type: string\n  entity_id: string\n  bank_name: string\n  account_holder_name: string\n  account_number?: string\n  routing_number?: string\n  swift_bic?: string\n  iban?: string\n  currency: string\n  is_primary: boolean\n  notes?: string\n  created_at: string\n}\n\ninterface BankDetailsTabProps {\n  entityType: EntityType\n  entityId: string\n  entityName?: string\n  readOnly?: boolean\n}\n\nconst CURRENCIES = [\n  { value: 'USD', label: 'USD - US Dollar' },\n  { value: 'EUR', label: 'EUR - Euro' },\n  { value: 'GBP', label: 'GBP - British Pound' },\n  { value: 'CHF', label: 'CHF - Swiss Franc' },\n  { value: 'JPY', label: 'JPY - Japanese Yen' },\n  { value: 'CAD', label: 'CAD - Canadian Dollar' },\n  { value: 'AUD', label: 'AUD - Australian Dollar' },\n  { value: 'SGD', label: 'SGD - Singapore Dollar' },\n  { value: 'HKD', label: 'HKD - Hong Kong Dollar' },\n]\n\nconst initialFormData = {\n  bank_name: '',\n  account_holder_name: '',\n  account_number: '',\n  routing_number: '',\n  swift_bic: '',\n  iban: '',\n  currency: 'USD',\n  is_primary: false,\n  notes: '',\n}\n\nexport function BankDetailsTab({ entityType, entityId, entityName, readOnly = false }: BankDetailsTabProps) {\n  const [bankDetails, setBankDetails] = useState<BankDetail[]>([])\n  const [loading, setLoading] = useState(true)\n  const [saving, setSaving] = useState(false)\n  const [dialogOpen, setDialogOpen] = useState(false)\n  const [editingId, setEditingId] = useState<string | null>(null)\n  const [formData, setFormData] = useState(initialFormData)\n\n  const fetchBankDetails = useCallback(async () => {\n    if (!entityId) return\n\n    setLoading(true)\n    try {\n      const response = await fetch(`/api/admin/bank-details?entity_type=${entityType}&entity_id=${entityId}`)\n      if (!response.ok) throw new Error('Failed to fetch bank details')\n\n      const data = await response.json()\n      setBankDetails(data.bankDetails || [])\n    } catch (error) {\n      console.error('Error fetching bank details:', error)\n      toast.error('Failed to load bank details')\n    } finally {\n      setLoading(false)\n    }\n  }, [entityId, entityType])\n\n  useEffect(() => {\n    fetchBankDetails()\n  }, [fetchBankDetails])\n\n  const handleSubmit = async () => {\n    if (!formData.bank_name.trim() || !formData.account_holder_name.trim()) {\n      toast.error('Bank name and account holder name are required')\n      return\n    }\n\n    setSaving(true)\n    try {\n      const url = editingId\n        ? `/api/admin/bank-details/${editingId}`\n        : '/api/admin/bank-details'\n\n      const response = await fetch(url, {\n        method: editingId ? 'PATCH' : 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          ...formData,\n          entity_type: entityType,\n          entity_id: entityId,\n        }),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error || 'Failed to save bank details')\n      }\n\n      toast.success(editingId ? 'Bank details updated' : 'Bank account added')\n      setDialogOpen(false)\n      setEditingId(null)\n      setFormData(initialFormData)\n      await fetchBankDetails()\n    } catch (error: any) {\n      console.error('Save error:', error)\n      toast.error(error.message || 'Failed to save bank details')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleEdit = (bankDetail: BankDetail) => {\n    setEditingId(bankDetail.id)\n    setFormData({\n      bank_name: bankDetail.bank_name,\n      account_holder_name: bankDetail.account_holder_name,\n      account_number: bankDetail.account_number || '',\n      routing_number: bankDetail.routing_number || '',\n      swift_bic: bankDetail.swift_bic || '',\n      iban: bankDetail.iban || '',\n      currency: bankDetail.currency,\n      is_primary: bankDetail.is_primary,\n      notes: bankDetail.notes || '',\n    })\n    setDialogOpen(true)\n  }\n\n  const handleDelete = async (id: string) => {\n    if (!confirm('Delete this bank account? This action cannot be undone.')) {\n      return\n    }\n\n    try {\n      const response = await fetch(`/api/admin/bank-details/${id}`, {\n        method: 'DELETE',\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error || 'Delete failed')\n      }\n\n      toast.success('Bank account deleted')\n      await fetchBankDetails()\n    } catch (error: any) {\n      console.error('Delete error:', error)\n      toast.error(error.message || 'Failed to delete bank account')\n    }\n  }\n\n  const handleSetPrimary = async (id: string) => {\n    try {\n      const response = await fetch(`/api/admin/bank-details/${id}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ is_primary: true }),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error || 'Failed to set as primary')\n      }\n\n      toast.success('Primary bank account updated')\n      await fetchBankDetails()\n    } catch (error: any) {\n      console.error('Set primary error:', error)\n      toast.error(error.message || 'Failed to update primary account')\n    }\n  }\n\n  const openAddDialog = () => {\n    setEditingId(null)\n    setFormData(initialFormData)\n    setDialogOpen(true)\n  }\n\n  const primaryAccount = bankDetails.find(b => b.is_primary)\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Summary Card */}\n      <Card>\n        <CardHeader className=\"pb-3\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle>Bank Details</CardTitle>\n              <CardDescription>\n                {entityName ? `Bank accounts for ${entityName}` : 'Manage bank account information for payments and distributions'}\n              </CardDescription>\n            </div>\n            {!readOnly && (\n              <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n                <DialogTrigger asChild>\n                  <Button onClick={openAddDialog}>\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add Account\n                  </Button>\n                </DialogTrigger>\n                <DialogContent className=\"max-w-lg\">\n                  <DialogHeader>\n                    <DialogTitle>{editingId ? 'Edit Bank Account' : 'Add Bank Account'}</DialogTitle>\n                    <DialogDescription>\n                      {editingId ? 'Update bank account details' : 'Add a new bank account for this entity'}\n                    </DialogDescription>\n                  </DialogHeader>\n\n                  <div className=\"space-y-4 py-4\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"bank_name\">Bank Name *</Label>\n                        <Input\n                          id=\"bank_name\"\n                          value={formData.bank_name}\n                          onChange={(e) => setFormData(prev => ({ ...prev, bank_name: e.target.value }))}\n                          placeholder=\"e.g., HSBC, Barclays\"\n                        />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"currency\">Currency</Label>\n                        <Select\n                          value={formData.currency}\n                          onValueChange={(value) => setFormData(prev => ({ ...prev, currency: value }))}\n                        >\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {CURRENCIES.map(curr => (\n                              <SelectItem key={curr.value} value={curr.value}>\n                                {curr.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"account_holder_name\">Account Holder Name *</Label>\n                      <Input\n                        id=\"account_holder_name\"\n                        value={formData.account_holder_name}\n                        onChange={(e) => setFormData(prev => ({ ...prev, account_holder_name: e.target.value }))}\n                        placeholder=\"Name on the account\"\n                      />\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"account_number\">Account Number</Label>\n                        <Input\n                          id=\"account_number\"\n                          value={formData.account_number}\n                          onChange={(e) => setFormData(prev => ({ ...prev, account_number: e.target.value }))}\n                          placeholder=\"Account number\"\n                        />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"routing_number\">Routing Number / Sort Code</Label>\n                        <Input\n                          id=\"routing_number\"\n                          value={formData.routing_number}\n                          onChange={(e) => setFormData(prev => ({ ...prev, routing_number: e.target.value }))}\n                          placeholder=\"Routing/Sort code\"\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"swift_bic\">SWIFT/BIC Code</Label>\n                        <Input\n                          id=\"swift_bic\"\n                          value={formData.swift_bic}\n                          onChange={(e) => setFormData(prev => ({ ...prev, swift_bic: e.target.value }))}\n                          placeholder=\"e.g., HSBCGB2L\"\n                        />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"iban\">IBAN</Label>\n                        <Input\n                          id=\"iban\"\n                          value={formData.iban}\n                          onChange={(e) => setFormData(prev => ({ ...prev, iban: e.target.value }))}\n                          placeholder=\"e.g., GB82WEST...\"\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"notes\">Notes</Label>\n                      <Textarea\n                        id=\"notes\"\n                        value={formData.notes}\n                        onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n                        placeholder=\"Additional notes about this account\"\n                        rows={2}\n                      />\n                    </div>\n\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        id=\"is_primary\"\n                        checked={formData.is_primary}\n                        onCheckedChange={(checked) => setFormData(prev => ({ ...prev, is_primary: checked }))}\n                      />\n                      <Label htmlFor=\"is_primary\" className=\"text-sm\">Set as primary account</Label>\n                    </div>\n                  </div>\n\n                  <DialogFooter>\n                    <Button variant=\"outline\" onClick={() => setDialogOpen(false)} disabled={saving}>\n                      Cancel\n                    </Button>\n                    <Button onClick={handleSubmit} disabled={saving}>\n                      {saving && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\n                      {editingId ? 'Update' : 'Add Account'}\n                    </Button>\n                  </DialogFooter>\n                </DialogContent>\n              </Dialog>\n            )}\n          </div>\n        </CardHeader>\n      </Card>\n\n      {/* Primary Account Highlight */}\n      {primaryAccount && (\n        <Card className=\"border-primary/50 bg-primary/5\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center gap-2\">\n              <Star className=\"h-5 w-5 text-primary fill-primary\" />\n              <CardTitle className=\"text-base\">Primary Account</CardTitle>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <div>\n                <p className=\"text-xs text-muted-foreground\">Bank Name</p>\n                <p className=\"text-sm font-medium\">{primaryAccount.bank_name}</p>\n              </div>\n              <div>\n                <p className=\"text-xs text-muted-foreground\">Account Holder</p>\n                <p className=\"text-sm font-medium\">{primaryAccount.account_holder_name}</p>\n              </div>\n              <div>\n                <p className=\"text-xs text-muted-foreground\">Currency</p>\n                <p className=\"text-sm font-medium\">{primaryAccount.currency}</p>\n              </div>\n              {primaryAccount.iban && (\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">IBAN</p>\n                  <p className=\"text-sm font-medium font-mono\">{primaryAccount.iban}</p>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Bank Accounts List */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-base\">All Bank Accounts</CardTitle>\n          <CardDescription>\n            {bankDetails.length} account{bankDetails.length !== 1 ? 's' : ''} on file\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          {loading ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n            </div>\n          ) : bankDetails.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-8 text-center\">\n              <Building2 className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <p className=\"text-sm text-muted-foreground\">No bank accounts added yet</p>\n              {!readOnly && (\n                <Button variant=\"outline\" className=\"mt-4\" onClick={openAddDialog}>\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Add First Account\n                </Button>\n              )}\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {bankDetails.map((bank) => (\n                <div\n                  key={bank.id}\n                  className={`flex items-start justify-between gap-4 p-4 rounded-lg border transition-colors ${\n                    bank.is_primary ? 'border-primary/50 bg-primary/5' : 'border-white/10 hover:bg-white/5'\n                  }`}\n                >\n                  <div className=\"flex items-start gap-3 flex-1 min-w-0\">\n                    <Building2 className=\"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0\" />\n                    <div className=\"flex-1 min-w-0 space-y-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <p className=\"text-sm font-medium text-foreground\">{bank.bank_name}</p>\n                        {bank.is_primary && (\n                          <span className=\"text-xs bg-primary/20 text-primary px-2 py-0.5 rounded-full\">\n                            Primary\n                          </span>\n                        )}\n                        <span className=\"text-xs bg-white/10 text-muted-foreground px-2 py-0.5 rounded-full\">\n                          {bank.currency}\n                        </span>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground\">{bank.account_holder_name}</p>\n                      <div className=\"flex flex-wrap gap-4 text-xs text-muted-foreground\">\n                        {bank.account_number && (\n                          <span>Account: •••{bank.account_number.slice(-4)}</span>\n                        )}\n                        {bank.swift_bic && (\n                          <span>SWIFT: {bank.swift_bic}</span>\n                        )}\n                        {bank.iban && (\n                          <span className=\"font-mono\">IBAN: {bank.iban.slice(0, 4)}...{bank.iban.slice(-4)}</span>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n\n                  {!readOnly && (\n                    <div className=\"flex items-center gap-1 flex-shrink-0\">\n                      {!bank.is_primary && (\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleSetPrimary(bank.id)}\n                          className=\"h-8 w-8 p-0\"\n                          title=\"Set as primary\"\n                        >\n                          <Star className=\"h-4 w-4\" />\n                        </Button>\n                      )}\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleEdit(bank)}\n                        className=\"h-8 w-8 p-0\"\n                      >\n                        <Edit2 className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleDelete(bank.id)}\n                        className=\"h-8 w-8 p-0 text-red-400 hover:text-red-300\"\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Helper Text */}\n      <div className=\"text-xs text-muted-foreground space-y-1 border-t border-white/10 pt-4\">\n        <p>• Bank details are used for distributions and commission payments</p>\n        <p>• The primary account will be used by default for payments</p>\n        <p>• Only authorized staff can view and edit bank details</p>\n        <p>• All changes are logged for audit purposes</p>\n      </div>\n    </div>\n  )\n}\n","'use client'\r\n\r\n/**\r\n * Staff Entity Members Tab\r\n *\r\n * A staff-side component for managing entity members (directors, UBOs, signatories)\r\n * across all persona types: investor, arranger, partner, introducer, lawyer, commercial_partner\r\n *\r\n * Uses MemberKYCEditDialog for comprehensive KYC field editing.\r\n * Points to staff-specific API endpoints with elevated permissions.\r\n */\r\n\r\nimport { useState, useEffect, useCallback } from 'react'\r\nimport { Users, UserPlus, Edit, Trash2, ShieldCheck, Clock, AlertCircle, FileWarning, CheckCircle, XCircle, Percent } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table'\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog'\r\nimport { toast } from 'sonner'\r\nimport { MemberKYCEditDialog } from '@/components/shared/member-kyc-edit-dialog'\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip'\r\n\r\n// Entity types that support members\r\nexport type StaffEntityType = 'investor' | 'partner' | 'introducer' | 'lawyer' | 'arranger' | 'commercial_partner'\r\n\r\n// Maps entity type to API path segment\r\nconst ENTITY_TYPE_TO_API_PATH: Record<StaffEntityType, string> = {\r\n  investor: 'investors',\r\n  partner: 'partners',\r\n  introducer: 'introducers',\r\n  lawyer: 'lawyers',\r\n  arranger: 'arrangers',\r\n  commercial_partner: 'commercial-partners',\r\n}\r\n\r\n// Member data structure\r\ninterface EntityMember {\r\n  id: string\r\n  full_name?: string\r\n  first_name?: string\r\n  middle_name?: string\r\n  middle_initial?: string\r\n  last_name?: string\r\n  name_suffix?: string\r\n  role: string\r\n  role_title?: string\r\n  email?: string\r\n  phone_mobile?: string\r\n  phone_office?: string\r\n  date_of_birth?: string\r\n  country_of_birth?: string\r\n  nationality?: string\r\n  residential_street?: string\r\n  residential_line_2?: string\r\n  residential_city?: string\r\n  residential_state?: string\r\n  residential_postal_code?: string\r\n  residential_country?: string\r\n  is_us_citizen?: boolean\r\n  is_us_taxpayer?: boolean\r\n  us_taxpayer_id?: string\r\n  country_of_tax_residency?: string\r\n  tax_id_number?: string\r\n  id_type?: string\r\n  id_number?: string\r\n  id_issue_date?: string\r\n  id_expiry_date?: string\r\n  id_issuing_country?: string\r\n  proof_of_address_date?: string\r\n  proof_of_address_expiry?: string\r\n  ownership_percentage?: number\r\n  is_beneficial_owner?: boolean\r\n  is_signatory?: boolean\r\n  can_sign?: boolean\r\n  kyc_status?: string\r\n  kyc_approved_at?: string\r\n  kyc_approved_by?: string\r\n  kyc_expiry_date?: string\r\n  kyc_notes?: string\r\n  is_active?: boolean\r\n  created_at?: string\r\n  effective_from?: string\r\n  effective_to?: string\r\n}\r\n\r\ninterface StaffEntityMembersTabProps {\r\n  entityType: StaffEntityType\r\n  entityId: string\r\n  entityName?: string\r\n  /** Optional custom title */\r\n  title?: string\r\n  /** Optional custom description */\r\n  description?: string\r\n  /** Callback when member data changes */\r\n  onDataChange?: () => void\r\n}\r\n\r\nconst ROLE_LABELS: Record<string, string> = {\r\n  director: 'Director',\r\n  shareholder: 'Shareholder',\r\n  beneficial_owner: 'Beneficial Owner',\r\n  authorized_signatory: 'Authorized Signatory',\r\n  officer: 'Officer',\r\n  partner: 'Partner',\r\n  ubo: 'UBO',\r\n  signatory: 'Signatory',\r\n  authorized_representative: 'Authorized Representative',\r\n  beneficiary: 'Beneficiary',\r\n  trustee: 'Trustee',\r\n  managing_member: 'Managing Member',\r\n  general_partner: 'General Partner',\r\n  limited_partner: 'Limited Partner',\r\n  other: 'Other',\r\n}\r\n\r\nexport function StaffEntityMembersTab({\r\n  entityType,\r\n  entityId,\r\n  entityName,\r\n  title = 'Entity Members',\r\n  description = 'Manage directors, shareholders, beneficial owners, and signatories',\r\n  onDataChange,\r\n}: StaffEntityMembersTabProps) {\r\n  const [members, setMembers] = useState<EntityMember[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  // Dialog states\r\n  const [editDialogOpen, setEditDialogOpen] = useState(false)\r\n  const [editingMember, setEditingMember] = useState<EntityMember | null>(null)\r\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false)\r\n  const [deletingMember, setDeletingMember] = useState<EntityMember | null>(null)\r\n  const [isDeleting, setIsDeleting] = useState(false)\r\n\r\n  // Build API endpoint for staff\r\n  const apiPath = ENTITY_TYPE_TO_API_PATH[entityType]\r\n  const apiEndpoint = `/api/staff/${apiPath}/${entityId}/members`\r\n\r\n  // Load members\r\n  const loadMembers = useCallback(async () => {\r\n    setLoading(true)\r\n    setError(null)\r\n\r\n    try {\r\n      const response = await fetch(apiEndpoint)\r\n      if (!response.ok) {\r\n        const data = await response.json()\r\n        throw new Error(data.error || 'Failed to load members')\r\n      }\r\n\r\n      const data = await response.json()\r\n      setMembers(data.members || [])\r\n    } catch (err) {\r\n      console.error('Error loading members:', err)\r\n      setError(err instanceof Error ? err.message : 'Failed to load members')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, [apiEndpoint])\r\n\r\n  useEffect(() => {\r\n    loadMembers()\r\n  }, [loadMembers])\r\n\r\n  const handleAddMember = () => {\r\n    setEditingMember(null)\r\n    setEditDialogOpen(true)\r\n  }\r\n\r\n  const handleEditMember = (member: EntityMember) => {\r\n    setEditingMember(member)\r\n    setEditDialogOpen(true)\r\n  }\r\n\r\n  const handleDeleteClick = (member: EntityMember) => {\r\n    setDeletingMember(member)\r\n    setDeleteDialogOpen(true)\r\n  }\r\n\r\n  const handleDeleteConfirm = async () => {\r\n    if (!deletingMember) return\r\n\r\n    setIsDeleting(true)\r\n    try {\r\n      const response = await fetch(`${apiEndpoint}/${deletingMember.id}`, {\r\n        method: 'DELETE',\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const data = await response.json()\r\n        throw new Error(data.error || 'Failed to delete member')\r\n      }\r\n\r\n      toast.success('Member removed successfully')\r\n      setDeleteDialogOpen(false)\r\n      setDeletingMember(null)\r\n      await loadMembers()\r\n      onDataChange?.()\r\n    } catch (err) {\r\n      console.error('Error deleting member:', err)\r\n      toast.error(err instanceof Error ? err.message : 'Failed to delete member')\r\n    } finally {\r\n      setIsDeleting(false)\r\n    }\r\n  }\r\n\r\n  const handleDialogSuccess = () => {\r\n    loadMembers()\r\n    onDataChange?.()\r\n  }\r\n\r\n  const getDisplayName = (member: EntityMember) => {\r\n    if (member.full_name) return member.full_name\r\n    const parts = [member.first_name, member.middle_name, member.last_name, member.name_suffix].filter(Boolean)\r\n    return parts.length > 0 ? parts.join(' ') : 'Unknown'\r\n  }\r\n\r\n  const getRoleBadge = (role: string) => {\r\n    const roleColors: Record<string, string> = {\r\n      director: 'bg-blue-500',\r\n      shareholder: 'bg-purple-500',\r\n      beneficial_owner: 'bg-amber-500',\r\n      ubo: 'bg-amber-500',\r\n      authorized_signatory: 'bg-green-500',\r\n      signatory: 'bg-green-500',\r\n      trustee: 'bg-indigo-500',\r\n      general_partner: 'bg-cyan-500',\r\n      limited_partner: 'bg-teal-500',\r\n    }\r\n    const color = roleColors[role] || 'bg-gray-500'\r\n    return <Badge className={color}>{ROLE_LABELS[role] || role}</Badge>\r\n  }\r\n\r\n  const getKYCStatusBadge = (status?: string) => {\r\n    switch (status) {\r\n      case 'approved':\r\n        return (\r\n          <Badge className=\"bg-green-500\">\r\n            <CheckCircle className=\"w-3 h-3 mr-1\" />\r\n            Approved\r\n          </Badge>\r\n        )\r\n      case 'pending':\r\n        return (\r\n          <Badge className=\"bg-yellow-500\">\r\n            <Clock className=\"w-3 h-3 mr-1\" />\r\n            Pending\r\n          </Badge>\r\n        )\r\n      case 'submitted':\r\n        return (\r\n          <Badge className=\"bg-blue-500\">\r\n            <ShieldCheck className=\"w-3 h-3 mr-1\" />\r\n            Submitted\r\n          </Badge>\r\n        )\r\n      case 'rejected':\r\n        return (\r\n          <Badge className=\"bg-red-500\">\r\n            <XCircle className=\"w-3 h-3 mr-1\" />\r\n            Rejected\r\n          </Badge>\r\n        )\r\n      case 'expired':\r\n        return (\r\n          <Badge className=\"bg-orange-500\">\r\n            <FileWarning className=\"w-3 h-3 mr-1\" />\r\n            Expired\r\n          </Badge>\r\n        )\r\n      default:\r\n        return (\r\n          <Badge variant=\"outline\" className=\"text-muted-foreground\">\r\n            <AlertCircle className=\"w-3 h-3 mr-1\" />\r\n            Not Submitted\r\n          </Badge>\r\n        )\r\n    }\r\n  }\r\n\r\n  // Check if ID is expiring soon (within 30 days)\r\n  const isIdExpiringSoon = (member: EntityMember) => {\r\n    if (!member.id_expiry_date) return false\r\n    const expiryDate = new Date(member.id_expiry_date)\r\n    const today = new Date()\r\n    const daysUntilExpiry = Math.ceil((expiryDate.getTime() - today.getTime()) / (1000 * 60 * 60 * 24))\r\n    return daysUntilExpiry <= 30 && daysUntilExpiry > 0\r\n  }\r\n\r\n  // Check if ID is expired\r\n  const isIdExpired = (member: EntityMember) => {\r\n    if (!member.id_expiry_date) return false\r\n    const expiryDate = new Date(member.id_expiry_date)\r\n    return expiryDate < new Date()\r\n  }\r\n\r\n  // Convert member data to form format for MemberKYCEditDialog\r\n  const getMemberInitialData = (member: EntityMember | null) => {\r\n    if (!member) return undefined\r\n\r\n    return {\r\n      role: member.role as 'director' | 'ubo' | 'signatory' | 'authorized_representative' | 'beneficiary',\r\n      first_name: member.first_name || '',\r\n      middle_name: member.middle_name || '',\r\n      last_name: member.last_name || '',\r\n      name_suffix: member.name_suffix || '',\r\n      date_of_birth: member.date_of_birth || '',\r\n      country_of_birth: member.country_of_birth || '',\r\n      nationality: member.nationality || '',\r\n      email: member.email || '',\r\n      phone_mobile: member.phone_mobile || '',\r\n      phone_office: member.phone_office || '',\r\n      residential_street: member.residential_street || '',\r\n      residential_line_2: member.residential_line_2 || '',\r\n      residential_city: member.residential_city || '',\r\n      residential_state: member.residential_state || '',\r\n      residential_postal_code: member.residential_postal_code || '',\r\n      residential_country: member.residential_country || '',\r\n      is_us_citizen: member.is_us_citizen || false,\r\n      is_us_taxpayer: member.is_us_taxpayer || false,\r\n      us_taxpayer_id: member.us_taxpayer_id || '',\r\n      country_of_tax_residency: member.country_of_tax_residency || '',\r\n      tax_id_number: member.tax_id_number || '',\r\n      id_type: member.id_type || '',\r\n      id_number: member.id_number || '',\r\n      id_issue_date: member.id_issue_date || '',\r\n      id_expiry_date: member.id_expiry_date || '',\r\n      id_issuing_country: member.id_issuing_country || '',\r\n      ownership_percentage: member.ownership_percentage,\r\n    }\r\n  }\r\n\r\n  // Summary stats\r\n  const totalUBOs = members.filter(m => m.is_beneficial_owner || m.role === 'ubo' || m.role === 'beneficial_owner').length\r\n  const totalSignatories = members.filter(m => m.is_signatory || m.can_sign || m.role === 'signatory' || m.role === 'authorized_signatory').length\r\n  const totalOwnership = members.reduce((sum, m) => sum + (m.ownership_percentage || 0), 0)\r\n  const pendingKYC = members.filter(m => !m.kyc_status || m.kyc_status === 'pending' || m.kyc_status === 'submitted').length\r\n  const expiredDocs = members.filter(m => isIdExpired(m)).length\r\n\r\n  if (loading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"py-12 text-center\">\r\n          <div className=\"animate-pulse\">Loading members...</div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"py-12 text-center\">\r\n          <AlertCircle className=\"w-12 h-12 mx-auto text-destructive mb-4\" />\r\n          <p className=\"text-destructive\">{error}</p>\r\n          <Button onClick={loadMembers} variant=\"outline\" className=\"mt-4\">\r\n            Retry\r\n          </Button>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Summary Stats */}\r\n      {members.length > 0 && (\r\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n          <Card>\r\n            <CardContent className=\"py-4\">\r\n              <div className=\"text-sm text-muted-foreground\">Total Members</div>\r\n              <div className=\"text-2xl font-bold\">{members.length}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardContent className=\"py-4\">\r\n              <div className=\"text-sm text-muted-foreground\">UBOs</div>\r\n              <div className=\"text-2xl font-bold\">{totalUBOs}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardContent className=\"py-4\">\r\n              <div className=\"text-sm text-muted-foreground\">Signatories</div>\r\n              <div className=\"text-2xl font-bold\">{totalSignatories}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardContent className=\"py-4\">\r\n              <div className=\"text-sm text-muted-foreground\">Total Ownership</div>\r\n              <div className=\"text-2xl font-bold flex items-center\">\r\n                {totalOwnership.toFixed(1)}%\r\n                {totalOwnership > 100 && (\r\n                  <TooltipProvider>\r\n                    <Tooltip>\r\n                      <TooltipTrigger>\r\n                        <AlertCircle className=\"w-4 h-4 ml-2 text-amber-500\" />\r\n                      </TooltipTrigger>\r\n                      <TooltipContent>Ownership exceeds 100%</TooltipContent>\r\n                    </Tooltip>\r\n                  </TooltipProvider>\r\n                )}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardContent className=\"py-4\">\r\n              <div className=\"text-sm text-muted-foreground\">Pending KYC</div>\r\n              <div className={`text-2xl font-bold ${pendingKYC > 0 ? 'text-amber-500' : 'text-green-500'}`}>\r\n                {pendingKYC}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      )}\r\n\r\n      {/* Expired/Expiring Documents Warning */}\r\n      {expiredDocs > 0 && (\r\n        <Card className=\"border-red-200 bg-red-50\">\r\n          <CardContent className=\"py-4\">\r\n            <div className=\"flex items-center gap-2 text-red-700\">\r\n              <FileWarning className=\"w-5 h-5\" />\r\n              <span className=\"font-medium\">\r\n                {expiredDocs} member{expiredDocs > 1 ? 's have' : ' has'} expired ID documents\r\n              </span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Members Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <Users className=\"h-5 w-5\" />\r\n                {title}\r\n              </CardTitle>\r\n              <CardDescription>{description}</CardDescription>\r\n            </div>\r\n            <Button onClick={handleAddMember}>\r\n              <UserPlus className=\"w-4 h-4 mr-2\" />\r\n              Add Member\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {members.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <Users className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\r\n              <p className=\"text-muted-foreground mb-4\">\r\n                No members added yet. Add directors, shareholders, or beneficial owners.\r\n              </p>\r\n              <Button onClick={handleAddMember} variant=\"outline\">\r\n                <UserPlus className=\"w-4 h-4 mr-2\" />\r\n                Add First Member\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Name</TableHead>\r\n                  <TableHead>Role</TableHead>\r\n                  <TableHead>Ownership</TableHead>\r\n                  <TableHead>Email</TableHead>\r\n                  <TableHead>KYC Status</TableHead>\r\n                  <TableHead>ID Expiry</TableHead>\r\n                  <TableHead className=\"text-right\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {members.map((member) => (\r\n                  <TableRow key={member.id}>\r\n                    <TableCell className=\"font-medium\">\r\n                      <div className=\"flex flex-col\">\r\n                        <span>{getDisplayName(member)}</span>\r\n                        <div className=\"flex gap-1 mt-1\">\r\n                          {(member.is_beneficial_owner || member.role === 'ubo' || member.role === 'beneficial_owner') && (\r\n                            <Badge variant=\"secondary\" className=\"text-xs\">UBO</Badge>\r\n                          )}\r\n                          {(member.is_signatory || member.can_sign) && (\r\n                            <Badge variant=\"secondary\" className=\"text-xs\">Signatory</Badge>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"flex flex-col gap-1\">\r\n                        {getRoleBadge(member.role)}\r\n                        {member.role_title && (\r\n                          <span className=\"text-xs text-muted-foreground\">{member.role_title}</span>\r\n                        )}\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {member.ownership_percentage != null ? (\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <Percent className=\"w-3 h-3 text-muted-foreground\" />\r\n                          <span>{member.ownership_percentage}%</span>\r\n                        </div>\r\n                      ) : (\r\n                        <span className=\"text-muted-foreground\">—</span>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {member.email || <span className=\"text-muted-foreground\">—</span>}\r\n                    </TableCell>\r\n                    <TableCell>{getKYCStatusBadge(member.kyc_status)}</TableCell>\r\n                    <TableCell>\r\n                      {member.id_expiry_date ? (\r\n                        <div className=\"flex items-center gap-1\">\r\n                          {isIdExpired(member) ? (\r\n                            <Badge variant=\"destructive\" className=\"text-xs\">\r\n                              <XCircle className=\"w-3 h-3 mr-1\" />\r\n                              Expired\r\n                            </Badge>\r\n                          ) : isIdExpiringSoon(member) ? (\r\n                            <Badge className=\"bg-amber-500 text-xs\">\r\n                              <AlertCircle className=\"w-3 h-3 mr-1\" />\r\n                              Expiring Soon\r\n                            </Badge>\r\n                          ) : (\r\n                            <span className=\"text-sm\">\r\n                              {new Date(member.id_expiry_date).toLocaleDateString()}\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      ) : (\r\n                        <span className=\"text-muted-foreground text-sm\">—</span>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right\">\r\n                      <div className=\"flex items-center justify-end gap-2\">\r\n                        <TooltipProvider>\r\n                          <Tooltip>\r\n                            <TooltipTrigger asChild>\r\n                              <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleEditMember(member)}\r\n                              >\r\n                                <Edit className=\"w-4 h-4\" />\r\n                              </Button>\r\n                            </TooltipTrigger>\r\n                            <TooltipContent>Edit Member</TooltipContent>\r\n                          </Tooltip>\r\n                        </TooltipProvider>\r\n                        <TooltipProvider>\r\n                          <Tooltip>\r\n                            <TooltipTrigger asChild>\r\n                              <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleDeleteClick(member)}\r\n                              >\r\n                                <Trash2 className=\"w-4 h-4\" />\r\n                              </Button>\r\n                            </TooltipTrigger>\r\n                            <TooltipContent>Remove Member</TooltipContent>\r\n                          </Tooltip>\r\n                        </TooltipProvider>\r\n                      </div>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Edit/Add Member Dialog */}\r\n      <MemberKYCEditDialog\r\n        open={editDialogOpen}\r\n        onOpenChange={setEditDialogOpen}\r\n        entityType={entityType}\r\n        entityId={entityId}\r\n        memberId={editingMember?.id}\r\n        memberName={editingMember ? getDisplayName(editingMember) : undefined}\r\n        initialData={getMemberInitialData(editingMember)}\r\n        apiEndpoint={apiEndpoint}\r\n        onSuccess={handleDialogSuccess}\r\n        mode={editingMember ? 'edit' : 'create'}\r\n      />\r\n\r\n      {/* Delete Confirmation Dialog */}\r\n      <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Remove Member</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Are you sure you want to remove <strong>{deletingMember ? getDisplayName(deletingMember) : 'this member'}</strong>?\r\n              <br /><br />\r\n              This will mark the member as inactive. The record will be preserved for audit purposes.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel disabled={isDeleting}>Cancel</AlertDialogCancel>\r\n            <AlertDialogAction\r\n              onClick={handleDeleteConfirm}\r\n              disabled={isDeleting}\r\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n            >\r\n              {isDeleting ? 'Removing...' : 'Remove Member'}\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"wEAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAOA,EAAA,EAAA,CAAA,CAAA,QAQA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,MAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAgDA,IAAM,EAA6D,CACjE,SAAU,CACR,CAAE,MAAO,+BAAgC,MAAO,8BAA+B,EAC/E,CAAE,MAAO,uCAAwC,MAAO,qBAAsB,EAC9E,CAAE,MAAO,gCAAiC,MAAO,4BAA6B,EAC9E,CAAE,MAAO,uCAAwC,MAAO,cAAe,EACvE,CAAE,MAAO,iCAAkC,MAAO,4BAA6B,EAC/E,CAAE,MAAO,8BAA+B,MAAO,iBAAkB,EACjE,CAAE,MAAO,2BAA4B,MAAO,WAAY,EACzD,CACD,WAAY,CACV,CAAE,MAAO,uBAAwB,MAAO,sBAAuB,EAC/D,CAAE,MAAO,uBAAwB,MAAO,sBAAuB,EAC/D,CAAE,MAAO,mBAAoB,MAAO,kBAAmB,EACxD,CACD,SAAU,CACR,CAAE,MAAO,+BAAgC,MAAO,8BAA+B,EAC/E,CAAE,MAAO,0CAA2C,MAAO,oBAAqB,EAChF,CAAE,MAAO,mCAAoC,MAAO,uBAAwB,EAC5E,CAAE,MAAO,0BAA2B,MAAO,YAAa,EACxD,CAAE,MAAO,8BAA+B,MAAO,sBAAuB,EACtE,CAAE,MAAO,mCAAoC,MAAO,sBAAuB,EAC3E,CAAE,MAAO,8BAA+B,MAAO,kBAAmB,EACnE,CACD,OAAQ,CACN,CAAE,MAAO,+BAAgC,MAAO,kBAAmB,EACnE,CAAE,MAAO,mCAAoC,MAAO,wBAAyB,EAC7E,CAAE,MAAO,oBAAqB,MAAO,mBAAoB,EACzD,CAAE,MAAO,mBAAoB,MAAO,kBAAmB,EACxD,CACD,QAAS,CACP,CAAE,MAAO,4BAA6B,MAAO,2BAA4B,EACzE,CAAE,MAAO,+BAAgC,MAAO,8BAA+B,EAC/E,CAAE,MAAO,mCAAoC,MAAO,sBAAuB,EAC3E,CAAE,MAAO,8BAA+B,MAAO,iBAAkB,EACjE,CAAE,MAAO,YAAa,MAAO,WAAY,EAC1C,CACD,mBAAoB,CAClB,CAAE,MAAO,+BAAgC,MAAO,8BAA+B,EAC/E,CAAE,MAAO,qBAAsB,MAAO,oBAAqB,EAC3D,CAAE,MAAO,mCAAoC,MAAO,uBAAwB,EAC5E,CAAE,MAAO,0BAA2B,MAAO,YAAa,EACxD,CAAE,MAAO,wBAAyB,MAAO,uBAAwB,EAClE,AACH,EAGM,EAAgD,CACpD,CAAE,MAAO,qCAAsC,MAAO,WAAY,EAClE,CAAE,MAAO,mBAAoB,MAAO,yBAA0B,EAC/D,CAiBM,SAAS,EAAgB,YAC9B,CAAU,UACV,CAAQ,YACR,CAAU,UACV,GAAW,CAAK,CAChB,UAAQ,CACR,YAAU,SACV,EAAU,EAAE,qBACZ,GAAsB,CAAK,CACN,EACrB,GAAM,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,EAAE,EACnD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MACpD,EAAgB,CAAA,EAAA,EAAA,MAAA,AAAM,EAA6C,CAAC,GAGpE,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnD,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAwB,MAC5D,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,MACpD,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,IAC3D,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,IACnD,CAAC,EAAoB,EAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,IAC/D,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC7C,CAAC,GAAgB,GAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/C,CAAC,GAAiB,GAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiD,MAEjG,GAAoB,CAAkB,CAAC,EAAW,EAAI,EAAE,CAExD,GAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UACjC,GAAK,CAAD,EAEJ,EAAW,IACX,CAHe,EAGX,CAWF,IAAM,EARuC,AAQ3B,CAPhB,SAAU,oBACV,SAAU,qBACV,WAAY,gBACZ,OAAQ,YACR,QAAS,aACT,mBAAoB,uBACtB,CAC8B,CAAC,EAAW,EAAI,CAAA,EAAG,EAAW,GAAG,CAAC,CAC1D,EAAW,MAAM,MAAM,CAAC,eAAe,EAAE,EAAU,CAAC,EAAE,EAAS,UAAU,CAAC,EAChF,GAAI,CAAC,EAAS,EAAE,CAAE,MAAM,AAAI,MAAM,6BAElC,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAa,EAAK,SAAS,EAAI,EAAE,CACnC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,4BAA6B,GAC3C,EAAA,KAAK,CAAC,KAAK,CAAC,2BACd,QAAU,CACR,EAAW,GACb,EACF,EAAG,CAAC,EAAU,EAAW,EAEzB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IACF,EAAG,CAAC,GAAe,EAgBnB,IAAM,GAAe,MAAO,EAAY,KACtC,GAAK,CAAD,EAIJ,GAAI,EAAK,EAJM,EAIF,CADG,EACA,GADK,KACI,EADG,UAE1B,EAAA,KAAK,CAAC,KAAK,CAAC,gCAcd,GAAI,CATiB,AAShB,CARH,kBACA,0EACA,qBACA,aACA,YACA,aACD,CAEiB,QAAQ,CAAC,EAAK,IAAI,EAAG,YACrC,EAAA,KAAK,CAAC,KAAK,CAAC,2EAKd,GAAI,CAAA,EAAA,EAAA,YAAY,AAAZ,EAAa,IAAiB,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,GAAe,YAtClE,EAuCmB,GAtCnB,EAsCyB,GArCzB,EAAgB,EAFF,EAGd,EAAsB,IAFL,AAGjB,EAAiB,IACjB,GAAkB,IAClB,GAAmB,MACnB,EAAoB,GAAY,IAChC,GAAoB,GAoCpB,OAAM,GAAc,EAAM,EAAc,GAAI,GAAI,IAAI,EAAO,IAC7D,EAGM,GAAgB,MACpB,EACA,EACA,EACA,EACA,EACA,EACA,KAEA,EAAa,GACb,GAAmB,MAEnB,GAAI,CACF,IAAM,EAAW,IAAI,SACrB,EAAS,MAAM,CAAC,OAAQ,GACxB,EAAS,MAAM,CAAC,OAAQ,GACxB,EAAS,MAAM,CAAC,OAAQ,EAAK,IAAI,CAAC,OAAO,CAAC,YAAa,KAGvD,CAH4D,GAGtD,EAA2B,aAAf,CAH6D,CAGjC,qBAAuB,CAAA,EAAG,EAAW,GAAG,CAAC,CAIvF,GAHA,EAAS,MAAM,CAAC,EAAW,GAGvB,EAAgB,CAClB,IAAM,EAAkB,CAAA,EAAG,EAAW,UAAU,CAAC,CACjD,EAAS,MAAM,CAAC,EAAiB,EACnC,CAGI,GACF,EAAS,IADE,EACI,CAAC,gBAAiB,GAE/B,GACF,EAAS,MAAM,CAAC,AADF,uBAC0B,GAEtC,IACF,EAAS,IADG,EACG,CAAC,iBAAkB,QAClC,EAAS,MAAM,CAAC,kBAAmB,IAGrC,IAAM,EAAW,MAAM,MAAM,wBAAyB,CACpD,OAAQ,OACR,KAAM,CACR,GAEM,EAAO,MAAM,EAAS,IAAI,GAEhC,GAAI,CAAC,EAAS,EAAE,CAAE,CAEhB,GAAwB,MAApB,EAAS,MAAM,EAAY,EAAK,UAAU,EAAE,YAAa,YAC3D,GAAmB,CACjB,MAAO,EAAK,KAAK,CACjB,aAAa,CACf,EAGF,OAAM,AAAI,MAAM,EAAK,KAAK,EAAI,gBAChC,CAEA,IAAM,EAAe,GAAkB,IAAI,CAAC,GAAK,EAAE,KAAK,GAAK,IAAe,OAC1E,EAA0B,IAAI,CAAC,GAAK,EAAE,KAAK,GAAK,IAAe,OAC/D,EACF,EAAA,KAAK,CAAC,OAAO,CAAC,CAAA,EAAG,EAAa,sBAAsB,CAAC,EAGrD,GAAoB,GACpB,MAAM,IACR,CAAE,MAAO,EAAY,CACnB,QAAQ,KAAK,CAAC,gBAAiB,GAC/B,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,4BAC/B,QAAU,CACR,EAAa,MAET,EAAc,OAAO,CAAC,EAAa,EAAE,CACvC,EAAc,OAAO,CAAC,EAAa,CAAE,KAAK,CAAG,EAAA,CAEjD,CACF,EAgBM,GAAe,MAAO,IAC1B,GAAK,CAAD,OAAS,CAAC,QAAQ,EAAE,EAAS,IAAI,CAAC,gCAAgC,CAAC,EAIvE,CAJ0E,EAItE,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,qBAAqB,EAAE,EAAS,EAAE,CAAA,CAAE,CAAE,CAClE,OAAQ,QACV,GAEA,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAQ,MAAM,EAAS,IAAI,EACjC,OAAM,AAAI,MAAM,EAAM,KAAK,EAAI,gBACjC,CAEA,EAAA,KAAK,CAAC,OAAO,CAAC,iCAGd,MAAM,IACR,CAAE,MAAO,EAAY,CACnB,QAAQ,KAAK,CAAC,gBAAiB,GAC/B,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,4BAC/B,CACF,EAEM,GAAiB,MAAO,IAC5B,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,eAAe,EAAE,EAAI,EAAE,CAAC,SAAS,CAAC,EAEhE,GAAI,CAAC,EAAS,EAAE,CACd,CADgB,KACV,AAAI,MAAM,mBAGlB,IAAM,EAAO,MAAM,EAAS,IAAI,GAC1B,EAAM,OAAO,GAAG,CAAC,eAAe,CAAC,GACjC,EAAI,SAAS,aAAa,CAAC,IACjC,GAAE,IAAI,CAAG,EACT,EAAE,QAAQ,CAAG,EAAI,SAAS,EAAI,EAAI,IAAI,CACtC,SAAS,IAAI,CAAC,WAAW,CAAC,GAC1B,EAAE,KAAK,GACP,OAAO,GAAG,CAAC,eAAe,CAAC,GAC3B,SAAS,IAAI,CAAC,WAAW,CAAC,GAE1B,EAAA,KAAK,CAAC,OAAO,CAAC,sBAChB,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,kBAAmB,GACjC,EAAA,KAAK,CAAC,KAAK,CAAC,8BACd,CACF,EAEM,GAAiB,AAAC,GACjB,AAAL,EACI,EAAQ,AADR,GAAQ,EACa,CAAP,AAAO,EAAG,EAAM,EAAE,CAAC,CACjC,EAAQ,OAAO,CAAa,CAAA,EAAG,CAAC,CAAX,CAAmB,IAAA,CAAI,CAAE,OAAO,CAAC,GAAG,GAAG,CAAC,CAC1D,CAAA,EAAG,CAAC,EAAS,MAAD,CAAQ,AAAI,CAAC,CAAE,OAAO,CAAC,GAAG,GAAG,CAAC,CAH9B,eAMf,GAAgB,EAAU,MAAM,CAAC,GAAK,GAAkB,IAAI,CAAC,GAAO,EAAI,KAAK,GAAK,EAAE,IAAI,GAAG,MAAM,CACjG,GAAuB,GAAkB,MAAM,CAAG,EACpD,KAAK,KAAK,CAAE,GAAgB,GAAkB,MAAM,CAAI,KACxD,EA8CJ,MACE,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WAEA,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAM,EAAkB,aAAc,WAC5C,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,aAAa,CAAA,CAAC,UAAU,wBACvB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,YAAY,CAAA,WACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UAAC,oBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,iBAAiB,CAAA,WACf,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,GAAiB,KAAO,+DACrC,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,GAAiB,KAAO,iEAI9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BAEZ,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8DACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,kCACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,wCAAgC,EAAW,IAAI,GAC5D,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAiC,GAAe,EAAW,IAAI,UAMjF,EAAQ,MAAM,CAAG,GAChB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,UAAC,qCACP,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAkB,cAAe,YAC9C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,UACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,YAAY,4BAE3B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,aAAa,CAAA,WACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,YAAG,0BACpB,EAAQ,GAAG,CAAC,GACX,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,CAAiB,MAAO,EAAO,EAAE,WAzC5D,AAAI,EAAO,SAAS,CAAS,CAAP,CAAc,SAAS,CACzC,EAAO,UAAU,EAAI,EAAO,SAAS,CAAS,CAAP,AAAO,EAAG,EAAO,UAAU,CAAC,CAAC,EAAE,EAAO,SAAS,CAAA,CAAE,CAyC3D,AAxC1B,EAAO,EAAE,CAAC,KAAK,CAAC,EAAG,GAwCe,KAAG,EAAO,IAAI,CAAC,MADvB,EAAO,EAAE,YAUnC,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,GAAiB,KACjC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,0BAAgB,iBACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wBAAe,SAE/C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,gBACH,KAAK,OACL,MAAO,EACP,SAAU,AAAC,GAAM,EAAgB,EAAE,MAAM,CAAC,KAAK,EAC/C,IAAK,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,GAE7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,iFAOhD,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,GAAiB,KAC7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,wBAAc,wBACN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wBAAe,SAEtD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,cACH,KAAK,OACL,MAAO,EACP,SAAW,AAAD,GAAO,EAAsB,EAAE,MAAM,CAAC,KAAK,EACrD,IAAK,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,GAE7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,4CAOhD,IACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4EACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CAAC,UAAU,8CACzB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,gCAAwB,GAAgB,KAAK,MAG3D,GAAgB,WAAW,EAC1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,GAAG,iBACH,QAAS,EACT,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,OAAO,EAClD,UAAU,YAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAiB,UAAU,mBAAU,wCAIrD,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACP,YAAY,+BACZ,MAAO,GACP,SAAU,AAAC,GAAM,GAAkB,EAAE,MAAM,CAAC,KAAK,EACjD,UAAU,0BASxB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,YAAY,CAAA,WACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,GAAoB,YAAQ,WAGrE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAnPiB,CAmPR,IAlPZ,GAAe,GACpB,GACE,EACA,EACA,CAJiB,CAKjB,EACA,CANiC,CAOjC,EACA,GAEJ,EAyOU,SACE,IAAc,GACb,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,GAAiB,KAAO,CAAC,GACtC,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,GAAiB,KAAO,CAAC,GAC1C,IAAiB,aAAe,GAAiB,CAAC,aAGpD,IAAc,EACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,8BAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,iBAClB,oBAMV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,gBACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,kBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACb,EAAa,CAAC,yBAAyB,EAAE,EAAA,CAAY,CAAG,sDAG7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+CACZ,GAAc,IAAE,GAAkB,MAAM,IAE3C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0CACZ,GAAqB,wBAK9B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UAEV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,gCAAgC,EACjB,MAAzB,GAA+B,eAC/B,IAAwB,GAAK,gBAAkB,aAAA,CAC/C,CACF,MAAO,CAAE,MAAO,CAAA,EAAG,GAAqB,CAAC,CAAC,AAAC,WAOnD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,qBAAY,uBACjC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAC,kEAInB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACT,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,iDAGrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,GAAkB,GAAG,CAAE,AAAD,IACrB,IAAM,EAAW,EAAU,IAAI,CAAC,GAAK,EAAE,IAAI,GAAK,EAAQ,KAAK,EACvD,EAAc,IAAc,EAAQ,KAAK,CAE/C,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAU,mIAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACZ,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAU,yCAExB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,gDAEpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,wDAAgD,EAAQ,KAAK,GACzE,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,mDACV,EAAS,SAAS,CAAC,MAAI,GAAe,EAAS,eAAe,WAMvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDAEZ,GAAY,CAtQH,AAAC,IAE7B,GAAI,EAAI,oBAAoB,CAAE,CAC5B,IAAM,EAAa,IAAI,KAAK,EAAI,oBAAoB,EAC9C,EAAQ,IAAI,KACZ,EAAkB,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAY,GAErD,GAAI,EAAkB,EACpB,CADuB,KAErB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,qDACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YAAY,aAIlC,GAAI,GAAmB,GAC5B,CADgC,KAE9B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,yDACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,YAChB,CAAA,EAAA,EAAA,qBAAA,AAAqB,EAAC,KAI/B,QAGA,AAAI,EAAI,iBAAiB,EAA8B,SAAS,CAAnC,EAAI,iBAAiB,CAE9C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAW,CAAA,EAAG,CAAA,EAAA,EAAA,wBAAA,AAAwB,EAAC,EAAI,iBAAiB,EAAE,QAAQ,CAAC,UAC3E,CAAA,EAAA,EAAA,wBAAA,AAAwB,EAAC,EAAI,iBAAiB,IAK9C,IACT,GAoOuD,GAElC,EACC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,GAAe,GAC9B,UAAU,uBAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,cAErB,CAAC,GACA,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,GAAa,GAC5B,UAAU,uDAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,iBAItB,CAAC,GACH,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,IAAK,AAAC,IAAS,EAAc,OAAO,CAAC,EAAQ,KAAK,CAAC,CAAG,CAAG,EACzD,KAAK,OACL,UAAU,SACV,OAAO,uCACP,SAAU,AAAC,IACT,IAAM,EAAO,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,AAC5B,IAAM,GAAa,EAAM,EAAQ,KAAK,CAC5C,EACA,SAAU,IAEZ,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,KAAK,KACL,QAAS,IAAM,EAAc,OAAO,CAAC,EAAQ,KAAK,CAAC,EAAE,QACrD,SAAU,YAET,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,8BAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,iBAClB,oBAnEL,EAAQ,KAAK,CA2ExB,UAOP,EAAU,MAAM,CAAC,GAAK,CAAC,GAAkB,IAAI,CAAC,GAAO,EAAI,KAAK,GAAK,EAAE,IAAI,GAAG,MAAM,CAAG,GACpF,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,qBAAY,yBACjC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAC,gDAInB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EACE,MAAM,CAAC,GAAK,CAAC,GAAkB,IAAI,CAAC,GAAO,EAAI,KAAK,GAAK,EAAE,IAAI,GAC/D,GAAG,CAAC,AAAC,GACJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAU,4GAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,gDACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,wDAAgD,EAAI,IAAI,GACrE,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,mDACV,EAAI,SAAS,CAAC,MAAI,GAAe,EAAI,eAAe,WAI3D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,GAAe,GAC9B,UAAU,uBAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,cAErB,CAAC,GACA,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,GAAa,GAC5B,UAAU,uDAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,mBA5BnB,EAAI,EAAE,UAwCzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kFACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,uDACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,uCACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,8DACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,gDACF,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,iBAAmB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,iDACnC,CAAA,EAAA,EAAA,gBAAgB,AAAhB,EAAiB,qBAAuB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,sEAKpD,uCCrxBA,IAAA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OA6BA,IAAM,EAAa,CACjB,CAAE,MAAO,MAAO,MAAO,iBAAkB,EACzC,CAAE,MAAO,MAAO,MAAO,YAAa,EACpC,CAAE,MAAO,MAAO,MAAO,qBAAsB,EAC7C,CAAE,MAAO,MAAO,MAAO,mBAAoB,EAC3C,CAAE,MAAO,MAAO,MAAO,oBAAqB,EAC5C,CAAE,MAAO,MAAO,MAAO,uBAAwB,EAC/C,CAAE,MAAO,MAAO,MAAO,yBAA0B,EACjD,CAAE,MAAO,MAAO,MAAO,wBAAyB,EAChD,CAAE,MAAO,MAAO,MAAO,wBAAyB,EACjD,CAEK,EAAkB,CACtB,UAAW,GACX,oBAAqB,GACrB,eAAgB,GAChB,eAAgB,GAChB,UAAW,GACX,KAAM,GACN,SAAU,MACV,YAAY,EACZ,MAAO,EACT,EAEO,SAAS,EAAe,CAAE,YAAU,UAAE,CAAQ,YAAE,CAAU,UAAE,GAAW,CAAK,CAAuB,EACxG,GAAM,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAe,EAAE,EACzD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/B,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MACpD,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAEnC,EAAmB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UACnC,GAAK,CAAD,EAEJ,GAAW,GACX,CAHe,EAGX,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,oCAAoC,EAAE,EAAW,WAAW,EAAE,EAAA,CAAU,EACtG,GAAI,CAAC,EAAS,EAAE,CAAE,MAAM,AAAI,MAAM,gCAElC,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAe,EAAK,WAAW,EAAI,EAAE,CACvC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,+BAAgC,GAC9C,EAAA,KAAK,CAAC,KAAK,CAAC,8BACd,QAAU,CACR,GAAW,EACb,EACF,EAAG,CAAC,EAAU,EAAW,EAEzB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GACF,EAAG,CAAC,EAAiB,EAErB,IAAM,EAAe,UACnB,GAAI,CAAC,EAAS,SAAS,CAAC,IAAI,IAAM,CAAC,EAAS,mBAAmB,CAAC,IAAI,GAAI,YACtE,EAAA,KAAK,CAAC,KAAK,CAAC,kDAId,GAAU,GACV,GAAI,CACF,IAAM,EAAM,EACR,CAAC,wBAAwB,EAAE,EAAA,CAAW,CACtC,0BAEE,EAAW,MAAM,MAAM,EAAK,CAChC,OAAQ,EAAY,QAAU,OAC9B,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CACnB,GAAG,CAAQ,CACX,YAAa,EACb,UAAW,CACb,EACF,GAEA,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAQ,MAAM,EAAS,IAAI,EACjC,OAAM,AAAI,MAAM,EAAM,KAAK,EAAI,8BACjC,CAEA,EAAA,KAAK,CAAC,OAAO,CAAC,EAAY,uBAAyB,sBACnD,GAAc,GACd,EAAa,MACb,EAAY,GACZ,MAAM,GACR,CAAE,MAAO,EAAY,CACnB,QAAQ,KAAK,CAAC,cAAe,GAC7B,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,8BAC/B,QAAU,CACR,GAAU,EACZ,CACF,EAkBM,EAAe,MAAO,IAC1B,GAAK,CAAD,OAAS,2DAIb,CAJyE,EAIrE,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,wBAAwB,EAAE,EAAA,CAAI,CAAE,CAC5D,OAAQ,QACV,GAEA,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAQ,MAAM,EAAS,IAAI,EACjC,OAAM,AAAI,MAAM,EAAM,KAAK,EAAI,gBACjC,CAEA,EAAA,KAAK,CAAC,OAAO,CAAC,wBACd,MAAM,GACR,CAAE,MAAO,EAAY,CACnB,QAAQ,KAAK,CAAC,gBAAiB,GAC/B,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,gCAC/B,CACF,EAEM,EAAmB,MAAO,IAC9B,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,wBAAwB,EAAE,EAAA,CAAI,CAAE,CAC5D,OAAQ,QACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CAAE,YAAY,CAAK,EAC1C,GAEA,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAQ,MAAM,EAAS,IAAI,EACjC,OAAM,AAAI,MAAM,EAAM,KAAK,EAAI,2BACjC,CAEA,EAAA,KAAK,CAAC,OAAO,CAAC,gCACd,MAAM,GACR,CAAE,MAAO,EAAY,CACnB,QAAQ,KAAK,CAAC,qBAAsB,GACpC,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,mCAC/B,CACF,EAEM,EAAgB,KACpB,EAAa,MACb,EAAY,GACZ,GAAc,EAChB,EAEM,EAAiB,EAAY,IAAI,CAAC,GAAK,EAAE,UAAU,EAEzD,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,gBACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,iBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACb,EAAa,CAAC,kBAAkB,EAAE,EAAA,CAAY,CAAG,sEAGrD,CAAC,GACA,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAM,EAAY,aAAc,YACtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CAAC,OAAO,CAAA,CAAA,WACpB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAS,YACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,mBAIrC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,aAAa,CAAA,CAAC,UAAU,qBACvB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,YAAY,CAAA,WACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UAAE,EAAY,oBAAsB,qBAChD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,UACf,EAAY,8BAAgC,8CAIjD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,qBAAY,gBAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,YACH,MAAO,EAAS,SAAS,CACzB,SAAU,AAAC,GAAM,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,UAAW,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,EAC5E,YAAY,4BAGhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,oBAAW,aAC1B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAS,QAAQ,CACxB,cAAe,AAAC,GAAU,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,SAAU,EAAM,CAAC,YAE3E,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,UACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAA,KAEd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,UACX,EAAW,GAAG,CAAC,GACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAkB,MAAO,EAAK,KAAK,UAC3C,EAAK,KAAK,EADI,EAAK,KAAK,cASrC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,+BAAsB,0BACrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,sBACH,MAAO,EAAS,mBAAmB,CACnC,SAAU,AAAC,GAAM,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,oBAAqB,EAAE,MAAM,CAAC,KAAK,AAAC,CAAC,GACtF,YAAY,2BAIhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,0BAAiB,mBAChC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,iBACH,MAAO,EAAS,cAAc,CAC9B,SAAW,AAAD,GAAO,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,eAAgB,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,EACjF,YAAY,sBAGhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,0BAAiB,+BAChC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,iBACH,MAAO,EAAS,cAAc,CAC9B,SAAU,AAAC,GAAM,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,eAAgB,EAAE,MAAM,CAAC,KAAK,AAAC,CAAC,GACjF,YAAY,4BAKlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,qBAAY,mBAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,YACH,MAAO,EAAS,SAAS,CACzB,SAAW,AAAD,GAAO,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,UAAW,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,EAC5E,YAAY,sBAGhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,gBAAO,SACtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,OACH,MAAO,EAAS,IAAI,CACpB,SAAW,AAAD,GAAO,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,KAAM,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,EACvE,YAAY,4BAKlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAQ,UACvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACP,GAAG,QACH,MAAO,EAAS,KAAK,CACrB,SAAU,AAAC,GAAM,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,MAAO,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,EACxE,YAAY,sCACZ,KAAM,OAIV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,GAAG,aACH,QAAS,EAAS,UAAU,CAC5B,gBAAiB,AAAC,GAAY,EAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,WAAY,EAAQ,CAAC,IAErF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,aAAa,UAAU,mBAAU,iCAIpD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,YAAY,CAAA,WACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,GAAc,GAAQ,SAAU,WAAQ,WAGjF,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAS,EAAc,SAAU,YACtC,GAAU,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,8BAC7B,EAAY,SAAW,iCAWvC,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,2CACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,gBACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,sCAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,qBAAY,yBAGrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,cAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,+BAAuB,EAAe,SAAS,MAE9D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,mBAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,+BAAuB,EAAe,mBAAmB,MAExE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,aAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,+BAAuB,EAAe,QAAQ,MAE5D,EAAe,IAAI,EAClB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,SAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAiC,EAAe,IAAI,cAS7E,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,qBAAY,sBACjC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,eAAe,CAAA,WACb,EAAY,MAAM,CAAC,WAAgC,IAAvB,EAAY,MAAM,CAAS,IAAM,GAAG,iBAGrE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACT,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,iDAEI,IAAvB,EAAY,MAAM,CACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uEACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,yCACrB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,+BAC5C,CAAC,GACA,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,UAAU,OAAO,QAAS,YAClD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,0BAMvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAY,GAAG,CAAC,AAAC,GAChB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAW,CAAC,+EAA+E,EACzF,EAAK,UAAU,CAAG,iCAAmC,mCAAA,CACrD,WAEF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,uDACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,+CAAuC,EAAK,SAAS,GACjE,EAAK,UAAU,EACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uEAA8D,YAIhF,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,8EACb,EAAK,QAAQ,MAGlB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAiC,EAAK,mBAAmB,GACtE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+DACZ,EAAK,cAAc,EAClB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,eAAa,EAAK,cAAc,CAAC,KAAK,CAAC,CAAC,MAE/C,EAAK,SAAS,EACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,UAAQ,EAAK,SAAS,IAE7B,EAAK,IAAI,EACR,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,sBAAY,SAAO,EAAK,IAAI,CAAC,KAAK,CAAC,EAAG,GAAG,MAAI,EAAK,IAAI,CAAC,KAAK,CAAC,CAAC,eAMrF,CAAC,GACA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACZ,CAAC,EAAK,UAAU,EACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,EAAiB,EAAK,EAAE,EACvC,UAAU,cACV,MAAM,0BAEN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,cAGpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,CAvUnC,EAAa,EAAW,EAAE,EAC1B,EAAY,CACV,UAAW,EAAW,SAAS,CAC/B,oBAAqB,AAoUuB,EApUZ,mBAAmB,CACnD,eAAgB,EAAW,cAAc,EAAI,GAC7C,eAAgB,EAAW,cAAc,EAAI,GAC7C,UAAW,EAAW,SAAS,EAAI,GACnC,KAAM,EAAW,IAAI,EAAI,GACzB,SAAU,EAAW,QAAQ,CAC7B,WAAY,EAAW,UAAU,CACjC,MAAO,EAAW,KAAK,EAAI,EAC7B,GACA,GAAc,IA4TM,UAAU,uBAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,cAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,EAAa,EAAK,EAAE,EACnC,UAAU,uDAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,mBA7DnB,EAAK,EAAE,UAyExB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kFACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,sEACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,+DACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,2DACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,qDAIX,sCC/dA,IAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAIA,EAAA,EAAA,CAAA,CAAA,QAQA,EAAA,EAAA,CAAA,CAAA,QAWA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAMA,IAAM,EAA2D,CAC/D,SAAU,YACV,QAAS,WACT,WAAY,cACZ,OAAQ,UACR,SAAU,YACV,mBAAoB,qBACtB,EAgEM,EAAsC,CAC1C,SAAU,WACV,YAAa,cACb,iBAAkB,mBAClB,qBAAsB,uBACtB,QAAS,UACT,QAAS,UACT,IAAK,MACL,UAAW,YACX,0BAA2B,4BAC3B,YAAa,cACb,QAAS,UACT,gBAAiB,kBACjB,gBAAiB,kBACjB,gBAAiB,kBACjB,MAAO,OACT,EAEO,SAAS,EAAsB,YACpC,CAAU,UACV,CAAQ,YACR,CAAU,OACV,EAAQ,gBAAgB,aACxB,EAAc,oEAAoE,cAClF,CAAY,CACe,EAC3B,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiB,EAAE,EACnD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAG5C,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/C,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAsB,MAClE,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnD,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAsB,MACpE,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAGvC,EAAU,CAAuB,CAAC,EAAW,CAC7C,EAAc,CAAC,WAAW,EAAE,EAAQ,CAAC,EAAE,EAAS,QAAQ,CAAC,CAGzD,EAAc,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UAC9B,GAAW,GACX,EAAS,MAET,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,GAC7B,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAO,MAAM,EAAS,IAAI,EAChC,OAAM,AAAI,MAAM,EAAK,KAAK,EAAI,yBAChC,CAEA,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAW,EAAK,OAAO,EAAI,EAAE,CAC/B,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,yBAA0B,GACxC,EAAS,aAAe,MAAQ,EAAI,OAAO,CAAG,yBAChD,QAAU,CACR,GAAW,EACb,CACF,EAAG,CAAC,EAAY,EAEhB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GACF,EAAG,CAAC,EAAY,EAEhB,IAAM,EAAkB,KACtB,EAAiB,MACjB,GAAkB,EACpB,EAYM,EAAsB,UAC1B,GAAK,CAAD,EAEJ,GAAc,GACd,GAAI,CACF,GAJmB,CAIb,EAAW,MAAM,MAAM,CAAA,EAAG,EAAY,CAAC,EAAE,EAAe,EAAE,CAAA,CAAE,CAAE,CAClE,OAAQ,QACV,GAEA,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAO,MAAM,EAAS,IAAI,EAChC,OAAM,AAAI,MAAM,EAAK,KAAK,EAAI,0BAChC,CAEA,EAAA,KAAK,CAAC,OAAO,CAAC,+BACd,GAAoB,GACpB,EAAkB,MAClB,MAAM,IACN,KACF,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,yBAA0B,GACxC,EAAA,KAAK,CAAC,KAAK,CAAC,aAAe,MAAQ,EAAI,OAAO,CAAG,0BACnD,QAAU,CACR,GAAc,EAChB,EACF,EAOM,EAAiB,AAAC,IACtB,GAAI,EAAO,SAAS,CAAE,OAAO,EAAO,SAAS,CAC7C,IAAM,EAAQ,CAAC,EAAO,UAAU,CAAE,EAAO,WAAW,CAAE,EAAO,SAAS,CAAE,EAAO,WAAW,CAAC,CAAC,MAAM,CAAC,SACnG,OAAO,EAAM,MAAM,CAAG,EAAI,EAAM,IAAI,CAAC,KAAO,SAC9C,EA2EM,EAAc,AAAC,GACnB,CAAI,CAAC,EAAO,cAAc,EAAE,AAErB,AADY,IAAI,GADY,EACP,EAAO,cAAc,EAC7B,IAAI,KAwCpB,EAAY,EAAQ,MAAM,CAAC,GAAK,EAAE,mBAAmB,EAAe,QAAX,EAAE,IAAI,EAAyB,qBAAX,EAAE,IAAI,EAAyB,MAAM,CAClH,EAAmB,EAAQ,MAAM,CAAC,GAAK,EAAE,YAAY,EAAI,EAAE,QAAQ,EAAe,cAAX,EAAE,IAAI,EAA+B,yBAAX,EAAE,IAAI,EAA6B,MAAM,CAC1I,GAAiB,EAAQ,MAAM,CAAC,CAAC,EAAK,IAAM,GAAO,EAAE,CAAH,mBAAuB,GAAI,CAAC,CAAG,GACjF,GAAa,EAAQ,MAAM,CAAC,GAAK,CAAC,EAAE,UAAU,EAAqB,YAAjB,EAAE,UAAU,EAAkB,AAAiB,gBAAf,UAAU,EAAkB,MAAM,CACpH,GAAc,EAAQ,MAAM,CAAC,GAAK,EAAY,IAAI,MAAM,QAE9D,AAAI,EAEA,CAAA,EAAA,EAAA,EAFS,CAET,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,6BACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBAAgB,2BAMnC,EAEA,CAAA,EAAA,EAAA,AAFO,GAEP,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,8BACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,4CACvB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4BAAoB,IACjC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAS,EAAa,QAAQ,UAAU,UAAU,gBAAO,eASvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEZ,EAAQ,MAAM,CAAG,GAChB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCAAgC,kBAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8BAAsB,EAAQ,MAAM,QAGvD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCAAgC,SAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8BAAsB,SAGzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCAAgC,gBAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8BAAsB,SAGzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCAAgC,oBAC/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iDACZ,GAAe,OAAO,CAAC,GAAG,IAC1B,GAAiB,KAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,OAAO,CAAA,WACN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,UACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,kCAEzB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,UAAC,wCAO5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCAAgC,gBAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,mBAAmB,EAAE,GAAa,EAAI,iBAAmB,iBAAA,CAAkB,UACzF,aAQV,GAAc,GACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,oCACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,gBACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACvB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,wBACb,GAAY,UAAQ,GAAc,EAAI,SAAW,OAAO,kCAQnE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,UACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,oCACnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,YAChB,KAEH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAE,OAEpB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAS,YACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,iBAAiB,qBAK3C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACU,IAAnB,EAAQ,MAAM,CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,iDACjB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,6EAG1C,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAS,EAAiB,QAAQ,oBACxC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,iBAAiB,yBAKzC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,WACJ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACV,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,WACP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,SACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,SACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,cACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,UACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,eACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,cACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,sBAAa,iBAGtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACP,EAAQ,GAAG,CAAC,AAAC,gBACZ,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,WACP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,uBACnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAe,KACtB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACZ,CAAC,EAAO,mBAAmB,EAAoB,QAAhB,EAAO,IAAI,EAA8B,qBAAhB,EAAO,IAAI,AAAK,CAAkB,EACzF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,YAAY,UAAU,mBAAU,QAEhD,CAAC,EAAO,YAAY,EAAI,EAAO,QAAA,AAAQ,GACtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,YAAY,UAAU,mBAAU,sBAKvD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCA/Qb,EAgRc,EAAO,IAAI,CAnQtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UADA,AAX6B,CAYlB,AAXvB,SAAU,cACV,YAAa,gBACb,iBAAkB,eAClB,IAAK,eACL,qBAAsB,eACtB,UAAW,eACX,QAAS,gBACT,gBAAiB,cACjB,gBAAiB,aACnB,CACwB,CAAC,EAAK,EAAI,uBACD,CAAW,CAAC,EAAK,EAAI,KAoQjC,EAAO,UAAU,EAChB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yCAAiC,EAAO,UAAU,QAIxE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACwB,MAA/B,EAAO,oBAAoB,CAC1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,kCACnB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAM,EAAO,oBAAoB,CAAC,UAGrC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iCAAwB,QAG5C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACP,EAAO,KAAK,EAAI,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iCAAwB,QAE3D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAE,CAnRJ,AAAC,IACzB,OAAQ,GACN,IAAK,WACH,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,yBACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBAAiB,aAI9C,KAAK,UACH,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0BACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,iBAAiB,YAIxC,KAAK,YACH,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,wBACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBAAiB,cAI9C,KAAK,WACH,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,uBACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,iBAAiB,aAI1C,KAAK,UACH,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0BACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBAAiB,YAI9C,SACE,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,UAAU,kCACjC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBAAiB,kBAIhD,CACF,GAsOgD,EAAO,UAAU,IAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACP,EAAO,cAAc,CACpB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mCACZ,EAAY,GACX,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,cAAc,UAAU,oBACrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,iBAAiB,aAGpC,CA5OH,AAAC,IACxB,GAAI,CAAC,EAAO,cAAc,CAAE,OAAO,EACnC,IAAM,EAAa,IAAI,KAAK,EAAO,cAAc,EAC3C,EAAQ,IAAI,KACZ,EAAkB,KAAK,IAAI,CAAC,CAAC,EAAW,OAAO,GAAK,EAAM,OAAO,EAAA,CAAE,CAAK,GAAD,IAC7E,AADqF,KAAK,EACnF,GADwF,AACrE,EADuE,EACjE,EAAkB,EACpD,EAsO6C,GACnB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,iCACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBAAiB,mBAI1C,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mBACb,IAAI,KAAK,EAAO,cAAc,EAAE,kBAAkB,OAKzD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yCAAgC,QAGpD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,sBACnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,OAAO,CAAA,WACN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CAAC,OAAO,CAAA,CAAA,WACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,KAAK,KACL,QAAS,IAAM,CAlX3C,EAkX4D,GAjX5D,GAAkB,SADD,IAoXW,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,gBAGpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,UAAC,qBAGpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,OAAO,CAAA,WACN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CAAC,OAAO,CAAA,CAAA,WACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,KAAK,KACL,QAAS,IAAM,CA3X3C,EA2X6D,GA1X7D,GAAoB,UADF,GA6XU,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,gBAGtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,UAAC,8BAtFX,EAAO,EAAE,cAoGpC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,mBAAmB,CAAA,CAClB,KAAM,EACN,aAAc,EACd,WAAY,EACZ,SAAU,EACV,SAAU,GAAe,GACzB,WAAY,EAAgB,EAAe,QAAiB,EAC5D,YAAa,CA3RW,AAAD,IAC3B,GAAK,CAAD,CAEJ,MAAO,AAFM,CAGX,KAAM,CAHY,CAGL,IAAI,CACjB,WAAY,EAAO,UAAU,EAAI,GACjC,YAAa,EAAO,WAAW,EAAI,GACnC,UAAW,EAAO,SAAS,EAAI,GAC/B,YAAa,EAAO,WAAW,EAAI,GACnC,cAAe,EAAO,aAAa,EAAI,GACvC,iBAAkB,EAAO,gBAAgB,EAAI,GAC7C,YAAa,EAAO,WAAW,EAAI,GACnC,MAAO,EAAO,KAAK,EAAI,GACvB,aAAc,EAAO,YAAY,EAAI,GACrC,aAAc,EAAO,YAAY,EAAI,GACrC,mBAAoB,EAAO,kBAAkB,EAAI,GACjD,mBAAoB,EAAO,kBAAkB,EAAI,GACjD,iBAAkB,EAAO,gBAAgB,EAAI,GAC7C,kBAAmB,EAAO,iBAAiB,EAAI,GAC/C,wBAAyB,EAAO,uBAAuB,EAAI,GAC3D,oBAAqB,EAAO,mBAAmB,EAAI,GACnD,cAAe,EAAO,aAAa,GAAI,EACvC,eAAgB,EAAO,cAAc,GAAI,EACzC,eAAgB,EAAO,cAAc,EAAI,GACzC,yBAA0B,EAAO,wBAAwB,EAAI,GAC7D,cAAe,EAAO,aAAa,EAAI,GACvC,QAAS,EAAO,OAAO,EAAI,GAC3B,UAAW,EAAO,SAAS,EAAI,GAC/B,cAAe,EAAO,aAAa,EAAI,GACvC,eAAgB,EAAO,cAAc,EAAI,GACzC,mBAAoB,EAAO,kBAAkB,EAAI,GACjD,qBAAsB,EAAO,oBAAoB,AACnD,CACF,GA0PwC,GAClC,YAAa,EACb,UAxXsB,CAwXX,IAvXf,IACA,KACF,EAsXM,KAAM,EAAgB,OAAS,WAIjC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,KAAM,EAAkB,aAAc,WACjD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,kBAAkB,CAAA,WACjB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,iBAAiB,CAAA,WAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,UAAC,kBAClB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,sBAAsB,CAAA,WAAC,mCACU,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAQ,EAAiB,EAAe,GAAkB,gBAAuB,IAClH,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAA,GAAK,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAA,GAAK,gGAIhB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,iBAAiB,CAAA,WAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,CAAC,SAAU,WAAY,WACzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,CAChB,QAAS,EACT,SAAU,EACV,UAAU,8EAET,EAAa,cAAgB,4BAO5C"}