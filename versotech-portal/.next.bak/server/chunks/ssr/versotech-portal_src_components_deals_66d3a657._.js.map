{"version":3,"sources":["../../../../../versotech-portal/src/components/deals/submit-subscription-form.tsx","../../../../../versotech-portal/src/components/subscriptions/entity-selector.tsx","../../../../../versotech-portal/src/components/deals/interest-modal.tsx","../../../../../versotech-portal/src/components/deals/subscribe-now-dialog.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Checkbox } from '@/components/ui/checkbox'\r\nimport { Card, CardContent } from '@/components/ui/card'\r\nimport { Loader2, CheckCircle2, AlertTriangle, TrendingUp } from 'lucide-react'\r\nimport { EntitySelector } from '@/components/subscriptions/entity-selector'\r\nimport { Alert, AlertDescription } from '@/components/ui/alert'\r\nimport { Progress } from '@/components/ui/progress'\r\n\r\ninterface DealCapacityInfo {\r\n  target_raise: number | null\r\n  min_ticket: number | null\r\n  max_ticket: number | null\r\n  total_subscribed: number\r\n  subscription_count: number\r\n}\r\n\r\ninterface SubmitSubscriptionFormProps {\r\n  dealId: string\r\n  currency: string\r\n  existingSubmission: {\r\n    id: string\r\n    status: string\r\n    submitted_at: string\r\n    payload_json: Record<string, any>\r\n  } | null\r\n}\r\n\r\nexport function SubmitSubscriptionForm({ dealId, currency, existingSubmission }: SubmitSubscriptionFormProps) {\r\n  const [amount, setAmount] = useState('')\r\n  const [bankConfirmation, setBankConfirmation] = useState(false)\r\n  const [notes, setNotes] = useState('')\r\n  const [entitySelection, setEntitySelection] = useState<{\r\n    subscription_type: 'personal' | 'entity'\r\n    counterparty_entity_id?: string | null\r\n  }>({\r\n    subscription_type: 'personal',\r\n    counterparty_entity_id: null\r\n  })\r\n  const [isSubmitting, setIsSubmitting] = useState(false)\r\n  const [feedback, setFeedback] = useState<string | null>(null)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [dealCapacity, setDealCapacity] = useState<DealCapacityInfo | null>(null)\r\n  const [loadingCapacity, setLoadingCapacity] = useState(true)\r\n\r\n  // Fetch deal capacity information\r\n  useEffect(() => {\r\n    async function fetchDealCapacity() {\r\n      try {\r\n        const response = await fetch(`/api/deals/${dealId}/capacity`)\r\n        if (response.ok) {\r\n          const data = await response.json()\r\n          setDealCapacity(data)\r\n        }\r\n      } catch (err) {\r\n        console.error('Failed to fetch deal capacity:', err)\r\n      } finally {\r\n        setLoadingCapacity(false)\r\n      }\r\n    }\r\n    fetchDealCapacity()\r\n  }, [dealId])\r\n\r\n  // Calculate subscription metrics\r\n  const subscriptionPercentage = dealCapacity?.target_raise\r\n    ? (dealCapacity.total_subscribed / dealCapacity.target_raise) * 100\r\n    : 0\r\n  const isOversubscribed = subscriptionPercentage > 100\r\n  const remainingCapacity = dealCapacity?.target_raise\r\n    ? Math.max(0, dealCapacity.target_raise - dealCapacity.total_subscribed)\r\n    : null\r\n\r\n  // Format currency amounts\r\n  const formatAmount = (value: number) => {\r\n    return new Intl.NumberFormat('en-US', {\r\n      style: 'currency',\r\n      currency: currency,\r\n      minimumFractionDigits: 0,\r\n      maximumFractionDigits: 0,\r\n    }).format(value)\r\n  }\r\n\r\n  // Only lock form during pending review to prevent duplicate submissions\r\n  // Allow new submissions after approval/rejection (follow-on investments, entity changes)\r\n  const isLocked = existingSubmission && existingSubmission.status === 'pending_review'\r\n\r\n  const handleSubmit = async (event: React.FormEvent) => {\r\n    event.preventDefault()\r\n    if (isLocked) return\r\n\r\n    setIsSubmitting(true)\r\n    setFeedback(null)\r\n    setError(null)\r\n\r\n    try {\r\n      const numericAmount = parseFloat(amount)\r\n      if (!numericAmount || Number.isNaN(numericAmount) || numericAmount <= 0) {\r\n        setError('Enter a valid subscription amount.')\r\n        setIsSubmitting(false)\r\n        return\r\n      }\r\n\r\n      // Validate entity selection if entity type is chosen\r\n      if (entitySelection.subscription_type === 'entity' && !entitySelection.counterparty_entity_id) {\r\n        setError('Please select an entity or create one to invest through an entity.')\r\n        setIsSubmitting(false)\r\n        return\r\n      }\r\n\r\n      const response = await fetch(`/api/deals/${dealId}/subscriptions`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          payload: {\r\n            amount: numericAmount,\r\n            currency,\r\n            bank_confirmation: bankConfirmation,\r\n            notes: notes.trim() || null\r\n          },\r\n          subscription_type: entitySelection.subscription_type,\r\n          counterparty_entity_id: entitySelection.counterparty_entity_id || null\r\n        })\r\n      })\r\n\r\n      const data = await response.json()\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to submit subscription')\r\n      }\r\n\r\n      setFeedback('Subscription submitted for review. The VERSO team will follow up shortly.')\r\n      setAmount('')\r\n      setBankConfirmation(false)\r\n      setNotes('')\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Unexpected error submitting subscription')\r\n    } finally {\r\n      setIsSubmitting(false)\r\n    }\r\n  }\r\n\r\n  if (isLocked) {\r\n    const submittedAt = existingSubmission?.submitted_at\r\n      ? new Date(existingSubmission.submitted_at).toLocaleString()\r\n      : 'Recently'\r\n\r\n    return (\r\n      <Card className=\"border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20\">\r\n        <CardContent className=\"py-4 text-sm text-muted-foreground space-y-2\">\r\n          <div className=\"flex items-center gap-2 text-amber-700 dark:text-amber-300\">\r\n            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n            Subscription under review\r\n          </div>\r\n          <p>Submitted on {submittedAt}. The VERSO team is reviewing your request.</p>\r\n          <p className=\"text-xs text-muted-foreground\">\r\n            You&apos;ll be notified once a decision is made. Contact your relationship manager if you need to make urgent changes.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  // Validate amount against deal limits (non-blocking)\r\n  const numericAmount = parseFloat(amount)\r\n  const amountWarnings = []\r\n  if (!isNaN(numericAmount) && numericAmount > 0) {\r\n    if (dealCapacity?.min_ticket && numericAmount < dealCapacity.min_ticket) {\r\n      amountWarnings.push(`Below minimum investment of ${formatAmount(dealCapacity.min_ticket)}`)\r\n    }\r\n    if (dealCapacity?.max_ticket && numericAmount > dealCapacity.max_ticket) {\r\n      amountWarnings.push(`Above maximum investment of ${formatAmount(dealCapacity.max_ticket)}`)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n      {/* Deal Capacity Display */}\r\n      {!loadingCapacity && dealCapacity && dealCapacity.target_raise && (\r\n        <Card className={isOversubscribed ? \"border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20\" : \"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20\"}>\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"text-sm font-medium text-foreground\">Deal Progress</span>\r\n                <span className=\"text-sm font-bold text-foreground\">\r\n                  {subscriptionPercentage.toFixed(1)}% subscribed\r\n                </span>\r\n              </div>\r\n\r\n              <Progress\r\n                value={Math.min(subscriptionPercentage, 100)}\r\n                className={isOversubscribed ? \"bg-orange-200 dark:bg-orange-800\" : \"bg-blue-200 dark:bg-blue-800\"}\r\n              />\r\n\r\n              <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                <span>{formatAmount(dealCapacity.total_subscribed)} committed</span>\r\n                <span>Target: {formatAmount(dealCapacity.target_raise)}</span>\r\n              </div>\r\n\r\n              {isOversubscribed && (\r\n                <Alert className=\"border-orange-300 bg-orange-100\">\r\n                  <TrendingUp className=\"h-4 w-4\" />\r\n                  <AlertDescription className=\"text-xs\">\r\n                    This deal is oversubscribed by {(subscriptionPercentage - 100).toFixed(1)}%.\r\n                    You can still submit your interest, but allocation is not guaranteed.\r\n                  </AlertDescription>\r\n                </Alert>\r\n              )}\r\n\r\n              {dealCapacity.min_ticket && dealCapacity.max_ticket && (\r\n                <div className=\"text-xs text-muted-foreground pt-1 border-t border-border\">\r\n                  Investment range: {formatAmount(dealCapacity.min_ticket)} - {formatAmount(dealCapacity.max_ticket)}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      <EntitySelector\r\n        value={entitySelection}\r\n        onChange={setEntitySelection}\r\n      />\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor={`subscription-amount-${dealId}`} className=\"text-base font-semibold\">\r\n          Subscription Amount ({currency})\r\n        </Label>\r\n        <Input\r\n          id={`subscription-amount-${dealId}`}\r\n          type=\"number\"\r\n          min=\"0\"\r\n          step=\"0.01\"\r\n          value={amount}\r\n          onChange={event => setAmount(event.target.value)}\r\n          placeholder=\"e.g. 250000\"\r\n          className=\"text-foreground text-lg h-12\"\r\n        />\r\n\r\n        {/* Amount validation warnings */}\r\n        {amountWarnings.length > 0 && (\r\n          <Alert className=\"mt-2 border-yellow-300 bg-yellow-50\">\r\n            <AlertTriangle className=\"h-4 w-4 text-yellow-600\" />\r\n            <AlertDescription className=\"text-xs text-yellow-800\">\r\n              {amountWarnings.join('. ')}. You may still submit, but staff review is required.\r\n            </AlertDescription>\r\n          </Alert>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label className=\"text-base font-semibold\">Bank & Compliance</Label>\r\n        <div className=\"flex items-start space-x-3 rounded-md border-2 border-border px-4 py-3 bg-muted\">\r\n          <Checkbox\r\n            id={`bank-confirmation-${dealId}`}\r\n            checked={bankConfirmation}\r\n            onCheckedChange={checked => setBankConfirmation(Boolean(checked))}\r\n            className=\"mt-0.5\"\r\n          />\r\n          <Label htmlFor={`bank-confirmation-${dealId}`} className=\"text-sm text-foreground font-normal cursor-pointer leading-relaxed\">\r\n            I confirm my bank/KYC documentation is ready for the subscription pack.\r\n          </Label>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor={`subscription-notes-${dealId}`} className=\"text-base font-semibold\">Additional Notes (optional)</Label>\r\n        <Textarea\r\n          id={`subscription-notes-${dealId}`}\r\n          value={notes}\r\n          onChange={event => setNotes(event.target.value)}\r\n          rows={3}\r\n          placeholder=\"Share wiring preferences, co-investor details, or other information for the VERSO team.\"\r\n          className=\"text-foreground\"\r\n        />\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"text-sm text-red-600 font-medium bg-red-50 p-3 rounded-md border border-red-200\">{error}</div>\r\n      )}\r\n      {feedback && (\r\n        <div className=\"text-sm text-emerald-600 font-medium bg-emerald-50 p-3 rounded-md border border-emerald-200\">{feedback}</div>\r\n      )}\r\n\r\n      <Button\r\n        type=\"submit\"\r\n        disabled={isSubmitting}\r\n        className=\"w-full h-14 text-lg font-bold bg-blue-600 hover:bg-blue-700 text-white gap-2 shadow-md\"\r\n      >\r\n        {isSubmitting && <Loader2 className=\"h-5 w-5 animate-spin\" />}\r\n        Submit Subscription Request\r\n      </Button>\r\n    </form>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Label } from '@/components/ui/label'\r\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Plus, Building2, User } from 'lucide-react'\r\nimport { toast } from 'sonner'\r\nimport { EntityFormDialog } from '@/components/profile/entity-form-dialog'\r\n\r\ninterface CounterpartyEntity {\r\n  id: string\r\n  entity_type: string\r\n  legal_name: string\r\n  jurisdiction?: string\r\n  representative_name?: string\r\n}\r\n\r\ninterface EntitySelectorProps {\r\n  value: {\r\n    subscription_type: 'personal' | 'entity'\r\n    counterparty_entity_id?: string | null\r\n  }\r\n  onChange: (value: {\r\n    subscription_type: 'personal' | 'entity'\r\n    counterparty_entity_id?: string | null\r\n  }) => void\r\n}\r\n\r\nexport function EntitySelector({ value, onChange }: EntitySelectorProps) {\r\n  const [entities, setEntities] = useState<CounterpartyEntity[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [formDialogOpen, setFormDialogOpen] = useState(false)\r\n\r\n  useEffect(() => {\r\n    loadEntities()\r\n  }, [])\r\n\r\n  const loadEntities = async () => {\r\n    try {\r\n      const response = await fetch('/api/investors/me/counterparty-entities')\r\n      if (!response.ok) throw new Error('Failed to load entities')\r\n\r\n      const data = await response.json()\r\n      setEntities(data.entities || [])\r\n    } catch (error) {\r\n      console.error('Error loading entities:', error)\r\n      toast.error('Failed to load entities')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleTypeChange = (type: 'personal' | 'entity') => {\r\n    onChange({\r\n      subscription_type: type,\r\n      counterparty_entity_id: type === 'personal' ? null : value.counterparty_entity_id\r\n    })\r\n  }\r\n\r\n  const handleEntityChange = (entityId: string) => {\r\n    onChange({\r\n      subscription_type: 'entity',\r\n      counterparty_entity_id: entityId\r\n    })\r\n  }\r\n\r\n  const handleFormSuccess = async () => {\r\n    setFormDialogOpen(false)\r\n    await loadEntities()\r\n  }\r\n\r\n  const getEntityTypeBadge = (type: string) => {\r\n    const typeLabels: Record<string, string> = {\r\n      trust: 'Trust',\r\n      llc: 'LLC',\r\n      partnership: 'Partnership',\r\n      family_office: 'Family Office',\r\n      law_firm: 'Law Firm',\r\n      investment_bank: 'Investment Bank',\r\n      fund: 'Fund',\r\n      corporation: 'Corporation',\r\n      other: 'Other'\r\n    }\r\n    return typeLabels[type] || type\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"space-y-3\">\r\n        <Label className=\"text-base font-medium\">Investment Type</Label>\r\n        <RadioGroup\r\n          value={value.subscription_type}\r\n          onValueChange={(val) => handleTypeChange(val as 'personal' | 'entity')}\r\n          className=\"space-y-3\"\r\n        >\r\n          <div className=\"flex items-center space-x-3 rounded-lg border p-4 hover:bg-muted transition-colors\">\r\n            <RadioGroupItem value=\"personal\" id=\"personal\" />\r\n            <Label htmlFor=\"personal\" className=\"flex-1 cursor-pointer\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <User className=\"w-4 h-4\" />\r\n                <span className=\"font-medium\">Invest Personally</span>\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground mt-1\">\r\n                Subscribe using your personal investor profile\r\n              </p>\r\n            </Label>\r\n          </div>\r\n\r\n          <div className=\"flex items-center space-x-3 rounded-lg border p-4 hover:bg-muted transition-colors\">\r\n            <RadioGroupItem value=\"entity\" id=\"entity\" />\r\n            <Label htmlFor=\"entity\" className=\"flex-1 cursor-pointer\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Building2 className=\"w-4 h-4\" />\r\n                <span className=\"font-medium\">Invest Through Entity</span>\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground mt-1\">\r\n                Subscribe through a legal entity (trust, LLC, partnership, etc.)\r\n              </p>\r\n            </Label>\r\n          </div>\r\n        </RadioGroup>\r\n      </div>\r\n\r\n      {value.subscription_type === 'entity' && (\r\n        <div className=\"space-y-3 pl-8 border-l-2 border-primary/20\">\r\n          <Label htmlFor=\"entity-select\">Select Entity</Label>\r\n          {loading ? (\r\n            <div className=\"text-sm text-muted-foreground\">Loading entities...</div>\r\n          ) : entities.length === 0 ? (\r\n            <div className=\"space-y-3\">\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                You haven't added any entities yet. Create one to invest through a legal entity.\r\n              </p>\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                onClick={() => setFormDialogOpen(true)}\r\n              >\r\n                <Plus className=\"w-4 h-4 mr-2\" />\r\n                Create Entity\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              <Select\r\n                value={value.counterparty_entity_id || ''}\r\n                onValueChange={handleEntityChange}\r\n              >\r\n                <SelectTrigger id=\"entity-select\" className=\"bg-background text-foreground border-border\">\r\n                  <SelectValue placeholder=\"Select an entity\" />\r\n                </SelectTrigger>\r\n                <SelectContent className=\"bg-background text-foreground border-border\">\r\n                  {entities.map((entity) => (\r\n                    <SelectItem key={entity.id} value={entity.id} className=\"text-foreground focus:bg-muted focus:text-foreground\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-medium\">{entity.legal_name}</span>\r\n                        <span className=\"text-xs text-muted-foreground/70\">\r\n                          ({getEntityTypeBadge(entity.entity_type)})\r\n                        </span>\r\n                      </div>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setFormDialogOpen(true)}\r\n              >\r\n                <Plus className=\"w-4 h-4 mr-2\" />\r\n                Add New Entity\r\n              </Button>\r\n\r\n              {value.counterparty_entity_id && (\r\n                <div className=\"rounded-lg bg-muted border border-border p-3\">\r\n                  {(() => {\r\n                    const selectedEntity = entities.find(\r\n                      (e) => e.id === value.counterparty_entity_id\r\n                    )\r\n                    if (!selectedEntity) return null\r\n\r\n                    return (\r\n                      <div className=\"space-y-1 text-sm\">\r\n                        <div className=\"font-medium text-foreground\">{selectedEntity.legal_name}</div>\r\n                        <div className=\"text-muted-foreground\">\r\n                          Type: {getEntityTypeBadge(selectedEntity.entity_type)}\r\n                        </div>\r\n                        {selectedEntity.jurisdiction && (\r\n                          <div className=\"text-muted-foreground\">\r\n                            Jurisdiction: {selectedEntity.jurisdiction}\r\n                          </div>\r\n                        )}\r\n                        {selectedEntity.representative_name && (\r\n                          <div className=\"text-muted-foreground\">\r\n                            Representative: {selectedEntity.representative_name}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )\r\n                  })()}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      <EntityFormDialog\r\n        open={formDialogOpen}\r\n        onClose={() => setFormDialogOpen(false)}\r\n        onSuccess={handleFormSuccess}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n","'use client'\n\nimport { useCallback, useState } from 'react'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\nimport { Loader2, CheckCircle2, Sparkles } from 'lucide-react'\n\ninterface InterestModalProps {\n  dealId: string\n  dealName: string\n  currency?: string | null\n  investorId: string\n  defaultAmount?: number | null\n  isClosed?: boolean\n  onSubmitted?: () => Promise<void> | void\n  children: React.ReactNode\n}\n\nexport function InterestModal({\n  dealId,\n  dealName,\n  currency,\n  investorId,\n  defaultAmount,\n  isClosed = false,\n  onSubmitted,\n  children\n}: InterestModalProps) {\n  const [open, setOpen] = useState(false)\n  const [indicativeAmount, setIndicativeAmount] = useState(\n    defaultAmount ? defaultAmount.toString() : ''\n  )\n  const [notes, setNotes] = useState('')\n  const [submitting, setSubmitting] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [success, setSuccess] = useState(false)\n\n  const resetState = useCallback(() => {\n    setIndicativeAmount(defaultAmount ? defaultAmount.toString() : '')\n    setNotes('')\n    setSubmitting(false)\n    setError(null)\n    setSuccess(false)\n  }, [defaultAmount])\n\n  const handleOpenChange = (nextOpen: boolean) => {\n    setOpen(nextOpen)\n    if (!nextOpen) {\n      resetState()\n    }\n  }\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault()\n    setSubmitting(true)\n    setError(null)\n\n    try {\n      const parsedAmount = indicativeAmount.trim()\n      const payload: Record<string, unknown> = {\n        investor_id: investorId,\n        notes: notes.trim() || undefined\n      }\n\n      if (parsedAmount) {\n        const numericAmount = Number(parsedAmount.replace(/[^0-9.]/g, ''))\n        if (Number.isFinite(numericAmount) && numericAmount > 0) {\n          payload.indicative_amount = numericAmount\n          if (currency) {\n            payload.indicative_currency = currency\n          }\n        } else {\n          throw new Error('Enter a valid indicative amount or leave the field blank.')\n        }\n      }\n\n      if (isClosed) {\n        payload.is_post_close = true\n      }\n\n      const response = await fetch(`/api/deals/${dealId}/interests`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      })\n\n      if (!response.ok) {\n        const body = await response.json().catch(() => ({}))\n        throw new Error(body?.error || 'Unable to submit interest right now.')\n      }\n\n      setSuccess(true)\n      if (onSubmitted) {\n        await onSubmitted()\n      }\n\n      setTimeout(() => {\n        setOpen(false)\n        resetState()\n      }, 1500)\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Unexpected error'\n      setError(message)\n    } finally {\n      setSubmitting(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={handleOpenChange}>\n      <DialogTrigger asChild>{children}</DialogTrigger>\n      <DialogContent className=\"max-w-lg\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Sparkles className=\"h-5 w-5 text-blue-600\" />\n            {isClosed ? \"Notify Me About Similar Deals\" : \"Submit Interest for Data Room\"}\n          </DialogTitle>\n          <DialogDescription>\n            {isClosed\n              ? `Let the VERSO team know you're interested in similar opportunities to ${dealName}. We'll notify you when comparable deals become available.`\n              : `Submit your interest to access the data room for ${dealName}. Once approved, you'll receive the NDA to sign.`\n            }\n          </DialogDescription>\n        </DialogHeader>\n\n        {success ? (\n          <div className=\"flex flex-col items-center justify-center py-10 text-center\">\n            <CheckCircle2 className=\"h-12 w-12 text-green-500 mb-4\" />\n            <p className=\"text-lg font-semibold text-green-700\">\n              Interest submitted\n            </p>\n            <p className=\"text-sm text-green-600\">\n              We&apos;ll notify you as soon as the team responds.\n            </p>\n          </div>\n        ) : (\n          <form className=\"space-y-5\" onSubmit={handleSubmit}>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"indicative-amount\">\n                Indicative amount or range\n              </Label>\n              <Input\n                id=\"indicative-amount\"\n                placeholder={`e.g. ${currency ?? ''} 250k`}\n                value={indicativeAmount}\n                onChange={(event) => setIndicativeAmount(event.target.value)}\n                inputMode=\"decimal\"\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Optional â€” helps the team size the allocation. You can share a single number or range.\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"interest-notes\">Notes for the team</Label>\n              <Textarea\n                id=\"interest-notes\"\n                placeholder=\"Add any context or questions you'd like the team to review.\"\n                value={notes}\n                onChange={(event) => setNotes(event.target.value)}\n                rows={4}\n              />\n            </div>\n\n            {error && (\n              <Alert variant=\"destructive\">\n                <AlertDescription>{error}</AlertDescription>\n              </Alert>\n            )}\n\n            <div className=\"flex items-center justify-end gap-3\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => handleOpenChange(false)}\n                disabled={submitting}\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={submitting}>\n                {submitting ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                    Sending\n                  </>\n                ) : (\n                  'Submit interest'\n                )}\n              </Button>\n            </div>\n          </form>\n        )}\n      </DialogContent>\n    </Dialog>\n  )\n}\n","'use client'\r\n\r\nimport { ReactNode, useState } from 'react'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger\r\n} from '@/components/ui/dialog'\r\nimport { SubmitSubscriptionForm } from './submit-subscription-form'\r\nimport { Briefcase } from 'lucide-react'\r\n\r\ninterface SubscribeNowDialogProps {\r\n  dealId: string\r\n  dealName: string\r\n  currency: string\r\n  children: ReactNode\r\n  existingSubmission?: {\r\n    id: string\r\n    status: string\r\n    submitted_at: string\r\n  } | null\r\n}\r\n\r\nexport function SubscribeNowDialog({\r\n  dealId,\r\n  dealName,\r\n  currency,\r\n  children,\r\n  existingSubmission\r\n}: SubscribeNowDialogProps) {\r\n  const [open, setOpen] = useState(false)\r\n\r\n  // Map to the format expected by SubmitSubscriptionForm\r\n  const formattedSubmission = existingSubmission\r\n    ? {\r\n        id: existingSubmission.id,\r\n        status: existingSubmission.status,\r\n        submitted_at: existingSubmission.submitted_at,\r\n        payload_json: {}\r\n      }\r\n    : null\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>{children}</DialogTrigger>\r\n      <DialogContent className=\"max-w-xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-emerald-100\">\r\n              <Briefcase className=\"h-5 w-5 text-emerald-600\" />\r\n            </div>\r\n            <div>\r\n              <DialogTitle className=\"text-xl\">Subscribe to Investment Opportunity</DialogTitle>\r\n              <DialogDescription>\n                Submit a subscription request for {dealName}. The team will review it before sending the NDA and\n                subscription documents.\n                <span className=\"block mt-1 text-amber-600 dark:text-amber-400 text-xs\">\n                  Note: This request does not include data room access.\n                </span>\n              </DialogDescription>\n            </div>\r\n          </div>\r\n        </DialogHeader>\r\n        <div className=\"mt-4\">\r\n          <SubmitSubscriptionForm\r\n            dealId={dealId}\r\n            currency={currency}\r\n            existingSubmission={formattedSubmission}\r\n          />\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}