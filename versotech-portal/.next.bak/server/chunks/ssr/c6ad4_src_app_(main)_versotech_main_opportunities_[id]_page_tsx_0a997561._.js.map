{"version":3,"sources":["../../../../../versotech-portal/src/app/%28main%29/versotech_main/opportunities/%5Bid%5D/page.tsx","../../../../../versotech-portal/src/components/deals/investor-journey-bar.tsx","../../../../../versotech-portal/src/components/deals/data-room-viewer.tsx","../../../../../versotech-portal/src/components/deals/deal-timeline-card.tsx","../../../../../versotech-portal/src/components/deals/deal-key-details-card.tsx","../../../../../versotech-portal/src/components/deals/interest-status-card.tsx","../../../../../versotech-portal/src/components/deals/subscription-status-card.tsx","../../../../../versotech-portal/src/components/commercial-partner/index.ts","../../../../../versotech-portal/node_modules/lucide-react/src/icons/presentation.ts","../../../../../versotech-portal/node_modules/lucide-react/src/icons/skip-forward.ts","../../../../../versotech-portal/node_modules/lucide-react/src/icons/file-play.ts","../../../../../versotech-portal/node_modules/lucide-react/src/icons/file-image.ts"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { useParams, useRouter, useSearchParams } from 'next/navigation'\r\nimport Image from 'next/image'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Skeleton } from '@/components/ui/skeleton'\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport {\r\n  Accordion,\r\n  AccordionContent,\r\n  AccordionItem,\r\n  AccordionTrigger,\r\n} from '@/components/ui/accordion'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { InvestorJourneyBar } from '@/components/deals/investor-journey-bar'\r\nimport { DataRoomViewer, type DataRoomDocument } from '@/components/deals/data-room-viewer'\r\nimport { DealTimelineCard } from '@/components/deals/deal-timeline-card'\r\nimport { DealKeyDetailsCard } from '@/components/deals/deal-key-details-card'\r\nimport { InterestStatusCard } from '@/components/deals/interest-status-card'\r\nimport { SubscriptionStatusCard } from '@/components/deals/subscription-status-card'\r\nimport {\r\n  ArrowLeft,\r\n  Building2,\r\n  TrendingUp,\r\n  MapPin,\r\n  Globe,\r\n  FileText,\r\n  Download,\r\n  Eye,\r\n  Lock,\r\n  CheckCircle2,\r\n  Clock,\r\n  AlertCircle,\r\n  FileSignature,\r\n  Users,\r\n  ExternalLink,\r\n  HelpCircle,\r\n  MessageSquare,\r\n  Tag,\r\n  FolderOpen,\r\n  Loader2\r\n} from 'lucide-react'\r\nimport { DocumentViewerFullscreen } from '@/components/documents/DocumentViewerFullscreen'\r\nimport type { DocumentReference } from '@/types/document-viewer.types'\r\nimport { usePersona } from '@/contexts/persona-context'\r\nimport { useProxyMode } from '@/components/commercial-partner'\r\n\r\ninterface Document {\r\n  id: string\r\n  file_name: string\r\n  file_type: string\r\n  file_size: number\r\n  category: string\r\n  description: string | null\r\n  uploaded_at: string\r\n  is_featured: boolean\r\n  external_link: string | null\r\n  file_key: string | null\r\n}\r\n\r\ninterface FeeStructure {\r\n  id: string\r\n  status: string\r\n  version: number\r\n  // Opportunity Summary\r\n  opportunity_summary: string | null\r\n  term_sheet_html: string | null\r\n  // Transaction Details\r\n  transaction_type: string | null\r\n  issuer: string | null\r\n  vehicle: string | null\r\n  exclusive_arranger: string | null\r\n  purchaser: string | null\r\n  seller: string | null\r\n  structure: string | null\r\n  // Investment Terms\r\n  allocation_up_to: number | null\r\n  price_per_share_text: string | null\r\n  minimum_ticket: number | null\r\n  // Fee Structure\r\n  subscription_fee_percent: number | null\r\n  management_fee_percent: number | null\r\n  carried_interest_percent: number | null\r\n  management_fee_clause: string | null\r\n  performance_fee_clause: string | null\r\n  // Timeline\r\n  term_sheet_date: string | null\r\n  interest_confirmation_deadline: string | null\r\n  validity_date: string | null\r\n  completion_date: string | null\r\n  completion_date_text: string | null\r\n  // Legal\r\n  legal_counsel: string | null\r\n  // Attachment\r\n  term_sheet_attachment_key: string | null\r\n}\r\n\r\ninterface FAQ {\r\n  id: string\r\n  question: string\r\n  answer: string\r\n  display_order: number\r\n}\r\n\r\ninterface Signatory {\r\n  id: string\r\n  full_name: string\r\n  email: string\r\n  role: string\r\n}\r\n\r\ninterface Opportunity {\r\n  id: string\r\n  name: string\r\n  description: string | null\r\n  investment_thesis: string | null\r\n  status: string\r\n  deal_type: string | null\r\n  currency: string\r\n  minimum_investment: number | null\r\n  maximum_investment: number | null\r\n  target_amount: number | null\r\n  raised_amount: number | null\r\n  offer_unit_price: number | null\r\n  open_at: string | null\r\n  close_at: string | null\r\n  company_name: string | null\r\n  company_logo_url: string | null\r\n  company_website: string | null\r\n  sector: string | null\r\n  stage: string | null\r\n  location: string | null\r\n  stock_type: string | null\r\n  deal_round: string | null\r\n  vehicle: {\r\n    id: string\r\n    name: string\r\n    type: string\r\n  } | null\r\n  has_membership: boolean\r\n  membership: {\r\n    role: string\r\n    dispatched_at: string | null\r\n    viewed_at: string | null\r\n    interest_confirmed_at: string | null\r\n    nda_signed_at: string | null\r\n    data_room_granted_at: string | null\r\n  } | null\r\n  journey: {\r\n    current_stage: number\r\n    stages: any[]\r\n    summary: {\r\n      received: string | null\r\n      viewed: string | null\r\n      interest_confirmed: string | null\r\n      nda_signed: string | null\r\n      data_room_access: string | null\r\n      pack_generated: string | null\r\n      pack_sent: string | null\r\n      signed: string | null\r\n      funded: string | null\r\n      active: string | null\r\n    }\r\n  }\r\n  data_room: {\r\n    has_access: boolean\r\n    access_details: {\r\n      granted_at: string\r\n      expires_at: string | null\r\n      auto_granted: boolean\r\n    } | null\r\n    documents: Document[]\r\n    requires_nda: boolean\r\n  }\r\n  subscription: {\r\n    id: string\r\n    status: string\r\n    commitment: number | null\r\n    currency: string\r\n    funded_amount: number | null\r\n    pack_generated_at: string | null\r\n    pack_sent_at: string | null\r\n    signed_at: string | null\r\n    funded_at: string | null\r\n    activated_at: string | null\r\n    created_at: string | null\r\n    is_signed: boolean\r\n    is_funded: boolean\r\n    is_active: boolean\r\n    documents: {\r\n      nda: {\r\n        status: string\r\n        signatories: Array<{\r\n          name: string\r\n          email: string\r\n          status: string\r\n          signed_at: string | null\r\n        }>\r\n        unsigned_url: string | null\r\n        signed_url: string | null\r\n      }\r\n      subscription_pack: {\r\n        status: string\r\n        signatories: Array<{\r\n          name: string\r\n          email: string\r\n          status: string\r\n          signed_at: string | null\r\n        }>\r\n        unsigned_url: string | null\r\n        signed_url: string | null\r\n      }\r\n      certificate: {\r\n        status: string\r\n        url: string | null\r\n      } | null\r\n    } | null\r\n  } | null\r\n  subscription_submission?: {\r\n    id: string\r\n    status: string\r\n    submitted_at: string | null\r\n  } | null\r\n  fee_structures: FeeStructure[]\r\n  faqs: FAQ[]\r\n  signatories: Signatory[]\r\n  can_express_interest: boolean\r\n  can_sign_nda: boolean\r\n  can_access_data_room: boolean\r\n  can_subscribe: boolean\r\n  can_sign_subscription: boolean\r\n  is_tracking_only?: boolean\r\n  // PERSONA-BASED ACCESS CONTROLS (per Fred's meeting requirements)\r\n  access_controls?: {\r\n    can_view_term_sheet: boolean\r\n    can_view_data_room: boolean\r\n    has_auto_data_room_access: boolean\r\n    restriction_reason: string | null\r\n  }\r\n}\r\n\r\nfunction formatCurrency(amount: number | null, currency: string = 'USD'): string {\r\n  if (!amount) return '-'\r\n  return new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency,\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0\r\n  }).format(amount)\r\n}\r\n\r\nfunction formatDate(dateString: string | null): string {\r\n  if (!dateString) return '-'\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    month: 'short',\r\n    day: 'numeric',\r\n    year: 'numeric'\r\n  })\r\n}\r\n\r\nfunction formatFileSize(bytes: number): string {\r\n  if (bytes < 1024) return `${bytes} B`\r\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`\r\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`\r\n}\r\n\r\nexport default function OpportunityDetailPage() {\r\n  const params = useParams()\r\n  const router = useRouter()\r\n  const searchParams = useSearchParams()\r\n  const dealId = params.id as string\r\n  const actionParam = searchParams.get('action')\r\n  const fromParam = searchParams.get('from') // Track where user came from\r\n\r\n  const { hasAnyPersona, isLoading: personaLoading, activePersona, error: personaError } = usePersona()\r\n  const [opportunity, setOpportunity] = useState<Opportunity | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n\r\n  // Dialog states\r\n  const [showInterestDialog, setShowInterestDialog] = useState(false)\r\n  const [showNdaDialog, setShowNdaDialog] = useState(false)\r\n  const [showSubscribeDialog, setShowSubscribeDialog] = useState(false)\r\n  const [subscribeAmount, setSubscribeAmount] = useState('')\r\n  const [actionLoading, setActionLoading] = useState(false)\r\n  const isPartnerPersona = activePersona?.persona_type === 'partner'\r\n\r\n  // Term sheet preview state\r\n  const [previewOpen, setPreviewOpen] = useState(false)\r\n  const [previewLoading, setPreviewLoading] = useState(false)\r\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null)\r\n  const [previewError, setPreviewError] = useState<string | null>(null)\r\n  const [previewDocument, setPreviewDocument] = useState<DocumentReference | null>(null)\r\n  const { isProxyMode, selectedClient } = useProxyMode()\r\n\r\n  useEffect(() => {\r\n    // CRITICAL: AbortController prevents race conditions when navigating between deals\r\n    // Without this, if you navigate A→B quickly, fetch A might complete AFTER fetch B\r\n    // and overwrite the correct data with stale data\r\n    const abortController = new AbortController()\r\n    let isCancelled = false\r\n\r\n    // Reset state when dealId changes\r\n    setOpportunity(null)\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    async function fetchOpportunity() {\r\n      try {\r\n        console.log(`[OpportunityDetail] Starting fetch for dealId: ${dealId}`)\r\n\r\n        // Record view (fire and forget, don't block on this)\r\n        fetch(`/api/investors/me/opportunities/${dealId}`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ action: 'view' }),\r\n          cache: 'no-store'\r\n        }).catch(() => {}) // Ignore errors from view recording\r\n\r\n        // Fetch opportunity data with abort signal\r\n        const timestamp = Date.now()\r\n        const proxyParam = isProxyMode && selectedClient?.id\r\n          ? `&client_investor_id=${selectedClient.id}`\r\n          : ''\r\n        const response = await fetch(`/api/investors/me/opportunities/${dealId}?_t=${timestamp}${proxyParam}`, {\r\n          cache: 'no-store',\r\n          signal: abortController.signal,\r\n          headers: {\r\n            'Cache-Control': 'no-cache, no-store, must-revalidate',\r\n            'Pragma': 'no-cache'\r\n          }\r\n        })\r\n\r\n        // Check if this request was cancelled (user navigated away)\r\n        if (isCancelled) {\r\n          console.log(`[OpportunityDetail] Fetch for ${dealId} was cancelled (user navigated away)`)\r\n          return\r\n        }\r\n\r\n        const data = await response.json()\r\n        if (!response.ok) {\r\n          throw new Error(data.error || `Failed to fetch opportunity (${response.status})`)\r\n        }\r\n\r\n        // Double-check we're still on the same deal before setting state\r\n        if (isCancelled) {\r\n          console.log(`[OpportunityDetail] Ignoring response for ${dealId} - request was cancelled`)\r\n          return\r\n        }\r\n\r\n        console.log(`[OpportunityDetail] ✅ Setting state for: \"${data.opportunity?.name}\" (ID: ${data.opportunity?.id})`)\r\n\r\n        if (data.opportunity?.id !== dealId) {\r\n          console.error(`[OpportunityDetail] ⚠️ MISMATCH! URL has ${dealId} but API returned ${data.opportunity?.id}`)\r\n        }\r\n\r\n        setOpportunity(data.opportunity)\r\n        const trackingOnlyForPersona = data.opportunity.is_tracking_only || (isPartnerPersona && !data.opportunity.membership?.role)\r\n\r\n        if (actionParam === 'subscribe' && data.opportunity.can_subscribe && !trackingOnlyForPersona) {\r\n          setShowSubscribeDialog(true)\r\n        }\r\n      } catch (err: any) {\r\n        if (err.name === 'AbortError') {\r\n          console.log(`[OpportunityDetail] Fetch aborted for ${dealId}`)\r\n          return\r\n        }\r\n        if (!isCancelled) {\r\n          console.error('Error fetching opportunity:', err)\r\n          setError('Failed to load opportunity details')\r\n        }\r\n      } finally {\r\n        if (!isCancelled) {\r\n          setLoading(false)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (hasAnyPersona && dealId) {\r\n      fetchOpportunity()\r\n    }\r\n\r\n    // Cleanup: Cancel any in-flight requests when dealId changes or component unmounts\r\n    return () => {\r\n      console.log(`[OpportunityDetail] Cleanup: Cancelling fetch for ${dealId}`)\r\n      isCancelled = true\r\n      abortController.abort()\r\n    }\r\n  }, [hasAnyPersona, dealId, actionParam, isPartnerPersona, isProxyMode, selectedClient?.id])\r\n\r\n  const handleExpressInterest = async () => {\r\n    try {\r\n      setActionLoading(true)\r\n      const response = await fetch(`/api/deals/${dealId}/interests`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({})\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const err = await response.json().catch(() => ({}))\r\n        throw new Error(err.error || 'Failed to submit interest')\r\n      }\r\n\r\n      // Refresh data\r\n      const proxyParam = isProxyMode && selectedClient?.id\r\n        ? `?client_investor_id=${selectedClient.id}`\r\n        : ''\r\n      const refreshResponse = await fetch(`/api/investors/me/opportunities/${dealId}${proxyParam}`)\r\n      const data = await refreshResponse.json()\r\n      setOpportunity(data.opportunity)\r\n      setShowInterestDialog(false)\r\n    } catch (err) {\r\n      console.error('Error expressing interest:', err)\r\n    } finally {\r\n      setActionLoading(false)\r\n    }\r\n  }\r\n\r\n  // NDA signing is now handled automatically after CEO approval\r\n  // This function has been removed - NDA documents are generated and sent\r\n  // via the approval workflow, not triggered directly by investors\r\n\r\n  const handleSubscribe = async () => {\r\n    if (!subscribeAmount || !opportunity) return\r\n\r\n    try {\r\n      setActionLoading(true)\r\n\r\n      let response: Response\r\n      if (isProxyMode && selectedClient?.id) {\r\n        response = await fetch('/api/commercial-partners/proxy-subscribe', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            deal_id: dealId,\r\n            client_investor_id: selectedClient.id,\r\n            commitment: parseFloat(subscribeAmount),\r\n            stock_type: opportunity.stock_type || 'common',\r\n            notes: `Submitted in proxy mode by commercial partner`\r\n          })\r\n        })\r\n      } else {\r\n        // Submit subscription for review (creates CEO approval)\r\n        response = await fetch(`/api/deals/${dealId}/subscriptions`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            payload: {\r\n              amount: parseFloat(subscribeAmount),\r\n              currency: opportunity.currency,\r\n              bank_confirmation: false\r\n            },\r\n            subscription_type: 'personal'\r\n          })\r\n        })\r\n      }\r\n\r\n      if (!response.ok) {\r\n        const err = await response.json()\r\n        throw new Error(err.error || 'Failed to submit subscription')\r\n      }\r\n\r\n      await response.json()\r\n\r\n      // Refresh data\r\n      const proxyParam = isProxyMode && selectedClient?.id\r\n        ? `?client_investor_id=${selectedClient.id}`\r\n        : ''\r\n      const refreshResponse = await fetch(`/api/investors/me/opportunities/${dealId}${proxyParam}`)\r\n      const data = await refreshResponse.json()\r\n      setOpportunity(data.opportunity)\r\n      setShowSubscribeDialog(false)\r\n      setSubscribeAmount('')\r\n\r\n      alert('Subscription submitted for review. The VERSO team will follow up shortly.')\r\n    } catch (err: any) {\r\n      console.error('Error subscribing:', err)\r\n      alert(err.message || 'Failed to submit subscription')\r\n    } finally {\r\n      setActionLoading(false)\r\n    }\r\n  }\r\n\r\n\r\n  // Show loading while persona context is initializing\r\n  if (personaLoading) {\r\n    return (\r\n      <div className=\"p-6 space-y-6\">\r\n        <Skeleton className=\"h-8 w-48\" />\r\n        <Skeleton className=\"h-24 w-full\" />\r\n        <Skeleton className=\"h-64 w-full\" />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (!hasAnyPersona) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <Card className=\"max-w-lg mx-auto\">\r\n          <CardHeader>\r\n            <CardTitle>Access Required</CardTitle>\r\n            <CardDescription>\r\n              You need to be associated with an entity to view this opportunity.\r\n            </CardDescription>\r\n          </CardHeader>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-6 space-y-6\">\r\n        <Skeleton className=\"h-8 w-48\" />\r\n        <Skeleton className=\"h-24 w-full\" />\r\n        <Skeleton className=\"h-64 w-full\" />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error || !opportunity) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <Card className=\"max-w-lg mx-auto\">\r\n          <CardHeader>\r\n            <CardTitle>Error</CardTitle>\r\n            <CardDescription>{error || 'Opportunity not found'}</CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Button onClick={() => router.push(\r\n              fromParam === 'introductions'\r\n                ? '/versotech_main/introductions'\r\n                : '/versotech_main/opportunities'\r\n            )}>\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n              {fromParam === 'introductions' ? 'Back to Introductions' : 'Back to Opportunities'}\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const isTrackingOnly = !!opportunity.is_tracking_only || (isPartnerPersona && !opportunity.membership?.role)\r\n  const canSubscribe = opportunity.can_subscribe && !isTrackingOnly\r\n  const canExpressInterest = opportunity.can_express_interest && !isTrackingOnly\r\n  const canSignNda = opportunity.can_sign_nda && !isTrackingOnly\r\n  const showActionChoices =\r\n    opportunity.status !== 'closed' &&\r\n    !opportunity.subscription &&\r\n    (canSubscribe || canExpressInterest)\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      {/* Back button - context-aware navigation */}\r\n      <Button\r\n        variant=\"ghost\"\r\n        onClick={() => {\r\n          // If user came from introductions, go back there specifically\r\n          if (fromParam === 'introductions') {\r\n            router.push('/versotech_main/introductions')\r\n          } else {\r\n            router.back()\r\n          }\r\n        }}\r\n      >\r\n        <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n        {fromParam === 'introductions' ? 'Back to Introductions' : 'Back'}\r\n      </Button>\r\n\r\n      {/* Journey Progress Bar */}\r\n      {!isTrackingOnly ? (\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Investment Journey</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <InvestorJourneyBar\r\n              summary={opportunity.journey.summary}\r\n              currentStage={opportunity.journey.current_stage}\r\n            />\r\n          </CardContent>\r\n        </Card>\r\n      ) : (\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Tracking Access</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"flex items-start gap-3 text-sm text-muted-foreground\">\r\n              <AlertCircle className=\"h-4 w-4 mt-0.5\" />\r\n              <span>\r\n                This deal is available for tracking only. Contact your relationship manager for investor access.\r\n              </span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Deal Timeline */}\r\n      <DealTimelineCard\r\n        openAt={opportunity.open_at}\r\n        closeAt={opportunity.close_at}\r\n      />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex items-start gap-6\">\r\n        {opportunity.company_logo_url ? (\r\n          <Image\r\n            src={opportunity.company_logo_url}\r\n            alt={opportunity.company_name || opportunity.name}\r\n            width={80}\r\n            height={80}\r\n            className=\"rounded-xl object-cover\"\r\n          />\r\n        ) : (\r\n          <div className=\"w-20 h-20 rounded-xl bg-gray-100 dark:bg-gray-800 flex items-center justify-center\">\r\n            <Building2 className=\"w-10 h-10 text-gray-400\" />\r\n          </div>\r\n        )}\r\n        <div className=\"flex-1\">\r\n          <h1 className=\"text-2xl font-bold\">{opportunity.name}</h1>\r\n          {opportunity.company_name && (\r\n            <p className=\"text-muted-foreground\">{opportunity.company_name}</p>\r\n          )}\r\n          <div className=\"flex flex-wrap gap-2 mt-2\">\r\n            {opportunity.sector && (\r\n              <Badge variant=\"secondary\">\r\n                <TrendingUp className=\"w-3 h-3 mr-1\" />\r\n                {opportunity.sector}\r\n              </Badge>\r\n            )}\r\n            {opportunity.stage && (\r\n              <Badge variant=\"outline\">{opportunity.stage}</Badge>\r\n            )}\r\n            {opportunity.location && (\r\n              <Badge variant=\"outline\">\r\n                <MapPin className=\"w-3 h-3 mr-1\" />\r\n                {opportunity.location}\r\n              </Badge>\r\n            )}\r\n            {opportunity.stock_type && (\r\n              <Badge variant=\"outline\" className=\"border-purple-300 text-purple-700 dark:text-purple-300\">\r\n                <Tag className=\"w-3 h-3 mr-1\" />\r\n                {opportunity.stock_type.replace(/_/g, ' ')}\r\n              </Badge>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Action buttons */}\r\n        <div className=\"flex flex-col gap-3 min-w-[280px]\">\r\n          {/* Two Investment Paths for Open Deals */}\r\n          {showActionChoices && (\r\n            <div className=\"space-y-3\">\r\n              {/* Primary: Subscribe Directly */}\r\n              {canSubscribe && (\r\n                <div className=\"relative\">\r\n                  <Button\r\n                    className=\"w-full bg-emerald-600 hover:bg-emerald-700 h-auto py-3\"\r\n                    onClick={() => setShowSubscribeDialog(true)}\r\n                  >\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <TrendingUp className=\"w-5 h-5\" />\r\n                      <div className=\"text-left\">\r\n                        <div className=\"font-semibold\">Subscribe to Investment</div>\r\n                        <div className=\"text-xs opacity-90 font-normal\">Submit for review • NDA + Subscription</div>\r\n                      </div>\r\n                    </div>\r\n                  </Button>\r\n                </div>\r\n              )}\r\n\r\n              {/* OR Divider */}\r\n              {canSubscribe && canExpressInterest && (\r\n                <div className=\"relative flex items-center gap-3\">\r\n                  <div className=\"flex-1 h-px bg-gray-200 dark:bg-gray-700\" />\r\n                  <span className=\"text-xs text-muted-foreground font-medium px-2\">OR</span>\r\n                  <div className=\"flex-1 h-px bg-gray-200 dark:bg-gray-700\" />\r\n                </div>\r\n              )}\r\n\r\n              {/* Secondary: Data Room Interest */}\r\n              {/* PERSONA ACCESS RULE: Hide for introducers and lawyers who can't access data room */}\r\n              {canExpressInterest && opportunity.access_controls?.can_view_data_room !== false && (\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"w-full h-auto py-3 border-dashed\"\r\n                  onClick={() => setShowInterestDialog(true)}\r\n                >\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <FolderOpen className=\"w-5 h-5 text-amber-600\" />\r\n                    <div className=\"text-left\">\r\n                      <div className=\"font-medium\">Request Data Room Access</div>\r\n                      <div className=\"text-xs text-muted-foreground font-normal\">Review documents first</div>\r\n                    </div>\r\n                  </div>\r\n                </Button>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Show NDA info when in NDA stage - signing is triggered after CEO approval */}\r\n          {canSignNda && (\r\n            <Button variant=\"outline\" onClick={() => setShowNdaDialog(true)}>\r\n              <FileSignature className=\"w-4 h-4 mr-2\" />\r\n              About NDA Signing\r\n            </Button>\r\n          )}\r\n\r\n          {/* Subscription Status Badges */}\r\n          {opportunity.subscription && !opportunity.subscription.is_active && (\r\n            <Badge className=\"justify-center py-2\" variant=\"outline\">\r\n              <Clock className=\"w-4 h-4 mr-2\" />\r\n              {opportunity.subscription.is_funded ? 'Awaiting Activation' :\r\n               opportunity.subscription.is_signed ? 'Awaiting Funding' :\r\n               'Awaiting Signature'}\r\n            </Badge>\r\n          )}\r\n          {opportunity.subscription?.is_active && (\r\n            <Badge className=\"justify-center py-2 bg-emerald-500 text-white\">\r\n              <CheckCircle2 className=\"w-4 h-4 mr-2\" />\r\n              Active Investment\r\n            </Badge>\r\n          )}\r\n\r\n          {/* Ask Question - always available */}\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            className=\"text-muted-foreground hover:text-foreground\"\r\n            onClick={() => router.push(`/versotech_main/inbox?deal=${opportunity.id}&deal_name=${encodeURIComponent(opportunity.name)}`)}\r\n          >\r\n            <MessageSquare className=\"w-4 h-4 mr-2\" />\r\n            Ask a Question\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main content tabs */}\r\n      <Tabs defaultValue=\"overview\" className=\"space-y-4\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          {/* PERSONA ACCESS RULE: Hide Data Room tab for introducers and lawyers */}\r\n          {(opportunity.access_controls?.can_view_data_room !== false) && (\r\n            <TabsTrigger value=\"data-room\" className=\"relative\">\r\n              Data Room\r\n              {!opportunity.data_room.has_access && (\r\n                <Lock className=\"w-3 h-3 ml-1\" />\r\n              )}\r\n            </TabsTrigger>\r\n          )}\r\n          <TabsTrigger value=\"faqs\">FAQs</TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* Overview Tab */}\r\n        <TabsContent value=\"overview\" className=\"space-y-6\">\r\n          {/* Subscription Status OR Interest Status + Key Details Row */}\r\n          <div className=\"grid gap-6 lg:grid-cols-3\">\r\n            {/* Show SubscriptionStatusCard when subscription exists, otherwise show InterestStatusCard */}\r\n            {opportunity.subscription ? (\r\n              <SubscriptionStatusCard\r\n                subscription={opportunity.subscription}\r\n                dealCurrency={opportunity.currency}\r\n                dealId={opportunity.id}\r\n                dealName={opportunity.name}\r\n              />\r\n            ) : opportunity.subscription_submission ? (\r\n              <Card className=\"border-2 border-dashed border-amber-200 bg-amber-50\">\r\n                <CardHeader className=\"pb-3\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <CardTitle className=\"text-base flex items-center gap-2 text-amber-900\">\r\n                      <Clock className=\"h-5 w-5 text-amber-600\" />\r\n                      Subscription Under Review\r\n                    </CardTitle>\r\n                    <Badge className=\"bg-amber-200 text-amber-900 border-0\">\r\n                      Pending Review\r\n                    </Badge>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent className=\"text-sm text-amber-800\">\r\n                  {opportunity.subscription_submission.submitted_at\r\n                    ? `Submitted on ${formatDate(opportunity.subscription_submission.submitted_at)}.`\r\n                    : 'Submitted and awaiting CEO approval.'}\r\n                </CardContent>\r\n              </Card>\r\n            ) : (\r\n              <InterestStatusCard\r\n                currentStage={opportunity.journey.current_stage}\r\n                membership={opportunity.membership}\r\n                subscription={null}\r\n                canExpressInterest={canExpressInterest}\r\n                canSignNda={canSignNda}\r\n                canSubscribe={canSubscribe}\r\n                isTrackingOnly={isTrackingOnly}\r\n                onExpressInterest={() => setShowInterestDialog(true)}\r\n                onSignNda={() => setShowNdaDialog(true)}\r\n                onSubscribe={() => setShowSubscribeDialog(true)}\r\n              />\r\n            )}\r\n            <div className=\"lg:col-span-2\">\r\n              <DealKeyDetailsCard\r\n                dealType={opportunity.deal_type || 'N/A'}\r\n                currency={opportunity.currency}\r\n                stockType={opportunity.stock_type}\r\n                sector={opportunity.sector}\r\n                location={opportunity.location}\r\n                vehicleName={opportunity.vehicle?.name || null}\r\n                stage={opportunity.stage}\r\n                round={opportunity.deal_round}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid gap-6 md:grid-cols-2\">\r\n            {/* Investment Details */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Investment Details</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Target Raise</Label>\r\n                    <p className=\"font-medium\">{formatCurrency(opportunity.target_amount, opportunity.currency)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Raised</Label>\r\n                    <p className=\"font-medium\">{formatCurrency(opportunity.raised_amount, opportunity.currency)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Min Investment</Label>\r\n                    <p className=\"font-medium\">{formatCurrency(opportunity.minimum_investment, opportunity.currency)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Max Investment</Label>\r\n                    <p className=\"font-medium\">{formatCurrency(opportunity.maximum_investment, opportunity.currency)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Closing Date</Label>\r\n                    <p className=\"font-medium\">{formatDate(opportunity.close_at)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Deal Type</Label>\r\n                    <p className=\"font-medium\">{opportunity.deal_type || '-'}</p>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Company Info */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Company Information</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                {opportunity.description && (\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Description</Label>\r\n                    <p className=\"mt-1\">{opportunity.description}</p>\r\n                  </div>\r\n                )}\r\n                {opportunity.investment_thesis && (\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Investment Thesis</Label>\r\n                    <p className=\"mt-1\">{opportunity.investment_thesis}</p>\r\n                  </div>\r\n                )}\r\n                {opportunity.company_website && (\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Website</Label>\r\n                    <a\r\n                      href={opportunity.company_website}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"flex items-center gap-1 text-blue-600 hover:underline mt-1\"\r\n                    >\r\n                      <Globe className=\"w-4 h-4\" />\r\n                      {opportunity.company_website}\r\n                      <ExternalLink className=\"w-3 h-3\" />\r\n                    </a>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Term Sheet */}\r\n          {/* PERSONA ACCESS RULE: Hide Term Sheet for introducers and lawyers */}\r\n          {opportunity.access_controls?.can_view_term_sheet !== false && opportunity.fee_structures.length > 0 && (() => {\r\n            const termSheet = opportunity.fee_structures.find(ts => ts.status === 'published') || opportunity.fee_structures[0]\r\n            if (!termSheet) return null\r\n\r\n            const handlePreviewTermSheet = async () => {\r\n              if (!termSheet.term_sheet_attachment_key) return\r\n\r\n              // Set up document reference for viewer\r\n              const fileName = termSheet.term_sheet_attachment_key.split('/').pop() || 'Term Sheet.pdf'\r\n              setPreviewDocument({\r\n                id: termSheet.id,\r\n                file_name: fileName,\r\n                name: fileName,\r\n                mime_type: 'application/pdf',\r\n                type: 'term_sheet'\r\n              })\r\n              setPreviewOpen(true)\r\n              setPreviewLoading(true)\r\n              setPreviewError(null)\r\n              setPreviewUrl(null)\r\n\r\n              try {\r\n                // Use the correct endpoint with structureId\r\n                const response = await fetch(`/api/deals/${opportunity.id}/fee-structures/${termSheet.id}/attachment`)\r\n                const result = await response.json()\r\n                if (!response.ok) throw new Error(result.error || 'Failed to load preview')\r\n                setPreviewUrl(result.url)\r\n              } catch (err) {\r\n                console.error('Error loading term sheet preview:', err)\r\n                setPreviewError(err instanceof Error ? err.message : 'Failed to load preview')\r\n              } finally {\r\n                setPreviewLoading(false)\r\n              }\r\n            }\r\n\r\n            const closePreview = () => {\r\n              setPreviewOpen(false)\r\n              setPreviewUrl(null)\r\n              setPreviewError(null)\r\n              setPreviewDocument(null)\r\n            }\r\n\r\n            const handleDownloadFromPreview = () => {\r\n              if (previewUrl) {\r\n                window.open(previewUrl, '_blank')\r\n              }\r\n            }\r\n\r\n            // Check if any transaction details exist\r\n            const hasTransactionDetails = termSheet.transaction_type || termSheet.structure || termSheet.issuer ||\r\n              termSheet.vehicle || termSheet.exclusive_arranger || termSheet.purchaser || termSheet.seller || termSheet.legal_counsel\r\n\r\n            // Check if any timeline info exists\r\n            const hasTimeline = termSheet.interest_confirmation_deadline || termSheet.validity_date ||\r\n              termSheet.completion_date || termSheet.completion_date_text\r\n\r\n            // Check if any fees exist\r\n            const hasFees = termSheet.subscription_fee_percent !== null ||\r\n              termSheet.management_fee_percent !== null || termSheet.carried_interest_percent !== null\r\n\r\n            return (\r\n              <Card className=\"border-2\">\r\n                <CardHeader className=\"pb-4\">\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"space-y-1\">\r\n                      <CardTitle className=\"text-xl\">Term Sheet</CardTitle>\r\n                      {(termSheet.term_sheet_date || termSheet.version) && (\r\n                        <CardDescription className=\"text-sm\">\r\n                          {termSheet.term_sheet_date && formatDate(termSheet.term_sheet_date)}\r\n                          {termSheet.term_sheet_date && termSheet.version && ' • '}\r\n                          {termSheet.version && `Version ${termSheet.version}`}\r\n                        </CardDescription>\r\n                      )}\r\n                    </div>\r\n                    {termSheet.term_sheet_attachment_key && (\r\n                      <Button onClick={handlePreviewTermSheet} size=\"sm\" className=\"gap-2\">\r\n                        <Eye className=\"w-4 h-4\" />\r\n                        Preview PDF\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </CardHeader>\r\n\r\n                <CardContent className=\"space-y-8\">\r\n                  {/* Price Per Share - Hero display when available */}\r\n                  {termSheet.price_per_share_text && (\r\n                    <div className=\"text-center py-6 px-4 rounded-xl bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-950/50 dark:to-teal-950/50 border border-emerald-200 dark:border-emerald-800\">\r\n                      <div className=\"text-sm font-medium text-emerald-600 dark:text-emerald-400 mb-1\">Price Per Share</div>\r\n                      <div className=\"text-3xl font-bold text-emerald-700 dark:text-emerald-300\">{termSheet.price_per_share_text}</div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Opportunity Summary */}\r\n                  {(termSheet.term_sheet_html || termSheet.opportunity_summary) && (\r\n                    <div>\r\n                      <h4 className=\"text-sm font-semibold text-muted-foreground mb-3\">Opportunity Summary</h4>\r\n                      <div className=\"prose prose-sm dark:prose-invert max-w-none\">\r\n                        {termSheet.term_sheet_html ? (\r\n                          <div dangerouslySetInnerHTML={{ __html: termSheet.term_sheet_html }} />\r\n                        ) : (\r\n                          <p className=\"whitespace-pre-wrap text-foreground/80\">{termSheet.opportunity_summary}</p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Key Terms Grid */}\r\n                  {(termSheet.allocation_up_to || termSheet.minimum_ticket) && (\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                      {termSheet.allocation_up_to && (\r\n                        <div className=\"text-center p-4 rounded-lg bg-muted/50\">\r\n                          <div className=\"text-xs text-muted-foreground mb-1\">Allocation ({opportunity.currency})</div>\r\n                          <div className=\"text-lg font-semibold\">{formatCurrency(termSheet.allocation_up_to, opportunity.currency)}</div>\r\n                        </div>\r\n                      )}\r\n                      {termSheet.minimum_ticket && (\r\n                        <div className=\"text-center p-4 rounded-lg bg-muted/50\">\r\n                          <div className=\"text-xs text-muted-foreground mb-1\">Min. Ticket</div>\r\n                          <div className=\"text-lg font-semibold\">{formatCurrency(termSheet.minimum_ticket, opportunity.currency)}</div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Fee Structure */}\r\n                  {hasFees && (\r\n                    <div>\r\n                      <h4 className=\"text-sm font-semibold text-muted-foreground mb-3\">Fee Structure</h4>\r\n                      <div className=\"grid grid-cols-3 gap-4\">\r\n                        {termSheet.subscription_fee_percent !== null && (\r\n                          <div className=\"p-4 rounded-lg border bg-card\">\r\n                            <div className=\"text-xs text-muted-foreground\">Subscription Fee</div>\r\n                            <div className=\"text-2xl font-bold mt-1\">{termSheet.subscription_fee_percent}%</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.management_fee_percent !== null && (\r\n                          <div className=\"p-4 rounded-lg border bg-card\">\r\n                            <div className=\"text-xs text-muted-foreground\">Management Fee</div>\r\n                            <div className=\"text-2xl font-bold mt-1\">{termSheet.management_fee_percent}%</div>\r\n                            <div className=\"text-xs text-muted-foreground\">per annum</div>\r\n                            {termSheet.management_fee_clause && (\r\n                              <p className=\"text-xs text-muted-foreground mt-2 border-t pt-2\">{termSheet.management_fee_clause}</p>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                        {termSheet.carried_interest_percent !== null && (\r\n                          <div className=\"p-4 rounded-lg border bg-card\">\r\n                            <div className=\"text-xs text-muted-foreground\">Carried Interest</div>\r\n                            <div className=\"text-2xl font-bold mt-1\">{termSheet.carried_interest_percent}%</div>\r\n                            {termSheet.performance_fee_clause && (\r\n                              <p className=\"text-xs text-muted-foreground mt-2 border-t pt-2\">{termSheet.performance_fee_clause}</p>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Transaction Details */}\r\n                  {hasTransactionDetails && (\r\n                    <div>\r\n                      <h4 className=\"text-sm font-semibold text-muted-foreground mb-3\">Transaction Details</h4>\r\n                      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4\">\r\n                        {termSheet.transaction_type && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Type</div>\r\n                            <div className=\"font-medium\">{termSheet.transaction_type}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.structure && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Structure</div>\r\n                            <div className=\"font-medium\">{termSheet.structure}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.issuer && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Issuer</div>\r\n                            <div className=\"font-medium\">{termSheet.issuer}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.vehicle && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Vehicle</div>\r\n                            <div className=\"font-medium\">{termSheet.vehicle}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.exclusive_arranger && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Arranger</div>\r\n                            <div className=\"font-medium\">{termSheet.exclusive_arranger}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.purchaser && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Purchaser</div>\r\n                            <div className=\"font-medium\">{termSheet.purchaser}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.seller && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Seller</div>\r\n                            <div className=\"font-medium\">{termSheet.seller}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.legal_counsel && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Legal Counsel</div>\r\n                            <div className=\"font-medium\">{termSheet.legal_counsel}</div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Timeline */}\r\n                  {hasTimeline && (\r\n                    <div>\r\n                      <h4 className=\"text-sm font-semibold text-muted-foreground mb-3\">Timeline</h4>\r\n                      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n                        {termSheet.interest_confirmation_deadline && (\r\n                          <div className=\"p-3 rounded-lg bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800\">\r\n                            <div className=\"text-xs font-medium text-amber-600 dark:text-amber-400\">Interest Deadline</div>\r\n                            <div className=\"font-semibold text-amber-700 dark:text-amber-300 mt-1\">{formatDate(termSheet.interest_confirmation_deadline)}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.validity_date && (\r\n                          <div className=\"p-3 rounded-lg bg-muted/50\">\r\n                            <div className=\"text-xs text-muted-foreground\">Valid Until</div>\r\n                            <div className=\"font-medium mt-1\">{formatDate(termSheet.validity_date)}</div>\r\n                          </div>\r\n                        )}\r\n                        {(termSheet.completion_date || termSheet.completion_date_text) && (\r\n                          <div className=\"p-3 rounded-lg bg-muted/50\">\r\n                            <div className=\"text-xs text-muted-foreground\">Completion</div>\r\n                            <div className=\"font-medium mt-1\">\r\n                              {termSheet.completion_date\r\n                                ? formatDate(termSheet.completion_date)\r\n                                : termSheet.completion_date_text}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </CardContent>\r\n              </Card>\r\n            )\r\n          })()}\r\n\r\n          {/* Signatories */}\r\n          {opportunity.signatories.length > 0 && (\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Users className=\"w-5 h-5\" />\r\n                  Authorized Signatories\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  These signatories will need to sign the NDA and subscription documents\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  {opportunity.signatories.map((signatory) => (\r\n                    <div key={signatory.id} className=\"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800\">\r\n                      <div className=\"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center\">\r\n                        <Users className=\"w-5 h-5 text-gray-500\" />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-medium\">{signatory.full_name}</div>\r\n                        <div className=\"text-sm text-muted-foreground\">{signatory.email}</div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n\r\n        {/* Data Room Tab */}\r\n        {/* PERSONA ACCESS RULE: Hide Data Room content for introducers and lawyers */}\r\n        {(opportunity.access_controls?.can_view_data_room !== false) && (\r\n          <TabsContent value=\"data-room\" className=\"space-y-4\">\r\n            {/* Access details banner when has access */}\r\n            {opportunity.data_room.has_access && opportunity.data_room.access_details && (\r\n              <Card>\r\n                <CardContent className=\"py-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                      <CheckCircle2 className=\"w-4 h-4 text-emerald-500\" />\r\n                      Access granted: {formatDate(opportunity.data_room.access_details.granted_at)}\r\n                      {opportunity.access_controls?.has_auto_data_room_access && (\r\n                        <span className=\"ml-2 text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full\">\r\n                          Auto-granted (Arranger)\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    {opportunity.data_room.access_details.expires_at && (\r\n                      <div className=\"flex items-center gap-2 text-sm text-amber-600\">\r\n                        <Clock className=\"w-4 h-4\" />\r\n                        Expires: {formatDate(opportunity.data_room.access_details.expires_at)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            {/* Data Room Viewer with folder grouping and featured docs */}\r\n            <DataRoomViewer\r\n              documents={opportunity.data_room.documents as DataRoomDocument[]}\r\n              hasAccess={opportunity.data_room.has_access}\r\n              requiresNda={opportunity.data_room.requires_nda}\r\n              dealId={opportunity.id}\r\n              onRequestAccess={opportunity.can_sign_nda ? () => setShowNdaDialog(true) : undefined}\r\n            />\r\n          </TabsContent>\r\n        )}\r\n\r\n        {/* FAQs Tab */}\r\n        <TabsContent value=\"faqs\" className=\"space-y-4\">\r\n          {opportunity.faqs.length === 0 ? (\r\n            <Card>\r\n              <CardContent className=\"py-12 text-center\">\r\n                <HelpCircle className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\r\n                <h3 className=\"text-lg font-medium mb-2\">No FAQs Available</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Frequently asked questions will be added by the deal team.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          ) : (\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Frequently Asked Questions</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <Accordion type=\"single\" collapsible className=\"w-full\">\r\n                  {opportunity.faqs.map((faq, index) => (\r\n                    <AccordionItem key={faq.id} value={`faq-${index}`}>\r\n                      <AccordionTrigger>{faq.question}</AccordionTrigger>\r\n                      <AccordionContent>{faq.answer}</AccordionContent>\r\n                    </AccordionItem>\r\n                  ))}\r\n                </Accordion>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Submit Interest for Data Room Dialog */}\r\n      <Dialog open={showInterestDialog} onOpenChange={setShowInterestDialog}>\r\n        <DialogContent className=\"sm:max-w-md\">\r\n          <DialogHeader>\r\n            <div className=\"flex items-center gap-3 mb-2\">\r\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-amber-100 dark:bg-amber-900/30\">\r\n                <FolderOpen className=\"h-5 w-5 text-amber-600\" />\r\n              </div>\r\n              <DialogTitle className=\"text-lg\">Request Data Room Access</DialogTitle>\r\n            </div>\r\n            <DialogDescription className=\"text-left\">\r\n              Submit your interest to access the data room for {opportunity.name}.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          {/* Process Steps */}\r\n          <div className=\"py-4\">\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-start gap-3 text-sm\">\r\n                <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 text-xs font-medium\">1</div>\r\n                <div>\r\n                  <div className=\"font-medium\">Submit Interest</div>\r\n                  <div className=\"text-muted-foreground\">Team reviews your request</div>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-3 text-sm\">\r\n                <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 text-xs font-medium\">2</div>\r\n                <div>\r\n                  <div className=\"font-medium\">Sign NDA</div>\r\n                  <div className=\"text-muted-foreground\">All signatories sign the NDA</div>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-3 text-sm\">\r\n                <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 text-xs font-medium\">3</div>\r\n                <div>\r\n                  <div className=\"font-medium\">Access Data Room</div>\r\n                  <div className=\"text-muted-foreground\">7-day access to all documents</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter className=\"gap-2 sm:gap-0\">\r\n            <Button variant=\"outline\" onClick={() => setShowInterestDialog(false)}>\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleExpressInterest} disabled={actionLoading} className=\"gap-2\">\r\n              {actionLoading ? 'Processing...' : (\r\n                <>\r\n                  <FolderOpen className=\"w-4 h-4\" />\r\n                  Submit Interest\r\n                </>\r\n              )}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* NDA Info Dialog - NDA is sent automatically after CEO approval */}\r\n      <Dialog open={showNdaDialog} onOpenChange={setShowNdaDialog}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>NDA Signing Process</DialogTitle>\r\n            <DialogDescription>\r\n              The NDA will be sent to you automatically once your interest is approved.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"py-4 space-y-4\">\r\n            <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <CheckCircle2 className=\"w-5 h-5 text-blue-600 mt-0.5\" />\r\n                <div className=\"text-sm\">\r\n                  <p className=\"font-medium text-blue-800 dark:text-blue-200\">Automatic NDA Generation</p>\r\n                  <p className=\"text-blue-700 dark:text-blue-300 mt-1\">\r\n                    Once your interest is approved by the VERSO team, each authorized signatory\r\n                    ({opportunity.signatories.length}) will receive their own NDA document to sign.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <AlertCircle className=\"w-5 h-5 text-amber-600 mt-0.5\" />\r\n                <div className=\"text-sm\">\r\n                  <p className=\"font-medium text-amber-800 dark:text-amber-200\">Multi-Signatory Required</p>\r\n                  <p className=\"text-amber-700 dark:text-amber-300 mt-1\">\r\n                    Data room access will be granted only after <strong>all signatories</strong> have\r\n                    completed signing their individual NDAs.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <Button onClick={() => setShowNdaDialog(false)}>\r\n              Got it\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Subscribe to Investment Opportunity Dialog */}\r\n      <Dialog open={showSubscribeDialog} onOpenChange={setShowSubscribeDialog}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Subscribe to Investment Opportunity</DialogTitle>\r\n            <DialogDescription>\r\n              Enter your commitment amount to submit a subscription request for {opportunity.name}. Once reviewed,\r\n              you&apos;ll receive the NDA and subscription documents to sign.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"py-4 space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"amount\">Commitment Amount ({opportunity.currency})</Label>\r\n              <Input\r\n                id=\"amount\"\r\n                type=\"number\"\r\n                placeholder={`Min: ${formatCurrency(opportunity.minimum_investment, opportunity.currency)}`}\r\n                value={subscribeAmount}\r\n                onChange={(e) => setSubscribeAmount(e.target.value)}\r\n              />\r\n              {opportunity.minimum_investment && opportunity.maximum_investment && (\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  Range: {formatCurrency(opportunity.minimum_investment, opportunity.currency)} - {formatCurrency(opportunity.maximum_investment, opportunity.currency)}\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {opportunity.signatories.length > 0 && (\r\n              <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <FileSignature className=\"w-5 h-5 text-blue-600 mt-0.5\" />\r\n                  <div className=\"text-sm\">\r\n                    <p className=\"font-medium text-blue-800 dark:text-blue-200\">\r\n                      {opportunity.signatories.length} Signatory(ies) Required\r\n                    </p>\r\n                    <p className=\"text-blue-700 dark:text-blue-300 mt-1\">\r\n                      Both NDA and Subscription Pack will be sent to all authorized signatories.\r\n                    </p>\r\n                    <p className=\"text-amber-600 dark:text-amber-400 mt-2 text-xs\">\r\n                      Note: This request does not include data room access.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setShowSubscribeDialog(false)}>\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleSubscribe}\r\n              disabled={actionLoading || !subscribeAmount || (opportunity.minimum_investment !== null && parseFloat(subscribeAmount) < opportunity.minimum_investment)}\r\n            >\r\n              {actionLoading ? 'Processing...' : 'Subscribe'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Term Sheet Preview - Fullscreen Viewer */}\r\n      <DocumentViewerFullscreen\r\n        isOpen={previewOpen}\r\n        document={previewDocument}\r\n        previewUrl={previewUrl}\r\n        isLoading={previewLoading}\r\n        error={previewError}\r\n        onClose={() => {\r\n          setPreviewOpen(false)\r\n          setPreviewUrl(null)\r\n          setPreviewError(null)\r\n          setPreviewDocument(null)\r\n        }}\r\n        onDownload={() => {\r\n          if (previewUrl) {\r\n            window.open(previewUrl, '_blank')\r\n          }\r\n        }}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n","'use client'\n\nimport { cn } from '@/lib/utils'\nimport { Check, Circle, SkipForward } from 'lucide-react'\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/ui/tooltip'\n\nexport interface JourneyStage {\n  stage_number: number\n  stage_name: string\n  completed_at: string | null\n  is_current: boolean\n}\n\nexport interface JourneySummary {\n  received: string | null\n  viewed: string | null\n  interest_confirmed: string | null\n  nda_signed: string | null\n  data_room_access: string | null\n  pack_generated: string | null\n  pack_sent: string | null\n  signed: string | null\n  funded: string | null\n  active: string | null\n}\n\ninterface InvestorJourneyBarProps {\n  stages?: JourneyStage[]\n  summary?: JourneySummary\n  currentStage?: number\n  className?: string\n  compact?: boolean\n}\n\n// Stage definitions with optional flag\nconst STAGE_DEFINITIONS = [\n  { number: 1, name: 'Received', key: 'received', optional: true },\n  { number: 2, name: 'Viewed', key: 'viewed', optional: false },\n  { number: 3, name: 'Interest', key: 'interest_confirmed', optional: true },\n  { number: 4, name: 'NDA', key: 'nda_signed', optional: true },\n  { number: 5, name: 'Data Room', key: 'data_room_access', optional: true },\n  { number: 6, name: 'Pack Gen', key: 'pack_generated', optional: false },\n  { number: 7, name: 'Pack Sent', key: 'pack_sent', optional: false },\n  { number: 8, name: 'Signed', key: 'signed', optional: false },\n  { number: 9, name: 'Funded', key: 'funded', optional: false },\n  { number: 10, name: 'Active', key: 'active', optional: false },\n] as const\n\ntype StageStatus = 'completed' | 'current' | 'skipped' | 'pending'\n\n/**\n * Detect if investor took Direct Subscribe path\n * Direct Subscribe: pack_generated is set but interest_confirmed is null\n * This means they skipped the Interest and Data Room stages\n */\nfunction isDirectSubscribePath(summary: JourneySummary): boolean {\n  return summary.pack_generated !== null && summary.interest_confirmed === null\n}\n\nfunction getStageStatus(\n  stageDef: typeof STAGE_DEFINITIONS[number],\n  summary: JourneySummary,\n  currentStage: number\n): StageStatus {\n  const completedAt = summary[stageDef.key as keyof JourneySummary]\n\n  if (completedAt) {\n    return 'completed'\n  }\n\n  if (stageDef.number === currentStage) {\n    return 'current'\n  }\n\n  // Special handling for Direct Subscribe path\n  // Interest (stage 3) and Data Room (stage 5) are explicitly skipped\n  const isDirectPath = isDirectSubscribePath(summary)\n  if (isDirectPath) {\n    // For Direct Subscribe: Interest and Data Room are skipped\n    if (stageDef.number === 3 || stageDef.number === 5) {\n      // Only mark as skipped if we're past these stages\n      if (currentStage > stageDef.number || summary.pack_generated) {\n        return 'skipped'\n      }\n    }\n  }\n\n  // Check if this is an optional stage that was skipped\n  // A stage is skipped if it's optional and a later stage is completed\n  if (stageDef.optional && stageDef.number < currentStage) {\n    return 'skipped'\n  }\n\n  return 'pending'\n}\n\nfunction formatDate(dateString: string | null): string {\n  if (!dateString) return ''\n  const date = new Date(dateString)\n  return date.toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric'\n  })\n}\n\nexport function InvestorJourneyBar({\n  stages,\n  summary,\n  currentStage = 0,\n  className,\n  compact = false\n}: InvestorJourneyBarProps) {\n  // Build summary from stages if provided\n  const effectiveSummary: JourneySummary = summary || (stages ? {\n    received: stages.find(s => s.stage_number === 1)?.completed_at || null,\n    viewed: stages.find(s => s.stage_number === 2)?.completed_at || null,\n    interest_confirmed: stages.find(s => s.stage_number === 3)?.completed_at || null,\n    nda_signed: stages.find(s => s.stage_number === 4)?.completed_at || null,\n    data_room_access: stages.find(s => s.stage_number === 5)?.completed_at || null,\n    pack_generated: stages.find(s => s.stage_number === 6)?.completed_at || null,\n    pack_sent: stages.find(s => s.stage_number === 7)?.completed_at || null,\n    signed: stages.find(s => s.stage_number === 8)?.completed_at || null,\n    funded: stages.find(s => s.stage_number === 9)?.completed_at || null,\n    active: stages.find(s => s.stage_number === 10)?.completed_at || null,\n  } : {\n    received: null,\n    viewed: null,\n    interest_confirmed: null,\n    nda_signed: null,\n    data_room_access: null,\n    pack_generated: null,\n    pack_sent: null,\n    signed: null,\n    funded: null,\n    active: null,\n  })\n\n  // Calculate effective current stage if not provided\n  const effectiveCurrentStage = currentStage || (() => {\n    if (effectiveSummary.active) return 10\n    if (effectiveSummary.funded) return 9\n    if (effectiveSummary.signed) return 8\n    if (effectiveSummary.pack_sent) return 7\n    if (effectiveSummary.pack_generated) return 6\n    if (effectiveSummary.data_room_access) return 5\n    if (effectiveSummary.nda_signed) return 4\n    if (effectiveSummary.interest_confirmed) return 3\n    if (effectiveSummary.viewed) return 2\n    if (effectiveSummary.received) return 1\n    return 0\n  })()\n\n  return (\n    <TooltipProvider>\n      <div className={cn('w-full', className)}>\n        {/* Progress Bar */}\n        <div className=\"relative\">\n          {/* Background line */}\n          <div className=\"absolute top-4 left-0 right-0 h-0.5 bg-border\" />\n\n          {/* Progress line */}\n          <div\n            className=\"absolute top-4 left-0 h-0.5 bg-emerald-500 transition-all duration-500\"\n            style={{ width: `${Math.max(0, (effectiveCurrentStage - 1) / 9) * 100}%` }}\n          />\n\n          {/* Stage indicators */}\n          <div className=\"relative flex justify-between\">\n            {STAGE_DEFINITIONS.map((stageDef) => {\n              const status = getStageStatus(stageDef, effectiveSummary, effectiveCurrentStage)\n              const completedAt = effectiveSummary[stageDef.key as keyof JourneySummary]\n\n              return (\n                <Tooltip key={stageDef.number}>\n                  <TooltipTrigger asChild>\n                    <div className=\"flex flex-col items-center\">\n                      {/* Stage circle */}\n                      <div\n                        className={cn(\n                          'w-8 h-8 rounded-full flex items-center justify-center transition-all',\n                          status === 'completed' && 'bg-emerald-500 text-white',\n                          status === 'current' && 'bg-blue-500 text-white ring-4 ring-blue-200 dark:ring-blue-900',\n                          status === 'skipped' && 'bg-muted text-muted-foreground',\n                          status === 'pending' && 'bg-muted/50 text-muted-foreground'\n                        )}\n                      >\n                        {status === 'completed' ? (\n                          <Check className=\"w-4 h-4\" />\n                        ) : status === 'skipped' ? (\n                          <SkipForward className=\"w-3 h-3\" />\n                        ) : (\n                          <span className=\"text-xs font-medium\">{stageDef.number}</span>\n                        )}\n                      </div>\n\n                      {/* Stage label */}\n                      {!compact && (\n                        <span\n                          className={cn(\n                            'mt-2 text-xs font-medium text-center max-w-[60px] leading-tight',\n                            status === 'completed' && 'text-emerald-600 dark:text-emerald-400',\n                            status === 'current' && 'text-blue-600 dark:text-blue-400',\n                            status === 'skipped' && 'text-muted-foreground',\n                            status === 'pending' && 'text-muted-foreground'\n                          )}\n                        >\n                          {stageDef.name}\n                        </span>\n                      )}\n                    </div>\n                  </TooltipTrigger>\n                  <TooltipContent side=\"bottom\" className=\"max-w-[200px]\">\n                    <div className=\"text-sm\">\n                      <div className=\"font-medium\">{stageDef.name}</div>\n                      {status === 'completed' && completedAt && (\n                        <div className=\"text-xs text-muted-foreground mt-1\">\n                          Completed: {formatDate(completedAt)}\n                        </div>\n                      )}\n                      {status === 'current' && (\n                        <div className=\"text-xs text-blue-600 mt-1\">In Progress</div>\n                      )}\n                      {status === 'skipped' && (\n                        <div className=\"text-xs text-muted-foreground mt-1\">Skipped (optional)</div>\n                      )}\n                      {status === 'pending' && (\n                        <div className=\"text-xs text-muted-foreground mt-1\">Pending</div>\n                      )}\n                      {stageDef.optional && (\n                        <div className=\"text-xs text-amber-600 dark:text-amber-400 mt-1\">\n                          Optional stage\n                        </div>\n                      )}\n                    </div>\n                  </TooltipContent>\n                </Tooltip>\n              )\n            })}\n          </div>\n        </div>\n\n        {/* Stage summary text */}\n        {!compact && (\n          <div className=\"mt-4 text-center\">\n            <span className=\"text-sm text-muted-foreground\">\n              {effectiveCurrentStage === 0 && 'Not started'}\n              {effectiveCurrentStage === 1 && 'Opportunity received'}\n              {effectiveCurrentStage === 2 && 'Viewed opportunity'}\n              {effectiveCurrentStage === 3 && 'Interest confirmed'}\n              {effectiveCurrentStage === 4 && 'NDA signed'}\n              {effectiveCurrentStage === 5 && 'Data room access granted'}\n              {effectiveCurrentStage === 6 && 'Subscription pack generated'}\n              {effectiveCurrentStage === 7 && 'Subscription pack sent for signing'}\n              {effectiveCurrentStage === 8 && 'Subscription signed'}\n              {effectiveCurrentStage === 9 && 'Investment funded'}\n              {effectiveCurrentStage === 10 && 'Investment active'}\n            </span>\n          </div>\n        )}\n      </div>\n    </TooltipProvider>\n  )\n}\n\n// Compact version for list cards\nexport function JourneyProgressBadge({\n  currentStage,\n  className\n}: {\n  currentStage: number\n  className?: string\n}) {\n  const stageName = STAGE_DEFINITIONS[currentStage - 1]?.name || 'Not Started'\n\n  return (\n    <div className={cn('flex items-center gap-2', className)}>\n      <div className=\"flex gap-0.5\">\n        {STAGE_DEFINITIONS.map((stage) => (\n          <div\n            key={stage.number}\n            className={cn(\n              'w-2 h-2 rounded-full',\n              stage.number <= currentStage\n                ? 'bg-emerald-500'\n                : 'bg-muted'\n            )}\n          />\n        ))}\n      </div>\n      <span className=\"text-xs text-muted-foreground\">{stageName}</span>\n    </div>\n  )\n}\n","'use client'\n\nimport { useState, useMemo, useCallback } from 'react'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from '@/components/ui/collapsible'\nimport { cn } from '@/lib/utils'\nimport { toast } from 'sonner'\nimport {\n  ChevronDown,\n  ChevronRight,\n  Download,\n  ExternalLink,\n  File,\n  FileText,\n  FileSpreadsheet,\n  FileImage,\n  FileVideo,\n  Presentation,\n  Folder,\n  FolderOpen,\n  Star,\n  Lock,\n  Eye,\n  Loader2\n} from 'lucide-react'\n\nexport interface DataRoomDocument {\n  id: string\n  file_name: string\n  file_type: string\n  file_size: number\n  category: string\n  description: string | null\n  uploaded_at: string\n  is_featured: boolean\n  external_link: string | null\n  file_key: string | null\n}\n\ninterface DataRoomViewerProps {\n  documents: DataRoomDocument[]\n  hasAccess: boolean\n  requiresNda: boolean\n  dealId: string\n  onRequestAccess?: () => void\n}\n\n// File type icon mapping\nfunction getFileIcon(mimeType: string) {\n  if (mimeType.includes('pdf')) return FileText\n  if (mimeType.includes('spreadsheet') || mimeType.includes('excel') || mimeType.includes('csv')) return FileSpreadsheet\n  if (mimeType.includes('image')) return FileImage\n  if (mimeType.includes('video')) return FileVideo\n  if (mimeType.includes('presentation') || mimeType.includes('powerpoint')) return Presentation\n  if (mimeType.includes('word') || mimeType.includes('document')) return FileText\n  return File\n}\n\n// Format file size\nfunction formatFileSize(bytes: number): string {\n  if (bytes === 0) return '—'\n  const units = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(1024))\n  return `${(bytes / Math.pow(1024, i)).toFixed(i > 0 ? 1 : 0)} ${units[i]}`\n}\n\n// Format date\nfunction formatDate(dateString: string): string {\n  return new Date(dateString).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric'\n  })\n}\n\n// Check if file type supports preview\nfunction isPreviewableType(mimeType: string): boolean {\n  return (\n    mimeType.includes('pdf') ||\n    mimeType.includes('image') ||\n    mimeType.includes('text') ||\n    mimeType.includes('video')\n  )\n}\n\n// Document row component with download/preview functionality\nfunction DocumentRow({\n  document,\n  dealId,\n  hasAccess\n}: {\n  document: DataRoomDocument\n  dealId: string\n  hasAccess: boolean\n}) {\n  const [isDownloading, setIsDownloading] = useState(false)\n  const [isPreviewing, setIsPreviewing] = useState(false)\n  const FileIcon = getFileIcon(document.file_type)\n  const isExternal = !!document.external_link\n  const canPreview = isPreviewableType(document.file_type)\n\n  const handleDocumentAction = useCallback(async (mode: 'download' | 'preview') => {\n    if (isExternal && document.external_link) {\n      window.open(document.external_link, '_blank', 'noopener,noreferrer')\n      return\n    }\n\n    const isPreview = mode === 'preview'\n    if (isPreview) {\n      setIsPreviewing(true)\n    } else {\n      setIsDownloading(true)\n    }\n\n    try {\n      const response = await fetch(\n        `/api/deals/${dealId}/documents/${document.id}/download?mode=${mode}`\n      )\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}))\n        if (response.status === 401) {\n          toast.error('Please sign in to access documents')\n        } else if (response.status === 403) {\n          toast.error(errorData.error || 'Access denied to this document')\n        } else if (response.status === 404) {\n          toast.error('Document not found')\n        } else {\n          toast.error(errorData.error || 'Failed to access document')\n        }\n        return\n      }\n\n      const data = await response.json()\n      const url = data.download_url || data.url\n\n      if (!url) {\n        toast.error('Failed to generate document link')\n        return\n      }\n\n      // Open in new tab\n      window.open(url, '_blank', 'noopener,noreferrer')\n\n      // Show success toast with watermark info\n      if (data.watermark) {\n        toast.success(\n          isPreview ? 'Document opened for preview' : 'Download started',\n          {\n            description: `Link expires in ${Math.floor(data.expires_in_seconds / 60)} minutes`,\n            duration: 4000\n          }\n        )\n      } else {\n        toast.success(isPreview ? 'Document opened' : 'Download started')\n      }\n    } catch (error) {\n      console.error('Document action error:', error)\n      toast.error('Failed to access document. Please try again.')\n    } finally {\n      setIsDownloading(false)\n      setIsPreviewing(false)\n    }\n  }, [dealId, document.id, document.external_link, isExternal])\n\n  return (\n    <div className=\"flex items-center justify-between py-3 px-4 hover:bg-muted rounded-lg transition-colors group\">\n      <div className=\"flex items-center gap-3 min-w-0 flex-1\">\n        <div className=\"p-2 rounded-lg bg-muted text-muted-foreground\">\n          <FileIcon className=\"h-5 w-5\" />\n        </div>\n        <div className=\"min-w-0\">\n          <p className=\"font-medium text-foreground truncate\">\n            {document.file_name}\n          </p>\n          <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n            <span>{formatFileSize(document.file_size)}</span>\n            <span>•</span>\n            <span>{formatDate(document.uploaded_at)}</span>\n            {document.description && (\n              <>\n                <span>•</span>\n                <span className=\"truncate max-w-[200px]\">{document.description}</span>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {hasAccess && (\n        <div className=\"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n          {isExternal ? (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => handleDocumentAction('preview')}\n            >\n              <ExternalLink className=\"h-4 w-4 mr-1\" />\n              Open\n            </Button>\n          ) : (\n            <>\n              {/* Preview button for supported file types */}\n              {canPreview && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => handleDocumentAction('preview')}\n                  disabled={isPreviewing}\n                  className=\"text-blue-600 hover:text-blue-700 hover:bg-blue-50\"\n                >\n                  {isPreviewing ? (\n                    <Loader2 className=\"h-4 w-4 mr-1 animate-spin\" />\n                  ) : (\n                    <Eye className=\"h-4 w-4 mr-1\" />\n                  )}\n                  Preview\n                </Button>\n              )}\n              {/* Download button */}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handleDocumentAction('download')}\n                disabled={isDownloading}\n              >\n                {isDownloading ? (\n                  <Loader2 className=\"h-4 w-4 mr-1 animate-spin\" />\n                ) : (\n                  <Download className=\"h-4 w-4 mr-1\" />\n                )}\n                Download\n              </Button>\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\n// Folder section component\nfunction FolderSection({\n  folderName,\n  documents,\n  dealId,\n  hasAccess,\n  defaultOpen = false\n}: {\n  folderName: string\n  documents: DataRoomDocument[]\n  dealId: string\n  hasAccess: boolean\n  defaultOpen?: boolean\n}) {\n  const [isOpen, setIsOpen] = useState(defaultOpen)\n\n  return (\n    <Collapsible open={isOpen} onOpenChange={setIsOpen}>\n      <CollapsibleTrigger className=\"w-full\">\n        <div className=\"flex items-center justify-between py-3 px-4 hover:bg-muted rounded-lg transition-colors\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/30 text-blue-600\">\n              {isOpen ? <FolderOpen className=\"h-5 w-5\" /> : <Folder className=\"h-5 w-5\" />}\n            </div>\n            <span className=\"font-medium text-foreground\">{folderName}</span>\n            <Badge variant=\"secondary\" className=\"ml-2\">\n              {documents.length} {documents.length === 1 ? 'file' : 'files'}\n            </Badge>\n          </div>\n          {isOpen ? (\n            <ChevronDown className=\"h-5 w-5 text-muted-foreground\" />\n          ) : (\n            <ChevronRight className=\"h-5 w-5 text-muted-foreground\" />\n          )}\n        </div>\n      </CollapsibleTrigger>\n      <CollapsibleContent>\n        <div className=\"ml-6 pl-4 border-l-2 border-border space-y-1\">\n          {documents.map((doc) => (\n            <DocumentRow\n              key={doc.id}\n              document={doc}\n              dealId={dealId}\n              hasAccess={hasAccess}\n            />\n          ))}\n        </div>\n      </CollapsibleContent>\n    </Collapsible>\n  )\n}\n\nexport function DataRoomViewer({\n  documents,\n  hasAccess,\n  requiresNda,\n  dealId,\n  onRequestAccess\n}: DataRoomViewerProps) {\n  // Group documents by folder with featured section\n  const { featured, folders } = useMemo(() => {\n    const featured: DataRoomDocument[] = []\n    const folderMap: Record<string, DataRoomDocument[]> = {}\n\n    documents.forEach((doc) => {\n      if (doc.is_featured) {\n        featured.push(doc)\n      }\n\n      const folderName = doc.category || 'General'\n      if (!folderMap[folderName]) {\n        folderMap[folderName] = []\n      }\n      folderMap[folderName].push(doc)\n    })\n\n    // Sort folders alphabetically, but put \"General\" last\n    const sortedFolders: Record<string, DataRoomDocument[]> = {}\n    const keys = Object.keys(folderMap).sort((a, b) => {\n      if (a === 'General') return 1\n      if (b === 'General') return -1\n      return a.localeCompare(b)\n    })\n    keys.forEach((key) => {\n      sortedFolders[key] = folderMap[key]\n    })\n\n    return { featured, folders: sortedFolders }\n  }, [documents])\n\n  // No access state\n  if (!hasAccess) {\n    return (\n      <Card className=\"border-amber-200 bg-amber-50 dark:bg-amber-900/20\">\n        <CardContent className=\"py-8 text-center\">\n          <Lock className=\"h-12 w-12 mx-auto text-amber-500 mb-4\" />\n          <h3 className=\"text-lg font-semibold text-amber-800 dark:text-amber-200 mb-2\">\n            Data Room Access Required\n          </h3>\n          <p className=\"text-amber-700 dark:text-amber-300 mb-4 max-w-md mx-auto\">\n            {requiresNda\n              ? 'Sign the NDA to unlock access to the full data room with deal documents, financials, and more.'\n              : 'Express interest in this deal to unlock access to the data room.'}\n          </p>\n          {onRequestAccess && (\n            <Button onClick={onRequestAccess} className=\"bg-amber-600 hover:bg-amber-700\">\n              {requiresNda ? 'Sign NDA to Unlock' : 'Request Access'}\n            </Button>\n          )}\n        </CardContent>\n      </Card>\n    )\n  }\n\n  // Empty state\n  if (documents.length === 0) {\n    return (\n      <Card>\n        <CardContent className=\"py-8 text-center\">\n          <Folder className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n          <h3 className=\"text-lg font-semibold text-foreground mb-2\">\n            No Documents Available\n          </h3>\n          <p className=\"text-muted-foreground max-w-md mx-auto\">\n            Documents for this deal haven&apos;t been uploaded yet. Check back soon.\n          </p>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Featured Documents Section */}\n      {featured.length > 0 && (\n        <Card className=\"border-amber-200 bg-amber-50/50 dark:bg-amber-900/10\">\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-base flex items-center gap-2 text-amber-700 dark:text-amber-300\">\n              <Star className=\"h-5 w-5 fill-amber-400 text-amber-400\" />\n              Featured Documents\n            </CardTitle>\n            <CardDescription className=\"text-amber-600/80 dark:text-amber-400/80\">\n              Key documents highlighted by the deal team\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"pt-0 space-y-1\">\n            {featured.map((doc) => (\n              <DocumentRow\n                key={doc.id}\n                document={doc}\n                dealId={dealId}\n                hasAccess={hasAccess}\n              />\n            ))}\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Folders Section */}\n      <Card>\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-base flex items-center gap-2\">\n            <Eye className=\"h-5 w-5 text-blue-500\" />\n            Data Room\n          </CardTitle>\n          <CardDescription>\n            {documents.length} document{documents.length !== 1 ? 's' : ''} across {Object.keys(folders).length} folder{Object.keys(folders).length !== 1 ? 's' : ''}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"pt-0 space-y-1\">\n          {Object.entries(folders).map(([folderName, docs], index) => (\n            <FolderSection\n              key={folderName}\n              folderName={folderName}\n              documents={docs}\n              dealId={dealId}\n              hasAccess={hasAccess}\n              defaultOpen={index === 0} // Open first folder by default\n            />\n          ))}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n","'use client'\n\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Calendar, Clock, CheckCircle2, Circle, AlertTriangle } from 'lucide-react'\nimport { cn } from '@/lib/utils'\n\ninterface DealTimelineCardProps {\n  openAt: string | null\n  closeAt: string | null\n  interestDeadline?: string | null\n  settlementDate?: string | null\n}\n\ninterface TimelineMilestone {\n  label: string\n  date: string | null\n  status: 'past' | 'current' | 'future'\n}\n\nfunction formatDate(dateString: string | null): string {\n  if (!dateString) return 'TBD'\n  return new Date(dateString).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric'\n  })\n}\n\nfunction getDaysRemaining(dateString: string | null): number | null {\n  if (!dateString) return null\n  const target = new Date(dateString)\n  const now = new Date()\n  const diffTime = target.getTime() - now.getTime()\n  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24))\n  return diffDays\n}\n\nfunction getMilestoneStatus(dateString: string | null): 'past' | 'current' | 'future' {\n  if (!dateString) return 'future'\n  const date = new Date(dateString)\n  const now = new Date()\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate())\n  const targetDay = new Date(date.getFullYear(), date.getMonth(), date.getDate())\n\n  if (targetDay < today) return 'past'\n  if (targetDay.getTime() === today.getTime()) return 'current'\n  return 'future'\n}\n\nfunction MilestoneMarker({ status }: { status: 'past' | 'current' | 'future' }) {\n  if (status === 'past') {\n    return (\n      <div className=\"w-8 h-8 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center\">\n        <CheckCircle2 className=\"w-5 h-5 text-emerald-600\" />\n      </div>\n    )\n  }\n  if (status === 'current') {\n    return (\n      <div className=\"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center ring-2 ring-blue-500 ring-offset-2\">\n        <Circle className=\"w-5 h-5 text-blue-600 fill-blue-600\" />\n      </div>\n    )\n  }\n  return (\n    <div className=\"w-8 h-8 rounded-full bg-muted flex items-center justify-center\">\n      <Circle className=\"w-5 h-5 text-muted-foreground\" />\n    </div>\n  )\n}\n\nfunction TimelineConnector({ status }: { status: 'past' | 'current' | 'future' }) {\n  return (\n    <div\n      className={cn(\n        \"flex-1 h-1 rounded-full mx-2\",\n        status === 'past' && \"bg-emerald-400\",\n        status === 'current' && \"bg-gradient-to-r from-emerald-400 to-gray-300\",\n        status === 'future' && \"bg-muted\"\n      )}\n    />\n  )\n}\n\nexport function DealTimelineCard({\n  openAt,\n  closeAt,\n  interestDeadline,\n  settlementDate\n}: DealTimelineCardProps) {\n  const milestones: TimelineMilestone[] = [\n    { label: 'Deal Open', date: openAt, status: getMilestoneStatus(openAt) },\n    ...(interestDeadline ? [{ label: 'Interest Deadline', date: interestDeadline, status: getMilestoneStatus(interestDeadline) }] : []),\n    { label: 'Deal Close', date: closeAt, status: getMilestoneStatus(closeAt) },\n    ...(settlementDate ? [{ label: 'Settlement', date: settlementDate, status: getMilestoneStatus(settlementDate) }] : [])\n  ]\n\n  const daysToClose = getDaysRemaining(closeAt)\n  const isClosingSoon = daysToClose !== null && daysToClose > 0 && daysToClose <= 7\n  const isClosed = daysToClose !== null && daysToClose <= 0\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-base flex items-center gap-2\">\n            <Calendar className=\"h-5 w-5 text-blue-500\" />\n            Deal Timeline\n          </CardTitle>\n          {daysToClose !== null && !isClosed && (\n            <Badge variant={isClosingSoon ? \"destructive\" : \"secondary\"} className=\"flex items-center gap-1\">\n              {isClosingSoon && <AlertTriangle className=\"w-3 h-3\" />}\n              <Clock className=\"w-3 h-3\" />\n              {daysToClose} day{daysToClose !== 1 ? 's' : ''} remaining\n            </Badge>\n          )}\n          {isClosed && (\n            <Badge variant=\"secondary\" className=\"bg-muted\">\n              Closed\n            </Badge>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent>\n        {/* Desktop Timeline */}\n        <div className=\"hidden sm:block\">\n          <div className=\"flex items-center justify-between\">\n            {milestones.map((milestone, index) => (\n              <div key={milestone.label} className=\"flex items-center flex-1\">\n                <div className=\"flex flex-col items-center\">\n                  <MilestoneMarker status={milestone.status} />\n                  <div className=\"mt-2 text-center\">\n                    <p className={cn(\n                      \"text-xs font-medium\",\n                      milestone.status === 'past' && \"text-emerald-600\",\n                      milestone.status === 'current' && \"text-blue-600\",\n                      milestone.status === 'future' && \"text-muted-foreground\"\n                    )}>\n                      {milestone.label}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-0.5\">\n                      {formatDate(milestone.date)}\n                    </p>\n                  </div>\n                </div>\n                {index < milestones.length - 1 && (\n                  <TimelineConnector\n                    status={milestone.status === 'past' && milestones[index + 1]?.status === 'past'\n                      ? 'past'\n                      : milestone.status === 'past' && milestones[index + 1]?.status !== 'past'\n                        ? 'current'\n                        : 'future'\n                    }\n                  />\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Mobile Timeline (Vertical) */}\n        <div className=\"sm:hidden space-y-4\">\n          {milestones.map((milestone, index) => (\n            <div key={milestone.label} className=\"flex items-start gap-3\">\n              <div className=\"flex flex-col items-center\">\n                <MilestoneMarker status={milestone.status} />\n                {index < milestones.length - 1 && (\n                  <div className={cn(\n                    \"w-0.5 h-8 mt-2\",\n                    milestone.status === 'past' ? \"bg-emerald-400\" : \"bg-muted\"\n                  )} />\n                )}\n              </div>\n              <div className=\"pt-1\">\n                <p className={cn(\n                  \"text-sm font-medium\",\n                  milestone.status === 'past' && \"text-emerald-600\",\n                  milestone.status === 'current' && \"text-blue-600\",\n                  milestone.status === 'future' && \"text-muted-foreground\"\n                )}>\n                  {milestone.label}\n                </p>\n                <p className=\"text-xs text-muted-foreground\">\n                  {formatDate(milestone.date)}\n                </p>\n              </div>\n            </div>\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Briefcase,\n  DollarSign,\n  Tag,\n  Globe,\n  MapPin,\n  Building2,\n  TrendingUp,\n  Target,\n  Info\n} from 'lucide-react'\nimport { cn } from '@/lib/utils'\n\ninterface DealKeyDetailsCardProps {\n  dealType: string\n  currency: string\n  stockType: string | null\n  sector: string | null\n  location: string | null\n  vehicleName: string | null\n  stage: string | null\n  round: string | null\n}\n\ninterface DetailItem {\n  label: string\n  value: string | null\n  icon: typeof Briefcase\n  isBadge?: boolean\n  badgeVariant?: 'default' | 'secondary' | 'outline' | 'destructive'\n  badgeColor?: string\n}\n\nfunction formatValue(value: string | null): string {\n  if (!value) return '-'\n  // Replace underscores with spaces and capitalize\n  return value.replace(/_/g, ' ').replace(/\\b\\w/g, (c) => c.toUpperCase())\n}\n\nfunction DetailRow({ item }: { item: DetailItem }) {\n  const Icon = item.icon\n  const displayValue = formatValue(item.value)\n\n  return (\n    <div className=\"flex items-center gap-3 p-3 rounded-lg bg-muted/50\">\n      <div className=\"p-2 rounded-md bg-card shadow-sm\">\n        <Icon className=\"w-4 h-4 text-muted-foreground\" />\n      </div>\n      <div className=\"flex-1 min-w-0\">\n        <p className=\"text-xs text-muted-foreground\">{item.label}</p>\n        {item.isBadge && item.value ? (\n          <Badge\n            variant={item.badgeVariant || 'secondary'}\n            className={cn(\"mt-0.5\", item.badgeColor)}\n          >\n            {displayValue}\n          </Badge>\n        ) : (\n          <p className=\"text-sm font-medium truncate\">{displayValue}</p>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport function DealKeyDetailsCard({\n  dealType,\n  currency,\n  stockType,\n  sector,\n  location,\n  vehicleName,\n  stage,\n  round\n}: DealKeyDetailsCardProps) {\n  const details: DetailItem[] = [\n    {\n      label: 'Deal Type',\n      value: dealType,\n      icon: Briefcase,\n      isBadge: true,\n      badgeColor: 'bg-blue-100 text-blue-700 hover:bg-blue-100'\n    },\n    {\n      label: 'Stock Type',\n      value: stockType,\n      icon: Tag,\n      isBadge: true,\n      badgeColor: 'bg-purple-100 text-purple-700 hover:bg-purple-100'\n    },\n    {\n      label: 'Currency',\n      value: currency,\n      icon: DollarSign\n    },\n    {\n      label: 'Sector',\n      value: sector,\n      icon: Globe\n    },\n    {\n      label: 'Location',\n      value: location,\n      icon: MapPin\n    },\n    {\n      label: 'Vehicle',\n      value: vehicleName,\n      icon: Building2\n    },\n    {\n      label: 'Stage',\n      value: stage,\n      icon: TrendingUp\n    },\n    {\n      label: 'Round',\n      value: round,\n      icon: Target\n    }\n  ]\n\n  // Filter out items with no value (except Deal Type and Currency which are always shown)\n  const visibleDetails = details.filter(\n    (d) => d.value || d.label === 'Deal Type' || d.label === 'Currency'\n  )\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <CardTitle className=\"text-base flex items-center gap-2\">\n          <Info className=\"h-5 w-5 text-muted-foreground\" />\n          Key Details\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\n          {visibleDetails.map((item) => (\n            <DetailRow key={item.label} item={item} />\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Progress } from '@/components/ui/progress'\r\nimport {\r\n  Heart,\r\n  FileSignature,\r\n  FolderOpen,\r\n  Send,\r\n  CheckCircle2,\r\n  DollarSign,\r\n  Rocket,\r\n  ArrowRight,\r\n  Clock,\r\n  Sparkles\r\n} from 'lucide-react'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface InterestStatusCardProps {\r\n  currentStage: number\r\n  membership: {\r\n    interest_confirmed_at: string | null\r\n    nda_signed_at: string | null\r\n    data_room_granted_at: string | null\r\n  } | null\r\n  subscription: {\r\n    status: string\r\n    pack_sent_at: string | null\r\n    signed_at: string | null\r\n    funded_at: string | null\r\n  } | null\r\n  canExpressInterest: boolean\r\n  canSignNda: boolean\r\n  canSubscribe: boolean\r\n  isTrackingOnly: boolean\r\n  onExpressInterest: () => void\r\n  onSignNda: () => void\r\n  onSubscribe: () => void\r\n}\r\n\r\ninterface StageInfo {\r\n  label: string\r\n  description: string\r\n  icon: typeof Heart\r\n  color: string\r\n  bgColor: string\r\n}\r\n\r\nconst stageMetadata: Record<number, StageInfo> = {\r\n  0: {\r\n    label: 'New',\r\n    description: 'Choose to request a subscription or explore the data room first',\r\n    icon: Sparkles,\r\n    color: 'text-muted-foreground',\r\n    bgColor: 'bg-muted'\r\n  },\r\n  1: {\r\n    label: 'Received',\r\n    description: 'Deal dispatched to you',\r\n    icon: Send,\r\n    color: 'text-blue-600',\r\n    bgColor: 'bg-blue-100 dark:bg-blue-900/30'\r\n  },\r\n  2: {\r\n    label: 'Viewed',\r\n    description: 'You have viewed this deal',\r\n    icon: Clock,\r\n    color: 'text-blue-600',\r\n    bgColor: 'bg-blue-100 dark:bg-blue-900/30'\r\n  },\r\n  3: {\r\n    label: 'Interest Confirmed',\r\n    description: 'Next: Sign NDA to access documents',\r\n    icon: Heart,\r\n    color: 'text-pink-600',\r\n    bgColor: 'bg-pink-100 dark:bg-pink-900/30'\r\n  },\r\n  4: {\r\n    label: 'NDA Signed',\r\n    description: 'Access data room documents',\r\n    icon: FileSignature,\r\n    color: 'text-indigo-600',\r\n    bgColor: 'bg-indigo-100 dark:bg-indigo-900/30'\r\n  },\r\n  5: {\r\n    label: 'Data Room Access',\r\n    description: 'Review documents before subscribing',\r\n    icon: FolderOpen,\r\n    color: 'text-amber-600',\r\n    bgColor: 'bg-amber-100 dark:bg-amber-900/30'\r\n  },\r\n  6: {\r\n    label: 'Pack Generated',\r\n    description: 'Subscription documents prepared',\r\n    icon: CheckCircle2,\r\n    color: 'text-cyan-600',\r\n    bgColor: 'bg-cyan-100 dark:bg-cyan-900/30'\r\n  },\r\n  7: {\r\n    label: 'Pack Sent',\r\n    description: 'Awaiting your signature',\r\n    icon: Send,\r\n    color: 'text-violet-600',\r\n    bgColor: 'bg-violet-100 dark:bg-violet-900/30'\r\n  },\r\n  8: {\r\n    label: 'Signed',\r\n    description: 'Awaiting funding',\r\n    icon: FileSignature,\r\n    color: 'text-purple-600',\r\n    bgColor: 'bg-purple-100 dark:bg-purple-900/30'\r\n  },\r\n  9: {\r\n    label: 'Funded',\r\n    description: 'Awaiting activation',\r\n    icon: DollarSign,\r\n    color: 'text-emerald-600',\r\n    bgColor: 'bg-emerald-100 dark:bg-emerald-900/30'\r\n  },\r\n  10: {\r\n    label: 'Active',\r\n    description: 'Investment is active',\r\n    icon: Rocket,\r\n    color: 'text-green-600',\r\n    bgColor: 'bg-green-100 dark:bg-green-900/30'\r\n  }\r\n}\r\n\r\nfunction formatDate(dateString: string | null): string {\r\n  if (!dateString) return ''\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    month: 'short',\r\n    day: 'numeric',\r\n    year: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  })\r\n}\r\n\r\nfunction getLastAction(\r\n  membership: InterestStatusCardProps['membership'],\r\n  subscription: InterestStatusCardProps['subscription']\r\n): { action: string; timestamp: string } | null {\r\n  const actions: { action: string; timestamp: string | null }[] = [\r\n    { action: 'Investment activated', timestamp: subscription?.funded_at && subscription.status === 'active' ? subscription.funded_at : null },\r\n    { action: 'Funded', timestamp: subscription?.funded_at ?? null },\r\n    { action: 'Subscription signed', timestamp: subscription?.signed_at ?? null },\r\n    { action: 'Pack sent', timestamp: subscription?.pack_sent_at ?? null },\r\n    { action: 'Data room access granted', timestamp: membership?.data_room_granted_at ?? null },\r\n    { action: 'NDA signed', timestamp: membership?.nda_signed_at ?? null },\r\n    { action: 'Interest confirmed', timestamp: membership?.interest_confirmed_at ?? null }\r\n  ]\r\n\r\n  for (const item of actions) {\r\n    if (item.timestamp) {\r\n      return { action: item.action, timestamp: formatDate(item.timestamp) }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\nexport function InterestStatusCard({\r\n  currentStage,\r\n  membership,\r\n  subscription,\r\n  canExpressInterest,\r\n  canSignNda,\r\n  canSubscribe,\r\n  isTrackingOnly,\r\n  onExpressInterest,\r\n  onSignNda,\r\n  onSubscribe\r\n}: InterestStatusCardProps) {\r\n  const stageInfo = stageMetadata[currentStage] || stageMetadata[0]\r\n  const Icon = stageInfo.icon\r\n  const lastAction = getLastAction(membership, subscription)\r\n  const progressPercentage = (currentStage / 10) * 100\r\n\r\n  // Determine if we're in early stages where both options should be shown\r\n  const isEarlyStage = currentStage <= 2 && !subscription\r\n  const showTrackingNotice = isTrackingOnly\r\n  const showSubscribeOption = canSubscribe && !showTrackingNotice\r\n  const showExpressOption = canExpressInterest && !showTrackingNotice\r\n  const showEarlyStageActions = isEarlyStage && (showSubscribeOption || showExpressOption)\r\n\r\n  // Determine primary action based on stage\r\n  const primaryAction: { label: string; onClick: () => void; icon: typeof Heart } | null =\r\n    !showTrackingNotice && canSignNda\r\n      ? { label: 'Sign NDA', onClick: onSignNda, icon: FileSignature }\r\n      : !showTrackingNotice && canSubscribe\r\n        ? { label: 'Subscribe Now', onClick: onSubscribe, icon: Rocket }\r\n        : null\r\n\r\n  return (\r\n    <Card className=\"border-2 border-dashed border-border bg-gradient-to-br from-background to-muted\">\r\n      <CardHeader className=\"pb-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"text-base flex items-center gap-2\">\r\n            <Heart className=\"h-5 w-5 text-pink-500\" />\r\n            Your Interest Status\r\n          </CardTitle>\r\n          <Badge className={cn(stageInfo.bgColor, stageInfo.color, \"border-0\")}>\r\n            Stage {currentStage}/10\r\n          </Badge>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        {/* Current Status */}\r\n        <div className=\"flex items-start gap-4\">\r\n          <div className={cn(\"p-3 rounded-xl\", stageInfo.bgColor)}>\r\n            <Icon className={cn(\"w-6 h-6\", stageInfo.color)} />\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <h3 className={cn(\"font-semibold text-lg\", stageInfo.color)}>\r\n              {stageInfo.label}\r\n            </h3>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              {stageInfo.description}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress Bar */}\r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n            <span>Journey Progress</span>\r\n            <span>{currentStage}/10 stages</span>\r\n          </div>\r\n          <Progress value={progressPercentage} className=\"h-2\" />\r\n        </div>\r\n\r\n        {showTrackingNotice && (\r\n          <div className=\"rounded-lg border border-amber-200 bg-amber-50 p-3 text-amber-900 dark:border-amber-900/40 dark:bg-amber-900/20 dark:text-amber-200\">\r\n            <p className=\"text-sm font-medium\">Tracking Only Access</p>\r\n            <p className=\"text-xs text-amber-700 dark:text-amber-300\">\r\n              You can view this deal, but investment actions are disabled. Contact your relationship manager for investor access.\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Last Action */}\r\n        {lastAction && (\r\n          <div className=\"p-3 rounded-lg bg-muted text-sm\">\r\n            <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n              <Clock className=\"w-4 h-4\" />\r\n              <span className=\"font-medium\">{lastAction.action}</span>\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground mt-1 ml-6\">\r\n              {lastAction.timestamp}\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Two-Path Actions for Early Stages */}\r\n        {showEarlyStageActions && (\r\n          <div className=\"space-y-4\">\r\n            {/* Primary Path: Subscribe Directly */}\r\n            {showSubscribeOption && (\r\n              <button\r\n                onClick={onSubscribe}\r\n                className=\"w-full p-4 rounded-lg border-2 border-emerald-200 dark:border-emerald-800 bg-emerald-50 dark:bg-emerald-900/20 hover:border-emerald-400 dark:hover:border-emerald-600 transition-colors text-left group\"\r\n              >\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-emerald-600 text-white\">\r\n                    <Rocket className=\"w-5 h-5\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-semibold text-emerald-700 dark:text-emerald-300 flex items-center gap-2\">\r\n                      Subscribe to Investment\r\n                      <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\r\n                    </div>\r\n                    <div className=\"text-sm text-emerald-600 dark:text-emerald-400 mt-0.5\">\r\n                      Direct path • NDA + Subscription Pack\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </button>\r\n            )}\r\n\r\n            {/* OR Divider */}\r\n            {showSubscribeOption && showExpressOption && (\r\n              <div className=\"relative flex items-center\">\r\n                <div className=\"flex-1 h-px bg-border\" />\r\n                <span className=\"px-3 text-xs text-muted-foreground font-medium bg-background\">OR</span>\r\n                <div className=\"flex-1 h-px bg-border\" />\r\n              </div>\r\n            )}\r\n\r\n            {/* Secondary Path: Data Room */}\r\n            {showExpressOption && (\r\n              <button\r\n                onClick={onExpressInterest}\r\n                className=\"w-full p-4 rounded-lg border border-dashed border-border hover:border-amber-400 transition-colors text-left group\"\r\n              >\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-600\">\r\n                    <Heart className=\"w-5 h-5\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-medium text-foreground flex items-center gap-2\">\r\n                      Request Data Room Access\r\n                    </div>\r\n                    <div className=\"text-sm text-muted-foreground mt-0.5\">\r\n                      Review documents before committing\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Single Action Button for Later Stages */}\r\n        {!isEarlyStage && primaryAction && (\r\n          <Button\r\n            onClick={primaryAction.onClick}\r\n            className=\"w-full\"\r\n            size=\"lg\"\r\n          >\r\n            <primaryAction.icon className=\"w-4 h-4 mr-2\" />\r\n            {primaryAction.label}\r\n            <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n          </Button>\r\n        )}\r\n\r\n        {/* Completion Message for Active Investments */}\r\n        {currentStage === 10 && (\r\n          <div className=\"p-4 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 text-center\">\r\n            <CheckCircle2 className=\"w-8 h-8 mx-auto text-emerald-600 mb-2\" />\r\n            <p className=\"font-medium text-emerald-700 dark:text-emerald-300\">\r\n              Investment Active\r\n            </p>\r\n            <p className=\"text-sm text-emerald-600 dark:text-emerald-400\">\r\n              View in your Portfolio for NAV tracking\r\n            </p>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle\n} from '@/components/ui/dialog'\nimport { Progress } from '@/components/ui/progress'\nimport { Textarea } from '@/components/ui/textarea'\nimport {\n  FileSignature,\n  FileText,\n  Download,\n  Clock,\n  CheckCircle2,\n  DollarSign,\n  Rocket,\n  Award,\n  ChevronDown,\n  ExternalLink,\n  Banknote,\n  MessageSquare\n} from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { toast } from 'sonner'\n\r\ninterface DocumentSignatory {\r\n  name: string\r\n  email: string\r\n  status: string\r\n  signed_at: string | null\r\n}\r\n\r\ninterface SubscriptionDocument {\r\n  status: string\r\n  signatories: DocumentSignatory[]\r\n  unsigned_url: string | null\r\n  signed_url: string | null\r\n}\r\n\r\ninterface SubscriptionStatusCardProps {\n  subscription: {\n    id: string\r\n    status: string\r\n    commitment: number | null\r\n    currency: string\r\n    funded_amount: number | null\r\n    pack_generated_at: string | null\r\n    pack_sent_at: string | null\r\n    signed_at: string | null\r\n    funded_at: string | null\r\n    activated_at: string | null\r\n    created_at: string | null\r\n    is_signed: boolean\r\n    is_funded: boolean\r\n    is_active: boolean\r\n    documents: {\r\n      nda: SubscriptionDocument\r\n      subscription_pack: SubscriptionDocument\r\n      certificate: {\r\n        status: string\r\n        url: string | null\r\n      } | null\r\n    } | null\r\n  }\n  dealCurrency?: string\n  dealId?: string\n  dealName?: string\n}\n\r\nfunction formatCurrency(amount: number | null, currency: string = 'USD'): string {\r\n  if (!amount) return '-'\r\n  return new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency,\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0\r\n  }).format(amount)\r\n}\r\n\r\nfunction formatDateShort(dateString: string | null): string {\r\n  if (!dateString) return ''\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    month: 'short',\r\n    day: 'numeric'\r\n  })\r\n}\r\n\r\nfunction getStatusConfig(status: string) {\r\n  switch (status) {\r\n    case 'active':\r\n      return { label: 'Active', color: 'text-emerald-600', bg: 'bg-emerald-100 dark:bg-emerald-900/30', icon: Rocket }\r\n    case 'committed':\r\n      return { label: 'Committed', color: 'text-blue-600', bg: 'bg-blue-100 dark:bg-blue-900/30', icon: CheckCircle2 }\r\n    case 'funded':\r\n      return { label: 'Funded', color: 'text-purple-600', bg: 'bg-purple-100 dark:bg-purple-900/30', icon: DollarSign }\r\n    case 'pending':\r\n    default:\r\n      return { label: 'Pending', color: 'text-amber-600', bg: 'bg-amber-100 dark:bg-amber-900/30', icon: Clock }\r\n  }\r\n}\r\n\r\n// Compact document row with expand/collapse\r\nfunction DocumentRow({\r\n  icon: Icon,\r\n  iconColor,\r\n  label,\r\n  doc\r\n}: {\r\n  icon: typeof FileText\r\n  iconColor: string\r\n  label: string\r\n  doc: SubscriptionDocument\r\n}) {\r\n  const [expanded, setExpanded] = useState(false)\r\n  const signedCount = doc.signatories.filter(s => s.status === 'signed').length\r\n  const totalCount = doc.signatories.length\r\n  const isComplete = doc.status === 'complete'\r\n  const hasUrl = doc.signed_url || doc.unsigned_url\r\n\r\n  return (\r\n    <div>\r\n      <button\r\n        type=\"button\"\r\n        className={cn(\r\n          \"w-full flex items-center gap-2.5 py-2 px-2.5 rounded-md text-left transition-colors\",\r\n          totalCount > 0 && \"hover:bg-muted/50 cursor-pointer\",\r\n          expanded && \"bg-muted/30\"\r\n        )}\r\n        onClick={() => totalCount > 0 && setExpanded(!expanded)}\r\n        disabled={totalCount === 0}\r\n      >\r\n        <Icon className={cn(\"w-4 h-4 shrink-0\", iconColor)} />\r\n        <span className=\"text-sm font-medium flex-1\">{label}</span>\r\n        <div className=\"flex items-center gap-1.5\">\r\n          {totalCount > 0 && (\r\n            <span className={cn(\"text-xs tabular-nums\", isComplete ? \"text-emerald-600\" : \"text-muted-foreground\")}>\r\n              {signedCount}/{totalCount}\r\n            </span>\r\n          )}\r\n          {isComplete ? (\r\n            <CheckCircle2 className=\"w-3.5 h-3.5 text-emerald-500\" />\r\n          ) : (\r\n            <Clock className=\"w-3.5 h-3.5 text-amber-500\" />\r\n          )}\r\n          {totalCount > 0 && (\r\n            <ChevronDown className={cn(\"w-3 h-3 text-muted-foreground transition-transform\", expanded && \"rotate-180\")} />\r\n          )}\r\n        </div>\r\n      </button>\r\n\r\n      {/* Expanded content */}\r\n      {expanded && (\r\n        <div className=\"ml-6 mr-2 mt-1 mb-1.5 space-y-1\">\r\n          {doc.signatories.map((sig, idx) => (\r\n            <div key={idx} className=\"flex items-center justify-between text-xs py-0.5 px-2 rounded bg-muted/40\">\r\n              <span className=\"text-muted-foreground truncate max-w-[120px]\">{sig.name}</span>\r\n              {sig.status === 'signed' ? (\r\n                <span className=\"text-emerald-600 flex items-center gap-1\">\r\n                  <CheckCircle2 className=\"w-2.5 h-2.5\" />\r\n                  {sig.signed_at ? formatDateShort(sig.signed_at) : 'Done'}\r\n                </span>\r\n              ) : (\r\n                <span className=\"text-amber-500 text-[10px]\">Pending</span>\r\n              )}\r\n            </div>\r\n          ))}\r\n          {hasUrl && (\r\n            <Button\r\n              size=\"sm\"\r\n              variant=\"ghost\"\r\n              className=\"h-5 text-[10px] px-2 mt-0.5\"\r\n              onClick={(e) => {\r\n                e.stopPropagation()\r\n                window.open(doc.signed_url || doc.unsigned_url!, '_blank')\r\n              }}\r\n            >\r\n              {doc.signed_url ? <Download className=\"w-2.5 h-2.5 mr-1\" /> : <ExternalLink className=\"w-2.5 h-2.5 mr-1\" />}\r\n              {doc.signed_url ? 'Download' : 'View'}\r\n            </Button>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function SubscriptionStatusCard({\n  subscription,\n  dealCurrency,\n  dealId,\n  dealName\n}: SubscriptionStatusCardProps) {\n  const statusConfig = getStatusConfig(subscription.status)\n  const StatusIcon = statusConfig.icon\n  const currency = subscription.currency || dealCurrency || 'USD'\n  const docs = subscription.documents\n  const [clarificationOpen, setClarificationOpen] = useState(false)\n  const [clarificationSubject, setClarificationSubject] = useState(\n    dealName ? `Subscription pack clarification - ${dealName}` : 'Subscription pack clarification'\n  )\n  const [clarificationDetails, setClarificationDetails] = useState('')\n  const [clarificationSubmitting, setClarificationSubmitting] = useState(false)\n\r\n  // Progress calculation\r\n  const steps = [\r\n    { key: 'generated', done: !!subscription.pack_generated_at },\r\n    { key: 'sent', done: !!subscription.pack_sent_at },\r\n    { key: 'signed', done: !!subscription.signed_at },\r\n    { key: 'funded', done: !!subscription.funded_at },\r\n    { key: 'active', done: !!subscription.activated_at }\r\n  ]\r\n  const completedSteps = steps.filter(s => s.done).length\r\n  const progressPercent = (completedSteps / steps.length) * 100\r\n\r\n  return (\r\n    <Card className=\"border-2 border-dashed border-gray-200 dark:border-gray-800 bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-gray-950\">\r\n      <CardHeader className=\"pb-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"text-base flex items-center gap-2\">\r\n            <Banknote className=\"h-5 w-5 text-emerald-500\" />\r\n            Your Subscription\r\n          </CardTitle>\r\n          <Badge className={cn(statusConfig.bg, statusConfig.color, \"border-0\")}>\r\n            <StatusIcon className=\"w-3 h-3 mr-1\" />\r\n            {statusConfig.label}\r\n          </Badge>\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"space-y-4\">\r\n        {/* Commitment - Compact inline display */}\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className={cn(\"p-2.5 rounded-xl\", statusConfig.bg)}>\r\n            <DollarSign className={cn(\"w-5 h-5\", statusConfig.color)} />\r\n          </div>\r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"text-xl font-bold tracking-tight\">\r\n              {formatCurrency(subscription.commitment, currency)}\r\n            </div>\r\n            {subscription.funded_amount !== null && subscription.funded_amount > 0 && (\r\n              <div className=\"text-xs text-muted-foreground\">\r\n                Funded: {formatCurrency(subscription.funded_amount, currency)}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress Bar */}\r\n        <div className=\"space-y-1.5\">\r\n          <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n            <span>Progress</span>\r\n            <span>{completedSteps}/{steps.length}</span>\r\n          </div>\r\n          <Progress value={progressPercent} className=\"h-1.5\" />\r\n        </div>\r\n\r\n        {/* Documents - Compact collapsible list */}\r\n        {docs && (\n          <div className=\"rounded-lg border divide-y bg-card/50\">\n            <DocumentRow icon={FileSignature} iconColor=\"text-blue-500\" label=\"NDA\" doc={docs.nda} />\n            <DocumentRow icon={FileText} iconColor=\"text-purple-500\" label=\"Subscription Pack\" doc={docs.subscription_pack} />\n            {(docs.certificate || subscription.is_active) && (\r\n              <div className=\"flex items-center gap-2.5 py-2 px-2.5\">\r\n                <Award className={cn(\"w-4 h-4\", docs.certificate?.status === 'available' ? \"text-amber-500\" : \"text-muted-foreground\")} />\r\n                <span className=\"text-sm font-medium flex-1\">Certificate</span>\r\n                {docs.certificate?.status === 'available' ? (\r\n                  <div className=\"flex items-center gap-1.5\">\r\n                    <CheckCircle2 className=\"w-3.5 h-3.5 text-emerald-500\" />\r\n                    {docs.certificate.url && (\r\n                      <Button size=\"sm\" variant=\"ghost\" className=\"h-5 px-1.5\" onClick={() => window.open(docs.certificate!.url!, '_blank')}>\r\n                        <Download className=\"w-3 h-3\" />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                ) : (\r\n                  <span className=\"text-xs text-muted-foreground\">Pending</span>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\n        )}\n\n        {/* Clarification request */}\n        <div className=\"pt-1\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            className=\"w-full\"\n            onClick={() => setClarificationOpen(true)}\n            disabled={!dealId}\n          >\n            <MessageSquare className=\"w-4 h-4 mr-2\" />\n            Request Clarification\n          </Button>\n        </div>\n\n        {/* Active banner */}\n        {subscription.is_active && (\n          <div className=\"flex items-center gap-2.5 p-2.5 rounded-lg bg-emerald-50 dark:bg-emerald-900/20\">\r\n            <Rocket className=\"w-4 h-4 text-emerald-600\" />\r\n            <div className=\"flex-1\">\r\n              <div className=\"text-sm font-medium text-emerald-700 dark:text-emerald-300\">Investment Active</div>\r\n              <div className=\"text-xs text-emerald-600 dark:text-emerald-400\">Track in Portfolio</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* No docs placeholder */}\r\n        {!docs && (\r\n          <div className=\"flex items-center gap-2.5 p-3 rounded-lg bg-muted/30 text-muted-foreground\">\r\n            <FileText className=\"w-4 h-4\" />\r\n            <span className=\"text-sm\">Documents being prepared...</span>\r\n          </div>\r\n        )}\r\n      </CardContent>\n\n      <Dialog open={clarificationOpen} onOpenChange={setClarificationOpen}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Request Clarification</DialogTitle>\n            <DialogDescription>\n              Submit questions or clarification requests about the subscription pack.\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Subject</label>\n              <Input\n                value={clarificationSubject}\n                onChange={(e) => setClarificationSubject(e.target.value)}\n                placeholder=\"Subscription pack clarification\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Details</label>\n              <Textarea\n                value={clarificationDetails}\n                onChange={(e) => setClarificationDetails(e.target.value)}\n                placeholder=\"Share the exact sections or questions you need clarified...\"\n                rows={5}\n              />\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setClarificationOpen(false)}\n              disabled={clarificationSubmitting}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={async () => {\n                if (!dealId) return\n                if (!clarificationSubject.trim()) {\n                  toast.error('Please enter a subject for your clarification request.')\n                  return\n                }\n                if (!clarificationDetails.trim()) {\n                  toast.error('Please include details for your clarification request.')\n                  return\n                }\n\n                try {\n                  setClarificationSubmitting(true)\n                  const response = await fetch('/api/requests', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                      category: 'communication',\n                      subject: clarificationSubject.trim(),\n                      details: clarificationDetails.trim(),\n                      dealId\n                    })\n                  })\n\n                  if (!response.ok) {\n                    const errorData = await response.json()\n                    throw new Error(errorData.error || 'Failed to submit clarification')\n                  }\n\n                  toast.success('Clarification request submitted.')\n                  setClarificationDetails('')\n                  setClarificationOpen(false)\n                } catch (error) {\n                  console.error('[SubscriptionStatusCard] Clarification error:', error)\n                  toast.error(error instanceof Error ? error.message : 'Failed to submit clarification')\n                } finally {\n                  setClarificationSubmitting(false)\n                }\n              }}\n              disabled={clarificationSubmitting}\n            >\n              {clarificationSubmitting ? 'Submitting...' : 'Submit'}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </Card>\n  )\n}\n","export { ProxyModeProvider, useProxyMode } from './proxy-mode-context'\nexport { ProxyModeBanner } from './proxy-mode-banner'\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M2 3h20', key: '91anmk' }],\n  ['path', { d: 'M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3', key: '2k9sn8' }],\n  ['path', { d: 'm7 21 5-5 5 5', key: 'bip4we' }],\n];\n\n/**\n * @component @name Presentation\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMiAzaDIwIiAvPgogIDxwYXRoIGQ9Ik0yMSAzdjExYTIgMiAwIDAgMS0yIDJINWEyIDIgMCAwIDEtMi0yVjMiIC8+CiAgPHBhdGggZD0ibTcgMjEgNS01IDUgNSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/presentation\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Presentation = createLucideIcon('presentation', __iconNode);\n\nexport default Presentation;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M21 4v16', key: '7j8fe9' }],\n  [\n    'path',\n    {\n      d: 'M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z',\n      key: 'zs4d6',\n    },\n  ],\n];\n\n/**\n * @component @name SkipForward\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgNHYxNiIgLz4KICA8cGF0aCBkPSJNNi4wMjkgNC4yODVBMiAyIDAgMCAwIDMgNnYxMmEyIDIgMCAwIDAgMy4wMjkgMS43MTVsOS45OTctNS45OThhMiAyIDAgMCAwIC4wMDMtMy40MzJ6IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/skip-forward\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst SkipForward = createLucideIcon('skip-forward', __iconNode);\n\nexport default SkipForward;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M14 2v4a2 2 0 0 0 2 2h4', key: 'tnqrlb' }],\n  ['path', { d: 'M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z', key: '1mlx9k' }],\n  [\n    'path',\n    {\n      d: 'M15.033 13.44a.647.647 0 0 1 0 1.12l-4.065 2.352a.645.645 0 0 1-.968-.56v-4.704a.645.645 0 0 1 .967-.56z',\n      key: '1tzo1f',\n    },\n  ],\n];\n\n/**\n * @component @name FilePlay\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTQgMnY0YTIgMiAwIDAgMCAyIDJoNCIgLz4KICA8cGF0aCBkPSJNMTUgMkg2YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjd6IiAvPgogIDxwYXRoIGQ9Ik0xNS4wMzMgMTMuNDRhLjY0Ny42NDcgMCAwIDEgMCAxLjEybC00LjA2NSAyLjM1MmEuNjQ1LjY0NSAwIDAgMS0uOTY4LS41NnYtNC43MDRhLjY0NS42NDUgMCAwIDEgLjk2Ny0uNTZ6IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/file-play\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst FilePlay = createLucideIcon('file-play', __iconNode);\n\nexport default FilePlay;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z', key: '1rqfz7' }],\n  ['path', { d: 'M14 2v4a2 2 0 0 0 2 2h4', key: 'tnqrlb' }],\n  ['circle', { cx: '10', cy: '12', r: '2', key: '737tya' }],\n  ['path', { d: 'm20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22', key: 'wt3hpn' }],\n];\n\n/**\n * @component @name FileImage\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTUgMkg2YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjdaIiAvPgogIDxwYXRoIGQ9Ik0xNCAydjRhMiAyIDAgMCAwIDIgMmg0IiAvPgogIDxjaXJjbGUgY3g9IjEwIiBjeT0iMTIiIHI9IjIiIC8+CiAgPHBhdGggZD0ibTIwIDE3LTEuMjk2LTEuMjk2YTIuNDEgMi40MSAwIDAgMC0zLjQwOCAwTDkgMjIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/file-image\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst FileImage = createLucideIcon('file-image', __iconNode);\n\nexport default FileImage;\n"],"names":[],"mappings":"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CAAK,AAAL,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,GDmB5E,EAAA,CAAA,EAAW,CAAA,CAAA,OAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,GAAa,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAtBpC,AAsBoC,CCtBpC,AFAA,ADAA,AEAA,AAsBoC,CAAU,CAAA,iHArBqB,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,EAEzF,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CAAA,ACAD,CAAA,ADAC,CAAA,ACAD,+GDGG,GAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EACP,CAEJ,CDYA,CAAA,ADLA,CCKA,CAAA,ADLA,CAAA,EAAqB,CCZZ,ADYY,CCZZ,ADYY,CCZZ,ADYY,CAAA,ACZZ,CAAA,ADYY,CCZZ,ADYY,CCZZ,ADYY,CAAA,ACZZ,CDYY,ACZZ,ADYY,CCZZ,ADYY,CCZZ,ADYY,AAAiB,CCZ7B,ADYY,AAAiB,CAAjB,ACZZ,ADY6B,CAAjB,ACZZ,ADY6B,CCZ7B,ADYY,ACZZ,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADY6B,CCZ7B,ADL2B,0BACJ,sBAChB,CAAA,AEAA,ACAA,CAAA,ADAA,AFAA,CEAA,ACAA,AHAA,CEAA,ACAA,AHAA,CAAA,AGAA,ADAA,CFAA,AGAA,ADAA,CCAA,ADAA,AFAA,CGAA,ADAA,AFAA,CGAA,ADAA,AFAA,CGAA,ADAA,AFAA,CEAA,AFAA,AGAA,CAAA,ADAA,AFAA,CGAA,AHAA,AEAA,CFAA,AGAA,ADAA,CAAA,ACAA,AHAA,CGAA,AHAA,AEAA,CFAA,AGAA,ADAA,CCAA,ADAA,AFAA,CGAA,AHAA,AEAA,CFAA,AEAA,ACAA,CAAA,ADAA,AFAA,CGAA,ADAA,AFAA,CAAA,AGAA,ADAA,CCAA,ADAA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","ignoreList":[8,9,10,11]}