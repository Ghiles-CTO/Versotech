module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},9349,a=>{a.n(a.i(142710))},199585,a=>{a.n(a.i(701395))},929852,a=>{a.n(a.i(816404))},516153,a=>{a.n(a.i(422096))},911164,a=>{a.n(a.i(273021))},16933,a=>{a.n(a.i(618450))},498419,a=>{a.n(a.i(72598))},810300,a=>{a.n(a.i(932455))},513594,a=>{"use strict";a.s(["AddInvestorModal",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call AddInvestorModal() from the server but AddInvestorModal is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/add-investor-modal.tsx <module evaluation>","AddInvestorModal")},448982,a=>{"use strict";a.s(["AddInvestorModal",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call AddInvestorModal() from the server but AddInvestorModal is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/add-investor-modal.tsx","AddInvestorModal")},451717,a=>{"use strict";a.i(513594);var b=a.i(448982);a.n(b)},122023,a=>{"use strict";a.s(["InvestorFilters",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorFilters() from the server but InvestorFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-filters.tsx <module evaluation>","InvestorFilters")},322846,a=>{"use strict";a.s(["InvestorFilters",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorFilters() from the server but InvestorFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-filters.tsx","InvestorFilters")},264551,a=>{"use strict";a.i(122023);var b=a.i(322846);a.n(b)},971079,a=>{"use strict";a.s(["ExportInvestorsButton",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call ExportInvestorsButton() from the server but ExportInvestorsButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/export-investors-button.tsx <module evaluation>","ExportInvestorsButton")},426786,a=>{"use strict";a.s(["ExportInvestorsButton",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call ExportInvestorsButton() from the server but ExportInvestorsButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/export-investors-button.tsx","ExportInvestorsButton")},508568,a=>{"use strict";a.i(971079);var b=a.i(426786);a.n(b)},597387,a=>{"use strict";a.s(["InvestorSearch",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorSearch() from the server but InvestorSearch is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-search.tsx <module evaluation>","InvestorSearch")},628439,a=>{"use strict";a.s(["InvestorSearch",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorSearch() from the server but InvestorSearch is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-search.tsx","InvestorSearch")},239622,a=>{"use strict";a.i(597387);var b=a.i(628439);a.n(b)},137548,a=>{"use strict";a.s(["InvestorsDataTable",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorsDataTable() from the server but InvestorsDataTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investors-data-table.tsx <module evaluation>","InvestorsDataTable")},190362,a=>{"use strict";a.s(["InvestorsDataTable",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorsDataTable() from the server but InvestorsDataTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investors-data-table.tsx","InvestorsDataTable")},462575,a=>{"use strict";a.i(137548);var b=a.i(190362);a.n(b)},619541,a=>{"use strict";a.s(["dispatchInvestorInvite",()=>c,"investorColumns",()=>d]);var b=a.i(578644);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call dispatchInvestorInvite() from the server but dispatchInvestorInvite is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-columns.tsx <module evaluation>","dispatchInvestorInvite"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call investorColumns() from the server but investorColumns is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-columns.tsx <module evaluation>","investorColumns")},822811,a=>{"use strict";a.s(["dispatchInvestorInvite",()=>c,"investorColumns",()=>d]);var b=a.i(578644);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call dispatchInvestorInvite() from the server but dispatchInvestorInvite is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-columns.tsx","dispatchInvestorInvite"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call investorColumns() from the server but investorColumns is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-columns.tsx","investorColumns")},644231,a=>{"use strict";a.i(619541);var b=a.i(822811);a.n(b)},772587,a=>{"use strict";var b=a.i(714898),c=a.i(944497),d=a.i(198307),e=a.i(243085),f=a.i(451717),g=a.i(264551),h=a.i(508568),i=a.i(239622),j=a.i(462575),k=a.i(644231);let l=[{id:"1",name:"Acme Fund LP",type:"institutional",email:"contact@acmefund.com",kycStatus:"completed",onboardingStatus:"active",totalCommitment:25e5,totalContributed:18e5,vehicleCount:3,metricsAvailable:!0,lastActivity:"2024-01-15",relationshipManager:"Sarah Chen",riskRating:"low",country:"United States",users:[]},{id:"2",name:"John Smith",type:"individual",email:"john.smith@email.com",kycStatus:"pending",onboardingStatus:"in_progress",totalCommitment:5e5,totalContributed:25e4,vehicleCount:1,metricsAvailable:!0,lastActivity:"2024-01-14",relationshipManager:"Michael Rodriguez",riskRating:"medium",country:"United Kingdom",users:[]},{id:"3",name:"Global Investments LLC",type:"institutional",email:"investments@global.com",kycStatus:"completed",onboardingStatus:"active",totalCommitment:5e6,totalContributed:42e5,vehicleCount:5,metricsAvailable:!0,lastActivity:"2024-01-16",relationshipManager:"Sarah Chen",riskRating:"low",country:"Luxembourg",users:[]}];async function m({searchParams:a}){await (0,e.requireStaffAuth)();let b=await (0,d.createClient)(),c=await a,f=parseInt(c.limit||"1000"),g=parseInt(c.page||"1"),h=(g-1)*f,i=b.from("investors").select(`
        id,
        legal_name,
        type,
        kyc_status,
        country,
        status,
        onboarding_status,
        aml_risk_rating,
        created_at,
        primary_rm,
        rm_profile:profiles!investors_primary_rm_fkey (
          id,
          display_name,
          email
        ),
        investor_users (
          user_id,
          profiles:profiles!investor_users_user_id_fkey (
            id,
            display_name,
            email,
            title,
            role
          )
        )
      `,{count:"exact"});c.q&&(i=i.or(`legal_name.ilike.%${c.q}%,email.ilike.%${c.q}%`)),c.status&&(i=i.eq("kyc_status",c.status)),c.type&&(i=i.eq("type",c.type)),c.rm&&(i=i.eq("primary_rm",c.rm));let{data:j,error:k,count:m}=await i.order("created_at",{ascending:!1}).range(h,h+f-1);if(k)return console.error("[Investors] Error fetching investors:",k),p(l,{source:"error"});let q=(j||[]).map(a=>({...a,rm_profile:Array.isArray(a.rm_profile)?a.rm_profile[0]:a.rm_profile,investor_users:a.investor_users?.map(a=>({user_id:a.user_id,profiles:Array.isArray(a.profiles)?a.profiles[0]:a.profiles}))}));if(0===q.length)return console.warn("[Investors] No investors returned. Using fallback dataset."),p(l,{source:"empty"});let r=q.map(a=>a.id),[s,t]=await Promise.all([n(b,r),o(b,r)]);return p(q.map(a=>{var b;let c=(a.investor_users||[]).map(a=>({id:a.profiles?.id||a.user_id,name:a.profiles?.display_name||"Unnamed User",email:a.profiles?.email||"No email",title:a.profiles?.title||"â€”"})),d=c[0],e=s.get(a.id);return{id:a.id,name:a.legal_name||"Unnamed Investor",type:a.type||"individual",email:d?.email||"No primary contact",kycStatus:function(a){if(!a)return"pending";let b=a.toLowerCase();return"approved"===b?"completed":b}(a.kyc_status),onboardingStatus:a.onboarding_status||(e?.total_commitment?"completed":"pending"),totalCommitment:e?.total_commitment||0,totalContributed:e?.total_contributed||0,vehicleCount:e?.vehicle_count||0,metricsAvailable:!!e,lastActivity:t.get(a.id)||a.created_at||new Date().toISOString(),relationshipManager:a.rm_profile?.display_name||"Unassigned",riskRating:a.aml_risk_rating||((b=a.kyc_status)&&"approved"===b.toLowerCase()?"low":"medium"),country:a.country||"Unknown",users:c}}),{source:"live",pagination:{currentPage:g,totalPages:Math.ceil((m||0)/f),totalCount:m||0,limit:f},filters:c})}async function n(a,b){let c=new Map;if(0===b.length)return c;try{let{data:d,error:e}=await a.rpc("get_investor_capital_summary",{p_investor_ids:b});if(e)return console.warn("[Investors] Capital summary RPC failed:",e.message),c;d.forEach(a=>{c.set(a.investor_id,a)})}catch(a){console.warn("[Investors] Capital summary RPC unavailable:",a)}return c}async function o(a,b){let c=new Map;if(0===b.length)return c;try{let{data:d,error:e}=await a.from("activity_feed").select("investor_id, created_at").in("investor_id",b).order("created_at",{ascending:!1});if(e)return console.warn("[Investors] Failed to fetch activity feed:",e.message),c;d.forEach(a=>{c.has(a.investor_id)||c.set(a.investor_id,a.created_at)})}catch(a){console.warn("[Investors] Activity feed unavailable:",a)}return c}function p(a,d){d?.source&&!["live","demo"].includes(d.source)&&console.warn("[Investors] Rendering fallback dataset from",d.source);let e={total:d?.pagination?.totalCount||a.length,active:a.filter(a=>"completed"===a.onboardingStatus||"active"===a.onboardingStatus).length,pending:a.filter(a=>["pending","review"].includes(a.kycStatus)).length,entities:a.filter(a=>"entity"===a.type).length,individuals:a.filter(a=>"individual"===a.type).length};return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Investor Management"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage investor accounts, linked users, and onboarding status"})]}),(0,b.jsx)(f.AddInvestorModal,{})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Investors"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-foreground",children:e.total}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Registered accounts"})]})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Active Accounts"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-400",children:e.active}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Fully onboarded"})]})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Pending KYC"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:e.pending}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Require attention"})]})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Entities"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:e.entities}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Corporate investors"})]})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Individuals"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:e.individuals}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Natural persons"})]})]})]}),(0,b.jsx)(c.Card,{children:(0,b.jsx)(c.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)(i.InvestorSearch,{})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.InvestorFilters,{}),(0,b.jsx)(h.ExportInvestorsButton,{investors:a})]})]})})}),(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsxs)(c.CardTitle,{children:["All Investors (",d?.pagination?.totalCount||a.length,")"]}),(0,b.jsxs)(c.CardDescription,{children:["Comprehensive investor list with sortable columns and bulk actions",d?.pagination?.totalCount&&d.pagination.totalCount>a.length&&(0,b.jsxs)("span",{className:"text-muted-foreground text-sm ml-2",children:["(Showing ",a.length," of ",d.pagination.totalCount,")"]})]})]}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)(j.InvestorsDataTable,{columns:k.investorColumns,data:a})})]})]})}a.s(["default",()=>m,"dynamic",0,"force-dynamic","revalidate",0,0])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__40607f96._.js.map