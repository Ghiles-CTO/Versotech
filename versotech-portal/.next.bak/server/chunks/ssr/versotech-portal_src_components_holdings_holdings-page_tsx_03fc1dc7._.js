module.exports=[405002,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(58834),e=a.i(284169),f=a.i(421908),g=a.i(15788),h=a.i(778541),i=a.i(877028),j=a.i(688611),k=a.i(168118),l=a.i(711903);let m=["#1e3a5f","#0d9488","#6366f1","#d97706","#dc2626","#059669","#8b5cf6","#0891b2"],n=(a,b="$")=>a>=1e6?`${b}${(a/1e6).toFixed(2)}M`:a>=1e3?`${b}${(a/1e3).toFixed(0)}K`:`${b}${a.toFixed(0)}`;function o({data:a,maxVisibleItems:d=6,currency:g="USD"}){let[h,i]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),q=!a||0===a.length,r=(0,c.useMemo)(()=>a?.reduce((a,b)=>a+b.value,0)||0,[a]),{displayData:s,hiddenCount:t}=(0,c.useMemo)(()=>{if(!a||0===a.length)return{displayData:[],hiddenCount:0};let b=[...a].filter(a=>a.value>0).sort((a,b)=>b.value-a.value);return h||b.length<=d?{displayData:b,hiddenCount:0}:{displayData:b.slice(0,d),hiddenCount:b.length-d}},[a,d,h]),u=(0,c.useMemo)(()=>{let a=0;return s.map((b,c)=>{let d=r>0?b.value/r*100:0,e=3.6*a;return a+=d,{...b,percentage:d,startAngle:e,endAngle:3.6*a,color:m[c%m.length]}})},[s,r]);if(q)return(0,b.jsxs)(e.Card,{className:"border shadow-sm",children:[(0,b.jsx)(e.CardHeader,{className:"pb-3",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(j.PieChart,{className:"h-4 w-4 text-muted-foreground"}),"Portfolio Allocation"]})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"flex items-center justify-center h-[200px] text-muted-foreground",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(j.PieChart,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),(0,b.jsx)("p",{className:"text-sm",children:"No allocation data"})]})})})]});let v=2*Math.PI*74;return(0,b.jsxs)(e.Card,{className:"border shadow-sm",children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(j.PieChart,{className:"h-4 w-4 text-muted-foreground"}),"Portfolio Allocation"]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-lg font-bold",children:n(r)}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[a.filter(a=>a.value>0).length," positions"]})]})]})}),(0,b.jsx)(e.CardContent,{className:"pt-0",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-6",children:[(0,b.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,b.jsxs)("svg",{width:180,height:180,className:"transform -rotate-90",children:[(0,b.jsx)("circle",{cx:90,cy:90,r:74,fill:"none",stroke:"hsl(var(--muted))",strokeWidth:32}),u.map((a,c)=>{let d=a.percentage/100*v,e=u.slice(0,c).reduce((a,b)=>a+b.percentage,0)/100*v,f=o===c;return(0,b.jsx)("circle",{cx:90,cy:90,r:74,fill:"none",stroke:a.color,strokeWidth:f?36:32,strokeDasharray:`${d} ${v-d}`,strokeDashoffset:-e,className:"transition-all duration-200 cursor-pointer",style:{filter:f?"brightness(1.1)":"none"},onMouseEnter:()=>p(c),onMouseLeave:()=>p(null)},`${a.name}-${c}`)})]}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-center",children:null!==o?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("p",{className:"text-lg font-bold",children:[u[o]?.percentage.toFixed(1),"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground truncate max-w-[80px]",children:u[o]?.name.split(" ").pop()})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{className:"text-lg font-bold",children:s.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Holdings"})]})})})]}),(0,b.jsxs)("div",{className:"flex-1 w-full space-y-2",children:[u.map((a,c)=>(0,b.jsxs)("div",{className:`flex items-center justify-between py-1.5 px-2 rounded-md transition-colors cursor-pointer ${o===c?"bg-muted/50":"hover:bg-muted/30"}`,onMouseEnter:()=>p(c),onMouseLeave:()=>p(null),children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-sm flex-shrink-0",style:{backgroundColor:a.color}}),(0,b.jsx)("span",{className:"text-sm truncate",title:a.name,children:a.name.length>25?a.name.substring(0,25)+"...":a.name})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0 ml-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:n(a.value)}),(0,b.jsxs)("span",{className:"text-xs px-1.5 py-0.5 rounded font-medium min-w-[45px] text-center",style:{backgroundColor:`${a.color}15`,color:a.color},children:[a.percentage.toFixed(1),"%"]})]})]},`legend-${a.name}-${c}`)),(t>0||h&&a.filter(a=>a.value>0).length>d)&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"w-full h-8 text-xs text-muted-foreground hover:text-foreground mt-2",onClick:()=>i(!h),children:h?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.ChevronUp,{className:"h-3 w-3 mr-1.5"}),"Show Less"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.ChevronDown,{className:"h-3 w-3 mr-1.5"}),"Show ",t," More"]})})]})]})})]})}var p=a.i(268208),q=a.i(353667),r=a.i(849928),s=a.i(66579),t=a.i(89413),u=a.i(921819),v=a.i(799524),w=a.i(966494),x=a.i(85514);let y={grid:"#e5e7eb",axis:"#6b7280",axisLine:"#e5e7eb",tooltip:{bg:"#ffffff",border:"#e5e7eb",text:"#111827",label:"#6b7280"},primary:"#3b82f6",secondary:"#8b5cf6",success:"#10b981",warning:"#f59e0b",danger:"#ef4444",info:"#0ea5e9",gradientStart:"#3b82f6",gradientEnd:"rgba(59, 130, 246, 0.1)",area:{fill:"rgba(59, 130, 246, 0.1)",stroke:"#3b82f6"},bar:{fill:"#3b82f6",hover:"#2563eb"},line:{stroke:"#3b82f6",dot:"#ffffff",activeDot:"#3b82f6"},pie:{stroke:"#ffffff"}},z={grid:"#27272a",axis:"#a1a1aa",axisLine:"#3f3f46",tooltip:{bg:"#18181b",border:"#3f3f46",text:"#fafafa",label:"#a1a1aa"},primary:"#60a5fa",secondary:"#a78bfa",success:"#34d399",warning:"#fbbf24",danger:"#f87171",info:"#38bdf8",gradientStart:"#60a5fa",gradientEnd:"rgba(96, 165, 250, 0.1)",area:{fill:"rgba(96, 165, 250, 0.15)",stroke:"#60a5fa"},bar:{fill:"#60a5fa",hover:"#3b82f6"},line:{stroke:"#60a5fa",dot:"#18181b",activeDot:"#60a5fa"},pie:{stroke:"#18181b"}},A=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0,notation:a>=1e6?"compact":"standard",compactDisplay:"short"}).format(a);function B({data:a}){let d=function(){let{theme:a}=(0,x.useTheme)();return(0,c.useMemo)(()=>"staff-dark"===a?z:y,[a])}();return a&&0!==a.length?(0,b.jsxs)(e.Card,{className:"border-0 shadow-md bg-gradient-to-br from-muted/50 to-background",children:[(0,b.jsxs)(e.CardHeader,{className:"pb-4",children:[(0,b.jsxs)(e.CardTitle,{className:"text-base font-semibold flex items-center gap-2 text-foreground",children:[(0,b.jsx)(w.TrendingUp,{className:"h-5 w-5 text-emerald-600"}),"NAV Performance"]}),(0,b.jsx)(e.CardDescription,{className:"text-muted-foreground",children:"Portfolio value over time"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)(v.ResponsiveContainer,{width:"100%",height:320,children:(0,b.jsxs)(p.LineChart,{data:a,margin:{top:5,right:20,left:10,bottom:5},children:[(0,b.jsx)(t.CartesianGrid,{strokeDasharray:"3 3",stroke:d.grid,vertical:!1}),(0,b.jsx)(r.XAxis,{dataKey:"displayDate",tick:{fontSize:12,fill:d.axis},tickLine:!1,axisLine:{stroke:d.axisLine}}),(0,b.jsx)(s.YAxis,{tick:{fontSize:12,fill:d.axis},tickLine:!1,axisLine:{stroke:d.axisLine},tickFormatter:A}),(0,b.jsx)(u.Tooltip,{content:({active:a,payload:c})=>{if(a&&c&&c.length){let a=c[0].payload;return(0,b.jsxs)("div",{className:"bg-background p-4 border border-border rounded-lg shadow-lg",children:[(0,b.jsx)("p",{className:"font-semibold text-foreground mb-2",children:a.displayDate}),(0,b.jsxs)("p",{className:"text-sm text-emerald-600 dark:text-emerald-400 font-medium",children:["NAV: ",A(a.value)]})]})}return null}}),(0,b.jsx)(q.Line,{type:"monotone",dataKey:"value",stroke:d.success,strokeWidth:3,dot:{fill:d.success,r:4,strokeWidth:2,stroke:d.line.dot},activeDot:{r:6,strokeWidth:2,stroke:d.line.dot}})]})})})]}):(0,b.jsxs)(e.Card,{className:"border-0 shadow-md bg-gradient-to-br from-muted/50 to-background",children:[(0,b.jsxs)(e.CardHeader,{className:"pb-4",children:[(0,b.jsxs)(e.CardTitle,{className:"text-base font-semibold flex items-center gap-2 text-foreground",children:[(0,b.jsx)(w.TrendingUp,{className:"h-5 w-5 text-emerald-600"}),"NAV Performance"]}),(0,b.jsx)(e.CardDescription,{className:"text-muted-foreground",children:"Portfolio value over time"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"flex items-center justify-center h-[320px] text-muted-foreground/50",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(w.TrendingUp,{className:"h-16 w-16 mx-auto mb-3 opacity-20"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:"No performance data available"})]})})})]})}var C=a.i(828087),D=a.i(861486),E=a.i(476424),F=a.i(155508);let G=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0,notation:Math.abs(a)>=1e6?"compact":"standard",compactDisplay:"short"}).format(a);function H({data:a}){return a&&0!==a.length?(0,b.jsxs)(e.Card,{className:"border-0 shadow-md bg-gradient-to-br from-background to-muted/30 dark:from-gray-800 dark:to-gray-900",children:[(0,b.jsxs)(e.CardHeader,{className:"pb-4",children:[(0,b.jsxs)(e.CardTitle,{className:"text-base font-semibold flex items-center gap-2 text-foreground",children:[(0,b.jsx)(F.DollarSign,{className:"h-5 w-5 text-violet-600"}),"Cash Flow History"]}),(0,b.jsx)(e.CardDescription,{className:"text-muted-foreground",children:"Contributions vs distributions over time"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)(v.ResponsiveContainer,{width:"100%",height:320,children:(0,b.jsxs)(C.BarChart,{data:a,margin:{top:5,right:20,left:10,bottom:5},children:[(0,b.jsx)(t.CartesianGrid,{strokeDasharray:"3 3",className:"stroke-border",vertical:!1}),(0,b.jsx)(r.XAxis,{dataKey:"displayPeriod",tick:{fontSize:12},tickLine:!1,axisLine:!1,className:"fill-muted-foreground"}),(0,b.jsx)(s.YAxis,{tick:{fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:G,className:"fill-muted-foreground"}),(0,b.jsx)(u.Tooltip,{content:({active:a,payload:c})=>{if(a&&c&&c.length){let a=c[0].payload;return(0,b.jsxs)("div",{className:"bg-card p-4 border border-border rounded-lg shadow-lg",children:[(0,b.jsx)("p",{className:"font-semibold text-foreground mb-3",children:a.displayPeriod}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Contributions"})]}),(0,b.jsx)("span",{className:"text-sm font-medium text-red-600",children:G(a.contributions)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 bg-emerald-500 rounded"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Distributions"})]}),(0,b.jsx)("span",{className:"text-sm font-medium text-emerald-600",children:G(a.distributions)})]}),(0,b.jsxs)("div",{className:"pt-2 border-t border-border flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Net Cash"}),(0,b.jsx)("span",{className:`text-sm font-semibold ${a.distributions-a.contributions>=0?"text-emerald-600":"text-red-600"}`,children:G(a.distributions-a.contributions)})]})]})]})}return null}}),(0,b.jsx)(E.Legend,{wrapperStyle:{fontSize:"12px",paddingTop:"20px"},iconType:"circle",formatter:a=>"contributions"===a?"Capital Calls":"Distributions"}),(0,b.jsx)(D.Bar,{dataKey:"contributions",fill:"#dc2626",name:"contributions",radius:[6,6,0,0]}),(0,b.jsx)(D.Bar,{dataKey:"distributions",fill:"#059669",name:"distributions",radius:[6,6,0,0]})]})})})]}):(0,b.jsxs)(e.Card,{className:"border-0 shadow-md bg-gradient-to-br from-background to-muted/30 dark:from-gray-800 dark:to-gray-900",children:[(0,b.jsxs)(e.CardHeader,{className:"pb-4",children:[(0,b.jsxs)(e.CardTitle,{className:"text-base font-semibold flex items-center gap-2 text-foreground",children:[(0,b.jsx)(F.DollarSign,{className:"h-5 w-5 text-violet-600"}),"Cash Flow History"]}),(0,b.jsx)(e.CardDescription,{className:"text-muted-foreground",children:"Contributions vs distributions over time"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"flex items-center justify-center h-[320px] text-muted-foreground/70",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(F.DollarSign,{className:"h-16 w-16 mx-auto mb-3 opacity-20"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:"No cash flow data available"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground/80 mt-2",children:"Staff must add distributions via API"})]})})})]})}var I=a.i(347954);let J=(0,a.i(95799).default)("piggy-bank",[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]]);var K=a.i(376515),L=a.i(908513),M=a.i(425622),N=a.i(600900),O=a.i(787957),P=a.i(888987);let Q=a=>{let b=null==a||isNaN(a)?0:a;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0,notation:Math.abs(b)>=1e6?"compact":"standard",compactDisplay:"short"}).format(b)},R=(a,b=1)=>{let c=null==a||isNaN(a)?0:a;return`${c>0?"+":""}${c.toFixed(b)}%`},S=(a,b=2)=>{let c=null==a||isNaN(a)?0:a;return`${c.toFixed(b)}x`};function T({title:a,value:c,subtitle:d,change:f,icon:g,trend:h,className:i}){return(0,b.jsx)(e.Card,{className:(0,P.cn)("border shadow-sm",i),children:(0,b.jsx)(e.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:a}),(0,b.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,b.jsx)("h3",{className:"text-2xl font-bold",children:c}),void 0!==f&&(0,b.jsxs)("div",{className:(0,P.cn)("flex items-center gap-1 text-sm font-medium","text-muted-foreground"),children:[f>=0?(0,b.jsx)(w.TrendingUp,{className:"h-3 w-3"}):(0,b.jsx)(I.TrendingDown,{className:"h-3 w-3"}),R(f)]})]}),d&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:d})]}),g&&(0,b.jsx)("div",{className:"p-2 rounded-lg bg-muted",children:(0,b.jsx)(g,{className:"h-5 w-5 text-muted-foreground"})})]})})})}function U({kpis:a,trends:c,summary:d,asOfDate:j,isLoading:k=!1,onRefresh:l,onExport:m,className:n,vehicleBreakdown:p=[],allocationData:q=[],performanceData:r=[],cashFlowData:s=[]}){return(0,b.jsxs)("div",{className:(0,P.cn)("space-y-6",n),children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Portfolio Analytics"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:[d.totalVehicles," vehicles, ",d.totalPositions," positions"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(g.Badge,{variant:"outline",className:"text-xs",children:[(0,b.jsx)(O.Activity,{className:"h-3 w-3 mr-1"}),new Date(j).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})]}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:l,disabled:k,children:(0,b.jsx)(L.RefreshCw,{className:(0,P.cn)("h-4 w-4",k&&"animate-spin")})}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:m,disabled:!m,children:(0,b.jsx)(M.Download,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsx)(T,{title:"Portfolio Value",value:Q(a.currentNAV),subtitle:"Current NAV",change:c?.navChangePct,icon:N.Wallet}),(0,b.jsx)(T,{title:"Invested",value:Q(a.totalContributed),subtitle:`${a.totalCommitment>0?(a.totalContributed/a.totalCommitment*100).toFixed(0):0}% deployed`,icon:J}),(0,b.jsx)(T,{title:"Distributions",value:Q(a.totalDistributions),subtitle:`DPI: ${S(a.dpi)}`,icon:w.TrendingUp}),(0,b.jsx)(T,{title:"Unrealized",value:Q(a.unrealizedGain),subtitle:`${(a.unrealizedGainPct??0).toFixed(1)}% return`,change:a.unrealizedGainPct,icon:K.Target})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)(e.Card,{className:"border shadow-sm",children:[(0,b.jsx)(e.CardHeader,{className:"pb-3",children:(0,b.jsx)(e.CardTitle,{className:"text-base font-medium",children:"Performance Metrics"})}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"TVPI"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:S(a.tvpi)})]}),(0,b.jsx)(h.Progress,{value:a.tvpi/3*100,className:"h-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"DPI"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:S(a.dpi)})]}),(0,b.jsx)(h.Progress,{value:a.dpi/2*100,className:"h-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Net IRR"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:R(a.irr)})]}),(0,b.jsx)(h.Progress,{value:Math.min(a.irr/30*100,100),className:"h-2"})]})]})]}),(0,b.jsxs)(e.Card,{className:"border shadow-sm",children:[(0,b.jsx)(e.CardHeader,{className:"pb-3",children:(0,b.jsx)(e.CardTitle,{className:"text-base font-medium",children:"Capital Deployment"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Deployed"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:[a.totalCommitment>0?(a.totalContributed/a.totalCommitment*100).toFixed(0):0,"%"]})]}),(0,b.jsx)(h.Progress,{value:a.totalCommitment>0?a.totalContributed/a.totalCommitment*100:0,className:"h-2"})]}),(0,b.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Commitment"}),(0,b.jsx)("span",{children:Q(a.totalCommitment)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Contributed"}),(0,b.jsx)("span",{children:Q(a.totalContributed)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Unfunded"}),(0,b.jsx)("span",{children:Q(a.unfundedCommitment)})]})]})]})})]}),(0,b.jsxs)(e.Card,{className:"border shadow-sm",children:[(0,b.jsx)(e.CardHeader,{className:"pb-3",children:(0,b.jsx)(e.CardTitle,{className:"text-base font-medium",children:"Portfolio Stats"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:d.totalVehicles}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Vehicles"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:d.totalPositions}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Positions"})]})]}),(0,b.jsx)(i.Separator,{className:"my-4"}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Deal Allocations"}),(0,b.jsx)("span",{children:d.totalDeals})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Deal Value"}),(0,b.jsx)("span",{children:Q(d.totalDealValue)})]})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsx)(B,{data:r}),(0,b.jsx)(o,{data:q})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,b.jsx)(H,{data:s})})]})}var V=a.i(663475),W=a.i(249464),X=a.i(951870),Y=a.i(623157),Z=a.i(723603),$=a.i(513483),_=a.i(983639),aa=a.i(429770),ab=a.i(948624),ac=a.i(256832),ad=a.i(559387),ae=a.i(895834),af=a.i(311449),ag=a.i(579119),ah=a.i(769996),ai=["PageUp","PageDown"],aj=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ak={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},al="Slider",[am,an,ao]=(0,ah.createCollection)(al),[ap,aq]=(0,ab.createContextScope)(al,[ao]),[ar,as]=ap(al),at=c.forwardRef((a,d)=>{let{name:e,min:f=0,max:g=100,step:h=1,orientation:i="horizontal",disabled:j=!1,minStepsBetweenThumbs:k=0,defaultValue:l=[f],value:m,onValueChange:n=()=>{},onValueCommit:o=()=>{},inverted:p=!1,form:q,...r}=a,s=c.useRef(new Set),t=c.useRef(0),u="horizontal"===i,[v=[],w]=(0,ac.useControllableState)({prop:m,defaultProp:l,onChange:a=>{let b=[...s.current];b[t.current]?.focus(),n(a)}}),x=c.useRef(v);function y(a,b,{commit:c}={commit:!1}){let d,e=(String(h).split(".")[1]||"").length,i=Math.round((Math.round((a-f)/h)*h+f)*(d=Math.pow(10,e)))/d,j=(0,$.clamp)(i,[f,g]);w((a=[])=>{let d=function(a=[],b,c){let d=[...a];return d[c]=b,d.sort((a,b)=>a-b)}(a,j,b);if(!function(a,b){if(b>0)return Math.min(...a.slice(0,-1).map((b,c)=>a[c+1]-b))>=b;return!0}(d,k*h))return a;{t.current=d.indexOf(j);let b=String(d)!==String(a);return b&&c&&o(d),b?d:a}})}return(0,b.jsx)(ar,{scope:a.__scopeSlider,name:e,disabled:j,min:f,max:g,valueIndexToChangeRef:t,thumbs:s.current,values:v,orientation:i,form:q,children:(0,b.jsx)(am.Provider,{scope:a.__scopeSlider,children:(0,b.jsx)(am.Slot,{scope:a.__scopeSlider,children:(0,b.jsx)(u?aw:ax,{"aria-disabled":j,"data-disabled":j?"":void 0,...r,ref:d,onPointerDown:(0,_.composeEventHandlers)(r.onPointerDown,()=>{j||(x.current=v)}),min:f,max:g,inverted:p,onSlideStart:j?void 0:function(a){let b=function(a,b){if(1===a.length)return 0;let c=a.map(a=>Math.abs(a-b)),d=Math.min(...c);return c.indexOf(d)}(v,a);y(a,b)},onSlideMove:j?void 0:function(a){y(a,t.current)},onSlideEnd:j?void 0:function(){let a=x.current[t.current];v[t.current]!==a&&o(v)},onHomeKeyDown:()=>!j&&y(f,0,{commit:!0}),onEndKeyDown:()=>!j&&y(g,v.length-1,{commit:!0}),onStepKeyDown:({event:a,direction:b})=>{if(!j){let c=ai.includes(a.key)||a.shiftKey&&aj.includes(a.key),d=t.current;y(v[d]+h*(c?10:1)*b,d,{commit:!0})}}})})})})});at.displayName=al;var[au,av]=ap(al,{startEdge:"left",endEdge:"right",size:"width",direction:1}),aw=c.forwardRef((a,d)=>{let{min:e,max:f,dir:g,inverted:h,onSlideStart:i,onSlideMove:j,onSlideEnd:k,onStepKeyDown:l,...m}=a,[n,o]=c.useState(null),p=(0,aa.useComposedRefs)(d,a=>o(a)),q=c.useRef(void 0),r=(0,ad.useDirection)(g),s="ltr"===r,t=s&&!h||!s&&h;function u(a){let b=q.current||n.getBoundingClientRect(),c=aI([0,b.width],t?[e,f]:[f,e]);return q.current=b,c(a-b.left)}return(0,b.jsx)(au,{scope:a.__scopeSlider,startEdge:t?"left":"right",endEdge:t?"right":"left",direction:t?1:-1,size:"width",children:(0,b.jsx)(ay,{dir:r,"data-orientation":"horizontal",...m,ref:p,style:{...m.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:a=>{let b=u(a.clientX);i?.(b)},onSlideMove:a=>{let b=u(a.clientX);j?.(b)},onSlideEnd:()=>{q.current=void 0,k?.()},onStepKeyDown:a=>{let b=ak[t?"from-left":"from-right"].includes(a.key);l?.({event:a,direction:b?-1:1})}})})}),ax=c.forwardRef((a,d)=>{let{min:e,max:f,inverted:g,onSlideStart:h,onSlideMove:i,onSlideEnd:j,onStepKeyDown:k,...l}=a,m=c.useRef(null),n=(0,aa.useComposedRefs)(d,m),o=c.useRef(void 0),p=!g;function q(a){let b=o.current||m.current.getBoundingClientRect(),c=aI([0,b.height],p?[f,e]:[e,f]);return o.current=b,c(a-b.top)}return(0,b.jsx)(au,{scope:a.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:(0,b.jsx)(ay,{"data-orientation":"vertical",...l,ref:n,style:{...l.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:a=>{let b=q(a.clientY);h?.(b)},onSlideMove:a=>{let b=q(a.clientY);i?.(b)},onSlideEnd:()=>{o.current=void 0,j?.()},onStepKeyDown:a=>{let b=ak[p?"from-bottom":"from-top"].includes(a.key);k?.({event:a,direction:b?-1:1})}})})}),ay=c.forwardRef((a,c)=>{let{__scopeSlider:d,onSlideStart:e,onSlideMove:f,onSlideEnd:g,onHomeKeyDown:h,onEndKeyDown:i,onStepKeyDown:j,...k}=a,l=as(al,d);return(0,b.jsx)(ag.Primitive.span,{...k,ref:c,onKeyDown:(0,_.composeEventHandlers)(a.onKeyDown,a=>{"Home"===a.key?(h(a),a.preventDefault()):"End"===a.key?(i(a),a.preventDefault()):ai.concat(aj).includes(a.key)&&(j(a),a.preventDefault())}),onPointerDown:(0,_.composeEventHandlers)(a.onPointerDown,a=>{let b=a.target;b.setPointerCapture(a.pointerId),a.preventDefault(),l.thumbs.has(b)?b.focus():e(a)}),onPointerMove:(0,_.composeEventHandlers)(a.onPointerMove,a=>{a.target.hasPointerCapture(a.pointerId)&&f(a)}),onPointerUp:(0,_.composeEventHandlers)(a.onPointerUp,a=>{let b=a.target;b.hasPointerCapture(a.pointerId)&&(b.releasePointerCapture(a.pointerId),g(a))})})}),az="SliderTrack",aA=c.forwardRef((a,c)=>{let{__scopeSlider:d,...e}=a,f=as(az,d);return(0,b.jsx)(ag.Primitive.span,{"data-disabled":f.disabled?"":void 0,"data-orientation":f.orientation,...e,ref:c})});aA.displayName=az;var aB="SliderRange",aC=c.forwardRef((a,d)=>{let{__scopeSlider:e,...f}=a,g=as(aB,e),h=av(aB,e),i=c.useRef(null),j=(0,aa.useComposedRefs)(d,i),k=g.values.length,l=g.values.map(a=>aH(a,g.min,g.max)),m=k>1?Math.min(...l):0,n=100-Math.max(...l);return(0,b.jsx)(ag.Primitive.span,{"data-orientation":g.orientation,"data-disabled":g.disabled?"":void 0,...f,ref:j,style:{...a.style,[h.startEdge]:m+"%",[h.endEdge]:n+"%"}})});aC.displayName=aB;var aD="SliderThumb",aE=c.forwardRef((a,d)=>{let e=an(a.__scopeSlider),[f,g]=c.useState(null),h=(0,aa.useComposedRefs)(d,a=>g(a)),i=c.useMemo(()=>f?e().findIndex(a=>a.ref.current===f):-1,[e,f]);return(0,b.jsx)(aF,{...a,ref:h,index:i})}),aF=c.forwardRef((a,d)=>{var e,f,g,h,i;let j,k,{__scopeSlider:l,index:m,name:n,...o}=a,p=as(aD,l),q=av(aD,l),[r,s]=c.useState(null),t=(0,aa.useComposedRefs)(d,a=>s(a)),u=!r||p.form||!!r.closest("form"),v=(0,af.useSize)(r),w=p.values[m],x=void 0===w?0:aH(w,p.min,p.max),y=(e=m,(f=p.values.length)>2?`Value ${e+1} of ${f}`:2===f?["Minimum","Maximum"][e]:void 0),z=v?.[q.size],A=z?(g=z,h=x,i=q.direction,k=aI([0,50],[0,j=g/2]),(j-k(h)*i)*i):0;return c.useEffect(()=>{if(r)return p.thumbs.add(r),()=>{p.thumbs.delete(r)}},[r,p.thumbs]),(0,b.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[q.startEdge]:`calc(${x}% + ${A}px)`},children:[(0,b.jsx)(am.ItemSlot,{scope:a.__scopeSlider,children:(0,b.jsx)(ag.Primitive.span,{role:"slider","aria-label":a["aria-label"]||y,"aria-valuemin":p.min,"aria-valuenow":w,"aria-valuemax":p.max,"aria-orientation":p.orientation,"data-orientation":p.orientation,"data-disabled":p.disabled?"":void 0,tabIndex:p.disabled?void 0:0,...o,ref:t,style:void 0===w?{display:"none"}:a.style,onFocus:(0,_.composeEventHandlers)(a.onFocus,()=>{p.valueIndexToChangeRef.current=m})})}),u&&(0,b.jsx)(aG,{name:n??(p.name?p.name+(p.values.length>1?"[]":""):void 0),form:p.form,value:w},m)]})});aE.displayName=aD;var aG=c.forwardRef(({__scopeSlider:a,value:d,...e},f)=>{let g=c.useRef(null),h=(0,aa.useComposedRefs)(g,f),i=(0,ae.usePrevious)(d);return c.useEffect(()=>{let a=g.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(i!==d&&b){let c=new Event("input",{bubbles:!0});b.call(a,d),a.dispatchEvent(c)}},[i,d]),(0,b.jsx)(ag.Primitive.input,{style:{display:"none"},...e,ref:h,defaultValue:d})});function aH(a,b,c){return(0,$.clamp)(100/(c-b)*(a-b),[0,100])}function aI(a,b){return c=>{if(a[0]===a[1]||b[0]===b[1])return b[0];let d=(b[1]-b[0])/(a[1]-a[0]);return b[0]+d*(c-a[0])}}function aJ({className:a,defaultValue:d,value:e,min:f=0,max:g=100,...h}){let i=c.useMemo(()=>Array.isArray(e)?e:Array.isArray(d)?d:[f,g],[e,d,f,g]);return(0,b.jsxs)(at,{"data-slot":"slider",defaultValue:d,value:e,min:f,max:g,className:(0,P.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",a),...h,children:[(0,b.jsx)(aA,{"data-slot":"slider-track",className:(0,P.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,b.jsx)(aC,{"data-slot":"slider-range",className:(0,P.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:i.length},(a,c)=>(0,b.jsx)(aE,{"data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-6 md:size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},c))]})}aG.displayName="RadioBubbleInput";var aK=a.i(487068),aL=a.i(166457),aM=a.i(823879),aN=a.i(278541),aO=a.i(724070),aP=a.i(190120),aQ=a.i(674875),aR=a.i(696661);let aS=[{value:"all",label:"All Types",icon:aN.Building2},{value:"fund",label:"Funds",icon:aN.Building2},{value:"spv",label:"SPVs",icon:aN.Building2},{value:"co_investment",label:"Co-Investments",icon:aN.Building2},{value:"direct",label:"Direct Investments",icon:aN.Building2}],aT=[{value:"all",label:"All Status"},{value:"active",label:"Active",color:"green"},{value:"pending",label:"Pending",color:"yellow"},{value:"closed",label:"Closed",color:"gray"}],aU=[{value:"all",label:"All Performance",icon:aP.BarChart3},{value:"positive",label:"Positive Returns",icon:w.TrendingUp,color:"green"},{value:"negative",label:"Negative Returns",icon:I.TrendingDown,color:"red"},{value:"breakeven",label:"Break Even",icon:aP.BarChart3,color:"gray"}],aV=[{value:"all",label:"All Sizes"},{value:"large",label:"Large (>$1M)",icon:F.DollarSign},{value:"medium",label:"Medium ($100K-$1M)",icon:F.DollarSign},{value:"small",label:"Small (<$100K)",icon:F.DollarSign}],aW=[{value:"all",label:"All Vintages"},{value:"recent",label:"Recent (< 2 years)",icon:aO.Calendar},{value:"mature",label:"Mature (2-5 years)",icon:aO.Calendar},{value:"legacy",label:"Legacy (> 5 years)",icon:aO.Calendar}],aX=[{value:"all",label:"All Locations"},{value:"luxembourg",label:"Luxembourg",flag:"ðŸ‡±ðŸ‡º"},{value:"british virgin islands",label:"British Virgin Islands",flag:"ðŸ‡»ðŸ‡¬"},{value:"cayman islands",label:"Cayman Islands",flag:"ðŸ‡°ðŸ‡¾"},{value:"united states",label:"United States",flag:"ðŸ‡ºðŸ‡¸"},{value:"singapore",label:"Singapore",flag:"ðŸ‡¸ðŸ‡¬"},{value:"other",label:"Other",flag:"ðŸŒ"}],aY=[{value:"value_desc",label:"Highest Value",icon:w.TrendingUp},{value:"value_asc",label:"Lowest Value",icon:I.TrendingDown},{value:"performance_desc",label:"Best Performance",icon:w.TrendingUp},{value:"performance_asc",label:"Worst Performance",icon:I.TrendingDown},{value:"name_asc",label:"Name (A-Z)"},{value:"name_desc",label:"Name (Z-A)"},{value:"date_desc",label:"Newest First",icon:aO.Calendar},{value:"date_asc",label:"Oldest First",icon:aO.Calendar},{value:"commitment_desc",label:"Largest Commitment",icon:F.DollarSign},{value:"commitment_asc",label:"Smallest Commitment",icon:F.DollarSign}];function aZ({filters:a,onFiltersChange:d,sortBy:e,onSortChange:g,onClearFilters:h,activeFiltersCount:j,totalResults:l=0,className:m}){let[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)([a.minValue??0,a.maxValue??1e7]),[r,s]=(0,c.useState)([a.minReturn??-50,a.maxReturn??100]),t=(b,c)=>{d({...a,[b]:c})},u=aY.find(a=>a.value===e)||aY[0];return(0,b.jsxs)("div",{className:(0,P.cn)("space-y-4",m),children:[(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,b.jsx)(aK.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(V.Input,{placeholder:"Search by name, type, or location...",value:a.search,onChange:a=>t("search",a.target.value),className:"pl-10 pr-10"}),a.search&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0",onClick:()=>t("search",""),children:(0,b.jsx)(aM.X,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)(X.Select,{value:a.type,onValueChange:a=>t("type",a),children:[(0,b.jsx)(X.SelectTrigger,{className:"w-full sm:w-[160px]",children:(0,b.jsx)(X.SelectValue,{placeholder:"Vehicle Type"})}),(0,b.jsx)(X.SelectContent,{children:aS.map(a=>(0,b.jsx)(X.SelectItem,{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)(X.Select,{value:a.performance,onValueChange:a=>t("performance",a),children:[(0,b.jsx)(X.SelectTrigger,{className:"w-full sm:w-[160px]",children:(0,b.jsx)(X.SelectValue,{placeholder:"Performance"})}),(0,b.jsx)(X.SelectContent,{children:aU.map(a=>(0,b.jsx)(X.SelectItem,{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)(X.Select,{value:a.size,onValueChange:a=>t("size",a),children:[(0,b.jsx)(X.SelectTrigger,{className:"w-full sm:w-[140px]",children:(0,b.jsx)(X.SelectValue,{placeholder:"Size"})}),(0,b.jsx)(X.SelectContent,{children:aV.map(a=>(0,b.jsx)(X.SelectItem,{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)(f.Button,{variant:n?"default":"outline",size:"sm",onClick:()=>o(!n),className:"gap-2",children:[(0,b.jsx)(aQ.Sparkles,{className:"h-4 w-4"}),"Advanced",(0,b.jsx)(k.ChevronDown,{className:(0,P.cn)("h-4 w-4 transition-transform",n&&"rotate-180")})]}),(0,b.jsxs)(Y.Popover,{children:[(0,b.jsx)(Y.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"gap-2",children:[u.icon&&(0,b.jsx)(u.icon,{className:"h-4 w-4"}),u.label,(0,b.jsx)(k.ChevronDown,{className:"h-4 w-4"})]})}),(0,b.jsx)(Y.PopoverContent,{className:"w-56",align:"end",children:(0,b.jsxs)(Z.Command,{children:[(0,b.jsx)(Z.CommandInput,{placeholder:"Search sort options..."}),(0,b.jsxs)(Z.CommandList,{children:[(0,b.jsx)(Z.CommandEmpty,{children:"No sort option found."}),(0,b.jsx)(Z.CommandGroup,{children:aY.map(a=>(0,b.jsx)(Z.CommandItem,{value:a.value,onSelect:()=>g(a.value),children:(0,b.jsxs)("div",{className:"flex items-center w-full",children:[a.icon&&(0,b.jsx)(a.icon,{className:"h-4 w-4 mr-2"}),(0,b.jsx)("span",{className:"flex-1",children:a.label}),e===a.value&&(0,b.jsx)(aR.Check,{className:"h-4 w-4"})]})},a.value))})]})]})})]})]})]}),n&&(0,b.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 bg-muted/30",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(W.Label,{className:"text-sm font-medium",children:"Status"}),(0,b.jsxs)(X.Select,{value:a.status,onValueChange:a=>t("status",a),children:[(0,b.jsx)(X.SelectTrigger,{children:(0,b.jsx)(X.SelectValue,{placeholder:"Select status"})}),(0,b.jsx)(X.SelectContent,{children:aT.map(a=>(0,b.jsx)(X.SelectItem,{value:a.value,children:(0,b.jsxs)("div",{className:"flex items-center",children:[a.color&&(0,b.jsx)("div",{className:(0,P.cn)("h-2 w-2 rounded-full mr-2","green"===a.color&&"bg-green-500","yellow"===a.color&&"bg-yellow-500","gray"===a.color&&"bg-gray-500")}),a.label]})},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(W.Label,{className:"text-sm font-medium",children:"Vintage"}),(0,b.jsxs)(X.Select,{value:a.vintage,onValueChange:a=>t("vintage",a),children:[(0,b.jsx)(X.SelectTrigger,{children:(0,b.jsx)(X.SelectValue,{placeholder:"Select vintage"})}),(0,b.jsx)(X.SelectContent,{children:aW.map(a=>(0,b.jsx)(X.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(W.Label,{className:"text-sm font-medium",children:"Domicile"}),(0,b.jsxs)(X.Select,{value:a.domicile,onValueChange:a=>t("domicile",a),children:[(0,b.jsx)(X.SelectTrigger,{children:(0,b.jsx)(X.SelectValue,{placeholder:"Select location"})}),(0,b.jsx)(X.SelectContent,{children:aX.map(a=>(0,b.jsxs)(X.SelectItem,{value:a.value,children:[(0,b.jsx)("span",{className:"mr-2",children:a.flag}),a.label]},a.value))})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(W.Label,{className:"text-sm font-medium",children:"Value Range"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["$",(p[0]/1e3).toFixed(0),"K - $",(p[1]/1e3).toFixed(0),"K"]})]}),(0,b.jsx)(aJ,{value:p,onValueChange:b=>{q(b);let c=0===b[0]&&1e7===b[1];d({...a,minValue:c?void 0:b[0],maxValue:c?void 0:b[1]})},max:1e7,step:1e5,className:"w-full"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(W.Label,{className:"text-sm font-medium",children:"Return Range"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[r[0],"% - ",r[1],"%"]})]}),(0,b.jsx)(aJ,{value:r,onValueChange:b=>{s(b);let c=-50===b[0]&&100===b[1];d({...a,minReturn:c?void 0:b[0],maxReturn:c?void 0:b[1]})},min:-50,max:100,step:5,className:"w-full"})]})]})]}),j>0&&(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(aL.Filter,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[j," filter",1!==j?"s":""," active"]}),l>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Separator,{orientation:"vertical",className:"h-4"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:[l," result",1!==l?"s":""]})]})]}),(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:h,className:"text-muted-foreground hover:text-foreground",children:[(0,b.jsx)(aM.X,{className:"h-4 w-4 mr-2"}),"Clear all"]})]})]})}var a$=a.i(289633),a_=a.i(714814),a0=a.i(140561),a1=a.i(216316),a2=a.i(264890),a3=a.i(264634),a4=a.i(191675),a5=a.i(403205),a6=a.i(3321),a7=a.i(838086),a8=a.i(587143),a9=a.i(438436),ba=a.i(899750);function bb({subscriptionId:a,vehicleName:d,fundedAmount:e,currency:g,onSuccess:h,onCancel:j}){let k=(0,a$.useRouter)(),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(null),v=parseFloat(n)||0,w=e>0?v/e*100:0,x=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:g||"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(a);async function y(b){if(b.preventDefault(),u(null),!n||v<=0)return void u("Please enter a valid amount");if(v>e)return void u(`Amount cannot exceed your position value of ${x(e)}`);m(!0);try{let b=await fetch("/api/investor/sell-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription_id:a,amount_to_sell:v,asking_price_per_unit:p?parseFloat(p):void 0,notes:r||void 0})}),c=await b.json();if(!b.ok)throw Error(c.error||"Failed to submit request");ba.toast.success("Sale request submitted successfully"),h?h():(k.push("/versotech_main/portfolio"),k.refresh())}catch(b){console.error("Submit error:",b);let a=b instanceof Error?b.message:"Failed to submit request";u(a),ba.toast.error(a)}finally{m(!1)}}return(0,b.jsxs)("div",{className:"w-full space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-amber-500/10 to-orange-500/10 border border-amber-200/50",children:(0,b.jsx)(I.TrendingDown,{className:"h-5 w-5 text-amber-600"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg tracking-tight",children:"Sell Position"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5",children:d})]})]}),(0,b.jsx)("div",{className:"p-4 rounded-xl bg-gradient-to-br from-slate-50 to-slate-100/50 dark:from-slate-900 dark:to-slate-800/50 border border-slate-200/50 dark:border-slate-700/50",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Position Value"}),(0,b.jsx)("span",{className:"text-xl font-semibold tabular-nums tracking-tight",children:x(e)})]})})]}),(0,b.jsx)(i.Separator,{className:"bg-border/50"}),(0,b.jsxs)("form",{onSubmit:y,className:"space-y-5",children:[(0,b.jsxs)(a5.Alert,{className:"border-amber-200/50 bg-amber-50/50 dark:bg-amber-950/20",children:[(0,b.jsx)(a7.AlertTriangle,{className:"h-4 w-4 text-amber-600"}),(0,b.jsx)(a5.AlertDescription,{className:"text-sm text-amber-800 dark:text-amber-200",children:"Sale requests are subject to review and buyer matching. The process typically takes 2-4 weeks."})]}),t&&(0,b.jsx)(a5.Alert,{variant:"destructive",className:"animate-in fade-in-0 slide-in-from-top-1",children:(0,b.jsx)(a5.AlertDescription,{children:t})}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(W.Label,{htmlFor:"amount",className:"text-sm font-medium",children:"Amount to Sell"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground tabular-nums",children:g||"USD"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(V.Input,{id:"amount",type:"number",step:"0.01",min:"0",max:e,value:n,onChange:a=>o(a.target.value),placeholder:"0.00",required:!0,disabled:l,className:"text-lg h-12 pr-20 font-medium tabular-nums"}),v>0&&(0,b.jsxs)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1 text-xs text-muted-foreground bg-background px-1.5 py-0.5 rounded",children:[(0,b.jsx)(a9.Percent,{className:"h-3 w-3"}),(0,b.jsxs)("span",{className:"tabular-nums",children:[w.toFixed(1),"%"]})]})]}),(0,b.jsx)("div",{className:"flex gap-2",children:[25,50,75,100].map(a=>(0,b.jsxs)(f.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{o((e*a/100).toFixed(2))},disabled:l,className:(0,P.cn)("flex-1 text-xs h-8 transition-all",w===a&&"bg-primary/5 border-primary/30 text-primary"),children:[a,"%"]},a))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(W.Label,{htmlFor:"askingPrice",className:"text-sm font-medium",children:"Asking Price per Unit"}),(0,b.jsx)("span",{className:"text-[10px] font-medium text-muted-foreground bg-muted px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),(0,b.jsx)(V.Input,{id:"askingPrice",type:"number",step:"0.0001",min:"0",value:p,onChange:a=>q(a.target.value),placeholder:"Leave blank for market price",disabled:l,className:"h-11"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1.5",children:[(0,b.jsx)(a8.Info,{className:"h-3 w-3"}),"If not specified, current market valuation will be used"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(W.Label,{htmlFor:"notes",className:"text-sm font-medium",children:"Additional Notes"}),(0,b.jsx)("span",{className:"text-[10px] font-medium text-muted-foreground bg-muted px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),(0,b.jsx)(a4.Textarea,{id:"notes",value:r,onChange:a=>s(a.target.value),placeholder:"Any special requirements or context for your request...",rows:3,maxLength:1e3,disabled:l,className:"resize-none"}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground tabular-nums",children:[r.length,"/1000"]})})]}),(0,b.jsx)(i.Separator,{className:"bg-border/50"}),v>0&&(0,b.jsxs)("div",{className:"p-4 rounded-xl bg-muted/30 border border-border/50 space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Request Summary"}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm",children:"Selling"}),(0,b.jsx)("span",{className:"font-semibold tabular-nums",children:x(v)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-muted-foreground",children:[(0,b.jsx)("span",{className:"text-sm",children:"of position"}),(0,b.jsxs)("span",{className:"text-sm tabular-nums",children:[w.toFixed(1),"%"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(f.Button,{type:"submit",disabled:l||v<=0,className:"flex-1 h-11 font-medium",children:l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(a6.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Sale Request"}),j&&(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:j,disabled:l,className:"h-11",children:"Cancel"})]})]})]})}function bc({holding:a,detailsBasePath:d="/versotech_main/portfolio"}){let h=(0,a$.useRouter)(),[i,j]=(0,c.useState)(!1),k=a.position&&a.position.units>0,l=k&&a.subscription?.id,m=!!a.position?.unrealizedGainPct&&a.position.unrealizedGainPct>=0,n=(a.status||a.allocation_status||a.subscription?.status||(k?"active":"pending")).toLowerCase(),o=n.replace(/_/g," ").toUpperCase(),p=()=>{h.push(`${d}/${a.id}`)},q=async a=>{try{let b=await fetch(`/api/documents/${a.id}/download`),c=await b.json();c.url&&window.open(c.url,"_blank")}catch(a){console.error("Download failed:",a)}};return(0,b.jsxs)(e.Card,{className:"group relative overflow-hidden border shadow-sm hover:shadow-md transition-shadow duration-200 min-h-[420px] flex flex-col",children:[(0,b.jsx)(e.CardHeader,{className:"pb-3 flex-shrink-0",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[a.logo_url?(0,b.jsx)(a_.default,{src:a.logo_url,alt:a.investment_name||"Investment",width:48,height:48,className:"h-12 w-12 rounded-lg object-contain bg-muted p-1.5"}):(0,b.jsx)("div",{className:"h-12 w-12 rounded-lg bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center shadow-sm",children:(0,b.jsx)("span",{className:"text-white font-bold text-lg",children:(a.investment_name||a.name||"V").charAt(0).toUpperCase()})}),(0,b.jsxs)("div",{children:[a.investment_name&&(0,b.jsx)("span",{className:"text-sm font-medium text-muted-foreground block",children:a.investment_name}),(0,b.jsx)(e.CardTitle,{className:"text-lg font-semibold line-clamp-1",children:a.name})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)(g.Badge,{variant:"secondary",className:"text-xs",children:a.type.replace(/_/g," ")}),a.domicile&&(0,b.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:a.domicile}),(0,b.jsx)(g.Badge,{className:(0,P.cn)("text-xs",(a=>{switch(a){case"active":case"committed":return"bg-emerald-600 border-emerald-500 text-white font-medium";case"pending":return"bg-amber-600 border-amber-500 text-white font-medium";case"closed":return"bg-blue-600 border-blue-500 text-white font-medium";case"cancelled":return"bg-red-600 border-red-500 text-white font-medium";default:return"bg-muted border-border text-foreground font-medium"}})(n)),children:o})]})]}),(0,b.jsxs)(a1.DropdownMenu,{children:[(0,b.jsx)(a1.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,b.jsx)(a3.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(a1.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(a1.DropdownMenuLabel,{children:"Actions"}),(0,b.jsx)(a1.DropdownMenuSeparator,{}),(0,b.jsxs)(a1.DropdownMenuItem,{onClick:p,children:[(0,b.jsx)(a2.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),l&&(0,b.jsxs)(a1.DropdownMenuItem,{onClick:()=>j(!0),children:[(0,b.jsx)(I.TrendingDown,{className:"mr-2 h-4 w-4"}),"Request Sale"]})]})]})]})}),(0,b.jsxs)(e.CardContent,{className:"flex-1 flex flex-col",children:[(0,b.jsx)("div",{className:"flex-1 space-y-4",children:k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Current Value"}),(0,b.jsx)("span",{className:"text-lg font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:a.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(a.position.currentValue)})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unrealized Gain"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:(0,P.cn)("text-sm font-medium",m?"text-foreground":"text-muted-foreground"),children:new Intl.NumberFormat("en-US",{style:"currency",currency:a.currency,minimumFractionDigits:0,maximumFractionDigits:0,signDisplay:"always"}).format(a.position.unrealizedGain)}),(0,b.jsxs)(g.Badge,{variant:"outline",className:"text-xs",children:[m?"+":"-",Math.abs(a.position.unrealizedGainPct).toFixed(1),"%"]})]})]})]}),(0,b.jsx)("div",{className:"pt-3 border-t mt-3",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Units"}),(0,b.jsx)("p",{className:"font-medium",children:a.position.units.toLocaleString()})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Cost Basis"}),(0,b.jsx)("p",{className:"font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:a.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(a.position.costBasis)})]})]})}),a.valuation&&(0,b.jsx)("div",{className:"pt-3 border-t mt-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"NAV per Unit"}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:a.currency}).format(a.valuation.navPerUnit)}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center justify-end gap-1",children:[(0,b.jsx)(aO.Calendar,{className:"h-3 w-3"}),new Date(a.valuation.asOfDate).toLocaleDateString()]})]})]})})]}):(0,b.jsxs)("div",{className:"text-center py-6 space-y-3",children:[(0,b.jsx)(F.DollarSign,{className:"h-12 w-12 text-muted-foreground/20 mx-auto mb-1"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Awaiting Funding"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your commitment has been recorded. We will notify you once units are issued."})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(g.Badge,{variant:"outline",className:"bg-muted/50 border-border text-xs capitalize",children:["Allocation Status: ",(a.allocation_status||a.subscription?.status||"pending").replace(/_/g," ")]}),a.subscription?.commitment!==null&&a.subscription?.commitment!==void 0&&(0,b.jsxs)(g.Badge,{variant:"outline",className:"bg-muted/50 border-border text-xs",children:["Commitment:"," ",new Intl.NumberFormat("en-US",{style:"currency",currency:a.subscription?.currency||a.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(a.subscription.commitment??0)]}),a.subscription?.funding_due_at&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Funding due ",new Date(a.subscription.funding_due_at).toLocaleDateString()]}),a.invite_sent_at&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Invite sent ",new Date(a.invite_sent_at).toLocaleDateString()]})]})]})}),a.documents&&(0,b.jsxs)("div",{className:"pt-3 border-t",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"Documents"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 text-sm",children:[a.documents.nda&&(0,b.jsx)("button",{onClick:()=>q(a.documents.nda),className:"text-emerald-500 hover:text-emerald-400 hover:underline",children:"NDA"}),a.documents.subscription_pack&&(0,b.jsx)("button",{onClick:()=>q(a.documents.subscription_pack),className:"text-emerald-500 hover:text-emerald-400 hover:underline",children:"Sub Pack"}),a.documents.certificate&&(0,b.jsx)("button",{onClick:()=>q(a.documents.certificate),className:"text-emerald-500 hover:text-emerald-400 hover:underline",children:"Certificate"}),!a.documents.nda&&!a.documents.subscription_pack&&!a.documents.certificate&&(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"No documents"})]})]}),(0,b.jsxs)("div",{className:"pt-2 mt-auto space-y-2",children:[l&&(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"w-full border-amber-200 text-amber-700 hover:bg-amber-50 hover:text-amber-800",onClick:()=>j(!0),children:[(0,b.jsx)(I.TrendingDown,{className:"h-4 w-4 mr-2"}),"Request Sale"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"w-full",onClick:p,children:[(0,b.jsx)(a2.Eye,{className:"h-4 w-4 mr-2"}),"View Details"]})]})]}),l&&(0,b.jsx)(a0.Sheet,{open:i,onOpenChange:j,children:(0,b.jsxs)(a0.SheetContent,{className:"sm:max-w-md overflow-y-auto",children:[(0,b.jsx)(a0.SheetHeader,{className:"mb-4",children:(0,b.jsx)(a0.SheetTitle,{children:"Request Position Sale"})}),(0,b.jsx)(bb,{subscriptionId:a.subscription.id,vehicleName:a.name,fundedAmount:a.position.costBasis,currency:a.currency,onSuccess:()=>j(!1),onCancel:()=>j(!1)})]})})]})}function bd({children:a,investorIds:e,onDataUpdate:f,enableNotifications:g=!0,holdingsPath:h="/versotech_main/portfolio"}){var i;let j,[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),o=(0,c.useRef)([]),p=(0,c.useRef)(0),q=(0,c.useRef)(1e3),r=(0,c.useRef)(()=>{}),s=(0,a$.useRouter)();(0,c.useEffect)(()=>()=>{o.current.forEach(a=>{a.unsubscribe()}),o.current=[]},[]);let t=(0,c.useCallback)((i=a=>{if(n(new Date().toISOString()),f?.(a),g)switch(a.type){case"position_update":ba.toast.info("Portfolio position updated",{description:"Your holdings have been updated with the latest data.",duration:3e3});break;case"valuation_update":ba.toast.info("Valuation updated",{description:"New NAV data is available for your investments.",duration:3e3});break;case"allocation_update":ba.toast.success("Allocation confirmed",{description:"Your deal allocation has been processed.",duration:5e3});break;case"capital_call":ba.toast.warning("Capital call issued",{description:"A new capital call has been issued for one of your investments.",duration:1e4,action:{label:"View Details",onClick:()=>s.push(h)}});break;case"distribution":ba.toast.success("Distribution received",{description:"A distribution has been processed for your investment.",duration:8e3,action:{label:"View Details",onClick:()=>s.push(h)}});break;case"fee_accrual":ba.toast.info("Fee accrued",{description:"New fees have been accrued for your investments.",duration:5e3})}},j=null,(...a)=>{j&&clearTimeout(j),j=setTimeout(()=>{i(...a)},2e3)}),[f,g,h,s]);return(0,c.useEffect)(()=>{let a;if(!e.length)return;let b=async()=>{try{a=(0,d.createClient)(),o.current.forEach(a=>{a.unsubscribe()}),o.current=[];let b=`investor_id=in.(${e.join(",")})`,f=a.channel("positions_updates").on("postgres_changes",{event:"*",schema:"public",table:"positions",filter:b},a=>{console.log("Position update:",a),t({type:"position_update",data:a,timestamp:new Date().toISOString()})}).subscribe(a=>{console.log("Positions channel status:",a),"SUBSCRIBED"===a?(l(!0),p.current=0,q.current=1e3):"CHANNEL_ERROR"===a&&(l(!1),c())}),g=a.channel("valuations_updates").on("postgres_changes",{event:"*",schema:"public",table:"valuations"},a=>{console.log("Valuation update:",a),t({type:"valuation_update",data:a,timestamp:new Date().toISOString()})}).subscribe(),h=a.channel("allocations_updates").on("postgres_changes",{event:"*",schema:"public",table:"allocations",filter:b},a=>{console.log("Allocation update:",a),t({type:"allocation_update",data:a,timestamp:new Date().toISOString()})}).subscribe(),i=a.channel("capital_calls_updates").on("postgres_changes",{event:"INSERT",schema:"public",table:"capital_calls"},a=>{console.log("Capital call update:",a),t({type:"capital_call",data:a,timestamp:new Date().toISOString()})}).subscribe(),j=a.channel("distributions_updates").on("postgres_changes",{event:"INSERT",schema:"public",table:"distributions"},a=>{console.log("Distribution update:",a),t({type:"distribution",data:a,timestamp:new Date().toISOString()})}).subscribe(),k=a.channel("fee_events_updates").on("postgres_changes",{event:"*",schema:"public",table:"fee_events",filter:b},a=>{console.log("Fee event update:",a),t({type:"fee_accrual",data:a,timestamp:new Date().toISOString()})}).subscribe();o.current=[f,g,h,i,j,k],console.log("Realtime subscriptions established for investors:",e)}catch(a){console.error("Error setting up realtime subscriptions:",a),l(!1),c()}},c=()=>{p.current<5?setTimeout(()=>{console.log(`Attempting to reconnect... (attempt ${p.current+1})`),p.current++,q.current=Math.min(2*q.current,3e4),b()},q.current):(console.error("Max reconnection attempts reached"),ba.toast.error("Connection lost",{description:"Unable to maintain real-time updates. Please refresh the page.",duration:1e4,action:{label:"Refresh",onClick:()=>s.refresh()}}))};return r.current=c,b(),()=>{o.current.forEach(a=>{a.unsubscribe()}),o.current=[],l(!1)}},[e,t,s]),(0,c.useEffect)(()=>{let a=setInterval(()=>{!k&&p.current<5&&(console.log("Health check: Connection lost, attempting reconnection..."),p.current=0,r.current())},6e4);return()=>clearInterval(a)},[k]),(0,b.jsxs)("div",{className:"relative",children:[a,(0,b.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,b.jsxs)("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full text-xs font-medium transition-all duration-300 ${k?"bg-green-100 text-green-700 border border-green-200":"bg-red-100 text-red-700 border border-red-200"}`,children:[(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${k?"bg-green-500 animate-pulse":"bg-red-500"}`}),k?"Live":"Offline",m&&k&&(0,b.jsxs)("span",{className:"opacity-70",children:["â€¢ ",new Date(m).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})]})]})})]})}var be=a.i(211374),bf=a.i(877918);let bg=a=>{if(a.status)return a.status;let b=a.allocation_status?.toLowerCase();if("active"===b||"committed"===b||"pending"===b)return b;if("closed"===b||"cancelled"===b)return"closed";let c=a.subscription?.status?.toLowerCase();return"active"===c?"active":"committed"===c||"pending"===c?"pending":"closed"===c||"cancelled"===c?"closed":a.position&&a.position.currentValue>0?"active":"pending"};function bh({initialData:a,detailsBasePath:g="/versotech_main/portfolio",holdingsPath:h="/versotech_main/portfolio",dealsPath:i="/versotech_main/opportunities",positionsOnly:j=!1}){let[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(a),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)({search:"",type:"all",status:"all",performance:"all",size:"all",vintage:"all",domicile:"all"}),[E,F]=(0,c.useState)("value_desc"),G=(0,c.useCallback)(async(a=!0,b=!0,c=!0)=>{try{let d=new URLSearchParams;a&&d.append("breakdown","true"),b&&d.append("trends","true");let e={method:"GET",headers:{"Content-Type":"application/json"}};c||(e.cache="no-store");let f=await fetch(`/api/portfolio?${d.toString()}`,e);if(!f.ok){let a=await f.text();throw Error(`Failed to fetch portfolio data: ${a}`)}return await f.json()}catch(a){throw console.error("Portfolio fetch error:",a),a}},[]),H=(0,c.useCallback)(async(a=!0)=>{try{let b={method:"GET",headers:{"Content-Type":"application/json"}};a||(b.cache="no-store");let c=await fetch("/api/vehicles?related=true",b);if(!c.ok){let a=await c.text();throw Error(`Failed to fetch holdings: ${a}`)}let d=((await c.json()).vehicles||[]).map(a=>{let b=bg(a),c=a.subscription?{...a.subscription,commitment:null===a.subscription.commitment||void 0===a.subscription.commitment?null:Number(a.subscription.commitment),currency:a.subscription.currency||a.currency,status:a.subscription.status||a.allocation_status||b}:a.subscription;return{...a,status:b,allocation_status:a.allocation_status||c?.status||b,subscription:c}}),e=j?d.filter(a=>(a.position?.units??0)>0):d;l(e)}catch(a){throw console.error("Holdings fetch error:",a),a}},[j]);(0,c.useEffect)(()=>{(async()=>{p(!0),r(null);try{let b=(0,d.createClient)(),{data:{user:c}}=await b.auth.getUser();if(c){let{data:a}=await b.from("investor_users").select("investor_id").eq("user_id",c.id);if(a){let b=a.map(a=>a.investor_id);v(b)}}if(a)n(a),await H();else{let[a]=await Promise.all([G(),H()]);n(a)}}catch(a){console.error("Data load error:",a),r(a instanceof Error?a.message:"Failed to load portfolio data")}finally{p(!1)}})()},[a,G,H]);let I=async()=>{t(!0),r(null);try{let[a]=await Promise.all([G(!0,!0,!1),H(!1)]);n(a)}catch(a){console.error("Refresh error:",a),r(a instanceof Error?a.message:"Failed to refresh data")}finally{t(!1)}};(0,c.useEffect)(()=>{(async()=>{if(!m||!u.length)return;let a=(0,d.createClient)();try{if(m.vehicleBreakdown&&m.vehicleBreakdown.length>0){let a=m.vehicleBreakdown.reduce((a,b)=>a+(b.currentValue||0),0),b=m.vehicleBreakdown.map(b=>({name:b.vehicleName||"Unknown",value:b.currentValue||0,percentage:a>0?(b.currentValue||0)/a*100:0}));x(b)}let{data:b}=await a.from("valuations").select("vehicle_id, nav_total, as_of_date").in("vehicle_id",k.map(a=>a.id)).order("as_of_date",{ascending:!0}).limit(50);if(b&&b.length>0){let a=b.reduce((a,b)=>{let c=b.as_of_date.split("T")[0];return a[c]||(a[c]=0),a[c]+=b.nav_total||0,a},{}),c=Object.entries(a).map(([a,b])=>({date:a,value:b,displayDate:new Date(a).toLocaleDateString("en-US",{month:"short",year:"numeric"})}));z(c)}let{data:c}=await a.from("cashflows").select("type, amount, date").in("investor_id",u).order("date",{ascending:!0}).limit(100),d={};c?.forEach(a=>{let b=new Date(a.date).toISOString().substring(0,7);d[b]||(d[b]={period:b,contributions:0,distributions:0}),"call"===a.type?d[b].contributions+=a.amount||0:"distribution"===a.type&&(d[b].distributions+=a.amount||0)});let e=Object.values(d).map(a=>({...a,displayPeriod:new Date(a.period+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"})}));B(e)}catch(a){console.error("Chart data preparation error:",a)}})()},[m,u,k]);let J=(0,c.useMemo)(()=>{let a=[...k];if(C.search){let b=C.search.toLowerCase();a=a.filter(a=>a.name.toLowerCase().includes(b)||a.type.toLowerCase().includes(b)||a.domicile&&a.domicile.toLowerCase().includes(b))}if("all"!==C.type&&(a=a.filter(a=>a.type===C.type)),"all"!==C.status&&(a=a.filter(a=>bg(a)===C.status)),"all"!==C.performance&&(a=a.filter(a=>{let b=a.position?.unrealizedGainPct||0;switch(C.performance){case"positive":return b>0;case"negative":return b<0;case"breakeven":return 1>=Math.abs(b);default:return!0}})),"all"!==C.size&&(a=a.filter(a=>{let b=a.position?.currentValue||0;switch(C.size){case"large":return b>1e6;case"medium":return b>=1e5&&b<=1e6;case"small":return b<1e5;default:return!0}})),"all"!==C.domicile&&(a=a.filter(a=>(a.domicile?.toLowerCase()||"other")===C.domicile)),"all"!==C.vintage){let b=new Date;a=a.filter(a=>{let c=new Date(a.created_at),d=(b.getTime()-c.getTime())/31536e6;switch(C.vintage){case"recent":return d<2;case"mature":return d>=2&&d<=5;case"legacy":return d>5;default:return!0}})}return(void 0!==C.minValue||void 0!==C.maxValue)&&(a=a.filter(a=>{let b=a.position?.currentValue||0,c=C.minValue??0,d=C.maxValue??1/0;return b>=c&&b<=d})),(void 0!==C.minReturn||void 0!==C.maxReturn)&&(a=a.filter(a=>{let b=a.position?.unrealizedGainPct||0,c=C.minReturn??-1/0,d=C.maxReturn??1/0;return b>=c&&b<=d})),a.sort((a,b)=>{switch(E){case"name_asc":return a.name.localeCompare(b.name);case"name_desc":return b.name.localeCompare(a.name);case"value_asc":return(a.position?.currentValue||0)-(b.position?.currentValue||0);case"value_desc":return(b.position?.currentValue||0)-(a.position?.currentValue||0);case"performance_asc":return(a.position?.unrealizedGainPct||0)-(b.position?.unrealizedGainPct||0);case"performance_desc":return(b.position?.unrealizedGainPct||0)-(a.position?.unrealizedGainPct||0);case"commitment_asc":return(a.subscription?.commitment||0)-(b.subscription?.commitment||0);case"commitment_desc":return(b.subscription?.commitment||0)-(a.subscription?.commitment||0);case"date_asc":return new Date(a.created_at).getTime()-new Date(b.created_at).getTime();case"date_desc":return new Date(b.created_at).getTime()-new Date(a.created_at).getTime();default:return 0}}),a},[k,C,E]),M=Object.entries(C).filter(([a,b])=>"search"!==a&&"all"!==b).length+ +!!C.search,N=()=>{D({search:"",type:"all",status:"all",performance:"all",size:"all",vintage:"all",domicile:"all"})},O=(0,c.useCallback)(()=>{if(0===J.length)return;let a=new Blob([["Name,Type,Domicile,Status,Currency,Current Value,Cost Basis,Unrealized Gain,Unrealized Gain %,Units,Commitment,Created Date",...J.map(a=>[a.name,a.type.replace(/_/g," "),a.domicile||"",bg(a),a.currency,a.position?.currentValue?.toFixed(2)||"0",a.position?.costBasis?.toFixed(2)||"0",a.position?.unrealizedGain?.toFixed(2)||"0",a.position?.unrealizedGainPct?.toFixed(2)||"0",a.position?.units?.toString()||"0",a.subscription?.commitment?.toFixed(2)||"0",new Date(a.created_at).toLocaleDateString()]).map(a=>a.map(a=>`"${String(a).replace(/"/g,'""')}"`).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a"),c=URL.createObjectURL(a);b.setAttribute("href",c),b.setAttribute("download",`portfolio-holdings-${new Date().toISOString().split("T")[0]}.csv`),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(c)},[J]);if(o)return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)(be.Skeleton,{className:"h-8 w-64"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:8}).map((a,c)=>(0,b.jsx)(be.Skeleton,{className:"h-32"},c))})]});if(q&&!m)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)(a5.Alert,{children:[(0,b.jsx)(bf.AlertCircle,{className:"h-4 w-4"}),(0,b.jsxs)(a5.AlertDescription,{children:[q,(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:I,className:"ml-4",disabled:s,children:[(0,b.jsx)(L.RefreshCw,{className:(0,P.cn)("h-4 w-4 mr-2",s&&"animate-spin")}),"Retry"]})]})]})});let Q=J.length;return(0,b.jsx)(bd,{investorIds:u,onDataUpdate:()=>I(),enableNotifications:!0,holdingsPath:h,children:(0,b.jsx)("div",{className:"min-h-screen bg-background",children:(0,b.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Portfolio Holdings"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Complete overview of your investments"})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)(f.Button,{variant:"default",size:"sm",onClick:()=>window.location.href=i,children:[(0,b.jsx)(K.Target,{className:"h-4 w-4 mr-2"}),"Explore Active Deals"]})})]}),m&&(0,b.jsx)(U,{kpis:m.kpis,trends:m.trends,summary:m.summary,asOfDate:m.asOfDate,isLoading:s,onRefresh:I,onExport:O,vehicleBreakdown:m.vehicleBreakdown,allocationData:w,performanceData:y,cashFlowData:A}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Your Holdings"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[J.length," total holdings"]})]}),(0,b.jsx)(aZ,{filters:C,onFiltersChange:D,sortBy:E,onSortChange:F,onClearFilters:N,activeFiltersCount:M,totalResults:Q}),0===Q?(0,b.jsx)(e.Card,{className:"border-dashed",children:(0,b.jsxs)(e.CardContent,{className:"flex flex-col items-center justify-center py-16",children:[(0,b.jsx)(bf.AlertCircle,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No holdings found"}),(0,b.jsx)("p",{className:"text-muted-foreground text-center max-w-sm",children:M>0?"Try adjusting your filters to see more results":"Your holdings will appear here once investments are made"}),M>0&&(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:N,className:"mt-4",children:"Clear filters"})]})}):(0,b.jsx)("div",{className:"grid gap-6 grid-cols-1 lg:grid-cols-2",children:J.map(a=>(0,b.jsx)(bc,{holding:a,detailsBasePath:g},a.id))})]})]})})})}a.s(["HoldingsPage",()=>bh],405002)}];

//# sourceMappingURL=versotech-portal_src_components_holdings_holdings-page_tsx_03fc1dc7._.js.map