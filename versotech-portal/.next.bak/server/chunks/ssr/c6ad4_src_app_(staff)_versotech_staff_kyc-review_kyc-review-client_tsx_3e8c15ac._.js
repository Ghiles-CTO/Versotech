module.exports=[676379,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(441278),e=a.i(625473),f=a.i(42329),g=a.i(877918),h=a.i(816854),i=a.i(577955),j=a.i(672606),k=a.i(195587),l=a.i(598626),m=a.i(618287),n=a.i(540316),o=a.i(142015),p=a.i(421908),q=a.i(284169),r=a.i(15788),s=a.i(663475),t=a.i(249464),u=a.i(191675),v=a.i(951870),w=a.i(470305),x=a.i(910187),y=a.i(771088),z=a.i(899750),A=a.i(518173),B=a.i(160409),C=a.i(877028),D=a.i(325866),E=a.i(871057),F=a.i(671948),G=a.i(496392),H=a.i(776404),I=a.i(675167),J=a.i(966494),K=a.i(838086),L=a.i(752907),M=a.i(38373);let N={fullName:"Full Legal Name",dateOfBirth:"Date of Birth",nationality:"Nationality",countryOfResidence:"Country of Residence",residentialAddress:"Residential Address",city:"City",postalCode:"Postal Code",email:"Email Address",phone:"Phone Number",taxIdNumber:"Tax ID Number",taxResidencyCountry:"Tax Residency Country",investmentType:"Investment Type",investmentTypeOther:"Other Investment Type",isWellInformed:"Well-Informed Investor?",wellInformedBasis:"Basis for Well-Informed Status",wellInformedEvidence:"Supporting Evidence",isPEP:"Politically Exposed Person (PEP)?",pepDetails:"PEP Details",isRelatedToPEP:"Related to a PEP?",relatedPEPDetails:"Related PEP Details",isSanctioned:"Subject to Sanctions?",sanctionedDetails:"Sanctions Details",hasCriminalRecord:"Criminal Record?",criminalDetails:"Criminal Record Details",isUnderInvestigation:"Under Investigation?",investigationDetails:"Investigation Details",hasBankruptcy:"Bankruptcy History?",bankruptcyDetails:"Bankruptcy Details",isUSPerson:"US Person?",sourceOfFunds:"Source of Funds",sourceOfWealth:"Source of Wealth",isUSCitizen:"US Citizen?",isUSResident:"US Resident?",hasUSGreenCard:"US Green Card Holder?",hasSubstantialUSPresence:"Substantial US Presence?",hasUSMailingAddress:"US Mailing Address?",hasUSPhoneNumber:"US Phone Number?",hasUSBankAccount:"US Bank Account?",hasUSPowerOfAttorney:"US Power of Attorney?",usConnectionDetails:"US Connection Details",isAccreditedInvestor:"Accredited Investor?",accreditationBasis:"Accreditation Basis",hasReceivedOfferingMaterials:"Received Offering Materials?",understandsRestrictions:"Understands Restrictions?",acknowledgesFATCA:"FATCA Acknowledgment",willProvideW9:"Will Provide W-9?",understandsWithholding:"Understands Withholding?",certifiesTaxCompliance:"Certifies Tax Compliance?",acknowledgesReportingObligations:"Reporting Obligations Acknowledged?",educationLevel:"Education Level",employmentStatus:"Employment Status",occupation:"Occupation",employer:"Employer",yearsInvestingExperience:"Years of Investment Experience",annualIncome:"Annual Income",netWorth:"Net Worth",liquidNetWorth:"Liquid Net Worth",investmentObjective:"Investment Objective",riskTolerance:"Risk Tolerance",investmentHorizon:"Investment Time Horizon",percentageOfNetWorthToInvest:"% of Net Worth to Invest",hasAlternativeInvestmentExperience:"Alternative Investment Experience?",alternativeInvestmentTypes:"Types of Alternative Investments",acknowledgesIlliquidity:"Acknowledges Illiquidity Risk",acknowledgesLossRisk:"Acknowledges Loss Risk",acknowledgesNoGuarantees:"Acknowledges No Guarantees",acknowledgesLimitedInfo:"Acknowledges Limited Information",acknowledgesNoRegulation:"Acknowledges Limited Regulation",acknowledgesConflicts:"Acknowledges Conflicts of Interest",acknowledgesTaxImplications:"Acknowledges Tax Implications",acknowledgesFees:"Acknowledges Fees",hasReadOfferingDocs:"Has Read Offering Documents",hasSoughtIndependentAdvice:"Has Sought Independent Advice",certifiesAccuracy:"Certifies Accuracy",certifiesNoOmissions:"Certifies No Omissions",agreesToUpdates:"Agrees to Provide Updates",consentToProcessing:"Consents to Data Processing",signatureName:"Signature Name",signatureDate:"Signature Date",lastCompletedStep:"Last Completed Step",wizardVersion:"Form Version"},O=["isPEP","isRelatedToPEP","isSanctioned","hasCriminalRecord","isUnderInvestigation","hasBankruptcy"],P={step1:["fullName","dateOfBirth","nationality","countryOfResidence","residentialAddress","city","postalCode","email","phone","taxIdNumber","taxResidencyCountry"],step2:["investmentType","investmentTypeOther"],step3:["isWellInformed","wellInformedBasis","wellInformedEvidence"],step4:["isPEP","pepDetails","isRelatedToPEP","relatedPEPDetails","isSanctioned","sanctionedDetails","hasCriminalRecord","criminalDetails","isUnderInvestigation","investigationDetails","hasBankruptcy","bankruptcyDetails","isUSPerson","sourceOfFunds","sourceOfWealth"],step5:["isUSCitizen","isUSResident","hasUSGreenCard","hasSubstantialUSPresence","hasUSMailingAddress","hasUSPhoneNumber","hasUSBankAccount","hasUSPowerOfAttorney","usConnectionDetails"],step6:["isAccreditedInvestor","accreditationBasis","hasReceivedOfferingMaterials","understandsRestrictions"],step7:["acknowledgesFATCA","willProvideW9","understandsWithholding","certifiesTaxCompliance","acknowledgesReportingObligations"],step8:["educationLevel","employmentStatus","occupation","employer","yearsInvestingExperience","annualIncome","netWorth","liquidNetWorth","investmentObjective","riskTolerance","investmentHorizon","percentageOfNetWorthToInvest","hasAlternativeInvestmentExperience","alternativeInvestmentTypes"],step9:["acknowledgesIlliquidity","acknowledgesLossRisk","acknowledgesNoGuarantees","acknowledgesLimitedInfo","acknowledgesNoRegulation","acknowledgesConflicts","acknowledgesTaxImplications","acknowledgesFees","hasReadOfferingDocs","hasSoughtIndependentAdvice"],step10:["certifiesAccuracy","certifiesNoOmissions","agreesToUpdates","consentToProcessing","signatureName","signatureDate"]},Q={step1:D.User,step2:E.Briefcase,step3:F.GraduationCap,step4:G.Shield,step5:H.Flag,step6:h.FileText,step7:I.FileCheck,step8:J.TrendingUp,step9:K.AlertTriangle,step10:L.PenTool};function R(a){return a.replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/\b\w/g,a=>a.toUpperCase()).trim()}function S({open:a,onClose:c,investorName:f,submittedAt:i,metadata:j}){if(!j)return null;let k={};for(let[a,b]of Object.entries(j))a.startsWith("step")&&"object"==typeof b&&null!==b?Object.assign(k,b):k[a]=b;let l="yes"===k.isUSPerson;return(0,b.jsx)(w.Dialog,{open:a,onOpenChange:a=>!a&&c(),children:(0,b.jsxs)(w.DialogContent,{className:"max-w-3xl max-h-[85vh] flex flex-col overflow-hidden",children:[(0,b.jsxs)(w.DialogHeader,{className:"flex-shrink-0",children:[(0,b.jsxs)(w.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(h.FileText,{className:"h-5 w-5"}),"KYC Questionnaire Responses"]}),(0,b.jsxs)(w.DialogDescription,{children:["Submitted by ",(0,b.jsx)("span",{className:"font-medium text-foreground",children:f})," on"," ",new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),(0,b.jsx)("div",{className:"flex-1 min-h-0 -mx-6 px-6 overflow-y-auto",children:(0,b.jsx)("div",{className:"space-y-6 py-4",children:(l?["step1","step2","step3","step4","step5","step6","step7","step8","step9","step10"]:["step1","step2","step3","step4","step8","step9","step10"]).map(a=>{let c,f=(c=parseInt(a.replace("step",""))-1,M.STEP_CONFIG[c]),i=Q[a]||h.FileText,j=(P[a]||[]).filter(a=>void 0!==k[a]&&""!==k[a]);return 0===j.length?null:(0,b.jsxs)(q.Card,{className:"border-border/50",children:[(0,b.jsx)(q.CardHeader,{className:"pb-3",children:(0,b.jsxs)(q.CardTitle,{className:"text-base font-semibold flex items-center gap-2",children:[(0,b.jsx)(i,{className:"h-4 w-4 text-muted-foreground"}),f?.title||`Step ${a.replace("step","")}`,"step4"===a&&(0,b.jsx)(r.Badge,{variant:"outline",className:"ml-2 text-xs font-normal",children:"Compliance"})]})}),(0,b.jsx)(q.CardContent,{className:"pt-0",children:(0,b.jsx)("div",{className:"grid gap-3",children:j.map(a=>{var c;let f=k[a],h=!!O.includes(a)&&("yes"===f||!0===f),i=N[a]||R(a),j=null==(c=f)||""===c?"—":"boolean"==typeof c?c?"Yes":"No":"yes"===c||"no"===c?"yes"===c?"Yes":"No":Array.isArray(c)?0===c.length?"—":c.map(a=>R(String(a))).join(", "):"string"==typeof c&&(c.includes("_")||/^[a-z]+[A-Z]/.test(c))?R(c):String(c);return(0,b.jsxs)("div",{className:`flex flex-col gap-1 p-3 rounded-lg ${h?"bg-destructive/10 border border-destructive/30":"bg-muted/50"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:i}),h&&(0,b.jsxs)(r.Badge,{variant:"destructive",className:"text-xs",children:[(0,b.jsx)(g.AlertCircle,{className:"h-3 w-3 mr-1"}),"Requires Review"]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:"boolean"==typeof f||"yes"===f||"no"===f?(0,b.jsxs)(b.Fragment,{children:[!0===f||"yes"===f?(0,b.jsx)(d.CheckCircle,{className:`h-4 w-4 ${h?"text-destructive":"text-emerald-500"}`}):(0,b.jsx)(e.XCircle,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:`text-sm ${h?"font-semibold text-destructive":"text-foreground"}`,children:j})]}):(0,b.jsx)("span",{className:"text-sm text-foreground",children:j})})]},a)})})})]},a)})})}),(0,b.jsx)(C.Separator,{className:"flex-shrink-0"}),(0,b.jsx)(w.DialogFooter,{className:"pt-4 flex-shrink-0",children:(0,b.jsx)(p.Button,{onClick:c,children:"Close"})})]})})}var T=a.i(478274),U=a.i(888987);function V(){let[a,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!0),[J,K]=(0,c.useState)("all"),[L,M]=(0,c.useState)("all"),[N,O]=(0,c.useState)("all"),[P,Q]=(0,c.useState)(""),[R,V]=(0,c.useState)(1),[W,X]=(0,c.useState)(25),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)("approve"),[ac,ad]=(0,c.useState)(""),[ae,af]=(0,c.useState)(""),[ag,ah]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(new Set),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)(""),ao=a.filter(a=>["pending","under_review"].includes(a.status)),ap=()=>aj(new Set),aq=async(a,b)=>{if(0!==ai.size){ah(!0);try{let c=Array.from(ai).map(c=>fetch(`/api/staff/kyc-submissions/${c}/review`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:a,rejection_reason:"reject"===a?b:void 0})})),d=(await Promise.all(c)).filter(a=>a.ok).length;z.toast.success(`${d} document${1!==d?"s":""} ${"approve"===a?"approved":"rejected"}`),ap(),al(!1),an(""),await aB()}catch(a){console.error("Bulk action error:",a),z.toast.error("Failed to process some documents")}finally{ah(!1)}}},{isOpen:ar,document:as,previewUrl:at,isLoading:au,error:av,openPreview:aw,closePreview:ax,downloadDocument:ay}=(0,B.useDocumentViewer)(),[az,aA]=(0,c.useState)(null),aB=(0,c.useCallback)(async()=>{try{let a=new URLSearchParams;"all"!==J&&a.append("status",J),"all"!==L&&a.append("document_type",L),"all"!==N&&a.append("investor_id",N),a.append("page",String(R)),a.append("pageSize",String(W));let b=await fetch(`/api/staff/kyc-submissions?${a.toString()}`);if(!b.ok){let a=await b.json();throw console.error("API error response:",a),Error(a.error||"Failed to load submissions")}let c=await b.json();C(c.submissions||[]),E(c.statistics||null),G(c.pagination||null)}catch(a){console.error("Error loading submissions:",a),z.toast.error("Failed to load KYC submissions",{description:a.message})}finally{I(!1)}},[J,L,N,R,W]);(0,c.useEffect)(()=>{V(1)},[J,L,N]),(0,c.useEffect)(()=>{aB()},[aB]);let aC=(a,b)=>{_(a),ab(b),ad(""),af(""),Z(!0)},aD=async()=>{if($){if(("reject"===aa||"request_info"===aa)&&!ac.trim())return void z.toast.error("request_info"===aa?"Please specify what additional information is needed":"Please provide a rejection reason");ah(!0);try{let a=await fetch(`/api/staff/kyc-submissions/${$.id}/review`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:aa,rejection_reason:"reject"===aa||"request_info"===aa?ac:void 0,notes:ae||void 0})});if(!a.ok){let b=await a.json();throw Error(b.error||"Review failed")}z.toast.success({approve:"Document approved successfully",reject:"Document rejected successfully",request_info:"Information request sent to investor"}[aa]),Z(!1),await aB()}catch(a){console.error("Review error:",a),z.toast.error(a.message||"Failed to review document")}finally{ah(!1)}}},aE=Array.from(new Set(a.map(a=>a.document_type))).sort(),aF=Array.from(new Map(a.filter(a=>a.investor).map(a=>[a.investor.id,a.investor])).values()).sort((a,b)=>(a.display_name||a.legal_name).localeCompare(b.display_name||b.legal_name)),aG=a.filter(a=>{if(P){let b=P.toLowerCase(),c=(0,T.getDocumentTypeLabel)(a.document_type,a.custom_label).toLowerCase();return a.investor?.display_name.toLowerCase().includes(b)||a.investor?.legal_name.toLowerCase().includes(b)||a.investor?.email.toLowerCase().includes(b)||c.includes(b)||a.counterparty_entity?.legal_name.toLowerCase().includes(b)}return!0});return H?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"KYC Document Review"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Review and approve investor KYC documents"})]}),D&&(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-4 lg:grid-cols-7",children:[(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{className:"pb-2",children:(0,b.jsx)(q.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-foreground",children:D.total})})]}),(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{className:"pb-2",children:(0,b.jsx)(q.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Draft"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-slate-500",children:D.draft})})]}),(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{className:"pb-2",children:(0,b.jsx)(q.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Pending"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-amber-500",children:D.pending})})]}),(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{className:"pb-2",children:(0,b.jsx)(q.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Under Review"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:D.under_review})})]}),(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{className:"pb-2",children:(0,b.jsx)(q.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Approved"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-emerald-500",children:D.approved})})]}),(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{className:"pb-2",children:(0,b.jsx)(q.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Rejected"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-rose-500",children:D.rejected})})]}),(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{className:"pb-2",children:(0,b.jsx)(q.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Expired"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-slate-400",children:D.expired})})]})]}),(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{children:(0,b.jsx)(q.CardTitle,{children:"Filters"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Label,{htmlFor:"status-filter",children:"Status"}),(0,b.jsxs)(v.Select,{value:J,onValueChange:K,children:[(0,b.jsx)(v.SelectTrigger,{id:"status-filter",children:(0,b.jsx)(v.SelectValue,{placeholder:"All statuses"})}),(0,b.jsxs)(v.SelectContent,{children:[(0,b.jsx)(v.SelectItem,{value:"all",children:"All Statuses"}),(0,b.jsx)(v.SelectItem,{value:"draft",children:"Draft"}),(0,b.jsx)(v.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(v.SelectItem,{value:"under_review",children:"Under Review"}),(0,b.jsx)(v.SelectItem,{value:"approved",children:"Approved"}),(0,b.jsx)(v.SelectItem,{value:"rejected",children:"Rejected"}),(0,b.jsx)(v.SelectItem,{value:"expired",children:"Expired"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Label,{htmlFor:"type-filter",children:"Document Type"}),(0,b.jsxs)(v.Select,{value:L,onValueChange:M,children:[(0,b.jsx)(v.SelectTrigger,{id:"type-filter",children:(0,b.jsx)(v.SelectValue,{placeholder:"All types"})}),(0,b.jsxs)(v.SelectContent,{children:[(0,b.jsx)(v.SelectItem,{value:"all",children:"All Types"}),aE.map(a=>(0,b.jsx)(v.SelectItem,{value:a,children:(0,T.getDocumentTypeLabel)(a)},a))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Label,{htmlFor:"investor-filter",children:"Investor"}),(0,b.jsxs)(v.Select,{value:N,onValueChange:O,children:[(0,b.jsx)(v.SelectTrigger,{id:"investor-filter",children:(0,b.jsx)(v.SelectValue,{placeholder:"All investors"})}),(0,b.jsxs)(v.SelectContent,{children:[(0,b.jsx)(v.SelectItem,{value:"all",children:"All Investors"}),aF.map(a=>(0,b.jsx)(v.SelectItem,{value:a.id,children:a.display_name||a.legal_name},a.id))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Label,{htmlFor:"search",children:"Search"}),(0,b.jsx)(s.Input,{id:"search",placeholder:"Search investor name or email...",value:P,onChange:a=>Q(a.target.value)})]})]})})]}),(0,b.jsxs)(q.Card,{children:[(0,b.jsxs)(q.CardHeader,{children:[(0,b.jsxs)(q.CardTitle,{children:["Submissions (",aG.length,")"]}),(0,b.jsx)(q.CardDescription,{children:"Review pending KYC documents and approve or reject them"})]}),(0,b.jsxs)(q.CardContent,{children:[(0,b.jsxs)(y.Table,{children:[(0,b.jsx)(y.TableHeader,{children:(0,b.jsxs)(y.TableRow,{children:[(0,b.jsx)(y.TableHead,{className:"w-10",children:(0,b.jsx)("input",{type:"checkbox",checked:ai.size>0&&ai.size===ao.length,onChange:a=>a.target.checked?void aj(new Set(ao.map(a=>a.id))):ap(),className:"h-4 w-4 rounded border-gray-300"})}),(0,b.jsx)(y.TableHead,{children:"Investor"}),(0,b.jsx)(y.TableHead,{children:"Document Type"}),(0,b.jsx)(y.TableHead,{children:"Content"}),(0,b.jsx)(y.TableHead,{children:"Submitted"}),(0,b.jsx)(y.TableHead,{children:"Status"}),(0,b.jsx)(y.TableHead,{children:"Reviewer"}),(0,b.jsx)(y.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(y.TableBody,{children:0===aG.length?(0,b.jsx)(y.TableRow,{children:(0,b.jsx)(y.TableCell,{colSpan:8,className:"text-center text-muted-foreground py-8",children:"No submissions found"})}):aG.map(a=>(0,b.jsxs)(y.TableRow,{children:[(0,b.jsx)(y.TableCell,{children:["pending","under_review"].includes(a.status)&&(0,b.jsx)("input",{type:"checkbox",checked:ai.has(a.id),onChange:()=>{var b;return b=a.id,void aj(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})},className:"h-4 w-4 rounded border-gray-300"})}),(0,b.jsx)(y.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium flex items-center gap-1",children:a.counterparty_entity?(0,b.jsxs)(b.Fragment,{children:[a.counterparty_entity.legal_name,(0,b.jsx)(r.Badge,{variant:"outline",className:"ml-2 text-xs",children:"Entity"})]}):(0,b.jsxs)(b.Fragment,{children:[a.investor?.display_name||a.investor?.legal_name||"Unknown",a.investor?.id&&(0,b.jsx)("a",{href:`/versotech/staff/investors/${a.investor.id}`,target:"_blank",rel:"noopener noreferrer",className:"ml-1 text-muted-foreground hover:text-foreground transition-colors",title:"View investor profile",children:(0,b.jsx)(m.ExternalLink,{className:"w-3 h-3"})})]})}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1 flex-wrap",children:[a.investor?.email||"",a.investor?.type&&["entity","corporate","institution"].includes(a.investor.type)&&(0,b.jsx)(r.Badge,{variant:"secondary",className:"text-xs",children:a.investor.type}),a.investor?.kyc_status&&(0,b.jsxs)(r.Badge,{variant:"outline",className:`text-xs ${"approved"===a.investor.kyc_status?"border-emerald-500 text-emerald-500":"pending"===a.investor.kyc_status?"border-amber-500 text-amber-500":"rejected"===a.investor.kyc_status?"border-rose-500 text-rose-500":"border-muted-foreground text-muted-foreground"}`,children:["KYC: ",a.investor.kyc_status]})]})]})}),(0,b.jsx)(y.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:(0,T.getDocumentTypeLabel)(a.document_type,a.custom_label)}),a.investor_member&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-0.5",children:(0,b.jsxs)(r.Badge,{variant:"outline",className:"text-xs font-normal",children:[a.investor_member.full_name,a.investor_member.role_title&&` (${a.investor_member.role_title})`]})}),a.version&&a.version>1&&(0,b.jsxs)("div",{className:"text-xs text-amber-500 mt-0.5",children:["v",a.version]})]})}),(0,b.jsx)(y.TableCell,{children:a.document?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.FileText,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm truncate max-w-[200px]",children:a.document.name})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground ml-6",children:(0,U.formatFileSize)(a.document.file_size_bytes)})]}):a.metadata&&"questionnaire"===a.document_type?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.ClipboardList,{className:"w-4 h-4 text-blue-500"}),(0,b.jsx)("span",{className:"text-sm text-blue-500 font-medium",children:"Questionnaire Responses"})]}):(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"No content"})}),(0,b.jsxs)(y.TableCell,{children:[(0,b.jsx)("div",{className:"text-sm",children:new Date(a.submitted_at).toLocaleDateString()}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(a.submitted_at).toLocaleTimeString()})]}),(0,b.jsx)(y.TableCell,{children:(0,b.jsxs)("div",{children:[(a=>{switch(a){case"approved":return(0,b.jsxs)(r.Badge,{className:"bg-green-500",children:[(0,b.jsx)(d.CheckCircle,{className:"w-3 h-3 mr-1"}),"Approved"]});case"rejected":return(0,b.jsxs)(r.Badge,{variant:"destructive",children:[(0,b.jsx)(e.XCircle,{className:"w-3 h-3 mr-1"}),"Rejected"]});case"under_review":return(0,b.jsxs)(r.Badge,{variant:"secondary",children:[(0,b.jsx)(f.Clock,{className:"w-3 h-3 mr-1"}),"Under Review"]});case"pending":return(0,b.jsxs)(r.Badge,{className:"bg-amber-500",children:[(0,b.jsx)(f.Clock,{className:"w-3 h-3 mr-1"}),"Pending"]});case"draft":return(0,b.jsxs)(r.Badge,{variant:"outline",className:"border-slate-400 text-slate-400",children:[(0,b.jsx)(f.Clock,{className:"w-3 h-3 mr-1"}),"Draft"]});case"expired":return(0,b.jsxs)(r.Badge,{variant:"outline",children:[(0,b.jsx)(g.AlertCircle,{className:"w-3 h-3 mr-1"}),"Expired"]});default:return null}})(a.status),"rejected"===a.status&&a.rejection_reason&&(0,b.jsx)(x.TooltipProvider,{children:(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,b.jsx)("div",{className:"text-xs text-rose-400 mt-1 max-w-[200px] truncate cursor-help",children:a.rejection_reason})}),(0,b.jsx)(x.TooltipContent,{className:"max-w-[300px]",children:(0,b.jsx)("p",{className:"text-sm",children:a.rejection_reason})})]})})]})}),(0,b.jsx)(y.TableCell,{children:a.reviewer?(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("div",{children:a.reviewer.display_name}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(a.reviewed_at).toLocaleDateString()})]}):(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"})}),(0,b.jsx)(y.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[a.document&&(0,b.jsx)(x.TooltipProvider,{children:(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(p.Button,{variant:"ghost",size:"sm",onClick:()=>{a.document&&aw({id:a.document.id,file_name:a.document.name,name:a.document.name,mime_type:a.document.mime_type,file_size_bytes:a.document.file_size_bytes})},children:(0,b.jsx)(h.FileText,{className:"w-4 h-4"})})}),(0,b.jsx)(x.TooltipContent,{children:(0,b.jsx)("p",{children:"View Document"})})]})}),a.metadata&&"questionnaire"===a.document_type&&(0,b.jsx)(x.TooltipProvider,{children:(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(p.Button,{variant:"ghost",size:"sm",onClick:()=>aA(a),children:(0,b.jsx)(n.ClipboardList,{className:"w-4 h-4"})})}),(0,b.jsx)(x.TooltipContent,{children:(0,b.jsx)("p",{children:"View Questionnaire Answers"})})]})}),["pending","under_review"].includes(a.status)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(p.Button,{variant:"outline",size:"sm",className:"text-emerald-500 border-emerald-500 hover:bg-emerald-950 hover:text-emerald-400",onClick:()=>aC(a,"approve"),children:[(0,b.jsx)(d.CheckCircle,{className:"w-4 h-4 mr-1"}),"Approve"]}),(0,b.jsxs)(p.Button,{variant:"outline",size:"sm",className:"text-amber-500 border-amber-500 hover:bg-amber-950 hover:text-amber-400",onClick:()=>aC(a,"request_info"),children:[(0,b.jsx)(o.MessageSquare,{className:"w-4 h-4 mr-1"}),"Request Info"]}),(0,b.jsxs)(p.Button,{variant:"outline",size:"sm",className:"text-rose-500 border-rose-500 hover:bg-rose-950 hover:text-rose-400",onClick:()=>aC(a,"reject"),children:[(0,b.jsx)(e.XCircle,{className:"w-4 h-4 mr-1"}),"Reject"]})]})]})})]},a.id))})]}),F&&F.totalPages>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-2 py-4 border-t",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsxs)("span",{children:["Showing ",(F.page-1)*F.pageSize+1," to"," ",Math.min(F.page*F.pageSize,F.totalCount)," of"," ",F.totalCount," submissions"]}),(0,b.jsxs)(v.Select,{value:String(W),onValueChange:a=>{X(Number(a)),V(1)},children:[(0,b.jsx)(v.SelectTrigger,{className:"h-8 w-[70px]",children:(0,b.jsx)(v.SelectValue,{placeholder:W})}),(0,b.jsxs)(v.SelectContent,{children:[(0,b.jsx)(v.SelectItem,{value:"10",children:"10"}),(0,b.jsx)(v.SelectItem,{value:"25",children:"25"}),(0,b.jsx)(v.SelectItem,{value:"50",children:"50"}),(0,b.jsx)(v.SelectItem,{value:"100",children:"100"})]})]}),(0,b.jsx)("span",{children:"per page"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(p.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>V(1),disabled:!F.hasPrevPage,children:(0,b.jsx)(k.ChevronsLeft,{className:"h-4 w-4"})}),(0,b.jsx)(p.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>V(R-1),disabled:!F.hasPrevPage,children:(0,b.jsx)(i.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsxs)("span",{className:"flex items-center gap-1 px-2 text-sm",children:["Page ",F.page," of ",F.totalPages]}),(0,b.jsx)(p.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>V(R+1),disabled:!F.hasNextPage,children:(0,b.jsx)(j.ChevronRight,{className:"h-4 w-4"})}),(0,b.jsx)(p.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>V(F.totalPages),disabled:!F.hasNextPage,children:(0,b.jsx)(l.ChevronsRight,{className:"h-4 w-4"})})]})]})]})]}),(0,b.jsx)(w.Dialog,{open:Y,onOpenChange:Z,children:(0,b.jsxs)(w.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(w.DialogHeader,{children:[(0,b.jsxs)(w.DialogTitle,{children:["approve"===aa&&"Approve Document","reject"===aa&&"Reject Document","request_info"===aa&&"Request Additional Information"]}),(0,b.jsx)(w.DialogDescription,{children:$&&(0,b.jsxs)(b.Fragment,{children:[(0,T.getDocumentTypeLabel)($.document_type,$.custom_label)," for"," ",$.counterparty_entity?`${$.counterparty_entity.legal_name} (Entity of ${$.investor?.display_name||$.investor?.legal_name||"Unknown"})`:$.investor?.display_name||$.investor?.legal_name||"Unknown"]})})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[("reject"===aa||"request_info"===aa)&&(0,b.jsxs)("div",{children:[(0,b.jsxs)(t.Label,{htmlFor:"rejection-reason",children:["request_info"===aa?"What information is needed?":"Rejection Reason"," ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(u.Textarea,{id:"rejection-reason",placeholder:"request_info"===aa?"Please specify what additional information or documents the investor needs to provide...":"Please explain why this document is being rejected...",value:ac,onChange:a=>ad(a.target.value),rows:4,className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Label,{htmlFor:"review-notes",children:"Notes (Optional)"}),(0,b.jsx)(u.Textarea,{id:"review-notes",placeholder:"Any additional notes...",value:ae,onChange:a=>af(a.target.value),rows:3,className:"mt-1"})]})]}),(0,b.jsxs)(w.DialogFooter,{children:[(0,b.jsx)(p.Button,{variant:"outline",onClick:()=>Z(!1),disabled:ag,children:"Cancel"}),(0,b.jsx)(p.Button,{onClick:aD,disabled:ag,className:"approve"===aa?"bg-emerald-600 hover:bg-emerald-700":"request_info"===aa?"bg-amber-600 hover:bg-amber-700":"",children:ag?"Processing...":"approve"===aa?"Approve":"request_info"===aa?"Send Request":"Reject"})]})]})}),(0,b.jsx)(A.DocumentViewerFullscreen,{isOpen:ar,document:as,previewUrl:at,isLoading:au,error:av,onClose:ax,onDownload:ay}),az&&(0,b.jsx)(S,{open:!!az,onClose:()=>aA(null),investorName:az.investor?.display_name||az.investor?.legal_name||"Unknown",submittedAt:az.submitted_at,metadata:az.metadata||{}}),ai.size>0&&(0,b.jsxs)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 bg-background border border-border rounded-lg shadow-lg p-4 flex items-center gap-4 z-50",children:[(0,b.jsxs)("span",{className:"text-sm text-muted-foreground font-medium",children:[ai.size," selected"]}),(0,b.jsxs)(p.Button,{size:"sm",className:"bg-emerald-600 hover:bg-emerald-700",onClick:()=>aq("approve"),disabled:ag,children:[(0,b.jsx)(d.CheckCircle,{className:"h-4 w-4 mr-1"}),"Approve All"]}),(0,b.jsxs)(p.Button,{size:"sm",variant:"destructive",onClick:()=>al(!0),disabled:ag,children:[(0,b.jsx)(e.XCircle,{className:"h-4 w-4 mr-1"}),"Reject All"]}),(0,b.jsx)(p.Button,{size:"sm",variant:"ghost",onClick:ap,disabled:ag,children:"Cancel"})]}),(0,b.jsx)(w.Dialog,{open:ak,onOpenChange:al,children:(0,b.jsxs)(w.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(w.DialogHeader,{children:[(0,b.jsxs)(w.DialogTitle,{children:["Reject ",ai.size," Documents"]}),(0,b.jsx)(w.DialogDescription,{children:"This will reject all selected documents with the same reason."})]}),(0,b.jsxs)("div",{className:"py-4",children:[(0,b.jsxs)(t.Label,{htmlFor:"bulk-rejection-reason",children:["Rejection Reason ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(u.Textarea,{id:"bulk-rejection-reason",placeholder:"Please explain why these documents are being rejected...",value:am,onChange:a=>an(a.target.value),rows:4,className:"mt-1"})]}),(0,b.jsxs)(w.DialogFooter,{children:[(0,b.jsx)(p.Button,{variant:"outline",onClick:()=>al(!1),disabled:ag,children:"Cancel"}),(0,b.jsx)(p.Button,{variant:"destructive",onClick:()=>aq("reject",am),disabled:ag||!am.trim(),children:ag?"Processing...":"Reject All"})]})]})})]})}a.s(["KYCReviewClient",()=>V],676379)}];

//# sourceMappingURL=c6ad4_src_app_%28staff%29_versotech_staff_kyc-review_kyc-review-client_tsx_3e8c15ac._.js.map