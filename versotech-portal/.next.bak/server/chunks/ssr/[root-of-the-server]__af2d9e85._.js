module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},9349,a=>{a.n(a.i(142710))},199585,a=>{a.n(a.i(701395))},929852,a=>{a.n(a.i(816404))},516153,a=>{a.n(a.i(422096))},911164,a=>{a.n(a.i(273021))},450926,a=>{a.n(a.i(933743))},718829,a=>{"use strict";var b=a.i(999684);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],718829)},441196,a=>{"use strict";let b=(0,a.i(718829).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],441196)},368965,a=>{"use strict";a.s(["VersoSignPageClient",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call VersoSignPageClient() from the server but VersoSignPageClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/app/(staff)/versotech/staff/versosign/versosign-page-client.tsx <module evaluation>","VersoSignPageClient")},457243,a=>{"use strict";a.s(["VersoSignPageClient",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call VersoSignPageClient() from the server but VersoSignPageClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/app/(staff)/versotech/staff/versosign/versosign-page-client.tsx","VersoSignPageClient")},180424,a=>{"use strict";a.i(368965);var b=a.i(457243);a.n(b)},901501,a=>{"use strict";a.s(["PlacementAgreementSigningSection",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call PlacementAgreementSigningSection() from the server but PlacementAgreementSigningSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/app/(main)/versotech_main/versosign/placement-agreement-signing-section.tsx <module evaluation>","PlacementAgreementSigningSection")},953825,a=>{"use strict";a.s(["PlacementAgreementSigningSection",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call PlacementAgreementSigningSection() from the server but PlacementAgreementSigningSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/app/(main)/versotech_main/versosign/placement-agreement-signing-section.tsx","PlacementAgreementSigningSection")},819076,a=>{"use strict";a.i(901501);var b=a.i(953825);a.n(b)},239848,a=>{"use strict";var b=a.i(714898),c=a.i(198307),d=a.i(180424),e=a.i(441196),f=a.i(819076),g=a.i(243085),h=a.i(621599);async function i(){let a=await (0,c.createClient)(),{data:{user:i},error:j}=await a.auth.getUser();if(!i||j)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(e.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Authentication Required"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Please log in to view VersoSign."})]})});let k=await (0,g.checkStaffAccess)(i.id),l=(0,c.createServiceClient)(),{data:m}=await l.rpc("get_user_personas",{p_user_id:i.id}),n=m?.some(a=>"lawyer"===a.persona_type)||!1,o=m?.some(a=>"introducer"===a.persona_type)||!1,p=m?.some(a=>"arranger"===a.persona_type)||!1,q=m?.some(a=>"partner"===a.persona_type)||!1,r=m?.some(a=>"commercial_partner"===a.persona_type)||!1,s=await (0,h.cookies)(),t=s.get("verso_active_persona_type")?.value,u=k&&("ceo"===t||"staff"===t||!t),v=p&&"arranger"===t,w=o&&"introducer"===t,x=r&&"commercial_partner"===t;if(q){let{data:a}=await l.from("partner_users").select("partner_id").eq("user_id",i.id);a?.map(a=>a.partner_id)}let y=[];if(p){let{data:a}=await l.from("arranger_users").select("arranger_id").eq("user_id",i.id);y=a?.map(a=>a.arranger_id)||[]}let z=[];if(o){let{data:a}=await l.from("introducer_users").select("introducer_id").eq("user_id",i.id);z=a?.map(a=>a.introducer_id)||[]}let A=[];if(r){let{data:a}=await l.from("commercial_partner_users").select("commercial_partner_id").eq("user_id",i.id);A=a?.map(a=>a.commercial_partner_id)||[]}let B=null,{data:C}=await l.from("ceo_users").select("user_id").eq("user_id",i.id).maybeSingle();if(C){let{data:a}=await l.from("ceo_entity").select("id").limit(1).single();B=a?.id||null}let D=[],E=new Set;if(k){let{data:a}=await l.from("placement_agreements").select(`
        id, status, default_commission_bps, pdf_url, created_at,
        ceo_signature_request_id, cp_signature_request_id,
        arranger_signature_request_id, arranger_id,
        commercial_partner:commercial_partner_id (id, legal_name, display_name, email)
      `).eq("status","approved").is("arranger_id",null).order("created_at",{ascending:!1});for(let b of a||[])E.has(b.id)||(D.push(b),E.add(b.id))}if(p&&y.length>0){let{data:a}=await l.from("placement_agreements").select(`
        id, status, default_commission_bps, pdf_url, created_at,
        ceo_signature_request_id, cp_signature_request_id,
        arranger_signature_request_id, arranger_id,
        commercial_partner:commercial_partner_id (id, legal_name, display_name, email)
      `).in("arranger_id",y).eq("status","approved").order("created_at",{ascending:!1});for(let b of a||[])E.has(b.id)||(D.push(b),E.add(b.id))}let F=[];if(m?.some(a=>"investor"===a.persona_type)){let{data:a}=await l.from("investor_users").select("investor_id").eq("user_id",i.id);F=a?.map(a=>a.investor_id)||[]}let G=[];if(n){let{data:a}=await l.from("lawyer_users").select("lawyer_id").eq("user_id",i.id);G=a?.map(a=>a.lawyer_id)||[]}let H=[],I=new Set,J=a=>{for(let b of a)I.has(b.id)||(H.push(b),I.add(b.id))};if(u){let a=l.from("tasks").select("*").in("kind",["countersignature","subscription_pack_signature","other"]).order("due_at",{ascending:!0,nullsFirst:!1});a=B?a.or(`owner_user_id.eq.${i.id},owner_ceo_entity_id.eq.${B}`):a.eq("owner_user_id",i.id);let{data:b}=await a;J(b||[])}if(n&&"lawyer"===t&&G.length>0){let{data:a}=await l.from("deal_lawyer_assignments").select("deal_id").in("lawyer_id",G),b=a?.map(a=>a.deal_id)||[];if(b.length>0){let{data:a}=await l.from("tasks").select("*").eq("kind","subscription_pack_signature").in("related_deal_id",b).order("due_at",{ascending:!0,nullsFirst:!1});J(a||[])}}if("investor"===t&&F.length>0){let{data:a}=await l.from("tasks").select("*").in("kind",["countersignature","subscription_pack_signature","other"]).or(`owner_user_id.eq.${i.id},owner_investor_id.in.(${F.join(",")})`).order("due_at",{ascending:!0,nullsFirst:!1});J(a||[])}if(w&&z.length>0){let{data:a}=await l.from("tasks").select("*").in("kind",["countersignature","subscription_pack_signature","other"]).or(`owner_user_id.eq.${i.id},owner_introducer_id.in.(${z.join(",")})`).order("due_at",{ascending:!0,nullsFirst:!1});J(a||[])}else if(w){let{data:a}=await l.from("tasks").select("*").in("kind",["countersignature","subscription_pack_signature","other"]).eq("owner_user_id",i.id).order("due_at",{ascending:!0,nullsFirst:!1});J(a||[])}if(v&&y.length>0){let{data:a}=await l.from("deals").select("id").in("arranger_entity_id",y),b=a?.map(a=>a.id)||[];if(b.length>0){let{data:a}=await l.from("tasks").select("*").in("kind",["countersignature","subscription_pack_signature"]).in("related_deal_id",b).is("owner_ceo_entity_id",null).order("due_at",{ascending:!0,nullsFirst:!1});J(a||[])}}if(x&&A.length>0){let{data:a}=await l.from("tasks").select("*").in("kind",["countersignature","subscription_pack_signature","other"]).or(`owner_user_id.eq.${i.id},owner_commercial_partner_id.in.(${A.join(",")})`).order("due_at",{ascending:!0,nullsFirst:!1});J(a||[])}else if(x){let{data:a}=await l.from("tasks").select("*").in("kind",["countersignature","subscription_pack_signature","other"]).eq("owner_user_id",i.id).order("due_at",{ascending:!0,nullsFirst:!1});J(a||[])}if(0===H.length&&!k&&!n&&0===F.length&&!p&&!r){let{data:a}=await l.from("tasks").select("*").in("kind",["countersignature","subscription_pack_signature","other"]).eq("owner_user_id",i.id).order("due_at",{ascending:!0,nullsFirst:!1});J(a||[])}if(H.length>0){let a=H.filter(a=>("pending"===a.status||"in_progress"===a.status)&&"signature_request"===a.related_entity_type&&a.related_entity_id);if(a.length>0){let b=a.map(a=>a.related_entity_id),{data:c}=await l.from("signature_requests").select("id").in("id",b).eq("status","expired"),d=new Set((c||[]).map(a=>a.id));H=H.map(a=>d.has(a.related_entity_id)&&("pending"===a.status||"in_progress"===a.status)?{...a,_expired:!0}:a)}}let K=[];if(k){let{data:a}=await l.from("signature_requests").select(`
        id, signer_name, signer_email, document_type,
        token_expires_at, created_at, investor_id,
        investor:investors(display_name, legal_name)
      `).eq("status","expired").order("token_expires_at",{ascending:!1}).limit(50);K=a||[]}let L=H&&H.length>0,M=D.length>0,N=k||n||o||p||q||r;if(!L&&!M&&!N)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(e.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No Signature Tasks"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"You don't have any pending signature tasks at this time."})]})});let O={high:0,medium:1,low:2},P=(H||[]).sort((a,b)=>{let c=O[a.priority]??99,d=O[b.priority]??99;return c!==d?c-d:a.due_at||b.due_at?a.due_at?b.due_at?new Date(a.due_at).getTime()-new Date(b.due_at).getTime():-1:1:0}),Q=P.filter(a=>!a._expired),R=P.filter(a=>a._expired),S=[{category:"countersignatures",title:"Pending Countersignatures",description:"Subscription agreements awaiting your countersignature",tasks:Q.filter(a=>"countersignature"===a.kind&&("pending"===a.status||"in_progress"===a.status))},{category:"follow_ups",title:"Manual Follow-ups Required",description:"Investors without platform accounts - manual intervention needed",tasks:Q.filter(a=>a.metadata?.issue==="investor_no_user_account"&&"pending"===a.status)},{category:"other",title:"Completed Signatures",description:"Recently completed signature tasks",tasks:P.filter(a=>("countersignature"===a.kind||"subscription_pack_signature"===a.kind)&&"completed"===a.status).slice(0,10)},{category:"expired",title:"Expired Signatures",description:"Signature requests that have expired - may need to be resent",tasks:R,expiredSignatures:K}],T={pending:Q.filter(a=>"pending"===a.status).length,in_progress:Q.filter(a=>"in_progress"===a.status).length,completed_today:P.filter(a=>"completed"===a.status&&a.completed_at&&new Date(a.completed_at).toDateString()===new Date().toDateString()).length,overdue:Q.filter(a=>"pending"===a.status&&a.due_at&&new Date(a.due_at)<new Date).length,expired:K.length+R.length};return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(k||p)&&D.length>0&&(0,b.jsx)(f.PlacementAgreementSigningSection,{agreements:D,isStaff:k,isArranger:p}),q&&!L&&!M&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-950/20 dark:to-teal-950/20 border border-emerald-200 dark:border-emerald-800 rounded-xl p-8 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-emerald-100 dark:bg-emerald-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)("svg",{className:"w-8 h-8 text-emerald-600 dark:text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-emerald-900 dark:text-emerald-100 mb-2",children:"All Caught Up!"}),(0,b.jsx)("p",{className:"text-emerald-700 dark:text-emerald-300 max-w-md mx-auto",children:"You don't have any pending signature tasks as a Partner. When your referred investors have documents requiring your signature, they'll appear here."})]}),(0,b.jsx)(d.VersoSignPageClient,{userId:i.id,signatureGroups:S,stats:T})]})}a.s(["default",()=>i,"dynamic",0,"force-dynamic"])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__af2d9e85._.js.map