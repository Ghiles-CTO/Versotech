module.exports=[91935,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(899750),e=a.i(284169),f=a.i(421908),g=a.i(15788),h=a.i(663475),i=a.i(249464),j=a.i(191675),k=a.i(951870),l=a.i(771088),m=a.i(470305),n=a.i(479612),o=a.i(405708),p=a.i(405398),q=a.i(134303),r=a.i(816854),s=a.i(478870),t=a.i(3321),u=a.i(877918),v=a.i(278541),w=a.i(799373),x=a.i(871057),y=a.i(823879),z=a.i(873785),A=a.i(441278),B=a.i(168118),C=a.i(672606),D=a.i(95799);let E=(0,D.default)("layout-list",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]),F=(0,D.default)("folder-kanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);var G=a.i(181608),H=a.i(58834);let I=[{value:"subscription",label:"Subscription Fee"},{value:"management",label:"Management Fee"},{value:"performance",label:"Performance Fee"},{value:"bd_fee",label:"Broker-Dealer Fee"},{value:"flat",label:"Flat Fee"},{value:"other",label:"Other"}],J=[{value:"upfront",label:"Upfront"},{value:"recurring",label:"Recurring"},{value:"on_demand",label:"On Demand"}];function K(){let[a,D]=(0,c.useState)([]),[K,L]=(0,c.useState)([]),[M,N]=(0,c.useState)(!0),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)("list"),[S,T]=(0,c.useState)(new Map),[U,V]=(0,c.useState)(new Set),[W,X]=(0,c.useState)(!1),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)(!1),[ac,ad]=(0,c.useState)(null),[ae,af]=(0,c.useState)(""),[ag,ah]=(0,c.useState)(""),[ai,aj]=(0,c.useState)("none"),[ak,al]=(0,c.useState)("none"),[am,an]=(0,c.useState)([]);(0,c.useEffect)(()=>{ao()},[]);let ao=async()=>{try{N(!0);let a=(0,H.createClient)(),b=await fetch("/api/arrangers/me/fee-plans?include_components=true&is_active=all");if(!b.ok)throw Error("Failed to fetch fee plans");let c=await b.json();D(c.data||[]);let{data:{user:d}}=await a.auth.getUser();if(!d)throw Error("Not authenticated");let{data:e}=await a.from("arranger_users").select("arranger_id").eq("user_id",d.id).single();if(e){let{data:b}=await a.from("deals").select("id").eq("arranger_entity_id",e.arranger_id);if(b&&b.length>0){let d=b.map(a=>a.id),{data:f}=await a.from("deal_memberships").select("referred_by_entity_id, referred_by_entity_type").in("deal_id",d).not("referred_by_entity_id","is",null),g=[...new Set((f||[]).filter(a=>"partner"===a.referred_by_entity_type).map(a=>a.referred_by_entity_id))],h=[...new Set((f||[]).filter(a=>"introducer"===a.referred_by_entity_type).map(a=>a.referred_by_entity_id))],i=[];if(g.length>0){let{data:b}=await a.from("partners").select("id, name").in("id",g);(b||[]).forEach(a=>{i.push({id:a.id,name:a.name,type:"partner"})})}if(h.length>0){let{data:b}=await a.from("introducers").select("id, legal_name").in("id",h);(b||[]).forEach(a=>{i.push({id:a.id,name:a.legal_name,type:"introducer"})})}let j=(f||[]).filter(a=>"commercial_partner"===a.referred_by_entity_type).map(a=>a.referred_by_entity_id),{data:k}=await a.from("placement_agreements").select("commercial_partner_id").eq("arranger_id",e.arranger_id),l=(k||[]).map(a=>a.commercial_partner_id).filter(Boolean),m=[...new Set([...j,...l])];if(m.length>0){let{data:b}=await a.from("commercial_partners").select("id, name, legal_name").in("id",m);(b||[]).forEach(a=>{i.push({id:a.id,name:a.name||a.legal_name||"Unknown CP",type:"commercial_partner"})})}L(i);let n=new Map,o=[...new Set((c.data||[]).filter(a=>a.deal_id).map(a=>a.deal_id))],p=new Map;if(o.length>0){let{data:b}=await a.from("deals").select("id, name, status").in("id",o);p=new Map((b||[]).map(a=>[a.id,a]))}for(let a of c.data||[]){let b=a.deal_id||"general",c=a.deal_id?p.get(a.deal_id)||{id:a.deal_id,name:"Unknown Deal"}:{id:"general",name:"General (No Deal)",status:"active"};n.has(b)||n.set(b,{deal:c,plans:[]}),n.get(b).plans.push(a)}T(n)}}P(null)}catch(a){console.error("[FeePlansPage] Error:",a),P(a instanceof Error?a.message:"Failed to load data")}finally{N(!1)}},ap=()=>{af(""),ah(""),aj("none"),al("none"),an([])},aq=()=>{ap(),_(null),X(!0)},ar=a=>{_(a),af(a.name),ah(a.description||""),a.partner_id?(aj("partner"),al(a.partner_id)):a.introducer_id?(aj("introducer"),al(a.introducer_id)):a.commercial_partner_id?(aj("commercial_partner"),al(a.commercial_partner_id)):(aj("none"),al("none")),an(a.components||[]),X(!0)},as=a=>{_(a),Z(!0)},at=(a,b)=>{let c=[...am];c[a]={...c[a],...b},an(c)},au=async()=>{if(!ae.trim())return void P("Plan name is required");if(0===am.length)return void P("At least one fee component is required");ab(!0),P(null);try{let a={name:ae.trim(),description:ag.trim()||void 0,components:am.map(a=>({...a,rate_bps:a.rate_bps?Number(a.rate_bps):void 0,flat_amount:a.flat_amount?Number(a.flat_amount):void 0}))};"partner"===ai&&"none"!==ak?a.partner_id=ak:"introducer"===ai&&"none"!==ak?a.introducer_id=ak:"commercial_partner"===ai&&"none"!==ak&&(a.commercial_partner_id=ak);let b=$?`/api/arrangers/me/fee-plans/${$.id}`:"/api/arrangers/me/fee-plans",c=await fetch(b,{method:$?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to save fee plan")}await ao(),X(!1),ap(),d.toast.success($?"Fee plan updated":"Fee plan created",{description:`"${ae}" has been saved successfully.`})}catch(a){console.error("[FeePlansPage] Save error:",a),P(a instanceof Error?a.message:"Failed to save fee plan")}finally{ab(!1)}},av=async()=>{if(!$)return;let a=$.name;try{if(!(await fetch(`/api/arrangers/me/fee-plans/${$.id}`,{method:"DELETE"})).ok)throw Error("Failed to delete fee plan");await ao(),Z(!1),_(null),d.toast.success("Fee plan deleted",{description:`"${a}" has been removed.`})}catch(a){console.error("[FeePlansPage] Delete error:",a),P(a instanceof Error?a.message:"Failed to delete fee plan")}},aw=async a=>{if(!a.partner_id&&!a.introducer_id&&!a.commercial_partner_id)return void d.toast.error("Cannot send fee plan",{description:"Please assign this fee plan to a partner, introducer, or commercial partner first."});ad(a.id),P(null);try{let b=await fetch(`/api/arrangers/me/fee-plans/${a.id}/send`,{method:"POST"});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to send fee plan")}let c=await b.json();await ao(),"no_users"===c.notification_status?d.toast.warning("Fee plan sent",{description:`"${a.name}" was marked as sent, but there are no users to notify.`}):"failed"===c.notification_status?d.toast.warning("Fee plan sent",{description:`"${a.name}" was sent, but notifications could not be delivered.`}):d.toast.success("Fee plan sent",{description:`"${a.name}" has been sent to ${c.notified_users} user(s).`})}catch(a){console.error("[FeePlansPage] Send error:",a),d.toast.error("Failed to send fee plan",{description:a instanceof Error?a.message:"An unexpected error occurred."})}finally{ad(null)}},ax=a=>{let b=new Set(U);b.has(a)?b.delete(a):b.add(a),V(b)},ay=a=>`${(a/100).toFixed(2)}%`,az=a=>{if(a.partner_id){let b=K.find(b=>b.id===a.partner_id&&"partner"===b.type);return b?.name||"Partner"}if(a.introducer_id){let b=K.find(b=>b.id===a.introducer_id&&"introducer"===b.type);return b?.name||"Introducer"}if(a.commercial_partner_id){let b=K.find(b=>b.id===a.commercial_partner_id&&"commercial_partner"===b.type);return b?.name||"Commercial Partner"}return"General"},aA=a=>a.partner_id?(0,b.jsx)(s.Users,{className:"h-4 w-4 text-blue-400"}):a.introducer_id?(0,b.jsx)(w.UserPlus,{className:"h-4 w-4 text-green-400"}):a.commercial_partner_id?(0,b.jsx)(x.Briefcase,{className:"h-4 w-4 text-purple-400"}):(0,b.jsx)(v.Building2,{className:"h-4 w-4 text-gray-400"});return M?(0,b.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,b.jsx)(t.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,b.jsx)("span",{className:"ml-3 text-muted-foreground",children:"Loading fee plans..."})]}):(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Fee Plans"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Create and manage fee structures for your network partners"})]}),(0,b.jsxs)(f.Button,{onClick:aq,className:"gap-2",children:[(0,b.jsx)(o.Plus,{className:"h-4 w-4"}),"Create Fee Plan"]})]}),O&&(0,b.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 text-red-400 text-sm p-4 rounded flex items-center gap-2",children:[(0,b.jsx)(u.AlertCircle,{className:"h-4 w-4"}),O]}),(0,b.jsx)(e.Card,{className:"bg-blue-500/10 border-blue-500/30",children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,b.jsx)("strong",{className:"text-blue-400",children:"How Fee Plans Work:"})," Create fee structures for your partners, introducers, and commercial partners. These plans define the fee components that will apply to subscriptions they refer. You can assign different fee structures to different entities based on your agreements."]})})}),(0,b.jsxs)(G.Tabs,{value:Q,onValueChange:a=>R(a),children:[(0,b.jsxs)(G.TabsList,{className:"mb-4",children:[(0,b.jsxs)(G.TabsTrigger,{value:"list",className:"gap-2",children:[(0,b.jsx)(E,{className:"h-4 w-4"}),"List View"]}),(0,b.jsxs)(G.TabsTrigger,{value:"by-opportunity",className:"gap-2",children:[(0,b.jsx)(F,{className:"h-4 w-4"}),"By Opportunity"]})]}),(0,b.jsx)(G.TabsContent,{value:"list",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Your Fee Plans"}),(0,b.jsxs)(e.CardDescription,{children:[a.length," fee plan",1!==a.length?"s":""," created"]})]}),(0,b.jsx)(e.CardContent,{children:0===a.length?(0,b.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,b.jsx)(r.FileText,{className:"h-10 w-10 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No fee plans created yet"}),(0,b.jsxs)(f.Button,{onClick:aq,variant:"outline",size:"sm",children:[(0,b.jsx)(o.Plus,{className:"h-4 w-4 mr-1"}),"Create Your First Fee Plan"]})]}):(0,b.jsx)("div",{className:"rounded-md border overflow-x-auto",children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{children:"Plan Name"}),(0,b.jsx)(l.TableHead,{children:"Assigned To"}),(0,b.jsx)(l.TableHead,{children:"Fee Components"}),(0,b.jsx)(l.TableHead,{children:"Status"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(l.TableBody,{children:a.map(a=>(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),a.description&&(0,b.jsx)("div",{className:"text-sm text-muted-foreground truncate max-w-[200px]",children:a.description})]})]})}),(0,b.jsx)(l.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[aA(a),(0,b.jsx)("span",{children:az(a)})]})}),(0,b.jsx)(l.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.components?.slice(0,3).map((a,c)=>(0,b.jsxs)(g.Badge,{variant:"outline",className:"text-xs",children:[a.kind,": ",a.rate_bps?ay(a.rate_bps):a.flat_amount?`$${a.flat_amount}`:"N/A"]},c)),(a.components?.length||0)>3&&(0,b.jsxs)(g.Badge,{variant:"outline",className:"text-xs",children:["+",(a.components?.length||0)-3," more"]})]})}),(0,b.jsx)(l.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.is_active?(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-green-500/10 text-green-500 border-green-500",children:"Active"}):(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-gray-500/10 text-gray-500 border-gray-500",children:"Inactive"}),"sent"===a.status&&(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-blue-500/10 text-blue-500 border-blue-500",children:"Sent"})]})}),(0,b.jsx)(l.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex gap-1 justify-end",children:[(a.partner_id||a.introducer_id||a.commercial_partner_id)&&"sent"!==a.status&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>aw(a),disabled:ac===a.id,title:"Send to entity","aria-label":`Send fee plan "${a.name}" to entity`,children:ac===a.id?(0,b.jsx)(t.Loader2,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}):(0,b.jsx)(z.Send,{className:"h-4 w-4 text-blue-500","aria-hidden":"true"})}),"sent"===a.status&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",disabled:!0,title:"Already sent","aria-label":"Fee plan already sent",children:(0,b.jsx)(A.CheckCircle,{className:"h-4 w-4 text-green-500","aria-hidden":"true"})}),"sent"!==a.status&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>ar(a),"aria-label":`Edit fee plan "${a.name}"`,children:(0,b.jsx)(p.Edit,{className:"h-4 w-4","aria-hidden":"true"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>as(a),"aria-label":`Delete fee plan "${a.name}"`,children:(0,b.jsx)(q.Trash2,{className:"h-4 w-4 text-red-500","aria-hidden":"true"})})]})})]},a.id))})]})})})]})}),(0,b.jsx)(G.TabsContent,{value:"by-opportunity",children:(0,b.jsx)(()=>(0,b.jsxs)("div",{className:"space-y-4",children:[Array.from(S.entries()).map(([a,{deal:c,plans:d}])=>(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"cursor-pointer hover:bg-muted/50 transition-colors py-4",onClick:()=>ax(a),onKeyDown:b=>{("Enter"===b.key||" "===b.key)&&(b.preventDefault(),ax(a))},tabIndex:0,role:"button","aria-expanded":U.has(a),"aria-label":`${c.name} - ${d.length} fee plan${1!==d.length?"s":""}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[U.has(a)?(0,b.jsx)(B.ChevronDown,{className:"h-5 w-5","aria-hidden":"true"}):(0,b.jsx)(C.ChevronRight,{className:"h-5 w-5","aria-hidden":"true"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{className:"text-lg",children:c.name}),(0,b.jsxs)(e.CardDescription,{children:[d.length," fee plan",1!==d.length?"s":"",c.status&&` â€¢ ${c.status}`]})]})]}),(0,b.jsx)(g.Badge,{variant:"outline",children:d.length})]})}),U.has(a)&&(0,b.jsx)(e.CardContent,{className:"pt-0",children:(0,b.jsx)("div",{className:"space-y-3",children:d.map(a=>(0,b.jsxs)("div",{className:"border rounded-lg p-4 bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium",children:a.name}),"sent"===a.status&&(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-blue-500/10 text-blue-500 text-xs",children:"Sent"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[aA(a),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:az(a)})]})]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:a.components?.map((a,c)=>(0,b.jsxs)(g.Badge,{variant:"secondary",className:"text-xs",children:[a.kind,": ",a.rate_bps?ay(a.rate_bps):a.flat_amount?`$${a.flat_amount}`:"N/A"]},c))}),(0,b.jsxs)("div",{className:"flex gap-2 mt-3 pt-3 border-t",children:[(a.partner_id||a.introducer_id||a.commercial_partner_id)&&"sent"!==a.status&&(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:b=>{b.stopPropagation(),aw(a)},disabled:ac===a.id,children:[ac===a.id?(0,b.jsx)(t.Loader2,{className:"h-3 w-3 mr-1 animate-spin"}):(0,b.jsx)(z.Send,{className:"h-3 w-3 mr-1"}),"Send"]}),"sent"!==a.status&&(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:b=>{b.stopPropagation(),ar(a)},children:[(0,b.jsx)(p.Edit,{className:"h-3 w-3 mr-1"})," Edit"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:b=>{b.stopPropagation(),as(a)},children:[(0,b.jsx)(q.Trash2,{className:"h-3 w-3 mr-1 text-red-500"})," Delete"]})]})]},a.id))})})]},a)),0===S.size&&(0,b.jsxs)("div",{className:"border border-dashed rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,b.jsx)(F,{className:"h-10 w-10 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No fee plans to display by opportunity"})]})]}),{})})]}),(0,b.jsx)(m.Dialog,{open:W,onOpenChange:X,children:(0,b.jsxs)(m.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{children:$?"Edit Fee Plan":"Create Fee Plan"}),(0,b.jsx)(m.DialogDescription,{children:"Define the fee structure for your network partners"})]}),O&&(0,b.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 text-red-400 text-sm p-3 rounded flex items-center gap-2",children:[(0,b.jsx)(u.AlertCircle,{className:"h-4 w-4 flex-shrink-0"}),O]}),(0,b.jsxs)("div",{className:"space-y-6 py-4",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"name",children:"Plan Name *"}),(0,b.jsx)(h.Input,{id:"name",value:ae,onChange:a=>af(a.target.value),placeholder:"e.g., Standard Partner Fee"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(j.Textarea,{id:"description",value:ag,onChange:a=>ah(a.target.value),placeholder:"Optional description",rows:2})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Entity Type"}),(0,b.jsxs)(k.Select,{value:ai,onValueChange:a=>{aj(a),al("none")},children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"none",children:"General (No specific entity)"}),(0,b.jsx)(k.SelectItem,{value:"partner",children:"Partner"}),(0,b.jsx)(k.SelectItem,{value:"introducer",children:"Introducer"}),(0,b.jsx)(k.SelectItem,{value:"commercial_partner",children:"Commercial Partner"})]})]})]}),"none"!==ai&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(i.Label,{children:["Select ","partner"===ai?"Partner":"introducer"===ai?"Introducer":"Commercial Partner"]}),(0,b.jsxs)(k.Select,{value:ak,onValueChange:al,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select..."})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"none",children:"None"}),K.filter(a=>a.type===ai).map(a=>(0,b.jsx)(k.SelectItem,{value:a.id,children:a.name},a.id))]})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(i.Label,{children:["Fee Components (",am.length,")"]}),(0,b.jsxs)(f.Button,{onClick:()=>{an([...am,{kind:"management",calc_method:"percent_per_annum",frequency:"quarterly",payment_schedule:"recurring"}])},size:"sm",variant:"outline",children:[(0,b.jsx)(o.Plus,{className:"h-4 w-4 mr-1"}),"Add Component"]})]}),0===am.length?(0,b.jsx)("div",{className:"border border-dashed rounded-lg py-8 text-center text-muted-foreground",children:'Click "Add Component" to define fee components'}):(0,b.jsx)("div",{className:"space-y-4",children:am.map((a,c)=>(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"py-3 flex flex-row items-center justify-between",children:[(0,b.jsxs)(e.CardTitle,{className:"text-sm",children:["Component ",c+1]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>{an(am.filter((a,b)=>b!==c))},children:(0,b.jsx)(y.X,{className:"h-4 w-4"})})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Fee Type"}),(0,b.jsxs)(k.Select,{value:a.kind,onValueChange:a=>at(c,{kind:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsx)(k.SelectContent,{children:I.map(a=>(0,b.jsx)(k.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Payment Schedule"}),(0,b.jsxs)(k.Select,{value:a.payment_schedule||"recurring",onValueChange:a=>at(c,{payment_schedule:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsx)(k.SelectContent,{children:J.map(a=>(0,b.jsx)(k.SelectItem,{value:a.value,children:a.label},a.value))})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Rate (basis points)"}),(0,b.jsx)(h.Input,{type:"number",value:a.rate_bps||"",onChange:a=>at(c,{rate_bps:a.target.value?Number(a.target.value):void 0}),placeholder:"e.g., 200 = 2%"}),a.rate_bps&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["= ",(a.rate_bps/100).toFixed(2),"%"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Flat Amount ($)"}),(0,b.jsx)(h.Input,{type:"number",value:a.flat_amount||"",onChange:a=>at(c,{flat_amount:a.target.value?Number(a.target.value):void 0}),placeholder:"e.g., 5000"})]})]})]})]},c))})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>X(!1),disabled:aa,children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:au,disabled:aa,children:aa?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):$?"Update Plan":"Create Plan"})]})]})}),(0,b.jsx)(n.AlertDialog,{open:Y,onOpenChange:Z,children:(0,b.jsxs)(n.AlertDialogContent,{children:[(0,b.jsxs)(n.AlertDialogHeader,{children:[(0,b.jsx)(n.AlertDialogTitle,{children:"Delete Fee Plan?"}),(0,b.jsxs)(n.AlertDialogDescription,{children:['Are you sure you want to delete "',$?.name,'"? This will deactivate the fee plan and hide it from the list. Existing subscriptions using this plan will not be affected.']})]}),(0,b.jsxs)(n.AlertDialogFooter,{children:[(0,b.jsx)(n.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(n.AlertDialogAction,{onClick:av,className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})})]})}a.s(["default",()=>K],91935)}];

//# sourceMappingURL=versotech-portal_src_app_%28main%29_versotech_main_fee-plans_page_tsx_44ed8348._.js.map