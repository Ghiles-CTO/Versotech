module.exports=[770392,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(289633),e=a.i(714814),f=a.i(284169),g=a.i(421908),h=a.i(15788),i=a.i(211374),j=a.i(181608),k=a.i(470305),l=a.i(240004),m=a.i(663475),n=a.i(249464),o=a.i(888987),p=a.i(696661),q=a.i(95799);let r=(0,q.default)("skip-forward",[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]]);var s=a.i(910187);let t=[{number:1,name:"Received",key:"received",optional:!0},{number:2,name:"Viewed",key:"viewed",optional:!1},{number:3,name:"Interest",key:"interest_confirmed",optional:!0},{number:4,name:"NDA",key:"nda_signed",optional:!0},{number:5,name:"Data Room",key:"data_room_access",optional:!0},{number:6,name:"Pack Gen",key:"pack_generated",optional:!1},{number:7,name:"Pack Sent",key:"pack_sent",optional:!1},{number:8,name:"Signed",key:"signed",optional:!1},{number:9,name:"Funded",key:"funded",optional:!1},{number:10,name:"Active",key:"active",optional:!1}];function u({stages:a,summary:c,currentStage:d=0,className:e,compact:f=!1}){let g=c||(a?{received:a.find(a=>1===a.stage_number)?.completed_at||null,viewed:a.find(a=>2===a.stage_number)?.completed_at||null,interest_confirmed:a.find(a=>3===a.stage_number)?.completed_at||null,nda_signed:a.find(a=>4===a.stage_number)?.completed_at||null,data_room_access:a.find(a=>5===a.stage_number)?.completed_at||null,pack_generated:a.find(a=>6===a.stage_number)?.completed_at||null,pack_sent:a.find(a=>7===a.stage_number)?.completed_at||null,signed:a.find(a=>8===a.stage_number)?.completed_at||null,funded:a.find(a=>9===a.stage_number)?.completed_at||null,active:a.find(a=>10===a.stage_number)?.completed_at||null}:{received:null,viewed:null,interest_confirmed:null,nda_signed:null,data_room_access:null,pack_generated:null,pack_sent:null,signed:null,funded:null,active:null}),h=d||(g.active?10:g.funded?9:g.signed?8:g.pack_sent?7:g.pack_generated?6:g.data_room_access?5:g.nda_signed?4:g.interest_confirmed?3:g.viewed?2:+!!g.received);return(0,b.jsx)(s.TooltipProvider,{children:(0,b.jsxs)("div",{className:(0,o.cn)("w-full",e),children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute top-4 left-0 right-0 h-0.5 bg-border"}),(0,b.jsx)("div",{className:"absolute top-4 left-0 h-0.5 bg-emerald-500 transition-all duration-500",style:{width:`${100*Math.max(0,(h-1)/9)}%`}}),(0,b.jsx)("div",{className:"relative flex justify-between",children:t.map(a=>{let c=function(a,b,c){return b[a.key]?"completed":a.number===c?"current":null!==b.pack_generated&&null===b.interest_confirmed&&(3===a.number||5===a.number)&&(c>a.number||b.pack_generated)||a.optional&&a.number<c?"skipped":"pending"}(a,g,h),d=g[a.key];return(0,b.jsxs)(s.Tooltip,{children:[(0,b.jsx)(s.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[(0,b.jsx)("div",{className:(0,o.cn)("w-8 h-8 rounded-full flex items-center justify-center transition-all","completed"===c&&"bg-emerald-500 text-white","current"===c&&"bg-blue-500 text-white ring-4 ring-blue-200 dark:ring-blue-900","skipped"===c&&"bg-muted text-muted-foreground","pending"===c&&"bg-muted/50 text-muted-foreground"),children:"completed"===c?(0,b.jsx)(p.Check,{className:"w-4 h-4"}):"skipped"===c?(0,b.jsx)(r,{className:"w-3 h-3"}):(0,b.jsx)("span",{className:"text-xs font-medium",children:a.number})}),!f&&(0,b.jsx)("span",{className:(0,o.cn)("mt-2 text-xs font-medium text-center max-w-[60px] leading-tight","completed"===c&&"text-emerald-600 dark:text-emerald-400","current"===c&&"text-blue-600 dark:text-blue-400","skipped"===c&&"text-muted-foreground","pending"===c&&"text-muted-foreground"),children:a.name})]})}),(0,b.jsx)(s.TooltipContent,{side:"bottom",className:"max-w-[200px]",children:(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),"completed"===c&&d&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Completed: ",d?new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""]}),"current"===c&&(0,b.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"In Progress"}),"skipped"===c&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Skipped (optional)"}),"pending"===c&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Pending"}),a.optional&&(0,b.jsx)("div",{className:"text-xs text-amber-600 dark:text-amber-400 mt-1",children:"Optional stage"})]})})]},a.number)})})]}),!f&&(0,b.jsx)("div",{className:"mt-4 text-center",children:(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[0===h&&"Not started",1===h&&"Opportunity received",2===h&&"Viewed opportunity",3===h&&"Interest confirmed",4===h&&"NDA signed",5===h&&"Data room access granted",6===h&&"Subscription pack generated",7===h&&"Subscription pack sent for signing",8===h&&"Subscription signed",9===h&&"Investment funded",10===h&&"Investment active"]})})]})})}var v=a.i(926076),w=a.i(899750),x=a.i(168118),y=a.i(672606),z=a.i(425622),A=a.i(618287),B=a.i(478291),C=a.i(816854),D=a.i(324647);let E=(0,q.default)("file-image",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),F=(0,q.default)("file-play",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M15.033 13.44a.647.647 0 0 1 0 1.12l-4.065 2.352a.645.645 0 0 1-.968-.56v-4.704a.645.645 0 0 1 .967-.56z",key:"1tzo1f"}]]),G=(0,q.default)("presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);var H=a.i(905219),I=a.i(941766),J=a.i(84818),K=a.i(686331),L=a.i(264890),M=a.i(3321);function N({document:a,dealId:d,hasAccess:e}){var f,h;let[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),m=(f=a.file_type).includes("pdf")?C.FileText:f.includes("spreadsheet")||f.includes("excel")||f.includes("csv")?D.FileSpreadsheet:f.includes("image")?E:f.includes("video")?F:f.includes("presentation")||f.includes("powerpoint")?G:f.includes("word")||f.includes("document")?C.FileText:B.File,n=!!a.external_link,o=(h=a.file_type).includes("pdf")||h.includes("image")||h.includes("text")||h.includes("video"),p=(0,c.useCallback)(async b=>{if(n&&a.external_link)return void window.open(a.external_link,"_blank","noopener,noreferrer");let c="preview"===b;c?l(!0):j(!0);try{let e=await fetch(`/api/deals/${d}/documents/${a.id}/download?mode=${b}`);if(!e.ok){let a=await e.json().catch(()=>({}));401===e.status?w.toast.error("Please sign in to access documents"):403===e.status?w.toast.error(a.error||"Access denied to this document"):404===e.status?w.toast.error("Document not found"):w.toast.error(a.error||"Failed to access document");return}let f=await e.json(),g=f.download_url||f.url;if(!g)return void w.toast.error("Failed to generate document link");window.open(g,"_blank","noopener,noreferrer"),f.watermark?w.toast.success(c?"Document opened for preview":"Download started",{description:`Link expires in ${Math.floor(f.expires_in_seconds/60)} minutes`,duration:4e3}):w.toast.success(c?"Document opened":"Download started")}catch(a){console.error("Document action error:",a),w.toast.error("Failed to access document. Please try again.")}finally{j(!1),l(!1)}},[d,a.id,a.external_link,n]);return(0,b.jsxs)("div",{className:"flex items-center justify-between py-3 px-4 hover:bg-muted rounded-lg transition-colors group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-muted text-muted-foreground",children:(0,b.jsx)(m,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-foreground truncate",children:a.file_name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:function(a){if(0===a)return"—";let b=Math.floor(Math.log(a)/Math.log(1024));return`${(a/Math.pow(1024,b)).toFixed(+(b>0))} ${["B","KB","MB","GB"][b]}`}(a.file_size)}),(0,b.jsx)("span",{children:"•"}),(0,b.jsx)("span",{children:new Date(a.uploaded_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),a.description&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:"•"}),(0,b.jsx)("span",{className:"truncate max-w-[200px]",children:a.description})]})]})]})]}),e&&(0,b.jsx)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:n?(0,b.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:()=>p("preview"),children:[(0,b.jsx)(A.ExternalLink,{className:"h-4 w-4 mr-1"}),"Open"]}):(0,b.jsxs)(b.Fragment,{children:[o&&(0,b.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:()=>p("preview"),disabled:k,className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:[k?(0,b.jsx)(M.Loader2,{className:"h-4 w-4 mr-1 animate-spin"}):(0,b.jsx)(L.Eye,{className:"h-4 w-4 mr-1"}),"Preview"]}),(0,b.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:()=>p("download"),disabled:i,children:[i?(0,b.jsx)(M.Loader2,{className:"h-4 w-4 mr-1 animate-spin"}):(0,b.jsx)(z.Download,{className:"h-4 w-4 mr-1"}),"Download"]})]})})]})}function O({folderName:a,documents:d,dealId:e,hasAccess:f,defaultOpen:g=!1}){let[i,j]=(0,c.useState)(g);return(0,b.jsxs)(v.Collapsible,{open:i,onOpenChange:j,children:[(0,b.jsx)(v.CollapsibleTrigger,{className:"w-full",children:(0,b.jsxs)("div",{className:"flex items-center justify-between py-3 px-4 hover:bg-muted rounded-lg transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/30 text-blue-600",children:i?(0,b.jsx)(I.FolderOpen,{className:"h-5 w-5"}):(0,b.jsx)(H.Folder,{className:"h-5 w-5"})}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:a}),(0,b.jsxs)(h.Badge,{variant:"secondary",className:"ml-2",children:[d.length," ",1===d.length?"file":"files"]})]}),i?(0,b.jsx)(x.ChevronDown,{className:"h-5 w-5 text-muted-foreground"}):(0,b.jsx)(y.ChevronRight,{className:"h-5 w-5 text-muted-foreground"})]})}),(0,b.jsx)(v.CollapsibleContent,{children:(0,b.jsx)("div",{className:"ml-6 pl-4 border-l-2 border-border space-y-1",children:d.map(a=>(0,b.jsx)(N,{document:a,dealId:e,hasAccess:f},a.id))})})]})}function P({documents:a,hasAccess:d,requiresNda:e,dealId:h,onRequestAccess:i}){let{featured:j,folders:k}=(0,c.useMemo)(()=>{let b=[],c={};a.forEach(a=>{a.is_featured&&b.push(a);let d=a.category||"General";c[d]||(c[d]=[]),c[d].push(a)});let d={};return Object.keys(c).sort((a,b)=>"General"===a?1:"General"===b?-1:a.localeCompare(b)).forEach(a=>{d[a]=c[a]}),{featured:b,folders:d}},[a]);return d?0===a.length?(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"py-8 text-center",children:[(0,b.jsx)(H.Folder,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No Documents Available"}),(0,b.jsx)("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Documents for this deal haven't been uploaded yet. Check back soon."})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[j.length>0&&(0,b.jsxs)(f.Card,{className:"border-amber-200 bg-amber-50/50 dark:bg-amber-900/10",children:[(0,b.jsxs)(f.CardHeader,{className:"pb-2",children:[(0,b.jsxs)(f.CardTitle,{className:"text-base flex items-center gap-2 text-amber-700 dark:text-amber-300",children:[(0,b.jsx)(J.Star,{className:"h-5 w-5 fill-amber-400 text-amber-400"}),"Featured Documents"]}),(0,b.jsx)(f.CardDescription,{className:"text-amber-600/80 dark:text-amber-400/80",children:"Key documents highlighted by the deal team"})]}),(0,b.jsx)(f.CardContent,{className:"pt-0 space-y-1",children:j.map(a=>(0,b.jsx)(N,{document:a,dealId:h,hasAccess:d},a.id))})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{className:"pb-2",children:[(0,b.jsxs)(f.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(L.Eye,{className:"h-5 w-5 text-blue-500"}),"Data Room"]}),(0,b.jsxs)(f.CardDescription,{children:[a.length," document",1!==a.length?"s":""," across ",Object.keys(k).length," folder",1!==Object.keys(k).length?"s":""]})]}),(0,b.jsx)(f.CardContent,{className:"pt-0 space-y-1",children:Object.entries(k).map(([a,c],e)=>(0,b.jsx)(O,{folderName:a,documents:c,dealId:h,hasAccess:d,defaultOpen:0===e},a))})]})]}):(0,b.jsx)(f.Card,{className:"border-amber-200 bg-amber-50 dark:bg-amber-900/20",children:(0,b.jsxs)(f.CardContent,{className:"py-8 text-center",children:[(0,b.jsx)(K.Lock,{className:"h-12 w-12 mx-auto text-amber-500 mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-amber-800 dark:text-amber-200 mb-2",children:"Data Room Access Required"}),(0,b.jsx)("p",{className:"text-amber-700 dark:text-amber-300 mb-4 max-w-md mx-auto",children:e?"Sign the NDA to unlock access to the full data room with deal documents, financials, and more.":"Express interest in this deal to unlock access to the data room."}),i&&(0,b.jsx)(g.Button,{onClick:i,className:"bg-amber-600 hover:bg-amber-700",children:e?"Sign NDA to Unlock":"Request Access"})]})})}var Q=a.i(724070),R=a.i(42329),S=a.i(399580),T=a.i(591808),U=a.i(838086);function V(a){return a?new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"TBD"}function W(a){if(!a)return"future";let b=new Date(a),c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate()),e=new Date(b.getFullYear(),b.getMonth(),b.getDate());return e<d?"past":e.getTime()===d.getTime()?"current":"future"}function X({status:a}){return"past"===a?(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center",children:(0,b.jsx)(S.CheckCircle2,{className:"w-5 h-5 text-emerald-600"})}):"current"===a?(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center ring-2 ring-blue-500 ring-offset-2",children:(0,b.jsx)(T.Circle,{className:"w-5 h-5 text-blue-600 fill-blue-600"})}):(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center",children:(0,b.jsx)(T.Circle,{className:"w-5 h-5 text-muted-foreground"})})}function Y({status:a}){return(0,b.jsx)("div",{className:(0,o.cn)("flex-1 h-1 rounded-full mx-2","past"===a&&"bg-emerald-400","current"===a&&"bg-gradient-to-r from-emerald-400 to-gray-300","future"===a&&"bg-muted")})}function Z({openAt:a,closeAt:c,interestDeadline:d,settlementDate:e}){let g=[{label:"Deal Open",date:a,status:W(a)},...d?[{label:"Interest Deadline",date:d,status:W(d)}]:[],{label:"Deal Close",date:c,status:W(c)},...e?[{label:"Settlement",date:e,status:W(e)}]:[]],i=function(a){if(!a)return null;let b=new Date(a),c=new Date;return Math.ceil((b.getTime()-c.getTime())/864e5)}(c),j=null!==i&&i>0&&i<=7,k=null!==i&&i<=0;return(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(f.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(Q.Calendar,{className:"h-5 w-5 text-blue-500"}),"Deal Timeline"]}),null!==i&&!k&&(0,b.jsxs)(h.Badge,{variant:j?"destructive":"secondary",className:"flex items-center gap-1",children:[j&&(0,b.jsx)(U.AlertTriangle,{className:"w-3 h-3"}),(0,b.jsx)(R.Clock,{className:"w-3 h-3"}),i," day",1!==i?"s":""," remaining"]}),k&&(0,b.jsx)(h.Badge,{variant:"secondary",className:"bg-muted",children:"Closed"})]})}),(0,b.jsxs)(f.CardContent,{children:[(0,b.jsx)("div",{className:"hidden sm:block",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:g.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center flex-1",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[(0,b.jsx)(X,{status:a.status}),(0,b.jsxs)("div",{className:"mt-2 text-center",children:[(0,b.jsx)("p",{className:(0,o.cn)("text-xs font-medium","past"===a.status&&"text-emerald-600","current"===a.status&&"text-blue-600","future"===a.status&&"text-muted-foreground"),children:a.label}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:V(a.date)})]})]}),c<g.length-1&&(0,b.jsx)(Y,{status:"past"===a.status&&g[c+1]?.status==="past"?"past":"past"===a.status&&g[c+1]?.status!=="past"?"current":"future"})]},a.label))})}),(0,b.jsx)("div",{className:"sm:hidden space-y-4",children:g.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[(0,b.jsx)(X,{status:a.status}),c<g.length-1&&(0,b.jsx)("div",{className:(0,o.cn)("w-0.5 h-8 mt-2","past"===a.status?"bg-emerald-400":"bg-muted")})]}),(0,b.jsxs)("div",{className:"pt-1",children:[(0,b.jsx)("p",{className:(0,o.cn)("text-sm font-medium","past"===a.status&&"text-emerald-600","current"===a.status&&"text-blue-600","future"===a.status&&"text-muted-foreground"),children:a.label}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:V(a.date)})]})]},a.label))})]})]})}var $=a.i(871057),_=a.i(155508),aa=a.i(707556),ab=a.i(318525),ac=a.i(806640),ad=a.i(278541),ae=a.i(966494),af=a.i(376515),ag=a.i(587143);function ah({item:a}){var c;let d=a.icon,e=(c=a.value)?c.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-";return(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,b.jsx)("div",{className:"p-2 rounded-md bg-card shadow-sm",children:(0,b.jsx)(d,{className:"w-4 h-4 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.label}),a.isBadge&&a.value?(0,b.jsx)(h.Badge,{variant:a.badgeVariant||"secondary",className:(0,o.cn)("mt-0.5",a.badgeColor),children:e}):(0,b.jsx)("p",{className:"text-sm font-medium truncate",children:e})]})]})}function ai({dealType:a,currency:c,stockType:d,sector:e,location:g,vehicleName:h,stage:i,round:j}){let k=[{label:"Deal Type",value:a,icon:$.Briefcase,isBadge:!0,badgeColor:"bg-blue-100 text-blue-700 hover:bg-blue-100"},{label:"Stock Type",value:d,icon:aa.Tag,isBadge:!0,badgeColor:"bg-purple-100 text-purple-700 hover:bg-purple-100"},{label:"Currency",value:c,icon:_.DollarSign},{label:"Sector",value:e,icon:ab.Globe},{label:"Location",value:g,icon:ac.MapPin},{label:"Vehicle",value:h,icon:ad.Building2},{label:"Stage",value:i,icon:ae.TrendingUp},{label:"Round",value:j,icon:af.Target}].filter(a=>a.value||"Deal Type"===a.label||"Currency"===a.label);return(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-3",children:(0,b.jsxs)(f.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(ag.Info,{className:"h-5 w-5 text-muted-foreground"}),"Key Details"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:k.map(a=>(0,b.jsx)(ah,{item:a},a.label))})})]})}var aj=a.i(778541),ak=a.i(980137),al=a.i(203297),am=a.i(873785),an=a.i(366511),ao=a.i(50828);let ap={0:{label:"New",description:"Choose to request a subscription or explore the data room first",icon:a.i(674875).Sparkles,color:"text-muted-foreground",bgColor:"bg-muted"},1:{label:"Received",description:"Deal dispatched to you",icon:am.Send,color:"text-blue-600",bgColor:"bg-blue-100 dark:bg-blue-900/30"},2:{label:"Viewed",description:"You have viewed this deal",icon:R.Clock,color:"text-blue-600",bgColor:"bg-blue-100 dark:bg-blue-900/30"},3:{label:"Interest Confirmed",description:"Next: Sign NDA to access documents",icon:ak.Heart,color:"text-pink-600",bgColor:"bg-pink-100 dark:bg-pink-900/30"},4:{label:"NDA Signed",description:"Access data room documents",icon:al.FileSignature,color:"text-indigo-600",bgColor:"bg-indigo-100 dark:bg-indigo-900/30"},5:{label:"Data Room Access",description:"Review documents before subscribing",icon:I.FolderOpen,color:"text-amber-600",bgColor:"bg-amber-100 dark:bg-amber-900/30"},6:{label:"Pack Generated",description:"Subscription documents prepared",icon:S.CheckCircle2,color:"text-cyan-600",bgColor:"bg-cyan-100 dark:bg-cyan-900/30"},7:{label:"Pack Sent",description:"Awaiting your signature",icon:am.Send,color:"text-violet-600",bgColor:"bg-violet-100 dark:bg-violet-900/30"},8:{label:"Signed",description:"Awaiting funding",icon:al.FileSignature,color:"text-purple-600",bgColor:"bg-purple-100 dark:bg-purple-900/30"},9:{label:"Funded",description:"Awaiting activation",icon:_.DollarSign,color:"text-emerald-600",bgColor:"bg-emerald-100 dark:bg-emerald-900/30"},10:{label:"Active",description:"Investment is active",icon:an.Rocket,color:"text-green-600",bgColor:"bg-green-100 dark:bg-green-900/30"}};function aq({currentStage:a,membership:c,subscription:d,canExpressInterest:e,canSignNda:i,canSubscribe:j,isTrackingOnly:k,onExpressInterest:l,onSignNda:m,onSubscribe:n}){let p=ap[a]||ap[0],q=p.icon,r=function(a,b){for(let d of[{action:"Investment activated",timestamp:b?.funded_at&&"active"===b.status?b.funded_at:null},{action:"Funded",timestamp:b?.funded_at??null},{action:"Subscription signed",timestamp:b?.signed_at??null},{action:"Pack sent",timestamp:b?.pack_sent_at??null},{action:"Data room access granted",timestamp:a?.data_room_granted_at??null},{action:"NDA signed",timestamp:a?.nda_signed_at??null},{action:"Interest confirmed",timestamp:a?.interest_confirmed_at??null}])if(d.timestamp){var c;return{action:d.action,timestamp:(c=d.timestamp)?new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}}return null}(c,d),s=a/10*100,t=a<=2&&!d,u=j&&!k,v=e&&!k,w=t&&(u||v),x=!k&&i?{label:"Sign NDA",onClick:m,icon:al.FileSignature}:!k&&j?{label:"Subscribe Now",onClick:n,icon:an.Rocket}:null;return(0,b.jsxs)(f.Card,{className:"border-2 border-dashed border-border bg-gradient-to-br from-background to-muted",children:[(0,b.jsx)(f.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(f.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(ak.Heart,{className:"h-5 w-5 text-pink-500"}),"Your Interest Status"]}),(0,b.jsxs)(h.Badge,{className:(0,o.cn)(p.bgColor,p.color,"border-0"),children:["Stage ",a,"/10"]})]})}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:(0,o.cn)("p-3 rounded-xl",p.bgColor),children:(0,b.jsx)(q,{className:(0,o.cn)("w-6 h-6",p.color)})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:(0,o.cn)("font-semibold text-lg",p.color),children:p.label}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:p.description})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:"Journey Progress"}),(0,b.jsxs)("span",{children:[a,"/10 stages"]})]}),(0,b.jsx)(aj.Progress,{value:s,className:"h-2"})]}),k&&(0,b.jsxs)("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-3 text-amber-900 dark:border-amber-900/40 dark:bg-amber-900/20 dark:text-amber-200",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Tracking Only Access"}),(0,b.jsx)("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:"You can view this deal, but investment actions are disabled. Contact your relationship manager for investor access."})]}),r&&(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-muted text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(R.Clock,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"font-medium",children:r.action})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1 ml-6",children:r.timestamp})]}),w&&(0,b.jsxs)("div",{className:"space-y-4",children:[u&&(0,b.jsx)("button",{onClick:n,className:"w-full p-4 rounded-lg border-2 border-emerald-200 dark:border-emerald-800 bg-emerald-50 dark:bg-emerald-900/20 hover:border-emerald-400 dark:hover:border-emerald-600 transition-colors text-left group",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-emerald-600 text-white",children:(0,b.jsx)(an.Rocket,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"font-semibold text-emerald-700 dark:text-emerald-300 flex items-center gap-2",children:["Subscribe to Investment",(0,b.jsx)(ao.ArrowRight,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]}),(0,b.jsx)("div",{className:"text-sm text-emerald-600 dark:text-emerald-400 mt-0.5",children:"Direct path • NDA + Subscription Pack"})]})]})}),u&&v&&(0,b.jsxs)("div",{className:"relative flex items-center",children:[(0,b.jsx)("div",{className:"flex-1 h-px bg-border"}),(0,b.jsx)("span",{className:"px-3 text-xs text-muted-foreground font-medium bg-background",children:"OR"}),(0,b.jsx)("div",{className:"flex-1 h-px bg-border"})]}),v&&(0,b.jsx)("button",{onClick:l,className:"w-full p-4 rounded-lg border border-dashed border-border hover:border-amber-400 transition-colors text-left group",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-600",children:(0,b.jsx)(ak.Heart,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium text-foreground flex items-center gap-2",children:"Request Data Room Access"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-0.5",children:"Review documents before committing"})]})]})})]}),!t&&x&&(0,b.jsxs)(g.Button,{onClick:x.onClick,className:"w-full",size:"lg",children:[(0,b.jsx)(x.icon,{className:"w-4 h-4 mr-2"}),x.label,(0,b.jsx)(ao.ArrowRight,{className:"w-4 h-4 ml-2"})]}),10===a&&(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 text-center",children:[(0,b.jsx)(S.CheckCircle2,{className:"w-8 h-8 mx-auto text-emerald-600 mb-2"}),(0,b.jsx)("p",{className:"font-medium text-emerald-700 dark:text-emerald-300",children:"Investment Active"}),(0,b.jsx)("p",{className:"text-sm text-emerald-600 dark:text-emerald-400",children:"View in your Portfolio for NAV tracking"})]})]})]})}var ar=a.i(191675),as=a.i(57104),at=a.i(90516),au=a.i(142015);function av(a,b="USD"){return a?new Intl.NumberFormat("en-US",{style:"currency",currency:b,minimumFractionDigits:0,maximumFractionDigits:0}).format(a):"-"}function aw({icon:a,iconColor:d,label:e,doc:f}){let[h,i]=(0,c.useState)(!1),j=f.signatories.filter(a=>"signed"===a.status).length,k=f.signatories.length,l="complete"===f.status,m=f.signed_url||f.unsigned_url;return(0,b.jsxs)("div",{children:[(0,b.jsxs)("button",{type:"button",className:(0,o.cn)("w-full flex items-center gap-2.5 py-2 px-2.5 rounded-md text-left transition-colors",k>0&&"hover:bg-muted/50 cursor-pointer",h&&"bg-muted/30"),onClick:()=>k>0&&i(!h),disabled:0===k,children:[(0,b.jsx)(a,{className:(0,o.cn)("w-4 h-4 shrink-0",d)}),(0,b.jsx)("span",{className:"text-sm font-medium flex-1",children:e}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[k>0&&(0,b.jsxs)("span",{className:(0,o.cn)("text-xs tabular-nums",l?"text-emerald-600":"text-muted-foreground"),children:[j,"/",k]}),l?(0,b.jsx)(S.CheckCircle2,{className:"w-3.5 h-3.5 text-emerald-500"}):(0,b.jsx)(R.Clock,{className:"w-3.5 h-3.5 text-amber-500"}),k>0&&(0,b.jsx)(x.ChevronDown,{className:(0,o.cn)("w-3 h-3 text-muted-foreground transition-transform",h&&"rotate-180")})]})]}),h&&(0,b.jsxs)("div",{className:"ml-6 mr-2 mt-1 mb-1.5 space-y-1",children:[f.signatories.map((a,c)=>{var d;return(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs py-0.5 px-2 rounded bg-muted/40",children:[(0,b.jsx)("span",{className:"text-muted-foreground truncate max-w-[120px]",children:a.name}),"signed"===a.status?(0,b.jsxs)("span",{className:"text-emerald-600 flex items-center gap-1",children:[(0,b.jsx)(S.CheckCircle2,{className:"w-2.5 h-2.5"}),a.signed_at?(d=a.signed_at)?new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"":"Done"]}):(0,b.jsx)("span",{className:"text-amber-500 text-[10px]",children:"Pending"})]},c)}),m&&(0,b.jsxs)(g.Button,{size:"sm",variant:"ghost",className:"h-5 text-[10px] px-2 mt-0.5",onClick:a=>{a.stopPropagation(),window.open(f.signed_url||f.unsigned_url,"_blank")},children:[f.signed_url?(0,b.jsx)(z.Download,{className:"w-2.5 h-2.5 mr-1"}):(0,b.jsx)(A.ExternalLink,{className:"w-2.5 h-2.5 mr-1"}),f.signed_url?"Download":"View"]})]})]})}function ax({subscription:a,dealCurrency:d,dealId:e,dealName:i}){let j=function(a){switch(a){case"active":return{label:"Active",color:"text-emerald-600",bg:"bg-emerald-100 dark:bg-emerald-900/30",icon:an.Rocket};case"committed":return{label:"Committed",color:"text-blue-600",bg:"bg-blue-100 dark:bg-blue-900/30",icon:S.CheckCircle2};case"funded":return{label:"Funded",color:"text-purple-600",bg:"bg-purple-100 dark:bg-purple-900/30",icon:_.DollarSign};default:return{label:"Pending",color:"text-amber-600",bg:"bg-amber-100 dark:bg-amber-900/30",icon:R.Clock}}}(a.status),l=j.icon,n=a.currency||d||"USD",p=a.documents,[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(i?`Subscription pack clarification - ${i}`:"Subscription pack clarification"),[u,v]=(0,c.useState)(""),[x,y]=(0,c.useState)(!1),A=[{key:"generated",done:!!a.pack_generated_at},{key:"sent",done:!!a.pack_sent_at},{key:"signed",done:!!a.signed_at},{key:"funded",done:!!a.funded_at},{key:"active",done:!!a.activated_at}],B=A.filter(a=>a.done).length,D=B/A.length*100;return(0,b.jsxs)(f.Card,{className:"border-2 border-dashed border-gray-200 dark:border-gray-800 bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-gray-950",children:[(0,b.jsx)(f.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(f.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(at.Banknote,{className:"h-5 w-5 text-emerald-500"}),"Your Subscription"]}),(0,b.jsxs)(h.Badge,{className:(0,o.cn)(j.bg,j.color,"border-0"),children:[(0,b.jsx)(l,{className:"w-3 h-3 mr-1"}),j.label]})]})}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:(0,o.cn)("p-2.5 rounded-xl",j.bg),children:(0,b.jsx)(_.DollarSign,{className:(0,o.cn)("w-5 h-5",j.color)})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-xl font-bold tracking-tight",children:av(a.commitment,n)}),null!==a.funded_amount&&a.funded_amount>0&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Funded: ",av(a.funded_amount,n)]})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:"Progress"}),(0,b.jsxs)("span",{children:[B,"/",A.length]})]}),(0,b.jsx)(aj.Progress,{value:D,className:"h-1.5"})]}),p&&(0,b.jsxs)("div",{className:"rounded-lg border divide-y bg-card/50",children:[(0,b.jsx)(aw,{icon:al.FileSignature,iconColor:"text-blue-500",label:"NDA",doc:p.nda}),(0,b.jsx)(aw,{icon:C.FileText,iconColor:"text-purple-500",label:"Subscription Pack",doc:p.subscription_pack}),(p.certificate||a.is_active)&&(0,b.jsxs)("div",{className:"flex items-center gap-2.5 py-2 px-2.5",children:[(0,b.jsx)(as.Award,{className:(0,o.cn)("w-4 h-4",p.certificate?.status==="available"?"text-amber-500":"text-muted-foreground")}),(0,b.jsx)("span",{className:"text-sm font-medium flex-1",children:"Certificate"}),p.certificate?.status==="available"?(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(S.CheckCircle2,{className:"w-3.5 h-3.5 text-emerald-500"}),p.certificate.url&&(0,b.jsx)(g.Button,{size:"sm",variant:"ghost",className:"h-5 px-1.5",onClick:()=>window.open(p.certificate.url,"_blank"),children:(0,b.jsx)(z.Download,{className:"w-3 h-3"})})]}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Pending"})]})]}),(0,b.jsx)("div",{className:"pt-1",children:(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",className:"w-full",onClick:()=>r(!0),disabled:!e,children:[(0,b.jsx)(au.MessageSquare,{className:"w-4 h-4 mr-2"}),"Request Clarification"]})}),a.is_active&&(0,b.jsxs)("div",{className:"flex items-center gap-2.5 p-2.5 rounded-lg bg-emerald-50 dark:bg-emerald-900/20",children:[(0,b.jsx)(an.Rocket,{className:"w-4 h-4 text-emerald-600"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-emerald-700 dark:text-emerald-300",children:"Investment Active"}),(0,b.jsx)("div",{className:"text-xs text-emerald-600 dark:text-emerald-400",children:"Track in Portfolio"})]})]}),!p&&(0,b.jsxs)("div",{className:"flex items-center gap-2.5 p-3 rounded-lg bg-muted/30 text-muted-foreground",children:[(0,b.jsx)(C.FileText,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-sm",children:"Documents being prepared..."})]})]}),(0,b.jsx)(k.Dialog,{open:q,onOpenChange:r,children:(0,b.jsxs)(k.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Request Clarification"}),(0,b.jsx)(k.DialogDescription,{children:"Submit questions or clarification requests about the subscription pack."})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Subject"}),(0,b.jsx)(m.Input,{value:s,onChange:a=>t(a.target.value),placeholder:"Subscription pack clarification"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Details"}),(0,b.jsx)(ar.Textarea,{value:u,onChange:a=>v(a.target.value),placeholder:"Share the exact sections or questions you need clarified...",rows:5})]})]}),(0,b.jsxs)(k.DialogFooter,{children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>r(!1),disabled:x,children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:async()=>{if(e){if(!s.trim())return void w.toast.error("Please enter a subject for your clarification request.");if(!u.trim())return void w.toast.error("Please include details for your clarification request.");try{y(!0);let a=await fetch("/api/requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:"communication",subject:s.trim(),details:u.trim(),dealId:e})});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to submit clarification")}w.toast.success("Clarification request submitted."),v(""),r(!1)}catch(a){console.error("[SubscriptionStatusCard] Clarification error:",a),w.toast.error(a instanceof Error?a.message:"Failed to submit clarification")}finally{y(!1)}}},disabled:x,children:x?"Submitting...":"Submit"})]})]})})]})}var ay=a.i(975965),az=a.i(877918),aA=a.i(478870),aB=a.i(118234),aC=a.i(518173),aD=a.i(520783),aE=a.i(995382);function aF(a,b="USD"){return a?new Intl.NumberFormat("en-US",{style:"currency",currency:b,minimumFractionDigits:0,maximumFractionDigits:0}).format(a):"-"}function aG(a){return a?new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}function aH(){let a=(0,d.useParams)(),o=(0,d.useRouter)(),p=(0,d.useSearchParams)(),q=a.id,r=p.get("action"),s=p.get("from"),{hasAnyPersona:t,isLoading:v,activePersona:w,error:x}=(0,aD.usePersona)(),[y,z]=(0,c.useState)(null),[B,C]=(0,c.useState)(!0),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),[H,J]=(0,c.useState)(!1),[M,N]=(0,c.useState)(!1),[O,Q]=(0,c.useState)(""),[T,U]=(0,c.useState)(!1),V=w?.persona_type==="partner",[W,X]=(0,c.useState)(!1),[Y,$]=(0,c.useState)(!1),[_,af]=(0,c.useState)(null),[ag,ah]=(0,c.useState)(null),[aj,ak]=(0,c.useState)(null),{isProxyMode:am,selectedClient:an}=(0,aE.useProxyMode)();(0,c.useEffect)(()=>{let a=new AbortController,b=!1;async function c(){try{console.log(`[OpportunityDetail] Starting fetch for dealId: ${q}`),fetch(`/api/investors/me/opportunities/${q}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"view"}),cache:"no-store"}).catch(()=>{});let c=Date.now(),d=am&&an?.id?`&client_investor_id=${an.id}`:"",e=await fetch(`/api/investors/me/opportunities/${q}?_t=${c}${d}`,{cache:"no-store",signal:a.signal,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});if(b)return void console.log(`[OpportunityDetail] Fetch for ${q} was cancelled (user navigated away)`);let f=await e.json();if(!e.ok)throw Error(f.error||`Failed to fetch opportunity (${e.status})`);if(b)return void console.log(`[OpportunityDetail] Ignoring response for ${q} - request was cancelled`);console.log(`[OpportunityDetail] ✅ Setting state for: "${f.opportunity?.name}" (ID: ${f.opportunity?.id})`),f.opportunity?.id!==q&&console.error(`[OpportunityDetail] ⚠️ MISMATCH! URL has ${q} but API returned ${f.opportunity?.id}`),z(f.opportunity);let g=f.opportunity.is_tracking_only||V&&!f.opportunity.membership?.role;"subscribe"===r&&f.opportunity.can_subscribe&&!g&&N(!0)}catch(a){if("AbortError"===a.name)return void console.log(`[OpportunityDetail] Fetch aborted for ${q}`);b||(console.error("Error fetching opportunity:",a),E("Failed to load opportunity details"))}finally{b||C(!1)}}return z(null),E(null),C(!0),t&&q&&c(),()=>{console.log(`[OpportunityDetail] Cleanup: Cancelling fetch for ${q}`),b=!0,a.abort()}},[t,q,r,V,am,an?.id]);let ao=async()=>{try{U(!0);let a=await fetch(`/api/deals/${q}/interests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!a.ok){let b=await a.json().catch(()=>({}));throw Error(b.error||"Failed to submit interest")}let b=am&&an?.id?`?client_investor_id=${an.id}`:"",c=await fetch(`/api/investors/me/opportunities/${q}${b}`),d=await c.json();z(d.opportunity),G(!1)}catch(a){console.error("Error expressing interest:",a)}finally{U(!1)}},ap=async()=>{if(O&&y)try{let a;if(U(!0),!(a=am&&an?.id?await fetch("/api/commercial-partners/proxy-subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deal_id:q,client_investor_id:an.id,commitment:parseFloat(O),stock_type:y.stock_type||"common",notes:"Submitted in proxy mode by commercial partner"})}):await fetch(`/api/deals/${q}/subscriptions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:{amount:parseFloat(O),currency:y.currency,bank_confirmation:!1},subscription_type:"personal"})})).ok){let b=await a.json();throw Error(b.error||"Failed to submit subscription")}await a.json();let b=am&&an?.id?`?client_investor_id=${an.id}`:"",c=await fetch(`/api/investors/me/opportunities/${q}${b}`),d=await c.json();z(d.opportunity),N(!1),Q(""),alert("Subscription submitted for review. The VERSO team will follow up shortly.")}catch(a){console.error("Error subscribing:",a),alert(a.message||"Failed to submit subscription")}finally{U(!1)}};if(v)return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)(i.Skeleton,{className:"h-8 w-48"}),(0,b.jsx)(i.Skeleton,{className:"h-24 w-full"}),(0,b.jsx)(i.Skeleton,{className:"h-64 w-full"})]});if(!t)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)(f.Card,{className:"max-w-lg mx-auto",children:(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Access Required"}),(0,b.jsx)(f.CardDescription,{children:"You need to be associated with an entity to view this opportunity."})]})})});if(B)return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)(i.Skeleton,{className:"h-8 w-48"}),(0,b.jsx)(i.Skeleton,{className:"h-24 w-full"}),(0,b.jsx)(i.Skeleton,{className:"h-64 w-full"})]});if(D||!y)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)(f.Card,{className:"max-w-lg mx-auto",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Error"}),(0,b.jsx)(f.CardDescription,{children:D||"Opportunity not found"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(g.Button,{onClick:()=>o.push("introductions"===s?"/versotech_main/introductions":"/versotech_main/opportunities"),children:[(0,b.jsx)(ay.ArrowLeft,{className:"w-4 h-4 mr-2"}),"introductions"===s?"Back to Introductions":"Back to Opportunities"]})})]})});let ar=!!y.is_tracking_only||V&&!y.membership?.role,as=y.can_subscribe&&!ar,at=y.can_express_interest&&!ar,av=y.can_sign_nda&&!ar,aw="closed"!==y.status&&!y.subscription&&(as||at);return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>{"introductions"===s?o.push("/versotech_main/introductions"):o.back()},children:[(0,b.jsx)(ay.ArrowLeft,{className:"w-4 h-4 mr-2"}),"introductions"===s?"Back to Introductions":"Back"]}),ar?(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-2",children:(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Tracking Access"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"flex items-start gap-3 text-sm text-muted-foreground",children:[(0,b.jsx)(az.AlertCircle,{className:"h-4 w-4 mt-0.5"}),(0,b.jsx)("span",{children:"This deal is available for tracking only. Contact your relationship manager for investor access."})]})})]}):(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-2",children:(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Investment Journey"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)(u,{summary:y.journey.summary,currentStage:y.journey.current_stage})})]}),(0,b.jsx)(Z,{openAt:y.open_at,closeAt:y.close_at}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[y.company_logo_url?(0,b.jsx)(e.default,{src:y.company_logo_url,alt:y.company_name||y.name,width:80,height:80,className:"rounded-xl object-cover"}):(0,b.jsx)("div",{className:"w-20 h-20 rounded-xl bg-gray-100 dark:bg-gray-800 flex items-center justify-center",children:(0,b.jsx)(ad.Building2,{className:"w-10 h-10 text-gray-400"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:y.name}),y.company_name&&(0,b.jsx)("p",{className:"text-muted-foreground",children:y.company_name}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2",children:[y.sector&&(0,b.jsxs)(h.Badge,{variant:"secondary",children:[(0,b.jsx)(ae.TrendingUp,{className:"w-3 h-3 mr-1"}),y.sector]}),y.stage&&(0,b.jsx)(h.Badge,{variant:"outline",children:y.stage}),y.location&&(0,b.jsxs)(h.Badge,{variant:"outline",children:[(0,b.jsx)(ac.MapPin,{className:"w-3 h-3 mr-1"}),y.location]}),y.stock_type&&(0,b.jsxs)(h.Badge,{variant:"outline",className:"border-purple-300 text-purple-700 dark:text-purple-300",children:[(0,b.jsx)(aa.Tag,{className:"w-3 h-3 mr-1"}),y.stock_type.replace(/_/g," ")]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 min-w-[280px]",children:[aw&&(0,b.jsxs)("div",{className:"space-y-3",children:[as&&(0,b.jsx)("div",{className:"relative",children:(0,b.jsx)(g.Button,{className:"w-full bg-emerald-600 hover:bg-emerald-700 h-auto py-3",onClick:()=>N(!0),children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(ae.TrendingUp,{className:"w-5 h-5"}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Subscribe to Investment"}),(0,b.jsx)("div",{className:"text-xs opacity-90 font-normal",children:"Submit for review • NDA + Subscription"})]})]})})}),as&&at&&(0,b.jsxs)("div",{className:"relative flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex-1 h-px bg-gray-200 dark:bg-gray-700"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground font-medium px-2",children:"OR"}),(0,b.jsx)("div",{className:"flex-1 h-px bg-gray-200 dark:bg-gray-700"})]}),at&&y.access_controls?.can_view_data_room!==!1&&(0,b.jsx)(g.Button,{variant:"outline",className:"w-full h-auto py-3 border-dashed",onClick:()=>G(!0),children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(I.FolderOpen,{className:"w-5 h-5 text-amber-600"}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"font-medium",children:"Request Data Room Access"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground font-normal",children:"Review documents first"})]})]})})]}),av&&(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>J(!0),children:[(0,b.jsx)(al.FileSignature,{className:"w-4 h-4 mr-2"}),"About NDA Signing"]}),y.subscription&&!y.subscription.is_active&&(0,b.jsxs)(h.Badge,{className:"justify-center py-2",variant:"outline",children:[(0,b.jsx)(R.Clock,{className:"w-4 h-4 mr-2"}),y.subscription.is_funded?"Awaiting Activation":y.subscription.is_signed?"Awaiting Funding":"Awaiting Signature"]}),y.subscription?.is_active&&(0,b.jsxs)(h.Badge,{className:"justify-center py-2 bg-emerald-500 text-white",children:[(0,b.jsx)(S.CheckCircle2,{className:"w-4 h-4 mr-2"}),"Active Investment"]}),(0,b.jsxs)(g.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>o.push(`/versotech_main/inbox?deal=${y.id}&deal_name=${encodeURIComponent(y.name)}`),children:[(0,b.jsx)(au.MessageSquare,{className:"w-4 h-4 mr-2"}),"Ask a Question"]})]})]}),(0,b.jsxs)(j.Tabs,{defaultValue:"overview",className:"space-y-4",children:[(0,b.jsxs)(j.TabsList,{children:[(0,b.jsx)(j.TabsTrigger,{value:"overview",children:"Overview"}),y.access_controls?.can_view_data_room!==!1&&(0,b.jsxs)(j.TabsTrigger,{value:"data-room",className:"relative",children:["Data Room",!y.data_room.has_access&&(0,b.jsx)(K.Lock,{className:"w-3 h-3 ml-1"})]}),(0,b.jsx)(j.TabsTrigger,{value:"faqs",children:"FAQs"})]}),(0,b.jsxs)(j.TabsContent,{value:"overview",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[y.subscription?(0,b.jsx)(ax,{subscription:y.subscription,dealCurrency:y.currency,dealId:y.id,dealName:y.name}):y.subscription_submission?(0,b.jsxs)(f.Card,{className:"border-2 border-dashed border-amber-200 bg-amber-50",children:[(0,b.jsx)(f.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(f.CardTitle,{className:"text-base flex items-center gap-2 text-amber-900",children:[(0,b.jsx)(R.Clock,{className:"h-5 w-5 text-amber-600"}),"Subscription Under Review"]}),(0,b.jsx)(h.Badge,{className:"bg-amber-200 text-amber-900 border-0",children:"Pending Review"})]})}),(0,b.jsx)(f.CardContent,{className:"text-sm text-amber-800",children:y.subscription_submission.submitted_at?`Submitted on ${aG(y.subscription_submission.submitted_at)}.`:"Submitted and awaiting CEO approval."})]}):(0,b.jsx)(aq,{currentStage:y.journey.current_stage,membership:y.membership,subscription:null,canExpressInterest:at,canSignNda:av,canSubscribe:as,isTrackingOnly:ar,onExpressInterest:()=>G(!0),onSignNda:()=>J(!0),onSubscribe:()=>N(!0)}),(0,b.jsx)("div",{className:"lg:col-span-2",children:(0,b.jsx)(ai,{dealType:y.deal_type||"N/A",currency:y.currency,stockType:y.stock_type,sector:y.sector,location:y.location,vehicleName:y.vehicle?.name||null,stage:y.stage,round:y.deal_round})})]}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Investment Details"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Target Raise"}),(0,b.jsx)("p",{className:"font-medium",children:aF(y.target_amount,y.currency)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Raised"}),(0,b.jsx)("p",{className:"font-medium",children:aF(y.raised_amount,y.currency)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Min Investment"}),(0,b.jsx)("p",{className:"font-medium",children:aF(y.minimum_investment,y.currency)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Max Investment"}),(0,b.jsx)("p",{className:"font-medium",children:aF(y.maximum_investment,y.currency)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Closing Date"}),(0,b.jsx)("p",{className:"font-medium",children:aG(y.close_at)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Deal Type"}),(0,b.jsx)("p",{className:"font-medium",children:y.deal_type||"-"})]})]})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Company Information"})}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[y.description&&(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Description"}),(0,b.jsx)("p",{className:"mt-1",children:y.description})]}),y.investment_thesis&&(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Investment Thesis"}),(0,b.jsx)("p",{className:"mt-1",children:y.investment_thesis})]}),y.company_website&&(0,b.jsxs)("div",{children:[(0,b.jsx)(n.Label,{className:"text-muted-foreground",children:"Website"}),(0,b.jsxs)("a",{href:y.company_website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-blue-600 hover:underline mt-1",children:[(0,b.jsx)(ab.Globe,{className:"w-4 h-4"}),y.company_website,(0,b.jsx)(A.ExternalLink,{className:"w-3 h-3"})]})]})]})]})]}),y.access_controls?.can_view_term_sheet!==!1&&y.fee_structures.length>0&&(()=>{let a=y.fee_structures.find(a=>"published"===a.status)||y.fee_structures[0];if(!a)return null;let c=async()=>{if(!a.term_sheet_attachment_key)return;let b=a.term_sheet_attachment_key.split("/").pop()||"Term Sheet.pdf";ak({id:a.id,file_name:b,name:b,mime_type:"application/pdf",type:"term_sheet"}),X(!0),$(!0),ah(null),af(null);try{let b=await fetch(`/api/deals/${y.id}/fee-structures/${a.id}/attachment`),c=await b.json();if(!b.ok)throw Error(c.error||"Failed to load preview");af(c.url)}catch(a){console.error("Error loading term sheet preview:",a),ah(a instanceof Error?a.message:"Failed to load preview")}finally{$(!1)}},d=a.transaction_type||a.structure||a.issuer||a.vehicle||a.exclusive_arranger||a.purchaser||a.seller||a.legal_counsel,e=a.interest_confirmation_deadline||a.validity_date||a.completion_date||a.completion_date_text,h=null!==a.subscription_fee_percent||null!==a.management_fee_percent||null!==a.carried_interest_percent;return(0,b.jsxs)(f.Card,{className:"border-2",children:[(0,b.jsx)(f.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(f.CardTitle,{className:"text-xl",children:"Term Sheet"}),(a.term_sheet_date||a.version)&&(0,b.jsxs)(f.CardDescription,{className:"text-sm",children:[a.term_sheet_date&&aG(a.term_sheet_date),a.term_sheet_date&&a.version&&" • ",a.version&&`Version ${a.version}`]})]}),a.term_sheet_attachment_key&&(0,b.jsxs)(g.Button,{onClick:c,size:"sm",className:"gap-2",children:[(0,b.jsx)(L.Eye,{className:"w-4 h-4"}),"Preview PDF"]})]})}),(0,b.jsxs)(f.CardContent,{className:"space-y-8",children:[a.price_per_share_text&&(0,b.jsxs)("div",{className:"text-center py-6 px-4 rounded-xl bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-950/50 dark:to-teal-950/50 border border-emerald-200 dark:border-emerald-800",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-emerald-600 dark:text-emerald-400 mb-1",children:"Price Per Share"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-emerald-700 dark:text-emerald-300",children:a.price_per_share_text})]}),(a.term_sheet_html||a.opportunity_summary)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-3",children:"Opportunity Summary"}),(0,b.jsx)("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:a.term_sheet_html?(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:a.term_sheet_html}}):(0,b.jsx)("p",{className:"whitespace-pre-wrap text-foreground/80",children:a.opportunity_summary})})]}),(a.allocation_up_to||a.minimum_ticket)&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[a.allocation_up_to&&(0,b.jsxs)("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[(0,b.jsxs)("div",{className:"text-xs text-muted-foreground mb-1",children:["Allocation (",y.currency,")"]}),(0,b.jsx)("div",{className:"text-lg font-semibold",children:aF(a.allocation_up_to,y.currency)})]}),a.minimum_ticket&&(0,b.jsxs)("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Min. Ticket"}),(0,b.jsx)("div",{className:"text-lg font-semibold",children:aF(a.minimum_ticket,y.currency)})]})]}),h&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-3",children:"Fee Structure"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[null!==a.subscription_fee_percent&&(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-card",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Subscription Fee"}),(0,b.jsxs)("div",{className:"text-2xl font-bold mt-1",children:[a.subscription_fee_percent,"%"]})]}),null!==a.management_fee_percent&&(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-card",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Management Fee"}),(0,b.jsxs)("div",{className:"text-2xl font-bold mt-1",children:[a.management_fee_percent,"%"]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"per annum"}),a.management_fee_clause&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2 border-t pt-2",children:a.management_fee_clause})]}),null!==a.carried_interest_percent&&(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-card",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Carried Interest"}),(0,b.jsxs)("div",{className:"text-2xl font-bold mt-1",children:[a.carried_interest_percent,"%"]}),a.performance_fee_clause&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2 border-t pt-2",children:a.performance_fee_clause})]})]})]}),d&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-3",children:"Transaction Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4",children:[a.transaction_type&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Type"}),(0,b.jsx)("div",{className:"font-medium",children:a.transaction_type})]}),a.structure&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Structure"}),(0,b.jsx)("div",{className:"font-medium",children:a.structure})]}),a.issuer&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Issuer"}),(0,b.jsx)("div",{className:"font-medium",children:a.issuer})]}),a.vehicle&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Vehicle"}),(0,b.jsx)("div",{className:"font-medium",children:a.vehicle})]}),a.exclusive_arranger&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Arranger"}),(0,b.jsx)("div",{className:"font-medium",children:a.exclusive_arranger})]}),a.purchaser&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Purchaser"}),(0,b.jsx)("div",{className:"font-medium",children:a.purchaser})]}),a.seller&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Seller"}),(0,b.jsx)("div",{className:"font-medium",children:a.seller})]}),a.legal_counsel&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Legal Counsel"}),(0,b.jsx)("div",{className:"font-medium",children:a.legal_counsel})]})]})]}),e&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-3",children:"Timeline"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[a.interest_confirmation_deadline&&(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800",children:[(0,b.jsx)("div",{className:"text-xs font-medium text-amber-600 dark:text-amber-400",children:"Interest Deadline"}),(0,b.jsx)("div",{className:"font-semibold text-amber-700 dark:text-amber-300 mt-1",children:aG(a.interest_confirmation_deadline)})]}),a.validity_date&&(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-muted/50",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Valid Until"}),(0,b.jsx)("div",{className:"font-medium mt-1",children:aG(a.validity_date)})]}),(a.completion_date||a.completion_date_text)&&(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-muted/50",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Completion"}),(0,b.jsx)("div",{className:"font-medium mt-1",children:a.completion_date?aG(a.completion_date):a.completion_date_text})]})]})]})]})]})})(),y.signatories.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(aA.Users,{className:"w-5 h-5"}),"Authorized Signatories"]}),(0,b.jsx)(f.CardDescription,{children:"These signatories will need to sign the NDA and subscription documents"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:y.signatories.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:(0,b.jsx)(aA.Users,{className:"w-5 h-5 text-gray-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.full_name}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.email})]})]},a.id))})})]})]}),y.access_controls?.can_view_data_room!==!1&&(0,b.jsxs)(j.TabsContent,{value:"data-room",className:"space-y-4",children:[y.data_room.has_access&&y.data_room.access_details&&(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(S.CheckCircle2,{className:"w-4 h-4 text-emerald-500"}),"Access granted: ",aG(y.data_room.access_details.granted_at),y.access_controls?.has_auto_data_room_access&&(0,b.jsx)("span",{className:"ml-2 text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full",children:"Auto-granted (Arranger)"})]}),y.data_room.access_details.expires_at&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-amber-600",children:[(0,b.jsx)(R.Clock,{className:"w-4 h-4"}),"Expires: ",aG(y.data_room.access_details.expires_at)]})]})})}),(0,b.jsx)(P,{documents:y.data_room.documents,hasAccess:y.data_room.has_access,requiresNda:y.data_room.requires_nda,dealId:y.id,onRequestAccess:y.can_sign_nda?()=>J(!0):void 0})]}),(0,b.jsx)(j.TabsContent,{value:"faqs",className:"space-y-4",children:0===y.faqs.length?(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(aB.HelpCircle,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No FAQs Available"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Frequently asked questions will be added by the deal team."})]})}):(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Frequently Asked Questions"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)(l.Accordion,{type:"single",collapsible:!0,className:"w-full",children:y.faqs.map((a,c)=>(0,b.jsxs)(l.AccordionItem,{value:`faq-${c}`,children:[(0,b.jsx)(l.AccordionTrigger,{children:a.question}),(0,b.jsx)(l.AccordionContent,{children:a.answer})]},a.id))})})]})})]}),(0,b.jsx)(k.Dialog,{open:F,onOpenChange:G,children:(0,b.jsxs)(k.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-amber-100 dark:bg-amber-900/30",children:(0,b.jsx)(I.FolderOpen,{className:"h-5 w-5 text-amber-600"})}),(0,b.jsx)(k.DialogTitle,{className:"text-lg",children:"Request Data Room Access"})]}),(0,b.jsxs)(k.DialogDescription,{className:"text-left",children:["Submit your interest to access the data room for ",y.name,"."]})]}),(0,b.jsx)("div",{className:"py-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 text-sm",children:[(0,b.jsx)("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 text-xs font-medium",children:"1"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:"Submit Interest"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:"Team reviews your request"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3 text-sm",children:[(0,b.jsx)("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 text-xs font-medium",children:"2"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:"Sign NDA"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:"All signatories sign the NDA"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3 text-sm",children:[(0,b.jsx)("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 text-xs font-medium",children:"3"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:"Access Data Room"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:"7-day access to all documents"})]})]})]})}),(0,b.jsxs)(k.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>G(!1),children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:ao,disabled:T,className:"gap-2",children:T?"Processing...":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(I.FolderOpen,{className:"w-4 h-4"}),"Submit Interest"]})})]})]})}),(0,b.jsx)(k.Dialog,{open:H,onOpenChange:J,children:(0,b.jsxs)(k.DialogContent,{children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"NDA Signing Process"}),(0,b.jsx)(k.DialogDescription,{children:"The NDA will be sent to you automatically once your interest is approved."})]}),(0,b.jsxs)("div",{className:"py-4 space-y-4",children:[(0,b.jsx)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(S.CheckCircle2,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("p",{className:"font-medium text-blue-800 dark:text-blue-200",children:"Automatic NDA Generation"}),(0,b.jsxs)("p",{className:"text-blue-700 dark:text-blue-300 mt-1",children:["Once your interest is approved by the VERSO team, each authorized signatory (",y.signatories.length,") will receive their own NDA document to sign."]})]})]})}),(0,b.jsx)("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(az.AlertCircle,{className:"w-5 h-5 text-amber-600 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("p",{className:"font-medium text-amber-800 dark:text-amber-200",children:"Multi-Signatory Required"}),(0,b.jsxs)("p",{className:"text-amber-700 dark:text-amber-300 mt-1",children:["Data room access will be granted only after ",(0,b.jsx)("strong",{children:"all signatories"})," have completed signing their individual NDAs."]})]})]})})]}),(0,b.jsx)(k.DialogFooter,{children:(0,b.jsx)(g.Button,{onClick:()=>J(!1),children:"Got it"})})]})}),(0,b.jsx)(k.Dialog,{open:M,onOpenChange:N,children:(0,b.jsxs)(k.DialogContent,{children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Subscribe to Investment Opportunity"}),(0,b.jsxs)(k.DialogDescription,{children:["Enter your commitment amount to submit a subscription request for ",y.name,". Once reviewed, you'll receive the NDA and subscription documents to sign."]})]}),(0,b.jsxs)("div",{className:"py-4 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(n.Label,{htmlFor:"amount",children:["Commitment Amount (",y.currency,")"]}),(0,b.jsx)(m.Input,{id:"amount",type:"number",placeholder:`Min: ${aF(y.minimum_investment,y.currency)}`,value:O,onChange:a=>Q(a.target.value)}),y.minimum_investment&&y.maximum_investment&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Range: ",aF(y.minimum_investment,y.currency)," - ",aF(y.maximum_investment,y.currency)]})]}),y.signatories.length>0&&(0,b.jsx)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(al.FileSignature,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsxs)("p",{className:"font-medium text-blue-800 dark:text-blue-200",children:[y.signatories.length," Signatory(ies) Required"]}),(0,b.jsx)("p",{className:"text-blue-700 dark:text-blue-300 mt-1",children:"Both NDA and Subscription Pack will be sent to all authorized signatories."}),(0,b.jsx)("p",{className:"text-amber-600 dark:text-amber-400 mt-2 text-xs",children:"Note: This request does not include data room access."})]})]})})]}),(0,b.jsxs)(k.DialogFooter,{children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:ap,disabled:T||!O||null!==y.minimum_investment&&parseFloat(O)<y.minimum_investment,children:T?"Processing...":"Subscribe"})]})]})}),(0,b.jsx)(aC.DocumentViewerFullscreen,{isOpen:W,document:aj,previewUrl:_,isLoading:Y,error:ag,onClose:()=>{X(!1),af(null),ah(null),ak(null)},onDownload:()=>{_&&window.open(_,"_blank")}})]})}a.i(355825),a.s(["default",()=>aH],770392)}];

//# sourceMappingURL=c6ad4_src_app_%28main%29_versotech_main_opportunities_%5Bid%5D_page_tsx_0a997561._.js.map