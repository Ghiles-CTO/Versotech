{"version":3,"sources":["../../../../../versotech-portal/src/components/staff/lawyers/lawyer-detail-client.tsx/__nextjs-internal-proxy.mjs","../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/lawyers/%5Bid%5D/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const LawyerDetailClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call LawyerDetailClient() from the server but LawyerDetailClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/components/staff/lawyers/lawyer-detail-client.tsx\",\n    \"LawyerDetailClient\",\n);\n","import { createServiceClient } from '@/lib/supabase/server'\nimport { requireStaffAuth } from '@/lib/auth'\nimport { notFound } from 'next/navigation'\nimport { LawyerDetailClient } from '@/components/staff/lawyers/lawyer-detail-client'\n\nexport const dynamic = 'force-dynamic'\nexport const revalidate = 0\n\ntype LawyerDetail = {\n  id: string\n  firm_name: string\n  display_name: string\n  legal_entity_type: string | null\n  registration_number: string | null\n  tax_id: string | null\n  primary_contact_name: string | null\n  primary_contact_email: string | null\n  primary_contact_phone: string | null\n  street_address: string | null\n  city: string | null\n  state_province: string | null\n  postal_code: string | null\n  country: string | null\n  specializations: string[] | null\n  is_active: boolean\n  onboarded_at: string | null\n  created_at: string | null\n  created_by: string | null\n  updated_at: string | null\n  logo_url: string | null\n  kyc_status: string | null\n  kyc_approved_at: string | null\n  kyc_approved_by: string | null\n  kyc_expires_at: string | null\n  kyc_notes: string | null\n  assigned_deals: string[] | null\n}\n\ntype Deal = {\n  id: string\n  name: string\n  status: string\n  target_amount: number | null\n  created_at: string\n}\n\nexport default async function LawyerDetailPage({\n  params\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n\n  await requireStaffAuth()\n  const serviceClient = createServiceClient()\n\n  // Fetch lawyer details\n  const { data: lawyer, error } = await serviceClient\n    .from('lawyers')\n    .select('*')\n    .eq('id', id)\n    .single()\n\n  if (error || !lawyer) {\n    console.error('[LawyerDetailPage] Error:', error)\n    notFound()\n  }\n\n  // Fetch assigned deals\n  const assignedDealIds = lawyer.assigned_deals || []\n  let deals: Deal[] = []\n\n  if (assignedDealIds.length > 0) {\n    const { data: dealsData } = await serviceClient\n      .from('deals')\n      .select('id, name, status, target_amount, created_at')\n      .in('id', assignedDealIds)\n      .order('created_at', { ascending: false })\n\n    deals = (dealsData || []).map(d => ({\n      id: d.id,\n      name: d.name,\n      status: d.status || 'unknown',\n      target_amount: d.target_amount,\n      created_at: d.created_at\n    }))\n  }\n\n  // Fetch document count from entity_document_links\n  const { count: documentCount } = await serviceClient\n    .from('entity_document_links')\n    .select('*', { count: 'exact', head: true })\n    .eq('entity_type', 'lawyer')\n    .eq('entity_id', id)\n\n  // Calculate metrics\n  const activeDeals = deals.filter(d =>\n    ['draft', 'open', 'allocation_pending', 'in_progress'].includes(d.status)\n  ).length\n\n  const metrics = {\n    totalDeals: deals.length,\n    activeDeals,\n    documentCount: documentCount || 0\n  }\n\n  const lawyerData = lawyer as LawyerDetail\n\n  return (\n    <LawyerDetailClient\n      lawyer={lawyerData}\n      metrics={metrics}\n      deals={deals}\n    />\n  )\n}\n"],"names":[],"mappings":"yaAEO,IAAM,EAAqB,CAAA,EAAA,AADlC,EAAA,CAAA,CAAA,QACkC,uBAAA,AAAuB,EACrD,WAAa,MAAM,AAAI,MAAM,kPAAoP,EACjR,uGACA,iFAHG,IAAM,EAAqB,CAAA,EADlC,AACkC,EADlC,CAAA,CAAA,QACkC,uBAAuB,AAAvB,EAC9B,WAAa,MAAM,AAAI,MAAM,kPAAoP,EACjR,mFACA,+HCLJ,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA,QAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QA2Ce,eAAe,EAAiB,QAC7C,CAAM,CAGP,EACC,GAAM,IAAE,CAAE,CAAE,CAAG,MAAM,CAErB,OAAM,CAAA,EAAA,EAAA,gBAAgB,AAAhB,IACN,IAAM,EAAgB,CAAA,EAAA,EAAA,mBAAA,AAAmB,IAGnC,CAAE,KAAM,CAAM,OAAE,CAAK,CAAE,CAAG,MAAM,EACnC,IAAI,CAAC,WACL,MAAM,CAAC,KACP,EAAE,CAAC,KAAM,GACT,MAAM,IAEL,GAAS,CAAC,CAAA,GAAQ,CACpB,QAAQ,KAAK,CAAC,4BAA6B,GAC3C,CAAA,EAAA,EAAA,QAAA,AAAQ,KAIV,IAAM,EAAkB,EAAO,cAAc,EAAI,EAAE,CAC/C,EAAgB,EAAE,CAEtB,GAAI,EAAgB,MAAM,CAAG,EAAG,CAC9B,GAAM,CAAE,KAAM,CAAS,CAAE,CAAG,MAAM,EAC/B,IAAI,CAAC,SACL,MAAM,CAAC,+CACP,EAAE,CAAC,KAAM,GACT,KAAK,CAAC,aAAc,CAAE,WAAW,CAAM,GAE1C,EAAQ,CAAC,GAAa,EAAA,AAAE,EAAE,GAAG,CAAC,IAAK,AAAC,CAClC,GAAI,EAAE,EAAE,CACR,KAAM,EAAE,IAAI,CACZ,OAAQ,EAAE,MAAM,EAAI,UACpB,cAAe,EAAE,aAAa,CAC9B,WAAY,EAAE,UAAU,CAC1B,CAAC,CACH,CAGA,GAAM,CAAE,MAAO,CAAa,CAAE,CAAG,MAAM,EACpC,IAAI,CAAC,yBACL,MAAM,CAAC,IAAK,CAAE,MAAO,QAAS,MAAM,CAAK,GACzC,EAAE,CAAC,cAAe,UAClB,EAAE,CAAC,YAAa,GAGb,EAAc,EAAM,MAAM,CAAC,GAC/B,CAAC,QAAS,OAAQ,qBAAsB,cAAc,CAAC,QAAQ,CAAC,EAAE,MAAM,GACxE,MAAM,CAEF,EAAU,CACd,WAAY,EAAM,MAAM,aACxB,EACA,cAAe,GAAiB,CAClC,EAIA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,kBAAkB,CAAA,CACjB,OAJe,CAIP,CACR,QAAS,EACT,MAAO,GAGb,kCA9GuB,+BACG","ignoreList":[0]}