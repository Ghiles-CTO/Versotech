{"version":3,"sources":["../../../../../versotech-portal/src/app/%28main%29/versotech_main/assigned-deals/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table'\nimport {\n  Briefcase,\n  FileText,\n  Clock,\n  CheckCircle2,\n  Search,\n  Loader2,\n  AlertCircle,\n  ExternalLink,\n  Building2,\n  Scale,\n  ChevronLeft,\n  ChevronRight,\n} from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { formatCurrency, formatDate } from '@/lib/format'\nimport { createClient } from '@/lib/supabase/client'\nimport Link from 'next/link'\n\ntype AssignedDeal = {\n  id: string\n  name: string\n  company_name: string | null\n  company_logo_url: string | null\n  deal_type: string\n  status: string\n  currency: string\n  target_amount: number\n  close_at: string | null\n  created_at: string\n  // Future: assignment_date, document_status, escrow_status, etc.\n}\n\ntype LawyerInfo = {\n  id: string\n  firm_name: string\n  display_name: string\n  specializations: string[] | null\n  is_active: boolean\n}\n\ntype Summary = {\n  totalAssigned: number\n  activeDeals: number\n  closedDeals: number\n  pendingReview: number\n}\n\nconst STATUS_STYLES: Record<string, string> = {\n  open: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',\n  draft: 'bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700',\n  closed: 'bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800',\n  cancelled: 'bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800',\n  allocation_pending: 'bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-800',\n  fully_subscribed: 'bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900/30 dark:text-purple-300 dark:border-purple-800',\n}\n\nconst STATUS_FILTERS = [\n  { label: 'All Status', value: 'all' },\n  { label: 'Open', value: 'open' },\n  { label: 'Draft', value: 'draft' },\n  { label: 'Closed', value: 'closed' },\n  { label: 'Fully Subscribed', value: 'fully_subscribed' },\n]\n\nexport default function AssignedDealsPage() {\n  const [lawyerInfo, setLawyerInfo] = useState<LawyerInfo | null>(null)\n  const [deals, setDeals] = useState<AssignedDeal[]>([])\n  const [summary, setSummary] = useState<Summary>({\n    totalAssigned: 0,\n    activeDeals: 0,\n    closedDeals: 0,\n    pendingReview: 0,\n  })\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [search, setSearch] = useState('')\n  const [statusFilter, setStatusFilter] = useState('all')\n  const [currentPage, setCurrentPage] = useState(1)\n  const pageSize = 10\n\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        setLoading(true)\n        const supabase = createClient()\n\n        // Get current user\n        const { data: { user } } = await supabase.auth.getUser()\n        if (!user) {\n          setError('Not authenticated')\n          return\n        }\n\n        // Check if user is a lawyer\n        const { data: lawyerUser, error: lawyerUserError } = await supabase\n          .from('lawyer_users')\n          .select('lawyer_id')\n          .eq('user_id', user.id)\n          .single()\n\n        if (lawyerUserError || !lawyerUser) {\n          // Maybe they're staff - show all deals as placeholder\n          await fetchAllDeals(supabase)\n          return\n        }\n\n        // Fetch lawyer info\n        const { data: lawyer, error: lawyerError } = await supabase\n          .from('lawyers')\n          .select('id, firm_name, display_name, specializations, is_active')\n          .eq('id', lawyerUser.lawyer_id)\n          .single()\n\n        if (lawyerError) throw lawyerError\n        setLawyerInfo(lawyer)\n\n        // VEHICLE-LEVEL ARCHITECTURE: Get vehicles assigned to this lawyer first\n        const { data: lawyerVehicles, error: vehiclesError } = await supabase\n          .from('vehicles')\n          .select('id, name')\n          .eq('lawyer_id', lawyerUser.lawyer_id)\n\n        if (vehiclesError) {\n          console.error('Error fetching lawyer vehicles:', vehiclesError)\n        }\n\n        const vehicleIds = (lawyerVehicles || []).map((v: any) => v.id)\n\n        // Then get all deals under those vehicles\n        let processedDeals: AssignedDeal[] = []\n\n        if (vehicleIds.length > 0) {\n          const { data: vehicleDeals, error: dealsError } = await supabase\n            .from('deals')\n            .select(`\n              id,\n              name,\n              company_name,\n              company_logo_url,\n              deal_type,\n              status,\n              currency,\n              target_amount,\n              close_at,\n              created_at,\n              vehicle_id\n            `)\n            .in('vehicle_id', vehicleIds)\n            .order('created_at', { ascending: false })\n\n          if (dealsError) {\n            console.error('Error fetching deals:', dealsError)\n          }\n\n          processedDeals = (vehicleDeals || []).map((deal: any) => ({\n            id: deal.id,\n            name: deal.name || 'Untitled Deal',\n            company_name: deal.company_name,\n            company_logo_url: deal.company_logo_url,\n            deal_type: deal.deal_type || 'unknown',\n            status: deal.status || 'draft',\n            currency: deal.currency || 'USD',\n            target_amount: Number(deal.target_amount) || 0,\n            close_at: deal.close_at,\n            created_at: deal.created_at,\n          }))\n        } else {\n          // Fallback: check lawyers.assigned_deals array (legacy)\n          const { data: lawyerWithDeals } = await supabase\n            .from('lawyers')\n            .select('assigned_deals')\n            .eq('id', lawyerUser.lawyer_id)\n            .single()\n\n          if (lawyerWithDeals?.assigned_deals && lawyerWithDeals.assigned_deals.length > 0) {\n            const { data: dealsFromArray } = await supabase\n              .from('deals')\n              .select(`\n                id, name, company_name, company_logo_url, deal_type,\n                status, currency, target_amount, close_at, created_at\n              `)\n              .in('id', lawyerWithDeals.assigned_deals)\n              .order('created_at', { ascending: false })\n\n            processedDeals = (dealsFromArray || []).map((deal: any) => ({\n              id: deal.id,\n              name: deal.name || 'Untitled Deal',\n              company_name: deal.company_name,\n              company_logo_url: deal.company_logo_url,\n              deal_type: deal.deal_type || 'unknown',\n              status: deal.status || 'draft',\n              currency: deal.currency || 'USD',\n              target_amount: Number(deal.target_amount) || 0,\n              close_at: deal.close_at,\n              created_at: deal.created_at,\n            }))\n          }\n        }\n\n        setDeals(processedDeals)\n\n        const active = processedDeals.filter(d => d.status === 'open' || d.status === 'allocation_pending').length\n        const closed = processedDeals.filter(d => d.status === 'closed' || d.status === 'fully_subscribed').length\n\n        setSummary({\n          totalAssigned: processedDeals.length,\n          activeDeals: active,\n          closedDeals: closed,\n          pendingReview: 0, // No longer tracked via deal_lawyer_assignments status\n        })\n\n        setError(null)\n      } catch (err) {\n        console.error('[AssignedDealsPage] Error:', err)\n        setError(err instanceof Error ? err.message : 'Failed to load assigned deals')\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    async function fetchAllDeals(supabase: any) {\n      // Staff view - show recent deals as placeholder\n      const { data: dealsData, error: dealsError } = await supabase\n        .from('deals')\n        .select(`\n          id,\n          name,\n          company_name,\n          company_logo_url,\n          deal_type,\n          status,\n          currency,\n          target_amount,\n          close_at,\n          created_at\n        `)\n        .order('created_at', { ascending: false })\n        .limit(50)\n\n      if (dealsError) throw dealsError\n\n      const processedDeals: AssignedDeal[] = (dealsData || []).map((deal: any) => ({\n        id: deal.id,\n        name: deal.name || 'Untitled Deal',\n        company_name: deal.company_name,\n        company_logo_url: deal.company_logo_url,\n        deal_type: deal.deal_type || 'unknown',\n        status: deal.status || 'draft',\n        currency: deal.currency || 'USD',\n        target_amount: Number(deal.target_amount) || 0,\n        close_at: deal.close_at,\n        created_at: deal.created_at,\n      }))\n\n      setDeals(processedDeals)\n\n      const active = processedDeals.filter(d => d.status === 'open' || d.status === 'allocation_pending').length\n      const closed = processedDeals.filter(d => d.status === 'closed' || d.status === 'fully_subscribed').length\n\n      setSummary({\n        totalAssigned: processedDeals.length,\n        activeDeals: active,\n        closedDeals: closed,\n        pendingReview: 0,\n      })\n    }\n\n    fetchData()\n  }, [])\n\n  // Filter deals\n  const filteredDeals = deals.filter(deal => {\n    const matchesStatus = statusFilter === 'all' || deal.status === statusFilter\n    const matchesSearch = !search ||\n      deal.name?.toLowerCase().includes(search.toLowerCase()) ||\n      deal.company_name?.toLowerCase().includes(search.toLowerCase())\n    return matchesStatus && matchesSearch\n  })\n\n  // Pagination calculations\n  const totalPages = Math.ceil(filteredDeals.length / pageSize)\n  const startIndex = (currentPage - 1) * pageSize\n  const paginatedDeals = filteredDeals.slice(startIndex, startIndex + pageSize)\n\n  // Reset to page 1 when filters change\n  useEffect(() => {\n    setCurrentPage(1)\n  }, [search, statusFilter])\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-16\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n        <span className=\"ml-3 text-muted-foreground\">Loading assigned deals...</span>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-16\">\n        <AlertCircle className=\"h-12 w-12 text-destructive mx-auto mb-4\" />\n        <h3 className=\"text-lg font-medium text-foreground mb-2\">Error Loading Deals</h3>\n        <p className=\"text-muted-foreground\">{error}</p>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-foreground\">Assigned Deals</h1>\n          <p className=\"text-muted-foreground mt-1\">\n            {lawyerInfo\n              ? `Manage deal documentation and escrow as ${lawyerInfo.display_name}`\n              : 'View all deals requiring legal review'}\n          </p>\n        </div>\n        {lawyerInfo && lawyerInfo.specializations && lawyerInfo.specializations.length > 0 && (\n          <div className=\"flex gap-1\">\n            {lawyerInfo.specializations.slice(0, 2).map((spec, idx) => (\n              <Badge key={idx} variant=\"outline\" className=\"capitalize\">\n                {spec}\n              </Badge>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n              <Briefcase className=\"h-4 w-4\" />\n              Total Assigned\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{summary.totalAssigned}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Deals requiring attention\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n              <Scale className=\"h-4 w-4\" />\n              Active Deals\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-green-600\">{summary.activeDeals}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Currently in progress\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n              <CheckCircle2 className=\"h-4 w-4\" />\n              Completed\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-blue-600\">{summary.closedDeals}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Successfully closed\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n              <Clock className=\"h-4 w-4\" />\n              Pending Review\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-orange-500\">{summary.pendingReview}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Awaiting your review\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Filters */}\n      <Card>\n        <CardContent className=\"pt-6\">\n          <div className=\"flex flex-col md:flex-row gap-4\">\n            <div className=\"flex-1\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search by deal name or company...\"\n                  value={search}\n                  onChange={(e) => setSearch(e.target.value)}\n                  className=\"pl-10\"\n                />\n              </div>\n            </div>\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-full md:w-48\">\n                <SelectValue placeholder=\"Filter by status\" />\n              </SelectTrigger>\n              <SelectContent>\n                {STATUS_FILTERS.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    {option.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Deals Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Deals</CardTitle>\n          <CardDescription>\n            {filteredDeals.length} deal{filteredDeals.length !== 1 ? 's' : ''} found\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          {filteredDeals.length === 0 ? (\n            <div className=\"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2\">\n              <FileText className=\"h-10 w-10 text-muted-foreground\" />\n              <p className=\"text-sm text-muted-foreground\">\n                {search || statusFilter !== 'all'\n                  ? 'No deals match your filters'\n                  : lawyerInfo\n                    ? 'No deals assigned to you yet'\n                    : 'No deals requiring legal review'}\n              </p>\n              {lawyerInfo && deals.length === 0 && (\n                <p className=\"text-xs text-muted-foreground\">\n                  You will be notified when deals are assigned for your review\n                </p>\n              )}\n            </div>\n          ) : (\n            <>\n            <div className=\"rounded-md border\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Deal</TableHead>\n                    <TableHead>Type</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Value</TableHead>\n                    <TableHead>Close Date</TableHead>\n                    <TableHead className=\"text-right\">Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {paginatedDeals.map((deal) => (\n                    <TableRow key={deal.id}>\n                      <TableCell>\n                        <div className=\"flex items-center gap-3\">\n                          {deal.company_logo_url ? (\n                            <img\n                              src={deal.company_logo_url}\n                              alt={deal.company_name || ''}\n                              className=\"h-10 w-10 rounded-lg object-cover\"\n                            />\n                          ) : (\n                            <div className=\"h-10 w-10 rounded-lg bg-muted flex items-center justify-center\">\n                              <Building2 className=\"h-5 w-5 text-muted-foreground\" />\n                            </div>\n                          )}\n                          <div>\n                            <div className=\"font-medium\">{deal.name}</div>\n                            {deal.company_name && (\n                              <div className=\"text-xs text-muted-foreground\">\n                                {deal.company_name}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <Badge variant=\"secondary\" className=\"capitalize\">\n                          {deal.deal_type.replace('_', ' ')}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>\n                        <Badge\n                          variant=\"outline\"\n                          className={cn('capitalize', STATUS_STYLES[deal.status] || STATUS_STYLES.draft)}\n                        >\n                          {deal.status.replace('_', ' ')}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"font-medium\">\n                          {formatCurrency(deal.target_amount, deal.currency)}\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        {deal.close_at ? (\n                          <div className=\"text-sm\">\n                            {formatDate(deal.close_at)}\n                          </div>\n                        ) : (\n                          <span className=\"text-muted-foreground text-xs\">Not set</span>\n                        )}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <Button variant=\"ghost\" size=\"sm\" asChild>\n                          <Link href={`/versotech_main/lawyer-deal/${deal.id}`}>\n                            <ExternalLink className=\"h-4 w-4\" />\n                          </Link>\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n\n            {/* Pagination Controls */}\n            {totalPages > 1 && (\n              <div className=\"flex items-center justify-between pt-4 border-t\">\n                <div className=\"text-sm text-muted-foreground\">\n                  Showing {startIndex + 1}-{Math.min(startIndex + pageSize, filteredDeals.length)} of {filteredDeals.length} deals\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\n                    disabled={currentPage === 1}\n                  >\n                    <ChevronLeft className=\"h-4 w-4\" />\n                    Previous\n                  </Button>\n                  <div className=\"flex items-center gap-1 text-sm\">\n                    <span>Page</span>\n                    <span className=\"font-medium\">{currentPage}</span>\n                    <span>of</span>\n                    <span className=\"font-medium\">{totalPages}</span>\n                  </div>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))}\n                    disabled={currentPage === totalPages}\n                  >\n                    Next\n                    <ChevronRight className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n            </>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}