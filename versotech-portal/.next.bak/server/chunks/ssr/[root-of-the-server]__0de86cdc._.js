module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},9349,a=>{a.n(a.i(142710))},199585,a=>{a.n(a.i(701395))},929852,a=>{a.n(a.i(816404))},516153,a=>{a.n(a.i(422096))},911164,a=>{a.n(a.i(273021))},16933,a=>{a.n(a.i(618450))},498419,a=>{a.n(a.i(72598))},416869,a=>{"use strict";a.s(["CalendarSplitView",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call CalendarSplitView() from the server but CalendarSplitView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx <module evaluation>","CalendarSplitView")},249364,a=>{"use strict";a.s(["CalendarSplitView",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call CalendarSplitView() from the server but CalendarSplitView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx","CalendarSplitView")},77088,a=>{"use strict";a.i(416869);var b=a.i(249364);a.n(b)},304961,a=>{"use strict";var b=a.i(714898);a.i(937413);var c=a.i(131360),d=a.i(77088),e=a.i(198307);let f={high:{id:"task-high",name:"Task • High priority",color:"#dc2626"},medium:{id:"task-medium",name:"Task • Medium priority",color:"#f97316"},low:{id:"task-low",name:"Task • Standard priority",color:"#2563eb"}},g={urgent:{id:"request-urgent",name:"Investor request • Urgent",color:"#be123c"},high:{id:"request-high",name:"Investor request • High",color:"#b45309"},normal:{id:"request-normal",name:"Investor request • Standard",color:"#0ea5e9"},low:{id:"request-low",name:"Investor request • Low",color:"#64748b"}},h={open:{id:"deal-open",name:"Deal close • Open",color:"#7c3aed"},allocation_pending:{id:"deal-allocation",name:"Deal close • Allocation pending",color:"#a855f7"},due_diligence:{id:"deal-dd",name:"Deal close • Due diligence",color:"#9333ea"},closed:{id:"deal-closed",name:"Deal close • Closed",color:"#64748b"}},i={id:"call-pending",name:"Capital call due",color:"#dc2626"},j={id:"call-draft",name:"Capital call • Draft",color:"#f97316"},k={id:"dist-scheduled",name:"Distribution",color:"#16a34a"},l={id:"kyc-expiring",name:"KYC expiring",color:"#f59e0b"},m={id:"kyc-expired",name:"KYC expired",color:"#dc2626"},n={id:"accred-expiring",name:"Accreditation expiring",color:"#ea580c"},o={id:"approval-breach",name:"Approval • SLA breach",color:"#dc2626"},p={id:"approval-pending",name:"Approval pending",color:"#f59e0b"},q={id:"fee-accrued",name:"Fee event",color:"#14b8a6"},r={id:"data-room-expiring",name:"Data room access expiring",color:"#8b5cf6"},s={id:"sub-funding",name:"Subscription funding due",color:"#10b981"};async function t(){let a=await (0,e.createClient)(),{data:{user:t}}=await a.auth.getUser();t||(0,c.redirect)("/versotech/login");let{data:w}=await a.from("profiles").select("role").eq("id",t.id).single();w&&["staff_admin","staff_ops","staff_rm","ceo"].includes(w.role)||(0,c.redirect)("/versotech");let x=(0,e.createServiceClient)(),y=[],{data:z}=await x.from("tasks").select("id, title, status, priority, due_at, category, created_at").not("status","eq","completed").not("owner_user_id","is",null).order("due_at",{ascending:!0,nullsFirst:!1}).limit(50);for(let a of z??[]){let b=f[a.priority||"medium"]??f.low,c=new Date(a.due_at?a.due_at:a.created_at),d=a.due_at?u(c,-1):new Date(a.created_at);y.push({id:`task-${a.id}`,name:a.title,startAt:d.toISOString(),endAt:c.toISOString(),status:b,description:a.category?`Category • ${v(a.category)}`:void 0})}let{data:A}=await x.from("deals").select("id, name, status, close_at, created_at, vehicles ( name )").in("status",["open","allocation_pending","draft"]).not("close_at","is",null).order("close_at",{ascending:!0}).limit(30);for(let a of A??[]){let b=h[a.status??"open"]??h.open,c=u(new Date(a.close_at),-7);y.push({id:`deal-${a.id}`,name:`Deal Close: ${a.name}`,startAt:c.toISOString(),endAt:a.close_at,status:b,description:a.vehicles?.[0]?.name?`Vehicle • ${a.vehicles[0].name}`:void 0})}let{data:B}=await x.from("capital_calls").select("id, name, due_date, status, vehicles ( name )").in("status",["draft","pending","active"]).not("due_date","is",null).order("due_date",{ascending:!0}).limit(30);for(let a of B??[]){let b="pending"===a.status?i:j,c=u(new Date(a.due_date),-3);y.push({id:`call-${a.id}`,name:a.name,startAt:c.toISOString(),endAt:a.due_date,status:b,description:a.vehicles?.[0]?.name?`Vehicle • ${a.vehicles[0].name}`:void 0})}let{data:C}=await x.from("distributions").select("id, name, date, vehicles ( name )").gte("date",new Date(Date.now()-2592e6).toISOString().split("T")[0]).order("date",{ascending:!0}).limit(30);for(let a of C??[]){let b=new Date(a.date);y.push({id:`dist-${a.id}`,name:a.name,startAt:b.toISOString(),endAt:b.toISOString(),status:k,description:a.vehicles?.[0]?.name?`Vehicle • ${a.vehicles[0].name}`:void 0})}let D=new Date(Date.now()+7776e6).toISOString().split("T")[0],{data:E}=await x.from("investors").select("id, legal_name, kyc_expiry_date, accreditation_expiry").or(`kyc_expiry_date.lte.${D},accreditation_expiry.lte.${D}`).limit(50);for(let a of E??[]){if(a.kyc_expiry_date){let b=new Date(a.kyc_expiry_date),c=b<new Date,d=c?m:l,e=u(b,-14);y.push({id:`kyc-${a.id}`,name:`KYC Renewal: ${a.legal_name}`,startAt:e.toISOString(),endAt:a.kyc_expiry_date,status:d,description:c?"Expired":"Expiring soon"})}if(a.accreditation_expiry){let b=u(new Date(a.accreditation_expiry),-14);y.push({id:`accred-${a.id}`,name:`Accreditation Renewal: ${a.legal_name}`,startAt:b.toISOString(),endAt:a.accreditation_expiry,status:n,description:"Accreditation expiring"})}}let{data:F}=await x.from("approvals").select("id, entity_type, action, entity_id, created_at, sla_breach_at, requested_by:profiles!requested_by ( display_name )").eq("status","pending").order("sla_breach_at",{ascending:!0,nullsFirst:!1}).limit(30);for(let a of F??[]){let b=a.sla_breach_at?new Date(a.sla_breach_at):u(new Date(a.created_at),3),c=b<new Date?o:p,d=new Date(a.created_at),e=a.action?v(a.action):v(a.entity_type);y.push({id:`approval-${a.id}`,name:`Approval: ${e}`,startAt:d.toISOString(),endAt:b.toISOString(),status:c,description:Array.isArray(a.requested_by)&&a.requested_by[0]?.display_name?`Requested by ${a.requested_by[0].display_name}`:void 0})}let{data:G}=await x.from("subscriptions").select("id, subscription_number, funding_due_at, investors ( legal_name ), vehicles ( name )").in("status",["committed","active"]).not("funding_due_at","is",null).gte("funding_due_at",new Date().toISOString()).order("funding_due_at",{ascending:!0}).limit(30);for(let a of G??[]){let b=u(new Date(a.funding_due_at),-5);y.push({id:`sub-${a.id}`,name:`Funding Due: ${(Array.isArray(a.investors)?a.investors[0]?.legal_name:null)||a.subscription_number}`,startAt:b.toISOString(),endAt:a.funding_due_at,status:s,description:a.vehicles?.[0]?.name?`Vehicle • ${a.vehicles[0].name}`:void 0})}let{data:H}=await x.from("fee_events").select("id, fee_type, event_date, computed_amount, deals ( name ), investors ( legal_name, display_name )").in("status",["accrued","invoiced"]).gte("event_date",new Date(Date.now()-2592e6).toISOString().split("T")[0]).order("event_date",{ascending:!0}).limit(30);for(let a of H??[]){let b=new Date(a.event_date),c=Array.isArray(a.deals)&&a.deals[0]?.name?a.deals[0].name:null,d=Array.isArray(a.investors)&&a.investors[0]?a.investors[0].display_name||a.investors[0].legal_name:null,e=c?`Deal • ${c}`:d?`Investor • ${d}`:void 0;y.push({id:`fee-${a.id}`,name:`Fee Event: ${v(a.fee_type)}`,startAt:b.toISOString(),endAt:b.toISOString(),status:q,description:e})}let{data:I}=await x.from("request_tickets").select("id, subject, status, priority, due_date, created_at, investors ( legal_name )").in("status",["open","in_progress"]).order("due_date",{ascending:!0,nullsFirst:!1}).limit(30);for(let a of I??[]){let b=g[a.priority]??g.normal,c=a.due_date?new Date(a.due_date):u(new Date(a.created_at),5),d=new Date(a.created_at);y.push({id:`request-${a.id}`,name:a.subject||"Investor Request",startAt:d.toISOString(),endAt:c.toISOString(),status:b,description:Array.isArray(a.investors)&&a.investors[0]?.legal_name?`Investor • ${a.investors[0].legal_name}`:void 0})}let J=new Date(Date.now()+2592e6).toISOString(),{data:K}=await x.from("deal_data_room_access").select("id, expires_at, deals ( name ), investors ( legal_name, display_name )").is("revoked_at",null).lte("expires_at",J).order("expires_at",{ascending:!0}).limit(30);for(let a of K??[]){let b=u(new Date(a.expires_at),-3),c=Array.isArray(a.investors)&&a.investors[0]?a.investors[0].display_name||a.investors[0].legal_name:null;y.push({id:`dataroom-${a.id}`,name:`Data Room Expiry: ${(Array.isArray(a.deals)?a.deals[0]?.name:null)||"Deal"}`,startAt:b.toISOString(),endAt:a.expires_at,status:r,description:c?`Investor • ${c}`:void 0})}return y.sort((a,b)=>new Date(a.startAt).getTime()-new Date(b.startAt).getTime()),(0,b.jsxs)("div",{className:"space-y-8 px-6 py-8",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Staff Calendar"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"View all important deadlines, events, and tasks across the platform"})]}),(0,b.jsx)(d.CalendarSplitView,{calendarEvents:y,emptyCalendarMessage:"No upcoming events or deadlines scheduled.",brand:"versotech"})]})}function u(a,b){return new Date(a.getTime()+864e5*b)}function v(a){if(a)return a.toLowerCase().split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}a.s(["default",()=>t,"dynamic",0,"force-dynamic"])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0de86cdc._.js.map