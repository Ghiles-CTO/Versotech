{"version":3,"sources":["../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/reconciliation/components/reconciliation-page-client.tsx","../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/reconciliation/components/transactions-data-table.tsx","../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/reconciliation/components/transaction-columns.tsx","../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/reconciliation/components/invoices-data-table.tsx","../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/reconciliation/components/invoice-columns.tsx","../../../../../versotech-portal/src/components/staff/reconciliation-client.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState, useMemo } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\r\nimport {\r\n  Upload,\r\n  RefreshCw,\r\n  Search,\r\n  CheckCircle,\r\n  AlertCircle,\r\n  Clock,\r\n  Activity,\r\n  FileText,\r\n  DollarSign,\r\n  TrendingUp\r\n} from 'lucide-react'\r\nimport { Progress } from '@/components/ui/progress'\r\nimport { TransactionsDataTable } from './transactions-data-table'\r\nimport { transactionColumns, BankTransactionRow } from './transaction-columns'\r\nimport { InvoicesDataTable } from './invoices-data-table'\r\nimport { invoiceColumns, ReconciliationInvoiceRow } from './invoice-columns'\r\nimport { UploadCSVDialog, AutoMatchButton } from '@/components/staff/reconciliation-client'\r\nimport { toast } from 'sonner'\r\n\r\nexport function ReconciliationPageClient() {\r\n  const router = useRouter()\r\n\r\n  const [activeTab, setActiveTab] = useState<'transactions' | 'invoices'>('transactions')\r\n\r\n  const [rawData, setRawData] = useState<BankTransactionRow[]>([])\r\n  const [stats, setStats] = useState<any>(null)\r\n  const [invoices, setInvoices] = useState<ReconciliationInvoiceRow[]>([])\r\n  const [invoiceStats, setInvoiceStats] = useState<any>(null)\r\n\r\n  const [loading, setLoading] = useState(true)\r\n  const [refreshing, setRefreshing] = useState(false)\r\n\r\n  const [quickSearch, setQuickSearch] = useState('')\r\n  const [statusFilter, setStatusFilter] = useState<string>('')\r\n\r\n  useEffect(() => {\r\n    loadData()\r\n    loadInvoices()\r\n  }, [])\r\n\r\n  const loadData = async () => {\r\n    try {\r\n      setLoading(true)\r\n      const response = await fetch('/api/staff/reconciliation')\r\n      if (!response.ok) throw new Error('Failed to load transactions')\r\n\r\n      const data = await response.json()\r\n      setRawData(data.transactions || [])\r\n      setStats(data.stats || {})\r\n    } catch (err) {\r\n      console.error('Load error:', err)\r\n      toast.error('Failed to load reconciliation data')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const loadInvoices = async () => {\r\n    try {\r\n      const response = await fetch('/api/staff/reconciliation/invoices')\r\n      if (!response.ok) throw new Error('Failed to load invoices')\r\n\r\n      const data = await response.json()\r\n      setInvoices(data.invoices || [])\r\n      setInvoiceStats(data.stats || {})\r\n    } catch (err) {\r\n      console.error('Invoice load error:', err)\r\n      toast.error('Failed to load invoices')\r\n    }\r\n  }\r\n\r\n  const handleRefresh = async () => {\r\n    setRefreshing(true)\r\n    try {\r\n      await Promise.all([\r\n        fetch('/api/staff/reconciliation').then(async (response) => {\r\n          if (!response.ok) throw new Error('Failed to refresh transactions')\r\n          const data = await response.json()\r\n          setRawData(data.transactions || [])\r\n          setStats(data.stats || {})\r\n        }),\r\n        fetch('/api/staff/reconciliation/invoices').then(async (response) => {\r\n          if (!response.ok) throw new Error('Failed to refresh invoices')\r\n          const data = await response.json()\r\n          setInvoices(data.invoices || [])\r\n          setInvoiceStats(data.stats || {})\r\n        })\r\n      ])\r\n      toast.success('Data refreshed')\r\n    } catch (err) {\r\n      toast.error('Failed to refresh data')\r\n    } finally {\r\n      setRefreshing(false)\r\n    }\r\n  }\r\n\r\n  const filteredTransactions = useMemo(() => {\r\n    if (!rawData || rawData.length === 0) return []\r\n\r\n    let result = rawData\r\n\r\n    if (quickSearch) {\r\n      const search = quickSearch.toLowerCase()\r\n      result = result.filter(txn => {\r\n        const matchTerms = (txn.matches || []).flatMap(match => {\r\n          const invoice = match.invoices\r\n          return [\r\n            invoice?.invoice_number,\r\n            invoice?.investor?.legal_name,\r\n            invoice?.deal?.name\r\n          ]\r\n        })\r\n        const suggestionTerms = (txn.suggestions || []).flatMap(suggestion => {\r\n          const invoice = suggestion.invoices\r\n          return [\r\n            invoice?.invoice_number,\r\n            invoice?.investor?.legal_name,\r\n            invoice?.deal?.name\r\n          ]\r\n        })\r\n\r\n        const searchable = [\r\n          txn.counterparty,\r\n          txn.memo,\r\n          txn.bank_reference,\r\n          txn.account_ref,\r\n          ...matchTerms,\r\n          ...suggestionTerms\r\n        ]\r\n          .filter(Boolean)\r\n          .join(' ')\r\n          .toLowerCase()\r\n\r\n        return searchable.includes(search)\r\n      })\r\n    }\r\n\r\n    if (statusFilter) {\r\n      result = result.filter(txn => txn.status === statusFilter)\r\n    }\r\n\r\n    return result\r\n  }, [rawData, quickSearch, statusFilter])\r\n\r\n  const filteredInvoices = useMemo(() => {\r\n    if (!invoices || invoices.length === 0) return []\r\n\r\n    let result = invoices\r\n\r\n    if (quickSearch) {\r\n      const search = quickSearch.toLowerCase()\r\n      result = result.filter(inv => {\r\n        const searchable = [\r\n          inv.invoice_number,\r\n          inv.investor?.legal_name,\r\n          inv.deal?.name\r\n        ]\r\n          .filter(Boolean)\r\n          .join(' ')\r\n          .toLowerCase()\r\n\r\n        return searchable.includes(search)\r\n      })\r\n    }\r\n\r\n    if (statusFilter) {\r\n      // For invoices, statusFilter can be payment status or match status\r\n      if (['paid', 'partially_paid', 'sent', 'overdue', 'draft'].includes(statusFilter)) {\r\n        result = result.filter(inv => inv.status === statusFilter)\r\n      } else if (['matched', 'partially_matched', 'unmatched'].includes(statusFilter)) {\r\n        result = result.filter(inv => inv.match_status === statusFilter)\r\n      }\r\n    }\r\n\r\n    return result\r\n  }, [invoices, quickSearch, statusFilter])\r\n\r\n  // Summary stats based on filtered data (for the summary section)\r\n  // NOTE: This hook MUST be called before the loading early return to maintain hook order\r\n  const filteredSummary = useMemo(() => {\r\n    const txns = filteredTransactions\r\n    const total = txns.length\r\n    const matched = txns.filter(t => t.status === 'matched').length\r\n    const partiallyMatched = txns.filter(t => t.status === 'partially_matched').length\r\n    const unmatched = txns.filter(t => t.status === 'unmatched').length\r\n\r\n    const totalAmount = txns.reduce((sum, t) => sum + (Number(t.amount) || 0), 0)\r\n    const matchedAmount = txns.reduce((sum, t) => sum + (Number(t.matched_amount_total) || 0), 0)\r\n    const unmatchedAmount = txns\r\n      .filter(t => t.status === 'unmatched')\r\n      .reduce((sum, t) => sum + (Number(t.amount) || 0), 0)\r\n    const outstandingAmount = totalAmount - matchedAmount\r\n\r\n    const matchPercentage = total > 0 ? Math.round((matched / total) * 100) : 0\r\n\r\n    return {\r\n      total,\r\n      matched,\r\n      partiallyMatched,\r\n      unmatched,\r\n      totalAmount,\r\n      matchedAmount,\r\n      unmatchedAmount,\r\n      outstandingAmount,\r\n      matchPercentage\r\n    }\r\n  }, [filteredTransactions])\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return new Intl.NumberFormat('en-US', {\r\n      style: 'currency',\r\n      currency: 'USD',\r\n      minimumFractionDigits: 0,\r\n      maximumFractionDigits: 0,\r\n    }).format(amount)\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-96\">\r\n        <div className=\"text-center\">\r\n          <RefreshCw className=\"h-8 w-8 animate-spin text-muted-foreground mx-auto mb-2\" />\r\n          <div className=\"text-sm text-muted-foreground\">Loading reconciliation data...</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const matchRate = stats?.total > 0 ? Math.round((stats.matched / stats.total) * 100) : 0\r\n  const partialRemainingAmount = rawData\r\n    .filter(txn => txn.status === 'partially_matched')\r\n    .reduce((sum, txn) => {\r\n      const remaining = typeof txn.remaining_amount === 'number'\r\n        ? txn.remaining_amount\r\n        : Math.max((txn.amount || 0) - (txn.matched_amount_total || 0), 0)\r\n      return sum + remaining\r\n    }, 0)\r\n\r\n  const currentStats = activeTab === 'transactions' ? stats : invoiceStats\r\n  const currentData = activeTab === 'transactions' ? filteredTransactions : filteredInvoices\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-foreground\">Bank Reconciliation</h1>\r\n          <p className=\"text-muted-foreground mt-1\">\r\n            Import bank transactions and match payments to fee invoices\r\n          </p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={handleRefresh}\r\n            disabled={refreshing}\r\n          >\r\n            <RefreshCw className={`h-4 w-4 mr-2 ${refreshing ? 'animate-spin' : ''}`} />\r\n            Refresh\r\n          </Button>\r\n          <UploadCSVDialog />\r\n          <AutoMatchButton />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Reconciliation Summary */}\r\n      <Card>\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <TrendingUp className=\"h-5 w-5 text-muted-foreground\" />\r\n                Reconciliation Summary\r\n              </CardTitle>\r\n              <CardDescription className=\"mt-1\">\r\n                Overall reconciliation status\r\n                {(quickSearch || statusFilter) && (\r\n                  <span className=\"text-amber-400 ml-2\">(filtered view)</span>\r\n                )}\r\n              </CardDescription>\r\n            </div>\r\n            <div className=\"text-right\">\r\n              <div className=\"text-3xl font-bold text-emerald-400\">{filteredSummary.matchPercentage}%</div>\r\n              <div className=\"text-sm text-muted-foreground\">Match Rate</div>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* Progress Bar */}\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-muted-foreground\">Matching Progress</span>\r\n              <span className=\"text-foreground font-medium\">\r\n                {filteredSummary.matched} of {filteredSummary.total} transactions\r\n              </span>\r\n            </div>\r\n            <Progress value={filteredSummary.matchPercentage} className=\"h-3\" />\r\n          </div>\r\n\r\n          {/* Summary KPIs */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 pt-2\">\r\n            <div className=\"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border border-border\">\r\n              <div className=\"p-2 rounded-lg bg-amber-500/10\">\r\n                <Clock className=\"h-5 w-5 text-amber-500 dark:text-amber-400\" />\r\n              </div>\r\n              <div>\r\n                <div className=\"text-sm text-muted-foreground\">Total Outstanding</div>\r\n                <div className=\"text-lg font-bold text-amber-600 dark:text-amber-200\">{formatCurrency(filteredSummary.outstandingAmount)}</div>\r\n                <div className=\"text-xs text-muted-foreground\">{filteredSummary.unmatched + filteredSummary.partiallyMatched} transactions</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border border-border\">\r\n              <div className=\"p-2 rounded-lg bg-emerald-500/10\">\r\n                <CheckCircle className=\"h-5 w-5 text-emerald-500 dark:text-emerald-400\" />\r\n              </div>\r\n              <div>\r\n                <div className=\"text-sm text-muted-foreground\">Total Matched</div>\r\n                <div className=\"text-lg font-bold text-emerald-600 dark:text-emerald-200\">{formatCurrency(filteredSummary.matchedAmount)}</div>\r\n                <div className=\"text-xs text-muted-foreground\">{filteredSummary.matched} transactions</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border border-border\">\r\n              <div className=\"p-2 rounded-lg bg-rose-500/10\">\r\n                <AlertCircle className=\"h-5 w-5 text-rose-500 dark:text-rose-400\" />\r\n              </div>\r\n              <div>\r\n                <div className=\"text-sm text-muted-foreground\">Total Unmatched</div>\r\n                <div className=\"text-lg font-bold text-rose-600 dark:text-rose-200\">{formatCurrency(filteredSummary.unmatchedAmount)}</div>\r\n                <div className=\"text-xs text-muted-foreground\">{filteredSummary.unmatched} transactions</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Tabs */}\r\n      <Tabs value={activeTab} onValueChange={(val) => setActiveTab(val as 'transactions' | 'invoices')}>\r\n        <TabsList className=\"grid w-full max-w-md grid-cols-2\">\r\n          <TabsTrigger value=\"transactions\" className=\"flex items-center gap-2\">\r\n            <Activity className=\"h-4 w-4\" />\r\n            Transactions ({rawData.length})\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"invoices\" className=\"flex items-center gap-2\">\r\n            <FileText className=\"h-4 w-4\" />\r\n            Fee Invoices ({invoices.length})\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* Stats Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4 mt-6\">\r\n        <Card className=\"bg-muted/50 border border-border\">\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <Activity className=\"h-4 w-4\" />\r\n              Match Rate\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-emerald-600 dark:text-emerald-200\">{matchRate}%</div>\r\n            <div className=\"text-sm text-muted-foreground mt-1\">\r\n              {stats?.matched || 0} of {stats?.total || 0}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <CheckCircle className=\"h-4 w-4\" />\r\n              Matched\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-emerald-600 dark:text-emerald-200\">{stats?.matched || 0}</div>\r\n            <div className=\"text-sm text-muted-foreground mt-1\">\r\n              {formatCurrency(stats?.matchedAmount || 0)}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <AlertCircle className=\"h-4 w-4\" />\r\n              Partial\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-amber-600 dark:text-amber-200\">{stats?.partiallyMatched || stats?.partially_matched || 0}</div>\r\n            <div className=\"text-sm text-muted-foreground mt-1\">\r\n              {formatCurrency(partialRemainingAmount || 0)}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <Clock className=\"h-4 w-4\" />\r\n              Unmatched\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-rose-600 dark:text-rose-200\">{stats?.unmatched || 0}</div>\r\n            <div className=\"text-sm text-muted-foreground mt-1\">\r\n              {formatCurrency(stats?.unmatchedAmount || 0)}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <Search className=\"h-4 w-4\" />\r\n              Suggested Matches\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-200\">{stats?.suggestedMatchesCount || 0}</div>\r\n            <div className=\"text-sm text-muted-foreground mt-1\">Ready for review</div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n        {/* Transactions Tab */}\r\n        <TabsContent value=\"transactions\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <CardTitle>All Transactions</CardTitle>\r\n                  <CardDescription>\r\n                    {filteredTransactions.length} transaction{filteredTransactions.length !== 1 ? 's' : ''}\r\n                    {filteredTransactions.length !== rawData.length && ` (filtered from ${rawData.length})`}\r\n                  </CardDescription>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              {/* Search and Filters */}\r\n              <div className=\"flex gap-3\">\r\n                <div className=\"flex-1 relative\">\r\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                  <Input\r\n                    placeholder=\"Search by counterparty, invoice, investor, reference...\"\r\n                    value={quickSearch}\r\n                    onChange={(e) => setQuickSearch(e.target.value)}\r\n                    className=\"pl-10\"\r\n                  />\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    variant={statusFilter === '' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('')}\r\n                  >\r\n                    All\r\n                  </Button>\r\n                  <Button\r\n                    variant={statusFilter === 'unmatched' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('unmatched')}\r\n                  >\r\n                    Unmatched\r\n                  </Button>\r\n                  <Button\r\n                    variant={statusFilter === 'partially_matched' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('partially_matched')}\r\n                  >\r\n                    Partial\r\n                  </Button>\r\n                  <Button\r\n                    variant={statusFilter === 'matched' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('matched')}\r\n                  >\r\n                    Matched\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* DataTable */}\r\n              <TransactionsDataTable\r\n                columns={transactionColumns}\r\n                data={filteredTransactions}\r\n                pageSize={25}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Invoices Tab */}\r\n        <TabsContent value=\"invoices\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <CardTitle>All Fee Invoices</CardTitle>\r\n                  <CardDescription>\r\n                    {filteredInvoices.length} invoice{filteredInvoices.length !== 1 ? 's' : ''}\r\n                    {filteredInvoices.length !== invoices.length && ` (filtered from ${invoices.length})`}\r\n                  </CardDescription>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              {/* Search and Filters */}\r\n              <div className=\"flex gap-3\">\r\n                <div className=\"flex-1 relative\">\r\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                  <Input\r\n                    placeholder=\"Search by invoice number, investor, deal...\"\r\n                    value={quickSearch}\r\n                    onChange={(e) => setQuickSearch(e.target.value)}\r\n                    className=\"pl-10\"\r\n                  />\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    variant={statusFilter === '' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('')}\r\n                  >\r\n                    All\r\n                  </Button>\r\n                  <Button\r\n                    variant={statusFilter === 'sent' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('sent')}\r\n                  >\r\n                    Sent\r\n                  </Button>\r\n                  <Button\r\n                    variant={statusFilter === 'partially_paid' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('partially_paid')}\r\n                  >\r\n                    Partial\r\n                  </Button>\r\n                  <Button\r\n                    variant={statusFilter === 'paid' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('paid')}\r\n                  >\r\n                    Paid\r\n                  </Button>\r\n                  <Button\r\n                    variant={statusFilter === 'matched' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('matched')}\r\n                  >\r\n                    Matched\r\n                  </Button>\r\n                  <Button\r\n                    variant={statusFilter === 'unmatched' ? 'default' : 'outline'}\r\n                    size=\"sm\"\r\n                    onClick={() => setStatusFilter('unmatched')}\r\n                  >\r\n                    Unmatched\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* DataTable */}\r\n              <InvoicesDataTable\r\n                columns={invoiceColumns}\r\n                data={filteredInvoices}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport * as React from 'react'\r\nimport {\r\n  ColumnDef,\r\n  ColumnFiltersState,\r\n  SortingState,\r\n  VisibilityState,\r\n  flexRender,\r\n  getCoreRowModel,\r\n  getFilteredRowModel,\r\n  getSortedRowModel,\r\n  getPaginationRowModel,\r\n  useReactTable,\r\n} from '@tanstack/react-table'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport { ChevronLeft, ChevronRight, ChevronsLeft, ChevronsRight } from 'lucide-react'\r\n\r\ninterface DataTableProps<TData, TValue> {\r\n  columns: ColumnDef<TData, TValue>[]\r\n  data: TData[]\r\n  pageSize?: number\r\n}\r\n\r\nexport function TransactionsDataTable<TData, TValue>({\r\n  columns,\r\n  data,\r\n  pageSize = 25,\r\n}: DataTableProps<TData, TValue>) {\r\n  const [sorting, setSorting] = React.useState<SortingState>([{ id: 'value_date', desc: true }])\r\n  const [columnFilters, setColumnFilters] = React.useState<ColumnFiltersState>([])\r\n  const [columnVisibility, setColumnVisibility] = React.useState<VisibilityState>({})\r\n  const [pagination, setPagination] = React.useState({\r\n    pageIndex: 0,\r\n    pageSize,\r\n  })\r\n\r\n  const table = useReactTable({\r\n    data,\r\n    columns,\r\n    pageCount: Math.ceil(data.length / pagination.pageSize),\r\n    onSortingChange: setSorting,\r\n    onColumnFiltersChange: setColumnFilters,\r\n    getCoreRowModel: getCoreRowModel(),\r\n    getSortedRowModel: getSortedRowModel(),\r\n    getFilteredRowModel: getFilteredRowModel(),\r\n    getPaginationRowModel: getPaginationRowModel(),\r\n    onColumnVisibilityChange: setColumnVisibility,\r\n    onPaginationChange: setPagination,\r\n    state: {\r\n      sorting,\r\n      columnFilters,\r\n      columnVisibility,\r\n      pagination,\r\n    },\r\n  })\r\n\r\n  const currentPageRows = table.getRowModel().rows\r\n  const totalRows = table.getFilteredRowModel().rows.length\r\n  const pageCount = table.getPageCount()\r\n  const currentPage = pagination.pageIndex + 1\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Pagination Controls TOP */}\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-muted/50 border-b border-border\">\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          Showing <span className=\"font-medium text-foreground\">{pagination.pageIndex * pagination.pageSize + 1}</span> to{' '}\r\n          <span className=\"font-medium text-foreground\">{Math.min((pagination.pageIndex + 1) * pagination.pageSize, totalRows)}</span> of{' '}\r\n          <span className=\"font-medium text-foreground\">{totalRows}</span> transactions\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          <Select\r\n            value={`${pagination.pageSize}`}\r\n            onValueChange={(value) => {\r\n              setPagination(prev => ({ ...prev, pageSize: Number(value), pageIndex: 0 }))\r\n            }}\r\n          >\r\n            <SelectTrigger className=\"h-8 w-[100px]\">\r\n              <SelectValue placeholder={`${pagination.pageSize}`} />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"10\">10 rows</SelectItem>\r\n              <SelectItem value=\"25\">25 rows</SelectItem>\r\n              <SelectItem value=\"50\">50 rows</SelectItem>\r\n              <SelectItem value=\"100\">100 rows</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"h-8 w-8 disabled:opacity-30\"\r\n              onClick={() => table.setPageIndex(0)}\r\n              disabled={!table.getCanPreviousPage()}\r\n            >\r\n              <ChevronsLeft className=\"h-4 w-4 text-muted-foreground\" />\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"h-8 w-8 disabled:opacity-30\"\r\n              onClick={() => table.previousPage()}\r\n              disabled={!table.getCanPreviousPage()}\r\n            >\r\n              <ChevronLeft className=\"h-4 w-4 text-muted-foreground\" />\r\n            </Button>\r\n            <div className=\"flex items-center gap-1 px-3\">\r\n              <span className=\"text-sm text-muted-foreground\">\r\n                Page <span className=\"font-medium text-foreground\">{currentPage}</span> of <span className=\"font-medium text-foreground\">{pageCount}</span>\r\n              </span>\r\n            </div>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"h-8 w-8 disabled:opacity-30\"\r\n              onClick={() => table.nextPage()}\r\n              disabled={!table.getCanNextPage()}\r\n            >\r\n              <ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"h-8 w-8 disabled:opacity-30\"\r\n              onClick={() => table.setPageIndex(pageCount - 1)}\r\n              disabled={!table.getCanNextPage()}\r\n            >\r\n              <ChevronsRight className=\"h-4 w-4 text-muted-foreground\" />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"border border-border rounded-lg overflow-hidden bg-card\">\r\n        <Table>\r\n          <TableHeader>\r\n            {table.getHeaderGroups().map((headerGroup) => (\r\n              <TableRow key={headerGroup.id} className=\"border-b border-border bg-muted/50 hover:bg-muted/50\">\r\n                {headerGroup.headers.map((header) => {\r\n                  return (\r\n                    <TableHead key={header.id} className=\"text-foreground font-semibold\">\r\n                      {header.isPlaceholder\r\n                        ? null\r\n                        : flexRender(\r\n                            header.column.columnDef.header,\r\n                            header.getContext()\r\n                          )}\r\n                    </TableHead>\r\n                  )\r\n                })}\r\n              </TableRow>\r\n            ))}\r\n          </TableHeader>\r\n          <TableBody>\r\n            {currentPageRows.length ? (\r\n              currentPageRows.map((row) => (\r\n                <TableRow\r\n                  key={row.id}\r\n                  data-state={row.getIsSelected() && 'selected'}\r\n                  className=\"border-b border-border/50 hover:bg-muted/30 transition-colors\"\r\n                >\r\n                  {row.getVisibleCells().map((cell) => (\r\n                    <TableCell key={cell.id} className=\"py-4\">\r\n                      {flexRender(\r\n                        cell.column.columnDef.cell,\r\n                        cell.getContext()\r\n                      )}\r\n                    </TableCell>\r\n                  ))}\r\n                </TableRow>\r\n              ))\r\n            ) : (\r\n              <TableRow>\r\n                <TableCell\r\n                  colSpan={columns.length}\r\n                  className=\"h-24 text-center text-muted-foreground\"\r\n                >\r\n                  No transactions found.\r\n                </TableCell>\r\n              </TableRow>\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n\r\n      {/* Pagination Controls BOTTOM */}\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-muted/50 border-t border-border\">\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          Page {currentPage} of {pageCount}\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => table.setPageIndex(0)}\r\n            disabled={!table.getCanPreviousPage()}\r\n          >\r\n            First\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => table.previousPage()}\r\n            disabled={!table.getCanPreviousPage()}\r\n          >\r\n            Previous\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => table.nextPage()}\r\n            disabled={!table.getCanNextPage()}\r\n          >\r\n            Next\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => table.setPageIndex(pageCount - 1)}\r\n            disabled={!table.getCanNextPage()}\r\n          >\r\n            Last\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","'use client'\n\nimport { ColumnDef } from '@tanstack/react-table'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport { ArrowUpDown, Eye, CheckCircle2, AlertCircle, HelpCircle, FileText, Users } from 'lucide-react'\nimport Link from 'next/link'\n\nexport type InvoiceSummary = {\n  id: string\n  invoice_number: string | null\n  total: number | null\n  paid_amount: number | null\n  balance_due: number | null\n  status: string\n  match_status: string | null\n  currency: string | null\n  investor?: {\n    id: string\n    legal_name: string | null\n  }\n  deal?: {\n    id: string\n    name: string | null\n  }\n}\n\nexport type TransactionMatchRow = {\n  id: string\n  invoice_id: string\n  match_type: string\n  matched_amount: number\n  match_confidence: number | null\n  match_reason: string | null\n  status: string\n  approved_at: string | null\n  invoices?: InvoiceSummary\n}\n\nexport type TransactionSuggestionRow = {\n  id: string\n  invoice_id: string\n  confidence: number | null\n  match_reason: string | null\n  amount_difference: number | null\n  created_at: string\n  invoices?: InvoiceSummary\n}\n\nexport type BankTransactionRow = {\n  id: string\n  value_date: string\n  amount: number\n  currency: string\n  counterparty: string\n  memo: string | null\n  account_ref: string | null\n  bank_reference: string | null\n  status: 'matched' | 'partially_matched' | 'unmatched'\n  match_confidence: number | null\n  match_notes: string | null\n  matched_invoice_ids: string[] | null\n  matched_amount_total?: number\n  remaining_amount?: number\n  created_at: string\n  updated_at: string\n  matches?: TransactionMatchRow[]\n  suggestions?: TransactionSuggestionRow[]\n}\n\nconst getStatusBadge = (status: string) => {\n  const variants = {\n    matched: { color: 'bg-emerald-900/30 text-emerald-300 border-emerald-700', icon: CheckCircle2, label: 'Matched' },\n    partially_matched: { color: 'bg-amber-900/30 text-amber-300 border-amber-700', icon: AlertCircle, label: 'Partial' },\n    unmatched: { color: 'bg-slate-800/50 text-slate-300 border-slate-700', icon: HelpCircle, label: 'Unmatched' }\n  }\n  const variant = variants[status as keyof typeof variants] || variants.unmatched\n  const Icon = variant.icon\n\n  return (\n    <Badge className={`${variant.color} gap-1.5`}>\n      <Icon className=\"h-3 w-3\" />\n      {variant.label}\n    </Badge>\n  )\n}\n\nconst getConfidenceBadge = (confidence: number | null) => {\n  if (confidence === null || confidence === undefined) return null\n\n  const color = confidence >= 80\n    ? 'bg-emerald-900/30 text-emerald-300 border-emerald-700'\n    : confidence >= 60\n    ? 'bg-amber-900/30 text-amber-300 border-amber-700'\n    : 'bg-rose-900/30 text-rose-300 border-rose-700'\n\n  return (\n    <Badge className={color}>\n      {confidence}% match\n    </Badge>\n  )\n}\n\nconst formatCurrency = (amount: number, currency: string) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: currency || 'USD',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(amount)\n}\n\nconst formatDate = (dateString: string) => {\n  return new Date(dateString).toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\nconst buildInvoiceLabel = (invoice?: InvoiceSummary | null) => {\n  if (!invoice) return 'Invoice'\n  if (invoice.invoice_number) return invoice.invoice_number\n  return `Invoice ${invoice.id.slice(0, 8)}`\n}\n\nconst renderInvoiceLine = (match: TransactionMatchRow) => {\n  const invoice = match.invoices\n  const label = buildInvoiceLabel(invoice)\n  const investor = invoice?.investor?.legal_name\n  const deal = invoice?.deal?.name\n\n  return (\n    <div key={match.id} className=\"space-y-0.5\">\n      <div className=\"text-sm font-medium text-foreground flex items-center gap-2\">\n        <FileText className=\"h-3.5 w-3.5\" /> {label}\n        <Badge variant=\"outline\" className=\"border-white/10 text-xs capitalize\">\n          {match.match_type.replace('_', ' ')}\n        </Badge>\n      </div>\n      <div className=\"text-xs text-muted-foreground flex items-center gap-1\">\n        <span>{formatCurrency(match.matched_amount, invoice?.currency || 'USD')}</span>\n        {match.match_reason && <span className=\"text-muted-foreground/70\">• {match.match_reason}</span>}\n      </div>\n      {(investor || deal) && (\n        <div className=\"text-xs text-muted-foreground flex items-center gap-2\">\n          <Users className=\"h-3 w-3\" />\n          <span>{[investor, deal].filter(Boolean).join(' • ')}</span>\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst renderSuggestionSummary = (transaction: BankTransactionRow) => {\n  const suggestions = transaction.suggestions || []\n  if (!suggestions.length) {\n    return <span className=\"text-muted-foreground text-sm\">—</span>\n  }\n\n  const topSuggestion = suggestions[0]\n  const invoice = topSuggestion.invoices\n  const label = buildInvoiceLabel(invoice)\n  const investor = invoice?.investor?.legal_name\n\n  return (\n    <div className=\"space-y-1\">\n      <div className=\"text-sm font-medium text-amber-300\">\n        {label}\n        {suggestions.length > 1 && (\n          <span className=\"text-xs text-muted-foreground ml-2\">\n            +{suggestions.length - 1} more\n          </span>\n        )}\n      </div>\n      <div className=\"text-xs text-muted-foreground\">\n        {investor || 'Potential match'}\n      </div>\n      {getConfidenceBadge(topSuggestion.confidence)}\n    </div>\n  )\n}\n\nexport const transactionColumns: ColumnDef<BankTransactionRow>[] = [\n  {\n    id: 'value_date',\n    accessorKey: 'value_date',\n    header: ({ column }) => {\n      return (\n        <Button\n          variant=\"ghost\"\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\n          className=\"hover:bg-white/5 -ml-4\"\n        >\n          Date\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\n        </Button>\n      )\n    },\n    cell: ({ row }) => {\n      return (\n        <div className=\"font-medium text-foreground\">\n          {formatDate(row.original.value_date)}\n        </div>\n      )\n    },\n  },\n  {\n    id: 'counterparty',\n    accessorKey: 'counterparty',\n    header: ({ column }) => {\n      return (\n        <Button\n          variant=\"ghost\"\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\n          className=\"hover:bg-white/5 -ml-4\"\n        >\n          Counterparty\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\n        </Button>\n      )\n    },\n    cell: ({ row }) => {\n      const transaction = row.original\n      const firstMatch = transaction.matches?.[0]\n      const invoice = firstMatch?.invoices\n      const investor = invoice?.investor?.legal_name\n\n      return (\n        <div className=\"space-y-1\">\n          <div className=\"font-medium text-foreground\">{transaction.counterparty}</div>\n          {investor && (\n            <div className=\"text-xs text-emerald-300\">→ {investor}</div>\n          )}\n          {!investor && (transaction.suggestions?.length || 0) > 0 && (\n            <div className=\"text-xs text-amber-400\">{transaction.suggestions?.length} suggestion{(transaction.suggestions?.length || 0) > 1 ? 's' : ''}</div>\n          )}\n          {transaction.memo && (\n            <div className=\"text-xs text-muted-foreground truncate max-w-xs\">{transaction.memo}</div>\n          )}\n        </div>\n      )\n    },\n  },\n  {\n    id: 'amount',\n    accessorKey: 'amount',\n    header: ({ column }) => {\n      return (\n        <Button\n          variant=\"ghost\"\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\n          className=\"hover:bg-white/5 -ml-4\"\n        >\n          Amount\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\n        </Button>\n      )\n    },\n    cell: ({ row }) => {\n      const transaction = row.original\n      const isNegative = transaction.amount < 0\n\n      return (\n        <div className=\"space-y-1\">\n          <div className={`font-semibold ${isNegative ? 'text-rose-400' : 'text-foreground'}`}>\n            {formatCurrency(transaction.amount, transaction.currency)}\n          </div>\n          {typeof transaction.matched_amount_total === 'number' && transaction.matched_amount_total > 0 && (\n            <div className=\"text-xs text-emerald-300\">\n              Matched {formatCurrency(transaction.matched_amount_total, transaction.currency)}\n            </div>\n          )}\n          {typeof transaction.remaining_amount === 'number' && transaction.remaining_amount > 0 && (\n            <div className=\"text-xs text-amber-400\">\n              Remaining {formatCurrency(transaction.remaining_amount, transaction.currency)}\n            </div>\n          )}\n        </div>\n      )\n    },\n  },\n  {\n    id: 'matched_to',\n    header: 'Matched To',\n    cell: ({ row }) => {\n      const transaction = row.original\n\n      if (transaction.matches && transaction.matches.length > 0) {\n        return (\n          <div className=\"space-y-2\">\n            {transaction.matches.slice(0, 2).map(renderInvoiceLine)}\n            {transaction.matches.length > 2 && (\n              <div className=\"text-xs text-muted-foreground\">+{transaction.matches.length - 2} more matches</div>\n            )}\n          </div>\n        )\n      }\n\n      return renderSuggestionSummary(transaction)\n    },\n  },\n  {\n    id: 'status',\n    accessorKey: 'status',\n    header: ({ column }) => {\n      return (\n        <Button\n          variant=\"ghost\"\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\n          className=\"hover:bg-white/5 -ml-4\"\n        >\n          Status\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\n        </Button>\n      )\n    },\n    cell: ({ row }) => {\n      const transaction = row.original\n\n      return (\n        <div className=\"space-y-1.5\">\n          {getStatusBadge(transaction.status)}\n          {transaction.match_confidence && getConfidenceBadge(transaction.match_confidence)}\n          {transaction.match_notes && (\n            <div className=\"text-xs text-muted-foreground line-clamp-2\">\n              {transaction.match_notes}\n            </div>\n          )}\n        </div>\n      )\n    },\n  },\n  {\n    id: 'reference',\n    header: 'Reference',\n    cell: ({ row }) => {\n      const transaction = row.original\n\n      return (\n        <div className=\"space-y-1\">\n          {transaction.bank_reference && (\n            <div className=\"text-xs font-mono text-muted-foreground\">\n              {transaction.bank_reference}\n            </div>\n          )}\n          {transaction.account_ref && (\n            <div className=\"text-xs text-muted-foreground\">\n              {transaction.account_ref}\n            </div>\n          )}\n        </div>\n      )\n    },\n  },\n  {\n    id: 'actions',\n    header: 'Actions',\n    cell: ({ row }) => {\n      const transaction = row.original\n\n      return (\n        <Link href={`/versotech_main/reconciliation/${transaction.id}`}>\n          <Button variant=\"ghost\" size=\"sm\" className=\"hover:bg-white/5\">\n            <Eye className=\"h-4 w-4 mr-2\" />\n            View\n          </Button>\n        </Link>\n      )\n    },\n  },\n]\n","'use client'\r\n\r\nimport * as React from 'react'\r\nimport {\r\n  ColumnDef,\r\n  flexRender,\r\n  getCoreRowModel,\r\n  getSortedRowModel,\r\n  SortingState,\r\n  useReactTable,\r\n} from '@tanstack/react-table'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table'\r\n\r\ninterface InvoicesDataTableProps<TData, TValue> {\r\n  columns: ColumnDef<TData, TValue>[]\r\n  data: TData[]\r\n}\r\n\r\nexport function InvoicesDataTable<TData, TValue>({\r\n  columns,\r\n  data,\r\n}: InvoicesDataTableProps<TData, TValue>) {\r\n  const [sorting, setSorting] = React.useState<SortingState>([{ id: 'created_at', desc: true }])\r\n\r\n  const table = useReactTable({\r\n    data,\r\n    columns,\r\n    state: {\r\n      sorting,\r\n    },\r\n    onSortingChange: setSorting,\r\n    getCoreRowModel: getCoreRowModel(),\r\n    getSortedRowModel: getSortedRowModel(),\r\n  })\r\n\r\n  return (\r\n    <div className=\"rounded-md border border-white/10\">\r\n      <Table>\r\n        <TableHeader>\r\n          {table.getHeaderGroups().map((headerGroup) => (\r\n            <TableRow key={headerGroup.id} className=\"border-white/10 hover:bg-white/5\">\r\n              {headerGroup.headers.map((header) => {\r\n                return (\r\n                  <TableHead key={header.id} className=\"text-muted-foreground\">\r\n                    {header.isPlaceholder\r\n                      ? null\r\n                      : flexRender(\r\n                          header.column.columnDef.header,\r\n                          header.getContext()\r\n                        )}\r\n                  </TableHead>\r\n                )\r\n              })}\r\n            </TableRow>\r\n          ))}\r\n        </TableHeader>\r\n        <TableBody>\r\n          {table.getRowModel().rows?.length ? (\r\n            table.getRowModel().rows.map((row) => (\r\n              <TableRow\r\n                key={row.id}\r\n                data-state={row.getIsSelected() && 'selected'}\r\n                className=\"border-white/10 hover:bg-white/5\"\r\n              >\r\n                {row.getVisibleCells().map((cell) => (\r\n                  <TableCell key={cell.id}>\r\n                    {flexRender(cell.column.columnDef.cell, cell.getContext())}\r\n                  </TableCell>\r\n                ))}\r\n              </TableRow>\r\n            ))\r\n          ) : (\r\n            <TableRow>\r\n              <TableCell colSpan={columns.length} className=\"h-24 text-center text-muted-foreground\">\r\n                No invoices found.\r\n              </TableCell>\r\n            </TableRow>\r\n          )}\r\n        </TableBody>\r\n      </Table>\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { ColumnDef } from '@tanstack/react-table'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport { ArrowUpDown, FileText, CheckCircle2, AlertCircle, Clock, DollarSign } from 'lucide-react'\r\n\r\nexport type ReconciliationInvoiceRow = {\r\n  id: string\r\n  invoice_number: string | null\r\n  total: number\r\n  paid_amount: number\r\n  balance_due: number\r\n  status: string\r\n  match_status: string | null\r\n  currency: string | null\r\n  created_at: string\r\n  paid_at: string | null\r\n  investor?: {\r\n    id: string\r\n    legal_name: string | null\r\n  }\r\n  deal?: {\r\n    id: string\r\n    name: string | null\r\n  }\r\n  match_count?: number\r\n  transaction_count?: number\r\n}\r\n\r\nconst getStatusBadge = (status: string) => {\r\n  const variants: Record<string, { color: string; icon: any; label: string }> = {\r\n    paid: { color: 'bg-emerald-900/30 text-emerald-300 border-emerald-700', icon: CheckCircle2, label: 'Paid' },\r\n    partially_paid: { color: 'bg-amber-900/30 text-amber-300 border-amber-700', icon: Clock, label: 'Partial' },\r\n    sent: { color: 'bg-blue-900/30 text-blue-300 border-blue-700', icon: FileText, label: 'Sent' },\r\n    overdue: { color: 'bg-rose-900/30 text-rose-300 border-rose-700', icon: AlertCircle, label: 'Overdue' },\r\n    draft: { color: 'bg-slate-800/50 text-slate-300 border-slate-700', icon: Clock, label: 'Draft' },\r\n  }\r\n  const variant = variants[status] || variants.draft\r\n  const Icon = variant.icon\r\n  return (\r\n    <Badge className={`${variant.color} gap-1.5`}>\r\n      <Icon className=\"h-3 w-3\" />\r\n      {variant.label}\r\n    </Badge>\r\n  )\r\n}\r\n\r\nconst getMatchStatusBadge = (matchStatus: string | null) => {\r\n  if (!matchStatus) return null\r\n  const variants: Record<string, { color: string; label: string }> = {\r\n    matched: { color: 'bg-emerald-900/30 text-emerald-300 border-emerald-700', label: 'Matched' },\r\n    partially_matched: { color: 'bg-amber-900/30 text-amber-300 border-amber-700', label: 'Partial Match' },\r\n    unmatched: { color: 'bg-slate-800/50 text-slate-300 border-slate-700', label: 'Unmatched' },\r\n  }\r\n  const variant = variants[matchStatus] || variants.unmatched\r\n  return (\r\n    <Badge className={variant.color}>\r\n      {variant.label}\r\n    </Badge>\r\n  )\r\n}\r\n\r\nconst formatCurrency = (amount: number, currency: string | null) => {\r\n  return new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency: currency || 'USD',\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 2,\r\n  }).format(amount)\r\n}\r\n\r\nconst formatDate = (dateString: string) => {\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric'\r\n  })\r\n}\r\n\r\nexport const invoiceColumns: ColumnDef<ReconciliationInvoiceRow>[] = [\r\n  {\r\n    id: 'invoice_number',\r\n    accessorKey: 'invoice_number',\r\n    header: ({ column }) => {\r\n      return (\r\n        <Button\r\n          variant=\"ghost\"\r\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\r\n          className=\"hover:bg-white/5 -ml-4\"\r\n        >\r\n          Invoice #\r\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\r\n        </Button>\r\n      )\r\n    },\r\n    cell: ({ row }) => {\r\n      const invoice = row.original\r\n      const invoiceNumber = invoice.invoice_number || `INV-${invoice.id.slice(0, 8)}`\r\n      return (\r\n        <div className=\"space-y-1\">\r\n          <div className=\"font-medium text-foreground flex items-center gap-2\">\r\n            <FileText className=\"h-3.5 w-3.5\" />\r\n            {invoiceNumber}\r\n          </div>\r\n          {invoice.deal?.name && (\r\n            <div className=\"text-xs text-muted-foreground\">{invoice.deal.name}</div>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n  },\r\n  {\r\n    id: 'investor',\r\n    header: 'Investor',\r\n    cell: ({ row }) => {\r\n      const investor = row.original.investor\r\n      return (\r\n        <div className=\"font-medium text-foreground\">\r\n          {investor?.legal_name || '—'}\r\n        </div>\r\n      )\r\n    },\r\n  },\r\n  {\r\n    id: 'created_at',\r\n    accessorKey: 'created_at',\r\n    header: ({ column }) => {\r\n      return (\r\n        <Button\r\n          variant=\"ghost\"\r\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\r\n          className=\"hover:bg-white/5 -ml-4\"\r\n        >\r\n          Created\r\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\r\n        </Button>\r\n      )\r\n    },\r\n    cell: ({ row }) => {\r\n      return (\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          {formatDate(row.original.created_at)}\r\n        </div>\r\n      )\r\n    },\r\n  },\r\n  {\r\n    id: 'total',\r\n    accessorKey: 'total',\r\n    header: ({ column }) => {\r\n      return (\r\n        <Button\r\n          variant=\"ghost\"\r\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\r\n          className=\"hover:bg-white/5 -ml-4\"\r\n        >\r\n          Total\r\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\r\n        </Button>\r\n      )\r\n    },\r\n    cell: ({ row }) => {\r\n      const invoice = row.original\r\n      return (\r\n        <div className=\"font-semibold text-foreground\">\r\n          {formatCurrency(invoice.total, invoice.currency)}\r\n        </div>\r\n      )\r\n    },\r\n  },\r\n  {\r\n    id: 'paid_amount',\r\n    accessorKey: 'paid_amount',\r\n    header: ({ column }) => {\r\n      return (\r\n        <Button\r\n          variant=\"ghost\"\r\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\r\n          className=\"hover:bg-white/5 -ml-4\"\r\n        >\r\n          Paid\r\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\r\n        </Button>\r\n      )\r\n    },\r\n    cell: ({ row }) => {\r\n      const invoice = row.original\r\n      const paidPct = invoice.total > 0 ? (invoice.paid_amount / invoice.total) * 100 : 0\r\n      return (\r\n        <div className=\"space-y-1\">\r\n          <div className={`text-sm font-medium ${invoice.paid_amount > 0 ? 'text-emerald-300' : 'text-muted-foreground'}`}>\r\n            {formatCurrency(invoice.paid_amount, invoice.currency)}\r\n          </div>\r\n          {paidPct > 0 && (\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              {paidPct.toFixed(0)}% paid\r\n            </div>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n  },\r\n  {\r\n    id: 'balance_due',\r\n    accessorKey: 'balance_due',\r\n    header: ({ column }) => {\r\n      return (\r\n        <Button\r\n          variant=\"ghost\"\r\n          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}\r\n          className=\"hover:bg-white/5 -ml-4\"\r\n        >\r\n          Balance Due\r\n          <ArrowUpDown className=\"ml-2 h-4 w-4\" />\r\n        </Button>\r\n      )\r\n    },\r\n    cell: ({ row }) => {\r\n      const invoice = row.original\r\n      return (\r\n        <div className={`font-medium ${invoice.balance_due > 0 ? 'text-amber-300' : 'text-muted-foreground'}`}>\r\n          {formatCurrency(invoice.balance_due, invoice.currency)}\r\n        </div>\r\n      )\r\n    },\r\n  },\r\n  {\r\n    id: 'status',\r\n    accessorKey: 'status',\r\n    header: 'Status',\r\n    cell: ({ row }) => {\r\n      const invoice = row.original\r\n      return (\r\n        <div className=\"space-y-1.5\">\r\n          {getStatusBadge(invoice.status)}\r\n          {invoice.paid_at && (\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              Paid {formatDate(invoice.paid_at)}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n  },\r\n  {\r\n    id: 'match_status',\r\n    header: 'Match Status',\r\n    cell: ({ row }) => {\r\n      const invoice = row.original\r\n      return (\r\n        <div className=\"space-y-1\">\r\n          {getMatchStatusBadge(invoice.match_status)}\r\n          {(invoice.match_count || 0) > 0 && (\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              {invoice.match_count} match{invoice.match_count === 1 ? '' : 'es'}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n  },\r\n]\r\n","'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { Upload, RefreshCw, Link, Check, X } from 'lucide-react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { toast } from 'sonner'\r\n\r\nexport function UploadCSVDialog() {\r\n  const [isOpen, setIsOpen] = useState(false)\r\n  const [file, setFile] = useState<File | null>(null)\r\n  const [isUploading, setIsUploading] = useState(false)\r\n  const router = useRouter()\r\n\r\n  const handleUpload = async () => {\r\n    if (!file) {\r\n      toast.error('Please select a file')\r\n      return\r\n    }\r\n\r\n    setIsUploading(true)\r\n    try {\r\n      const formData = new FormData()\r\n      formData.append('file', file)\r\n\r\n      const response = await fetch('/api/staff/reconciliation/upload', {\r\n        method: 'POST',\r\n        body: formData\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to upload CSV')\r\n      }\r\n\r\n      toast.success(data.message || `Imported ${data.imported} transactions`)\r\n      setIsOpen(false)\r\n      setFile(null)\r\n      router.refresh()\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to upload CSV')\r\n    } finally {\r\n      setIsUploading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n      <DialogTrigger asChild>\r\n        <Button variant=\"outline\">\r\n          <Upload className=\"h-4 w-4 mr-2\" />\r\n          Import Bank Data\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent>\r\n        <DialogHeader>\r\n          <DialogTitle>Import Bank Transactions</DialogTitle>\r\n        </DialogHeader>\r\n        <div className=\"space-y-4\">\r\n          <div>\r\n            <Label htmlFor=\"file\">CSV File</Label>\r\n            <Input\r\n              id=\"file\"\r\n              type=\"file\"\r\n              accept=\".csv\"\r\n              onChange={(e) => setFile(e.target.files?.[0] || null)}\r\n            />\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Expected columns: date, amount, counterparty (plus optional: currency, memo, reference)\r\n            </p>\r\n          </div>\r\n          <div className=\"flex justify-end gap-2\">\r\n            <Button variant=\"outline\" onClick={() => setIsOpen(false)} disabled={isUploading}>\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleUpload} disabled={!file || isUploading}>\r\n              {isUploading ? 'Uploading...' : 'Import'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport function AutoMatchButton() {\r\n  const [isRunning, setIsRunning] = useState(false)\r\n  const router = useRouter()\r\n\r\n  const handleAutoMatch = async () => {\r\n    setIsRunning(true)\r\n    try {\r\n      const response = await fetch('/api/staff/reconciliation/auto-match', {\r\n        method: 'POST'\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to run auto-match')\r\n      }\r\n\r\n      toast.success(data.message || `Found ${data.matches} suggested matches`)\r\n      router.refresh()\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to run auto-match')\r\n    } finally {\r\n      setIsRunning(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Button onClick={handleAutoMatch} disabled={isRunning}>\r\n      <RefreshCw className={`h-4 w-4 mr-2 ${isRunning ? 'animate-spin' : ''}`} />\r\n      Run Auto-Match\r\n    </Button>\r\n  )\r\n}\r\n\r\ninterface MatchActionsProps {\r\n  suggestedMatchId: string\r\n}\r\n\r\nexport function MatchActions({ suggestedMatchId }: MatchActionsProps) {\r\n  const [isProcessing, setIsProcessing] = useState(false)\r\n  const router = useRouter()\r\n\r\n  const handleAccept = async () => {\r\n    setIsProcessing(true)\r\n    try {\r\n      const response = await fetch('/api/staff/reconciliation/match/accept', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ suggested_match_id: suggestedMatchId })\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to accept match')\r\n      }\r\n\r\n      toast.success(data.message || 'Match accepted')\r\n      router.refresh()\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to accept match')\r\n    } finally {\r\n      setIsProcessing(false)\r\n    }\r\n  }\r\n\r\n  const handleReject = async () => {\r\n    setIsProcessing(true)\r\n    try {\r\n      const response = await fetch('/api/staff/reconciliation/match/reject', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ suggested_match_id: suggestedMatchId })\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to reject match')\r\n      }\r\n\r\n      toast.success(data.message || 'Match rejected')\r\n      router.refresh()\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to reject match')\r\n    } finally {\r\n      setIsProcessing(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex gap-2\">\r\n      <Button variant=\"outline\" size=\"sm\" onClick={handleAccept} disabled={isProcessing}>\r\n        <Check className=\"h-4 w-4 mr-1\" />\r\n        Accept\r\n      </Button>\r\n      <Button variant=\"outline\" size=\"sm\" onClick={handleReject} disabled={isProcessing}>\r\n        <X className=\"h-4 w-4 mr-1\" />\r\n        Reject\r\n      </Button>\r\n    </div>\r\n  )\r\n}\r\n\r\ninterface ResolveDiscrepancyDialogProps {\r\n  bankTransactionId: string\r\n}\r\n\r\nexport function ResolveDiscrepancyDialog({ bankTransactionId }: ResolveDiscrepancyDialogProps) {\r\n  const [isOpen, setIsOpen] = useState(false)\r\n  const [resolutionType, setResolutionType] = useState('')\r\n  const [notes, setNotes] = useState('')\r\n  const [isResolving, setIsResolving] = useState(false)\r\n  const router = useRouter()\r\n\r\n  const handleResolve = async () => {\r\n    setIsResolving(true)\r\n    try {\r\n      const response = await fetch('/api/staff/reconciliation/resolve', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          bank_transaction_id: bankTransactionId,\r\n          resolution_type: resolutionType,\r\n          notes\r\n        })\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to resolve discrepancy')\r\n      }\r\n\r\n      toast.success(data.message || 'Discrepancy resolved')\r\n      setIsOpen(false)\r\n      setResolutionType('')\r\n      setNotes('')\r\n      router.refresh()\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to resolve discrepancy')\r\n    } finally {\r\n      setIsResolving(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n      <DialogTrigger asChild>\r\n        <Button variant=\"outline\" size=\"sm\">\r\n          Resolve\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent>\r\n        <DialogHeader>\r\n          <DialogTitle>Resolve Discrepancy</DialogTitle>\r\n        </DialogHeader>\r\n        <div className=\"space-y-4\">\r\n          <div>\r\n            <Label>Resolution Type</Label>\r\n            <Select value={resolutionType} onValueChange={setResolutionType}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Select type\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"Bank Fee\">Bank Fee</SelectItem>\r\n                <SelectItem value=\"Wire Transfer Fee\">Wire Transfer Fee</SelectItem>\r\n                <SelectItem value=\"Currency Conversion\">Currency Conversion</SelectItem>\r\n                <SelectItem value=\"Partial Payment\">Partial Payment</SelectItem>\r\n                <SelectItem value=\"Amount Error\">Amount Error</SelectItem>\r\n                <SelectItem value=\"Duplicate Entry\">Duplicate Entry</SelectItem>\r\n                <SelectItem value=\"Other\">Other</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n          <div>\r\n            <Label>Notes</Label>\r\n            <Textarea\r\n              value={notes}\r\n              onChange={(e) => setNotes(e.target.value)}\r\n              placeholder=\"Explain the resolution...\"\r\n              rows={4}\r\n            />\r\n          </div>\r\n          <div className=\"flex justify-end gap-2\">\r\n            <Button variant=\"outline\" onClick={() => setIsOpen(false)} disabled={isResolving}>\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleResolve} disabled={!resolutionType || isResolving}>\r\n              {isResolving ? 'Resolving...' : 'Resolve'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}