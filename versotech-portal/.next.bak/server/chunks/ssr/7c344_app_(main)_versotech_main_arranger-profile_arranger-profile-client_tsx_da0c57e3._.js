module.exports=[575275,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(284169),e=a.i(15788),f=a.i(421908),g=a.i(663475),h=a.i(191675),i=a.i(249464),j=a.i(181608),k=a.i(278541),l=a.i(439467),m=a.i(231276),n=a.i(806640),o=a.i(816854),p=a.i(496392),q=a.i(399580),r=a.i(42329),s=a.i(838086),t=a.i(871057),u=a.i(405398),v=a.i(3321),w=a.i(752907),x=a.i(686331),y=a.i(158800),z=a.i(113276),A=a.i(823879),B=a.i(923251),C=a.i(478870),D=a.i(71459),E=a.i(201986),F=a.i(888987),G=a.i(899750),H=a.i(714814),I=a.i(354726),J=a.i(815917),K=a.i(737172),L=a.i(190321),M=a.i(468095),N=a.i(425622),O=a.i(134303),P=a.i(591808),Q=a.i(877918),R=a.i(325866);let S=[{label:"Certificate of Incorporation",value:"certificate_of_incorporation"},{label:"FCA Authorization Letter / SEC Form ADV",value:"regulatory_license"},{label:"Professional Indemnity Insurance",value:"insurance_certificate"},{label:"AML/CTF Policy Document",value:"aml_policy"},{label:"Latest Financial Statements",value:"financial_statements"},{label:"Beneficial Ownership Declaration",value:"beneficial_ownership"},{label:"Proof of Registered Address",value:"proof_of_address"}],T=[{label:"ID / Passport",value:"passport_id"},{label:"Proof of Address (Utility Bill)",value:"utility_bill"}];function U({arrangerId:a,arrangerName:h,kycStatus:i}){let[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(null),[u,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(i),[B,C]=(0,c.useState)("entity-level"),D=(0,c.useRef)({}),E=(0,c.useCallback)(async()=>{if(a){r(!0);try{let a=await fetch("/api/arrangers/me/documents");if(!a.ok)throw Error("Failed to fetch documents");let b=await a.json();k(b.documents||[]),m(b.members||[])}catch(a){console.error("Error fetching documents:",a),G.toast.error("Failed to load documents")}finally{r(!1)}}},[a]);(0,c.useEffect)(()=>{E()},[E]);let H=async(b,c,d)=>{if(a){if(b.size>0x3200000)return void G.toast.error("File size exceeds 50MB limit");if(!["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","image/jpeg","image/png","image/webp","text/plain"].includes(b.type))return void G.toast.error("Invalid file type. Please upload PDF, DOC, DOCX, JPG, PNG, or TXT files");t(d?`${c}_${d}`:c);try{let a=new FormData;a.append("file",b),a.append("type",c),a.append("name",b.name.replace(/\.[^/.]+$/,"")),d&&"entity-level"!==d&&a.append("arranger_user_id",d);let e=await fetch("/api/arrangers/me/documents",{method:"POST",body:a});if(!e.ok){let a=await e.json();throw Error(a.error||"Upload failed")}let f=[...S,...T].find(a=>a.value===c)?.label||c;G.toast.success(`${f} uploaded successfully`),await E()}catch(a){console.error("Upload error:",a),G.toast.error(a.message||"Failed to upload document")}finally{t(null);let a=d?`${c}_${d}`:c;D.current[a]&&(D.current[a].value="")}}},I=async a=>{if(confirm(`Delete "${a.name}"? This action cannot be undone.`)){w(a.id);try{let b=await fetch(`/api/arrangers/me/documents/${a.id}`,{method:"DELETE"});if(!b.ok){let a=await b.json();throw Error(a.error||"Delete failed")}G.toast.success("Document deleted successfully"),await E()}catch(a){console.error("Delete error:",a),G.toast.error(a.message||"Failed to delete document")}finally{w(null)}}},J=async a=>{try{let b=await fetch(`/api/documents/${a.id}/download`);if(!b.ok)throw Error("Download failed");let c=await b.blob(),d=window.URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=a.file_name||a.name,document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(d),document.body.removeChild(e),G.toast.success("Document downloaded")}catch(a){console.error("Download error:",a),G.toast.error("Failed to download document")}},K=a=>a?a<1024?`${a} B`:a<1048576?`${(a/1024).toFixed(1)} KB`:`${(a/1048576).toFixed(1)} MB`:"Unknown size",L=a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),U=j.filter(a=>S.some(b=>b.value===a.type)).length,V=Math.round(U/S.length*100),W=async()=>{y(!0);try{let a=await fetch("/api/arrangers/me/kyc-submission",{method:"POST",headers:{"Content-Type":"application/json"}}),b=await a.json();if(!a.ok)return void(b.details?.missing?G.toast.error(`Missing documents: ${b.details.missing.join(", ")}`):G.toast.error(b.error||"Failed to submit KYC"));A("pending"),G.toast.success("KYC documents submitted for review!")}catch(a){console.error("KYC submission error:",a),G.toast.error("Failed to submit KYC")}finally{y(!1)}},X=100===V&&"approved"!==z&&"pending"!==z;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:(0,F.cn)("h-10 w-10 rounded-full flex items-center justify-center",100===V?"bg-green-100":"bg-blue-100"),children:(0,b.jsx)(p.Shield,{className:(0,F.cn)("h-5 w-5",100===V?"text-green-600":"text-blue-600")})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"KYC Documents"}),(0,b.jsx)(d.CardDescription,{children:h?`Compliance documents for ${h}`:"Upload required compliance documents"})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-2xl font-bold text-foreground",children:[U,"/",S.length]}),z&&(0,b.jsxs)(e.Badge,{variant:"outline",className:(0,F.cn)("capitalize",(a=>{switch(a){case"approved":return"bg-green-100 text-green-800 border-green-200";case"pending":case"pending_review":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(z)),children:["KYC: ",z.replace("_"," ")]})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[V,"% complete"]})]})]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,b.jsx)("div",{className:(0,F.cn)("h-2.5 rounded-full transition-all duration-500",100===V?"bg-green-500":V>=50?"bg-yellow-500":"bg-blue-500"),style:{width:`${V}%`}})}),V<100&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Upload all required documents to complete KYC verification"}),100===V&&(0,b.jsx)("div",{className:"mt-4 pt-4 border-t",children:"pending"===z?(0,b.jsxs)("div",{className:"flex items-center gap-2 text-yellow-700 bg-yellow-50 px-4 py-3 rounded-lg",children:[(0,b.jsx)(v.Loader2,{className:"h-4 w-4 animate-spin"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"KYC documents are being reviewed..."})]}):"approved"===z?(0,b.jsxs)("div",{className:"flex items-center gap-2 text-green-700 bg-green-50 px-4 py-3 rounded-lg",children:[(0,b.jsx)(q.CheckCircle2,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"KYC verification complete"})]}):(0,b.jsx)(f.Button,{onClick:W,disabled:x||!X,className:"w-full",children:x?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Submitting..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Shield,{className:"h-4 w-4 mr-2"}),"Submit for Approval"]})})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-base",children:"Required Documents"}),(0,b.jsx)(d.CardDescription,{children:"These documents are required for regulatory compliance and KYC verification"})]}),(0,b.jsx)(d.CardContent,{children:n?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)(v.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,b.jsx)("div",{className:"space-y-3",children:S.map(a=>{let c=j.find(b=>b.type===a.value),d=s===a.value,e=u===c?.id;return(0,b.jsxs)("div",{className:(0,F.cn)("flex items-center justify-between gap-4 py-3 px-4 rounded-lg border transition-colors",c?"border-green-200 bg-green-50/50":"border-gray-200 hover:bg-gray-50"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[c?(0,b.jsx)(q.CheckCircle2,{className:"h-5 w-5 text-green-600 flex-shrink-0"}):(0,b.jsx)(P.Circle,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground truncate",children:a.label}),c&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[c.file_name," • ",K(c.file_size_bytes)," • ",L(c.created_at)]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 flex-shrink-0",children:c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>J(c),className:"h-8 w-8 p-0",title:"Download",children:(0,b.jsx)(N.Download,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>I(c),disabled:e,className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Delete",children:e?(0,b.jsx)(v.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(O.Trash2,{className:"h-4 w-4"})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Input,{ref:b=>{D.current[a.value]=b},type:"file",className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.webp,.txt",onChange:b=>{let c=b.target.files?.[0];c&&H(c,a.value)},disabled:d}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>D.current[a.value]?.click(),disabled:d,children:[d?(0,b.jsx)(v.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(M.Upload,{className:"h-4 w-4 mr-2"}),"Upload"]})]})})]},a.value)})})})]}),l.length>0&&(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(R.User,{className:"h-5 w-5"}),"Member KYC Documents"]}),(0,b.jsx)(d.CardDescription,{children:"Upload ID and Proof of Address for each member/director. Required for full KYC compliance."})]}),(0,b.jsx)(d.CardContent,{className:"space-y-6",children:l.map(a=>{let c=j.filter(b=>b.arranger_user_id===a.id);return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 pb-2 border-b",children:[(0,b.jsx)(R.User,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium text-sm",children:a.full_name}),(0,b.jsx)(e.Badge,{variant:"outline",className:"capitalize text-xs",children:a.role}),a.is_primary&&(0,b.jsx)(e.Badge,{variant:"secondary",className:"text-xs",children:"Primary"})]}),T.map(d=>{let e=c.find(a=>a.type===d.value),h=`${d.value}_${a.id}`,i=s===h,j=u===e?.id;return(0,b.jsxs)("div",{className:(0,F.cn)("flex items-center justify-between gap-4 py-2 px-3 rounded-lg border transition-colors ml-6",e?"border-green-200 bg-green-50/50":"border-gray-200 hover:bg-gray-50"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e?(0,b.jsx)(q.CheckCircle2,{className:"h-4 w-4 text-green-600 flex-shrink-0"}):(0,b.jsx)(P.Circle,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground truncate",children:d.label}),e&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[e.file_name," • ",K(e.file_size_bytes)," • ",L(e.created_at)]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 flex-shrink-0",children:e?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>J(e),className:"h-7 w-7 p-0",title:"Download",children:(0,b.jsx)(N.Download,{className:"h-3.5 w-3.5"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>I(e),disabled:j,className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Delete",children:j?(0,b.jsx)(v.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(O.Trash2,{className:"h-3.5 w-3.5"})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Input,{ref:a=>{D.current[h]=a},type:"file",className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.webp",onChange:b=>{let c=b.target.files?.[0];c&&H(c,d.value,a.id)},disabled:i}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>D.current[h]?.click(),disabled:i,className:"h-7 text-xs",children:[i?(0,b.jsx)(v.Loader2,{className:"h-3.5 w-3.5 mr-1 animate-spin"}):(0,b.jsx)(M.Upload,{className:"h-3.5 w-3.5 mr-1"}),"Upload"]})]})})]},h)})]},a.id)})})]}),j.filter(a=>!S.some(b=>b.value===a.type)&&!T.some(b=>b.value===a.type)).length>0&&(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-base",children:"Additional Documents"}),(0,b.jsx)(d.CardDescription,{children:"Other documents uploaded for compliance"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"space-y-2",children:j.filter(a=>!S.some(b=>b.value===a.type)).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 py-2 px-3 rounded-lg border hover:bg-gray-50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,b.jsx)(o.FileText,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground truncate",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[a.type," • ",K(a.file_size_bytes)," • ",L(a.created_at)]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>J(a),className:"h-8 w-8 p-0",children:(0,b.jsx)(N.Download,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>I(a),disabled:u===a.id,className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:u===a.id?(0,b.jsx)(v.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(O.Trash2,{className:"h-4 w-4"})})]})]},a.id))})})]}),(0,b.jsx)(d.Card,{className:"bg-blue-50/50 border-blue-200",children:(0,b.jsx)(d.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(Q.AlertCircle,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm space-y-1",children:[(0,b.jsx)("p",{className:"font-medium text-blue-900",children:"Document Requirements"}),(0,b.jsxs)("ul",{className:"text-blue-700 space-y-0.5",children:[(0,b.jsx)("li",{children:"• Supported formats: PDF, DOC, DOCX, JPG, PNG, TXT"}),(0,b.jsx)("li",{children:"• Maximum file size: 50MB per file"}),(0,b.jsx)("li",{children:"• Documents must be current and valid"}),(0,b.jsx)("li",{children:"• VERSO staff will review your documents for KYC approval"})]})]})]})})})]})}var V=a.i(466932),W=a.i(149159),X=a.i(410403);a.i(73475);var Y=a.i(108284),Z=a.i(99422),$=a.i(493469);let _={approved:"bg-green-100 text-green-800 border-green-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200",pending_review:"bg-yellow-100 text-yellow-800 border-yellow-200",rejected:"bg-red-100 text-red-800 border-red-200",expired:"bg-red-100 text-red-800 border-red-200",not_started:"bg-gray-100 text-gray-800 border-gray-200"},aa={active:"bg-green-100 text-green-800 border-green-200",inactive:"bg-gray-100 text-gray-800 border-gray-200",suspended:"bg-red-100 text-red-800 border-red-200"};function ab({label:a,value:c,field:d,isEditing:e,editValue:f,onChange:j,type:k="text",multiline:l=!1,icon:m,className:n}){return e?(0,b.jsxs)("div",{className:(0,F.cn)("space-y-1.5",n),children:[(0,b.jsx)(i.Label,{htmlFor:d,className:"text-sm font-medium text-muted-foreground",children:a}),l?(0,b.jsx)(h.Textarea,{id:d,value:f,onChange:a=>j(d,a.target.value),placeholder:`Enter ${a.toLowerCase()}`,rows:3,className:"mt-1"}):(0,b.jsx)(g.Input,{id:d,type:k,value:f,onChange:a=>j(d,a.target.value),placeholder:`Enter ${a.toLowerCase()}`,className:"mt-1"})]}):(0,b.jsxs)("div",{className:(0,F.cn)("flex items-start gap-3",n),children:[m&&(0,b.jsx)(m,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:a}),(0,b.jsx)("p",{className:(0,F.cn)("text-foreground mt-1","date"===k||d.includes("number")||d.includes("id")?"font-mono":"",l&&"whitespace-pre-line"),children:c||(0,b.jsx)("span",{className:"text-muted-foreground italic",children:"Not set"})})]})]})}function ac({userEmail:a,profile:g,arrangerInfo:h,arrangerUserInfo:i,dealCount:M}){let[N,O]=(0,c.useState)(h),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(!1),[T,ac]=(0,c.useState)(!1),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)(!1),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(!1),al=(0,c.useRef)(null),[am,an]=(0,c.useState)({legal_name:N?.legal_name||"",registration_number:N?.registration_number||"",tax_id:N?.tax_id||""}),[ao,ap]=(0,c.useState)({regulator:N?.regulator||"",license_number:N?.license_number||"",license_type:N?.license_type||"",license_expiry_date:N?.license_expiry_date||""}),[aq,ar]=(0,c.useState)({email:N?.email||"",phone:N?.phone||"",address:N?.address||""});if(!N)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(k.Building2,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Arranger Profile Not Found"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Unable to load your arranger profile. Please contact support."})]})});let as=()=>{if(!N.license_expiry_date)return!1;let a=new Date(N.license_expiry_date),b=new Date;return b.setDate(b.getDate()+30),a<=b&&a>new Date},at=()=>!!N.license_expiry_date&&new Date(N.license_expiry_date)<new Date,au=async()=>{ae(!0);try{let a=await fetch("/api/arrangers/me/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(am)});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to save")}O(a=>a?{...a,...am}:null),Q(!1),G.toast.success("Entity details updated successfully")}catch(a){console.error("Error saving entity:",a),G.toast.error(a.message||"Failed to save entity details")}finally{ae(!1)}},av=async()=>{ae(!0);try{let a=await fetch("/api/arrangers/me/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ao)});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to save")}O(a=>a?{...a,...ao}:null),S(!1),G.toast.success("Regulatory information updated successfully")}catch(a){console.error("Error saving regulatory:",a),G.toast.error(a.message||"Failed to save regulatory information")}finally{ae(!1)}},aw=async()=>{ae(!0);try{let a=await fetch("/api/arrangers/me/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(aq)});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to save")}O(a=>a?{...a,...aq}:null),ac(!1),G.toast.success("Contact information updated successfully")}catch(a){console.error("Error saving contact:",a),G.toast.error(a.message||"Failed to save contact information")}finally{ae(!1)}},ax=async a=>{let b=a.target.files?.[0];if(b){if(!["image/png","image/jpeg","image/webp"].includes(b.type))return void G.toast.error("Please upload a PNG, JPEG, or WebP image");if(b.size>2097152)return void G.toast.error("File size must be less than 2MB");ag(!0);try{let a=new FormData;a.append("logo",b);let c=await fetch("/api/arrangers/me/logo",{method:"POST",body:a});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to upload logo")}let d=await c.json();O(a=>a?{...a,logo_url:d.logo_url}:null),G.toast.success("Logo uploaded successfully")}catch(a){console.error("Error uploading logo:",a),G.toast.error(a.message||"Failed to upload logo")}finally{ag(!1),al.current&&(al.current.value="")}}};return(0,b.jsxs)("div",{className:"p-6 space-y-6 max-w-6xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"relative h-16 w-16 rounded-xl bg-primary/10 flex items-center justify-center cursor-pointer group overflow-hidden",onClick:()=>al.current?.click(),children:[N.logo_url?(0,b.jsx)(H.default,{src:N.logo_url,alt:N.legal_name,fill:!0,className:"object-cover"}):(0,b.jsx)(k.Building2,{className:"h-8 w-8 text-primary"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:af?(0,b.jsx)(v.Loader2,{className:"h-5 w-5 text-white animate-spin"}):(0,b.jsx)(B.Camera,{className:"h-5 w-5 text-white"})}),(0,b.jsx)("input",{ref:al,type:"file",accept:"image/png,image/jpeg,image/webp",className:"hidden",onChange:ax,disabled:af})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:N.legal_name}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:[g?.full_name||a," - ",i.role||"Member"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Badge,{variant:"outline",className:(0,F.cn)("capitalize",aa[N.status]||aa.inactive),children:N.status}),(0,b.jsxs)(e.Badge,{variant:"outline",className:(0,F.cn)("capitalize",_[N.kyc_status]||_.not_started),children:["KYC: ",N.kyc_status?.replace("_"," ")]})]})]}),as()&&(0,b.jsx)(d.Card,{className:"border-amber-500/30 bg-amber-50/50",children:(0,b.jsx)(d.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(s.AlertTriangle,{className:"h-5 w-5 text-amber-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-foreground",children:"License Expiring Soon"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Your license expires on ",(0,E.formatDate)(N.license_expiry_date),". Please renew before expiry."]})]})]})})}),at()&&(0,b.jsx)(d.Card,{className:"border-red-500/30 bg-red-50/50",children:(0,b.jsx)(d.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(s.AlertTriangle,{className:"h-5 w-5 text-red-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-foreground",children:"License Expired"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Your license expired on ",(0,E.formatDate)(N.license_expiry_date),". Please contact VERSO to renew."]})]})]})})}),"pending"===N.kyc_status&&(0,b.jsx)(d.Card,{className:"border-blue-500/30 bg-blue-50/50",children:(0,b.jsx)(d.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(r.Clock,{className:"h-5 w-5 text-blue-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-foreground",children:"KYC Verification Pending"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your KYC documents are being reviewed. This usually takes 1-2 business days."})]})]})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(t.Briefcase,{className:"h-4 w-4"}),"Mandates"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:M}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Deals managed"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(p.Shield,{className:"h-4 w-4"}),"KYC Status"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["approved"===N.kyc_status?(0,b.jsx)(q.CheckCircle2,{className:"h-5 w-5 text-green-600"}):"pending"===N.kyc_status?(0,b.jsx)(r.Clock,{className:"h-5 w-5 text-yellow-600"}):(0,b.jsx)(s.AlertTriangle,{className:"h-5 w-5 text-red-600"}),(0,b.jsx)("span",{className:"text-lg font-semibold capitalize",children:N.kyc_status?.replace("_"," ")})]}),N.kyc_approved_at&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Approved ",(0,E.formatDate)(N.kyc_approved_at)]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(o.FileText,{className:"h-4 w-4"}),"License"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-lg font-semibold",children:N.license_type||"Not specified"}),N.license_expiry_date&&(0,b.jsxs)("p",{className:(0,F.cn)("text-xs mt-1",at()?"text-red-600 font-medium":as()?"text-amber-600 font-medium":"text-muted-foreground"),children:["Expires ",(0,E.formatDate)(N.license_expiry_date)]})]})]})]}),(0,b.jsxs)(j.Tabs,{defaultValue:"details",className:"space-y-4",id:"arranger-profile-tabs",children:[(0,b.jsxs)(j.TabsList,{className:"grid w-full grid-cols-5 md:grid-cols-9 h-auto p-1 gap-1",children:[(0,b.jsxs)(j.TabsTrigger,{value:"details",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(k.Building2,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Entity"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"members",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(C.Users,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Members"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"entity-members",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(C.Users,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Directors/UBOs"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"regulatory",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(o.FileText,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Regulatory"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"contact",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(l.Mail,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Contact"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"documents",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(p.Shield,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"KYC"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"signature",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(w.PenTool,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Signature"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"security",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(x.Lock,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Security"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"preferences",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(y.Settings,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Preferences"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"privacy",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(p.Shield,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Privacy"})]}),(0,b.jsxs)(j.TabsTrigger,{value:"notices",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,b.jsx)(D.Bell,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Notices"})]})]}),(0,b.jsxs)(j.TabsContent,{value:"details",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Entity Details"}),(0,b.jsx)(d.CardDescription,{children:"Legal and registration information"})]}),P?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>{an({legal_name:N.legal_name||"",registration_number:N.registration_number||"",tax_id:N.tax_id||""}),Q(!1)},disabled:ad,children:[(0,b.jsx)(A.X,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,b.jsxs)(f.Button,{size:"sm",onClick:au,disabled:ad,children:[ad?(0,b.jsx)(v.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(z.Save,{className:"h-4 w-4 mr-2"}),"Save"]})]}):(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>Q(!0),children:[(0,b.jsx)(u.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]})]})}),(0,b.jsx)(d.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(ab,{label:"Legal Name",value:N.legal_name,field:"legal_name",isEditing:P,editValue:am.legal_name,onChange:(a,b)=>an(a=>({...a,legal_name:b}))}),(0,b.jsx)(ab,{label:"Registration Number",value:N.registration_number,field:"registration_number",isEditing:P,editValue:am.registration_number,onChange:(a,b)=>an(a=>({...a,registration_number:b}))}),(0,b.jsx)(ab,{label:"Tax ID",value:N.tax_id,field:"tax_id",isEditing:P,editValue:am.tax_id,onChange:(a,b)=>an(a=>({...a,tax_id:b}))}),N.created_at&&!P&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Member Since"}),(0,b.jsx)("p",{className:"text-foreground mt-1",children:(0,E.formatDate)(N.created_at)})]})]})})]}),"individual"===N.type&&(0,b.jsx)($.IndividualKycDisplay,{data:{first_name:N.first_name,middle_name:N.middle_name,last_name:N.last_name,name_suffix:N.name_suffix,date_of_birth:N.date_of_birth,country_of_birth:N.country_of_birth,nationality:N.nationality,email:N.email,phone_mobile:N.phone_mobile,phone_office:N.phone_office,residential_street:N.residential_street,residential_line_2:N.residential_line_2,residential_city:N.residential_city,residential_state:N.residential_state,residential_postal_code:N.residential_postal_code,residential_country:N.residential_country,is_us_citizen:N.is_us_citizen,is_us_taxpayer:N.is_us_taxpayer,us_taxpayer_id:N.us_taxpayer_id,country_of_tax_residency:N.country_of_tax_residency,id_type:N.id_type,id_number:N.id_number,id_issue_date:N.id_issue_date,id_expiry_date:N.id_expiry_date,id_issuing_country:N.id_issuing_country},onEdit:()=>ai(!0),title:"Personal KYC Information",className:"mt-6"})]}),(0,b.jsx)(j.TabsContent,{value:"members",children:(0,b.jsx)(V.MembersManagementTab,{entityType:"arranger",entityId:N.id,entityName:N.legal_name,showSignatoryOption:!0})}),(0,b.jsx)(j.TabsContent,{value:"entity-members",children:(0,b.jsx)(W.GenericEntityMembersTab,{entityType:"arranger",entityId:N.id,entityName:N.legal_name,apiEndpoint:"/api/arrangers/me/members",canManage:"admin"===i.role,title:"Directors, UBOs & Signatories",description:"Manage directors, beneficial owners (>25% ownership), and authorized signatories with full KYC information."})}),(0,b.jsx)(j.TabsContent,{value:"regulatory",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Regulatory Information"}),(0,b.jsx)(d.CardDescription,{children:"Licensing and compliance details"})]}),R?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>{ap({regulator:N.regulator||"",license_number:N.license_number||"",license_type:N.license_type||"",license_expiry_date:N.license_expiry_date||""}),S(!1)},disabled:ad,children:[(0,b.jsx)(A.X,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,b.jsxs)(f.Button,{size:"sm",onClick:av,disabled:ad,children:[ad?(0,b.jsx)(v.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(z.Save,{className:"h-4 w-4 mr-2"}),"Save"]})]}):(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>S(!0),children:[(0,b.jsx)(u.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]})]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(ab,{label:"Regulator",value:N.regulator,field:"regulator",isEditing:R,editValue:ao.regulator,onChange:(a,b)=>ap(a=>({...a,regulator:b}))}),(0,b.jsx)(ab,{label:"License Number",value:N.license_number,field:"license_number",isEditing:R,editValue:ao.license_number,onChange:(a,b)=>ap(a=>({...a,license_number:b}))}),(0,b.jsx)(ab,{label:"License Type",value:N.license_type,field:"license_type",isEditing:R,editValue:ao.license_type,onChange:(a,b)=>ap(a=>({...a,license_type:b}))}),(0,b.jsx)(ab,{label:"License Expiry",value:N.license_expiry_date?(0,E.formatDate)(N.license_expiry_date):null,field:"license_expiry_date",isEditing:R,editValue:ao.license_expiry_date,onChange:(a,b)=>ap(a=>({...a,license_expiry_date:b})),type:"date"})]}),(0,b.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,b.jsx)("h4",{className:"font-medium text-foreground mb-3",children:"KYC Verification (Read-only)"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,b.jsx)("div",{className:"flex items-center gap-2 mt-1",children:(0,b.jsx)(e.Badge,{variant:"outline",className:(0,F.cn)("capitalize",_[N.kyc_status]||_.not_started),children:N.kyc_status?.replace("_"," ")})})]}),N.kyc_approved_at&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Approved Date"}),(0,b.jsx)("p",{className:"text-foreground mt-1",children:(0,E.formatDate)(N.kyc_approved_at)})]}),N.kyc_expires_at&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"KYC Expiry"}),(0,b.jsx)("p",{className:(0,F.cn)("mt-1",(()=>{if(!N.kyc_expires_at)return!1;let a=new Date(N.kyc_expires_at),b=new Date;return b.setDate(b.getDate()+30),a<=b&&a>new Date})()?"text-amber-600 font-medium":"text-foreground"),children:(0,E.formatDate)(N.kyc_expires_at)})]})]})]})]})]})}),(0,b.jsx)(j.TabsContent,{value:"contact",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Contact Information"}),(0,b.jsx)(d.CardDescription,{children:"How to reach the arranger entity"})]}),T?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>{ar({email:N.email||"",phone:N.phone||"",address:N.address||""}),ac(!1)},disabled:ad,children:[(0,b.jsx)(A.X,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,b.jsxs)(f.Button,{size:"sm",onClick:aw,disabled:ad,children:[ad?(0,b.jsx)(v.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(z.Save,{className:"h-4 w-4 mr-2"}),"Save"]})]}):(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>ac(!0),children:[(0,b.jsx)(u.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]})]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(ab,{label:"Email",value:N.email,field:"email",isEditing:T,editValue:aq.email,onChange:(a,b)=>ar(a=>({...a,email:b})),type:"email",icon:T?void 0:l.Mail}),(0,b.jsx)(ab,{label:"Phone",value:N.phone,field:"phone",isEditing:T,editValue:aq.phone,onChange:(a,b)=>ar(a=>({...a,phone:b})),type:"tel",icon:T?void 0:m.Phone}),(0,b.jsx)(ab,{label:"Address",value:N.address,field:"address",isEditing:T,editValue:aq.address,onChange:(a,b)=>ar(a=>({...a,address:b})),multiline:!0,icon:T?void 0:n.MapPin,className:"md:col-span-2"})]}),!N.email&&!N.phone&&!N.address&&!T&&(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No contact information on file. Click Edit to add."})]})]})}),(0,b.jsx)(j.TabsContent,{value:"documents",children:(0,b.jsx)(U,{arrangerId:N.id,arrangerName:N.legal_name,kycStatus:N.kyc_status})}),(0,b.jsx)(j.TabsContent,{value:"signature",children:(0,b.jsx)(I.SignatureSpecimenTab,{})}),(0,b.jsx)(j.TabsContent,{value:"security",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Security Settings"}),(0,b.jsx)(d.CardDescription,{children:"Manage your account security and password"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(J.PasswordChangeForm,{})})]})}),(0,b.jsx)(j.TabsContent,{value:"preferences",children:(0,b.jsx)(K.PreferencesEditor,{variant:"arranger"})}),(0,b.jsx)(j.TabsContent,{value:"privacy",children:(0,b.jsx)(L.GDPRControls,{variant:"light"})}),(0,b.jsx)(j.TabsContent,{value:"notices",children:(0,b.jsx)(X.NoticeContactsTab,{apiEndpoint:"/api/arrangers/me/notice-contacts"})})]}),"individual"===N.type&&(0,b.jsx)(Y.EntityKYCEditDialog,{open:ah,onOpenChange:ai,entityType:"arranger",entityId:N.id,entityName:N.legal_name,initialData:{first_name:N.first_name??void 0,middle_name:N.middle_name??void 0,last_name:N.last_name??void 0,name_suffix:N.name_suffix??void 0,date_of_birth:N.date_of_birth??void 0,nationality:N.nationality??void 0,country_of_birth:N.country_of_birth??void 0,phone_mobile:N.phone_mobile??void 0,phone_office:N.phone_office??void 0,is_us_citizen:!0===N.is_us_citizen,is_us_taxpayer:!0===N.is_us_taxpayer,us_taxpayer_id:N.us_taxpayer_id??void 0,country_of_tax_residency:N.country_of_tax_residency??void 0,id_type:N.id_type??void 0,id_number:N.id_number??void 0,id_issue_date:N.id_issue_date??void 0,id_expiry_date:N.id_expiry_date??void 0,id_issuing_country:N.id_issuing_country??void 0,residential_street:N.residential_street??void 0,residential_city:N.residential_city??void 0,residential_state:N.residential_state??void 0,residential_postal_code:N.residential_postal_code??void 0,residential_country:N.residential_country??void 0},apiEndpoint:"/api/arrangers/me/profile",onSuccess:()=>window.location.reload()}),"individual"!==N.type&&(0,b.jsx)(Z.EntityAddressEditDialog,{open:aj,onOpenChange:ak,entityType:"arranger",entityName:N.legal_name,initialData:{address_line_1:N.address??"",email:N.email??"",phone:N.phone??"",phone_mobile:N.phone_mobile??"",phone_office:N.phone_office??""},apiEndpoint:"/api/arrangers/me/profile",onSuccess:()=>window.location.reload()})]})}a.s(["ArrangerProfileClient",()=>ac],575275)}];

//# sourceMappingURL=7c344_app_%28main%29_versotech_main_arranger-profile_arranger-profile-client_tsx_da0c57e3._.js.map