module.exports=[504112,a=>{"use strict";var b=a.i(352584),c=a.i(173434),d=a.i(257802);function e({dashboardData:a,realtimeMetrics:e}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(d.RealtimeStaffDashboard,{initialData:e}),(0,b.jsx)(c.EnhancedStaffDashboard,{initialData:a})]})}a.s(["CEODashboard",()=>e])},80276,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(520783),e=a.i(85514),f=a.i(58834),g=a.i(284169),h=a.i(15788),i=a.i(497412),j=a.i(714814),k=a.i(106720),l=a.i(317450),m=a.i(67018),n=a.i(421908),o=a.i(877028),p=a.i(211374),q=a.i(888987),r=a.i(324117),s=a.i(278541),t=a.i(176531),u=a.i(816854),v=a.i(871092),w=a.i(806640),x=a.i(142015),y=a.i(376515),z=a.i(325866);function A(){let{theme:a}=(0,e.useTheme)();return(0,b.jsxs)("div",{className:"space-y-8 animate-pulse",children:[(0,b.jsx)("div",{className:(0,q.cn)("rounded-3xl border p-8","staff-dark"===a?"border-white/10 bg-white/5":"border-slate-200/80 bg-white"),children:(0,b.jsxs)("div",{className:"grid gap-6 md:gap-8 md:grid-cols-[1.9fr,1fr]",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(p.Skeleton,{className:"h-16 w-16 rounded-full"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(p.Skeleton,{className:"h-4 w-24"}),(0,b.jsx)(p.Skeleton,{className:"h-8 w-48"}),(0,b.jsx)(p.Skeleton,{className:"h-4 w-64"})]})]}),(0,b.jsx)("div",{className:"grid gap-3 md:gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3",children:[1,2,3].map(a=>(0,b.jsx)(p.Skeleton,{className:"h-24 rounded-2xl"},a))})]}),(0,b.jsx)(p.Skeleton,{className:"h-48 rounded-2xl"})]})}),(0,b.jsx)("div",{className:"grid gap-6 md:grid-cols-3",children:[1,2,3].map(a=>(0,b.jsx)(p.Skeleton,{className:"h-64 rounded-2xl"},a))})]})}function B({vehicles:a}){let{theme:c}=(0,e.useTheme)(),d="staff-dark"===c,f=a.slice(0,4);return(0,b.jsxs)(g.Card,{className:(0,q.cn)("h-full overflow-hidden rounded-2xl border shadow-sm",d?"border-white/10 bg-card":"border-slate-200/80"),children:[(0,b.jsxs)(g.CardHeader,{className:"space-y-1.5 border-b p-6",children:[(0,b.jsx)(g.CardTitle,{className:(0,q.cn)("text-base font-semibold",d?"text-white":"text-slate-900"),children:"Portfolio snapshot"}),(0,b.jsx)(g.CardDescription,{className:(0,q.cn)("text-sm",d?"text-gray-400":"text-slate-600"),children:"At-a-glance view of the vehicles you're currently allocated to."})]}),(0,b.jsx)(g.CardContent,{className:"space-y-4 p-6",children:0===f.length?(0,b.jsx)("div",{className:(0,q.cn)("rounded-xl border border-dashed p-6 text-center text-sm",d?"border-white/10 bg-white/5 text-gray-400":"border-slate-200/80 bg-slate-50/80 text-slate-500"),children:"No active holdings yet. Allocations will appear here once your onboarding is complete."}):(0,b.jsx)("div",{className:"space-y-3",children:f.map(a=>{let c,e;return(0,b.jsxs)(i.default,{href:`/versotech_main/opportunities?vehicle=${a.id}`,className:(0,q.cn)("flex items-center justify-between gap-4 rounded-xl border p-4 transition-all hover:border-primary/40 hover:bg-primary/5",d?"border-white/10 bg-white/5":"border-slate-200/80 bg-white/90"),children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:(0,q.cn)("text-sm font-semibold",d?"text-white":"text-slate-900"),children:a.name}),(0,b.jsx)("p",{className:(0,q.cn)("text-xs",d?"text-gray-400":"text-slate-500"),children:(c=a.type?a.type.replace(/_/g," "):"Vehicle",e=a.domicile||a.currency||"Global",`${c} • ${e}`)})]}),(0,b.jsx)(r.ArrowUpRight,{className:"h-4 w-4 text-primary"})]},a.id)})})}),(0,b.jsxs)(g.CardFooter,{className:"flex flex-wrap items-center justify-between gap-3 border-t p-6",children:[(0,b.jsxs)(h.Badge,{variant:"outline",className:(0,q.cn)("rounded-full",d?"border-white/10 bg-white/5 text-gray-300":"border-slate-200/80 bg-slate-50 text-slate-600"),children:[a.length," vehicle",1===a.length?"":"s"," tracked"]}),(0,b.jsx)(i.default,{href:"/versotech_main/opportunities",children:(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",children:["Open holdings workspace",(0,b.jsx)(r.ArrowUpRight,{className:"ml-2 h-4 w-4"})]})})]})]})}function C(){let{theme:a}=(0,e.useTheme)(),c="staff-dark"===a;return(0,b.jsxs)(g.Card,{className:(0,q.cn)("h-full overflow-hidden rounded-2xl border shadow-sm",c?"border-white/10 bg-card":"border-slate-200/80"),children:[(0,b.jsxs)(g.CardHeader,{className:"space-y-1.5 border-b p-6",children:[(0,b.jsx)(g.CardTitle,{className:(0,q.cn)("text-base font-semibold",c?"text-white":"text-slate-900"),children:"VERSO concierge"}),(0,b.jsx)(g.CardDescription,{className:(0,q.cn)("text-sm",c?"text-gray-400":"text-slate-600"),children:"Direct access to deal rooms, bespoke reporting, and support."})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-3 p-6",children:[(0,b.jsx)(i.default,{href:"/versotech_main/opportunities",children:(0,b.jsxs)(n.Button,{className:(0,q.cn)("w-full justify-start rounded-xl border hover:border-primary/40 hover:bg-primary/5",c?"border-white/10 bg-white/5 text-gray-200":"border-slate-200/80 bg-white/80 text-slate-700"),variant:"outline",children:[(0,b.jsx)(v.Layers,{className:"mr-2 h-4 w-4"}),"Concluder™ Deal Room"]})}),(0,b.jsx)(i.default,{href:"/versotech_main/opportunities",children:(0,b.jsxs)(n.Button,{className:(0,q.cn)("w-full justify-start rounded-xl border hover:border-primary/40 hover:bg-primary/5",c?"border-white/10 bg-white/5 text-gray-200":"border-slate-200/80 bg-white/80 text-slate-700"),variant:"outline",children:[(0,b.jsx)(y.Target,{className:"mr-2 h-4 w-4"}),"Off-market opportunities"]})}),(0,b.jsx)(i.default,{href:"/versotech_main/documents",children:(0,b.jsxs)(n.Button,{className:(0,q.cn)("w-full justify-start rounded-xl border hover:border-primary/40 hover:bg-primary/5",c?"border-white/10 bg-white/5 text-gray-200":"border-slate-200/80 bg-white/80 text-slate-700"),variant:"outline",children:[(0,b.jsx)(u.FileText,{className:"mr-2 h-4 w-4"}),"Request position statement"]})}),(0,b.jsx)(i.default,{href:"/versotech_main/inbox",children:(0,b.jsxs)(n.Button,{className:(0,q.cn)("w-full justify-start rounded-xl border hover:border-primary/40 hover:bg-primary/5",c?"border-white/10 bg-white/5 text-gray-200":"border-slate-200/80 bg-white/80 text-slate-700"),variant:"outline",children:[(0,b.jsx)(x.MessageSquare,{className:"mr-2 h-4 w-4"}),"Custom analytics request"]})})]})]})}function D(){let{theme:a}=(0,e.useTheme)(),c="staff-dark"===a,d=[{id:"fund",title:"VERSO FUND",description:"BVI professional mutual fund access",icon:(0,b.jsx)(s.Building2,{className:"h-6 w-6"})},{id:"real-estate",title:"REAL Empire",description:"Institutional real estate securitisation",icon:(0,b.jsx)(y.Target,{className:"h-6 w-6"})},{id:"lux",title:"Luxembourg Platforms",description:"European investment infrastructure",icon:(0,b.jsx)(w.MapPin,{className:"h-6 w-6"})}];return(0,b.jsx)("section",{className:(0,q.cn)("rounded-3xl border px-8 py-10 shadow-sm",c?"border-white/10 bg-card":"border-slate-200/80 bg-white"),children:(0,b.jsxs)("div",{className:"mx-auto flex max-w-4xl flex-col gap-8",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-6 text-center sm:flex-row sm:items-start sm:text-left",children:[(0,b.jsx)("div",{className:(0,q.cn)("flex h-16 w-16 items-center justify-center rounded-2xl shadow-sm",c?"bg-white/10 text-white":"bg-slate-900 text-white"),children:(0,b.jsx)(s.Building2,{className:"h-7 w-7"})}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:(0,q.cn)("text-[11px] font-semibold uppercase tracking-wider",c?"text-gray-400":"text-slate-500"),children:"Investor onboarding"}),(0,b.jsx)("h2",{className:(0,q.cn)("text-3xl font-semibold",c?"text-white":"text-slate-900"),children:"Welcome to VERSO Holdings"}),(0,b.jsx)("p",{className:(0,q.cn)("text-sm",c?"text-gray-400":"text-slate-600"),children:"Complete your onboarding steps to unlock performance analytics, live deal access, and bespoke reporting matched to your mandate."})]})]}),(0,b.jsx)("div",{className:"grid gap-4 sm:grid-cols-3",children:d.map(a=>(0,b.jsxs)(g.Card,{className:(0,q.cn)("rounded-2xl border p-6 text-left shadow-sm",c?"border-white/10 bg-white/5":"border-slate-200/80 bg-slate-50/60"),children:[(0,b.jsx)("div",{className:(0,q.cn)("flex h-12 w-12 items-center justify-center rounded-xl shadow-sm",c?"bg-white/10 text-white":"bg-white text-slate-900"),children:a.icon}),(0,b.jsx)("h3",{className:(0,q.cn)("mt-4 text-sm font-semibold",c?"text-white":"text-slate-900"),children:a.title}),(0,b.jsx)("p",{className:(0,q.cn)("mt-1 text-xs",c?"text-gray-400":"text-slate-600"),children:a.description})]},a.id))}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-3 sm:flex-row sm:justify-end",children:[(0,b.jsx)(i.default,{href:"/versotech_main/tasks",className:"w-full sm:w-auto",children:(0,b.jsx)(n.Button,{size:"lg",className:"w-full sm:w-auto",children:"Complete onboarding"})}),(0,b.jsx)(i.default,{href:"/versotech_main/inbox",className:"w-full sm:w-auto",children:(0,b.jsx)(n.Button,{variant:"outline",size:"lg",className:"w-full sm:w-auto",children:"Contact VERSO team"})})]})]})})}function E({investorId:a,userId:d,persona:g}){let{theme:p}=(0,e.useTheme)(),u="staff-dark"===p,[v,x]=(0,c.useState)(null),[E,F]=(0,c.useState)(!0),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1);(0,c.useEffect)(()=>{v?.profile&&!v.profile.hasSeenIntroVideo&&J(!0)},[v?.profile]);let K=async()=>{try{if(!(await fetch("/api/profiles/intro-video-seen",{method:"POST",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to mark video as seen");v?.profile&&x({...v,profile:{...v.profile,hasSeenIntroVideo:!0}})}finally{J(!1)}};if((0,c.useEffect)(()=>{async function b(){F(!0),H(null);try{let b=(0,f.createClient)(),c=[a],[e,g,h,i,j,k]=await Promise.all([b.from("profiles").select("display_name, avatar_url, has_seen_intro_video").eq("id",d).single(),b.from("vehicles").select(`
              id,
              name,
              type,
              domicile,
              currency,
              subscriptions!inner(investor_id, status)
            `).in("subscriptions.investor_id",c).eq("subscriptions.status","active"),b.from("deals").select(`
              id,
              name,
              status,
              deal_type,
              currency,
              offer_unit_price,
              open_at,
              close_at,
              company_name,
              company_logo_url,
              sector,
              location,
              vehicles ( id, name, type ),
              deal_memberships!inner ( user_id ),
              deal_fee_structures ( id, price_per_share_text, allocation_up_to, minimum_ticket, status, effective_at )
            `).eq("deal_memberships.user_id",d).eq("status","open").order("close_at",{ascending:!0,nullsFirst:!1}).limit(3),b.from("tasks").select("id, title, status, priority, due_at, category",{count:"exact"}).not("status","eq","completed").not("status","eq","waived").or(`owner_user_id.eq.${d},owner_investor_id.in.(${c.join(",")})`).order("due_at",{ascending:!0,nullsFirst:!1}).limit(12),b.from("deal_activity_events").select(`
              id,
              event_type,
              payload,
              occurred_at,
              deal_id,
              deals:deal_id(name)
            `).in("investor_id",c).order("occurred_at",{ascending:!1}).limit(10),b.from("positions").select("id").in("investor_id",c).limit(1)]),l={im_interested:{title:"Expressed Interest",activity_type:"deal"},nda_completed:{title:"NDA Signed",activity_type:"document"},data_room_submit:{title:"Allocation Submitted",activity_type:"allocation"},subscription_completed:{title:"Subscription Completed",activity_type:"deal"},data_room_granted:{title:"Data Room Access",activity_type:"document"},closed_deal_interest:{title:"Interest Registered",activity_type:"deal"}},m=(j.data??[]).map(a=>{let b=l[a.event_type]||{title:a.event_type,activity_type:"deal"},c=a.deals?.name||"Deal",d=a.payload?.commitment||a.payload?.indicative_amount;return{id:a.id,title:b.title,description:d?`${c} - $${d.toLocaleString()}`:c,activity_type:b.activity_type,created_at:a.occurred_at,importance:"normal",read_status:null}}),n={high:0,medium:1,low:2},o=(i.data??[]).sort((a,b)=>{let c=n[a.priority]??99,d=n[b.priority]??99;return c!==d?c-d:a.due_at||b.due_at?a.due_at?b.due_at?new Date(a.due_at).getTime()-new Date(b.due_at).getTime():-1:1:0}),p=(h.data??[]).map(a=>{let b=(a.deal_fee_structures??[]).filter(a=>"published"===a.status).sort((a,b)=>{let c=a.effective_at?new Date(a.effective_at).getTime():0;return(b.effective_at?new Date(b.effective_at).getTime():0)-c})[0]??null;return{...a,fee_structure:b?{id:b.id,price_per_share_text:b.price_per_share_text,allocation_up_to:b.allocation_up_to,minimum_ticket:b.minimum_ticket}:null,deal_fee_structures:void 0}});x({profile:e.data?{displayName:e.data.display_name,avatarUrl:e.data.avatar_url,hasSeenIntroVideo:e.data.has_seen_intro_video??!0}:null,vehicles:g.data??[],featuredDeals:p,tasks:o,tasksTotal:i.count??o.length,recentActivity:m,hasPortfolioData:(k.data?.length??0)>0||(g.data?.length??0)>0})}catch(a){console.error("[InvestorDashboard] Error fetching data:",a),H("Failed to load dashboard data")}finally{F(!1)}}a&&d&&b()},[a,d]),E)return(0,b.jsx)(A,{});if(G||!v)return(0,b.jsxs)("div",{className:"p-8 text-center",children:[(0,b.jsx)("p",{className:"text-red-500",children:G||"Unable to load dashboard"}),(0,b.jsx)(n.Button,{variant:"outline",className:"mt-4",onClick:()=>window.location.reload(),children:"Retry"})]});let L=g?.entity_name||v.profile?.displayName||"Investor",M=(L||"Investor").split(" ")[0]||"Investor",N=[{label:"Open opportunities",value:v.featuredDeals.length,helper:"Available deals"},{label:"Outstanding tasks",value:v.tasksTotal,helper:v.tasksTotal?"Pending actions":"All caught up"},{label:"Active holdings",value:v.vehicles.length,helper:"Investment vehicles"}];return(0,b.jsxs)("div",{className:"space-y-12 px-0 pb-16 pt-2",children:[(0,b.jsx)(m.VideoIntroModal,{open:I,videoUrl:"https://ipguxdssecfexudnvtia.supabase.co/storage/v1/object/public/public-assets/videos/intro-video.mp4",onComplete:K}),(0,b.jsx)("section",{className:(0,q.cn)("rounded-3xl border p-4 sm:p-6 md:p-8 shadow-sm",u?"border-white/10 bg-card":"border-slate-200/80 bg-white"),children:(0,b.jsxs)("div",{className:"grid gap-6 md:gap-8 md:grid-cols-[1.9fr,1fr]",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:(0,q.cn)("flex h-16 w-16 items-center justify-center rounded-full border shadow-sm overflow-hidden",u?"bg-gradient-to-br from-white/10 to-white/5 border-white/10":"bg-gradient-to-br from-slate-100 to-slate-200 border-slate-200"),children:v.profile?.avatarUrl?(0,b.jsx)(j.default,{src:v.profile.avatarUrl,alt:L,width:64,height:64,className:"object-cover w-full h-full",priority:!0}):g.entity_logo_url?(0,b.jsx)(j.default,{src:g.entity_logo_url,alt:L,width:64,height:64,className:"object-cover w-full h-full",priority:!0}):(0,b.jsx)(z.User,{className:(0,q.cn)("h-8 w-8",u?"text-gray-400":"text-slate-400")})}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:(0,q.cn)("text-[11px] font-semibold uppercase tracking-wide",u?"text-gray-400":"text-slate-500"),children:"Investor portal"}),(0,b.jsxs)("h1",{className:(0,q.cn)("text-3xl font-semibold",u?"text-white":"text-slate-900"),children:["Welcome, ",M]}),(0,b.jsx)("p",{className:(0,q.cn)("text-sm",u?"text-gray-400":"text-slate-600"),children:"VERSO Holdings • Merchant Banking Group • Since 1958"})]})]})}),(0,b.jsx)("div",{className:"grid gap-3 md:gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3",children:N.map(a=>(0,b.jsxs)("div",{className:(0,q.cn)("rounded-2xl border p-4 shadow-sm",u?"border-white/10 bg-white/5":"border-slate-200/80 bg-slate-50/70"),children:[(0,b.jsx)("p",{className:(0,q.cn)("text-[11px] font-semibold uppercase tracking-wide",u?"text-gray-400":"text-slate-500"),children:a.label}),(0,b.jsx)("p",{className:(0,q.cn)("mt-2 text-2xl font-semibold",u?"text-white":"text-slate-900"),children:a.value}),(0,b.jsx)("p",{className:(0,q.cn)("mt-1 text-xs",u?"text-gray-400":"text-slate-600"),children:a.helper})]},a.label))}),(0,b.jsxs)("div",{className:(0,q.cn)("flex flex-wrap items-center gap-2 text-xs font-medium",u?"text-gray-400":"text-slate-600"),children:[(0,b.jsxs)(h.Badge,{variant:"outline",className:(0,q.cn)("rounded-full",u?"border-white/10 bg-white/5 text-gray-300":"border-slate-200/80 bg-slate-50 text-slate-600"),children:[(0,b.jsx)(w.MapPin,{className:"mr-1 h-3 w-3"})," Luxembourg HQ"]}),(0,b.jsxs)(h.Badge,{variant:"outline",className:(0,q.cn)("rounded-full",u?"border-white/10 bg-white/5 text-gray-300":"border-slate-200/80 bg-slate-50 text-slate-600"),children:[(0,b.jsx)(s.Building2,{className:"mr-1 h-3 w-3"})," BVI Professional Fund"]}),(0,b.jsxs)(h.Badge,{variant:"outline",className:(0,q.cn)("rounded-full",u?"border-white/10 bg-white/5 text-gray-300":"border-slate-200/80 bg-slate-50 text-slate-600"),children:[(0,b.jsx)(y.Target,{className:"mr-1 h-3 w-3"})," PE • VC • Real Estate"]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 pt-2 sm:flex-row",children:[(0,b.jsx)(i.default,{href:"/versotech_main/opportunities",className:"w-full sm:w-auto",children:(0,b.jsxs)(n.Button,{size:"sm",className:"w-full sm:w-auto",children:["View holdings",(0,b.jsx)(r.ArrowUpRight,{className:"ml-2 h-4 w-4"})]})}),(0,b.jsx)(i.default,{href:"/versotech_main/tasks",className:"w-full sm:w-auto",children:(0,b.jsxs)(n.Button,{size:"sm",variant:"outline",className:"w-full sm:w-auto",children:["Calendar & deadlines",(0,b.jsx)(t.CalendarClock,{className:"ml-2 h-4 w-4"})]})})]})]}),(0,b.jsxs)("div",{className:(0,q.cn)("rounded-2xl border p-6 shadow-sm",u?"border-white/10 bg-white/5":"border-slate-200/80 bg-slate-50/70"),children:[(0,b.jsx)("p",{className:(0,q.cn)("text-[11px] font-semibold uppercase tracking-wide",u?"text-gray-400":"text-slate-500"),children:"Portal snapshot"}),(0,b.jsx)("p",{className:(0,q.cn)("mt-3 text-2xl font-semibold",u?"text-white":"text-slate-900"),children:new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,b.jsx)(o.Separator,{className:"my-4"}),(0,b.jsx)("p",{className:(0,q.cn)("text-sm",u?"text-gray-400":"text-slate-600"),children:"Your investment dashboard with key metrics and upcoming deadlines."}),(0,b.jsxs)(i.default,{href:"/versotech_main/tasks",className:"mt-4 inline-flex items-center gap-2 text-xs font-semibold text-primary hover:underline",children:["Review action centre",(0,b.jsx)(r.ArrowUpRight,{className:"h-3 w-3"})]})]})]})}),(0,b.jsx)(l.FeaturedDealsSection,{deals:v.featuredDeals}),(0,b.jsx)(k.InvestorActionCenter,{tasks:v.tasks,tasksTotal:v.tasksTotal,recentActivity:v.recentActivity}),v.hasPortfolioData?(0,b.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,b.jsx)(B,{vehicles:v.vehicles}),(0,b.jsx)(C,{})]}):(0,b.jsx)(D,{}),v.hasPortfolioData&&(0,b.jsx)(C,{})]})}var F=a.i(716103),G=a.i(799373),H=a.i(478870),I=a.i(155508),J=a.i(203297),K=a.i(966494),L=a.i(347954),M=a.i(42329),N=a.i(399580),O=a.i(838086),P=a.i(50828),Q=a.i(3321),R=a.i(933838),S=a.i(190120),T=a.i(600900),U=a.i(823879),V=a.i(201986),W=a.i(948153);function X({introducerId:a,userId:d,persona:j}){let{theme:k}=(0,e.useTheme)(),l="staff-dark"===k,[m,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(null),[x,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(void 0);if((0,c.useEffect)(()=>{!async function(){try{let b=(0,f.createClient)(),{data:c}=await b.from("introductions").select("id, status, prospect_email, introduced_at, deal:deal_id(id, name)").eq("introducer_id",a).order("introduced_at",{ascending:!1}),d=c||[],e=d.filter(a=>{if(!A?.from)return!0;if(!a.introduced_at)return!1;let b=new Date(a.introduced_at),c=new Date(A.from);if(c.setHours(0,0,0,0),b<c)return!1;if(A.to){let a=new Date(A.to);if(a.setHours(23,59,59,999),b>a)return!1}return!0}),{data:g}=await b.from("introducer_commissions").select("id, accrual_amount, status, created_at, introduction_id").eq("introducer_id",a),h=(g||[]).filter(a=>{if(!A?.from)return!0;if(!a.created_at)return!1;let b=new Date(a.created_at),c=new Date(A.from);if(c.setHours(0,0,0,0),b<c)return!1;if(A.to){let a=new Date(A.to);if(a.setHours(23,59,59,999),b>a)return!1}return!0}),i=new Set(h.filter(a=>a.introduction_id).map(a=>a.introduction_id)),j=e.map(a=>{var b,c;let d;return{...a,journey_stage:(b=a.status,c=i.has(a.id),d=function(a){switch(a){case"allocated":return"signed";case"joined":return"approved";case"lost":case"inactive":return"passed";default:return"interested"}}(b),"allocated"===b&&c?"funded":d)}}),k=j.filter(a=>"interested"===a.journey_stage).length,l=j.filter(a=>"approved"===a.journey_stage).length,m=j.filter(a=>"signed"===a.journey_stage).length,n=j.filter(a=>"funded"===a.journey_stage).length,o=j.filter(a=>"passed"===a.journey_stage).length,p=h.filter(a=>"paid"===a.status).reduce((a,b)=>a+(b.accrual_amount||0),0),r=h.filter(a=>["accrued","invoice_requested","invoice_submitted","invoiced"].includes(a.status)).reduce((a,b)=>a+(b.accrual_amount||0),0);q({totalIntroductions:e.length,interestedIntroductions:k,approvedIntroductions:l,signedIntroductions:m,fundedIntroductions:n,passedIntroductions:o,totalCommissionEarned:p,pendingCommission:r,conversionRate:e.length>0?n/e.length*100:0});let t=new Date,v=new Date(t.getFullYear(),t.getMonth(),1),x=new Date(t.getFullYear(),t.getMonth()-1,1),y=e.filter(a=>a.introduced_at&&new Date(a.introduced_at)>=v).length,B=d.filter(a=>a.introduced_at&&new Date(a.introduced_at)>=x&&new Date(a.introduced_at)<v).length,C=B>0?Math.round((y-B)/B*100):100*(y>0),D=n>0?Math.round(p/n):0;s({thisMonthIntroductions:y,lastMonthIntroductions:B,introductionGrowth:C,avgCommissionPerIntro:D});let E=j.slice(0,5).map(a=>({id:a.id,prospect_email:a.prospect_email,status:a.journey_stage,introduced_at:a.introduced_at,deal:Array.isArray(a.deal)?a.deal[0]||null:a.deal}));z(E);let{data:F}=await b.from("introducer_agreements").select("id, status, default_commission_bps, effective_date, expiry_date, signed_date").eq("introducer_id",a).order("created_at",{ascending:!1});if(F){let a=F.find(a=>"active"===a.status),b=F.find(a=>["pending_approval","pending_ceo_signature","pending_introducer_signature"].includes(a.status));u(a||null),w(b||null)}}catch(a){console.error("Error fetching introducer data:",a)}finally{o(!1)}}()},[a,A]),m)return(0,b.jsxs)("div",{className:"p-8 text-center flex flex-col items-center gap-3",children:[(0,b.jsx)(Q.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Loading dashboard..."})]});let C={interested:"bg-blue-500/20 text-blue-400",approved:"bg-purple-500/20 text-purple-400",signed:"bg-amber-500/20 text-amber-400",funded:"bg-green-500/20 text-green-400",passed:"bg-gray-500/20 text-gray-400"};return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:"Introducer Dashboard"}),(0,b.jsx)("p",{className:`mt-1 ${l?"text-gray-400":"text-gray-600"}`,children:j.entity_name})]}),j.logo_url&&(0,b.jsx)("img",{src:j.logo_url,alt:j.entity_name,className:"h-12 w-auto object-contain"})]}),v&&(0,b.jsx)(g.Card,{className:`border-amber-500/30 ${l?"bg-amber-500/10":"bg-amber-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-amber-500/20",children:(0,b.jsx)(R.PenLine,{className:"h-5 w-5 text-amber-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:"pending_approval"===v.status?"Agreement Awaiting Your Approval":"pending_ceo_signature"===v.status||"approved"===v.status?"Agreement Awaiting CEO Signature":"Agreement Awaiting Your Signature"}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"pending_approval"===v.status?"Please review and approve your fee agreement":"pending_ceo_signature"===v.status||"approved"===v.status?"You have approved. Awaiting CEO signature.":"CEO has signed. Please countersign to activate."})]})]}),(0,b.jsx)(n.Button,{asChild:!0,children:(0,b.jsxs)(i.default,{href:`/versotech_main/introducer-agreements/${v.id}`,children:["pending_approval"===v.status?"Review":"pending_ceo_signature"===v.status||"approved"===v.status?"View":"Sign Now",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-2"})]})})]})})}),!t&&!v&&(0,b.jsx)(g.Card,{className:`border-red-500/30 ${l?"bg-red-500/10":"bg-red-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-red-500/20",children:(0,b.jsx)(O.AlertTriangle,{className:"h-5 w-5 text-red-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:"No Active Agreement"}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"You need an active fee agreement to make introductions. Contact your relationship manager."})]})]})})}),(0,b.jsx)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:(0,b.jsxs)(g.CardContent,{className:"py-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("p",{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-700"}`,children:"Filter by Date Range:"}),(0,b.jsx)(F.DateRangePicker,{value:A,onChange:B,variant:l?"dark":"default"})]}),A?.from&&(0,b.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:()=>B(void 0),className:l?"text-gray-400 hover:text-white":"",children:[(0,b.jsx)(U.X,{className:"h-4 w-4 mr-1"}),"Clear Filter"]})]}),A?.from&&(0,b.jsx)("p",{className:"text-xs mt-2 text-gray-500",children:A.to?`Showing data from ${(0,W.format)(A.from,"MMM dd, yyyy")} to ${(0,W.format)(A.to,"MMM dd, yyyy")}`:`Showing data from ${(0,W.format)(A.from,"MMM dd, yyyy")} onwards`}),!A?.from&&(0,b.jsx)("p",{className:"text-xs mt-2 text-gray-500",children:"Showing all-time data"})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Total Introductions"}),(0,b.jsx)(H.Users,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.totalIntroductions||0}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[p?.interestedIntroductions||0," interested"]})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Conversion Rate"}),(0,b.jsx)(K.TrendingUp,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsxs)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:[p?.conversionRate.toFixed(1)||0,"%"]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[p?.fundedIntroductions||0," funded"]})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Commission Earned"}),(0,b.jsx)(I.DollarSign,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-500",children:(0,V.formatCurrency)(p?.totalCommissionEarned||0)}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Total paid to date"})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Pending Commission"}),(0,b.jsx)(M.Clock,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-amber-500",children:(0,V.formatCurrency)(p?.pendingCommission||0)}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Accrued or awaiting approval"})]})]})]}),r&&(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)(g.CardTitle,{className:`flex items-center gap-2 ${l?"text-white":""}`,children:[(0,b.jsx)(S.BarChart3,{className:"h-5 w-5"}),"Performance Analytics"]}),(0,b.jsx)(g.CardDescription,{children:"Your introduction performance trends"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:`p-4 rounded-lg border ${l?"bg-white/5 border-white/10":"bg-muted/30"}`,children:[(0,b.jsxs)("div",{className:`flex items-center gap-2 text-sm mb-1 ${l?"text-gray-400":"text-muted-foreground"}`,children:[r.introductionGrowth>=0?(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-green-500"}):(0,b.jsx)(L.TrendingDown,{className:"h-4 w-4 text-red-500"}),"This Month"]}),(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:r.thisMonthIntroductions}),(0,b.jsxs)("p",{className:`text-xs mt-1 ${l?"text-gray-500":"text-muted-foreground"}`,children:[(0,b.jsxs)("span",{className:r.introductionGrowth>=0?"text-green-500":"text-red-500",children:[r.introductionGrowth>=0?"+":"",r.introductionGrowth,"%"]})," ","vs last month (",r.lastMonthIntroductions,")"]})]}),(0,b.jsxs)("div",{className:`p-4 rounded-lg border ${l?"bg-white/5 border-white/10":"bg-muted/30"}`,children:[(0,b.jsxs)("div",{className:`flex items-center gap-2 text-sm mb-1 ${l?"text-gray-400":"text-muted-foreground"}`,children:[(0,b.jsx)(y.Target,{className:"h-4 w-4"}),"Conversion Rate"]}),(0,b.jsxs)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:[p?.conversionRate.toFixed(1)||0,"%"]}),(0,b.jsxs)("p",{className:`text-xs mt-1 ${l?"text-gray-500":"text-muted-foreground"}`,children:[p?.fundedIntroductions||0," of ",p?.totalIntroductions||0," funded"]})]}),(0,b.jsxs)("div",{className:`p-4 rounded-lg border ${l?"bg-white/5 border-white/10":"bg-muted/30"}`,children:[(0,b.jsxs)("div",{className:`flex items-center gap-2 text-sm mb-1 ${l?"text-gray-400":"text-muted-foreground"}`,children:[(0,b.jsx)(T.Wallet,{className:"h-4 w-4"}),"Avg Commission"]}),(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:(0,V.formatCurrency)(r.avgCommissionPerIntro)}),(0,b.jsx)("p",{className:`text-xs mt-1 ${l?"text-gray-500":"text-muted-foreground"}`,children:"Per successful introduction"})]})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Recent Introductions"}),(0,b.jsx)(g.CardDescription,{children:"Your latest referrals"})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/introductions",children:["View All",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-1"})]})})]}),(0,b.jsx)(g.CardContent,{children:0===x.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(G.UserPlus,{className:`h-10 w-10 mx-auto mb-3 ${l?"text-gray-600":"text-gray-400"}`}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"No introductions yet"})]}):(0,b.jsx)("div",{className:"space-y-3",children:x.map(a=>(0,b.jsxs)("div",{className:`flex items-center justify-between p-3 rounded-lg ${l?"bg-white/5":"bg-gray-50"}`,children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:a.prospect_email}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:a.deal?.name||"Unknown Deal"})]}),(0,b.jsx)(h.Badge,{className:C[a.status]||"bg-gray-500/20 text-gray-400",children:a.status})]},a.id))})})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Fee Agreement"}),(0,b.jsx)(g.CardDescription,{children:"Your current commission terms"})]}),(0,b.jsx)(g.CardContent,{children:t?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(N.CheckCircle2,{className:"h-5 w-5 text-green-500"}),(0,b.jsx)("span",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:"Active Agreement"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Commission Rate"}),(0,b.jsx)("p",{className:`text-lg font-semibold ${l?"text-white":"text-gray-900"}`,children:t.default_commission_bps?`${(t.default_commission_bps/100).toFixed(2)}%`:"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Effective Since"}),(0,b.jsx)("p",{className:`text-lg font-semibold ${l?"text-white":"text-gray-900"}`,children:t.effective_date?(0,V.formatDate)(t.effective_date):"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Expires"}),(0,b.jsx)("p",{className:`text-lg font-semibold ${l?"text-white":"text-gray-900"}`,children:t.expiry_date?(0,V.formatDate)(t.expiry_date):"No Expiry"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Signed"}),(0,b.jsx)("p",{className:`text-lg font-semibold ${l?"text-white":"text-gray-900"}`,children:t.signed_date?(0,V.formatDate)(t.signed_date):"N/A"})]})]}),(0,b.jsx)(n.Button,{variant:"outline",size:"sm",asChild:!0,className:"w-full",children:(0,b.jsxs)(i.default,{href:`/versotech_main/introducer-agreements/${t.id}`,children:[(0,b.jsx)(J.FileSignature,{className:"h-4 w-4 mr-2"}),"View Agreement"]})})]}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(J.FileSignature,{className:`h-10 w-10 mx-auto mb-3 ${l?"text-gray-600":"text-gray-400"}`}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"No active agreement"}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"} mt-1`,children:"Contact your relationship manager to set up an agreement"})]})})]})]})]})}var Y=a.i(871057),Z=a.i(264890),$=a.i(455964),_=a.i(787957),aa=a.i(625473),ab=a.i(899750);let ac={subscription:"Subscription Fee",management:"Management Fee",performance:"Performance Fee",flat:"Flat Fee"},ad=["subscription","management","performance"],ae={draft:"Draft",sent:"Pending Approval",pending_signature:"Pending Signature",accepted:"Accepted",rejected:"Rejected"},af={accepted:"bg-green-500/20 text-green-400 border-green-500/30",rejected:"bg-red-500/20 text-red-400 border-red-500/30",sent:"bg-amber-500/20 text-amber-400 border-amber-500/30",pending_signature:"bg-amber-500/20 text-amber-400 border-amber-500/30",draft:"bg-slate-500/20 text-slate-300 border-slate-500/30"};function ag(a){if(!a)return"—";if(null!==a.rate_bps&&void 0!==a.rate_bps){let b=Number(a.rate_bps);if(!Number.isNaN(b))return`${b/100}%`}if(null!==a.flat_amount&&void 0!==a.flat_amount){let b=Number(a.flat_amount);if(!Number.isNaN(b))return(0,V.formatCurrency)(b)}return"—"}function ah(){let[a,d]=(0,c.useState)(!0),[e,f]=(0,c.useState)(null),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(null);(0,c.useEffect)(()=>{!async function(){try{d(!0),f(null);let a=await fetch("/api/partners/me/fee-models"),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to load fee models");j(b.fee_models||[])}catch(a){console.error("Error fetching fee models:",a),f(a instanceof Error?a.message:"Failed to load fee models")}finally{d(!1)}}()},[]);let m=async(a,b)=>{let c="reject"===b?prompt("Please provide a rejection reason:"):null;if("reject"!==b||c){l(a);try{var d;let e=await fetch(`/api/fee-plans/${a}/${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:"reject"===b?JSON.stringify({reason:c}):void 0}),f=await e.json();if(!e.ok)throw Error(f.error||`Failed to ${b} fee model`);d="accept"===b?"accepted":"rejected",j(b=>b.map(b=>b.id===a?{...b,status:d}:b)),ab.toast.success("accept"===b?"Fee model approved":"Fee model rejected")}catch(a){console.error(`Error during ${b}:`,a),ab.toast.error(a instanceof Error?a.message:`Failed to ${b} fee model`)}finally{l(null)}}};return(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(J.FileSignature,{className:"h-5 w-5"}),"Fee Models"]}),(0,b.jsx)(g.CardDescription,{children:"Read-only fee structures that apply to you"})]}),(0,b.jsx)(g.CardContent,{children:a?(0,b.jsxs)("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:[(0,b.jsx)(Q.Loader2,{className:"h-5 w-5 animate-spin mr-2"}),"Loading fee models..."]}):e?(0,b.jsx)("div",{className:"text-sm text-red-500",children:e}):0===i.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)("p",{children:"No fee models assigned"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:"Contact your relationship manager for fee structure details"})]}):(0,b.jsx)("div",{className:"space-y-4",children:i.map(a=>{let c=(a.fee_components||[]).filter(a=>!ad.includes(a.kind)),d=a.status||"draft",e=ae[d]||d,f=af[d]||af.draft;return(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.deal?.name?`Deal: ${a.deal.name}`:a.description||"General fee model"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,b.jsx)(h.Badge,{variant:a.is_active?"default":"secondary",children:a.is_active?"Active":"Inactive"}),(0,b.jsx)(h.Badge,{variant:"outline",className:f,children:e})]})]}),(0,b.jsx)("div",{className:"mt-4 grid gap-3 sm:grid-cols-3",children:ad.map(c=>(0,b.jsxs)("div",{className:"rounded-md border px-3 py-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:ac[c]}),(0,b.jsx)("p",{className:"text-sm font-medium",children:ag(a.fee_components.find(a=>a.kind===c))})]},c))}),c.length>0&&(0,b.jsx)("div",{className:"mt-3 flex flex-wrap gap-2 text-xs text-muted-foreground",children:c.map(a=>(0,b.jsxs)(h.Badge,{variant:"outline",children:[ac[a.kind]||a.kind,":"," ",ag(a)]},a.id))}),"sent"===d&&(0,b.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2",children:[(0,b.jsx)(n.Button,{size:"sm",onClick:()=>m(a.id,"accept"),disabled:k===a.id,className:"bg-emerald-600 hover:bg-emerald-700",children:k===a.id?(0,b.jsx)(Q.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Approve"]})}),(0,b.jsx)(n.Button,{size:"sm",variant:"destructive",onClick:()=>m(a.id,"reject"),disabled:k===a.id,children:k===a.id?(0,b.jsx)(Q.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(aa.XCircle,{className:"h-4 w-4 mr-2"}),"Reject"]})})]})]},a.id)})})})]})}function ai({partnerId:a,userId:d,persona:e}){let[f,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(null),[m,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)([]);if((0,c.useEffect)(()=>{async function b(){try{j(!0),l(null);let a=await fetch("/api/partners/me/dashboard"),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to load partner dashboard");o(b.metrics),q(b.performance||null),s(b.recent_referrals||[])}catch(a){console.error("Error fetching partner dashboard data:",a),l(a instanceof Error?a.message:"Failed to load partner dashboard")}finally{j(!1)}}a&&d&&b()},[a,d]),f)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)(Q.Loader2,{className:"h-8 w-8 animate-spin text-primary"})});if(k)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Partner Dashboard"}),(0,b.jsx)(g.CardDescription,{children:k})]})})});let t=m?.commitmentCurrency||"USD",u=m?.pendingCommissionCurrency||"USD";return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold",children:["Welcome back, ",e.entity_name]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Partner Dashboard - Track your referrals and investment opportunities"})]}),(0,b.jsx)(i.default,{href:"/versotech_main/opportunities",children:(0,b.jsxs)(n.Button,{children:[(0,b.jsx)(K.TrendingUp,{className:"mr-2 h-4 w-4"}),"View Opportunities"]})})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsx)(i.default,{href:"/versotech_main/opportunities",className:"block",children:(0,b.jsxs)(g.Card,{className:"h-full hover:border-foreground/20 transition-colors",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Deals Available"}),(0,b.jsx)(Y.Briefcase,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:m?.investableDeals||0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m?.trackedDeals||0," tracking"]})]})]})}),(0,b.jsx)(i.default,{href:"/versotech_main/partner-transactions",className:"block",children:(0,b.jsxs)(g.Card,{className:"h-full hover:border-foreground/20 transition-colors",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Referred Investors"}),(0,b.jsx)(H.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:m?.totalReferredInvestors||0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m?.subscribedInvestors||0," subscribed, ",m?.pipelineInvestors||0," in pipeline"]})]})]})}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Total Referred Amount"}),(0,b.jsx)(I.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:(0,V.formatCurrency)(m?.totalCommitment||0,t)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Committed by referred investors"})]})]}),(0,b.jsx)(i.default,{href:"/versotech_main/partner-transactions",className:"block",children:(0,b.jsxs)(g.Card,{className:"h-full hover:border-foreground/20 transition-colors",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Pending Commissions"}),(0,b.jsx)(_.Activity,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:(0,V.formatCurrency)(m?.pendingCommissions||0,u)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Accrued and invoiced fees"})]})]})})]}),p&&(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(S.BarChart3,{className:"h-5 w-5"}),"Performance Analytics"]}),(0,b.jsx)(g.CardDescription,{children:"Your referral performance metrics"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[(0,b.jsx)(y.Target,{className:"h-4 w-4"}),"Conversion Rate"]}),(0,b.jsxs)("div",{className:"text-2xl font-bold",children:[p.conversionRate,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Referrals that subscribed"})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[p.referralGrowth>=0?(0,b.jsx)(K.TrendingUp,{className:"h-4 w-4 text-green-500"}):(0,b.jsx)(L.TrendingDown,{className:"h-4 w-4 text-red-500"}),"This Month"]}),(0,b.jsx)("div",{className:"text-2xl font-bold",children:p.thisMonthReferrals}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[(0,b.jsxs)("span",{className:p.referralGrowth>=0?"text-green-500":"text-red-500",children:[p.referralGrowth>=0?"+":"",p.referralGrowth,"%"]})," ","vs last month (",p.lastMonthReferrals,")"]})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[(0,b.jsx)(I.DollarSign,{className:"h-4 w-4"}),"Avg Commitment"]}),(0,b.jsx)("div",{className:"text-2xl font-bold",children:(0,V.formatCurrency)(p.avgCommitmentPerInvestor,p.avgCommitmentCurrency)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Per subscribed investor"})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[(0,b.jsx)(T.Wallet,{className:"h-4 w-4"}),"Paid Commissions"]}),(0,b.jsx)("div",{className:"text-2xl font-bold text-green-500",children:(0,V.formatCurrency)(p.paidCommissions,u)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Total received"})]})]})})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)($.HandCoins,{className:"h-5 w-5"}),"Recent Referrals"]}),(0,b.jsx)(g.CardDescription,{children:"Investors you have referred to deals"})]}),(0,b.jsx)(g.CardContent,{children:0===r.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(H.Users,{className:"h-12 w-12 mx-auto mb-4 opacity-20"}),(0,b.jsx)("p",{children:"No referrals yet"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:"Share deals with investors to start tracking"})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[r.map((a,c)=>{let d=a.subscription?.status,e="committed"===d||"active"===d,f="pending"===d,g=!d&&a.interest_confirmed_at;return(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`p-2 rounded-full ${e?"bg-green-100 text-green-600":f?"bg-yellow-100 text-yellow-600":g?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:e?(0,b.jsx)(N.CheckCircle2,{className:"h-4 w-4"}):f?(0,b.jsx)(M.Clock,{className:"h-4 w-4"}):(0,b.jsx)(Z.Eye,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.investor_name||"Unknown Investor"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.deal_name||"Unknown Deal"})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[a.subscription?.commitment?(0,b.jsx)("p",{className:"font-medium",children:(0,V.formatCurrency)(a.subscription.commitment,t)}):null,(0,b.jsx)(h.Badge,{variant:e?"default":f||g?"secondary":"outline",children:e?"Committed":f?"Pending":g?"Interested":"Dispatched"})]})]},`${a.deal_id}-${a.investor_id||c}`)}),(0,b.jsx)(i.default,{href:"/versotech_main/partner-transactions",children:(0,b.jsxs)(n.Button,{variant:"outline",className:"w-full",children:["View All Transactions",(0,b.jsx)(P.ArrowRight,{className:"ml-2 h-4 w-4"})]})})]})})]}),(0,b.jsx)(ah,{})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Quick Actions"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsx)(i.default,{href:"/versotech_main/opportunities",children:(0,b.jsxs)(n.Button,{variant:"outline",className:"w-full justify-start",children:[(0,b.jsx)(K.TrendingUp,{className:"mr-2 h-4 w-4"}),"Browse Opportunities"]})}),(0,b.jsx)(i.default,{href:"/versotech_main/partner-transactions",children:(0,b.jsxs)(n.Button,{variant:"outline",className:"w-full justify-start",children:[(0,b.jsx)(H.Users,{className:"mr-2 h-4 w-4"}),"View Transactions"]})}),(0,b.jsx)(i.default,{href:"/versotech_main/shared-transactions",children:(0,b.jsxs)(n.Button,{variant:"outline",className:"w-full justify-start",children:[(0,b.jsx)($.HandCoins,{className:"mr-2 h-4 w-4"}),"Shared Deals"]})}),(0,b.jsx)(i.default,{href:"/versotech_main/messages",children:(0,b.jsxs)(n.Button,{variant:"outline",className:"w-full justify-start",children:[(0,b.jsx)(_.Activity,{className:"mr-2 h-4 w-4"}),"Messages"]})})]})})]})]})}var aj=a.i(877918);function ak({lawyerId:a,userId:d,persona:j}){let{theme:k}=(0,e.useTheme)(),l="staff-dark"===k,[m,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null),[t,v]=(0,c.useState)(null),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]);if((0,c.useEffect)(()=>{!async function(){try{let b=(0,f.createClient)(),{data:c}=await b.from("lawyers").select("id, firm_name, display_name, specializations, is_active, assigned_deals").eq("id",a).maybeSingle();c&&v({firm_name:c.firm_name||"",display_name:c.display_name||"",specializations:c.specializations,is_active:c.is_active??!0});let{data:d}=await b.from("vehicles").select("id, name").eq("lawyer_id",a),e=(d||[]).map(a=>a.id),g=[],h=[];if(e.length>0){let{data:a}=await b.from("deals").select("id, name, status, target_amount, currency, vehicle_id").in("vehicle_id",e).order("created_at",{ascending:!1}).limit(10);g=(a||[]).map(a=>({id:a.id,name:a.name,status:a.status,target_amount:a.target_amount,currency:a.currency||"USD"})),h=(a||[]).map(a=>a.id)}if(!h.length&&c?.assigned_deals?.length&&(h=c.assigned_deals),z(g),h.length>0){let{data:a}=await b.from("subscriptions").select(`
              id,
              deal_id,
              investor_id,
              status,
              commitment,
              funded_amount,
              currency,
              committed_at,
              deals (id, name),
              investors (id, display_name, legal_name)
            `).in("deal_id",h).in("status",["committed","partially_funded","funded","active"]).order("committed_at",{ascending:!1}),c=a||[],{data:d}=await b.from("fee_events").select("id, status").in("deal_id",h).in("status",["accrued","invoiced"]),e=(d||[]).length,f=c.filter(a=>"committed"===a.status),g=c.filter(a=>"partially_funded"===a.status),i=c.filter(a=>"funded"===a.status||"active"===a.status),j=new Map,k=new Map;c.forEach(a=>{let b=a.currency||"USD";j.set(b,(j.get(b)||0)+(a.commitment||0)),k.set(b,(k.get(b)||0)+(a.funded_amount||0))});let l=(a,b)=>"USD"===a.currency?-1:"USD"===b.currency?1:a.currency.localeCompare(b.currency),m=Array.from(j.entries()).map(([a,b])=>({currency:a,amount:b})).filter(a=>a.amount>0).sort(l),n=Array.from(k.entries()).map(([a,b])=>({currency:a,amount:b})).filter(a=>a.amount>0).sort(l);s({assignedDeals:h.length,pendingEscrowConfirmations:f.length+g.length,pendingPaymentConfirmations:e,signedSubscriptions:c.length,fullyFundedSubscriptions:i.length,commitmentsByCurrency:m,fundedByCurrency:n});let o=c.slice(0,5).map(a=>{let b=Array.isArray(a.deals)?a.deals[0]:a.deals,c=Array.isArray(a.investors)?a.investors[0]:a.investors;return{id:a.id,deal_name:b?.name||"Unknown Deal",investor_name:c?.display_name||c?.legal_name||"Unknown Investor",commitment:a.commitment||0,funded_amount:a.funded_amount||0,currency:a.currency||"USD",status:a.status,committed_at:a.committed_at}});x(o)}else s({assignedDeals:0,pendingEscrowConfirmations:0,pendingPaymentConfirmations:0,signedSubscriptions:0,fullyFundedSubscriptions:0,commitmentsByCurrency:[],fundedByCurrency:[]})}catch(a){console.error("Error fetching lawyer data:",a),q(a instanceof Error?a.message:"Failed to load dashboard data")}finally{o(!1)}}()},[a,d]),m)return(0,b.jsxs)("div",{className:"p-8 text-center flex flex-col items-center gap-3",children:[(0,b.jsx)(Q.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Loading dashboard..."})]});if(p)return(0,b.jsxs)("div",{className:"p-8 text-center flex flex-col items-center gap-3",children:[(0,b.jsx)(aj.AlertCircle,{className:"h-12 w-12 text-destructive"}),(0,b.jsx)("h3",{className:"text-lg font-medium",children:"Error Loading Dashboard"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:p}),(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>window.location.reload(),children:"Try Again"})]});let A={committed:"bg-blue-500/20 text-blue-400",partially_funded:"bg-amber-500/20 text-amber-400",funded:"bg-emerald-500/20 text-emerald-400",active:"bg-green-500/20 text-green-400"},B={committed:"Awaiting Funding",partially_funded:"Partial",funded:"Fully Funded",active:"Active"},C={open:"bg-green-500/20 text-green-400",draft:"bg-gray-500/20 text-gray-400",allocation_pending:"bg-yellow-500/20 text-yellow-400",fully_subscribed:"bg-blue-500/20 text-blue-400",closed:"bg-purple-500/20 text-purple-400",cancelled:"bg-red-500/20 text-red-400"};return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:"Lawyer Dashboard"}),(0,b.jsxs)("p",{className:`mt-1 ${l?"text-gray-400":"text-gray-600"}`,children:[t?.display_name||j.entity_name,t?.firm_name&&` - ${t.firm_name}`]})]}),t?.specializations?.length?(0,b.jsx)("div",{className:"flex gap-2",children:t.specializations.slice(0,3).map((a,c)=>(0,b.jsx)(h.Badge,{variant:"outline",className:"capitalize",children:a},c))}):null]}),t&&!t.is_active&&(0,b.jsx)(g.Card,{className:`border-amber-500/30 ${l?"bg-amber-500/10":"bg-amber-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-amber-500/20",children:(0,b.jsx)(aj.AlertCircle,{className:"h-5 w-5 text-amber-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:"Account Inactive"}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"Your lawyer account is currently inactive. Contact the VERSO team for assistance."})]})]})})}),r&&r.pendingEscrowConfirmations>0&&(0,b.jsx)(g.Card,{className:`border-blue-500/30 ${l?"bg-blue-500/10":"bg-blue-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-blue-500/20",children:(0,b.jsx)(I.DollarSign,{className:"h-5 w-5 text-blue-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:[r.pendingEscrowConfirmations," Pending Escrow Confirmation",1!==r.pendingEscrowConfirmations?"s":""]}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"Signed subscriptions awaiting funding confirmation"})]})]}),(0,b.jsx)(n.Button,{asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/escrow",children:["Confirm Funding",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-2"})]})})]})})}),r&&r.pendingPaymentConfirmations>0&&(0,b.jsx)(g.Card,{className:`border-purple-500/30 ${l?"bg-purple-500/10":"bg-purple-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-purple-500/20",children:(0,b.jsx)(I.DollarSign,{className:"h-5 w-5 text-purple-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:[r.pendingPaymentConfirmations," Pending Fee Payment",1!==r.pendingPaymentConfirmations?"s":""]}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"Fee payments awaiting confirmation"})]})]}),(0,b.jsx)(n.Button,{asChild:!0,variant:"outline",children:(0,b.jsxs)(i.default,{href:"/versotech_main/lawyer-reconciliation",children:["View Fees",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-2"})]})})]})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Assigned Deals"}),(0,b.jsx)(Y.Briefcase,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:r?.assignedDeals||0}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Deals under your counsel"})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Signed Subscriptions"}),(0,b.jsx)(u.FileText,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:r?.signedSubscriptions||0}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[r?.fullyFundedSubscriptions||0," fully funded"]})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Total Committed"}),(0,b.jsx)(I.DollarSign,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[r?.commitmentsByCurrency&&r.commitmentsByCurrency.length>0?(0,b.jsx)("div",{className:"space-y-1",children:r.commitmentsByCurrency.map((a,c)=>(0,b.jsx)("div",{className:`${0===c?"text-2xl font-bold":"text-sm font-medium"} text-blue-500`,children:(0,V.formatCurrency)(a.amount,a.currency)},a.currency))}):(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-500",children:(0,V.formatCurrency)(0)}),(0,b.jsx)("p",{className:"text-xs mt-1 text-gray-500",children:"Across all subscriptions"})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Total Funded"}),(0,b.jsx)(N.CheckCircle2,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[r?.fundedByCurrency&&r.fundedByCurrency.length>0?(0,b.jsx)("div",{className:"space-y-1",children:r.fundedByCurrency.map((a,c)=>(0,b.jsx)("div",{className:`${0===c?"text-2xl font-bold":"text-sm font-medium"} text-green-500`,children:(0,V.formatCurrency)(a.amount,a.currency)},a.currency))}):(0,b.jsx)("div",{className:"text-2xl font-bold text-green-500",children:(0,V.formatCurrency)(0)}),(0,b.jsx)("p",{className:"text-xs mt-1 text-gray-500",children:"Escrow confirmed"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Recent Subscriptions"}),(0,b.jsx)(g.CardDescription,{children:"Recently signed subscription packs"})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/subscription-packs",children:["View All",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-1"})]})})]}),(0,b.jsx)(g.CardContent,{children:0===w.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(u.FileText,{className:`h-10 w-10 mx-auto mb-3 ${l?"text-gray-600":"text-gray-400"}`}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"No signed subscriptions yet"})]}):(0,b.jsx)("div",{className:"space-y-3",children:w.map(a=>(0,b.jsxs)("div",{className:`flex items-center justify-between p-3 rounded-lg ${l?"bg-white/5":"bg-gray-50"}`,children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:`font-medium truncate ${l?"text-white":"text-gray-900"}`,children:a.investor_name}),(0,b.jsx)("p",{className:`text-sm truncate ${l?"text-gray-400":"text-gray-500"}`,children:a.deal_name}),(0,b.jsxs)("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"}`,children:[(0,V.formatCurrency)(a.commitment,a.currency)," committed"]})]}),(0,b.jsx)(h.Badge,{className:A[a.status]||"bg-gray-500/20 text-gray-400",children:B[a.status]||a.status})]},a.id))})})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Assigned Deals"}),(0,b.jsx)(g.CardDescription,{children:"Deals under your legal counsel"})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/assigned-deals",children:["View All",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-1"})]})})]}),(0,b.jsx)(g.CardContent,{children:0===y.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(Y.Briefcase,{className:`h-10 w-10 mx-auto mb-3 ${l?"text-gray-600":"text-gray-400"}`}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"No deals assigned yet"}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"} mt-1`,children:"Contact the VERSO team to be assigned to deals"})]}):(0,b.jsx)("div",{className:"space-y-3",children:y.map(a=>(0,b.jsxs)(i.default,{href:`/versotech_main/opportunities/${a.id}`,className:`flex items-center justify-between p-3 rounded-lg transition-colors ${l?"bg-white/5 hover:bg-white/10":"bg-gray-50 hover:bg-gray-100"}`,children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:`font-medium truncate ${l?"text-white":"text-gray-900"}`,children:a.name}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:a.target_amount?`${(0,V.formatCurrency)(a.target_amount,a.currency)} target`:"No target set"})]}),(0,b.jsx)(h.Badge,{className:C[a.status]||"bg-gray-500/20 text-gray-400",children:a.status})]},a.id))})})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Quick Actions"}),(0,b.jsx)(g.CardDescription,{children:"Common tasks and workflows"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/subscription-packs",children:[(0,b.jsx)(u.FileText,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"View Signed Packs"})]})}),(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/escrow",children:[(0,b.jsx)(I.DollarSign,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Confirm Escrow"})]})}),(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/assigned-deals",children:[(0,b.jsx)(Y.Briefcase,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"View Deals"})]})})]})})]})]})}var al=a.i(504839),am=a.i(947208),an=a.i(403205),ao=a.i(778541),ap=a.i(752907),aq=a.i(873785),ar=a.i(47748);function as({arrangerId:a,compact:d=!1}){let{theme:f}=(0,e.useTheme)(),h="staff-dark"===f,[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(!0),[o,p]=(0,c.useState)(null);if((0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/arrangers/me/onboarding-status");if(!a.ok)throw Error("Failed to fetch onboarding status");let b=await a.json();k(b)}catch(a){console.error("Error fetching onboarding status:",a),p("Failed to load onboarding status")}finally{m(!1)}}()},[a]),l)return(0,b.jsx)(g.Card,{className:(0,q.cn)(h?"bg-white/5 border-white/10":""),children:(0,b.jsx)(g.CardContent,{className:"py-6 flex items-center justify-center",children:(0,b.jsx)(Q.Loader2,{className:"h-5 w-5 animate-spin text-gray-400"})})});if(o||!j||j.onboarding.is_complete&&d)return null;let{onboarding:r}=j,s=[{id:"profile",label:"Complete Profile",description:"Fill in your company details",icon:z.User,complete:r.steps.profile.complete,href:"/versotech_main/arranger-profile?tab=entity",progress:r.steps.profile.progress},{id:"documents",label:"Upload Documents",description:"Required KYC documents",icon:u.FileText,complete:r.steps.documents.complete,href:"/versotech_main/arranger-profile?tab=documents",progress:r.steps.documents.progress},{id:"signature",label:"Signature Specimen",description:"Add your signature",icon:ap.PenTool,complete:r.steps.signature.complete,href:"/versotech_main/arranger-profile?tab=signature"},{id:"submitted",label:"Submit for Review",description:"Send for VERSO approval",icon:aq.Send,complete:r.steps.submitted.complete,href:"/versotech_main/arranger-profile?tab=documents"},{id:"approved",label:"KYC Approved",description:"Ready to operate",icon:ar.ShieldCheck,complete:r.steps.approved.complete}];return d?(0,b.jsx)(g.Card,{className:(0,q.cn)("border-indigo-500/30",h?"bg-indigo-500/10":"bg-indigo-50"),children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-indigo-500/20",children:(0,b.jsx)(ar.ShieldCheck,{className:"h-5 w-5 text-indigo-500"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:(0,q.cn)("font-medium",h?"text-white":"text-gray-900"),children:"Complete Your Onboarding"}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,b.jsx)(ao.Progress,{value:r.progress_percent,className:"h-2 flex-1 max-w-[200px]"}),(0,b.jsxs)("span",{className:(0,q.cn)("text-sm",h?"text-gray-400":"text-gray-600"),children:[r.progress_percent,"%"]})]})]})]}),r.next_action&&(0,b.jsx)(n.Button,{asChild:!0,size:"sm",children:(0,b.jsxs)(i.default,{href:r.next_action.href,children:[r.next_action.label,(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-2"})]})})]})})}):(0,b.jsxs)(g.Card,{className:(0,q.cn)(h?"bg-white/5 border-white/10":""),children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:(0,q.cn)(h?"text-white":"text-gray-900"),children:"Onboarding Checklist"}),(0,b.jsx)(g.CardDescription,{className:(0,q.cn)(h?"text-gray-400":"text-gray-500"),children:"Complete these steps to activate your arranger account"})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:(0,q.cn)(h?"text-gray-400":"text-gray-600"),children:"Progress"}),(0,b.jsxs)("span",{className:(0,q.cn)("font-medium",h?"text-white":"text-gray-900"),children:[r.completed_steps," of ",r.total_steps," steps"]})]}),(0,b.jsx)(ao.Progress,{value:r.progress_percent,className:"h-2"})]}),(0,b.jsx)("div",{className:"space-y-3 pt-2",children:s.map((a,c)=>{let d=a.icon,e=r.next_action?.step===a.id||r.next_action?.step==="submit"&&"submitted"===a.id||r.next_action?.step==="pending"&&"submitted"===a.id;return(0,b.jsxs)("div",{className:(0,q.cn)("flex items-center gap-3 p-3 rounded-lg transition-colors",a.complete?h?"bg-green-500/10":"bg-green-50":e?h?"bg-indigo-500/10 border border-indigo-500/30":"bg-indigo-50 border border-indigo-200":h?"bg-white/5":"bg-gray-50"),children:[(0,b.jsx)("div",{className:(0,q.cn)("flex-shrink-0 p-2 rounded-full",a.complete?"bg-green-500/20 text-green-500":e?"bg-indigo-500/20 text-indigo-500":h?"bg-gray-700 text-gray-500":"bg-gray-200 text-gray-400"),children:a.complete?(0,b.jsx)(N.CheckCircle2,{className:"h-4 w-4"}):r.next_action?.step==="pending"&&"submitted"===a.id?(0,b.jsx)(M.Clock,{className:"h-4 w-4"}):(0,b.jsx)(d,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("p",{className:(0,q.cn)("font-medium text-sm",a.complete?h?"text-green-400":"text-green-700":h?"text-white":"text-gray-900"),children:[a.label,a.progress&&!a.complete&&(0,b.jsxs)("span",{className:(0,q.cn)("ml-2 text-xs font-normal",h?"text-gray-400":"text-gray-500"),children:["(",a.progress,")"]})]}),(0,b.jsx)("p",{className:(0,q.cn)("text-xs","text-gray-500"),children:r.next_action?.step==="pending"&&"submitted"===a.id?"Awaiting VERSO team review":a.description})]}),!a.complete&&a.href&&"approved"!==a.id&&(0,b.jsx)(n.Button,{asChild:!0,variant:e?"default":"ghost",size:"sm",className:"flex-shrink-0",children:(0,b.jsx)(i.default,{href:a.href,children:e?"Start":"View"})})]},a.id)})})]})]})}function at({arrangerId:a,userId:d,persona:j}){let{theme:k}=(0,e.useTheme)(),l="staff-dark"===k,[m,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(null),[r,t]=(0,c.useState)(null),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null);if((0,c.useEffect)(()=>{!async function(){try{let b=(0,f.createClient)(),{data:c}=await b.from("arranger_entities").select("id, legal_name, status, kyc_status").eq("id",a).maybeSingle();c&&t({legal_name:c.legal_name,status:c.status,kyc_status:c.kyc_status});let{data:d}=await b.from("vehicles").select("id, name, lawyer_id").eq("arranger_entity_id",a),e=(d||[]).map(a=>a.id),g=[];if(e.length>0){let{data:a}=await b.from("deals").select("id, name, status, target_amount, currency, created_at, vehicle_id").in("vehicle_id",e).order("created_at",{ascending:!1});g=a||[]}let h=g||[],i=h.filter(a=>"open"===a.status||"allocation_pending"===a.status),j=h.filter(a=>"draft"===a.status);v(h.slice(0,5).map(a=>({id:a.id,name:a.name,status:a.status,target_amount:a.target_amount,currency:a.currency||"USD",created_at:a.created_at})));let k=h.map(a=>a.id),l=0;if(k.length>0){let{data:a}=await b.from("subscriptions").select("commitment").in("deal_id",k).in("status",["committed","active","signed","funded"]);l=(a||[]).reduce((a,b)=>a+(b.commitment||0),0)}let m=0,n=0,o=0,p=new Set((d||[]).filter(a=>a.lawyer_id).map(a=>a.lawyer_id)).size;if(k.length>0){let{data:a}=await b.from("subscriptions").select("id, investor_id, introducer_id, proxy_commercial_partner_id").in("deal_id",k);n=new Set((a||[]).filter(a=>a.introducer_id).map(a=>a.introducer_id)).size;let{data:c}=await b.from("deal_memberships").select("referred_by_entity_id").in("deal_id",k).eq("referred_by_entity_type","partner").not("referred_by_entity_id","is",null);m=new Set((c||[]).map(a=>a.referred_by_entity_id)).size,o=new Set((a||[]).filter(a=>a.proxy_commercial_partner_id).map(a=>a.proxy_commercial_partner_id)).size}let{data:r}=await b.from("introducer_agreements").select(`
            id,
            status,
            created_at,
            introducers (id, display_name, legal_name)
          `).eq("arranger_id",a).in("status",["sent","pending_approval","approved","pending_ceo_signature","pending_introducer_signature"]).order("created_at",{ascending:!1}).limit(5),{data:s}=await b.from("placement_agreements").select(`
            id,
            status,
            created_at,
            commercial_partners (id, display_name, legal_name)
          `).eq("arranger_id",a).in("status",["sent","pending_approval","approved","pending_ceo_signature","pending_cp_signature"]).order("created_at",{ascending:!1}).limit(5),u=[];if((r||[]).forEach(a=>{let b=Array.isArray(a.introducers)?a.introducers[0]:a.introducers;u.push({id:a.id,entity_name:b?.display_name||b?.legal_name||"Unknown",entity_type:"introducer",status:a.status,created_at:a.created_at})}),(s||[]).forEach(a=>{let b=Array.isArray(a.commercial_partners)?a.commercial_partners[0]:a.commercial_partners;u.push({id:a.id,entity_name:b?.display_name||b?.legal_name||"Unknown",entity_type:"commercial_partner",status:a.status,created_at:a.created_at})}),u.sort((a,b)=>new Date(b.created_at).getTime()-new Date(a.created_at).getTime()),x(u.slice(0,5)),k.length>0){let{data:a}=await b.from("subscriptions").select("commitment, funded_amount, outstanding_amount, status, investor_id").in("deal_id",k).in("status",["committed","partially_funded","funded","active","signed"]),c=(a||[]).reduce((a,b)=>a+(b.commitment||0),0),d=(a||[]).reduce((a,b)=>a+(b.funded_amount||0),0),e=(a||[]).reduce((a,b)=>a+(b.outstanding_amount||0),0),f=(a||[]).filter(a=>(a.funded_amount||0)<(a.commitment||0)).length;z({totalExpected:c,totalFunded:d,totalOutstanding:e,fundingRate:c>0?d/c*100:0,pendingInvestors:f});let{data:g}=await b.from("documents").select(`
              id,
              subscription_id,
              status,
              ready_for_signature,
              signature_requests(id, signer_role, status)
            `).not("subscription_id","is",null).in("status",["published","pending_signature"]),{data:h}=await b.from("subscriptions").select("id").in("deal_id",k),i=new Set((h||[]).map(a=>a.id)),j=(g||[]).filter(a=>i.has(a.subscription_id)),l=0,m=0,n=0;j.forEach(a=>{if("pending_signature"!==a.status)return;let b=a.signature_requests||[],c=b.some(a=>"investor"===a.signer_role&&"pending"===a.status),d=b.some(a=>"arranger"===a.signer_role&&"pending"===a.status),e=b.some(a=>"admin"===a.signer_role&&"pending"===a.status);c&&l++,d&&m++,e&&n++});let o=new Date;o.setDate(1),o.setHours(0,0,0,0);let{count:p}=await b.from("subscriptions").select("id",{count:"exact",head:!0}).in("deal_id",k).not("signed_at","is",null).gte("signed_at",o.toISOString());B({awaitingInvestorSignature:l,awaitingArrangerSignature:m,awaitingCEOSignature:n,signedThisMonth:p||0,totalPending:l+m+n})}else z({totalExpected:0,totalFunded:0,totalOutstanding:0,fundingRate:0,pendingInvestors:0}),B({awaitingInvestorSignature:0,awaitingArrangerSignature:0,awaitingCEOSignature:0,signedThisMonth:0,totalPending:0});let{data:w}=await b.from("fee_events").select("computed_amount, status").eq("payee_arranger_id",a),y=(w||[]).filter(a=>"voided"!==a.status&&"cancelled"!==a.status),A=y.filter(a=>"accrued"===a.status).reduce((a,b)=>a+(b.computed_amount||0),0),C=y.filter(a=>"invoiced"===a.status).reduce((a,b)=>a+(b.computed_amount||0),0),E=y.filter(a=>"paid"===a.status).reduce((a,b)=>a+(b.computed_amount||0),0);D({totalAccrued:A,totalInvoiced:C,totalPaid:E,feePipeline:A+C}),q({totalMandates:h.length,activeMandates:i.length,pendingMandates:j.length,totalPartners:m||0,totalIntroducers:n||0,totalCommercialPartners:o||0,totalLawyers:p,pendingAgreements:u.length,totalCommitmentValue:l})}catch(a){console.error("Error fetching arranger data:",a)}finally{o(!1)}}()},[a]),m)return(0,b.jsxs)("div",{className:"p-8 text-center flex flex-col items-center gap-3",children:[(0,b.jsx)(Q.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Loading dashboard..."})]});let E={draft:"bg-gray-500/20 text-gray-400",open:"bg-green-500/20 text-green-400",allocation_pending:"bg-amber-500/20 text-amber-400",closed:"bg-purple-500/20 text-purple-400",cancelled:"bg-red-500/20 text-red-400"},F={sent:"bg-blue-500/20 text-blue-400",pending_approval:"bg-amber-500/20 text-amber-400",approved:"bg-green-500/20 text-green-400",pending_ceo_signature:"bg-purple-500/20 text-purple-400",pending_introducer_signature:"bg-indigo-500/20 text-indigo-400",pending_cp_signature:"bg-indigo-500/20 text-indigo-400"},K={sent:"Sent",pending_approval:"Pending Approval",approved:"Approved",pending_ceo_signature:"Awaiting CEO Signature",pending_introducer_signature:"Awaiting Signature",pending_cp_signature:"Awaiting Signature"};return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:"Arranger Dashboard"}),(0,b.jsx)("p",{className:`mt-1 ${l?"text-gray-400":"text-gray-600"}`,children:r?.legal_name||j.entity_name})]}),r?.kyc_status&&(0,b.jsxs)(h.Badge,{variant:"outline",className:"approved"===r.kyc_status?"border-green-500/50 text-green-500":"pending"===r.kyc_status?"border-amber-500/50 text-amber-500":"border-gray-500/50 text-gray-500",children:["KYC: ",r.kyc_status]})]}),r&&"active"!==r.status&&(0,b.jsx)(g.Card,{className:`border-amber-500/30 ${l?"bg-amber-500/10":"bg-amber-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-amber-500/20",children:(0,b.jsx)(aj.AlertCircle,{className:"h-5 w-5 text-amber-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:["Account ","pending"===r.status?"Pending Approval":"Inactive"]}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"pending"===r.status?"Your arranger account is pending approval. Contact the VERSO team for status updates.":"Your arranger account is currently inactive. Contact the VERSO team for assistance."})]})]})})}),p&&p.pendingAgreements>0&&(0,b.jsx)(g.Card,{className:`border-blue-500/30 ${l?"bg-blue-500/10":"bg-blue-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-blue-500/20",children:(0,b.jsx)(J.FileSignature,{className:"h-5 w-5 text-blue-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:[p.pendingAgreements," Pending Agreement",1!==p.pendingAgreements?"s":""]}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"Agreements awaiting approval or signature"})]})]}),(0,b.jsx)(n.Button,{asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/versosign",children:["View in VERSOSign",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-2"})]})})]})})}),r?.kyc_status!=="approved"&&(0,b.jsx)(as,{arrangerId:a,compact:!0}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Total Mandates"}),(0,b.jsx)(Y.Briefcase,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.totalMandates||0}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[p?.activeMandates||0," active, ",p?.pendingMandates||0," pending"]})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Active Network"}),(0,b.jsx)(H.Users,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:(p?.totalPartners||0)+(p?.totalIntroducers||0)+(p?.totalCommercialPartners||0)}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"On your mandates"})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Total Commitment"}),(0,b.jsx)(I.DollarSign,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-500",children:(0,V.formatCurrency)(p?.totalCommitmentValue||0)}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Across all mandates"})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Assigned Lawyers"}),(0,b.jsx)(al.Scale,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.totalLawyers||0}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"On your mandates"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Escrow Funding Status"}),(0,b.jsx)(T.Wallet,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsxs)("div",{className:`text-2xl font-bold ${(y?.fundingRate||0)>=75?"text-green-500":"text-amber-500"}`,children:[(y?.fundingRate||0).toFixed(0),"% Funded"]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[(0,V.formatCurrency)(y?.totalFunded||0)," of ",(0,V.formatCurrency)(y?.totalExpected||0)]}),(0,b.jsx)("div",{className:`mt-2 h-2 ${l?"bg-gray-700":"bg-gray-200"} rounded-full overflow-hidden`,children:(0,b.jsx)("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${Math.min(y?.fundingRate||0,100)}%`}})}),(y?.pendingInvestors||0)>0&&(0,b.jsxs)("p",{className:"text-xs text-amber-400 mt-2",children:[y?.pendingInvestors," investor(s) pending funding"]}),(0,b.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-700/50 flex justify-between text-xs",children:[(0,b.jsx)("span",{className:l?"text-gray-400":"text-gray-500",children:"Outstanding:"}),(0,b.jsx)("span",{className:"text-amber-400 font-medium",children:(0,V.formatCurrency)(y?.totalOutstanding||0)})]})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Fee Pipeline"}),(0,b.jsx)(am.Receipt,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-500",children:(0,V.formatCurrency)(C?.feePipeline||0)}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Pending collection"}),(0,b.jsxs)("div",{className:"mt-3 space-y-2 text-xs",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:l?"text-gray-400":"text-gray-500",children:"Accrued:"}),(0,b.jsx)("span",{className:"text-amber-400 font-medium",children:(0,V.formatCurrency)(C?.totalAccrued||0)})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:l?"text-gray-400":"text-gray-500",children:"Invoiced:"}),(0,b.jsx)("span",{className:"text-blue-400 font-medium",children:(0,V.formatCurrency)(C?.totalInvoiced||0)})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t border-gray-700/50",children:[(0,b.jsx)("span",{className:l?"text-gray-400":"text-gray-500",children:"Total Paid:"}),(0,b.jsx)("span",{className:"text-green-400 font-medium",children:(0,V.formatCurrency)(C?.totalPaid||0)})]})]})]})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Subscription Pack Pipeline"}),(0,b.jsx)(g.CardDescription,{children:"Document signing status across your mandates"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:`text-center p-4 rounded-lg ${l?"bg-amber-500/10":"bg-amber-50"}`,children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-amber-500",children:A?.awaitingInvestorSignature||0}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-400":"text-gray-500"}`,children:"Awaiting Investor"})]}),(0,b.jsxs)("div",{className:`text-center p-4 rounded-lg ${l?"bg-purple-500/10":"bg-purple-50"}`,children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-purple-500",children:A?.awaitingArrangerSignature||0}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-400":"text-gray-500"}`,children:"Awaiting Your Signature"})]}),(0,b.jsxs)("div",{className:`text-center p-4 rounded-lg ${l?"bg-blue-500/10":"bg-blue-50"}`,children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-500",children:A?.awaitingCEOSignature||0}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-400":"text-gray-500"}`,children:"Awaiting CEO"})]}),(0,b.jsxs)("div",{className:`text-center p-4 rounded-lg ${l?"bg-green-500/10":"bg-green-50"}`,children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-green-500",children:A?.signedThisMonth||0}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-400":"text-gray-500"}`,children:"Signed This Month"})]})]}),(A?.awaitingArrangerSignature||0)>0&&(0,b.jsxs)(an.Alert,{className:`mt-4 border-purple-500/30 ${l?"bg-purple-500/10":"bg-purple-50"}`,children:[(0,b.jsx)(J.FileSignature,{className:"h-4 w-4 text-purple-500"}),(0,b.jsxs)(an.AlertDescription,{className:`flex items-center justify-between ${l?"text-gray-300":"text-gray-700"}`,children:[(0,b.jsxs)("span",{children:["You have ",A?.awaitingArrangerSignature," document(s) awaiting your signature."]}),(0,b.jsx)(n.Button,{variant:"link",asChild:!0,className:"p-0 h-auto text-purple-500",children:(0,b.jsx)(i.default,{href:"/versotech_main/versosign",children:"Sign Now →"})})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsx)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-pink-500/20",children:(0,b.jsx)(H.Users,{className:"h-6 w-6 text-pink-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.totalPartners||0}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Partners"})]})]})})}),(0,b.jsx)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-orange-500/20",children:(0,b.jsx)(G.UserPlus,{className:"h-6 w-6 text-orange-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.totalIntroducers||0}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Introducers"})]})]})})}),(0,b.jsx)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-cyan-500/20",children:(0,b.jsx)(s.Building2,{className:"h-6 w-6 text-cyan-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.totalCommercialPartners||0}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Commercial Partners"})]})]})})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Recent Mandates"}),(0,b.jsx)(g.CardDescription,{children:"Your managed deals"})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/my-mandates",children:["View All",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-1"})]})})]}),(0,b.jsx)(g.CardContent,{children:0===u.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(Y.Briefcase,{className:`h-10 w-10 mx-auto mb-3 ${l?"text-gray-600":"text-gray-400"}`}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"No mandates assigned yet"}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"} mt-1`,children:"Contact the VERSO team to be assigned mandates"})]}):(0,b.jsx)("div",{className:"space-y-3",children:u.map(a=>(0,b.jsxs)(i.default,{href:"/versotech_main/my-mandates",className:`flex items-center justify-between p-3 rounded-lg transition-colors ${l?"bg-white/5 hover:bg-white/10":"bg-gray-50 hover:bg-gray-100"}`,children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:`font-medium truncate ${l?"text-white":"text-gray-900"}`,children:a.name}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:a.target_amount?`${(0,V.formatCurrency)(a.target_amount,a.currency)} target`:"No target set"})]}),(0,b.jsx)(h.Badge,{className:E[a.status]||"bg-gray-500/20 text-gray-400",children:a.status})]},a.id))})})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Pending Agreements"}),(0,b.jsx)(g.CardDescription,{children:"Agreements awaiting action"})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/versosign",children:["View All",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-1"})]})})]}),(0,b.jsx)(g.CardContent,{children:0===w.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(J.FileSignature,{className:`h-10 w-10 mx-auto mb-3 ${l?"text-gray-600":"text-gray-400"}`}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"No pending agreements"}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"} mt-1`,children:"All agreements are up to date"})]}):(0,b.jsx)("div",{className:"space-y-3",children:w.map(a=>(0,b.jsxs)("div",{className:`flex items-center justify-between p-3 rounded-lg ${l?"bg-white/5":"bg-gray-50"}`,children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:`font-medium truncate ${l?"text-white":"text-gray-900"}`,children:a.entity_name}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"introducer"===a.entity_type?"Introducer Agreement":"Placement Agreement"})]}),(0,b.jsx)(h.Badge,{className:F[a.status]||"bg-gray-500/20 text-gray-400",children:K[a.status]||a.status})]},a.id))})})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Quick Actions"}),(0,b.jsx)(g.CardDescription,{children:"Common tasks and workflows"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/my-mandates",children:[(0,b.jsx)(Y.Briefcase,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"View Mandates"})]})}),(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/my-partners",children:[(0,b.jsx)(H.Users,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"My Partners"})]})}),(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/my-introducers",children:[(0,b.jsx)(G.UserPlus,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"My Introducers"})]})}),(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/versosign",children:[(0,b.jsx)(J.FileSignature,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"VERSOSign"})]})})]})})]})]})}function au({commercialPartnerId:a,userId:d,persona:j}){let{theme:k}=(0,e.useTheme)(),l="staff-dark"===k,[m,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(null),[r,t]=(0,c.useState)(null),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{!async function(){try{let b=(0,f.createClient)(),{data:c}=await b.from("commercial_partners").select("id, name, legal_name, status, kyc_status, cp_type").eq("id",a).maybeSingle();c&&t({name:c.name,legal_name:c.legal_name,status:c.status,kyc_status:c.kyc_status,cp_type:c.cp_type});let{data:e}=await b.from("commercial_partner_users").select("can_execute_for_clients").eq("commercial_partner_id",a).eq("user_id",d).maybeSingle();A(e?.can_execute_for_clients||!1);let{data:g,count:h}=await b.from("commercial_partner_clients").select("id, is_active, client_investor_id",{count:"exact"}).eq("commercial_partner_id",a),i=(g||[]).filter(a=>a.is_active).length,j=(g||[]).filter(a=>a.client_investor_id).map(a=>a.client_investor_id),{data:k}=await b.from("investor_users").select("investor_id").eq("user_id",d),l=(k||[]).map(a=>a.investor_id),{data:m}=await b.from("deal_memberships").select("deal_id, role").eq("user_id",d).in("role",["commercial_partner_investor","commercial_partner_proxy"]),n=(m||[]).length,o=(m||[]).map(a=>a.deal_id),p=0;if(o.length>0){let{count:a}=await b.from("deals").select("id",{count:"exact",head:!0}).in("id",o).in("status",["open","allocation_pending","active"]);p=a||0}let r=0,s=0,u=0,v=0,x=[];if(l.length>0){let{data:a}=await b.from("subscriptions").select(`
              id, commitment, status, created_at,
              deals (id, name),
              investors (id, legal_name)
            `).in("investor_id",l).order("created_at",{ascending:!1}).limit(10);(a||[]).forEach(a=>{["committed","active","signed","funded"].includes(a.status)&&(r+=a.commitment||0),u++,"pending"===a.status&&v++,x.push({id:a.id,deal_name:a.deals?.name||"Unknown Deal",investor_name:"My Investment",commitment:a.commitment||0,status:a.status,created_at:a.created_at,is_proxy:!1})})}if(j.length>0){let{data:a}=await b.from("subscriptions").select(`
              id, commitment, status, created_at,
              deals (id, name),
              investors (id, legal_name)
            `).in("investor_id",j).order("created_at",{ascending:!1}).limit(10);(a||[]).forEach(a=>{["committed","active","signed","funded"].includes(a.status)&&(s+=a.commitment||0),u++,"pending"===a.status&&v++,x.push({id:a.id,deal_name:a.deals?.name||"Unknown Deal",investor_name:a.investors?.legal_name||"Client",commitment:a.commitment||0,status:a.status,created_at:a.created_at,is_proxy:!0})})}x.sort((a,b)=>new Date(b.created_at).getTime()-new Date(a.created_at).getTime()),w(x.slice(0,5));let{data:z}=await b.from("placement_agreements").select("id, agreement_type, status, default_commission_bps, created_at").eq("commercial_partner_id",a).order("created_at",{ascending:!1});y(z||[]);let B=(z||[]).filter(a=>["sent","pending_approval","approved","pending_ceo_signature","pending_cp_signature"].includes(a.status)).length,C=(z||[]).filter(a=>"active"===a.status).length,D=0,E=0,F=0,{data:G}=await b.from("commercial_partner_commissions").select("status, accrual_amount").eq("commercial_partner_id",a);G&&G.length>0&&G.forEach(a=>{let b=parseFloat(a.accrual_amount)||0;switch(a.status){case"paid":D+=b;break;case"accrued":E+=b;break;case"invoice_requested":case"invoiced":F+=b}}),q({totalClients:h||0,activeClients:i,dispatchedDeals:n,activeOpportunities:p,totalSubscriptions:u,pendingSubscriptions:v,ownInvestmentValue:r,clientInvestmentValue:s,pendingAgreements:B,activeAgreements:C,commissionPaid:D,commissionAccrued:E,commissionPending:F})}catch(a){console.error("Error fetching commercial partner data:",a)}finally{o(!1)}}()},[a,d]),m)return(0,b.jsxs)("div",{className:"p-8 text-center flex flex-col items-center gap-3",children:[(0,b.jsx)(Q.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Loading dashboard..."})]});let B={pending:"bg-amber-500/20 text-amber-400",committed:"bg-blue-500/20 text-blue-400",active:"bg-green-500/20 text-green-400",signed:"bg-purple-500/20 text-purple-400",funded:"bg-emerald-500/20 text-emerald-400",cancelled:"bg-red-500/20 text-red-400",rejected:"bg-red-500/20 text-red-400"},C={draft:"bg-gray-500/20 text-gray-400",sent:"bg-blue-500/20 text-blue-400",pending_approval:"bg-amber-500/20 text-amber-400",approved:"bg-green-500/20 text-green-400",pending_ceo_signature:"bg-purple-500/20 text-purple-400",pending_cp_signature:"bg-indigo-500/20 text-indigo-400",active:"bg-emerald-500/20 text-emerald-400",expired:"bg-red-500/20 text-red-400",terminated:"bg-red-500/20 text-red-400"},D={draft:"Draft",sent:"Sent",pending_approval:"Pending Approval",approved:"Approved",pending_ceo_signature:"Awaiting CEO Signature",pending_cp_signature:"Your Signature Required",active:"Active",expired:"Expired",terminated:"Terminated"};return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:"Commercial Partner Dashboard"}),(0,b.jsx)("p",{className:`mt-1 ${l?"text-gray-400":"text-gray-600"}`,children:r?.legal_name||r?.name||j.entity_name})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[r?.cp_type&&(0,b.jsx)(h.Badge,{variant:"outline",className:l?"border-gray-600":"",children:r.cp_type.replace(/_/g," ").toUpperCase()}),r?.kyc_status&&(0,b.jsxs)(h.Badge,{variant:"outline",className:"approved"===r.kyc_status?"border-green-500/50 text-green-500":"pending"===r.kyc_status?"border-amber-500/50 text-amber-500":"border-gray-500/50 text-gray-500",children:["KYC: ",r.kyc_status]})]})]}),r&&"active"!==r.status&&(0,b.jsx)(g.Card,{className:`border-amber-500/30 ${l?"bg-amber-500/10":"bg-amber-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-amber-500/20",children:(0,b.jsx)(aj.AlertCircle,{className:"h-5 w-5 text-amber-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:["Account ","pending"===r.status?"Pending Approval":"Inactive"]}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"pending"===r.status?"Your commercial partner account is pending approval. Contact the VERSO team for status updates.":"Your commercial partner account is currently inactive. Contact the VERSO team for assistance."})]})]})})}),p&&p.pendingAgreements>0&&(0,b.jsx)(g.Card,{className:`border-orange-500/30 ${l?"bg-orange-500/10":"bg-orange-50"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-orange-500/20",children:(0,b.jsx)(J.FileSignature,{className:"h-5 w-5 text-orange-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:[p.pendingAgreements," Pending Agreement",1!==p.pendingAgreements?"s":""]}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:"Agreements awaiting approval or signature"})]})]}),(0,b.jsx)(n.Button,{asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/placement-agreements",children:["View Agreements",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-2"})]})})]})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Clients Managed"}),(0,b.jsx)(H.Users,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.totalClients||0}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[p?.activeClients||0," active clients"]})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Active Opportunities"}),(0,b.jsx)(K.TrendingUp,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.activeOpportunities||0}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[p?.dispatchedDeals||0," total dispatched"]})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Client Investments"}),(0,b.jsx)(I.DollarSign,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-500",children:(0,V.formatCurrency)(p?.clientInvestmentValue||0)}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Via proxy subscriptions"})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Own Investments"}),(0,b.jsx)(Y.Briefcase,{className:`h-4 w-4 ${l?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:(0,V.formatCurrency)(p?.ownInvestmentValue||0)}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Direct investments"})]})]})]}),(p?.commissionPaid||0)+(p?.commissionAccrued||0)+(p?.commissionPending||0)>0&&(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Commission Earnings"}),(0,b.jsx)(g.CardDescription,{children:"Your commission totals across all deals"})]}),(0,b.jsx)("div",{className:"p-2 rounded-full bg-purple-500/20",children:(0,b.jsx)(I.DollarSign,{className:"h-5 w-5 text-purple-500"})})]})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:`p-4 rounded-lg ${l?"bg-white/5":"bg-green-50"}`,children:[(0,b.jsx)("p",{className:`text-xs font-medium ${l?"text-gray-400":"text-gray-500"} mb-1`,children:"Paid"}),(0,b.jsx)("p",{className:"text-xl font-bold text-green-500",children:(0,V.formatCurrency)(p?.commissionPaid||0)})]}),(0,b.jsxs)("div",{className:`p-4 rounded-lg ${l?"bg-white/5":"bg-blue-50"}`,children:[(0,b.jsx)("p",{className:`text-xs font-medium ${l?"text-gray-400":"text-gray-500"} mb-1`,children:"Accrued"}),(0,b.jsx)("p",{className:"text-xl font-bold text-blue-500",children:(0,V.formatCurrency)(p?.commissionAccrued||0)})]}),(0,b.jsxs)("div",{className:`p-4 rounded-lg ${l?"bg-white/5":"bg-amber-50"}`,children:[(0,b.jsx)("p",{className:`text-xs font-medium ${l?"text-gray-400":"text-gray-500"} mb-1`,children:"Pending"}),(0,b.jsx)("p",{className:"text-xl font-bold text-amber-500",children:(0,V.formatCurrency)(p?.commissionPending||0)})]})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-blue-500/20",children:(0,b.jsx)(u.FileText,{className:"h-6 w-6 text-blue-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.totalSubscriptions||0}),(0,b.jsxs)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:["Total Subscriptions (",p?.pendingSubscriptions||0," pending)"]})]})]})})}),(0,b.jsx)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-emerald-500/20",children:(0,b.jsx)(N.CheckCircle2,{className:"h-6 w-6 text-emerald-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:p?.activeAgreements||0}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Active Placement Agreements"})]})]})})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Recent Transactions"}),(0,b.jsx)(g.CardDescription,{children:"Latest subscription activity"})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/client-transactions",children:["View All",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-1"})]})})]}),(0,b.jsx)(g.CardContent,{children:0===v.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(u.FileText,{className:`h-10 w-10 mx-auto mb-3 ${l?"text-gray-600":"text-gray-400"}`}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"No subscriptions yet"}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"} mt-1`,children:"Browse opportunities to start investing"})]}):(0,b.jsx)("div",{className:"space-y-3",children:v.map(a=>(0,b.jsxs)("div",{className:`flex items-center justify-between p-3 rounded-lg ${l?"bg-white/5":"bg-gray-50"}`,children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:`font-medium truncate ${l?"text-white":"text-gray-900"}`,children:a.deal_name}),a.is_proxy&&(0,b.jsx)(h.Badge,{variant:"outline",className:"text-xs",children:"Proxy"})]}),(0,b.jsxs)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:[a.investor_name," • ",(0,V.formatCurrency)(a.commitment)]})]}),(0,b.jsx)(h.Badge,{className:B[a.status]||"bg-gray-500/20 text-gray-400",children:a.status})]},a.id))})})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Placement Agreements"}),(0,b.jsx)(g.CardDescription,{children:"Your commission agreements"})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(i.default,{href:"/versotech_main/placement-agreements",children:["View All",(0,b.jsx)(P.ArrowRight,{className:"h-4 w-4 ml-1"})]})})]}),(0,b.jsx)(g.CardContent,{children:0===x.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(J.FileSignature,{className:`h-10 w-10 mx-auto mb-3 ${l?"text-gray-600":"text-gray-400"}`}),(0,b.jsx)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"No placement agreements"}),(0,b.jsx)("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"} mt-1`,children:"Agreements will appear here once created"})]}):(0,b.jsx)("div",{className:"space-y-3",children:x.slice(0,5).map(a=>(0,b.jsxs)(i.default,{href:`/versotech_main/placement-agreements/${a.id}`,className:`flex items-center justify-between p-3 rounded-lg transition-colors ${l?"bg-white/5 hover:bg-white/10":"bg-gray-50 hover:bg-gray-100"}`,children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("p",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:[a.agreement_type.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())," Agreement"]}),(0,b.jsxs)("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:["Commission: ",(a.default_commission_bps/100).toFixed(2),"%"]})]}),(0,b.jsx)(h.Badge,{className:C[a.status]||"bg-gray-500/20 text-gray-400",children:D[a.status]||a.status})]},a.id))})})]})]}),(0,b.jsxs)(g.Card,{className:l?"bg-white/5 border-white/10":"",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:l?"text-white":"",children:"Quick Actions"}),(0,b.jsx)(g.CardDescription,{children:"Common tasks and workflows"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/opportunities",children:[(0,b.jsx)(K.TrendingUp,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"View Opportunities"})]})}),z&&(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/client-transactions",children:[(0,b.jsx)(H.Users,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Client Transactions"})]})}),(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/portfolio",children:[(0,b.jsx)(Y.Briefcase,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"My Portfolio"})]})}),(0,b.jsx)(n.Button,{variant:"outline",asChild:!0,className:"h-auto py-4 flex-col gap-2",children:(0,b.jsxs)(i.default,{href:"/versotech_main/placement-agreements",children:[(0,b.jsx)(J.FileSignature,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Agreements"})]})})]})})]}),(0,b.jsx)(g.Card,{className:`${l?"bg-cyan-500/10 border-cyan-500/20":"bg-cyan-50 border-cyan-200"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-10 w-10 rounded-full bg-cyan-500 flex items-center justify-center",children:(0,b.jsx)(s.Building2,{className:"h-5 w-5 text-white"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:`font-medium ${l?"text-white":"text-gray-900"}`,children:"Commercial Partner Capabilities"}),(0,b.jsx)("div",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:z?(0,b.jsxs)(b.Fragment,{children:["You can invest directly ",(0,b.jsx)("strong",{children:"(MODE 1)"})," and execute on behalf of clients ",(0,b.jsx)("strong",{children:"(MODE 2)"}),"."]}):(0,b.jsxs)(b.Fragment,{children:["You can invest directly ",(0,b.jsx)("strong",{children:"(MODE 1)"}),". Contact admin to enable client execution."]})})]})]})})})]})}var av=a.i(375968);let aw=(0,a.i(95799).default)("arrow-left-right",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),ax={staff:s.Building2,investor:z.User,arranger:Y.Briefcase,introducer:G.UserPlus,partner:H.Users,commercial_partner:s.Building2,lawyer:al.Scale},ay={staff:"bg-blue-500",investor:"bg-green-500",arranger:"bg-purple-500",introducer:"bg-orange-500",partner:"bg-pink-500",commercial_partner:"bg-cyan-500",lawyer:"bg-indigo-500"};async function az(a){try{let b=(0,f.createClient)(),{data:c}=await b.from("investor_users").select("investor_id").eq("user_id",a).limit(1);if(!c||0===c.length){let{data:c}=await b.from("subscriptions").select("id").or(`investor_id.in.(select investor_id from investor_users where user_id=${a})`).limit(1);return{hasInvestments:!1,investorId:null,investmentCount:0}}let d=c[0].investor_id,{data:e,count:g}=await b.from("subscriptions").select("id",{count:"exact",head:!0}).eq("investor_id",d).in("status",["active","signed","funded","pending"]);return{hasInvestments:(g||0)>0,investorId:d,investmentCount:g||0}}catch(a){return console.error("Error checking investments:",a),{hasInvestments:!1,investorId:null,investmentCount:0}}}function aA(){let{activePersona:a,personas:i,isCEO:j}=(0,d.usePersona)(),{theme:k}=(0,e.useTheme)(),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(null),[r,t]=(0,c.useState)("partner");(0,c.useEffect)(()=>{!async function(){let a=(0,f.createClient)(),{data:{user:b}}=await a.auth.getUser();m(b?.id??null),o(!1)}()},[]),(0,c.useEffect)(()=>{!async function(){l&&a&&("partner"===a.persona_type||"introducer"===a.persona_type)&&q(await az(l))}()},[l,a]);let v="staff-dark"===k;if(n||!a)return(0,b.jsxs)("div",{className:"p-8 text-center flex flex-col items-center gap-3",children:[(0,b.jsx)(Q.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Loading dashboard..."})]});if("investor"===a.persona_type&&l)return(0,b.jsx)(E,{investorId:a.entity_id,userId:l,persona:a});if("introducer"===a.persona_type&&l)return p?.hasInvestments&&p.investorId?(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsxs)("div",{className:`
            relative overflow-hidden rounded-xl
            ${v?"bg-zinc-900/80 border border-zinc-800":"bg-gradient-to-br from-slate-50 via-white to-stone-50 border border-slate-200/80 shadow-sm"}
          `,children:[(0,b.jsx)("div",{className:"absolute inset-0 opacity-[0.015] pointer-events-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23${v?"ffffff":"000000"}' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),(0,b.jsx)("div",{className:"relative px-5 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`
                    h-11 w-11 rounded-xl flex items-center justify-center
                    ${v?"bg-zinc-800 ring-1 ring-zinc-700":"bg-white ring-1 ring-slate-200 shadow-sm"}
                  `,children:(0,b.jsx)(aw,{className:`h-5 w-5 ${v?"text-zinc-400":"text-slate-500"}`})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-sm font-semibold tracking-tight ${v?"text-zinc-100":"text-slate-800"}`,children:"Dual Role Access"}),(0,b.jsxs)("p",{className:`text-[13px] ${v?"text-zinc-500":"text-slate-500"}`,children:["Introducer · ",p.investmentCount," investment",1!==p.investmentCount?"s":""]})]})]}),(0,b.jsxs)("div",{className:`
                  inline-flex p-1 rounded-lg
                  ${v?"bg-zinc-800/80 ring-1 ring-zinc-700/50":"bg-slate-100/80 ring-1 ring-slate-200/50"}
                `,children:[(0,b.jsxs)("button",{onClick:()=>t("partner"),className:`
                      relative px-4 py-2 rounded-md text-sm font-medium transition-all duration-200
                      flex items-center gap-2
                      ${"partner"===r?v?"bg-zinc-700 text-white shadow-sm ring-1 ring-zinc-600":"bg-white text-slate-900 shadow-sm ring-1 ring-slate-200":v?"text-zinc-400 hover:text-zinc-200":"text-slate-500 hover:text-slate-700"}
                    `,children:[(0,b.jsx)(G.UserPlus,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Referrals"})]}),(0,b.jsxs)("button",{onClick:()=>t("investor"),className:`
                      relative px-4 py-2 rounded-md text-sm font-medium transition-all duration-200
                      flex items-center gap-2
                      ${"investor"===r?v?"bg-zinc-700 text-white shadow-sm ring-1 ring-zinc-600":"bg-white text-slate-900 shadow-sm ring-1 ring-slate-200":v?"text-zinc-400 hover:text-zinc-200":"text-slate-500 hover:text-slate-700"}
                    `,children:[(0,b.jsx)(T.Wallet,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Portfolio"})]})]})]})})]}),"partner"===r?(0,b.jsx)(X,{introducerId:a.entity_id,userId:l,persona:a}):(0,b.jsx)(E,{investorId:p.investorId,userId:l,persona:{...a,persona_type:"investor",entity_id:p.investorId,entity_name:"My Investments"}})]}):(0,b.jsx)(X,{introducerId:a.entity_id,userId:l,persona:a});if("partner"===a.persona_type&&l)return p?.hasInvestments&&p.investorId?(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsxs)("div",{className:`
            relative overflow-hidden rounded-xl
            ${v?"bg-zinc-900/80 border border-zinc-800":"bg-gradient-to-br from-slate-50 via-white to-stone-50 border border-slate-200/80 shadow-sm"}
          `,children:[(0,b.jsx)("div",{className:"absolute inset-0 opacity-[0.015] pointer-events-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23${v?"ffffff":"000000"}' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),(0,b.jsx)("div",{className:"relative px-5 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`
                    h-11 w-11 rounded-xl flex items-center justify-center
                    ${v?"bg-zinc-800 ring-1 ring-zinc-700":"bg-white ring-1 ring-slate-200 shadow-sm"}
                  `,children:(0,b.jsx)(aw,{className:`h-5 w-5 ${v?"text-zinc-400":"text-slate-500"}`})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-sm font-semibold tracking-tight ${v?"text-zinc-100":"text-slate-800"}`,children:"Dual Role Access"}),(0,b.jsxs)("p",{className:`text-[13px] ${v?"text-zinc-500":"text-slate-500"}`,children:["Partner · ",p.investmentCount," investment",1!==p.investmentCount?"s":""]})]})]}),(0,b.jsxs)("div",{className:`
                  inline-flex p-1 rounded-lg
                  ${v?"bg-zinc-800/80 ring-1 ring-zinc-700/50":"bg-slate-100/80 ring-1 ring-slate-200/50"}
                `,children:[(0,b.jsxs)("button",{onClick:()=>t("partner"),className:`
                      relative px-4 py-2 rounded-md text-sm font-medium transition-all duration-200
                      flex items-center gap-2
                      ${"partner"===r?v?"bg-zinc-700 text-white shadow-sm ring-1 ring-zinc-600":"bg-white text-slate-900 shadow-sm ring-1 ring-slate-200":v?"text-zinc-400 hover:text-zinc-200":"text-slate-500 hover:text-slate-700"}
                    `,children:[(0,b.jsx)(H.Users,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Referrals"})]}),(0,b.jsxs)("button",{onClick:()=>t("investor"),className:`
                      relative px-4 py-2 rounded-md text-sm font-medium transition-all duration-200
                      flex items-center gap-2
                      ${"investor"===r?v?"bg-zinc-700 text-white shadow-sm ring-1 ring-zinc-600":"bg-white text-slate-900 shadow-sm ring-1 ring-slate-200":v?"text-zinc-400 hover:text-zinc-200":"text-slate-500 hover:text-slate-700"}
                    `,children:[(0,b.jsx)(T.Wallet,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Portfolio"})]})]})]})})]}),"partner"===r?(0,b.jsx)(ai,{partnerId:a.entity_id,userId:l,persona:a}):(0,b.jsx)(E,{investorId:p.investorId,userId:l,persona:{...a,persona_type:"investor",entity_id:p.investorId,entity_name:"My Investments"}})]}):(0,b.jsx)(ai,{partnerId:a.entity_id,userId:l,persona:a});if("lawyer"===a.persona_type&&l)return(0,b.jsx)(ak,{lawyerId:a.entity_id,userId:l,persona:a});if("arranger"===a.persona_type&&l)return(0,b.jsx)(at,{arrangerId:a.entity_id,userId:l,persona:a});if("commercial_partner"===a.persona_type&&l)return(0,b.jsx)(au,{commercialPartnerId:a.entity_id,userId:l,persona:a});let w=ax[a.persona_type]||z.User;return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:`text-2xl font-bold ${v?"text-white":"text-gray-900"}`,children:"Welcome to VERSO"}),(0,b.jsx)("p",{className:`mt-1 ${v?"text-gray-400":"text-gray-600"}`,children:"Unified Platform Dashboard"})]}),(0,b.jsxs)("div",{className:`flex items-center gap-3 px-4 py-2 rounded-lg ${v?"bg-white/5 border border-white/10":"bg-gray-50 border border-gray-100"}`,children:[(0,b.jsx)("div",{className:`h-10 w-10 rounded-full ${ay[a.persona_type]} flex items-center justify-center`,children:(0,b.jsx)(w,{className:"h-5 w-5 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:`font-medium ${v?"text-white":"text-gray-900"}`,children:a.entity_name}),(0,b.jsx)("div",{className:`text-sm ${v?"text-gray-400":"text-gray-500"}`,children:"staff"===a.persona_type?"staff_admin"===a.role_in_entity||"ceo"===a.role_in_entity?"CEO":a.role_in_entity?.toUpperCase():a.persona_type.replace("_"," ").toUpperCase()})]})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(c=>{let d=ax[c.persona_type]||z.User,e=a?.entity_id===c.entity_id;return(0,b.jsxs)(g.Card,{className:`${v?"bg-white/5 border-white/10":"bg-white border-gray-200"} ${e?"ring-2 ring-blue-500":""}`,children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center gap-4 pb-2",children:[(0,b.jsx)("div",{className:`h-12 w-12 rounded-full ${ay[c.persona_type]} flex items-center justify-center`,children:(0,b.jsx)(d,{className:"h-6 w-6 text-white"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(g.CardTitle,{className:`text-lg ${v?"text-white":"text-gray-900"}`,children:c.entity_name}),(0,b.jsx)(g.CardDescription,{className:v?"text-gray-400":"text-gray-500",children:"staff"===c.persona_type?"staff_admin"===c.role_in_entity||"ceo"===c.role_in_entity?"CEO":c.role_in_entity:c.persona_type.replace("_"," ")})]}),e&&(0,b.jsx)(h.Badge,{variant:"secondary",className:"bg-blue-500/20 text-blue-400",children:"Active"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[c.can_sign&&(0,b.jsx)(h.Badge,{variant:"outline",className:v?"border-white/20 text-gray-300":"",children:"Can Sign"}),c.can_execute_for_clients&&(0,b.jsx)(h.Badge,{variant:"outline",className:v?"border-white/20 text-gray-300":"",children:"Can Execute"}),c.is_primary&&(0,b.jsx)(h.Badge,{variant:"outline",className:v?"border-white/20 text-gray-300":"",children:"Primary"})]})})]},c.entity_id)})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(g.Card,{className:v?"bg-white/5 border-white/10":"bg-white border-gray-200",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${v?"text-gray-400":"text-gray-500"}`,children:"Pending Tasks"}),(0,b.jsx)(av.CheckSquare,{className:`h-4 w-4 ${v?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${v?"text-white":"text-gray-900"}`,children:"0"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"No pending tasks"})]})]}),(0,b.jsxs)(g.Card,{className:v?"bg-white/5 border-white/10":"bg-white border-gray-200",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${v?"text-gray-400":"text-gray-500"}`,children:"Active Deals"}),(0,b.jsx)(K.TrendingUp,{className:`h-4 w-4 ${v?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${v?"text-white":"text-gray-900"}`,children:"-"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Data loading..."})]})]}),(0,b.jsxs)(g.Card,{className:v?"bg-white/5 border-white/10":"bg-white border-gray-200",children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(g.CardTitle,{className:`text-sm font-medium ${v?"text-gray-400":"text-gray-500"}`,children:"Documents"}),(0,b.jsx)(u.FileText,{className:`h-4 w-4 ${v?"text-gray-500":"text-gray-400"}`})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${v?"text-white":"text-gray-900"}`,children:"-"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Data loading..."})]})]})]}),j&&(0,b.jsx)(g.Card,{className:`${v?"bg-blue-500/10 border-blue-500/20":"bg-blue-50 border-blue-200"}`,children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center",children:(0,b.jsx)(s.Building2,{className:"h-5 w-5 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:`font-medium ${v?"text-white":"text-gray-900"}`,children:"CEO Access Enabled"}),(0,b.jsx)("div",{className:`text-sm ${v?"text-gray-400":"text-gray-600"}`,children:"You have access to KYC Review, Fees, Audit, and Admin sections."})]})]})})})]})}a.s(["PersonaDashboard",()=>aA],80276)}];

//# sourceMappingURL=versotech-portal_src_app_%28main%29_versotech_main_dashboard_6e97cebc._.js.map