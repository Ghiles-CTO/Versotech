module.exports=[698004,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(169091),e=a.i(601527),f=a.i(165936),g=a.i(470305),h=a.i(421908),i=a.i(663475),j=a.i(249464),k=a.i(951870),l=a.i(772998),m=a.i(3321),n=a.i(439467),o=a.i(325866),p=a.i(871057),q=a.i(899750);let r=f.z.object({email:f.z.string().email("Please enter a valid email address"),display_name:f.z.string().min(2,"Display name must be at least 2 characters"),title:f.z.string().optional(),role:f.z.string(),is_primary:f.z.boolean(),is_signatory:f.z.boolean(),can_sign:f.z.boolean()}),s={investor:"Investor",arranger:"Arranger",lawyer:"Law Firm",introducer:"Introducer",partner:"Partner",commercial_partner:"Commercial Partner"},t={investor:[{value:"admin",label:"Admin"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}],arranger:[{value:"admin",label:"Admin"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}],lawyer:[{value:"admin",label:"Admin"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}],partner:[{value:"admin",label:"Admin"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}],introducer:[{value:"admin",label:"Admin"},{value:"contact",label:"Contact"},{value:"payment_contact",label:"Payment Contact"},{value:"legal_contact",label:"Legal Contact"}],commercial_partner:[{value:"admin",label:"Admin"},{value:"contact",label:"Contact"},{value:"billing_contact",label:"Billing Contact"},{value:"technical_contact",label:"Technical Contact"}]},u={investor:"member",arranger:"member",lawyer:"member",partner:"member",introducer:"contact",commercial_partner:"contact"};function v({entityType:a,entityId:f,entityName:v,open:w,onOpenChange:x,onSuccess:y}){let[z,A]=(0,c.useState)(!1),B=t[a],C=u[a],{register:D,handleSubmit:E,reset:F,watch:G,setValue:H,formState:{errors:I}}=(0,d.useForm)({resolver:(0,e.zodResolver)(r),defaultValues:{email:"",display_name:"",title:"",role:C,is_primary:!1,is_signatory:!1,can_sign:!1}}),J=G("is_primary");G("is_signatory");let K=G("can_sign"),L=G("role"),M=async b=>{A(!0);try{let c=await fetch("/api/admin/entity-invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_type:a,entity_id:f,...b})}),d=await c.json();if(!c.ok)throw Error(d.error||"Failed to invite user");q.toast.success(d.message||`User invited to ${v}`),F(),x(!1),y?.()}catch(a){console.error("Invite error:",a),q.toast.error(a instanceof Error?a.message:"Failed to invite user")}finally{A(!1)}},N=()=>{F(),x(!1)};return(0,b.jsx)(g.Dialog,{open:w,onOpenChange:N,children:(0,b.jsxs)(g.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(g.DialogHeader,{children:[(0,b.jsxs)(g.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Mail,{className:"h-5 w-5"}),"Invite User to ",s[a]]}),(0,b.jsxs)(g.DialogDescription,{children:["Send an invitation email to join ",(0,b.jsx)("span",{className:"font-medium",children:v}),". They will receive instructions to set up their account."]})]}),(0,b.jsxs)("form",{onSubmit:E(M),className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"email",children:"Email Address *"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(n.Mail,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(i.Input,{id:"email",type:"email",placeholder:"user@example.com",className:"pl-10",...D("email")})]}),I.email&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:I.email.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"display_name",children:"Display Name *"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(o.User,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(i.Input,{id:"display_name",placeholder:"John Smith",className:"pl-10",...D("display_name")})]}),I.display_name&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:I.display_name.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"title",children:"Title (Optional)"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(p.Briefcase,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(i.Input,{id:"title",placeholder:"Managing Director",className:"pl-10",...D("title")})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"role",children:"Role"}),(0,b.jsxs)(k.Select,{value:L,onValueChange:a=>H("role",a),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select role"})}),(0,b.jsx)(k.SelectContent,{children:B.map(a=>(0,b.jsx)(k.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(j.Label,{htmlFor:"is_primary",className:"text-sm font-medium",children:"Primary Contact"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Set as the main point of contact for this entity"})]}),(0,b.jsx)(l.Switch,{id:"is_primary",checked:J,onCheckedChange:a=>H("is_primary",a)})]}),"lawyer"===a&&(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(j.Label,{htmlFor:"can_sign",className:"text-sm font-medium",children:"Can Sign Documents"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Has authority to sign on behalf of the law firm"})]}),(0,b.jsx)(l.Switch,{id:"can_sign",checked:K,onCheckedChange:a=>H("can_sign",a)})]}),(0,b.jsxs)(g.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,b.jsx)(h.Button,{type:"button",variant:"outline",onClick:N,children:"Cancel"}),(0,b.jsx)(h.Button,{type:"submit",disabled:z,children:z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending Invite..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Mail,{className:"mr-2 h-4 w-4"}),"Send Invitation"]})})]})]})]})})}a.s(["InviteUserDialog",()=>v])},162477,310702,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(284169),e=a.i(15788),f=a.i(421908),g=a.i(211374),h=a.i(787957),i=a.i(816854),j=a.i(92881),k=a.i(799373),l=a.i(405398),m=a.i(496392),n=a.i(439467),o=a.i(278541),p=a.i(42329),q=a.i(908513),r=a.i(168118),s=a.i(877918),t=a.i(380640),u=a.i(948153);let v={created:(0,b.jsx)(k.UserPlus,{className:"h-4 w-4"}),updated:(0,b.jsx)(l.Edit,{className:"h-4 w-4"}),kyc_submitted:(0,b.jsx)(m.Shield,{className:"h-4 w-4"}),kyc_approved:(0,b.jsx)(j.UserCheck,{className:"h-4 w-4"}),kyc_rejected:(0,b.jsx)(s.AlertCircle,{className:"h-4 w-4"}),document_uploaded:(0,b.jsx)(i.FileText,{className:"h-4 w-4"}),document_deleted:(0,b.jsx)(i.FileText,{className:"h-4 w-4"}),email_sent:(0,b.jsx)(n.Mail,{className:"h-4 w-4"}),status_changed:(0,b.jsx)(h.Activity,{className:"h-4 w-4"}),bank_details_added:(0,b.jsx)(o.Building2,{className:"h-4 w-4"}),bank_details_updated:(0,b.jsx)(o.Building2,{className:"h-4 w-4"})},w={investor:["investor","investors"],introducer:["introducer","introducers"],arranger:["arranger","arrangers"],lawyer:["lawyer","lawyers"],partner:["partner","partners"],commercial_partner:["commercial_partner","commercial_partners","commercial-partner"]};function x({entityType:a,entityId:i,entityName:j}){let[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!0),[o,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(1),C=(0,c.useCallback)(async(b,c=!1)=>{try{n(!0),x(null);let d=w[a].join(","),e=await fetch(`/api/admin/activity-logs?entityId=${i}&entityTypes=${d}&page=${b}&pageSize=20`);if(!e.ok)throw Error("Failed to fetch activity logs");let f=await e.json();c?l(a=>[...a,...f.logs]):l(f.logs),z(f.hasMore)}catch(a){x(a instanceof Error?a.message:"An error occurred")}finally{n(!1)}},[i,a]);(0,c.useEffect)(()=>{C(1)},[C]);let D=()=>{B(1),C(1)};return m&&0===k.length?(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Activity History"}),(0,b.jsxs)(d.CardDescription,{children:["Recent activity and changes for this ",a.replace("_"," ")]})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(g.Skeleton,{className:"h-8 w-8 rounded-full"}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(g.Skeleton,{className:"h-4 w-3/4"}),(0,b.jsx)(g.Skeleton,{className:"h-3 w-1/4"})]})]},a))})})]}):o?(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Activity History"}),(0,b.jsxs)(d.CardDescription,{children:["Recent activity and changes for this ",a.replace("_"," ")]})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,b.jsx)(s.AlertCircle,{className:"h-12 w-12 text-red-400 mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:o}),(0,b.jsxs)(f.Button,{variant:"outline",onClick:D,children:[(0,b.jsx)(q.RefreshCw,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})]}):(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Activity History"}),(0,b.jsxs)(d.CardDescription,{children:["Recent activity and changes",j?` for ${j}`:""]})]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:D,disabled:m,children:(0,b.jsx)(q.RefreshCw,{className:`h-4 w-4 ${m?"animate-spin":""}`})})]}),(0,b.jsx)(d.CardContent,{children:0===k.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,b.jsx)(h.Activity,{className:"h-12 w-12 text-muted-foreground mb-4 opacity-50"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No activity recorded yet"})]}):(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"relative",children:k.map((a,c)=>{var d;return(0,b.jsxs)("div",{className:"relative pl-8 pb-6 last:pb-0",children:[c<k.length-1&&(0,b.jsx)("div",{className:"absolute left-3 top-8 bottom-0 w-px bg-border"}),(0,b.jsx)("div",{className:"absolute left-0 top-1 h-6 w-6 rounded-full bg-muted flex items-center justify-center",children:v[a.action]||(0,b.jsx)(h.Activity,{className:"h-3 w-3"})}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("span",{className:"font-medium text-foreground",children:(d=a.action)?d.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "):""}),(0,b.jsx)(e.Badge,{className:function(a){switch(a){case"entity_management":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"kyc_workflow":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"document_management":return"bg-amber-500/20 text-amber-400 border-amber-500/30";case"communication":return"bg-green-500/20 text-green-400 border-green-500/30";case"financial":return"bg-emerald-500/20 text-emerald-400 border-emerald-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}}(a.event_type),children:a.event_type.replace(/_/g," ")})]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.actor_name||a.actor_email||"System"}),a.action_details&&Object.keys(a.action_details).length>0&&(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1 p-2 rounded bg-muted/50",children:Object.entries(a.action_details).map(([a,c])=>(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("span",{className:"font-medium",children:[a.replace(/_/g," "),":"]}),(0,b.jsx)("span",{children:"object"==typeof c?JSON.stringify(c):String(c)})]},a))}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mt-1",children:[(0,b.jsx)(p.Clock,{className:"h-3 w-3"}),(0,b.jsx)("span",{title:(0,u.format)(new Date(a.timestamp),"PPpp"),children:(0,t.formatDistanceToNow)(new Date(a.timestamp),{addSuffix:!0})})]})]})]},a.id)})}),y&&(0,b.jsx)("div",{className:"flex justify-center pt-4",children:(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>{let a=A+1;B(a),C(a,!0)},disabled:m,children:[m?(0,b.jsx)(q.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(r.ChevronDown,{className:"h-4 w-4 mr-2"}),"Load More"]})})]})})]})}function y(a,b){return a&&b[a]||"bg-gray-500/20 text-gray-400 border-gray-500/30"}a.s(["ActivityTimelineTab",()=>x],162477),a.s(["getStatusStyle",()=>y,"kycStyles",0,{approved:"bg-green-500/20 text-green-400 border-green-500/30",draft:"bg-gray-500/20 text-gray-400 border-gray-500/30",pending:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",not_started:"bg-gray-500/20 text-gray-400 border-gray-500/30",expired:"bg-red-500/20 text-red-400 border-red-500/30",rejected:"bg-red-500/20 text-red-400 border-red-500/30"},"statusStyles",0,{active:"bg-green-500/20 text-green-400 border-green-500/30",pending:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",inactive:"bg-gray-500/20 text-gray-400 border-gray-500/30",suspended:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",onboarding:"bg-blue-500/20 text-blue-400 border-blue-500/30"}],310702)}];

//# sourceMappingURL=versotech-portal_src_components_34df42e9._.js.map