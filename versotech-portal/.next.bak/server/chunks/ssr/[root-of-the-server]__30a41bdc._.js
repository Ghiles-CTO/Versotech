module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},9349,a=>{a.n(a.i(142710))},199585,a=>{a.n(a.i(701395))},929852,a=>{a.n(a.i(816404))},516153,a=>{a.n(a.i(422096))},911164,a=>{a.n(a.i(273021))},243085,a=>{"use strict";a.i(483696);var b=a.i(263360),c=a.i(621599);a.i(937413);var d=a.i(131360);let e=["staff_admin","staff_ops","staff_rm","ceo"],f=async()=>{let a=await (0,c.cookies)();return(0,b.createServerClient)("https://ipguxdssecfexudnvtia.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlwZ3V4ZHNzZWNmZXh1ZG52dGlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzNjE4MzcsImV4cCI6MjA3MzkzNzgzN30.AGxM_YW9hfxuu7xDpi_4xhOoRhYM7iGTS1vJ0z2FByE",{cookies:{getAll:()=>a.getAll(),setAll(b){try{b.forEach(({name:b,value:c,options:d})=>a.set(b,c,d))}catch{}}}})};async function g(){try{let a=await f(),{data:{user:b},error:c}=await a.auth.getUser();if(c||!b)return null;let{data:d,error:g}=await a.from("profiles").select("*").eq("id",b.id).single();if(g||!d)return console.error("[auth] Profile not found for user:",b.id,g),null;let h=[];if(e.includes(d.role)){let{data:c}=await a.from("staff_permissions").select("permission").eq("user_id",b.id);h=c?.map(a=>a.permission)||[]}return{id:d.id,email:d.email,displayName:d.display_name||d.email?.split("@")[0]||"User",avatar:d.avatar_url,role:d.role,title:d.title,created_at:d.created_at,permissions:h}}catch(a){return console.error("Error getting current user:",a),null}}async function h(){let a=await g();return a?console.log("[auth] Profile retrieved:",a.email,a.role):console.log("[auth] No profile found"),a}async function i(a){let b=await g();if(b||(0,d.redirect)("/versotech_main/login"),a&&!a.includes(b.role))throw Error("Insufficient permissions");return b}async function j(){let a=await g();if(a||(0,d.redirect)("/versotech_main/login"),"investor"!==a.role)throw Error("Investor access required");return a}async function k(){let a=await g();if(a||(0,d.redirect)("/versotech_main/login"),!e.includes(a.role))throw Error("Staff access required");return a}async function l(a){let b=await f(),{data:c,error:d}=await b.from("profiles").select("role").eq("id",a).single();if(!d&&c&&e.includes(c.role))return!0;let{data:g}=await b.rpc("get_user_personas",{p_user_id:a});return g?.some(a=>"staff"===a.persona_type||"ceo"===a.persona_type)||!1}a.s(["checkStaffAccess",()=>l,"getCurrentUser",()=>g,"getProfile",()=>h,"requireAuth",()=>i,"requireInvestorAuth",()=>j,"requireStaffAuth",()=>k])},718829,a=>{"use strict";var b=a.i(999684);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],718829)},441196,a=>{"use strict";let b=(0,a.i(718829).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],441196)},912238,a=>{"use strict";a.s(["Sidebar",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call Sidebar() from the server but Sidebar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/layout/sidebar.tsx <module evaluation>","Sidebar")},286563,a=>{"use strict";a.s(["Sidebar",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call Sidebar() from the server but Sidebar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/layout/sidebar.tsx","Sidebar")},496154,a=>{"use strict";a.i(912238);var b=a.i(286563);a.n(b)},445735,a=>{"use strict";a.s(["UserMenu",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call UserMenu() from the server but UserMenu is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/layout/user-menu.tsx <module evaluation>","UserMenu")},181058,a=>{"use strict";a.s(["UserMenu",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call UserMenu() from the server but UserMenu is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/layout/user-menu.tsx","UserMenu")},455428,a=>{"use strict";a.i(445735);var b=a.i(181058);a.n(b)},365595,a=>{"use strict";a.s(["GlobalKeyboardShortcuts",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call GlobalKeyboardShortcuts() from the server but GlobalKeyboardShortcuts is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/layout/global-keyboard-shortcuts.tsx <module evaluation>","GlobalKeyboardShortcuts")},520443,a=>{"use strict";a.s(["GlobalKeyboardShortcuts",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call GlobalKeyboardShortcuts() from the server but GlobalKeyboardShortcuts is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/layout/global-keyboard-shortcuts.tsx","GlobalKeyboardShortcuts")},586007,a=>{"use strict";a.i(365595);var b=a.i(520443);a.n(b)},619220,a=>{"use strict";a.s(["ThemeProvider",()=>c,"useTheme",()=>d]);var b=a.i(578644);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/theme-provider.tsx <module evaluation>","ThemeProvider"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call useTheme() from the server but useTheme is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/theme-provider.tsx <module evaluation>","useTheme")},199017,a=>{"use strict";a.s(["ThemeProvider",()=>c,"useTheme",()=>d]);var b=a.i(578644);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/theme-provider.tsx","ThemeProvider"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call useTheme() from the server but useTheme is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/theme-provider.tsx","useTheme")},684069,a=>{"use strict";a.i(619220);var b=a.i(199017);a.n(b)},336331,a=>{"use strict";a.s(["KYCAlert",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call KYCAlert() from the server but KYCAlert is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/dashboard/kyc-alert.tsx <module evaluation>","KYCAlert")},730807,a=>{"use strict";a.s(["KYCAlert",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call KYCAlert() from the server but KYCAlert is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/dashboard/kyc-alert.tsx","KYCAlert")},914402,a=>{"use strict";a.i(336331);var b=a.i(730807);a.n(b)},743513,a=>{"use strict";var b=a.i(714898),c=a.i(496154);let d="#0B5FFF",e={versoholdings:{name:"VERSO",loginPath:"/login",dashboardPath:"/versotech_main/dashboard",primary:d},versotech:{name:"VERSO Tech",loginPath:"/login",dashboardPath:"/versotech_main",primary:d}};function f({brand:a,className:c=""}){let d=e[a];return(0,b.jsx)("div",{className:`flex items-center ${c}`,children:(0,b.jsx)("h1",{className:`text-xl font-bold ${"versotech"===a?"text-foreground":"text-black"}`,children:d.name})})}var g=a.i(455428),h=a.i(586007),i=a.i(684069),j=a.i(243085);a.i(937413);var k=a.i(131360),l=a.i(198307),m=a.i(914402);async function n({children:a,brand:d}){let e=await (0,j.getProfile)();e||(0,k.redirect)("/login");let n=["staff_admin","staff_ops","staff_rm","ceo"].includes(e.role);console.log("[AppLayout] Profile check:",{brand:d,userRole:e.role,isStaffRole:n,email:e.email}),"versoholdings"===d&&"investor"!==e.role&&(console.log("[AppLayout] Redirecting non-investor from versoholdings"),(0,k.redirect)("/versotech_main")),"versotech"!==d||n||(console.log("[AppLayout] Redirecting non-staff from versotech"),(0,k.redirect)("/versotech_main/dashboard")),console.log("[AppLayout] Access granted for",e.email,"to",d);let o="versotech"===d,p="completed";if("versoholdings"===d&&"investor"===e.role)try{let a=await (0,l.createClient)(),{data:b}=await a.from("investor_users").select("investor_id, investors(kyc_status)").eq("user_id",e.id).single();b?.investors&&(p=b.investors.kyc_status||"not_started")}catch(a){console.error("[AppLayout] Error fetching KYC status:",a)}return(0,b.jsx)(i.ThemeProvider,{defaultTheme:o?"staff-dark":"light",children:(0,b.jsxs)("div",{className:"flex h-screen min-h-screen overflow-hidden bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/20 dark:from-zinc-950 dark:via-zinc-950 dark:to-zinc-950 dark:bg-zinc-950",children:[(0,b.jsx)(h.GlobalKeyboardShortcuts,{brand:d,role:e.role}),(0,b.jsx)(c.Sidebar,{brand:d,userProfile:e}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,b.jsxs)("header",{className:"bg-white/80 dark:bg-zinc-950 backdrop-blur-sm border-b border-gray-200 dark:border-white/10 px-6 py-4 flex items-center justify-between",children:[(0,b.jsx)(f,{brand:d}),(0,b.jsx)("div",{className:"flex items-center space-x-4",children:(0,b.jsx)(g.UserMenu,{profile:e,brand:d})})]}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto scrollbar-hide bg-transparent dark:bg-zinc-950 backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"min-h-full bg-white/60 dark:bg-transparent backdrop-blur-sm dark:backdrop-blur-none",children:[!o&&"completed"!==p&&(0,b.jsx)("div",{className:"px-6 pt-6",children:(0,b.jsx)(m.KYCAlert,{status:p})}),a]})})]})]})})}a.s(["AppLayout",()=>n],743513)},783637,a=>{"use strict";let b=(0,a.i(718829).default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["ShieldCheck",()=>b],783637)},238578,a=>{"use strict";a.s(["DataRoomPreviewCard",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call DataRoomPreviewCard() from the server but DataRoomPreviewCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/deals/data-room-preview-card.tsx <module evaluation>","DataRoomPreviewCard")},36928,a=>{"use strict";a.s(["DataRoomPreviewCard",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call DataRoomPreviewCard() from the server but DataRoomPreviewCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/deals/data-room-preview-card.tsx","DataRoomPreviewCard")},270848,a=>{"use strict";a.i(238578);var b=a.i(36928);a.n(b)},68614,a=>{"use strict";var b=a.i(714898),c=a.i(743513),d=a.i(198307),e=a.i(441196),f=a.i(783637),g=a.i(270848);async function h(){let a=await (0,d.createClient)(),{data:{user:h},error:i}=await a.auth.getUser();if(i||!h)throw Error("Authentication required");let j=(0,d.createServiceClient)(),{data:k}=await j.from("investor_users").select("investor_id").eq("user_id",h.id);if(!k||0===k.length)return(0,b.jsx)(c.AppLayout,{brand:"versoholdings",children:(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(e.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No investor profile linked"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Contact the VERSO team to activate your investor account."})]})})});let l=k.map(a=>a.investor_id),m=l[0],n=new Date().toISOString(),{data:o}=await j.from("deal_data_room_access").select("id, deal_id, investor_id, granted_at, expires_at, auto_granted, notes, revoked_at").in("investor_id",l).is("revoked_at",null).or(`expires_at.is.null,expires_at.gt.${n}`).order("granted_at",{ascending:!1}),p=o??[],q=Array.from(new Set(p.map(a=>a.deal_id))),r=[],s=[],t=[];if(q.length>0){let{data:a}=await j.from("deals").select("id, name, company_name, company_logo_url, stage, sector, location, close_at, currency").in("id",q);r=a??[];let{data:b}=await j.from("deal_data_room_documents").select("id, deal_id, folder, file_key, file_name, created_at, external_link").in("deal_id",q).eq("visible_to_investors",!0).order("folder",{ascending:!0}).order("file_name",{ascending:!0});s=b??[];let{data:c}=await j.from("deal_subscription_submissions").select("id, deal_id, status, submitted_at, payload_json").in("deal_id",q).eq("investor_id",m).order("submitted_at",{ascending:!1});t=c??[]}let u=s.reduce((a,b)=>(a[b.deal_id]||(a[b.deal_id]=[]),a[b.deal_id].push(b),a),{}),v=r.reduce((a,b)=>(a[b.id]=b,a),{}),w=t.reduce((a,b)=>(a[b.deal_id]||(a[b.deal_id]=[]),a[b.deal_id].push(b),a),{});return(0,b.jsx)(c.AppLayout,{brand:"versoholdings",children:(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("header",{className:"space-y-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-black",children:"Data Rooms"}),(0,b.jsx)("p",{className:"text-sm text-black",children:"Browse available deals, review documents, and submit subscription requests."})]}),0===p.length?(0,b.jsxs)("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg bg-white",children:[(0,b.jsx)(f.ShieldCheck,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-black mb-1",children:"No data rooms available"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Submit interest on a deal or complete NDA requirements to unlock access."})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(a=>{let c=v[a.deal_id];if(!c)return null;let d=u[a.deal_id]??[],e=w[a.deal_id]??[];return(0,b.jsx)(g.DataRoomPreviewCard,{deal:c,access:{granted_at:a.granted_at,expires_at:a.expires_at},documentCount:d.length,status:e[0]?.status??null},a.id)})})]})})}a.s(["default",()=>h,"dynamic",0,"force-dynamic"])},361481,a=>{a.v(a=>Promise.resolve().then(()=>a(389018)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__30a41bdc._.js.map