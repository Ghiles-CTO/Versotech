module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},9349,a=>{a.n(a.i(142710))},199585,a=>{a.n(a.i(701395))},929852,a=>{a.n(a.i(816404))},516153,a=>{a.n(a.i(422096))},911164,a=>{a.n(a.i(273021))},450926,a=>{a.n(a.i(933743))},718829,a=>{"use strict";var b=a.i(999684);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],718829)},441196,a=>{"use strict";let b=(0,a.i(718829).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],441196)},75157,a=>{"use strict";async function b(a){let{data:{user:b},error:c}=await a.auth.getUser();return{user:b,error:c}}async function c(a,b,c){let{data:d}=await a.from("profiles").select("role").eq("id",b).single();if(d?.role==="ceo")return!0;let{data:e}=await a.from("ceo_users").select("user_id").eq("user_id",b).maybeSingle();if(e)return!0;let{data:f}=await a.from("staff_permissions").select("permission").eq("user_id",b).in("permission",c).limit(1).maybeSingle();return!!f}async function d(a,b){return c(a,b,["super_admin"])}a.s(["getAuthenticatedUser",()=>b,"isSuperAdmin",()=>d])},710494,a=>{"use strict";a.s(["UserDetailClient",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call UserDetailClient() from the server but UserDetailClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/app/(main)/versotech_main/users/[id]/user-detail-client.tsx <module evaluation>","UserDetailClient")},708858,a=>{"use strict";a.s(["UserDetailClient",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call UserDetailClient() from the server but UserDetailClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/app/(main)/versotech_main/users/[id]/user-detail-client.tsx","UserDetailClient")},752453,a=>{"use strict";a.i(710494);var b=a.i(708858);a.n(b)},462326,a=>{"use strict";var b=a.i(714898),c=a.i(198307);a.i(937413);var d=a.i(131360),e=a.i(752453),f=a.i(441196),g=a.i(243085),h=a.i(75157);async function i({params:a}){let{id:i}=await a,j=await (0,c.createClient)(),{data:{user:k},error:l}=await j.auth.getUser();(!k||l)&&(0,d.redirect)("/versotech_main/login");let m=await (0,g.checkStaffAccess)(k.id),n=(0,c.createServiceClient)();if(!m)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(f.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Access Restricted"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"User details are only available to staff members."})]})});if(!await (0,h.isSuperAdmin)(n,k.id))return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(f.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Admin Access Required"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"You need admin permissions to view user details."})]})});let{data:o,error:p}=await n.from("profiles").select("id, display_name, email, role, title, phone, office_location, avatar_url, created_at, last_login_at, password_set, is_super_admin, signature_specimen_url, deleted_at, bio").eq("id",i).single();(p||!o)&&(console.error("[User Detail] Profile error:",p),(0,d.notFound)());let[q,r,s,t,u,v]=await Promise.all([n.from("investor_users").select("user_id, investor_id, role, is_primary, can_sign, ceo_approval_status, investors:investors!investor_users_investor_id_fkey(id, legal_name)").eq("user_id",i),n.from("partner_users").select("user_id, partner_id, role, is_primary, can_sign, ceo_approval_status, partners:partners!partner_users_partner_fk(id, name, legal_name)").eq("user_id",i),n.from("lawyer_users").select("user_id, lawyer_id, role, is_primary, can_sign, ceo_approval_status, lawyers:lawyers!lawyer_users_lawyer_fk(id, firm_name, display_name)").eq("user_id",i),n.from("commercial_partner_users").select("user_id, commercial_partner_id, role, is_primary, can_sign, ceo_approval_status, commercial_partners:commercial_partners!commercial_partner_users_cp_fk(id, name, legal_name)").eq("user_id",i),n.from("introducer_users").select("user_id, introducer_id, role, is_primary, can_sign, ceo_approval_status, introducers:introducers!introducer_users_introducer_fk(id, legal_name)").eq("user_id",i),n.from("arranger_users").select("user_id, arranger_id, role, is_primary, can_sign, ceo_approval_status, arranger_entities:arranger_entities!arranger_users_arranger_fk(id, legal_name)").eq("user_id",i)]),w=[],x=a=>Array.isArray(a)?a[0]:a;if(q.data)for(let a of q.data){let b=x(a.investors);b&&w.push({id:b.id,name:b.legal_name||"Unnamed Investor",type:"investor",role:a.role||"member",isPrimary:a.is_primary||!1,canSign:a.can_sign||!1,approvalStatus:a.ceo_approval_status})}if(r.data)for(let a of r.data){let b=x(a.partners);b&&w.push({id:b.id,name:b.name||b.legal_name||"Unnamed Partner",type:"partner",role:a.role||"member",isPrimary:a.is_primary||!1,canSign:a.can_sign||!1,approvalStatus:a.ceo_approval_status})}if(s.data)for(let a of s.data){let b=x(a.lawyers);b&&w.push({id:b.id,name:b.firm_name||b.display_name||"Unnamed Law Firm",type:"lawyer",role:a.role||"member",isPrimary:a.is_primary||!1,canSign:a.can_sign||!1,approvalStatus:a.ceo_approval_status})}if(t.data)for(let a of t.data){let b=x(a.commercial_partners);b&&w.push({id:b.id,name:b.name||b.legal_name||"Unnamed Commercial Partner",type:"commercial_partner",role:a.role||"member",isPrimary:a.is_primary||!1,canSign:a.can_sign||!1,approvalStatus:a.ceo_approval_status})}if(u.data)for(let a of u.data){let b=x(a.introducers);b&&w.push({id:b.id,name:b.legal_name||"Unnamed Introducer",type:"introducer",role:a.role||"member",isPrimary:a.is_primary||!1,canSign:a.can_sign||!1,approvalStatus:a.ceo_approval_status})}if(v.data)for(let a of v.data){let b=x(a.arranger_entities);b&&w.push({id:b.id,name:b.legal_name||"Unnamed Arranger",type:"arranger",role:a.role||"member",isPrimary:a.is_primary||!1,canSign:a.can_sign||!1,approvalStatus:a.ceo_approval_status})}let y=null,z=null;if(o.email){let a=`
      email,
      kyc_status,
      first_name,
      middle_name,
      middle_initial,
      last_name,
      name_suffix,
      date_of_birth,
      country_of_birth,
      nationality,
      phone_mobile,
      phone_office,
      residential_street,
      residential_line_2,
      residential_city,
      residential_state,
      residential_postal_code,
      residential_country,
      is_us_citizen,
      is_us_taxpayer,
      us_taxpayer_id,
      country_of_tax_residency,
      tax_id_number,
      id_type,
      id_number,
      id_issue_date,
      id_expiry_date,
      id_issuing_country,
      proof_of_address_date,
      proof_of_address_expiry
    `,[b,c,d,e,f,g]=await Promise.all([n.from("investor_members").select(a).eq("email",o.email).limit(1).maybeSingle(),n.from("partner_members").select(a).eq("email",o.email).limit(1).maybeSingle(),n.from("lawyer_members").select(a).eq("email",o.email).limit(1).maybeSingle(),n.from("introducer_members").select(a).eq("email",o.email).limit(1).maybeSingle(),n.from("arranger_members").select(a).eq("email",o.email).limit(1).maybeSingle(),n.from("commercial_partner_members").select(a).eq("email",o.email).limit(1).maybeSingle()]),h=[b.data,c.data,d.data,e.data,f.data,g.data].filter(Boolean),i={approved:5,submitted:4,pending:3,rejected:2,expired:1};h.sort((a,b)=>{let c=i[a?.kyc_status||""]||0;return(i[b?.kyc_status||""]||0)-c});let j=h[0];j&&(y={status:j.kyc_status,idType:j.id_type,idExpiry:j.id_expiry_date,idExpiryWarning:function(a){if(!a)return null;let b=new Date(a),c=new Date,d=new Date(c.getTime()+2592e6);return b<c?"expired":b<d?"expiring_soon":null}(j.id_expiry_date),nationality:j.nationality,taxResidency:j.country_of_tax_residency,isUsPerson:j.is_us_citizen||!1},z={first_name:j.first_name,middle_name:j.middle_name,middle_initial:j.middle_initial,last_name:j.last_name,name_suffix:j.name_suffix,date_of_birth:j.date_of_birth,country_of_birth:j.country_of_birth,nationality:j.nationality,email:j.email,phone_mobile:j.phone_mobile,phone_office:j.phone_office,residential_street:j.residential_street,residential_line_2:j.residential_line_2,residential_city:j.residential_city,residential_state:j.residential_state,residential_postal_code:j.residential_postal_code,residential_country:j.residential_country,is_us_citizen:j.is_us_citizen,is_us_taxpayer:j.is_us_taxpayer,us_taxpayer_id:j.us_taxpayer_id,country_of_tax_residency:j.country_of_tax_residency,tax_id_number:j.tax_id_number,id_type:j.id_type,id_number:j.id_number,id_issue_date:j.id_issue_date,id_expiry_date:j.id_expiry_date,id_issuing_country:j.id_issuing_country,proof_of_address_date:j.proof_of_address_date,proof_of_address_expiry:j.proof_of_address_expiry})}let A={id:o.id,displayName:o.display_name||"Unknown",email:o.email||"",systemRole:o.role||"investor",title:o.title,phone:o.phone,officeLocation:o.office_location,avatarUrl:o.avatar_url,createdAt:o.created_at,lastLoginAt:o.last_login_at,passwordSet:o.password_set||!1,isSuperAdmin:o.is_super_admin||!1,hasSignature:!!o.signature_specimen_url,isDeleted:!!o.deleted_at,entities:w,entityCount:w.length,kyc:y};return(0,b.jsx)(e.UserDetailClient,{user:A,fullKycData:z})}a.s(["default",()=>i,"dynamic",0,"force-dynamic","revalidate",0,0])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5fc761f0._.js.map