module.exports=[634501,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(784021),e=a.i(391686),f=a.i(771088),g=a.i(421908),h=a.i(15788),i=a.i(105874),j=a.i(216316),k=a.i(470305),l=a.i(951870),m=a.i(249464),n=a.i(211374),o=a.i(284169),p=a.i(703606),q=a.i(264890),r=a.i(294565),s=a.i(478870),t=a.i(787957),u=a.i(92881),v=a.i(989002),w=a.i(3321),x=a.i(497412),y=a.i(888987),z=a.i(899750);function A(){return(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(f.Table,{children:[(0,b.jsx)(f.TableHeader,{children:(0,b.jsxs)(f.TableRow,{children:[(0,b.jsx)(f.TableHead,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-24"})}),(0,b.jsx)(f.TableHead,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-32"})}),(0,b.jsx)(f.TableHead,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-16"})}),(0,b.jsx)(f.TableHead,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-32"})}),(0,b.jsx)(f.TableHead,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-16"})}),(0,b.jsx)(f.TableHead,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-20"})}),(0,b.jsx)(f.TableHead,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-16"})}),(0,b.jsx)(f.TableHead,{className:"w-12"})]})}),(0,b.jsx)(f.TableBody,{children:Array.from({length:8}).map((a,c)=>(0,b.jsxs)(f.TableRow,{children:[(0,b.jsx)(f.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(n.Skeleton,{className:"h-8 w-8 rounded-full"}),(0,b.jsx)(n.Skeleton,{className:"h-4 w-32"})]})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-40"})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)(n.Skeleton,{className:"h-5 w-20 rounded-full"})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-32"})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-8"})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)(n.Skeleton,{className:"h-4 w-12"})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)(n.Skeleton,{className:"h-5 w-16 rounded-full"})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)(n.Skeleton,{className:"h-8 w-8"})})]},c))})]})})})}function B(){return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[(0,b.jsx)("div",{className:"rounded-full bg-muted p-4 mb-4",children:(0,b.jsx)(s.Users,{className:"h-8 w-8 text-muted-foreground"})}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-1",children:"No staff members found"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground text-center max-w-sm",children:"There are no staff members in the system yet. Invite staff members to get started."})]})}function C(){let[a,n]=(0,c.useState)([]),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)([{id:"display_name",desc:!1}]),[I,J]=(0,c.useState)(),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)([]),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(!1),Y=(0,c.useCallback)(async()=>{try{D(!0),F(null);let a=await fetch("/api/admin/staff"),b=await a.json();if(!b.success)throw Error(b.error||"Failed to fetch staff members");n(b.data?.staff_members||[]),J(b.data)}catch(a){F(a instanceof Error?a.message:"An error occurred")}finally{D(!1)}},[]);(0,c.useEffect)(()=>{Y()},[Y]);let Z=(0,c.useCallback)(async a=>{L(a),N(!0),T(!0);try{let b=await fetch(`/api/admin/staff/${a.id}/assigned-investors`),c=await b.json();c.success&&c.data?R(c.data):R([])}catch(a){R([])}finally{T(!1)}},[]),$=(0,c.useCallback)(a=>{L(a),V(""),P(!0)},[]),_=(0,c.useCallback)(async()=>{if(K&&U){X(!0);try{let a=await fetch("/api/admin/staff/transfer-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromStaffId:K.id,toStaffId:U})}),b=await a.json();if(!b.success)throw Error(b.error||"Failed to transfer assignments");z.toast.success("Assignments transferred",{description:`Investors reassigned from ${K.display_name} successfully.`}),P(!1),Y()}catch(a){z.toast.error("Failed to transfer",{description:a instanceof Error?a.message:"An error occurred"})}finally{X(!1)}}},[K,U,Y]),aa=(0,c.useMemo)(()=>{let a;return a={onViewAssigned:Z,onTransfer:$},[{accessorKey:"display_name",header:({column:a})=>(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>a.toggleSorting("asc"===a.getIsSorted()),className:"-ml-4",children:["User",(0,b.jsx)(r.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>{let c=a.original;return(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(i.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(i.AvatarImage,{src:void 0,alt:c.display_name}),(0,b.jsx)(i.AvatarFallback,{className:"text-xs",children:c.display_name.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2)})]}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)(x.default,{href:`/versotech_admin/users/${c.id}`,className:"font-medium hover:underline",children:c.display_name}),c.is_super_admin&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Super Admin"}),c.title&&!c.is_super_admin&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:c.title})]})]})}},{accessorKey:"email",header:({column:a})=>(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>a.toggleSorting("asc"===a.getIsSorted()),className:"-ml-4",children:["Email",(0,b.jsx)(r.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>(0,b.jsx)("span",{className:"text-muted-foreground",children:a.original.email})},{accessorKey:"role",header:"Role",cell:({row:a})=>{let c=a.original.role;return(0,b.jsx)(h.Badge,{variant:"ceo"===c?"default":c.startsWith("staff_")?"secondary":"outline",children:{ceo:"CEO",staff_admin:"Staff Admin",staff_ops:"Staff Ops",staff_rm:"Staff RM"}[c]||c})}},{accessorKey:"permissions",header:"Permissions",cell:({row:a})=>{let c=a.original.permissions;return(0,b.jsx)("span",{className:"text-sm text-muted-foreground max-w-[200px] truncate",title:c.join(", "),children:(a=>{if(0===a.length)return"None";let b=a.filter(a=>"super_admin"!==a).map(a=>a.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()));return 0===b.length?"Super Admin":b.slice(0,3).join(", ")+(b.length>3?` +${b.length-3}`:"")})(c)})}},{accessorKey:"assigned_investors",header:({column:a})=>(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>a.toggleSorting("asc"===a.getIsSorted()),className:"-ml-4",children:[(0,b.jsx)(u.UserCheck,{className:"mr-1 h-4 w-4"}),"Investors",(0,b.jsx)(r.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>{let c=a.original.assigned_investors;return(0,b.jsx)("div",{className:"flex items-center gap-1",children:(0,b.jsx)("span",{className:(0,y.cn)("font-medium",c>0?"text-foreground":"text-muted-foreground"),children:c})})}},{accessorKey:"activity_score_7d",header:({column:a})=>(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>a.toggleSorting("asc"===a.getIsSorted()),className:"-ml-4",children:[(0,b.jsx)(t.Activity,{className:"mr-1 h-4 w-4"}),"Activity (7d)",(0,b.jsx)(r.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>{let c=a.original.activity_score_7d;return(0,b.jsx)("span",{className:(0,y.cn)("font-medium",0===c?"text-muted-foreground":c<10?"text-yellow-600 dark:text-yellow-500":c<50?"text-blue-600 dark:text-blue-400":"text-green-600 dark:text-green-500"),children:c})}},{accessorKey:"status",header:"Status",cell:({row:a})=>{let c=a.original.status,{variant:d,className:e}="active"===c?{variant:"default",className:"bg-green-500 dark:bg-green-600 hover:bg-green-500/80 dark:hover:bg-green-600/80"}:{variant:"secondary",className:"bg-yellow-500 dark:bg-yellow-600 text-white hover:bg-yellow-500/80 dark:hover:bg-yellow-600/80"};return(0,b.jsx)(h.Badge,{variant:d,className:e,children:"active"===c?"Active":"Invited"})}},{id:"actions",header:"",cell:({row:c})=>{let d=c.original;return(0,b.jsxs)(j.DropdownMenu,{children:[(0,b.jsx)(j.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(g.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,b.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,b.jsx)(p.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,b.jsxs)(j.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(j.DropdownMenuLabel,{children:"Actions"}),(0,b.jsx)(j.DropdownMenuSeparator,{}),(0,b.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(x.default,{href:`/versotech_admin/users/${d.id}`,children:[(0,b.jsx)(q.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]})}),(0,b.jsxs)(j.DropdownMenuItem,{onClick:()=>a.onViewAssigned(d),children:[(0,b.jsx)(u.UserCheck,{className:"mr-2 h-4 w-4"}),"View Assigned Investors"]}),(0,b.jsxs)(j.DropdownMenuItem,{onClick:()=>a.onTransfer(d),children:[(0,b.jsx)(v.ArrowRightLeft,{className:"mr-2 h-4 w-4"}),"Transfer Assignments"]})]})]})}}]},[Z,$]),ab=(0,d.useReactTable)({data:a,columns:aa,onSortingChange:H,getCoreRowModel:(0,e.getCoreRowModel)(),getSortedRowModel:(0,e.getSortedRowModel)(),state:{sorting:G},getRowId:a=>a.id}),ac=(0,c.useMemo)(()=>a.filter(a=>a.id!==K?.id&&a.role.startsWith("staff_")),[a,K]);return E?(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4",children:[(0,b.jsx)("h3",{className:"font-medium text-destructive",children:"Error loading staff"}),(0,b.jsx)("p",{className:"text-sm text-destructive/80 mt-1",children:E}),(0,b.jsx)(g.Button,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>Y(),children:"Try Again"})]})}):(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Staff Members"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage internal team members and their permissions"})]})}),I&&(0,b.jsxs)("div",{className:"grid gap-4 grid-cols-2 md:grid-cols-4",children:[(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Staff"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:I.statistics.total_staff})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Active"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:I.statistics.active_staff})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Invited"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:I.statistics.invited_staff})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Super Admins"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:I.statistics.super_admins})]})]}),C?(0,b.jsx)(A,{}):0===a.length?(0,b.jsx)(B,{}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(f.Table,{children:[(0,b.jsx)(f.TableHeader,{children:ab.getHeaderGroups().map(a=>(0,b.jsx)(f.TableRow,{children:a.headers.map(a=>(0,b.jsx)(f.TableHead,{children:a.isPlaceholder?null:(0,d.flexRender)(a.column.columnDef.header,a.getContext())},a.id))},a.id))}),(0,b.jsx)(f.TableBody,{children:ab.getRowModel().rows.length?ab.getRowModel().rows.map(a=>(0,b.jsx)(f.TableRow,{className:"hover:bg-muted/50",children:a.getVisibleCells().map(a=>(0,b.jsx)(f.TableCell,{children:(0,d.flexRender)(a.column.columnDef.cell,a.getContext())},a.id))},a.id)):(0,b.jsx)(f.TableRow,{children:(0,b.jsx)(f.TableCell,{colSpan:aa.length,className:"h-24 text-center",children:"No staff members found."})})})]})}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",a.length," staff member",1!==a.length?"s":""]})]}),(0,b.jsx)(k.Dialog,{open:M,onOpenChange:N,children:(0,b.jsxs)(k.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Assigned Investors"}),(0,b.jsxs)(k.DialogDescription,{children:["Investors assigned to ",K?.display_name]})]}),(0,b.jsx)("div",{className:"py-4",children:S?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)(w.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===Q.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(s.Users,{className:"h-10 w-10 mx-auto text-muted-foreground mb-2"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No investors currently assigned"})]}):(0,b.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:Q.map(a=>(0,b.jsx)(o.Card,{className:"p-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(i.Avatar,{className:"h-8 w-8",children:(0,b.jsx)(i.AvatarFallback,{className:"text-xs",children:a.name.split(" ").map(a=>a[0]).join("").toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium truncate",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:a.email})]})]})},a.id))})}),(0,b.jsx)(k.DialogFooter,{children:(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>N(!1),children:"Close"})})]})}),(0,b.jsx)(k.Dialog,{open:O,onOpenChange:P,children:(0,b.jsxs)(k.DialogContent,{className:"sm:max-w-[425px]",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Transfer Assignments"}),(0,b.jsxs)(k.DialogDescription,{children:["Transfer all investor assignments from ",K?.display_name," to another staff member."]})]}),(0,b.jsxs)("div",{className:"py-4 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:"target-staff",children:"Transfer to"}),(0,b.jsxs)(l.Select,{value:U,onValueChange:V,children:[(0,b.jsx)(l.SelectTrigger,{id:"target-staff",children:(0,b.jsx)(l.SelectValue,{placeholder:"Select staff member"})}),(0,b.jsx)(l.SelectContent,{children:0===ac.length?(0,b.jsx)(l.SelectItem,{value:"_none",disabled:!0,children:"No other staff members available"}):ac.map(a=>(0,b.jsx)(l.SelectItem,{value:a.id,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{children:a.display_name}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:["(",a.assigned_investors," assigned)"]})]})},a.id))})]})]}),(0,b.jsx)("div",{className:"rounded-lg bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800 p-3",children:(0,b.jsxs)("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:[(0,b.jsx)("strong",{children:"Note:"})," This will transfer all ",K?.assigned_investors||0," investor assignments to the selected staff member."]})})]}),(0,b.jsxs)(k.DialogFooter,{children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),(0,b.jsxs)(g.Button,{onClick:_,disabled:!U||W,children:[W&&(0,b.jsx)(w.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Transfer Assignments"]})]})]})})]})}a.s(["default",()=>C])}];

//# sourceMappingURL=versotech-portal_src_app_%28admin%29_versotech_admin_users_staff_page_tsx_07cc4557._.js.map