module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},9349,a=>{a.n(a.i(142710))},199585,a=>{a.n(a.i(701395))},929852,a=>{a.n(a.i(816404))},516153,a=>{a.n(a.i(422096))},911164,a=>{a.n(a.i(273021))},450926,a=>{a.n(a.i(933743))},718829,a=>{"use strict";var b=a.i(999684);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],718829)},441196,a=>{"use strict";let b=(0,a.i(718829).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],441196)},944497,a=>{"use strict";var b=a.i(714898),c=a.i(599817);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}function i({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-footer",className:(0,c.cn)("flex items-center px-6 [.border-t]:pt-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardFooter",()=>i,"CardHeader",()=>e,"CardTitle",()=>f])},513594,a=>{"use strict";a.s(["AddInvestorModal",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call AddInvestorModal() from the server but AddInvestorModal is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/add-investor-modal.tsx <module evaluation>","AddInvestorModal")},448982,a=>{"use strict";a.s(["AddInvestorModal",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call AddInvestorModal() from the server but AddInvestorModal is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/add-investor-modal.tsx","AddInvestorModal")},451717,a=>{"use strict";a.i(513594);var b=a.i(448982);a.n(b)},122023,a=>{"use strict";a.s(["InvestorFilters",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorFilters() from the server but InvestorFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-filters.tsx <module evaluation>","InvestorFilters")},322846,a=>{"use strict";a.s(["InvestorFilters",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorFilters() from the server but InvestorFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-filters.tsx","InvestorFilters")},264551,a=>{"use strict";a.i(122023);var b=a.i(322846);a.n(b)},971079,a=>{"use strict";a.s(["ExportInvestorsButton",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call ExportInvestorsButton() from the server but ExportInvestorsButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/export-investors-button.tsx <module evaluation>","ExportInvestorsButton")},426786,a=>{"use strict";a.s(["ExportInvestorsButton",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call ExportInvestorsButton() from the server but ExportInvestorsButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/export-investors-button.tsx","ExportInvestorsButton")},508568,a=>{"use strict";a.i(971079);var b=a.i(426786);a.n(b)},597387,a=>{"use strict";a.s(["InvestorSearch",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorSearch() from the server but InvestorSearch is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-search.tsx <module evaluation>","InvestorSearch")},628439,a=>{"use strict";a.s(["InvestorSearch",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorSearch() from the server but InvestorSearch is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-search.tsx","InvestorSearch")},239622,a=>{"use strict";a.i(597387);var b=a.i(628439);a.n(b)},137548,a=>{"use strict";a.s(["InvestorsDataTable",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorsDataTable() from the server but InvestorsDataTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investors-data-table.tsx <module evaluation>","InvestorsDataTable")},190362,a=>{"use strict";a.s(["InvestorsDataTable",()=>b]);let b=(0,a.i(578644).registerClientReference)(function(){throw Error("Attempted to call InvestorsDataTable() from the server but InvestorsDataTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investors-data-table.tsx","InvestorsDataTable")},462575,a=>{"use strict";a.i(137548);var b=a.i(190362);a.n(b)},619541,a=>{"use strict";a.s(["dispatchInvestorInvite",()=>c,"investorColumns",()=>d]);var b=a.i(578644);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call dispatchInvestorInvite() from the server but dispatchInvestorInvite is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-columns.tsx <module evaluation>","dispatchInvestorInvite"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call investorColumns() from the server but investorColumns is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-columns.tsx <module evaluation>","investorColumns")},822811,a=>{"use strict";a.s(["dispatchInvestorInvite",()=>c,"investorColumns",()=>d]);var b=a.i(578644);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call dispatchInvestorInvite() from the server but dispatchInvestorInvite is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-columns.tsx","dispatchInvestorInvite"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call investorColumns() from the server but investorColumns is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/components/investors/investor-columns.tsx","investorColumns")},644231,a=>{"use strict";a.i(619541);var b=a.i(822811);a.n(b)},817815,a=>{"use strict";var b=a.i(714898),c=a.i(944497),d=a.i(198307),e=a.i(243085),f=a.i(451717),g=a.i(264551),h=a.i(508568),i=a.i(239622),j=a.i(462575),k=a.i(644231),l=a.i(441196);async function m({searchParams:a}){let m=await (0,d.createClient)(),{data:{user:n},error:o}=await m.auth.getUser();if(!n||o)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(l.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Authentication Required"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Please log in to view investors."})]})});let p=await (0,e.checkStaffAccess)(n.id),q=(0,d.createServiceClient)();if(!p)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(l.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Access Restricted"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Investor management is only available to staff members."})]})});let r=await a,s=parseInt(r.limit||"1000"),t=(parseInt(r.page||"1")-1)*s,u=q.from("investors").select(`
        id,
        legal_name,
        type,
        kyc_status,
        country,
        status,
        onboarding_status,
        aml_risk_rating,
        created_at,
        primary_rm,
        rm_profile:profiles!investors_primary_rm_fkey (
          id,
          display_name,
          email
        ),
        investor_users (
          user_id,
          profiles:profiles!investor_users_user_id_fkey (
            id,
            display_name,
            email,
            title,
            role
          )
        )
      `,{count:"exact"});r.q&&(u=u.or(`legal_name.ilike.%${r.q}%,email.ilike.%${r.q}%`)),r.status&&(u=u.eq("kyc_status",r.status)),r.type&&(u=u.eq("type",r.type)),r.rm&&(u=u.eq("primary_rm",r.rm));let{data:v,error:w,count:x}=await u.order("created_at",{ascending:!1}).range(t,t+s-1);w&&console.error("[Investors] Error fetching investors:",w);let y=(v||[]).map(a=>({...a,rm_profile:Array.isArray(a.rm_profile)?a.rm_profile[0]:a.rm_profile,investor_users:a.investor_users?.map(a=>({user_id:a.user_id,profiles:Array.isArray(a.profiles)?a.profiles[0]:a.profiles}))})),z=y.map(a=>a.id),A=new Map,B=new Map,C=!1;if(z.length>0){try{let{data:a,error:b}=await q.rpc("get_investor_capital_summary",{p_investor_ids:z});b&&(C=!0,console.warn("[Investors] Capital summary RPC unavailable:",b.message)),a&&a.forEach(a=>{A.set(a.investor_id,a)})}catch(a){C=!0,console.warn("[Investors] Capital summary RPC unavailable")}try{let{data:a}=await q.from("activity_feed").select("investor_id, created_at").in("investor_id",z).order("created_at",{ascending:!1});a&&a.forEach(a=>{B.has(a.investor_id)||B.set(a.investor_id,a.created_at)})}catch(a){console.warn("[Investors] Activity feed unavailable")}}let D=y.map(a=>{var b;let c=(a.investor_users||[]).map(a=>({id:a.profiles?.id||a.user_id,name:a.profiles?.display_name||"Unnamed User",email:a.profiles?.email||"No email",title:a.profiles?.title||"-"})),d=c[0],e=A.get(a.id),f=!C&&!!e;return{id:a.id,name:a.legal_name||"Unnamed Investor",type:a.type||"individual",email:d?.email||"No primary contact",kycStatus:function(a){if(!a)return"pending";let b=a.toLowerCase();return"approved"===b?"completed":b}(a.kyc_status),onboardingStatus:a.onboarding_status||(f&&e?.total_commitment?"completed":"pending"),totalCommitment:e?.total_commitment||0,totalContributed:e?.total_contributed||0,vehicleCount:e?.vehicle_count||0,metricsAvailable:f,lastActivity:B.get(a.id)||a.created_at||new Date().toISOString(),relationshipManager:a.rm_profile?.display_name||"Unassigned",riskRating:a.aml_risk_rating||((b=a.kyc_status)&&"approved"===b.toLowerCase()?"low":"medium"),country:a.country||"Unknown",users:c}}),E={total:x||D.length,active:D.filter(a=>"completed"===a.onboardingStatus||"active"===a.onboardingStatus).length,pending:D.filter(a=>["pending","review"].includes(a.kycStatus)).length,entities:D.filter(a=>"entity"===a.type).length,individuals:D.filter(a=>"individual"===a.type).length};return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Investor Management"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage investor accounts, linked users, and onboarding status"})]}),(0,b.jsx)(f.AddInvestorModal,{})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Investors"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-foreground",children:E.total}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Registered accounts"})]})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Active Accounts"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-400",children:E.active}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Fully onboarded"})]})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Pending KYC"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:E.pending}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Require attention"})]})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Entities"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:E.entities}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Entity investors"})]})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Individuals"})}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:E.individuals}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Individual investors"})]})]})]}),(0,b.jsx)(c.Card,{children:(0,b.jsx)(c.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)(i.InvestorSearch,{})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.InvestorFilters,{}),(0,b.jsx)(h.ExportInvestorsButton,{investors:D})]})]})})}),(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsxs)(c.CardTitle,{children:["All Investors (",x||D.length,")"]}),(0,b.jsx)(c.CardDescription,{children:"Comprehensive investor list with sortable columns and bulk actions"})]}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)(j.InvestorsDataTable,{columns:k.investorColumns,data:D})})]})]})}a.s(["default",()=>m,"dynamic",0,"force-dynamic","revalidate",0,0])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2a6df0b1._.js.map