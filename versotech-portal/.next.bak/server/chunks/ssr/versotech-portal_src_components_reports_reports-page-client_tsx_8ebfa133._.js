module.exports=[63107,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(899750),e=a.i(816854),f=a.i(142015),g=a.i(470305),h=a.i(421908),i=a.i(663475),j=a.i(249464),k=a.i(191675),l=a.i(951870),m=a.i(15788),n=a.i(266828),o=a.i(930939),p=a.i(877918),q=a.i(873785);function r({open:a,onOpenChange:e,onSubmit:f,vehicles:r=[]}){let[s,t]=(0,c.useState)({subject:"",category:"analysis",priority:"normal",details:"",preferredFormat:"pdf",includeBenchmark:!1,followUpCall:!1,dataFocus:[],dueDate:void 0,vehicleId:void 0}),[u,v]=(0,c.useState)(!1),w=(0,c.useMemo)(()=>r.map(a=>({value:a.id,label:a.name,type:a.type})),[r]),x=async()=>{if(s.subject.length<5)return void d.toast.error("Subject must be at least 5 characters");v(!0);try{await f({...s,vehicleId:s.vehicleId||void 0,dueDate:s.dueDate||void 0,dataFocus:s.dataFocus||[]}),t({subject:"",category:"analysis",priority:"normal",details:"",preferredFormat:"pdf",includeBenchmark:!1,followUpCall:!1,dataFocus:[],dueDate:void 0,vehicleId:void 0}),e(!1),d.toast.success("Request submitted successfully")}catch(a){console.error("Submit failed:",a)}finally{v(!1)}};return(0,b.jsx)(g.Dialog,{open:a,onOpenChange:a=>!u&&e(a),children:(0,b.jsxs)(g.DialogContent,{className:"max-w-2xl max-h-[90vh] flex flex-col",children:[(0,b.jsxs)(g.DialogHeader,{className:"flex-shrink-0",children:[(0,b.jsxs)(g.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(q.Send,{className:"h-5 w-5 text-blue-600"}),"Submit Custom Request"]}),(0,b.jsx)(g.DialogDescription,{children:"Need something specific? Send a request to the VERSO team and we'll get back to you shortly."})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-5 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"category",children:"Request Type"}),(0,b.jsxs)(l.Select,{value:s.category,onValueChange:a=>t({...s,category:a}),children:[(0,b.jsx)(l.SelectTrigger,{id:"category",children:(0,b.jsx)(l.SelectValue,{})}),(0,b.jsx)(l.SelectContent,{children:Object.entries(o.REQUEST_CATEGORIES).map(([a,c])=>(0,b.jsx)(l.SelectItem,{value:a,children:c.label},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"priority",children:"Priority"}),(0,b.jsxs)(l.Select,{value:s.priority||"normal",onValueChange:a=>t({...s,priority:a}),children:[(0,b.jsx)(l.SelectTrigger,{id:"priority",children:(0,b.jsx)(l.SelectValue,{})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"low",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Badge,{variant:"secondary",className:"text-xs",children:"Low"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:o.SLA_LABELS.low})]})}),(0,b.jsx)(l.SelectItem,{value:"normal",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Badge,{variant:"default",className:"text-xs",children:"Normal"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:o.SLA_LABELS.normal})]})}),(0,b.jsx)(l.SelectItem,{value:"high",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Badge,{variant:"destructive",className:"text-xs",children:"High"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:o.SLA_LABELS.high})]})})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(j.Label,{htmlFor:"subject",children:["Subject ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(i.Input,{id:"subject",placeholder:"Brief description of what you need",value:s.subject,onChange:a=>t({...s,subject:a.target.value}),maxLength:200}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.subject.length,"/200 characters"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"details",children:"Additional Details (Optional)"}),(0,b.jsx)(k.Textarea,{id:"details",placeholder:"Provide any additional context, specific requirements, date ranges, or other relevant information that will help the team understand your request...",rows:6,value:s.details,onChange:a=>t({...s,details:a.target.value}),maxLength:5e3,className:"resize-none"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.details?.length||0,"/5000 characters"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"vehicle",children:"Related Holding (Optional)"}),(0,b.jsxs)(l.Select,{value:s.vehicleId||"none",onValueChange:a=>t({...s,vehicleId:"none"===a?void 0:a}),children:[(0,b.jsx)(l.SelectTrigger,{id:"vehicle",children:(0,b.jsx)(l.SelectValue,{placeholder:"No specific holding"})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"none",children:"No specific holding"}),w.map(a=>(0,b.jsx)(l.SelectItem,{value:a.value,children:a.label},a.value))]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Connecting the request to a holding helps the team pull the right data faster."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"due-date",children:"Target Delivery Date"}),(0,b.jsx)(i.Input,{id:"due-date",type:"date",value:s.dueDate||"",onChange:a=>t({...s,dueDate:a.target.value})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Optional — let us know if you have a deadline in mind."})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"preferred-format",children:"Deliverable Format"}),(0,b.jsxs)(l.Select,{value:s.preferredFormat||"pdf",onValueChange:a=>t({...s,preferredFormat:a}),children:[(0,b.jsx)(l.SelectTrigger,{id:"preferred-format",children:(0,b.jsx)(l.SelectValue,{})}),(0,b.jsx)(l.SelectContent,{children:o.CUSTOM_REQUEST_FORMATS.map(a=>(0,b.jsx)(l.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{children:"Focus Areas"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:o.CUSTOM_REQUEST_DATA_FOCUS.map(a=>{let c=s.dataFocus?.includes(a.value);return(0,b.jsxs)("label",{className:"flex items-start gap-2 rounded-md border p-3 text-sm hover:bg-muted/50 cursor-pointer",children:[(0,b.jsx)(n.Checkbox,{checked:c,onCheckedChange:b=>{let c=new Set(s.dataFocus||[]);b?c.add(a.value):c.delete(a.value),t({...s,dataFocus:Array.from(c)})}}),(0,b.jsx)("div",{children:(0,b.jsx)("div",{className:"font-medium",children:a.label})})]},a.value)})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Select one or more focus areas to guide the analysis."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("label",{className:"flex items-start gap-2 rounded-md border p-3 text-sm bg-muted/30",children:[(0,b.jsx)(n.Checkbox,{checked:!!s.includeBenchmark,onCheckedChange:a=>t({...s,includeBenchmark:!!a})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:"Include benchmark comparisons"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Adds relevant indexes (where available) to performance analysis."})]})]}),(0,b.jsxs)("label",{className:"flex items-start gap-2 rounded-md border p-3 text-sm bg-muted/30",children:[(0,b.jsx)(n.Checkbox,{checked:!!s.followUpCall,onCheckedChange:a=>t({...s,followUpCall:!!a})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:"Request follow-up call"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"The team will schedule a call to walk through the results."})]})]})]}),(0,b.jsx)("div",{className:"bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(p.AlertCircle,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,b.jsx)("p",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Expected Response Time"}),(0,b.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:["The team typically responds to ",s.priority||"normal"," priority requests within"," ",(0,b.jsx)("strong",{children:o.SLA_LABELS[s.priority]||o.SLA_LABELS.normal}),". You'll receive a notification when your request is being processed."]})]})]})})]}),(0,b.jsxs)(g.DialogFooter,{className:"flex-shrink-0",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>e(!1),disabled:u,children:"Cancel"}),(0,b.jsx)(h.Button,{onClick:x,disabled:u||s.subject.length<5,children:u?"Submitting...":"Submit Request"})]})]})})}var s=a.i(42329),t=a.i(425622),u=a.i(838086),v=a.i(3321),w=a.i(441278);let x=(0,a.i(95799).default)("circle-dot",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);var y=a.i(92881),z=a.i(888987);let A={queued:{label:"Queued",icon:s.Clock,variant:"secondary",className:"bg-gray-100 text-gray-700 border-gray-200"},processing:{label:"Processing",icon:v.Loader2,variant:"default",className:"bg-blue-100 text-blue-700 border-blue-200 animate-pulse"},ready:{label:"Ready",icon:w.CheckCircle,variant:"default",className:"bg-green-100 text-green-700 border-green-200"},failed:{label:"Failed",icon:p.AlertCircle,variant:"destructive",className:"bg-red-100 text-red-700 border-red-200"}},B={open:{label:"Open",icon:x,variant:"secondary",className:"bg-gray-100 text-gray-700 border-gray-200"},assigned:{label:"Assigned",icon:y.UserCheck,variant:"default",className:"bg-yellow-100 text-yellow-700 border-yellow-200"},in_progress:{label:"In Progress",icon:v.Loader2,variant:"default",className:"bg-blue-100 text-blue-700 border-blue-200"},awaiting_info:{label:"Awaiting Info",icon:s.Clock,variant:"secondary",className:"bg-orange-100 text-orange-700 border-orange-200"},ready:{label:"Ready",icon:w.CheckCircle,variant:"default",className:"bg-green-100 text-green-700 border-green-200"},closed:{label:"Completed",icon:w.CheckCircle,variant:"secondary",className:"bg-gray-100 text-gray-600 border-gray-200"},cancelled:{label:"Cancelled",icon:p.AlertCircle,variant:"secondary",className:"bg-red-100 text-red-700 border-red-200"}};function C({status:a,type:c="report"}){let d="report"===c?A[a]:B[a];if(!d)return null;let e=d.icon;return(0,b.jsxs)(m.Badge,{variant:d.variant,className:(0,z.cn)("flex items-center gap-1.5 px-2.5 py-1 font-medium",d.className),children:[(0,b.jsx)(e,{className:(0,z.cn)("h-3.5 w-3.5","processing"===a&&"animate-spin")}),(0,b.jsx)("span",{children:d.label})]})}var D=a.i(380640);function E({requests:a,onDownload:c}){let d=a?.filter(a=>"closed"!==a.status)||[],e=a?.filter(a=>"closed"===a.status)?.slice(0,3)||[];if(!a||0===a.length)return(0,b.jsxs)("div",{className:"rounded-xl border border-dashed border-gray-300 bg-gray-50 p-8 text-center",children:[(0,b.jsx)(f.MessageSquare,{className:"mx-auto mb-4 h-12 w-12 text-gray-400 opacity-50"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"No requests yet"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Submit a custom request to get started."})]});let g=a=>{let d=o.REQUEST_CATEGORIES[a.category],e=(0,o.isOverdue)(a.due_date),g=a.result_doc_id&&("ready"===a.status||"closed"===a.status);return(0,b.jsxs)("div",{className:"flex items-start gap-4 rounded-lg border border-gray-200 bg-white p-4 shadow-sm transition-colors hover:bg-gray-50",children:[(0,b.jsx)("div",{className:"mt-1 flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-purple-50",children:(0,b.jsx)(f.MessageSquare,{className:"h-5 w-5 text-purple-600"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-1",children:a.subject}),(0,b.jsx)("p",{className:"mt-1 text-xs text-gray-600 line-clamp-2",children:a.details||"No additional details provided"})]}),(0,b.jsx)(C,{status:a.status,type:"request"})]}),(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-xs text-gray-600",children:[(0,b.jsx)(m.Badge,{variant:"outline",className:"border-gray-300 text-xs",children:d?.label||a.category}),(0,b.jsx)("span",{children:"•"}),(0,b.jsx)("span",{children:a.created_at?(0,D.formatDistanceToNow)(new Date(a.created_at),{addSuffix:!0}):"Unknown"}),"closed"!==a.status&&"ready"!==a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("div",{className:`flex items-center gap-1 ${e?"text-red-600 font-medium":""}`,children:[e&&(0,b.jsx)(u.AlertTriangle,{className:"h-3 w-3"}),(0,b.jsx)(s.Clock,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:(0,o.formatTimeRemaining)(a.due_date)})]})]}),a.assigned_to_profile&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("span",{children:["Assigned to ",a.assigned_to_profile.display_name]})]})]}),g&&(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>c?.(a.id,a.result_doc_id),className:"gap-2 border-gray-300",children:[(0,b.jsx)(t.Download,{className:"h-4 w-4"}),"Download Result"]})}),a.completion_note&&"closed"===a.status&&(0,b.jsxs)("div",{className:"mt-3 rounded-lg bg-gray-50 p-3 text-xs",children:[(0,b.jsx)("p",{className:"mb-1 font-medium text-gray-900",children:"Team Response:"}),(0,b.jsx)("p",{className:"text-gray-600",children:a.completion_note})]})]})]},a.id)};return(0,b.jsxs)("div",{className:"space-y-3",children:[d.length>0&&(0,b.jsx)("div",{className:"space-y-3",children:d.map(g)}),e.length>0&&(0,b.jsxs)(b.Fragment,{children:[d.length>0&&(0,b.jsxs)("div",{className:"relative py-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,b.jsx)("span",{className:"w-full border-t border-gray-200"})}),(0,b.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,b.jsx)("span",{className:"bg-white px-2 text-gray-500",children:"Recently Completed"})})]}),(0,b.jsx)("div",{className:"space-y-3 opacity-75",children:e.map(g)})]})]})}var F=a.i(284169),G=a.i(181608),H=a.i(546549),I=a.i(58834);function J({initialRequests:a,initialDocuments:e,folders:g,vehicles:i,initialView:j}){let[k,l]=(0,c.useState)(a),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(j),q=(0,I.createClient)(),s=(0,c.useMemo)(()=>e.map(a=>({id:a.id,type:a.type,file_name:a.name??a.file_key,file_key:a.file_key,file_size_bytes:a.file_size_bytes??0,created_at:a.created_at,created_by:a.created_by,scope:a.scope,watermark:a.watermark,metadata:a.metadata})),[e]),t=(0,c.useCallback)(async()=>{try{let a=await fetch("/api/requests");if(a.ok){let b=await a.json();l(b.requests||[])}}catch(a){console.error("Error fetching requests:",a)}},[]),u=(0,c.useCallback)(()=>{let a=q.channel("request_tickets_updates").on("postgres_changes",{event:"*",schema:"public",table:"request_tickets"},a=>{if("UPDATE"===a.eventType&&a.new){let b=a.new;"ready"===b.status?d.toast.success("Your custom request has been completed!"):"closed"===b.status&&d.toast.success("Your custom request has been closed"),t()}else"INSERT"===a.eventType&&t()}).subscribe();return()=>{q.removeChannel(a)}},[t,q]);async function v(a){try{let b=await fetch("/api/requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to submit custom request")}let c=await b.json();d.toast.success(c.message||"Custom request submitted successfully"),n(!1),t()}catch(a){throw console.error("Error submitting custom request:",a),d.toast.error(a instanceof Error?a.message:"Failed to submit custom request"),a}}return(0,c.useEffect)(()=>{let a=u();return()=>{a?.()}},[u]),(0,b.jsxs)("div",{className:"space-y-8 px-6 py-8",children:[(0,b.jsxs)(G.Tabs,{value:o,onValueChange:a=>p(a),className:"space-y-8",children:[(0,b.jsxs)(G.TabsList,{className:"grid w-full max-w-xl grid-cols-2 bg-white border border-gray-200 shadow-sm",children:[(0,b.jsx)(G.TabsTrigger,{value:"requests",className:"text-gray-700 data-[state=active]:bg-primary data-[state=active]:text-white",children:"Requests"}),(0,b.jsx)(G.TabsTrigger,{value:"documents",className:"text-gray-700 data-[state=active]:bg-primary data-[state=active]:text-white",children:"Documents"})]}),(0,b.jsx)(G.TabsContent,{value:"requests",className:"space-y-8",children:(0,b.jsxs)("section",{className:"grid gap-6 grid-cols-1 lg:grid-cols-[2fr,1fr]",children:[(0,b.jsxs)(F.Card,{className:"border border-gray-200 bg-white shadow-sm",children:[(0,b.jsxs)(F.CardHeader,{children:[(0,b.jsx)(F.CardTitle,{className:"text-xl font-semibold text-gray-900",children:"Your requests"}),(0,b.jsx)(F.CardDescription,{className:"text-gray-600",children:"Track your open analytics and document requests with the VERSO team."})]}),(0,b.jsx)(F.CardContent,{children:(0,b.jsx)(E,{requests:k})})]}),(0,b.jsxs)(F.Card,{className:"border border-gray-200 bg-white shadow-sm",children:[(0,b.jsxs)(F.CardHeader,{children:[(0,b.jsx)(F.CardTitle,{className:"text-base font-semibold text-gray-900",children:"Request something new"}),(0,b.jsx)(F.CardDescription,{className:"text-gray-600",children:"Tell us what you need and the team will confirm delivery milestones."})]}),(0,b.jsxs)(F.CardContent,{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Our team can prepare detailed analytics, presentations, and documents tailored to your mandates."}),(0,b.jsxs)(h.Button,{onClick:()=>n(!0),children:[(0,b.jsx)(f.MessageSquare,{className:"mr-2 h-4 w-4"}),"Create custom request"]})]})]})]})}),(0,b.jsx)(G.TabsContent,{value:"documents",children:(0,b.jsx)(K,{documents:e,folders:g,vehicles:i,documentsForFolders:s})})]}),(0,b.jsx)(r,{open:m,onOpenChange:n,onSubmit:v})]})}function K({documents:a,folders:c,vehicles:d,documentsForFolders:f}){let g=a.length;return(0,b.jsxs)(F.Card,{className:"border border-gray-200 bg-white shadow-sm",children:[(0,b.jsxs)(F.CardHeader,{children:[(0,b.jsx)(F.CardTitle,{className:"text-xl font-semibold text-gray-900",children:"Documents hub"}),(0,b.jsx)(F.CardDescription,{className:"text-gray-600",children:"Investor statements, agreements, NDAs, and tax packs organized by category for easier access."})]}),(0,b.jsx)(F.CardContent,{children:0===g?(0,b.jsxs)("div",{className:"rounded-xl border border-dashed border-gray-300 bg-gray-50 p-8 text-center",children:[(0,b.jsx)(e.FileText,{className:"mx-auto mb-4 h-12 w-12 text-gray-400 opacity-50"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"No documents yet"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"As soon as statements or reports are shared, they will appear here automatically."})]}):(0,b.jsx)(H.CategorizedDocumentsClient,{initialDocuments:a,vehicles:d})})]})}a.s(["ReportsPageClient",()=>J],63107)}];

//# sourceMappingURL=versotech-portal_src_components_reports_reports-page-client_tsx_8ebfa133._.js.map