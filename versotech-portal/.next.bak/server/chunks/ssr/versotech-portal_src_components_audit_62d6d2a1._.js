module.exports=[858223,a=>{"use strict";var b=a.i(352584),c=a.i(289633),d=a.i(663475),e=a.i(421908),f=a.i(487068),g=a.i(425622),h=a.i(611038),i=a.i(284169),j=a.i(951870);function k(){let a=(0,c.useRouter)(),k=(0,c.useSearchParams)(),[l,m]=(0,h.useState)(k.get("search")||""),n=async()=>{let a=await fetch(`/api/audit/export?${k.toString()}`),b=await a.blob(),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),document.body.removeChild(d)};return(0,b.jsx)(i.Card,{children:(0,b.jsx)(i.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(d.Input,{placeholder:"Search audit logs by actor, action, or entity...",className:"pl-10",value:l,onChange:a=>m(a.target.value),onKeyDown:b=>{let c;"Enter"===b.key&&(c=new URLSearchParams(k.toString()),l?c.set("search",l):c.delete("search"),a.push(`?${c.toString()}`))}})]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(j.Select,{defaultValue:k.get("risk")||"all",onValueChange:b=>{let c=new URLSearchParams(k.toString());b&&"all"!==b?c.set("risk",b):c.delete("risk"),a.push(`?${c.toString()}`)},children:[(0,b.jsx)(j.SelectTrigger,{className:"w-[140px]",children:(0,b.jsx)(j.SelectValue,{placeholder:"Risk Level"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All Risk Levels"}),(0,b.jsx)(j.SelectItem,{value:"low",children:"Low Risk"}),(0,b.jsx)(j.SelectItem,{value:"medium",children:"Medium Risk"}),(0,b.jsx)(j.SelectItem,{value:"high",children:"High Risk"}),(0,b.jsx)(j.SelectItem,{value:"critical",children:"Critical Risk"})]})]}),(0,b.jsxs)(j.Select,{defaultValue:k.get("action")||"all",onValueChange:b=>{let c=new URLSearchParams(k.toString());b&&"all"!==b?c.set("action",b):c.delete("action"),a.push(`?${c.toString()}`)},children:[(0,b.jsx)(j.SelectTrigger,{className:"w-[180px]",children:(0,b.jsx)(j.SelectValue,{placeholder:"Action Type"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All Actions"}),(0,b.jsx)(j.SelectItem,{value:"login_success",children:"Login Success"}),(0,b.jsx)(j.SelectItem,{value:"login_failed",children:"Login Failed"}),(0,b.jsx)(j.SelectItem,{value:"document_download",children:"Document Download"}),(0,b.jsx)(j.SelectItem,{value:"document_access",children:"Document Access"}),(0,b.jsx)(j.SelectItem,{value:"investor_data_modify",children:"Data Modify"}),(0,b.jsx)(j.SelectItem,{value:"user_role_change",children:"Role Change"}),(0,b.jsx)(j.SelectItem,{value:"workflow_execution",children:"Workflow"})]})]}),(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:n,children:[(0,b.jsx)(g.Download,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})})})}a.s(["AuditLogFilters",()=>k])},857610,a=>{"use strict";var b=a.i(352584),c=a.i(284169),d=a.i(15788),e=a.i(421908),f=a.i(496392),g=a.i(325866),h=a.i(816854),i=a.i(64730),j=a.i(787957),k=a.i(264890),l=a.i(318525),m=a.i(838086),n=a.i(611038),o=a.i(470305);function p(a){switch(a){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";case"critical":return"bg-red-200 text-red-900";default:return"bg-gray-100 text-foreground"}}function q(a){switch(a){case"staff_admin":return"bg-purple-100 text-purple-800";case"staff_rm":return"bg-blue-100 text-blue-800";case"staff_ops":return"bg-green-100 text-green-800";case"investor":default:return"bg-gray-100 text-foreground";case"system":return"bg-orange-100 text-orange-800"}}function r({logs:a}){let[r,s]=(0,n.useState)(null);return a&&0!==a.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsx)(c.CardTitle,{children:"Audit Trail"}),(0,b.jsxs)(c.CardDescription,{children:["Showing ",a.length," audit events"]})]}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>(0,b.jsx)("div",{className:"border border-gray-800 rounded-lg p-4 hover:bg-gray-900/50 transition-colors cursor-pointer",onClick:()=>s(a),children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[(0,b.jsx)("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center border ${"high"===a.risk_level||"critical"===a.risk_level?"bg-red-950/30 border-red-800":"medium"===a.risk_level?"bg-yellow-950/30 border-yellow-800":"bg-green-950/30 border-green-800"}`,children:function(a){switch(a){case"login_success":case"login_failed":case"failed_login_attempt":return(0,b.jsx)(g.User,{className:"h-4 w-4"});case"document_download":case"document_access":return(0,b.jsx)(h.FileText,{className:"h-4 w-4"});case"investor_data_modify":case"user_role_change":return(0,b.jsx)(i.Database,{className:"h-4 w-4"});case"workflow_execution":return(0,b.jsx)(j.Activity,{className:"h-4 w-4"});default:return(0,b.jsx)(f.Shield,{className:"h-4 w-4"})}}(a.action)}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:a.action.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}),a.compliance_flag&&(0,b.jsxs)(d.Badge,{className:"bg-yellow-100 text-yellow-800",children:[(0,b.jsx)(m.AlertTriangle,{className:"h-3 w-3 mr-1"}),"Compliance"]}),a.risk_level&&(0,b.jsxs)(d.Badge,{className:p(a.risk_level),children:[a.risk_level," risk"]})]}),(0,b.jsx)("p",{className:"text-foreground mb-3",children:a.details||"No details provided"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-foreground",children:"Actor"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:a.actor_email||"Unknown"}),a.actor_role&&(0,b.jsx)(d.Badge,{className:`${q(a.actor_role)} text-xs`,children:a.actor_role.replace("_"," ")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-foreground",children:"Timestamp"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:new Date(a.timestamp).toLocaleString()})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-foreground",children:"Entity"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:a.entity_type||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-foreground",children:"IP Address"}),(0,b.jsxs)("div",{className:"text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(l.Globe,{className:"h-3 w-3"}),a.ip_address||"N/A"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-foreground",children:"ID"}),(0,b.jsx)("div",{className:"text-muted-foreground font-mono text-xs",children:a.id.substring(0,8)})]})]})]})]}),(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>s(a),children:[(0,b.jsx)(k.Eye,{className:"h-4 w-4 mr-2"}),"Details"]})]})},a.id))})})]}),(0,b.jsx)(o.Dialog,{open:!!r,onOpenChange:()=>s(null),children:(0,b.jsxs)(o.DialogContent,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Audit Log Details"}),(0,b.jsx)(o.DialogDescription,{children:"Complete information for this audit event"})]}),r&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Event ID"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground font-mono",children:r.id})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Timestamp"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(r.timestamp).toLocaleString()})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Actor"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:r.actor_email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Role"}),(0,b.jsx)(d.Badge,{className:q(r.actor_role),children:r.actor_role||"Unknown"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Action"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:r.action})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Risk Level"}),(0,b.jsx)(d.Badge,{className:p(r.risk_level),children:r.risk_level||"Unknown"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"IP Address"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:r.ip_address||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Entity"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[r.entity_type," (",r.entity_id||"N/A",")"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Details"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:r.details})]}),r.user_agent&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"User Agent"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground font-mono text-xs break-all",children:r.user_agent})]}),r.before_value&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Before Value"}),(0,b.jsx)("pre",{className:"text-sm bg-gray-900 p-3 rounded-lg overflow-auto",children:JSON.stringify(r.before_value,null,2)})]}),r.after_value&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"After Value"}),(0,b.jsx)("pre",{className:"text-sm bg-gray-900 p-3 rounded-lg overflow-auto",children:JSON.stringify(r.after_value,null,2)})]})]})]})})]}):(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsx)(c.CardTitle,{children:"Audit Trail"}),(0,b.jsx)(c.CardDescription,{children:"Comprehensive log of all system activities and user actions"})]}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"No audit logs found. Try adjusting your filters."})})]})}a.s(["AuditLogTable",()=>r])},591781,a=>{"use strict";var b=a.i(352584),c=a.i(284169),d=a.i(421908),e=a.i(838086),f=a.i(289633);function g({alerts:a}){let g=(0,f.useRouter)(),h=async a=>{(await fetch(`/api/audit/compliance-alerts/${a}/review`,{method:"POST"})).ok&&g.refresh()};return a&&0!==a.length?(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsx)(c.CardTitle,{children:"Compliance Alerts"}),(0,b.jsxs)(c.CardDescription,{children:[a.length," events requiring compliance review"]})]}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:a.slice(0,5).map(a=>(0,b.jsxs)("div",{className:`flex items-center justify-between p-3 border rounded-lg ${"high"===a.severity||"critical"===a.severity?"bg-red-950/20 border-red-800":"bg-yellow-950/20 border-yellow-800"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,b.jsx)(e.AlertTriangle,{className:`h-4 w-4 ${"high"===a.severity||"critical"===a.severity?"text-red-400":"text-yellow-400"}`}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium text-foreground",children:a.alert_type.replace(/_/g," ")}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.description||"No description"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(a.created_at).toLocaleString()})]})]}),(0,b.jsx)(d.Button,{size:"sm",variant:"outline",onClick:()=>h(a.id),children:"Review"})]},a.id))})})]}):(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsx)(c.CardTitle,{children:"Compliance Alerts"}),(0,b.jsx)(c.CardDescription,{children:"Events requiring compliance review"})]}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)("div",{className:"text-center py-6 text-muted-foreground text-sm",children:"No open compliance alerts"})})]})}a.s(["ComplianceAlerts",()=>g])}];

//# sourceMappingURL=versotech-portal_src_components_audit_62d6d2a1._.js.map