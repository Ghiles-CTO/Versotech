{"version":3,"sources":["../../../../../versotech-portal/src/lib/staff/dashboard-cache.ts","../../../../../versotech-portal/src/lib/staff/dashboard-data.ts","../../../../../versotech-portal/src/components/dashboard/enhanced-staff-dashboard.tsx/__nextjs-internal-proxy.mjs","../../../../../versotech-portal/src/components/dashboard/realtime-staff-dashboard.tsx/__nextjs-internal-proxy.mjs","../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/video-intro-wrapper.tsx/__nextjs-internal-proxy.mjs","../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/page.tsx"],"sourcesContent":["import { unstable_cache as cache } from 'next/cache'\r\nimport { getStaffDashboardData, StaffDashboardData, DateRangeFilter } from './dashboard-data'\r\n\r\n/**\r\n * Production-ready cache using Next.js cache API\r\n * Works correctly in serverless environments (Vercel, AWS Lambda, etc.)\r\n *\r\n * Cache strategy:\r\n * - TTL: 5 minutes (300 seconds)\r\n * - Tag: 'staff-dashboard' for targeted revalidation\r\n * - Revalidation: Can be triggered manually via revalidateTag()\r\n */\r\n\r\nconst CACHE_TTL = 300 // 5 minutes in seconds\r\nconst CACHE_TAG = 'staff-dashboard'\r\n\r\n/**\r\n * Get cached staff dashboard data with optional date range filtering\r\n * @param dateRangeFilter - Optional date range to filter data\r\n * @param forceRefresh - If true, bypass cache and fetch fresh data\r\n */\r\nexport async function getCachedStaffDashboardData(\r\n  dateRangeFilter?: DateRangeFilter,\r\n  forceRefresh = false\r\n): Promise<StaffDashboardData> {\r\n  if (forceRefresh) {\r\n    console.log('[Dashboard Cache] Force refresh requested, bypassing cache')\r\n    return await getStaffDashboardData(dateRangeFilter)\r\n  }\r\n\r\n  // Create cache key that includes date range to ensure different ranges are cached separately\r\n  const cacheKey = dateRangeFilter?.from || dateRangeFilter?.to\r\n    ? `staff-dashboard-data-${dateRangeFilter.from?.toString()}-${dateRangeFilter.to?.toString()}`\r\n    : 'staff-dashboard-data-default'\r\n\r\n  // Create a cached version for this specific date range\r\n  const getCachedDashboardData = cache(\r\n    async () => {\r\n      console.log('[Dashboard Cache] Fetching fresh data from database for range:', dateRangeFilter)\r\n      return await getStaffDashboardData(dateRangeFilter)\r\n    },\r\n    [cacheKey],\r\n    {\r\n      revalidate: CACHE_TTL,\r\n      tags: [CACHE_TAG]\r\n    }\r\n  )\r\n\r\n  return await getCachedDashboardData()\r\n}\r\n\r\n/**\r\n * Invalidate dashboard cache\r\n * Use this when data changes that affect the dashboard\r\n *\r\n * @example\r\n * // After creating a new investor\r\n * await createInvestor(data)\r\n * await invalidateDashboardCache()\r\n */\r\nexport async function invalidateDashboardCache(): Promise<void> {\r\n  const { revalidateTag } = await import('next/cache')\r\n  // Next.js 16 requires cacheLife profile as second argument\r\n  // Using { expire: 0 } for immediate cache expiration (not stale-while-revalidate)\r\n  revalidateTag(CACHE_TAG, { expire: 0 })\r\n  console.log('[Dashboard Cache] Cache invalidated')\r\n}\r\n\r\n/**\r\n * Granular cache invalidation based on table changes\r\n * Only invalidates if the table affects dashboard data\r\n *\r\n * @param tableName - The database table that was modified\r\n *\r\n * @example\r\n * // After updating investor data\r\n * await updateInvestor(id, data)\r\n * await invalidateByTable('investors')\r\n */\r\nexport async function invalidateByTable(tableName: string): Promise<void> {\r\n  const tablesAffectingDashboard = [\r\n    'investors',\r\n    'tasks',\r\n    'workflow_runs',\r\n    'workflows',\r\n    'deals',\r\n    'request_tickets',\r\n    'fee_events',\r\n    'subscriptions'\r\n  ]\r\n\r\n  if (tablesAffectingDashboard.includes(tableName)) {\r\n    console.log(`[Dashboard Cache] Table ${tableName} modified, invalidating cache`)\r\n    await invalidateDashboardCache()\r\n  }\r\n}\r\n\r\n/**\r\n * Get cache configuration for monitoring\r\n * Note: With Next.js cache, we don't have access to internal cache stats\r\n * This is a limitation of Next.js's cache abstraction\r\n */\r\nexport function getCacheConfig() {\r\n  return {\r\n    ttl: CACHE_TTL,\r\n    tag: CACHE_TAG,\r\n    strategy: 'next-js-cache',\r\n    note: 'Using Next.js built-in cache (production-ready for serverless)'\r\n  }\r\n}\r\n","import { createServiceClient } from '@/lib/supabase/server'\r\n\r\ntype NullableString = string | null\r\n\r\nexport type MetricError = {\r\n  metric: string\r\n  message: string\r\n  code?: string\r\n}\r\n\r\nexport type StaffDashboardData = {\r\n  generatedAt: string\r\n  kpis: {\r\n    activeLps: number | null\r\n    pendingKyc: number | null\r\n    highPriorityKyc: number | null\r\n    workflowRunsThisMonth: number | null\r\n    complianceRate: number | null\r\n  }\r\n  processCenter: {\r\n    activeWorkflows: number | null\r\n  }\r\n  management: {\r\n    activeDeals: number | null\r\n    activeRequests: number | null\r\n    complianceRate: number | null\r\n    activeInvestors: number | null\r\n  }\r\n  recentActivity: Array<{\r\n    id: string\r\n    title: string\r\n    description: NullableString\r\n    activityType: 'fee' | 'subscription' | 'investor' | 'other'\r\n    createdAt: string\r\n    amount?: number\r\n    status?: string\r\n  }>\r\n  charts: {\r\n    fees: Array<{\r\n      date: string\r\n      amount: number\r\n      type: string\r\n    }>\r\n    subscriptions: Array<{\r\n      date: string\r\n      amount: number\r\n      status: string\r\n    }>\r\n  }\r\n  errors?: MetricError[]\r\n}\r\n\r\nconst startOfMonthISO = () => {\r\n  const now = new Date()\r\n  return new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), 1)).toISOString()\r\n}\r\n\r\nconst twelveMonthsAgoISO = () => {\r\n  const now = new Date()\r\n  now.setFullYear(now.getFullYear() - 1)\r\n  return now.toISOString()\r\n}\r\n\r\ntype CountResult = { count: number | null; error: string | null }\r\n\r\ntype CountPromise = Promise<{ count: number | null; error: { message: string; code?: string } | null }>\r\n\r\nasync function fetchCount(queryPromise: CountPromise, metricName: string): Promise<CountResult> {\r\n  try {\r\n    const { count, error } = await queryPromise\r\n    if (error) {\r\n      console.error(`[dashboard-data] Error fetching ${metricName}:`, error.message)\r\n      return { count: null, error: error.message }\r\n    }\r\n    return { count: count ?? 0, error: null }\r\n  } catch (error) {\r\n    const errorMsg = error instanceof Error ? error.message : 'Unknown error'\r\n    console.error(`[dashboard-data] Exception fetching ${metricName}:`, errorMsg)\r\n    return {\r\n      count: null,\r\n      error: errorMsg\r\n    }\r\n  }\r\n}\r\n\r\n// SQL-based aggregation for fee events (replaces JavaScript aggregation)\r\nasync function getFeeChartData(supabase: any, startDate: string) {\r\n  const { data, error } = await supabase.rpc('aggregate_fee_events_by_date', {\r\n    start_date: startDate\r\n  })\r\n\r\n  if (error) {\r\n    console.error('[dashboard-data] Error fetching aggregated fee data:', error)\r\n    // Fallback to manual aggregation if RPC doesn't exist\r\n    return { data: null, error }\r\n  }\r\n\r\n  return { data, error: null }\r\n}\r\n\r\n// SQL-based aggregation for subscriptions (replaces JavaScript aggregation)\r\nasync function getSubscriptionChartData(supabase: any, startDate: string) {\r\n  const { data, error } = await supabase.rpc('aggregate_subscriptions_by_date', {\r\n    start_date: startDate\r\n  })\r\n\r\n  if (error) {\r\n    console.error('[dashboard-data] Error fetching aggregated subscription data:', error)\r\n    // Fallback to manual aggregation if RPC doesn't exist\r\n    return { data: null, error }\r\n  }\r\n\r\n  return { data, error: null }\r\n}\r\n\r\n// Fallback: Helper to aggregate data by date if SQL aggregation fails\r\nfunction aggregateByDate(data: any[], dateKey: string, amountKey: string) {\r\n  const map = new Map<string, { date: string, amount: number }>()\r\n\r\n  data.forEach((item) => {\r\n    if (!item[dateKey]) return\r\n    // Ensure we use the date part only, handling potential timezones by taking the ISO date string directly\r\n    const date = new Date(item[dateKey]).toISOString().split('T')[0]\r\n    const amount = Number(item[amountKey]) || 0\r\n\r\n    if (!map.has(date)) {\r\n      map.set(date, {\r\n        date,\r\n        amount: 0\r\n      })\r\n    }\r\n\r\n    const entry = map.get(date)!\r\n    entry.amount += amount\r\n  })\r\n\r\n  return Array.from(map.values()).sort((a, b) => a.date.localeCompare(b.date))\r\n}\r\n\r\nexport type DateRangeFilter = {\r\n  from?: Date | string\r\n  to?: Date | string\r\n}\r\n\r\nexport async function getStaffDashboardData(\r\n  dateRangeFilter?: DateRangeFilter\r\n): Promise<StaffDashboardData> {\r\n  // Note: Auth validation is handled in the page component before calling this function\r\n  // Use service role client here because:\r\n  // 1. This function is called within unstable_cache() which cannot access cookies\r\n  // 2. Auth is already validated in the page component\r\n  // 3. Dashboard data is not user-specific - it shows all data for staff admins\r\n  const supabase = createServiceClient()\r\n  const errors: MetricError[] = []\r\n\r\n  const startOfMonth = startOfMonthISO()\r\n  // Use provided date range or default to 12 months ago\r\n  const chartStartDate = dateRangeFilter?.from\r\n    ? new Date(dateRangeFilter.from).toISOString()\r\n    : twelveMonthsAgoISO()\r\n\r\n  const [\r\n    activeLpsRes,\r\n    pendingKycRes,\r\n    highPriorityKycRes,\r\n    workflowRunsRes,\r\n    totalInvestorsRes,\r\n    compliantInvestorsRes,\r\n    workflowsRes,\r\n    dealsRes,\r\n    requestsRes,\r\n    // Replaced generic activity feed with specific business logic queries\r\n    latestFeesRes,\r\n    latestSubscriptionsRes,\r\n    latestInvestorsRes,\r\n    feesRes,\r\n    subscriptionsRes\r\n  ] = await Promise.all([\r\n    fetchCount(\r\n      supabase\r\n        .from('investors')\r\n        .select('id', { head: true, count: 'exact' })\r\n        .eq('status', 'active') as any,\r\n      'Active LPs'\r\n    ),\r\n    fetchCount(\r\n      supabase\r\n        .from('investors')\r\n        .select('id', { head: true, count: 'exact' })\r\n        .in('kyc_status', ['pending', 'review', 'completed']) as any,\r\n      'Pending KYC'\r\n    ),\r\n    fetchCount(\r\n      supabase\r\n        .from('tasks')\r\n        .select('id', { head: true, count: 'exact' })\r\n        .in('kind', ['kyc_individual', 'kyc_entity', 'kyc_aml_check', 'onboarding_profile', 'compliance_tax_forms'])\r\n        .in('status', ['pending', 'in_progress'])\r\n        .eq('priority', 'high') as any,\r\n      'High Priority KYC'\r\n    ),\r\n    fetchCount(\r\n      supabase\r\n        .from('workflow_runs')\r\n        .select('id', { head: true, count: 'exact' })\r\n        .gte('created_at', startOfMonth) as any,\r\n      'Workflow Runs (MTD)'\r\n    ),\r\n    fetchCount(\r\n      supabase.from('investors').select('id', { head: true, count: 'exact' }) as any,\r\n      'Total Investors'\r\n    ),\r\n    fetchCount(\r\n      supabase\r\n        .from('investors')\r\n        .select('id', { head: true, count: 'exact' })\r\n        .eq('kyc_status', 'approved') as any,\r\n      'Compliant Investors'\r\n    ),\r\n    fetchCount(\r\n      supabase\r\n        .from('workflows')\r\n        .select('id', { head: true, count: 'exact' })\r\n        .eq('is_active', true) as any,\r\n      'Active Workflows'\r\n    ),\r\n    fetchCount(\r\n      supabase\r\n        .from('deals')\r\n        .select('id', { head: true, count: 'exact' })\r\n        .in('status', ['open', 'allocation_pending', 'draft']) as any,\r\n      'Active Deals'\r\n    ),\r\n    fetchCount(\r\n      supabase\r\n        .from('request_tickets')\r\n        .select('id', { head: true, count: 'exact' })\r\n        .in('status', ['open', 'assigned', 'in_progress']) as any,\r\n      'Active Requests'\r\n    ),\r\n    // 1. Latest Fees\r\n    supabase\r\n        .from('fee_events')\r\n        .select('id, computed_amount, fee_type, created_at')\r\n        .order('created_at', { ascending: false })\r\n        .limit(5),\r\n    // 2. Latest Subscriptions\r\n    supabase\r\n        .from('subscriptions')\r\n        .select('id, commitment, status, created_at')\r\n        .order('created_at', { ascending: false })\r\n        .limit(5),\r\n    // 3. Latest Investors (e.g. newly approved)\r\n    supabase\r\n        .from('investors')\r\n        .select('id, status, kyc_status, created_at')\r\n        .order('created_at', { ascending: false })\r\n        .limit(5),\r\n\r\n    // Chart Data - Try SQL aggregation first, fallback to full data fetch\r\n    getFeeChartData(supabase, chartStartDate),\r\n    getSubscriptionChartData(supabase, chartStartDate)\r\n  ])\r\n\r\n  // Collect errors with specific metric names\r\n  if (latestFeesRes.error) {\r\n    errors.push({ metric: 'Latest Fees', message: latestFeesRes.error.message })\r\n  }\r\n  if (latestSubscriptionsRes.error) {\r\n    errors.push({ metric: 'Latest Subscriptions', message: latestSubscriptionsRes.error.message })\r\n  }\r\n  if (latestInvestorsRes.error) {\r\n    errors.push({ metric: 'Latest Investors', message: latestInvestorsRes.error.message })\r\n  }\r\n\r\n  const totalInvestors = totalInvestorsRes.count ?? 0\r\n  const compliantInvestors = compliantInvestorsRes.count ?? 0\r\n  const complianceRate = totalInvestors > 0 ? (compliantInvestors / totalInvestors) * 100 : null\r\n\r\n  // Process chart data with fallback\r\n  let aggregatedFees: any[] = []\r\n  let aggregatedSubscriptions: any[] = []\r\n\r\n  // Fees chart data\r\n  if (feesRes.error) {\r\n    errors.push({ metric: 'Fee Chart Data', message: feesRes.error.message })\r\n    // Try fallback: fetch raw data and aggregate in JavaScript\r\n    const fallbackFees = await supabase\r\n      .from('fee_events')\r\n      .select('computed_amount, created_at, fee_type')\r\n      .gte('created_at', chartStartDate)\r\n      .order('created_at', { ascending: true })\r\n\r\n    if (!fallbackFees.error && fallbackFees.data) {\r\n      aggregatedFees = aggregateByDate(fallbackFees.data, 'created_at', 'computed_amount')\r\n    }\r\n  } else {\r\n    aggregatedFees = feesRes.data ?? []\r\n  }\r\n\r\n  // Subscriptions chart data\r\n  if (subscriptionsRes.error) {\r\n    errors.push({ metric: 'Subscription Chart Data', message: subscriptionsRes.error.message })\r\n    // Try fallback: fetch raw data and aggregate in JavaScript\r\n    const fallbackSubs = await supabase\r\n      .from('subscriptions')\r\n      .select('commitment, created_at, status')\r\n      .gte('created_at', chartStartDate)\r\n      .order('created_at', { ascending: true })\r\n\r\n    if (!fallbackSubs.error && fallbackSubs.data) {\r\n      aggregatedSubscriptions = aggregateByDate(fallbackSubs.data, 'created_at', 'commitment')\r\n    }\r\n  } else {\r\n    aggregatedSubscriptions = subscriptionsRes.data ?? []\r\n  }\r\n\r\n  // Build Recent Activity\r\n  const activities: StaffDashboardData['recentActivity'] = []\r\n\r\n  // Add Fees\r\n  latestFeesRes.data?.forEach(fee => {\r\n    activities.push({\r\n        id: fee.id,\r\n        title: 'Fee Calculated',\r\n        description: `${fee.fee_type} fee of $${fee.computed_amount?.toLocaleString()}`,\r\n        activityType: 'fee',\r\n        createdAt: fee.created_at,\r\n        amount: fee.computed_amount,\r\n        status: 'processed'\r\n    })\r\n  })\r\n\r\n  // Add Subscriptions\r\n  latestSubscriptionsRes.data?.forEach(sub => {\r\n    activities.push({\r\n        id: sub.id,\r\n        title: 'New Subscription',\r\n        description: `Commitment: $${sub.commitment?.toLocaleString() ?? '0'}`,\r\n        activityType: 'subscription',\r\n        createdAt: sub.created_at,\r\n        amount: sub.commitment,\r\n        status: sub.status\r\n    })\r\n  })\r\n\r\n  // Add Investors\r\n  latestInvestorsRes.data?.forEach(inv => {\r\n    activities.push({\r\n        id: inv.id,\r\n        title: 'Investor Update',\r\n        description: `Status: ${inv.status}, KYC: ${inv.kyc_status}`,\r\n        activityType: 'investor',\r\n        createdAt: inv.created_at,\r\n        status: inv.kyc_status\r\n    })\r\n  })\r\n\r\n  // Sort and limit to top 10 most recent\r\n  activities.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\r\n  const recentActivity = activities.slice(0, 10)\r\n\r\n  // Collect errors from count queries\r\n  const countResults = [\r\n    { name: 'Active LPs', result: activeLpsRes },\r\n    { name: 'Pending KYC', result: pendingKycRes },\r\n    { name: 'High Priority KYC', result: highPriorityKycRes },\r\n    { name: 'Workflow Runs (MTD)', result: workflowRunsRes },\r\n    { name: 'Total Investors', result: totalInvestorsRes },\r\n    { name: 'Compliant Investors', result: compliantInvestorsRes },\r\n    { name: 'Active Workflows', result: workflowsRes },\r\n    { name: 'Active Deals', result: dealsRes },\r\n    { name: 'Active Requests', result: requestsRes }\r\n  ]\r\n\r\n  countResults.forEach(({ name, result }) => {\r\n    if (result.error) {\r\n      errors.push({ metric: name, message: result.error })\r\n    }\r\n  })\r\n\r\n  const data: StaffDashboardData = {\r\n    generatedAt: new Date().toISOString(),\r\n    kpis: {\r\n      activeLps: activeLpsRes.count,\r\n      pendingKyc: pendingKycRes.count,\r\n      highPriorityKyc: highPriorityKycRes.count,\r\n      workflowRunsThisMonth: workflowRunsRes.count,\r\n      complianceRate: complianceRate\r\n    },\r\n    processCenter: {\r\n      activeWorkflows: workflowsRes.count\r\n    },\r\n    management: {\r\n      activeDeals: dealsRes.count,\r\n      activeRequests: requestsRes.count,\r\n      complianceRate: complianceRate,\r\n      activeInvestors: activeLpsRes.count\r\n    },\r\n    recentActivity,\r\n    charts: {\r\n      fees: aggregatedFees.map((fee: any) => ({ ...fee, type: fee.type || 'total' })),\r\n      subscriptions: aggregatedSubscriptions.map((sub: any) => ({ ...sub, status: sub.status || 'active' }))\r\n    }\r\n  }\r\n\r\n  if (errors.length > 0) {\r\n    data.errors = errors\r\n  }\r\n\r\n  return data\r\n}\r\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const EnhancedStaffDashboard = registerClientReference(\n    function() { throw new Error(\"Attempted to call EnhancedStaffDashboard() from the server but EnhancedStaffDashboard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/components/dashboard/enhanced-staff-dashboard.tsx\",\n    \"EnhancedStaffDashboard\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const RealtimeStaffDashboard = registerClientReference(\n    function() { throw new Error(\"Attempted to call RealtimeStaffDashboard() from the server but RealtimeStaffDashboard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/components/dashboard/realtime-staff-dashboard.tsx\",\n    \"RealtimeStaffDashboard\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const VideoIntroWrapper = registerClientReference(\n    function() { throw new Error(\"Attempted to call VideoIntroWrapper() from the server but VideoIntroWrapper is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/app/(staff)/versotech/staff/video-intro-wrapper.tsx\",\n    \"VideoIntroWrapper\",\n);\n","import { requireStaffAuth } from '@/lib/auth'\r\nimport { EnhancedStaffDashboard } from '@/components/dashboard/enhanced-staff-dashboard'\r\nimport { RealtimeStaffDashboard } from '@/components/dashboard/realtime-staff-dashboard'\r\nimport { getCachedStaffDashboardData } from '@/lib/staff/dashboard-cache'\r\nimport { createClient } from '@/lib/supabase/server'\r\nimport { VideoIntroWrapper } from './video-intro-wrapper'\r\n\r\nexport const dynamic = 'force-dynamic'\r\n\r\nexport default async function StaffDashboard() {\r\n  const user = await requireStaffAuth()\r\n\r\n  // Check if user has seen intro video\r\n  const supabase = await createClient()\r\n  const { data: profile } = await supabase\r\n    .from('profiles')\r\n    .select('has_seen_intro_video')\r\n    .eq('id', user.id)\r\n    .single()\r\n  const showIntroVideo = profile?.has_seen_intro_video === false\r\n  const videoUrl = `${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/public-assets/videos/intro-video.mp4`\r\n\r\n  // Use cached dashboard data with 5-minute TTL\r\n  const data = await getCachedStaffDashboardData()\r\n\r\n  // Transform data for realtime component\r\n  const realtimeMetrics = {\r\n    activeLps: data.kpis.activeLps ?? 0,\r\n    pendingKyc: data.kpis.pendingKyc ?? 0,\r\n    workflowRuns: data.kpis.workflowRunsThisMonth ?? 0,\r\n    complianceRate: data.kpis.complianceRate ?? 0,\r\n    kycPipeline: data.kpis.highPriorityKyc ?? 0,\r\n    ndaInProgress: 0, // Not currently tracked in main data\r\n    subscriptionReview: 0, // Not currently tracked in main data\r\n    activeDeals: data.management.activeDeals ?? 0,\r\n    activeRequests: data.management.activeRequests ?? 0,\r\n    lastUpdated: data.generatedAt\r\n  }\r\n\r\n  return (\r\n    <VideoIntroWrapper showIntroVideo={showIntroVideo} videoUrl={videoUrl}>\r\n      <div className=\"space-y-6\">\r\n        {/* Real-time connection and live metrics */}\r\n        <RealtimeStaffDashboard initialData={realtimeMetrics} />\r\n\r\n        {/* Main comprehensive dashboard */}\r\n        <EnhancedStaffDashboard initialData={data} />\r\n      </div>\r\n    </VideoIntroWrapper>\r\n  )\r\n}"],"names":[],"mappings":"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","ignoreList":[2,3,4]}