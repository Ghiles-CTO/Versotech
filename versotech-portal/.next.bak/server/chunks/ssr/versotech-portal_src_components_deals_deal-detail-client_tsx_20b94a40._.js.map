{"version":3,"sources":["../../../../../versotech-portal/src/components/deals/data-room-document-editor.tsx","../../../../../versotech-portal/src/components/deals/deal-overview-tab.tsx","../../../../../versotech-portal/src/components/deals/add-share-lot-modal.tsx","../../../../../versotech-portal/src/components/deals/deal-inventory-tab.tsx","../../../../../versotech-portal/src/components/deals/add-participant-modal.tsx","../../../../../versotech-portal/src/components/deals/deal-members-tab.tsx","../../../../../versotech-portal/src/components/deals/deal-fee-plans-tab.tsx","../../../../../versotech-portal/src/components/deals/data-room-document-upload.tsx","../../../../../versotech-portal/src/components/deals/data-room-document-versions.tsx","../../../../../versotech-portal/src/components/deals/deal-documents-tab.tsx","../../../../../versotech-portal/src/components/deals/deal-activity-tab.tsx","../../../../../versotech-portal/src/components/deals/deal-term-sheet-tab.tsx","../../../../../versotech-portal/src/components/deals/deal-interest-tab.tsx","../../../../../versotech-portal/src/components/deals/deal-data-room-access-tab.tsx","../../../../../versotech-portal/src/components/deals/deal-subscriptions-tab.tsx","../../../../../versotech-portal/src/components/deals/faq-form-dialog.tsx","../../../../../versotech-portal/src/components/deals/faq-item.tsx","../../../../../versotech-portal/src/components/deals/deal-faq-tab.tsx","../../../../../versotech-portal/src/components/deals/deal-detail-client.tsx","../../../../../versotech-portal/node_modules/lucide-react/src/icons/send-horizontal.ts"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Checkbox } from '@/components/ui/checkbox'\nimport { Badge } from '@/components/ui/badge'\nimport { Loader2, X } from 'lucide-react'\nimport { toast } from 'sonner'\n\ninterface DocumentEditorProps {\n  dealId: string\n  documentId: string\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onSaved?: () => void\n  initialData?: {\n    file_name?: string\n    folder?: string\n    visible_to_investors?: boolean\n    tags?: string[]\n    document_notes?: string\n    document_expires_at?: string | null\n  }\n}\n\nconst FOLDERS = [\n  'Legal',\n  'KYC',\n  'Reports',\n  'Presentations',\n  'Financial Models',\n  'Misc'\n]\n\nexport function DataRoomDocumentEditor({\n  dealId,\n  documentId,\n  open,\n  onOpenChange,\n  onSaved,\n  initialData\n}: DocumentEditorProps) {\n  const [fileName, setFileName] = useState(initialData?.file_name || '')\n  const [folder, setFolder] = useState(initialData?.folder || 'Legal')\n  const [visibleToInvestors, setVisibleToInvestors] = useState(initialData?.visible_to_investors || false)\n  const [tags, setTags] = useState<string[]>(initialData?.tags || [])\n  const [tagInput, setTagInput] = useState('')\n  const [notes, setNotes] = useState(initialData?.document_notes || '')\n  const [expiresAt, setExpiresAt] = useState(\n    initialData?.document_expires_at \n      ? new Date(initialData.document_expires_at).toISOString().slice(0, 16)\n      : ''\n  )\n  const [saving, setSaving] = useState(false)\n\n  useEffect(() => {\n    if (initialData) {\n      setFileName(initialData.file_name || '')\n      setFolder(initialData.folder || 'Legal')\n      setVisibleToInvestors(initialData.visible_to_investors || false)\n      setTags(initialData.tags || [])\n      setNotes(initialData.document_notes || '')\n      setExpiresAt(\n        initialData.document_expires_at\n          ? new Date(initialData.document_expires_at).toISOString().slice(0, 16)\n          : ''\n      )\n    }\n  }, [initialData, open])\n\n  const addTag = () => {\n    const trimmed = tagInput.trim()\n    if (trimmed && !tags.includes(trimmed)) {\n      setTags([...tags, trimmed])\n      setTagInput('')\n    }\n  }\n\n  const removeTag = (tag: string) => {\n    setTags(tags.filter(t => t !== tag))\n  }\n\n  const handleSave = async () => {\n    setSaving(true)\n\n    try {\n      const response = await fetch(`/api/deals/${dealId}/documents/${documentId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          file_name: fileName,\n          folder,\n          visible_to_investors: visibleToInvestors,\n          tags,\n          document_notes: notes || null,\n          document_expires_at: expiresAt ? new Date(expiresAt).toISOString() : null\n        })\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error || 'Failed to update document')\n      }\n\n      toast.success('Document metadata updated successfully')\n      onOpenChange(false)\n\n      if (onSaved) {\n        onSaved()\n      }\n    } catch (error) {\n      console.error('Save error:', error)\n      toast.error(error instanceof Error ? error.message : 'Failed to save changes')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Edit Document Metadata</DialogTitle>\n          <DialogDescription>\n            Update document details, visibility, tags, and expiry settings.\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-4\">\n          {/* File Name */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"fileName\">File Name</Label>\n            <Input\n              id=\"fileName\"\n              value={fileName}\n              onChange={e => setFileName(e.target.value)}\n              placeholder=\"document.pdf\"\n            />\n          </div>\n\n          {/* Folder */}\n          <div className=\"space-y-2\">\n            <Label>Folder</Label>\n            <Select value={folder} onValueChange={setFolder}>\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {FOLDERS.map(f => (\n                  <SelectItem key={f} value={f}>\n                    {f}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* Visibility */}\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id=\"visible\"\n              checked={visibleToInvestors}\n              onCheckedChange={(checked) => setVisibleToInvestors(checked as boolean)}\n            />\n            <label\n              htmlFor=\"visible\"\n              className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n            >\n              Visible to investors\n            </label>\n          </div>\n\n          {/* Tags */}\n          <div className=\"space-y-2\">\n            <Label>Tags</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                value={tagInput}\n                onChange={e => setTagInput(e.target.value)}\n                onKeyPress={e => e.key === 'Enter' && (e.preventDefault(), addTag())}\n                placeholder=\"Add tag and press Enter\"\n              />\n              <Button type=\"button\" onClick={addTag} variant=\"outline\">\n                Add\n              </Button>\n            </div>\n            {tags.length > 0 && (\n              <div className=\"flex flex-wrap gap-2\">\n                {tags.map(tag => (\n                  <Badge key={tag} variant=\"secondary\" className=\"gap-1\">\n                    {tag}\n                    <X\n                      className=\"h-3 w-3 cursor-pointer\"\n                      onClick={() => removeTag(tag)}\n                    />\n                  </Badge>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Expiry Date */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"expiresAt\">Document Expiry (Optional)</Label>\n            <Input\n              id=\"expiresAt\"\n              type=\"datetime-local\"\n              value={expiresAt}\n              onChange={e => setExpiresAt(e.target.value)}\n            />\n            <p className=\"text-xs text-muted-foreground\">\n              Leave blank for no expiry. Expired documents will be hidden from investors.\n            </p>\n          </div>\n\n          {/* Notes */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"notes\">Internal Notes</Label>\n            <Textarea\n              id=\"notes\"\n              value={notes}\n              onChange={e => setNotes(e.target.value)}\n              rows={3}\n              placeholder=\"Add internal notes about this document (not visible to investors)\"\n            />\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={saving}>\n            Cancel\n          </Button>\n          <Button onClick={handleSave} disabled={saving}>\n            {saving && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n            Save Changes\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n","'use client'\r\n\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport {\r\n  CalendarDays,\r\n  TrendingUp,\r\n  DollarSign,\r\n  Building2\r\n} from 'lucide-react'\r\n\r\ninterface DealOverviewTabProps {\r\n  deal: any\r\n  memberships?: any[]\r\n  subscriptionsForJourney?: any[]\r\n}\r\n\r\nexport function DealOverviewTab({ deal, memberships = [], subscriptionsForJourney = [] }: DealOverviewTabProps) {\r\n  const progressPercent = deal.target_amount\r\n    ? Math.round((deal.raised_amount / deal.target_amount) * 100)\r\n    : 0\r\n\r\n  // Create subscription map for journey tracking\r\n  const subscriptionMap = new Map(\r\n    subscriptionsForJourney.map(s => [s.investor_id, s])\r\n  )\r\n\r\n  // Enhance memberships with subscription data\r\n  const enhancedMembers = memberships.map(m => ({\r\n    ...m,\r\n    subscription: m.investor_id ? subscriptionMap.get(m.investor_id) : null\r\n  }))\r\n\r\n  // Calculate journey stats\r\n  const journeyStats = {\r\n    total: enhancedMembers.length,\r\n    dispatched: enhancedMembers.filter(m => m.dispatched_at).length,\r\n    viewed: enhancedMembers.filter(m => m.viewed_at).length,\r\n    interested: enhancedMembers.filter(m => m.interest_confirmed_at).length,\r\n    ndaSigned: enhancedMembers.filter(m => m.nda_signed_at).length,\r\n    dataRoom: enhancedMembers.filter(m => m.data_room_granted_at).length,\r\n    packGen: enhancedMembers.filter(m => m.subscription?.pack_generated_at).length,\r\n    packSent: enhancedMembers.filter(m => m.subscription?.pack_sent_at).length,\r\n    signed: enhancedMembers.filter(m => m.subscription?.signed_at).length,\r\n    funded: enhancedMembers.filter(m => m.subscription?.funded_at).length,\r\n  }\r\n\r\n  const journeyStages = [\r\n    { label: 'Dispatched', count: journeyStats.dispatched },\r\n    { label: 'Viewed', count: journeyStats.viewed },\r\n    { label: 'Interested', count: journeyStats.interested },\r\n    { label: 'NDA', count: journeyStats.ndaSigned },\r\n    { label: 'Data Room', count: journeyStats.dataRoom },\r\n    { label: 'Pack Gen', count: journeyStats.packGen },\r\n    { label: 'Pack Sent', count: journeyStats.packSent },\r\n    { label: 'Signed', count: journeyStats.signed },\r\n    { label: 'Funded', count: journeyStats.funded },\r\n  ]\r\n\r\n  // Calculate conversion from previous stage\r\n  const getConversion = (idx: number) => {\r\n    if (idx === 0) return journeyStats.total > 0 ? Math.round((journeyStages[0].count / journeyStats.total) * 100) : 0\r\n    const prev = journeyStages[idx - 1].count\r\n    if (prev === 0) return 0\r\n    return Math.round((journeyStages[idx].count / prev) * 100)\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Investor Journey Pipeline - Minimalist Design */}\r\n      {memberships.length > 0 && (\r\n        <Card className=\"border border-border bg-muted/30 overflow-hidden\">\r\n          <CardHeader className=\"pb-2 pt-4 px-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground tracking-wide uppercase\">\r\n                Investor Pipeline\r\n              </CardTitle>\r\n              <span className=\"text-xs text-muted-foreground\">\r\n                {journeyStats.total} total\r\n              </span>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"px-6 pb-5\">\r\n            {/* Pipeline visualization */}\r\n            <div className=\"relative pt-2\">\r\n              {/* Connecting line */}\r\n              <div className=\"absolute top-[26px] left-5 right-5 h-[2px] bg-gradient-to-r from-emerald-500/20 via-emerald-500/10 to-transparent\" />\r\n\r\n              {/* Stage nodes */}\r\n              <div className=\"relative flex items-start justify-between\">\r\n                {journeyStages.map((stage, idx) => {\r\n                  const isActive = stage.count > 0\r\n                  const isFinal = stage.label === 'Funded'\r\n                  const conversion = getConversion(idx)\r\n\r\n                  return (\r\n                    <div\r\n                      key={stage.label}\r\n                      className=\"flex flex-col items-center group\"\r\n                      style={{ flex: '1 1 0' }}\r\n                    >\r\n                      {/* Node circle */}\r\n                      <div\r\n                        className={`\r\n                          relative z-10 w-11 h-11 rounded-full flex items-center justify-center\r\n                          text-sm font-semibold transition-all duration-300 cursor-default\r\n                          ${isActive\r\n                            ? isFinal\r\n                              ? 'bg-emerald-500/25 text-emerald-300 ring-2 ring-emerald-500/40 shadow-[0_0_20px_rgba(16,185,129,0.15)]'\r\n                              : 'bg-emerald-500/15 text-emerald-400 ring-1 ring-emerald-500/25'\r\n                            : 'bg-muted text-muted-foreground/60'\r\n                          }\r\n                          group-hover:scale-110 group-hover:ring-emerald-400/40\r\n                        `}\r\n                      >\r\n                        {stage.count}\r\n                      </div>\r\n\r\n                      {/* Label */}\r\n                      <span className={`\r\n                        text-[10px] mt-2 text-center leading-tight transition-colors\r\n                        ${isActive ? 'text-foreground/70' : 'text-muted-foreground/50'}\r\n                        group-hover:text-foreground\r\n                      `}>\r\n                        {stage.label}\r\n                      </span>\r\n\r\n                      {/* Conversion rate tooltip on hover */}\r\n                      {idx > 0 && (\r\n                        <span className={`\r\n                          text-[9px] mt-0.5 transition-opacity\r\n                          ${stage.count > 0 ? 'text-emerald-400/60' : 'text-muted-foreground/30'}\r\n                        `}>\r\n                          {conversion}%\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  )\r\n                })}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Summary stats row */}\r\n            <div className=\"flex items-center justify-center gap-8 mt-6 pt-4 border-t border-border\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-lg font-semibold text-foreground\">{journeyStats.funded}</div>\r\n                <div className=\"text-[10px] text-muted-foreground uppercase tracking-wider\">Funded</div>\r\n              </div>\r\n              <div className=\"w-px h-8 bg-muted\" />\r\n              <div className=\"text-center\">\r\n                <div className=\"text-lg font-semibold text-foreground\">\r\n                  {journeyStats.total > 0 ? Math.round((journeyStats.funded / journeyStats.total) * 100) : 0}%\r\n                </div>\r\n                <div className=\"text-[10px] text-muted-foreground uppercase tracking-wider\">Conversion</div>\r\n              </div>\r\n              <div className=\"w-px h-8 bg-muted\" />\r\n              <div className=\"text-center\">\r\n                <div className=\"text-lg font-semibold text-foreground\">{journeyStats.signed}</div>\r\n                <div className=\"text-[10px] text-muted-foreground uppercase tracking-wider\">Signed</div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Deal Information */}\r\n      <Card className=\"border border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <CardTitle className=\"text-foreground\">Deal Information</CardTitle>\r\n          <CardDescription>Core details and structure</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Deal Name</label>\r\n              <p className=\"text-lg text-foreground mt-1\">{deal.name}</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Company</label>\r\n              <p className=\"text-lg text-foreground mt-1\">{deal.company_name || '—'}</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Vehicle</label>\r\n              <div className=\"flex items-center gap-2 mt-1\">\r\n                {deal.vehicles ? (\r\n                  <>\r\n                    <Building2 className=\"h-4 w-4 text-muted-foreground\" />\r\n                    <span className=\"text-foreground\">{deal.vehicles.name}</span>\r\n                    <Badge variant=\"outline\" className=\"border-border\">\r\n                      {deal.vehicles.type}\r\n                    </Badge>\r\n                  </>\r\n                ) : (\r\n                  <span className=\"text-muted-foreground\">No vehicle assigned</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Arranger</label>\r\n              <div className=\"flex items-center gap-2 mt-1\">\r\n                {deal.arranger_entities ? (\r\n                  <>\r\n                    <Building2 className=\"h-4 w-4 text-amber-500\" />\r\n                    <span className=\"text-foreground\">\r\n                      {deal.arranger_entities.company_name || deal.arranger_entities.legal_name}\r\n                    </span>\r\n                    <Badge variant=\"outline\" className=\"border-amber-500/30 text-amber-400 bg-amber-500/10\">\r\n                      Mandate\r\n                    </Badge>\r\n                  </>\r\n                ) : (\r\n                  <span className=\"text-muted-foreground\">No arranger assigned</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Sector / Stage</label>\r\n              <p className=\"text-foreground mt-1\">\r\n                {deal.sector || '—'} {deal.stage && `• ${deal.stage}`}\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Location</label>\r\n              <p className=\"text-foreground mt-1\">{deal.location || '—'}</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Currency</label>\r\n              <p className=\"text-foreground mt-1\">{deal.currency}</p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Financial Details */}\r\n      <Card className=\"border border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n            <DollarSign className=\"h-5 w-5\" />\r\n            Fundraising Progress\r\n          </CardTitle>\r\n          <CardDescription>Target and raised amounts. Investment terms (price, min/max) are defined in the Term Sheet.</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Target Amount</label>\r\n              <p className=\"text-2xl font-bold text-foreground mt-1\">\r\n                {deal.currency} {deal.target_amount?.toLocaleString() || '—'}\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Raised Amount</label>\r\n              <p className=\"text-2xl font-bold text-emerald-400 mt-1\">\r\n                {deal.currency} {deal.raised_amount?.toLocaleString() || 0}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Progress Bar */}\r\n          {deal.target_amount > 0 && (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between text-sm\">\r\n                <span className=\"text-muted-foreground\">Progress</span>\r\n                <span className=\"font-medium text-foreground\">\r\n                  {progressPercent}% of target\r\n                </span>\r\n              </div>\r\n              <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\r\n                <div\r\n                  className=\"h-full bg-emerald-500 transition-all duration-300\"\r\n                  style={{ width: `${Math.min(progressPercent, 100)}%` }}\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Timeline */}\r\n      <Card className=\"border border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n            <CalendarDays className=\"h-5 w-5\" />\r\n            Timeline\r\n          </CardTitle>\r\n          <CardDescription>Important dates and deadlines</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Open Date</label>\r\n              <p className=\"text-foreground mt-1\">\r\n                {deal.open_at ? new Date(deal.open_at).toLocaleDateString('en-US', {\r\n                  year: 'numeric',\r\n                  month: 'long',\r\n                  day: 'numeric'\r\n                }) : '—'}\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Close Date</label>\r\n              <p className=\"text-foreground mt-1\">\r\n                {deal.close_at ? new Date(deal.close_at).toLocaleDateString('en-US', {\r\n                  year: 'numeric',\r\n                  month: 'long',\r\n                  day: 'numeric'\r\n                }) : '—'}\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Created</label>\r\n              <p className=\"text-foreground mt-1\">\r\n                {new Date(deal.created_at).toLocaleDateString('en-US', {\r\n                  year: 'numeric',\r\n                  month: 'long',\r\n                  day: 'numeric'\r\n                })}\r\n              </p>\r\n            </div>\r\n\r\n            {deal.close_at && new Date(deal.close_at) > new Date() && (\r\n              <div>\r\n                <label className=\"text-sm font-medium text-muted-foreground\">Days Remaining</label>\r\n                <p className=\"text-2xl font-bold text-emerald-200 mt-1\">\r\n                  {Math.ceil((new Date(deal.close_at).getTime() - new Date().getTime()) / (1000 * 60 * 60 * 24))}\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Description & Thesis */}\r\n      {(deal.description || deal.investment_thesis) && (\r\n        <Card className=\"border border-border bg-muted/50\">\r\n          <CardHeader>\r\n            <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n              <TrendingUp className=\"h-5 w-5\" />\r\n              Deal Overview\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            {deal.description && (\r\n              <div>\r\n                <label className=\"text-sm font-medium text-muted-foreground\">Description</label>\r\n                <p className=\"text-foreground mt-2 whitespace-pre-wrap\">{deal.description}</p>\r\n              </div>\r\n            )}\r\n\r\n            {deal.investment_thesis && (\r\n              <div>\r\n                <label className=\"text-sm font-medium text-muted-foreground\">Investment Thesis</label>\r\n                <p className=\"text-foreground mt-2 whitespace-pre-wrap\">{deal.investment_thesis}</p>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { Plus, Loader2 } from 'lucide-react'\r\nimport { useRouter } from 'next/navigation'\r\n\r\ninterface AddShareLotModalProps {\r\n  dealId: string\r\n  onSuccess?: () => void\r\n}\r\n\r\nexport function AddShareLotModal({ dealId, onSuccess }: AddShareLotModalProps) {\r\n  const router = useRouter()\r\n  const [open, setOpen] = useState(false)\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  const [formData, setFormData] = useState({\r\n    source_type: 'company',\r\n    counterparty_name: '',\r\n    units_total: '',\r\n    unit_cost: '',\r\n    currency: 'USD',\r\n    acquired_at: '',\r\n    lockup_until: '',\r\n    notes: ''\r\n  })\r\n\r\n  const updateField = (field: string, value: string) => {\r\n    setFormData(prev => ({ ...prev, [field]: value }))\r\n  }\r\n\r\n  const handleSubmit = async () => {\r\n    if (!formData.units_total || !formData.unit_cost) {\r\n      setError('Units and cost are required')\r\n      return\r\n    }\r\n\r\n    setLoading(true)\r\n    setError(null)\r\n\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/inventory`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          source_type: formData.source_type,\r\n          counterparty_name: formData.counterparty_name,\r\n          units_total: parseFloat(formData.units_total),\r\n          unit_cost: parseFloat(formData.unit_cost),\r\n          currency: formData.currency,\r\n          acquired_at: formData.acquired_at || null,\r\n          lockup_until: formData.lockup_until || null,\r\n          notes: formData.notes || null\r\n        })\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const data = await response.json()\r\n        throw new Error(data.error || 'Failed to add share lot')\r\n      }\r\n\r\n      // Reset form and close modal\r\n      setFormData({\r\n        source_type: 'company',\r\n        counterparty_name: '',\r\n        units_total: '',\r\n        unit_cost: '',\r\n        currency: 'USD',\r\n        acquired_at: '',\r\n        lockup_until: '',\r\n        notes: ''\r\n      })\r\n      setOpen(false)\r\n\r\n      // Trigger callback to refresh parent component\r\n      if (onSuccess) {\r\n        onSuccess()\r\n      }\r\n\r\n      router.refresh()\r\n    } catch (err: any) {\r\n      setError(err.message)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>\r\n        <Button className=\"gap-2\">\r\n          <Plus className=\"h-4 w-4\" />\r\n          Add Share Lot\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>Add Share Lot</DialogTitle>\r\n          <DialogDescription>\r\n            Add inventory to this deal from a share source\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"source_type\">Source Type *</Label>\r\n              <Select value={formData.source_type} onValueChange={(v) => updateField('source_type', v)}>\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"company\">Company</SelectItem>\r\n                  <SelectItem value=\"fund\">Fund</SelectItem>\r\n                  <SelectItem value=\"colleague\">Colleague</SelectItem>\r\n                  <SelectItem value=\"other\">Other</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"counterparty_name\">Counterparty Name</Label>\r\n              <Input\r\n                id=\"counterparty_name\"\r\n                placeholder=\"e.g., Former Employee\"\r\n                value={formData.counterparty_name}\r\n                onChange={(e) => updateField('counterparty_name', e.target.value)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"units_total\">Total Units *</Label>\r\n              <Input\r\n                id=\"units_total\"\r\n                type=\"number\"\r\n                step=\"0.00000001\"\r\n                placeholder=\"50000\"\r\n                value={formData.units_total}\r\n                onChange={(e) => updateField('units_total', e.target.value)}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"unit_cost\">Unit Cost *</Label>\r\n              <Input\r\n                id=\"unit_cost\"\r\n                type=\"number\"\r\n                step=\"0.000001\"\r\n                placeholder=\"120.00\"\r\n                value={formData.unit_cost}\r\n                onChange={(e) => updateField('unit_cost', e.target.value)}\r\n                required\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-3 gap-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"currency\">Currency</Label>\r\n              <Select value={formData.currency} onValueChange={(v) => updateField('currency', v)}>\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"USD\">USD</SelectItem>\r\n                  <SelectItem value=\"EUR\">EUR</SelectItem>\r\n                  <SelectItem value=\"GBP\">GBP</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"acquired_at\">Acquired Date</Label>\r\n              <Input\r\n                id=\"acquired_at\"\r\n                type=\"date\"\r\n                value={formData.acquired_at}\r\n                onChange={(e) => updateField('acquired_at', e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"lockup_until\">Lockup Until</Label>\r\n              <Input\r\n                id=\"lockup_until\"\r\n                type=\"date\"\r\n                value={formData.lockup_until}\r\n                onChange={(e) => updateField('lockup_until', e.target.value)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"notes\">Notes</Label>\r\n            <Textarea\r\n              id=\"notes\"\r\n              placeholder=\"Additional information about this share lot...\"\r\n              rows={3}\r\n              value={formData.notes}\r\n              onChange={(e) => updateField('notes', e.target.value)}\r\n            />\r\n          </div>\r\n\r\n          {error && (\r\n            <div className=\"p-3 rounded-lg bg-red-500/20 border border-red-400/30 text-red-200 text-sm\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex justify-end gap-2 pt-4\">\r\n            <Button variant=\"outline\" onClick={() => setOpen(false)} disabled={loading}>\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleSubmit} disabled={loading}>\r\n              {loading ? (\r\n                <>\r\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                  Adding...\r\n                </>\r\n              ) : (\r\n                'Add Share Lot'\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\n","'use client'\r\n\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Plus, Package } from 'lucide-react'\r\nimport { AddShareLotModal } from './add-share-lot-modal'\r\n\r\ninterface DealInventoryTabProps {\r\n  dealId: string\r\n  shareLots: any[]\r\n  inventorySummary: {\r\n    total_units: number\r\n    available_units: number\r\n    reserved_units: number\r\n    allocated_units: number\r\n  }\r\n  onRefresh?: () => void\r\n}\r\n\r\nexport function DealInventoryTab({ dealId, shareLots, inventorySummary, onRefresh }: DealInventoryTabProps) {\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Summary Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card className=\"border-border bg-muted/50\">\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Total Units</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-2xl font-bold text-foreground\">\r\n              {inventorySummary.total_units.toLocaleString()}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-border bg-muted/50\">\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Available</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-2xl font-bold text-emerald-200\">\r\n              {inventorySummary.available_units.toLocaleString()}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-border bg-muted/50\">\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Reserved</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-2xl font-bold text-amber-200\">\r\n              {inventorySummary.reserved_units.toLocaleString()}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-border bg-muted/50\">\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Allocated</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-2xl font-bold text-sky-200\">\r\n              {inventorySummary.allocated_units.toLocaleString()}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Share Lots Table */}\r\n      <Card className=\"border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n                <Package className=\"h-5 w-5\" />\r\n                Share Lots\r\n              </CardTitle>\r\n              <CardDescription>Inventory sources and allocation tracking</CardDescription>\r\n            </div>\r\n            <AddShareLotModal dealId={dealId} onSuccess={onRefresh} />\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {!shareLots || shareLots.length === 0 ? (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              No share lots added yet. Click \"Add Share Lot\" to begin.\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {shareLots.map((lot) => (\r\n                <div\r\n                  key={lot.id}\r\n                  className=\"border border-border rounded-lg p-4 bg-muted/50 hover:bg-muted transition-colors\"\r\n                >\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"space-y-1\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-medium text-foreground\">\r\n                          {lot.share_sources?.counterparty_name || 'Unknown Source'}\r\n                        </span>\r\n                        <Badge variant=\"outline\" className=\"border-border text-xs\">\r\n                          {lot.share_sources?.kind}\r\n                        </Badge>\r\n                        <Badge className={\r\n                          lot.status === 'available' ? 'bg-emerald-500/20 text-emerald-200' :\r\n                          lot.status === 'exhausted' ? 'bg-red-500/20 text-red-200' :\r\n                          'bg-amber-500/20 text-amber-200'\r\n                        }>\r\n                          {lot.status}\r\n                        </Badge>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\r\n                        <span>Total: {lot.units_total.toLocaleString()} units</span>\r\n                        <span>Remaining: {lot.units_remaining.toLocaleString()} units</span>\r\n                        <span>Cost: {lot.currency} {lot.unit_cost.toFixed(2)}/unit</span>\r\n                        {lot.acquired_at && (\r\n                          <span>Acquired: {new Date(lot.acquired_at).toLocaleDateString()}</span>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <Button variant=\"outline\" size=\"sm\">Edit</Button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState, useEffect, useCallback } from 'react'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport {\r\n  Plus,\r\n  Loader2,\r\n  Users,\r\n  Building2,\r\n  Briefcase,\r\n  UserCircle,\r\n  Trash2,\r\n  AlertCircle,\r\n} from 'lucide-react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface AddParticipantModalProps {\r\n  dealId: string\r\n  onParticipantAdded?: () => void\r\n}\r\n\r\ntype ParticipantCategory = 'investor' | 'partner' | 'introducer' | 'commercial_partner'\r\ntype ReferringEntityType = 'partner' | 'introducer' | 'commercial_partner'\r\n\r\ninterface FeeComponent {\r\n  kind: string\r\n  rate_bps?: number\r\n  flat_amount?: number\r\n}\r\n\r\ninterface FeePlan {\r\n  id: string\r\n  name: string\r\n  description?: string\r\n  status: string\r\n  is_default: boolean\r\n  is_active: boolean\r\n  accepted_at?: string\r\n  fee_components: FeeComponent[]\r\n}\r\n\r\ninterface FeePlansResponse {\r\n  fee_plans: FeePlan[]\r\n  accepted_plans: FeePlan[]\r\n  can_dispatch: boolean\r\n  message: string | null\r\n  entity_name: string\r\n}\r\n\r\ninterface TermSheet {\r\n  id: string\r\n  version: number\r\n  status: string\r\n  subscription_fee_percent: number | null\r\n  management_fee_percent: number | null\r\n  carried_interest_percent: number | null\r\n  term_sheet_date: string | null\r\n}\r\n\r\n// Types for the new Introducer dispatch flow\r\ninterface ActiveAgreement {\r\n  id: string\r\n  introducer_id: string\r\n  introducer_name: string\r\n  fee_plan_id: string\r\n  fee_plan_name: string\r\n  term_sheet_id: string\r\n  term_sheet_version: number\r\n  reference_number?: string\r\n  signed_date?: string\r\n}\r\n\r\ninterface LinkableInvestor {\r\n  user_id: string\r\n  investor_id: string\r\n  display_name: string\r\n  email: string\r\n  current_role: string\r\n}\r\n\r\n// Roles that require a referring entity and fee plan\r\nconst ROLES_REQUIRING_REFERRER: Record<string, ReferringEntityType> = {\r\n  'partner_investor': 'partner',\r\n  'introducer_investor': 'introducer',\r\n  'commercial_partner_investor': 'commercial_partner',\r\n}\r\n\r\nconst PARTICIPANT_CATEGORIES = [\r\n  {\r\n    value: 'investor' as const,\r\n    label: 'Investor',\r\n    icon: UserCircle,\r\n    description: 'Individual or entity investing in this deal',\r\n    color: 'bg-emerald-500/20 text-emerald-300 border-emerald-500/30',\r\n  },\r\n  {\r\n    value: 'partner' as const,\r\n    label: 'Partner',\r\n    icon: Building2,\r\n    description: 'Distribution or syndicate partner',\r\n    color: 'bg-purple-500/20 text-purple-300 border-purple-500/30',\r\n  },\r\n  {\r\n    value: 'introducer' as const,\r\n    label: 'Introducer',\r\n    icon: Users,\r\n    description: 'Individual or entity introducing investors',\r\n    color: 'bg-orange-500/20 text-orange-300 border-orange-500/30',\r\n  },\r\n  {\r\n    value: 'commercial_partner' as const,\r\n    label: 'Commercial Partner',\r\n    icon: Briefcase,\r\n    description: 'Wealth manager, placement agent, etc.',\r\n    color: 'bg-cyan-500/20 text-cyan-300 border-cyan-500/30',\r\n  },\r\n]\r\n\r\nconst INVESTOR_ROLES = [\r\n  { value: 'investor', label: 'Investor' },\r\n  { value: 'co_investor', label: 'Co-Investor' },\r\n  { value: 'partner_investor', label: 'Partner Investor' },\r\n  { value: 'introducer_investor', label: 'Introducer Investor' },\r\n  { value: 'commercial_partner_investor', label: 'Commercial Partner Investor' },\r\n]\r\n\r\nconst FEE_KINDS = [\r\n  { value: 'subscription', label: 'Subscription Fee' },\r\n  { value: 'management', label: 'Management Fee' },\r\n  { value: 'performance', label: 'Performance Fee' },\r\n  { value: 'spread_markup', label: 'Spread Markup' },\r\n  { value: 'flat', label: 'Flat Fee' },\r\n]\r\n\r\nexport function AddParticipantModal({ dealId, onParticipantAdded }: AddParticipantModalProps) {\r\n  const router = useRouter()\r\n  const [open, setOpen] = useState(false)\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  // Step 1: Category selection\r\n  const [category, setCategory] = useState<ParticipantCategory | null>(null)\r\n\r\n  // Entity lists for dropdowns\r\n  const [investors, setInvestors] = useState<any[]>([])\r\n  const [partners, setPartners] = useState<any[]>([])\r\n  const [introducers, setIntroducers] = useState<any[]>([])\r\n  const [commercialPartners, setCommercialPartners] = useState<any[]>([])\r\n  const [entitiesLoading, setEntitiesLoading] = useState(false)\r\n\r\n  // Selected entity\r\n  const [selectedEntityId, setSelectedEntityId] = useState<string>('')\r\n  const [selectedEntity, setSelectedEntity] = useState<any>(null)\r\n\r\n  // Investor-specific fields\r\n  const [investorRole, setInvestorRole] = useState('investor')\r\n\r\n  // Referring entity for investor roles that require it\r\n  const [selectedReferringEntityId, setSelectedReferringEntityId] = useState<string>('')\r\n  const [selectedReferringEntity, setSelectedReferringEntity] = useState<any>(null)\r\n\r\n  // Fee plan selection (when dispatching through an entity)\r\n  const [feePlansData, setFeePlansData] = useState<FeePlansResponse | null>(null)\r\n  const [feePlansLoading, setFeePlansLoading] = useState(false)\r\n  const [selectedFeePlanId, setSelectedFeePlanId] = useState<string>('')\r\n\r\n  // Term sheet selection (for all investors - determines investor class)\r\n  const [publishedTermSheets, setPublishedTermSheets] = useState<TermSheet[]>([])\r\n  const [selectedTermSheetId, setSelectedTermSheetId] = useState<string>('')\r\n  const [termSheetsLoading, setTermSheetsLoading] = useState(false)\r\n\r\n  // Entity-specific fields (partner/commercial_partner only - introducer uses dispatch flow)\r\n  const [feePlanName, setFeePlanName] = useState('')\r\n  const [feeComponents, setFeeComponents] = useState<FeeComponent[]>([\r\n    { kind: 'subscription', rate_bps: 200 },\r\n  ])\r\n\r\n  // Introducer dispatch flow state\r\n  const [activeAgreements, setActiveAgreements] = useState<ActiveAgreement[]>([])\r\n  const [activeAgreementsLoading, setActiveAgreementsLoading] = useState(false)\r\n  const [selectedAgreementId, setSelectedAgreementId] = useState<string>('')\r\n  const [selectedAgreement, setSelectedAgreement] = useState<ActiveAgreement | null>(null)\r\n  const [linkableInvestors, setLinkableInvestors] = useState<LinkableInvestor[]>([])\r\n  const [linkableInvestorsLoading, setLinkableInvestorsLoading] = useState(false)\r\n  const [selectedLinkableInvestorId, setSelectedLinkableInvestorId] = useState<string>('')\r\n\r\n  // Check if current role requires a referring entity\r\n  const requiresReferrer = !!ROLES_REQUIRING_REFERRER[investorRole]\r\n  const referrerEntityType = ROLES_REQUIRING_REFERRER[investorRole]\r\n\r\n  // ===== CALLBACKS (defined first, before useEffects) =====\r\n\r\n  // Get the appropriate entity list for referring entity dropdown\r\n  const getReferringEntityList = useCallback(() => {\r\n    if (referrerEntityType === 'partner') return partners\r\n    if (referrerEntityType === 'introducer') return introducers\r\n    if (referrerEntityType === 'commercial_partner') return commercialPartners\r\n    return []\r\n  }, [referrerEntityType, partners, introducers, commercialPartners])\r\n\r\n  const loadAllEntities = useCallback(async () => {\r\n    setEntitiesLoading(true)\r\n    try {\r\n      // Load all entity types in parallel\r\n      const [investorsRes, partnersRes, introducersRes, cpRes] = await Promise.all([\r\n        fetch('/api/investors?has_users=true'),\r\n        fetch('/api/admin/partners?status=active'),\r\n        fetch('/api/admin/introducers?status=active'),\r\n        fetch('/api/admin/commercial-partners?status=active'),\r\n      ])\r\n\r\n      if (investorsRes.ok) {\r\n        const data = await investorsRes.json()\r\n        setInvestors(data.investors || data.data || [])\r\n      }\r\n      if (partnersRes.ok) {\r\n        const data = await partnersRes.json()\r\n        setPartners(data.partners || data.data || [])\r\n      }\r\n      if (introducersRes.ok) {\r\n        const data = await introducersRes.json()\r\n        setIntroducers(data.introducers || data.data || [])\r\n      }\r\n      if (cpRes.ok) {\r\n        const data = await cpRes.json()\r\n        setCommercialPartners(data.partners || data.commercial_partners || data.data || [])\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to load entities:', err)\r\n    } finally {\r\n      setEntitiesLoading(false)\r\n    }\r\n  }, [])\r\n\r\n  const fetchPublishedTermSheets = useCallback(async () => {\r\n    setTermSheetsLoading(true)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/fee-structures?status=published`)\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        setPublishedTermSheets(data.term_sheets || [])\r\n      }\r\n    } catch (err) {\r\n      console.error('Term sheets fetch failed:', err)\r\n    } finally {\r\n      setTermSheetsLoading(false)\r\n    }\r\n  }, [dealId])\r\n\r\n  const fetchFeePlans = useCallback(async () => {\r\n    if (!selectedReferringEntity || !referrerEntityType) return\r\n\r\n    setFeePlansLoading(true)\r\n    setFeePlansData(null)\r\n    setSelectedFeePlanId('')\r\n    try {\r\n      let endpoint = `/api/deals/${dealId}/dispatch/fee-plans?entity_id=${selectedReferringEntity.id}&entity_type=${referrerEntityType}`\r\n      if (selectedTermSheetId) {\r\n        endpoint += `&term_sheet_id=${selectedTermSheetId}`\r\n      }\r\n      const response = await fetch(endpoint)\r\n\r\n      if (response.ok) {\r\n        const data: FeePlansResponse = await response.json()\r\n        setFeePlansData(data)\r\n        // Auto-select if only one accepted plan\r\n        if (data.accepted_plans.length === 1) {\r\n          setSelectedFeePlanId(data.accepted_plans[0].id)\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Fee plans fetch failed:', err)\r\n    } finally {\r\n      setFeePlansLoading(false)\r\n    }\r\n  }, [dealId, selectedReferringEntity, referrerEntityType, selectedTermSheetId])\r\n\r\n  // Fetch active introducer agreements for the selected introducer on this deal\r\n  const fetchActiveAgreements = useCallback(async (introducerId: string) => {\r\n    setActiveAgreementsLoading(true)\r\n    setActiveAgreements([])\r\n    setSelectedAgreementId('')\r\n    setSelectedAgreement(null)\r\n    setLinkableInvestors([])\r\n    setSelectedLinkableInvestorId('')\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/active-agreements?introducer_id=${introducerId}`)\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        setActiveAgreements(data.agreements || [])\r\n      }\r\n    } catch (err) {\r\n      console.error('Active agreements fetch failed:', err)\r\n    } finally {\r\n      setActiveAgreementsLoading(false)\r\n    }\r\n  }, [dealId])\r\n\r\n  // Fetch linkable investors for a specific term sheet\r\n  const fetchLinkableInvestors = useCallback(async (termSheetId: string) => {\r\n    setLinkableInvestorsLoading(true)\r\n    setLinkableInvestors([])\r\n    setSelectedLinkableInvestorId('')\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/linkable-investors?term_sheet_id=${termSheetId}`)\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        setLinkableInvestors(data.investors || [])\r\n      }\r\n    } catch (err) {\r\n      console.error('Linkable investors fetch failed:', err)\r\n    } finally {\r\n      setLinkableInvestorsLoading(false)\r\n    }\r\n  }, [dealId])\r\n\r\n  // ===== USE EFFECTS (after callbacks are defined) =====\r\n\r\n  // Reset form when modal closes\r\n  useEffect(() => {\r\n    if (!open) {\r\n      setCategory(null)\r\n      setSelectedEntityId('')\r\n      setSelectedEntity(null)\r\n      setInvestorRole('investor')\r\n      setFeePlanName('')\r\n      setFeeComponents([{ kind: 'subscription', rate_bps: 200 }])\r\n      setError(null)\r\n      setSelectedReferringEntityId('')\r\n      setSelectedReferringEntity(null)\r\n      setFeePlansData(null)\r\n      setSelectedFeePlanId('')\r\n      setPublishedTermSheets([])\r\n      setSelectedTermSheetId('')\r\n      // Reset introducer dispatch state\r\n      setActiveAgreements([])\r\n      setSelectedAgreementId('')\r\n      setSelectedAgreement(null)\r\n      setLinkableInvestors([])\r\n      setSelectedLinkableInvestorId('')\r\n    }\r\n  }, [open])\r\n\r\n  // Load all entity lists when modal opens\r\n  useEffect(() => {\r\n    if (open) {\r\n      loadAllEntities()\r\n    }\r\n  }, [open, loadAllEntities])\r\n\r\n  // Reset selections when category changes\r\n  useEffect(() => {\r\n    setSelectedEntityId('')\r\n    setSelectedEntity(null)\r\n    setInvestorRole('investor')\r\n    setSelectedReferringEntityId('')\r\n    setSelectedReferringEntity(null)\r\n    setFeePlansData(null)\r\n    setSelectedFeePlanId('')\r\n    setFeePlanName('')\r\n    // Reset introducer dispatch state\r\n    setActiveAgreements([])\r\n    setSelectedAgreementId('')\r\n    setSelectedAgreement(null)\r\n    setLinkableInvestors([])\r\n    setSelectedLinkableInvestorId('')\r\n  }, [category])\r\n\r\n  // Reset referring entity when role changes\r\n  useEffect(() => {\r\n    setSelectedReferringEntityId('')\r\n    setSelectedReferringEntity(null)\r\n    setFeePlansData(null)\r\n    setSelectedFeePlanId('')\r\n  }, [investorRole])\r\n\r\n  // Fetch published term sheets when category is investor\r\n  useEffect(() => {\r\n    if (category === 'investor' && open) {\r\n      fetchPublishedTermSheets()\r\n    } else {\r\n      setPublishedTermSheets([])\r\n      setSelectedTermSheetId('')\r\n    }\r\n  }, [category, open, fetchPublishedTermSheets])\r\n\r\n  // Fetch active agreements when an introducer is selected (for dispatch flow)\r\n  useEffect(() => {\r\n    if (category === 'introducer' && selectedEntity?.id) {\r\n      fetchActiveAgreements(selectedEntity.id)\r\n    } else if (category === 'introducer') {\r\n      // Reset agreement state when introducer is deselected\r\n      setActiveAgreements([])\r\n      setSelectedAgreementId('')\r\n      setSelectedAgreement(null)\r\n      setLinkableInvestors([])\r\n      setSelectedLinkableInvestorId('')\r\n    }\r\n  }, [category, selectedEntity?.id, fetchActiveAgreements])\r\n\r\n  // Update selectedAgreement and fetch linkable investors when agreement is selected\r\n  useEffect(() => {\r\n    if (!selectedAgreementId) {\r\n      setSelectedAgreement(null)\r\n      setLinkableInvestors([])\r\n      setSelectedLinkableInvestorId('')\r\n      return\r\n    }\r\n\r\n    const agreement = activeAgreements.find(a => a.id === selectedAgreementId)\r\n    setSelectedAgreement(agreement || null)\r\n\r\n    // Fetch linkable investors for this agreement's term sheet\r\n    if (agreement?.term_sheet_id) {\r\n      fetchLinkableInvestors(agreement.term_sheet_id)\r\n    }\r\n  }, [selectedAgreementId, activeAgreements, fetchLinkableInvestors])\r\n\r\n  // Fetch fee plans when referring entity is selected AND term sheet is selected\r\n  useEffect(() => {\r\n    if (selectedReferringEntity && referrerEntityType && selectedTermSheetId) {\r\n      fetchFeePlans()\r\n    } else {\r\n      setFeePlansData(null)\r\n      setSelectedFeePlanId('')\r\n    }\r\n  }, [selectedReferringEntity, referrerEntityType, selectedTermSheetId, fetchFeePlans])\r\n\r\n  // Update selectedEntity when dropdown changes\r\n  useEffect(() => {\r\n    if (!selectedEntityId) {\r\n      setSelectedEntity(null)\r\n      return\r\n    }\r\n\r\n    let entityList: any[] = []\r\n    if (category === 'investor') entityList = investors\r\n    else if (category === 'partner') entityList = partners\r\n    else if (category === 'introducer') entityList = introducers\r\n    else if (category === 'commercial_partner') entityList = commercialPartners\r\n\r\n    const entity = entityList.find(e => e.id === selectedEntityId)\r\n    setSelectedEntity(entity || null)\r\n\r\n    // Auto-fill fee plan name for non-investor entities\r\n    if (entity && category !== 'investor') {\r\n      const entityName = entity.name || entity.legal_name || 'Unknown'\r\n      setFeePlanName(`${entityName} Fee Plan`)\r\n    }\r\n  }, [selectedEntityId, category, investors, partners, introducers, commercialPartners])\r\n\r\n  // Update selectedReferringEntity when dropdown changes\r\n  useEffect(() => {\r\n    if (!selectedReferringEntityId) {\r\n      setSelectedReferringEntity(null)\r\n      return\r\n    }\r\n\r\n    const entityList = getReferringEntityList()\r\n    const entity = entityList.find(e => e.id === selectedReferringEntityId)\r\n    setSelectedReferringEntity(entity || null)\r\n  }, [selectedReferringEntityId, getReferringEntityList])\r\n\r\n  const handleAddFeeComponent = () => {\r\n    setFeeComponents([...feeComponents, { kind: 'subscription', rate_bps: 100 }])\r\n  }\r\n\r\n  const handleRemoveFeeComponent = (index: number) => {\r\n    setFeeComponents(feeComponents.filter((_, i) => i !== index))\r\n  }\r\n\r\n  const handleFeeComponentChange = (index: number, field: keyof FeeComponent, value: any) => {\r\n    const updated = [...feeComponents]\r\n    updated[index] = { ...updated[index], [field]: value }\r\n    if (field === 'rate_bps') delete updated[index].flat_amount\r\n    if (field === 'flat_amount') delete updated[index].rate_bps\r\n    setFeeComponents(updated)\r\n  }\r\n\r\n  const handleSubmit = async () => {\r\n    if (!category) {\r\n      setError('Please select a participant type')\r\n      return\r\n    }\r\n\r\n    if (category === 'investor') {\r\n      if (!selectedEntity) {\r\n        setError('Please select an investor')\r\n        return\r\n      }\r\n      if (!selectedTermSheetId) {\r\n        setError('Please select a term sheet for this investor')\r\n        return\r\n      }\r\n      if (requiresReferrer) {\r\n        if (!selectedReferringEntity) {\r\n          const entityLabel = referrerEntityType?.replace('_', ' ') || 'entity'\r\n          setError(`Please select a ${entityLabel} for this investor role`)\r\n          return\r\n        }\r\n        if (!feePlansData?.can_dispatch) {\r\n          setError(feePlansData?.message || 'No accepted fee plan available for this entity')\r\n          return\r\n        }\r\n        if (!selectedFeePlanId) {\r\n          setError('Please select a fee plan')\r\n          return\r\n        }\r\n      }\r\n    } else if (category === 'introducer') {\r\n      // Introducer dispatch flow validation\r\n      if (!selectedAgreement) {\r\n        setError('Please select an active introducer agreement')\r\n        return\r\n      }\r\n      if (!selectedLinkableInvestorId) {\r\n        setError('Please select an investor to link to this introducer')\r\n        return\r\n      }\r\n    } else {\r\n      // Partner / Commercial Partner flow\r\n      if (!selectedEntity) {\r\n        setError(`Please select a ${category.replace('_', ' ')}`)\r\n        return\r\n      }\r\n      if (!feePlanName.trim()) {\r\n        setError('Please enter a fee plan name')\r\n        return\r\n      }\r\n    }\r\n\r\n    setLoading(true)\r\n    setError(null)\r\n\r\n    try {\r\n      if (category === 'investor') {\r\n        const requestBody: Record<string, any> = {\r\n          investor_id: selectedEntity.id,\r\n          role: investorRole,\r\n          send_notification: true,\r\n          term_sheet_id: selectedTermSheetId,\r\n        }\r\n\r\n        if (requiresReferrer && selectedReferringEntity && selectedFeePlanId) {\r\n          requestBody.referred_by_entity_id = selectedReferringEntity.id\r\n          requestBody.referred_by_entity_type = referrerEntityType\r\n          requestBody.assigned_fee_plan_id = selectedFeePlanId\r\n        }\r\n\r\n        const response = await fetch(`/api/deals/${dealId}/members`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(requestBody),\r\n        })\r\n\r\n        if (!response.ok) {\r\n          const data = await response.json()\r\n          throw new Error(data.message || data.error || 'Failed to add investor')\r\n        }\r\n      } else if (category === 'introducer') {\r\n        // Introducer dispatch flow - link existing investor to introducer\r\n        const linkedInvestor = linkableInvestors.find(i => i.user_id === selectedLinkableInvestorId)\r\n        if (!linkedInvestor || !selectedAgreement) {\r\n          throw new Error('Invalid selection')\r\n        }\r\n\r\n        const response = await fetch(`/api/deals/${dealId}/members/${linkedInvestor.user_id}`, {\r\n          method: 'PATCH',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            referred_by_entity_id: selectedAgreement.introducer_id,\r\n            referred_by_entity_type: 'introducer',\r\n            assigned_fee_plan_id: selectedAgreement.fee_plan_id,\r\n            role: 'introducer_investor'\r\n          }),\r\n        })\r\n\r\n        if (!response.ok) {\r\n          const data = await response.json()\r\n          throw new Error(data.error || 'Failed to link investor to introducer')\r\n        }\r\n      } else {\r\n        // Partner / Commercial Partner flow\r\n        const response = await fetch(`/api/deals/${dealId}/partners`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            entity_type: category,\r\n            entity_id: selectedEntity.id,\r\n            fee_plan_name: feePlanName.trim(),\r\n            fee_components: feeComponents.filter(fc =>\r\n              (fc.rate_bps !== undefined && fc.rate_bps !== null) ||\r\n              (fc.flat_amount !== undefined && fc.flat_amount !== null)\r\n            ),\r\n          }),\r\n        })\r\n\r\n        if (!response.ok) {\r\n          const data = await response.json()\r\n          throw new Error(data.error || `Failed to add ${category.replace('_', ' ')}`)\r\n        }\r\n      }\r\n\r\n      setOpen(false)\r\n      onParticipantAdded?.()\r\n      router.refresh()\r\n    } catch (err: any) {\r\n      setError(err.message)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const getEntityDisplayName = (entity: any) => {\r\n    return entity.legal_name || entity.name || 'Unknown'\r\n  }\r\n\r\n  const selectedCategoryInfo = PARTICIPANT_CATEGORIES.find(c => c.value === category)\r\n\r\n  // Get the entity list for current category\r\n  const getEntityListForCategory = () => {\r\n    if (category === 'investor') return investors\r\n    if (category === 'partner') return partners\r\n    if (category === 'introducer') return introducers\r\n    if (category === 'commercial_partner') return commercialPartners\r\n    return []\r\n  }\r\n\r\n  // Check if form is valid for submission\r\n  const isFormValid = () => {\r\n    if (!category) return false\r\n    if (category === 'investor') {\r\n      if (!selectedEntity) return false\r\n      if (!selectedTermSheetId) return false\r\n      if (requiresReferrer) {\r\n        if (!selectedReferringEntity) return false\r\n        if (!feePlansData?.can_dispatch) return false\r\n        if (!selectedFeePlanId) return false\r\n      }\r\n      return true\r\n    } else if (category === 'introducer') {\r\n      // Introducer dispatch flow validation\r\n      return !!(selectedAgreement && selectedLinkableInvestorId)\r\n    } else {\r\n      // Partner / Commercial Partner\r\n      return !!(selectedEntity && feePlanName.trim())\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>\r\n        <Button className=\"gap-2\">\r\n          <Plus className=\"h-4 w-4\" />\r\n          Add Participant\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>Add Deal Participant</DialogTitle>\r\n          <DialogDescription>\r\n            Add an investor, partner, introducer, or commercial partner to this deal\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-6 py-4\">\r\n          {/* Step 1: Category Selection */}\r\n          <div className=\"space-y-3\">\r\n            <Label>Participant Type</Label>\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n              {PARTICIPANT_CATEGORIES.map((cat) => {\r\n                const Icon = cat.icon\r\n                const isSelected = category === cat.value\r\n                return (\r\n                  <button\r\n                    key={cat.value}\r\n                    type=\"button\"\r\n                    onClick={() => setCategory(cat.value)}\r\n                    className={cn(\r\n                      'p-4 rounded-lg border text-left transition-all',\r\n                      isSelected\r\n                        ? cat.color + ' border-2'\r\n                        : 'border-border hover:border-primary hover:bg-muted'\r\n                    )}\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <Icon className=\"h-5 w-5\" />\r\n                      <div>\r\n                        <div className=\"font-medium\">{cat.label}</div>\r\n                        <div className=\"text-xs text-muted-foreground\">{cat.description}</div>\r\n                      </div>\r\n                    </div>\r\n                  </button>\r\n                )\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Step 2: Entity Selection Dropdown */}\r\n          {category && (\r\n            <>\r\n              <div className=\"space-y-2\">\r\n                <Label>Select {selectedCategoryInfo?.label}</Label>\r\n                {entitiesLoading ? (\r\n                  <div className=\"flex items-center gap-2 py-3\">\r\n                    <Loader2 className=\"h-4 w-4 animate-spin text-muted-foreground\" />\r\n                    <span className=\"text-sm text-muted-foreground\">Loading {selectedCategoryInfo?.label.toLowerCase()}s...</span>\r\n                  </div>\r\n                ) : getEntityListForCategory().length === 0 ? (\r\n                  <div className=\"p-3 rounded-lg border border-amber-500/30 bg-amber-500/5 text-amber-300 text-sm\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <AlertCircle className=\"h-4 w-4\" />\r\n                      <span>No {selectedCategoryInfo?.label.toLowerCase()}s available.</span>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <Select value={selectedEntityId} onValueChange={setSelectedEntityId}>\r\n                    <SelectTrigger className={cn(selectedEntity && selectedCategoryInfo?.color)}>\r\n                      <SelectValue placeholder={`Select a ${selectedCategoryInfo?.label.toLowerCase()}`} />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      {getEntityListForCategory().map((entity) => (\r\n                        <SelectItem key={entity.id} value={entity.id}>\r\n                          <div className=\"flex flex-col\">\r\n                            <span>{getEntityDisplayName(entity)}</span>\r\n                            {entity.contact_email && (\r\n                              <span className=\"text-xs text-muted-foreground\">{entity.contact_email}</span>\r\n                            )}\r\n                          </div>\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n                )}\r\n              </div>\r\n\r\n              {/* Investor Role Selection */}\r\n              {category === 'investor' && selectedEntity && (\r\n                <div className=\"space-y-2\">\r\n                  <Label>Role</Label>\r\n                  <Select value={investorRole} onValueChange={setInvestorRole}>\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      {INVESTOR_ROLES.map((role) => (\r\n                        <SelectItem key={role.value} value={role.value}>\r\n                          {role.label}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n              )}\r\n\r\n              {/* Term Sheet Selection - Required for ALL investors */}\r\n              {category === 'investor' && selectedEntity && (\r\n                <div className=\"space-y-2\">\r\n                  <Label>Term Sheet (Investor Class) *</Label>\r\n                  {termSheetsLoading ? (\r\n                    <div className=\"flex items-center gap-2 py-3\">\r\n                      <Loader2 className=\"h-4 w-4 animate-spin text-muted-foreground\" />\r\n                      <span className=\"text-sm text-muted-foreground\">Loading term sheets...</span>\r\n                    </div>\r\n                  ) : publishedTermSheets.length === 0 ? (\r\n                    <div className=\"p-3 rounded-lg border border-amber-500/30 bg-amber-500/5 text-amber-300 text-sm\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <AlertCircle className=\"h-4 w-4\" />\r\n                        <span>No published term sheets available. Please publish a term sheet first.</span>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <Select value={selectedTermSheetId} onValueChange={setSelectedTermSheetId}>\r\n                      <SelectTrigger>\r\n                        <SelectValue placeholder=\"Select term sheet\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        {publishedTermSheets.map((ts) => (\r\n                          <SelectItem key={ts.id} value={ts.id}>\r\n                            v{ts.version} — {ts.subscription_fee_percent ?? 0}% sub / {ts.management_fee_percent ?? 0}% mgmt / {ts.carried_interest_percent ?? 0}% carry\r\n                          </SelectItem>\r\n                        ))}\r\n                      </SelectContent>\r\n                    </Select>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Referring Entity Selection - for roles requiring an introducer/partner/commercial_partner */}\r\n              {category === 'investor' && selectedEntity && requiresReferrer && (\r\n                <div className=\"space-y-3 p-4 rounded-lg border border-amber-500/30 bg-amber-500/5\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <AlertCircle className=\"h-4 w-4 text-amber-400\" />\r\n                    <Label className=\"text-amber-300\">\r\n                      Referring {referrerEntityType?.replace('_', ' ')} Required\r\n                    </Label>\r\n                  </div>\r\n\r\n                  <Select value={selectedReferringEntityId} onValueChange={setSelectedReferringEntityId}>\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder={`Select ${referrerEntityType?.replace('_', ' ')}`} />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      {getReferringEntityList().map((entity) => (\r\n                        <SelectItem key={entity.id} value={entity.id}>\r\n                          {getEntityDisplayName(entity)}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n\r\n                  {/* Term sheet required message */}\r\n                  {selectedReferringEntity && !selectedTermSheetId && (\r\n                    <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30\">\r\n                      <div className=\"flex items-start gap-2\">\r\n                        <AlertCircle className=\"h-4 w-4 text-blue-400 mt-0.5\" />\r\n                        <div>\r\n                          <p className=\"text-sm text-blue-300 font-medium\">Term Sheet Required</p>\r\n                          <p className=\"text-xs text-blue-300/80 mt-1\">\r\n                            Please select a term sheet above first. Fee plans are linked to specific term sheets.\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Fee Plan Selection */}\r\n                  {selectedReferringEntity && selectedTermSheetId && feePlansLoading && (\r\n                    <div className=\"flex items-center gap-2 py-3\">\r\n                      <Loader2 className=\"h-4 w-4 animate-spin text-muted-foreground\" />\r\n                      <span className=\"text-sm text-muted-foreground\">Loading fee plans...</span>\r\n                    </div>\r\n                  )}\r\n\r\n                  {selectedReferringEntity && selectedTermSheetId && !feePlansLoading && feePlansData && !feePlansData.can_dispatch && (\r\n                    <div className=\"p-3 rounded-lg bg-destructive/10 border border-destructive/30\">\r\n                      <div className=\"flex items-start gap-2\">\r\n                        <AlertCircle className=\"h-4 w-4 text-destructive mt-0.5\" />\r\n                        <div>\r\n                          <p className=\"text-sm text-destructive font-medium\">Cannot Dispatch</p>\r\n                          <p className=\"text-xs text-destructive/80 mt-1\">\r\n                            {feePlansData.message || 'No accepted fee plan available for this term sheet'}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {selectedReferringEntity && selectedTermSheetId && !feePlansLoading && feePlansData && feePlansData.can_dispatch && (\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Fee Plan</Label>\r\n                      <Select value={selectedFeePlanId} onValueChange={setSelectedFeePlanId}>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder=\"Select fee plan\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          {feePlansData.accepted_plans.map((plan) => (\r\n                            <SelectItem key={plan.id} value={plan.id}>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <span>{plan.name}</span>\r\n                                {plan.is_default && (\r\n                                  <span className=\"text-xs bg-primary/20 text-primary px-1.5 py-0.5 rounded\">\r\n                                    Default\r\n                                  </span>\r\n                                )}\r\n                              </div>\r\n                            </SelectItem>\r\n                          ))}\r\n                        </SelectContent>\r\n                      </Select>\r\n\r\n                      {/* Display selected fee plan details */}\r\n                      {selectedFeePlanId && (\r\n                        <div className=\"p-2 rounded bg-muted/30 text-xs space-y-1\">\r\n                          {feePlansData.accepted_plans\r\n                            .find(p => p.id === selectedFeePlanId)\r\n                            ?.fee_components.map((fc, idx) => (\r\n                              <div key={idx} className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground capitalize\">\r\n                                  {fc.kind.replace('_', ' ')}\r\n                                </span>\r\n                                <span>\r\n                                  {fc.rate_bps !== undefined\r\n                                    ? `${(fc.rate_bps / 100).toFixed(2)}%`\r\n                                    : fc.flat_amount !== undefined\r\n                                      ? `$${fc.flat_amount.toLocaleString()}`\r\n                                      : '-'}\r\n                                </span>\r\n                              </div>\r\n                            ))}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Fee Plan for entities (partner/commercial_partner only - introducer uses dispatch flow) */}\r\n              {category !== 'investor' && category !== 'introducer' && selectedEntity && (\r\n                <>\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Fee Plan Name</Label>\r\n                    <Input\r\n                      value={feePlanName}\r\n                      onChange={(e) => setFeePlanName(e.target.value)}\r\n                      placeholder=\"e.g., Standard Partner Fee\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <Label>Fee Components</Label>\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={handleAddFeeComponent}\r\n                        className=\"gap-1 text-xs\"\r\n                      >\r\n                        <Plus className=\"h-3 w-3\" />\r\n                        Add\r\n                      </Button>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      {feeComponents.map((fc, idx) => (\r\n                        <div key={idx} className=\"flex items-center gap-2 p-3 rounded-md bg-muted/50\">\r\n                          <Select\r\n                            value={fc.kind}\r\n                            onValueChange={(v) => handleFeeComponentChange(idx, 'kind', v)}\r\n                          >\r\n                            <SelectTrigger className=\"w-36\">\r\n                              <SelectValue />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                              {FEE_KINDS.map((k) => (\r\n                                <SelectItem key={k.value} value={k.value}>\r\n                                  {k.label}\r\n                                </SelectItem>\r\n                              ))}\r\n                            </SelectContent>\r\n                          </Select>\r\n\r\n                          <Input\r\n                            type=\"number\"\r\n                            step=\"0.01\"\r\n                            placeholder=\"Rate %\"\r\n                            value={fc.rate_bps !== undefined && fc.rate_bps !== null ? fc.rate_bps / 100 : ''}\r\n                            onChange={(e) =>\r\n                              handleFeeComponentChange(\r\n                                idx,\r\n                                'rate_bps',\r\n                                e.target.value ? parseFloat(e.target.value) * 100 : undefined\r\n                              )\r\n                            }\r\n                            className=\"w-20\"\r\n                          />\r\n                          <span className=\"text-xs text-muted-foreground\">or</span>\r\n                          <Input\r\n                            type=\"number\"\r\n                            step=\"0.01\"\r\n                            placeholder=\"Flat $\"\r\n                            value={fc.flat_amount !== undefined && fc.flat_amount !== null ? fc.flat_amount : ''}\r\n                            onChange={(e) =>\r\n                              handleFeeComponentChange(\r\n                                idx,\r\n                                'flat_amount',\r\n                                e.target.value ? parseFloat(e.target.value) : undefined\r\n                              )\r\n                            }\r\n                            className=\"w-20\"\r\n                          />\r\n\r\n                          {feeComponents.length > 1 && (\r\n                            <Button\r\n                              type=\"button\"\r\n                              variant=\"ghost\"\r\n                              size=\"icon\"\r\n                              onClick={() => handleRemoveFeeComponent(idx)}\r\n                              className=\"h-8 w-8 text-destructive\"\r\n                            >\r\n                              <Trash2 className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          {/* Introducer Dispatch Flow - Shows AFTER an introducer is selected */}\r\n          {category === 'introducer' && selectedEntity && (\r\n            <div className=\"space-y-4 p-4 rounded-lg border border-orange-500/30 bg-orange-500/5\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Users className=\"h-5 w-5 text-orange-400\" />\r\n                <div>\r\n                  <h4 className=\"font-medium text-orange-300\">Link Investor to {getEntityDisplayName(selectedEntity)}</h4>\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    Select an active agreement, then choose an investor to link\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Step 2: Select Active Agreement for this introducer */}\r\n              <div className=\"space-y-2\">\r\n                <Label>Select Agreement (Term Sheet)</Label>\r\n                {activeAgreementsLoading ? (\r\n                  <div className=\"flex items-center gap-2 py-3\">\r\n                    <Loader2 className=\"h-4 w-4 animate-spin text-muted-foreground\" />\r\n                    <span className=\"text-sm text-muted-foreground\">Loading agreements...</span>\r\n                  </div>\r\n                ) : activeAgreements.length === 0 ? (\r\n                  <div className=\"p-3 rounded-lg border border-amber-500/30 bg-amber-500/5 text-amber-300 text-sm\">\r\n                    <div className=\"flex items-start gap-2\">\r\n                      <AlertCircle className=\"h-4 w-4 mt-0.5\" />\r\n                      <div>\r\n                        <p className=\"font-medium\">No active agreements for this introducer</p>\r\n                        <p className=\"text-xs text-amber-300/80 mt-1\">\r\n                          {getEntityDisplayName(selectedEntity)} has no signed agreements on this deal.\r\n                          Create and sign an introducer agreement in the Introducers tab first.\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <Select value={selectedAgreementId} onValueChange={setSelectedAgreementId}>\r\n                    <SelectTrigger className={cn(selectedAgreement && 'border-orange-500/50')}>\r\n                      <SelectValue placeholder=\"Select an agreement\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      {activeAgreements.map((agreement) => (\r\n                        <SelectItem key={agreement.id} value={agreement.id}>\r\n                          <div className=\"flex flex-col\">\r\n                            <span className=\"font-medium\">{agreement.fee_plan_name}</span>\r\n                            <span className=\"text-xs text-muted-foreground\">\r\n                              Term Sheet v{agreement.term_sheet_version} {agreement.reference_number ? `• ${agreement.reference_number}` : ''}\r\n                            </span>\r\n                          </div>\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n                )}\r\n              </div>\r\n\r\n              {/* Step 3: Select Investor (shown after agreement is selected) */}\r\n              {selectedAgreement && (\r\n                <div className=\"space-y-2\">\r\n                  <Label>Select Investor to Link</Label>\r\n                  {linkableInvestorsLoading ? (\r\n                    <div className=\"flex items-center gap-2 py-3\">\r\n                      <Loader2 className=\"h-4 w-4 animate-spin text-muted-foreground\" />\r\n                      <span className=\"text-sm text-muted-foreground\">Loading eligible investors...</span>\r\n                    </div>\r\n                  ) : linkableInvestors.length === 0 ? (\r\n                    <div className=\"p-3 rounded-lg border border-blue-500/30 bg-blue-500/5 text-blue-300 text-sm\">\r\n                      <div className=\"flex items-start gap-2\">\r\n                        <AlertCircle className=\"h-4 w-4 mt-0.5\" />\r\n                        <div>\r\n                          <p className=\"font-medium\">No eligible investors</p>\r\n                          <p className=\"text-xs text-blue-300/80 mt-1\">\r\n                            No investors on Term Sheet v{selectedAgreement.term_sheet_version} are available to link.\r\n                            They may already be linked to an introducer, or you need to add investors to this term sheet first.\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <Select value={selectedLinkableInvestorId} onValueChange={setSelectedLinkableInvestorId}>\r\n                      <SelectTrigger className={cn(selectedLinkableInvestorId && 'border-orange-500/50')}>\r\n                        <SelectValue placeholder=\"Select an investor\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        {linkableInvestors.map((investor) => (\r\n                          <SelectItem key={investor.user_id} value={investor.user_id}>\r\n                            <div className=\"flex flex-col\">\r\n                              <span>{investor.display_name}</span>\r\n                              {investor.email && (\r\n                                <span className=\"text-xs text-muted-foreground\">{investor.email}</span>\r\n                              )}\r\n                            </div>\r\n                          </SelectItem>\r\n                        ))}\r\n                      </SelectContent>\r\n                    </Select>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Summary of what will happen */}\r\n              {selectedAgreement && selectedLinkableInvestorId && (\r\n                <div className=\"p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/30\">\r\n                  <div className=\"flex items-start gap-2\">\r\n                    <div className=\"text-emerald-400 mt-0.5\">✓</div>\r\n                    <div className=\"text-sm\">\r\n                      <p className=\"text-emerald-300 font-medium\">Ready to link</p>\r\n                      <p className=\"text-emerald-300/80 text-xs mt-1\">\r\n                        This investor will be linked to <strong>{getEntityDisplayName(selectedEntity)}</strong> using\r\n                        the <strong>{selectedAgreement.fee_plan_name}</strong> fee plan (Term Sheet v{selectedAgreement.term_sheet_version}).\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Error Display */}\r\n          {error && (\r\n            <div className=\"p-3 rounded-lg bg-destructive/10 text-destructive text-sm\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex justify-end gap-2 pt-4\">\r\n            <Button variant=\"outline\" onClick={() => setOpen(false)} disabled={loading}>\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleSubmit}\r\n              disabled={loading || !isFormValid()}\r\n            >\r\n              {loading ? (\r\n                <>\r\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                  {category === 'introducer' ? 'Linking...' : 'Adding...'}\r\n                </>\r\n              ) : category === 'introducer' ? (\r\n                'Link Investor to Introducer'\r\n              ) : (\r\n                `Add ${selectedCategoryInfo?.label || 'Participant'}`\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { format } from 'date-fns'\r\nimport { useRouter } from 'next/navigation'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow\r\n} from '@/components/ui/table'\r\nimport {\r\n  Send,\r\n  Eye,\r\n  TrendingUp,\r\n  FileSignature,\r\n  FolderOpen,\r\n  FileText,\r\n  Mail,\r\n  CheckCircle2,\r\n  Wallet,\r\n  Users,\r\n  Trash2,\r\n  MoreHorizontal,\r\n  Building2,\r\n  Briefcase,\r\n  Loader2,\r\n  UserPlus,\r\n  UserCircle,\r\n  FileCheck,\r\n  ArrowRight\r\n} from 'lucide-react'\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger\r\n} from '@/components/ui/dropdown-menu'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue\r\n} from '@/components/ui/select'\r\nimport { AddParticipantModal } from './add-participant-modal'\r\n\r\n// Partner assignment types\r\ninterface PartnerAssignment {\r\n  fee_plan_id: string\r\n  fee_plan_name: string\r\n  fee_plan_status: string\r\n  is_active: boolean\r\n  created_at: string\r\n  entity_type: 'partner' | 'introducer' | 'commercial_partner'\r\n  entity_id: string\r\n  entity_name: string\r\n  entity_status: string\r\n  entity_email: string | null\r\n  fee_components: Array<{\r\n    id: string\r\n    kind: string\r\n    rate_bps: number | null\r\n    flat_amount: number | null\r\n    currency: string\r\n  }>\r\n}\r\n\r\n// Journey stages configuration - 9-stage investor journey\r\nconst JOURNEY_STAGES = [\r\n  { key: 'dispatched', label: 'Dispatched', icon: Send, field: 'dispatched_at' },\r\n  { key: 'viewed', label: 'Viewed', icon: Eye, field: 'viewed_at' },\r\n  { key: 'interest', label: 'Interest', icon: TrendingUp, field: 'interest_confirmed_at' },\r\n  { key: 'nda', label: 'NDA', icon: FileSignature, field: 'nda_signed_at' },\r\n  { key: 'data_room', label: 'Data Room', icon: FolderOpen, field: 'data_room_granted_at' },\r\n  { key: 'pack_gen', label: 'Pack Gen', icon: FileText, field: 'pack_generated_at', fromSubscription: true },\r\n  { key: 'pack_sent', label: 'Pack Sent', icon: Mail, field: 'pack_sent_at', fromSubscription: true },\r\n  { key: 'signed', label: 'Signed', icon: CheckCircle2, field: 'signed_at', fromSubscription: true },\r\n  { key: 'funded', label: 'Funded', icon: Wallet, field: 'funded_at', fromSubscription: true },\r\n] as const\r\n\r\ninterface DealMembersTabProps {\r\n  dealId: string\r\n  members: any[]\r\n  subscriptions?: any[]\r\n}\r\n\r\nfunction getCurrentStage(member: any): { stage: string; index: number } {\r\n  // Build a map of investor_id to subscription\r\n  const subscription = member.subscription || null\r\n\r\n  // Check stages in reverse order to find the latest completed\r\n  for (let i = JOURNEY_STAGES.length - 1; i >= 0; i--) {\r\n    const stage = JOURNEY_STAGES[i]\r\n    let value: string | null = null\r\n\r\n    const isFromSubscription = 'fromSubscription' in stage && stage.fromSubscription\r\n    if (isFromSubscription && subscription) {\r\n      value = subscription[stage.field]\r\n    } else if (!isFromSubscription) {\r\n      value = member[stage.field]\r\n    }\r\n\r\n    if (value) {\r\n      return { stage: stage.label, index: i }\r\n    }\r\n  }\r\n  return { stage: 'Invited', index: -1 }\r\n}\r\n\r\nfunction JourneyProgressBar({ member }: { member: any }) {\r\n  const { index: currentIndex } = getCurrentStage(member)\r\n  const subscription = member.subscription || null\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-1\">\r\n      {JOURNEY_STAGES.map((stage, idx) => {\r\n        let value: string | null = null\r\n        const isFromSubscription = 'fromSubscription' in stage && stage.fromSubscription\r\n        if (isFromSubscription && subscription) {\r\n          value = subscription[stage.field]\r\n        } else if (!isFromSubscription) {\r\n          value = member[stage.field]\r\n        }\r\n\r\n        const isCompleted = !!value\r\n        const isCurrent = idx === currentIndex\r\n\r\n        return (\r\n          <div\r\n            key={stage.key}\r\n            className={`w-6 h-6 rounded-full flex items-center justify-center text-xs transition-colors ${\r\n              isCompleted\r\n                ? 'bg-green-500/30 text-green-400 border border-green-500/50'\r\n                : isCurrent\r\n                  ? 'bg-yellow-500/30 text-yellow-400 border border-yellow-500/50'\r\n                  : 'bg-muted text-muted-foreground'\r\n            }`}\r\n            title={`${stage.label}${value ? ` - ${format(new Date(value), 'MMM d, yyyy')}` : ''}`}\r\n          >\r\n            <stage.icon className=\"h-3 w-3\" />\r\n          </div>\r\n        )\r\n      })}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function DealMembersTab({ dealId, members: initialMembers, subscriptions = [] }: DealMembersTabProps) {\r\n  const router = useRouter()\r\n  const [members, setMembers] = useState(initialMembers)\r\n\r\n  // Partner assignment state\r\n  const [partnerAssignments, setPartnerAssignments] = useState<PartnerAssignment[]>([])\r\n  const [loadingAssignments, setLoadingAssignments] = useState(true)\r\n  const [assignmentsError, setAssignmentsError] = useState<string | null>(null)\r\n  const [removingId, setRemovingId] = useState<string | null>(null)\r\n\r\n  // Fee plan filter state\r\n  const [feePlanFilter, setFeePlanFilter] = useState<string>('all')\r\n\r\n  // Create subscription map for quick lookup\r\n  const subscriptionMap = new Map(\r\n    subscriptions.map(s => [s.investor_id, s])\r\n  )\r\n\r\n  const visibleMembers = members.filter(member => !['lawyer', 'arranger'].includes(member.role))\r\n  // Enhance members with subscription data\r\n  const enhancedMembers = visibleMembers.map(m => ({\r\n    ...m,\r\n    subscription: m.investor_id ? subscriptionMap.get(m.investor_id) : null\r\n  }))\r\n\r\n  // Extract unique fee plans from members for the filter dropdown\r\n  const uniqueFeePlans = enhancedMembers.reduce((acc, member) => {\r\n    const feePlan = member.assigned_fee_plan\r\n    if (feePlan && !acc.find((fp: { id: string; name: string }) => fp.id === feePlan.id)) {\r\n      acc.push({ id: feePlan.id, name: feePlan.name })\r\n    }\r\n    return acc\r\n  }, [] as { id: string; name: string }[])\r\n\r\n  // Apply fee plan filter to members\r\n  const filteredMembers = feePlanFilter === 'all'\r\n    ? enhancedMembers\r\n    : feePlanFilter === 'none'\r\n      ? enhancedMembers.filter(m => !m.assigned_fee_plan)\r\n      : enhancedMembers.filter(m => m.assigned_fee_plan?.id === feePlanFilter)\r\n\r\n  // Update local state when server data changes\r\n  useEffect(() => {\r\n    setMembers(initialMembers)\r\n  }, [initialMembers])\r\n\r\n  // Fetch partner assignments\r\n  const fetchAssignments = async () => {\r\n    setLoadingAssignments(true)\r\n    setAssignmentsError(null)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/partners`)\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}))\r\n        throw new Error(errorData.error || 'Failed to load partner assignments')\r\n      }\r\n      const data = await response.json()\r\n      setPartnerAssignments(data.data || [])\r\n    } catch (err) {\r\n      console.error('Failed to fetch partner assignments:', err)\r\n      setAssignmentsError(err instanceof Error ? err.message : 'Failed to load partner assignments')\r\n    } finally {\r\n      setLoadingAssignments(false)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchAssignments()\r\n  }, [dealId])\r\n\r\n  const handleRemoveAssignment = async (feePlanId: string) => {\r\n    if (!confirm('Are you sure you want to remove this partner from this deal?')) {\r\n      return\r\n    }\r\n\r\n    setRemovingId(feePlanId)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/partners?fee_plan_id=${feePlanId}`, {\r\n        method: 'DELETE',\r\n      })\r\n\r\n      if (response.ok) {\r\n        await fetchAssignments()\r\n        router.refresh()\r\n      } else {\r\n        const data = await response.json()\r\n        alert(data.error || 'Failed to remove partner')\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to remove partner:', err)\r\n      alert('Failed to remove partner')\r\n    } finally {\r\n      setRemovingId(null)\r\n    }\r\n  }\r\n\r\n  const getEntityIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'partner': return <Building2 className=\"h-4 w-4\" />\r\n      case 'introducer': return <Users className=\"h-4 w-4\" />\r\n      case 'commercial_partner': return <Briefcase className=\"h-4 w-4\" />\r\n      default: return <Building2 className=\"h-4 w-4\" />\r\n    }\r\n  }\r\n\r\n  const getEntityTypeLabel = (type: string) => {\r\n    switch (type) {\r\n      case 'partner': return 'Partner'\r\n      case 'introducer': return 'Introducer'\r\n      case 'commercial_partner': return 'Commercial Partner'\r\n      default: return type\r\n    }\r\n  }\r\n\r\n  const feeKindLabels: Record<string, string> = {\r\n    subscription: 'Subscription Fee',\r\n    management: 'Management Fee',\r\n    performance: 'Performance Fee',\r\n    spread_markup: 'Spread Markup',\r\n    flat: 'Flat Fee',\r\n    other: 'Other'\r\n  }\r\n\r\n  // Fee plan status styling\r\n  const feePlanStatusClasses: Record<string, string> = {\r\n    draft: 'bg-slate-100 dark:bg-slate-500/20 text-slate-700 dark:text-slate-300',\r\n    sent: 'bg-blue-100 dark:bg-blue-500/20 text-blue-700 dark:text-blue-300',\r\n    pending_signature: 'bg-amber-100 dark:bg-amber-500/20 text-amber-700 dark:text-amber-300',\r\n    accepted: 'bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-300',\r\n    rejected: 'bg-red-100 dark:bg-red-500/20 text-red-700 dark:text-red-300'\r\n  }\r\n\r\n  // Get referrer info from member's assigned_fee_plan\r\n  const getReferrerInfo = (member: any) => {\r\n    const feePlan = member.assigned_fee_plan\r\n    if (!feePlan) return null\r\n\r\n    // The referrer is the entity linked to the fee plan\r\n    if (feePlan.introducer) {\r\n      return {\r\n        type: 'Introducer',\r\n        name: feePlan.introducer.company_name || feePlan.introducer.name,\r\n        icon: Users\r\n      }\r\n    }\r\n    if (feePlan.partner) {\r\n      return {\r\n        type: 'Partner',\r\n        name: feePlan.partner.company_name || feePlan.partner.name,\r\n        icon: Building2\r\n      }\r\n    }\r\n    if (feePlan.commercial_partner) {\r\n      return {\r\n        type: 'Commercial Partner',\r\n        name: feePlan.commercial_partner.company_name || feePlan.commercial_partner.name,\r\n        icon: Briefcase\r\n      }\r\n    }\r\n    return null\r\n  }\r\n\r\n  const refreshMembers = async () => {\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/members`)\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        setMembers(data.members || [])\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to refresh members:', err)\r\n    }\r\n  }\r\n\r\n  const handleRemoveMember = async (userId: string) => {\r\n    if (!confirm('Are you sure you want to remove this member from the deal?')) {\r\n      return\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/members/${userId}`, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      if (response.ok) {\r\n        await refreshMembers()\r\n      } else {\r\n        const data = await response.json()\r\n        alert(`Failed to remove member: ${data.error || 'Unknown error'}`)\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to remove member:', err)\r\n      alert('Failed to remove member. Please try again.')\r\n    }\r\n  }\r\n\r\n  const roleColors: Record<string, string> = {\r\n    investor: 'bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-200',\r\n    co_investor: 'bg-blue-100 dark:bg-blue-500/20 text-blue-700 dark:text-blue-200',\r\n    partner_investor: 'bg-purple-100 dark:bg-purple-500/20 text-purple-700 dark:text-purple-200',\r\n    introducer_investor: 'bg-orange-100 dark:bg-orange-500/20 text-orange-700 dark:text-orange-200',\r\n    commercial_partner_investor: 'bg-teal-100 dark:bg-teal-500/20 text-teal-700 dark:text-teal-200',\r\n    advisor: 'bg-purple-100 dark:bg-purple-500/20 text-purple-700 dark:text-purple-200',\r\n    banker: 'bg-cyan-100 dark:bg-cyan-500/20 text-cyan-700 dark:text-cyan-200',\r\n    introducer: 'bg-pink-100 dark:bg-pink-500/20 text-pink-700 dark:text-pink-200',\r\n    verso_staff: 'bg-muted text-muted-foreground',\r\n    viewer: 'bg-muted text-muted-foreground'\r\n  }\r\n\r\n  // Calculate journey stats\r\n  const stats = {\r\n    total: enhancedMembers.length,\r\n    dispatched: enhancedMembers.filter(m => m.dispatched_at).length,\r\n    viewed: enhancedMembers.filter(m => m.viewed_at).length,\r\n    interested: enhancedMembers.filter(m => m.interest_confirmed_at).length,\r\n    ndaSigned: enhancedMembers.filter(m => m.nda_signed_at).length,\r\n    dataRoom: enhancedMembers.filter(m => m.data_room_granted_at).length,\r\n    packGen: enhancedMembers.filter(m => m.subscription?.pack_generated_at).length,\r\n    packSent: enhancedMembers.filter(m => m.subscription?.pack_sent_at).length,\r\n    signed: enhancedMembers.filter(m => m.subscription?.signed_at).length,\r\n    funded: enhancedMembers.filter(m => m.subscription?.funded_at).length,\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Journey Funnel Summary */}\r\n      <Card className=\"border border-border bg-muted/50\">\r\n        <CardHeader className=\"pb-3\">\r\n          <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\r\n            <TrendingUp className=\"h-4 w-4\" />\r\n            Investor Journey Funnel\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center gap-2 overflow-x-auto pb-2\">\r\n            {[\r\n              { label: 'Dispatched', count: stats.dispatched },\r\n              { label: 'Viewed', count: stats.viewed },\r\n              { label: 'Interested', count: stats.interested },\r\n              { label: 'NDA', count: stats.ndaSigned },\r\n              { label: 'Data Room', count: stats.dataRoom },\r\n              { label: 'Pack Gen', count: stats.packGen },\r\n              { label: 'Pack Sent', count: stats.packSent },\r\n              { label: 'Signed', count: stats.signed },\r\n              { label: 'Funded', count: stats.funded },\r\n            ].map((stage, idx) => (\r\n              <div key={stage.label} className=\"flex items-center\">\r\n                <div className=\"text-center min-w-[70px]\">\r\n                  <div className=\"text-xl font-bold\">{stage.count}</div>\r\n                  <div className=\"text-xs text-muted-foreground\">{stage.label}</div>\r\n                </div>\r\n                {idx < 8 && (\r\n                  <div className=\"mx-1 text-muted-foreground\">→</div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* All Participants Header */}\r\n      <Card className=\"border border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n                <Users className=\"h-5 w-5\" />\r\n                Deal Participants ({enhancedMembers.length + partnerAssignments.length})\r\n              </CardTitle>\r\n              <CardDescription>\r\n                Investors, partners, introducers, and other participants in this deal\r\n              </CardDescription>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <AddParticipantModal\r\n                dealId={dealId}\r\n                onParticipantAdded={() => {\r\n                  refreshMembers()\r\n                  fetchAssignments()\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          {/* Investors Section */}\r\n          <div>\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <h3 className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n                <UserCircle className=\"h-4 w-4\" />\r\n                Investors ({filteredMembers.length}{feePlanFilter !== 'all' ? ` of ${enhancedMembers.length}` : ''})\r\n              </h3>\r\n              {/* Fee Plan Filter Dropdown */}\r\n              {uniqueFeePlans.length > 0 && (\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-xs text-muted-foreground\">Filter by Fee Plan:</span>\r\n                  <Select value={feePlanFilter} onValueChange={setFeePlanFilter}>\r\n                    <SelectTrigger className=\"w-[200px] h-8 text-sm\">\r\n                      <SelectValue placeholder=\"All Fee Plans\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"all\">All Fee Plans</SelectItem>\r\n                      <SelectItem value=\"none\">No Fee Plan (Direct)</SelectItem>\r\n                      {uniqueFeePlans.map((fp: { id: string; name: string }) => (\r\n                        <SelectItem key={fp.id} value={fp.id}>\r\n                          {fp.name}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n              )}\r\n            </div>\r\n          {filteredMembers.length === 0 ? (\r\n            <div className=\"text-center py-6 text-muted-foreground border border-dashed border-border rounded-lg\">\r\n              {feePlanFilter !== 'all'\r\n                ? 'No investors match the selected fee plan filter.'\r\n                : 'No investors added yet. Click \"Add Participant\" to invite investors.'}\r\n            </div>\r\n          ) : (\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Member</TableHead>\r\n                  <TableHead>Role</TableHead>\r\n                  <TableHead>Referred By</TableHead>\r\n                  <TableHead>Fee Plan</TableHead>\r\n                  <TableHead>Journey Progress</TableHead>\r\n                  <TableHead>Current Stage</TableHead>\r\n                  <TableHead className=\"text-right\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {filteredMembers.map((member) => {\r\n                  const profile = Array.isArray(member.profiles) ? member.profiles[0] : member.profiles\r\n                  const investor = Array.isArray(member.investors) ? member.investors[0] : member.investors\r\n                  const { stage } = getCurrentStage(member)\r\n                  const referrer = getReferrerInfo(member)\r\n                  const feePlan = member.assigned_fee_plan\r\n\r\n                  return (\r\n                    <TableRow key={member.user_id}>\r\n                      <TableCell>\r\n                        <div>\r\n                          <div className=\"font-medium\">\r\n                            {investor?.legal_name || profile?.display_name || 'Unknown'}\r\n                          </div>\r\n                          <div className=\"text-sm text-muted-foreground\">\r\n                            {profile?.email}\r\n                          </div>\r\n                          {investor?.kyc_status && (\r\n                            <Badge\r\n                              variant=\"outline\"\r\n                              className={`text-xs mt-1 ${\r\n                                investor.kyc_status === 'approved'\r\n                                  ? 'bg-green-500/20 text-green-400'\r\n                                  : investor.kyc_status === 'pending'\r\n                                    ? 'bg-yellow-500/20 text-yellow-400'\r\n                                    : ''\r\n                              }`}\r\n                            >\r\n                              KYC: {investor.kyc_status}\r\n                            </Badge>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge className={roleColors[member.role] || 'bg-muted text-foreground'}>\r\n                          {member.role?.replace(/_/g, ' ')}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {referrer ? (\r\n                          <div className=\"flex items-center gap-1.5 text-sm\">\r\n                            <referrer.icon className=\"h-3.5 w-3.5 text-muted-foreground\" />\r\n                            <span className=\"text-muted-foreground\">{referrer.name}</span>\r\n                          </div>\r\n                        ) : (\r\n                          <span className=\"text-xs text-muted-foreground/60\">Direct</span>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {feePlan ? (\r\n                          <div className=\"flex flex-col gap-1\">\r\n                            <span className=\"text-sm\">{feePlan.name}</span>\r\n                            <Badge className={`text-[10px] w-fit ${feePlanStatusClasses[feePlan.status] || 'bg-muted text-muted-foreground'}`}>\r\n                              {feePlan.status}\r\n                            </Badge>\r\n                          </div>\r\n                        ) : (\r\n                          <span className=\"text-xs text-muted-foreground/60\">—</span>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <JourneyProgressBar member={member} />\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge variant=\"outline\">{stage}</Badge>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        <DropdownMenu>\r\n                          <DropdownMenuTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                              <MoreHorizontal className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          </DropdownMenuTrigger>\r\n                          <DropdownMenuContent align=\"end\">\r\n                            <DropdownMenuLabel>Actions</DropdownMenuLabel>\r\n                            <DropdownMenuSeparator />\r\n                            {investor && (\r\n                              <DropdownMenuItem asChild>\r\n                                <a href={`/versotech_main/investors/${investor.id}`}>\r\n                                  <Eye className=\"mr-2 h-4 w-4\" />\r\n                                  View Investor\r\n                                </a>\r\n                              </DropdownMenuItem>\r\n                            )}\r\n                            {profile?.email && (\r\n                              <DropdownMenuItem onClick={() => window.location.href = `mailto:${profile.email}`}>\r\n                                <Mail className=\"mr-2 h-4 w-4\" />\r\n                                Send Email\r\n                              </DropdownMenuItem>\r\n                            )}\r\n                            <DropdownMenuSeparator />\r\n                            <DropdownMenuItem\r\n                              className=\"text-red-400\"\r\n                              onClick={() => handleRemoveMember(member.user_id)}\r\n                            >\r\n                              <Trash2 className=\"mr-2 h-4 w-4\" />\r\n                              Remove Member\r\n                            </DropdownMenuItem>\r\n                          </DropdownMenuContent>\r\n                        </DropdownMenu>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  )\r\n                })}\r\n              </TableBody>\r\n            </Table>\r\n          )}\r\n          </div>\r\n\r\n          {/* Partners & Intermediaries Section */}\r\n          <div>\r\n            <h3 className=\"text-sm font-medium text-muted-foreground mb-3 flex items-center gap-2\">\r\n              <UserPlus className=\"h-4 w-4\" />\r\n              Partners & Intermediaries ({partnerAssignments.length})\r\n            </h3>\r\n            {loadingAssignments ? (\r\n              <div className=\"flex items-center justify-center py-6\">\r\n                <Loader2 className=\"h-5 w-5 animate-spin text-muted-foreground\" />\r\n              </div>\r\n            ) : assignmentsError ? (\r\n              <div className=\"text-center py-6 text-red-400 border border-dashed border-red-500/20 rounded-lg bg-red-500/5\">\r\n                {assignmentsError}\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={fetchAssignments}\r\n                  className=\"ml-2 text-red-400 hover:text-red-300\"\r\n                >\r\n                  Retry\r\n                </Button>\r\n              </div>\r\n            ) : partnerAssignments.length === 0 ? (\r\n              <div className=\"text-center py-6 text-muted-foreground border border-dashed border-border rounded-lg\">\r\n                No partners assigned yet. Click \"Add Participant\" to add partners, introducers, or commercial partners.\r\n              </div>\r\n            ) : (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\r\n                {partnerAssignments.map((assignment) => (\r\n                  <div\r\n                    key={assignment.fee_plan_id}\r\n                    className=\"p-3 rounded-lg border border-border bg-muted/50\"\r\n                  >\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex items-start gap-3\">\r\n                        <div className=\"p-2 rounded-lg bg-primary/10\">\r\n                          {getEntityIcon(assignment.entity_type)}\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"font-medium text-sm\">{assignment.entity_name}</div>\r\n                          <div className=\"flex items-center gap-2 mt-1\">\r\n                            <Badge variant=\"outline\" className=\"text-xs\">\r\n                              {getEntityTypeLabel(assignment.entity_type)}\r\n                            </Badge>\r\n                          </div>\r\n                          <div className=\"text-xs text-muted-foreground mt-1\">\r\n                            {assignment.fee_components.length > 0 ? (\r\n                              assignment.fee_components.map((fc) => (\r\n                                <span key={fc.id} className=\"mr-2\">\r\n                                  {feeKindLabels[fc.kind] || fc.kind}: {fc.rate_bps !== null && fc.rate_bps !== undefined ? `${fc.rate_bps / 100}%` : fc.flat_amount !== null && fc.flat_amount !== undefined ? `$${fc.flat_amount}` : '—'}\r\n                                </span>\r\n                              ))\r\n                            ) : (\r\n                              <span className=\"italic\">No fees defined</span>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        onClick={() => handleRemoveAssignment(assignment.fee_plan_id)}\r\n                        disabled={removingId === assignment.fee_plan_id}\r\n                        className=\"text-destructive hover:text-destructive h-7 w-7\"\r\n                      >\r\n                        {removingId === assignment.fee_plan_id ? (\r\n                          <Loader2 className=\"h-3 w-3 animate-spin\" />\r\n                        ) : (\r\n                          <Trash2 className=\"h-3 w-3\" />\r\n                        )}\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Plus, DollarSign, Edit, FileText, Users, Building2, Briefcase, CheckCircle, Clock, XCircle, FileSignature, Loader2, FileDown, Eye, Download } from 'lucide-react'\r\nimport { toast } from 'sonner'\r\nimport FeePlanEditModal from '@/components/fees/FeePlanEditModal'\r\nimport { useRouter } from 'next/navigation'\r\n\r\ninterface DealFeePlansTabProps {\r\n  dealId: string\r\n  feePlans: any[]\r\n}\r\n\r\nexport function DealFeePlansTab({ dealId, feePlans }: DealFeePlansTabProps) {\r\n  const router = useRouter()\r\n  const [modalOpen, setModalOpen] = useState(false)\r\n  const [selectedPlan, setSelectedPlan] = useState<any>(null)\r\n  const [generatingAgreement, setGeneratingAgreement] = useState<string | null>(null)\r\n  const [downloadingPdf, setDownloadingPdf] = useState<string | null>(null)\r\n\r\n  // Handle PDF download from Supabase storage\r\n  const handleDownloadPdf = async (pdfUrl: string, referenceNumber: string | null) => {\r\n    setDownloadingPdf(pdfUrl)\r\n    try {\r\n      const response = await fetch(`/api/storage/download?path=${encodeURIComponent(pdfUrl)}&bucket=deal-documents`)\r\n      if (!response.ok) {\r\n        throw new Error('Failed to download file')\r\n      }\r\n      const blob = await response.blob()\r\n      const url = window.URL.createObjectURL(blob)\r\n      const link = document.createElement('a')\r\n      link.href = url\r\n      // Extract actual filename from storage path, or fall back to reference number\r\n      const actualFilename = pdfUrl.split('/').pop() || `${referenceNumber || 'agreement'}.pdf`\r\n      link.download = actualFilename\r\n      document.body.appendChild(link)\r\n      link.click()\r\n      document.body.removeChild(link)\r\n      window.URL.revokeObjectURL(url)\r\n      toast.success('PDF downloaded successfully')\r\n    } catch (error) {\r\n      console.error('Error downloading PDF:', error)\r\n      toast.error('Failed to download PDF')\r\n    } finally {\r\n      setDownloadingPdf(null)\r\n    }\r\n  }\r\n\r\n  // Handle PDF preview in new tab\r\n  const handlePreviewPdf = async (pdfUrl: string) => {\r\n    try {\r\n      const response = await fetch(`/api/storage/download?path=${encodeURIComponent(pdfUrl)}&bucket=deal-documents`)\r\n      if (!response.ok) {\r\n        throw new Error('Failed to load file')\r\n      }\r\n      const blob = await response.blob()\r\n      const url = window.URL.createObjectURL(blob)\r\n      window.open(url, '_blank')\r\n    } catch (error) {\r\n      console.error('Error previewing PDF:', error)\r\n      toast.error('Failed to preview PDF')\r\n    }\r\n  }\r\n\r\n  // Get PDF URL from agreement (introducer or placement)\r\n  const getAgreementPdfInfo = (plan: any): { pdfUrl: string | null; referenceNumber: string | null } => {\r\n    if (plan.introducer_agreement?.pdf_url) {\r\n      return {\r\n        pdfUrl: plan.introducer_agreement.pdf_url,\r\n        referenceNumber: plan.introducer_agreement.reference_number\r\n      }\r\n    }\r\n    if (plan.placement_agreement?.pdf_url) {\r\n      return {\r\n        pdfUrl: plan.placement_agreement.pdf_url,\r\n        referenceNumber: plan.placement_agreement.reference_number\r\n      }\r\n    }\r\n    return { pdfUrl: null, referenceNumber: null }\r\n  }\r\n\r\n  const feeKindLabels: Record<string, string> = {\r\n    subscription: 'Subscription Fee',\r\n    management: 'Management Fee',\r\n    performance: 'Performance Fee',\r\n    spread_markup: 'Spread Markup',\r\n    flat: 'Flat Fee',\r\n    other: 'Other'\r\n  }\r\n\r\n  // Helper to get entity display info\r\n  const getEntityInfo = (plan: any) => {\r\n    if (plan.introducer_id) {\r\n      return {\r\n        type: 'Introducer',\r\n        icon: <Users className=\"h-4 w-4 text-blue-400\" />,\r\n        // Introducers table uses 'legal_name', not 'name' or 'company_name'\r\n        name: plan.introducer?.legal_name || plan.introducer?.name || plan.introducer?.company_name || 'Unknown'\r\n      }\r\n    }\r\n    if (plan.partner_id) {\r\n      return {\r\n        type: 'Partner',\r\n        icon: <Building2 className=\"h-4 w-4 text-green-400\" />,\r\n        // Partners table has 'name' and 'legal_name'\r\n        name: plan.partner?.name || plan.partner?.legal_name || plan.partner?.company_name || 'Unknown'\r\n      }\r\n    }\r\n    if (plan.commercial_partner_id) {\r\n      return {\r\n        type: 'Commercial Partner',\r\n        icon: <Briefcase className=\"h-4 w-4 text-purple-400\" />,\r\n        // Commercial partners table has 'name' and 'legal_name'\r\n        name: plan.commercial_partner?.name || plan.commercial_partner?.legal_name || plan.commercial_partner?.company_name || 'Unknown'\r\n      }\r\n    }\r\n    return null\r\n  }\r\n\r\n  // Helper to get status badge\r\n  const getStatusBadge = (plan: any) => {\r\n    const status = plan.status || 'draft'\r\n    switch (status) {\r\n      case 'accepted':\r\n        return (\r\n          <Badge className=\"bg-green-100 dark:bg-green-500/20 text-green-700 dark:text-green-400 border-green-300 dark:border-green-500/30\">\r\n            <CheckCircle className=\"h-3 w-3 mr-1\" />\r\n            Accepted\r\n          </Badge>\r\n        )\r\n      case 'sent':\r\n      case 'pending_signature':\r\n        return (\r\n          <Badge className=\"bg-amber-100 dark:bg-amber-500/20 text-amber-700 dark:text-amber-400 border-amber-300 dark:border-amber-500/30\">\r\n            <Clock className=\"h-3 w-3 mr-1\" />\r\n            Pending\r\n          </Badge>\r\n        )\r\n      case 'rejected':\r\n        return (\r\n          <Badge className=\"bg-red-100 dark:bg-red-500/20 text-red-700 dark:text-red-400 border-red-300 dark:border-red-500/30\">\r\n            <XCircle className=\"h-3 w-3 mr-1\" />\r\n            Rejected\r\n          </Badge>\r\n        )\r\n      default:\r\n        return (\r\n          <Badge variant=\"outline\" className=\"border-border text-muted-foreground\">\r\n            Draft\r\n          </Badge>\r\n        )\r\n    }\r\n  }\r\n\r\n  const handleCreateNew = () => {\r\n    setSelectedPlan(null)\r\n    setModalOpen(true)\r\n  }\r\n\r\n  const handleEdit = (plan: any) => {\r\n    // Transform fee_components to components for the modal\r\n    const normalizedPlan = {\r\n      ...plan,\r\n      components: plan.fee_components || []\r\n    }\r\n    setSelectedPlan(normalizedPlan)\r\n    setModalOpen(true)\r\n  }\r\n\r\n  const handleModalSuccess = () => {\r\n    setModalOpen(false)\r\n    setSelectedPlan(null)\r\n    router.refresh()\r\n  }\r\n\r\n  const handleModalClose = () => {\r\n    setModalOpen(false)\r\n    setSelectedPlan(null)\r\n  }\r\n\r\n  // Generate Introducer Agreement (DOC 3)\r\n  const handleGenerateIntroducerAgreement = async (plan: any) => {\r\n    if (!plan.introducer_id) return\r\n\r\n    setGeneratingAgreement(plan.id)\r\n    try {\r\n      const res = await fetch(`/api/staff/fees/plans/${plan.id}/generate-agreement`, {\r\n        method: 'POST',\r\n      })\r\n\r\n      if (!res.ok) {\r\n        const data = await res.json()\r\n        alert(`Failed to generate agreement: ${data.error || 'Unknown error'}`)\r\n        return\r\n      }\r\n\r\n      alert('Introducer Agreement generated successfully!')\r\n      router.refresh()\r\n    } catch (error) {\r\n      console.error('Error generating introducer agreement:', error)\r\n      alert('Failed to generate agreement')\r\n    } finally {\r\n      setGeneratingAgreement(null)\r\n    }\r\n  }\r\n\r\n  // Generate Partner Placement Agreement\r\n  const handleGeneratePartnerAgreement = async (plan: any) => {\r\n    if (!plan.partner_id) return\r\n\r\n    setGeneratingAgreement(plan.id)\r\n    try {\r\n      const res = await fetch(`/api/staff/fees/plans/${plan.id}/generate-placement-agreement`, {\r\n        method: 'POST',\r\n      })\r\n\r\n      if (!res.ok) {\r\n        const data = await res.json()\r\n        alert(`Failed to generate placement agreement: ${data.error || 'Unknown error'}`)\r\n        return\r\n      }\r\n\r\n      alert('Placement Agreement generated successfully!')\r\n      router.refresh()\r\n    } catch (error) {\r\n      console.error('Error generating placement agreement:', error)\r\n      alert('Failed to generate placement agreement')\r\n    } finally {\r\n      setGeneratingAgreement(null)\r\n    }\r\n  }\r\n\r\n  // Unified handler that routes to correct agreement type\r\n  const handleGenerateAgreement = async (plan: any) => {\r\n    if (plan.introducer_id) {\r\n      await handleGenerateIntroducerAgreement(plan)\r\n    } else if (plan.partner_id) {\r\n      await handleGeneratePartnerAgreement(plan)\r\n    }\r\n  }\r\n\r\n  // Check if agreement has been generated for this plan\r\n  const hasGeneratedAgreement = (plan: any) => {\r\n    if (plan.introducer_id && plan.generated_agreement_id) return true\r\n    if (plan.partner_id && plan.generated_placement_agreement_id) return true\r\n    return false\r\n  }\r\n\r\n  // Check if this plan can have an agreement generated\r\n  const canGenerateAgreement = (plan: any) => {\r\n    // Introducers: need introducer_id and no existing agreement\r\n    if (plan.introducer_id && !plan.generated_agreement_id) return true\r\n    // Partners: need partner_id and no existing placement agreement\r\n    if (plan.partner_id && !plan.generated_placement_agreement_id) return true\r\n    return false\r\n  }\r\n\r\n  // Get appropriate tooltip for generate button\r\n  const getGenerateTooltip = (plan: any) => {\r\n    if (plan.introducer_id) return 'Generate Introducer Agreement (DOC 3)'\r\n    if (plan.partner_id) return 'Generate Placement Agreement'\r\n    return ''\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Fee Plans Section (for investors) */}\r\n      <Card className=\"border border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n                <DollarSign className=\"h-5 w-5\" />\r\n                Fee Plans\r\n              </CardTitle>\r\n              <CardDescription>Configure fee structures for investors</CardDescription>\r\n            </div>\r\n            <Button onClick={handleCreateNew} className=\"gap-2\">\r\n              <Plus className=\"h-4 w-4\" />\r\n              Create Fee Plan\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {!feePlans || feePlans.length === 0 ? (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              No fee plans created yet. Click \"Create Fee Plan\" to begin.\r\n            </div>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              {feePlans.map((plan) => {\r\n                const entityInfo = getEntityInfo(plan)\r\n                return (\r\n                  <Card key={plan.id} className=\"border border-border bg-muted/50\">\r\n                    <CardHeader>\r\n                      <div className=\"flex items-start justify-between\">\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"flex items-center gap-2 mb-1\">\r\n                            <CardTitle className=\"text-lg text-foreground\">\r\n                              {plan.name}\r\n                            </CardTitle>\r\n                            {getStatusBadge(plan)}\r\n                          </div>\r\n                          {plan.description && (\r\n                            <CardDescription className=\"mt-1\">{plan.description}</CardDescription>\r\n                          )}\r\n                        </div>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          {/* Generate Agreement button - for introducers and partners */}\r\n                          {canGenerateAgreement(plan) && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleGenerateAgreement(plan)}\r\n                              disabled={generatingAgreement === plan.id}\r\n                              className=\"text-green-400 hover:text-green-300\"\r\n                              title={getGenerateTooltip(plan)}\r\n                            >\r\n                              {generatingAgreement === plan.id ? (\r\n                                <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                              ) : (\r\n                                <FileSignature className=\"h-4 w-4\" />\r\n                              )}\r\n                            </Button>\r\n                          )}\r\n                          {hasGeneratedAgreement(plan) && (\r\n                            <Badge className=\"bg-green-500/20 text-green-400 border-green-500/30 text-xs\">\r\n                              Agreement Generated\r\n                            </Badge>\r\n                          )}\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleEdit(plan)}\r\n                            className=\"text-blue-400 hover:text-blue-300\"\r\n                          >\r\n                            <Edit className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Term Sheet & Entity Info */}\r\n                      <div className=\"mt-3 space-y-2\">\r\n                        {plan.term_sheet_id && plan.term_sheet && (\r\n                          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                            <FileText className=\"h-4 w-4 text-muted-foreground\" />\r\n                            <span>\r\n                              Term Sheet v{plan.term_sheet.version}\r\n                              {plan.term_sheet.term_sheet_date && (\r\n                                <span className=\"text-muted-foreground ml-1\">\r\n                                  ({new Date(plan.term_sheet.term_sheet_date).toLocaleDateString()})\r\n                                </span>\r\n                              )}\r\n                            </span>\r\n                          </div>\r\n                        )}\r\n                        {!plan.term_sheet_id && (\r\n                          <div className=\"flex items-center gap-2 text-sm text-amber-400\">\r\n                            <FileText className=\"h-4 w-4\" />\r\n                            <span>No term sheet linked</span>\r\n                          </div>\r\n                        )}\r\n\r\n                        {entityInfo && (\r\n                          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                            {entityInfo.icon}\r\n                            <span>{entityInfo.type}: {entityInfo.name}</span>\r\n                          </div>\r\n                        )}\r\n                        {!entityInfo && (\r\n                          <div className=\"flex items-center gap-2 text-sm text-amber-400\">\r\n                            <Users className=\"h-4 w-4\" />\r\n                            <span>No entity linked</span>\r\n                          </div>\r\n                        )}\r\n\r\n                        {plan.accepted_at && (\r\n                          <div className=\"flex items-center gap-2 text-sm text-green-400\">\r\n                            <CheckCircle className=\"h-4 w-4\" />\r\n                            <span>Accepted {new Date(plan.accepted_at).toLocaleDateString()}</span>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-3\">\r\n                      {plan.fee_components && plan.fee_components.length > 0 ? (\r\n                        <div className=\"space-y-2\">\r\n                          {plan.fee_components.map((component: any) => (\r\n                            <div\r\n                              key={component.id}\r\n                              className=\"flex items-center justify-between py-2 px-3 rounded bg-muted/50\"\r\n                            >\r\n                              <span className=\"text-sm text-foreground\">\r\n                                {feeKindLabels[component.kind]}\r\n                              </span>\r\n                              <Badge variant=\"outline\" className=\"border-border text-muted-foreground\">\r\n                                {component.rate_bps ? `${component.rate_bps / 100}%` :\r\n                                 component.flat_amount ? `$${component.flat_amount}` : '—'}\r\n                              </Badge>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"text-center py-4\">\r\n                          <p className=\"text-sm text-muted-foreground mb-2\">No components added yet</p>\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleEdit(plan)}\r\n                            className=\"text-xs\"\r\n                          >\r\n                            Add Components\r\n                          </Button>\r\n                        </div>\r\n                      )}\r\n\r\n                      {/* Agreement Document Section */}\r\n                      {(() => {\r\n                        const { pdfUrl, referenceNumber } = getAgreementPdfInfo(plan)\r\n                        if (!pdfUrl) return null\r\n\r\n                        return (\r\n                          <div className=\"mt-4 pt-4 border-t border-border\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <div className=\"flex items-center gap-3\">\r\n                                <div className=\"p-2 rounded-lg bg-green-500/10\">\r\n                                  <FileText className=\"h-5 w-5 text-green-400\" />\r\n                                </div>\r\n                                <div>\r\n                                  <p className=\"text-sm font-medium text-foreground\">\r\n                                    {plan.introducer_id ? 'Introducer Agreement' : 'Placement Agreement'}\r\n                                  </p>\r\n                                  <p className=\"text-xs text-muted-foreground\">\r\n                                    {referenceNumber || 'Document ready'}\r\n                                  </p>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <Button\r\n                                  variant=\"outline\"\r\n                                  size=\"sm\"\r\n                                  onClick={() => handlePreviewPdf(pdfUrl)}\r\n                                  className=\"text-blue-400 border-blue-400/30 hover:bg-blue-400/10\"\r\n                                >\r\n                                  <Eye className=\"h-4 w-4 mr-1\" />\r\n                                  Preview\r\n                                </Button>\r\n                                <Button\r\n                                  variant=\"outline\"\r\n                                  size=\"sm\"\r\n                                  onClick={() => handleDownloadPdf(pdfUrl, referenceNumber)}\r\n                                  disabled={downloadingPdf === pdfUrl}\r\n                                  className=\"text-green-400 border-green-400/30 hover:bg-green-400/10\"\r\n                                >\r\n                                  {downloadingPdf === pdfUrl ? (\r\n                                    <Loader2 className=\"h-4 w-4 mr-1 animate-spin\" />\r\n                                  ) : (\r\n                                    <Download className=\"h-4 w-4 mr-1\" />\r\n                                  )}\r\n                                  Download\r\n                                </Button>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        )\r\n                      })()}\r\n                    </CardContent>\r\n                  </Card>\r\n                )\r\n              })}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Fee Plan Edit Modal */}\r\n      <FeePlanEditModal\r\n        open={modalOpen}\r\n        onClose={handleModalClose}\r\n        onSuccess={handleModalSuccess}\r\n        feePlan={selectedPlan}\r\n        dealId={dealId}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState, useCallback, useEffect } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { useDropzone } from 'react-dropzone'\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { Checkbox } from '@/components/ui/checkbox'\r\nimport { Progress } from '@/components/ui/progress'\r\nimport { Upload, File, X, Loader2, FolderOpen } from 'lucide-react'\r\nimport { toast } from 'sonner'\r\n\r\ninterface DocumentUploadProps {\r\n  dealId: string\r\n  onUploadComplete?: () => void\r\n  trigger: React.ReactNode\r\n}\r\n\r\ninterface DealFolder {\r\n  id: string\r\n  name: string\r\n  path: string\r\n  folder_type: string\r\n}\r\n\r\n// Fallback folders if database folders aren't available\r\nconst DEFAULT_FOLDERS = [\r\n  'Term Sheets',\r\n  'Data Room',\r\n  'Subscription Documents',\r\n  'Legal Documents',\r\n  'Financial Reports',\r\n  'Due Diligence'\r\n]\r\n\r\nexport function DataRoomDocumentUpload({ dealId, onUploadComplete, trigger }: DocumentUploadProps) {\r\n  const router = useRouter()\r\n  const [open, setOpen] = useState(false)\r\n  const [files, setFiles] = useState<File[]>([])\r\n  const [dealFolders, setDealFolders] = useState<DealFolder[]>([])\r\n  const [selectedFolderId, setSelectedFolderId] = useState<string | null>(null)\r\n  const [folder, setFolder] = useState('Data Room') // Default folder name for backward compatibility\r\n  const [visibleToInvestors, setVisibleToInvestors] = useState(false)\r\n  const [isFeatured, setIsFeatured] = useState(false)\r\n  const [uploading, setUploading] = useState(false)\r\n  const [uploadProgress, setUploadProgress] = useState(0)\r\n  const [uploadMode, setUploadMode] = useState<'file' | 'link'>('file')\r\n  const [externalLink, setExternalLink] = useState('')\r\n  const [linkFileName, setLinkFileName] = useState('')\r\n  const [loadingFolders, setLoadingFolders] = useState(false)\r\n\r\n  const fetchDealFolders = useCallback(async () => {\r\n    setLoadingFolders(true)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/folders`)\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        setDealFolders(data.folders || [])\r\n\r\n        // Set default folder (prefer Data Room folder)\r\n        const dataRoomFolder = data.folders?.find((f: DealFolder) =>\r\n          f.name === 'Data Room' || f.path?.includes('/Data Room')\r\n        )\r\n        if (dataRoomFolder) {\r\n          setSelectedFolderId(dataRoomFolder.id)\r\n          setFolder('Data Room')\r\n        } else if (data.folders?.length > 0) {\r\n          setSelectedFolderId(data.folders[0].id)\r\n          setFolder(data.folders[0].name)\r\n        }\r\n      } else {\r\n        // If folder fetch fails, folders might not be created yet\r\n        console.warn('Could not fetch deal folders, using defaults')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching deal folders:', error)\r\n    } finally {\r\n      setLoadingFolders(false)\r\n    }\r\n  }, [dealId])\r\n\r\n  // Fetch deal folders when dialog opens\r\n  useEffect(() => {\r\n    if (open && dealId) {\r\n      fetchDealFolders()\r\n    }\r\n  }, [open, dealId, fetchDealFolders])\r\n\r\n  const onDrop = useCallback((acceptedFiles: File[]) => {\r\n    setFiles(prev => [...prev, ...acceptedFiles])\r\n  }, [])\r\n\r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop,\r\n    multiple: true\r\n  })\r\n\r\n  const removeFile = (index: number) => {\r\n    setFiles(prev => prev.filter((_, i) => i !== index))\r\n  }\r\n\r\n  const handleUpload = async () => {\r\n    if (uploadMode === 'file' && files.length === 0) {\r\n      toast.error('Please select files to upload')\r\n      return\r\n    }\r\n\r\n    if (uploadMode === 'link') {\r\n      if (!externalLink.trim()) {\r\n        toast.error('Please enter a link')\r\n        return\r\n      }\r\n      if (!linkFileName.trim()) {\r\n        toast.error('Please enter a document name')\r\n        return\r\n      }\r\n    }\r\n\r\n    setUploading(true)\r\n    setUploadProgress(0)\r\n\r\n    try {\r\n      if (uploadMode === 'link') {\r\n        // Upload external link\r\n        const response = await fetch(`/api/deals/${dealId}/documents/link`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            external_link: externalLink,\r\n            file_name: linkFileName,\r\n            folder,\r\n            folder_id: selectedFolderId, // Include folder_id when available\r\n            visible_to_investors: visibleToInvestors,\r\n            is_featured: isFeatured\r\n          })\r\n        })\r\n\r\n        if (!response.ok) {\r\n          const error = await response.json()\r\n          toast.error(`Failed to add link: ${error.error}`)\r\n        } else {\r\n          toast.success('Link added successfully')\r\n        }\r\n\r\n        setUploadProgress(100)\r\n      } else {\r\n        // Upload files\r\n        let successCount = 0\r\n\r\n        for (let i = 0; i < files.length; i++) {\r\n          const file = files[i]\r\n          const formData = new FormData()\r\n          formData.append('file', file)\r\n          formData.append('folder', folder)\r\n          if (selectedFolderId) {\r\n            formData.append('folder_id', selectedFolderId) // Include folder_id when available\r\n          }\r\n          formData.append('visible_to_investors', visibleToInvestors.toString())\r\n          formData.append('is_featured', isFeatured.toString())\r\n\r\n          const response = await fetch(`/api/deals/${dealId}/documents/upload`, {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n\r\n          if (!response.ok) {\r\n            const error = await response.json()\r\n            toast.error(`Failed to upload ${file.name}: ${error.error}`)\r\n            continue\r\n          }\r\n\r\n          successCount++\r\n          setUploadProgress(Math.round(((i + 1) / files.length) * 100))\r\n        }\r\n\r\n        toast.success(`Successfully uploaded ${successCount} of ${files.length} files`)\r\n      }\r\n\r\n      // Reset form\r\n      setFiles([])\r\n      setFolder('Legal')\r\n      setVisibleToInvestors(false)\r\n      setIsFeatured(false)\r\n      setExternalLink('')\r\n      setLinkFileName('')\r\n      setOpen(false)\r\n\r\n      // Refresh to show new documents\r\n      onUploadComplete?.()\r\n      router.refresh()\r\n    } catch (error) {\r\n      console.error('Upload error:', error)\r\n      toast.error('Failed to upload documents')\r\n    } finally {\r\n      setUploading(false)\r\n      setUploadProgress(0)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div onClick={() => setOpen(true)}>{trigger}</div>\r\n      \r\n      <Dialog open={open} onOpenChange={setOpen}>\r\n        <DialogContent className=\"sm:max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle>Add Documents</DialogTitle>\r\n            <DialogDescription>\r\n              Upload files or add links to external documents (Google Drive, Dropbox, etc.)\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4\">\r\n            {/* Mode Selector */}\r\n            <div className=\"flex gap-2 border-b\">\r\n              <Button\r\n                variant={uploadMode === 'file' ? 'default' : 'ghost'}\r\n                onClick={() => setUploadMode('file')}\r\n                className=\"flex-1\"\r\n              >\r\n                Upload Files\r\n              </Button>\r\n              <Button\r\n                variant={uploadMode === 'link' ? 'default' : 'ghost'}\r\n                onClick={() => setUploadMode('link')}\r\n                className=\"flex-1\"\r\n              >\r\n                Add Link\r\n              </Button>\r\n            </div>\r\n\r\n            {uploadMode === 'file' ? (\r\n              <>\r\n                {/* Dropzone */}\r\n                <div\r\n                  {...getRootProps()}\r\n                  className={`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${\r\n                    isDragActive ? 'border-blue-500 bg-blue-500/10' : 'border-border hover:border-muted-foreground'\r\n                  }`}\r\n                >\r\n                  <input {...getInputProps()} />\r\n                  <Upload className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\" />\r\n                  {isDragActive ? (\r\n                    <p className=\"text-blue-600 dark:text-blue-400 font-medium\">Drop files here...</p>\r\n                  ) : (\r\n                    <>\r\n                      <p className=\"text-foreground font-medium mb-1\">\r\n                        Drag and drop files here, or click to browse\r\n                      </p>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Supports all document types (PDF, DOCX, XLSX, JSON, etc.)\r\n                      </p>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <>\r\n                {/* Link Input */}\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"linkUrl\">Document Link</Label>\r\n                    <Input\r\n                      id=\"linkUrl\"\r\n                      type=\"url\"\r\n                      value={externalLink}\r\n                      onChange={(e) => setExternalLink(e.target.value)}\r\n                      placeholder=\"https://drive.google.com/file/d/...\"\r\n                    />\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      Paste a Google Drive, Dropbox, or any public link\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"linkName\">Document Name</Label>\r\n                    <Input\r\n                      id=\"linkName\"\r\n                      value={linkFileName}\r\n                      onChange={(e) => setLinkFileName(e.target.value)}\r\n                      placeholder=\"Q4 2024 Report\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </>\r\n            )}\r\n\r\n            {/* File List */}\r\n            {uploadMode === 'file' && files.length > 0 && (\r\n              <div className=\"space-y-2\">\r\n                <Label>Selected Files ({files.length})</Label>\r\n                <div className=\"max-h-48 overflow-y-auto space-y-2\">\r\n                  {files.map((file, index) => (\r\n                    <div\r\n                      key={index}\r\n                      className=\"flex items-center justify-between p-2 bg-muted rounded border border-border\"\r\n                    >\r\n                      <div className=\"flex items-center gap-2 flex-1 min-w-0\">\r\n                        <File className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\r\n                        <span className=\"text-sm truncate\">{file.name}</span>\r\n                        <span className=\"text-xs text-muted-foreground flex-shrink-0\">\r\n                          ({(file.size / 1024).toFixed(1)} KB)\r\n                        </span>\r\n                      </div>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => removeFile(index)}\r\n                        disabled={uploading}\r\n                      >\r\n                        <X className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Settings */}\r\n            <div className=\"space-y-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>Folder</Label>\r\n                <Select\r\n                  value={selectedFolderId || folder}\r\n                  onValueChange={(value) => {\r\n                    // Check if value is a folder ID (UUID) or folder name\r\n                    const folderObj = dealFolders.find(f => f.id === value)\r\n                    if (folderObj) {\r\n                      setSelectedFolderId(folderObj.id)\r\n                      setFolder(folderObj.name)\r\n                    } else {\r\n                      // Fallback to using folder name directly\r\n                      setSelectedFolderId(null)\r\n                      setFolder(value)\r\n                    }\r\n                  }}\r\n                  disabled={uploading || loadingFolders}\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder={loadingFolders ? \"Loading folders...\" : \"Select folder\"} />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    {dealFolders.length > 0 ? (\r\n                      dealFolders.map(f => (\r\n                        <SelectItem key={f.id} value={f.id}>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <FolderOpen className=\"h-3 w-3\" />\r\n                            <span>{f.name}</span>\r\n                          </div>\r\n                        </SelectItem>\r\n                      ))\r\n                    ) : (\r\n                      DEFAULT_FOLDERS.map(f => (\r\n                        <SelectItem key={f} value={f}>\r\n                          {f}\r\n                        </SelectItem>\r\n                      ))\r\n                    )}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <Checkbox\r\n                    id=\"visible\"\r\n                    checked={visibleToInvestors}\r\n                    onCheckedChange={(checked) => setVisibleToInvestors(checked as boolean)}\r\n                    disabled={uploading}\r\n                  />\r\n                  <label\r\n                    htmlFor=\"visible\"\r\n                    className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\r\n                  >\r\n                    Visible to investors\r\n                  </label>\r\n                </div>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <Checkbox\r\n                    id=\"featured\"\r\n                    checked={isFeatured}\r\n                    onCheckedChange={(checked) => setIsFeatured(checked as boolean)}\r\n                    disabled={uploading}\r\n                  />\r\n                  <label\r\n                    htmlFor=\"featured\"\r\n                    className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\r\n                  >\r\n                    Featured document\r\n                  </label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Progress */}\r\n            {uploading && (\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between text-sm\">\r\n                  <span>Uploading...</span>\r\n                  <span>{uploadProgress}%</span>\r\n                </div>\r\n                <Progress value={uploadProgress} />\r\n              </div>\r\n            )}\r\n\r\n            {/* Actions */}\r\n            <div className=\"flex justify-end gap-2\">\r\n              <Button variant=\"outline\" onClick={() => setOpen(false)} disabled={uploading}>\r\n                Cancel\r\n              </Button>\r\n              <Button onClick={handleUpload} disabled={uploading || (uploadMode === 'file' && files.length === 0)}>\r\n                {uploading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                {uploadMode === 'link' ? 'Add Link' : `Upload ${files.length > 0 ? `(${files.length})` : ''}`}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  )\r\n}\r\n\r\n","'use client'\n\nimport { useState, useEffect, useCallback, useRef, ChangeEvent } from 'react'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle\n} from '@/components/ui/dialog'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow\n} from '@/components/ui/table'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Download, FileText, Loader2, Upload } from 'lucide-react'\nimport { format } from 'date-fns'\nimport { toast } from 'sonner'\n\ninterface DocumentVersionsProps {\n  dealId: string\n  documentId: string\n  open: boolean\n  onOpenChange: (open: boolean) => void\n}\n\ninterface DocumentVersion {\n  id: string\n  file_name: string\n  version: number\n  created_at: string\n  created_by: string | null\n  file_size_bytes: number | null\n  replaced_by_id: string | null\n  file_key: string\n}\n\nexport function DataRoomDocumentVersions({\n  dealId,\n  documentId,\n  open,\n  onOpenChange\n}: DocumentVersionsProps) {\n  const [versions, setVersions] = useState<DocumentVersion[]>([])\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [uploading, setUploading] = useState(false)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  const handleUploadVersion = async (e: ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (!file) return\n\n    setUploading(true)\n    try {\n      const formData = new FormData()\n      formData.append('file', file)\n\n      const response = await fetch(`/api/deals/${dealId}/documents/${documentId}/versions`, {\n        method: 'POST',\n        body: formData\n      })\n\n      if (!response.ok) {\n        const data = await response.json()\n        throw new Error(data.error || 'Failed to upload new version')\n      }\n\n      toast.success('New version uploaded successfully')\n      await loadVersions()\n    } catch (err) {\n      console.error('Error uploading version:', err)\n      toast.error(err instanceof Error ? err.message : 'Failed to upload new version')\n    } finally {\n      setUploading(false)\n      // Reset file input\n      if (fileInputRef.current) {\n        fileInputRef.current.value = ''\n      }\n    }\n  }\n\n  const loadVersions = useCallback(async () => {\n    setLoading(true)\n    setError(null)\n\n    try {\n      const response = await fetch(`/api/deals/${dealId}/documents/${documentId}/versions`)\n      \n      if (!response.ok) {\n        throw new Error('Failed to load version history')\n      }\n\n      const data = await response.json()\n      setVersions(data.versions || [])\n    } catch (err) {\n      console.error('Error loading versions:', err)\n      setError(err instanceof Error ? err.message : 'Failed to load versions')\n    } finally {\n      setLoading(false)\n    }\n  }, [dealId, documentId])\n\n  useEffect(() => {\n    if (open && documentId) {\n      loadVersions()\n    }\n  }, [open, documentId, loadVersions])\n\n  const formatFileSize = (bytes: number | null) => {\n    if (!bytes) return '—'\n    if (bytes < 1024) return `${bytes} B`\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`\n    return `${(bytes / (1024 * 1024)).toFixed(1)} MB`\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-3xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <div className=\"flex items-center justify-between\">\n            <DialogTitle className=\"flex items-center gap-2\">\n              <FileText className=\"h-5 w-5\" />\n              Document Version History\n            </DialogTitle>\n            <div>\n              <Button\n                size=\"sm\"\n                onClick={() => fileInputRef.current?.click()}\n                disabled={uploading || loading}\n              >\n                {uploading ? (\n                  <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                ) : (\n                  <Upload className=\"h-4 w-4 mr-2\" />\n                )}\n                {uploading ? 'Uploading...' : 'Upload New Version'}\n              </Button>\n              <input\n                type=\"file\"\n                ref={fileInputRef}\n                onChange={handleUploadVersion}\n                className=\"hidden\"\n                accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.csv\"\n              />\n            </div>\n          </div>\n          <DialogDescription>\n            View all versions of this document. The latest version is shown to investors.\n          </DialogDescription>\n        </DialogHeader>\n\n        {loading && (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n          </div>\n        )}\n\n        {error && (\n          <div className=\"text-center py-8 text-destructive\">\n            {error}\n          </div>\n        )}\n\n        {!loading && !error && versions.length === 0 && (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            No version history available yet.\n          </div>\n        )}\n\n        {!loading && !error && versions.length > 0 && (\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Version</TableHead>\n                <TableHead>File Name</TableHead>\n                <TableHead>Size</TableHead>\n                <TableHead>Uploaded</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {versions.map(version => {\n                const isLatest = !version.replaced_by_id\n                return (\n                  <TableRow key={version.id}>\n                    <TableCell className=\"font-medium\">\n                      v{version.version}\n                    </TableCell>\n                    <TableCell className=\"font-mono text-sm\">\n                      {version.file_name}\n                    </TableCell>\n                    <TableCell className=\"text-sm text-muted-foreground\">\n                      {formatFileSize(version.file_size_bytes)}\n                    </TableCell>\n                    <TableCell className=\"text-sm\">\n                      {format(new Date(version.created_at), 'dd MMM yyyy HH:mm')}\n                    </TableCell>\n                    <TableCell>\n                      {isLatest ? (\n                        <Badge className=\"bg-emerald-500/20 text-emerald-200\">\n                          Current\n                        </Badge>\n                      ) : (\n                        <Badge variant=\"outline\" className=\"text-muted-foreground\">\n                          Replaced\n                        </Badge>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                        <Download className=\"h-4 w-4\" />\n                        Download\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                )\n              })}\n            </TableBody>\n          </Table>\n        )}\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n","'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { FileText, Upload, Download, Trash2, Plus, Edit, History } from 'lucide-react'\r\nimport { DataRoomDocumentUpload } from './data-room-document-upload'\r\nimport { DataRoomDocumentEditor } from './data-room-document-editor'\r\nimport { DataRoomDocumentVersions } from './data-room-document-versions'\r\nimport { toast } from 'sonner'\r\n\r\ninterface DealDocumentsTabProps {\r\n  dealId: string\r\n  documents: any[]\r\n  onRefresh?: () => void\r\n}\r\n\r\nexport function DealDocumentsTab({ dealId, documents, onRefresh }: DealDocumentsTabProps) {\r\n  const [refreshKey, setRefreshKey] = useState(0)\r\n  const [editingDocument, setEditingDocument] = useState<any | null>(null)\r\n  const [versionHistoryDoc, setVersionHistoryDoc] = useState<string | null>(null)\r\n  const [deleting, setDeleting] = useState<string | null>(null)\r\n  const [downloading, setDownloading] = useState<string | null>(null)\r\n  \r\n  const docTypeColors: Record<string, string> = {\r\n    nda: 'bg-purple-500/20 text-purple-700 dark:text-purple-200',\r\n    term_sheet: 'bg-blue-500/20 text-blue-700 dark:text-blue-200',\r\n    subscription: 'bg-emerald-500/20 text-emerald-700 dark:text-emerald-200',\r\n    contract: 'bg-amber-500/20 text-amber-700 dark:text-amber-200',\r\n    report: 'bg-cyan-500/20 text-cyan-700 dark:text-cyan-200',\r\n    other: 'bg-muted text-muted-foreground'\r\n  }\r\n\r\n  const handleUploadComplete = () => {\r\n    setRefreshKey(prev => prev + 1)\r\n    // Trigger callback to refresh parent component\r\n    if (onRefresh) {\r\n      onRefresh()\r\n    }\r\n  }\r\n\r\n  const handleDownload = async (documentId: string) => {\r\n    setDownloading(documentId)\r\n\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/documents/${documentId}/download`)\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to generate download link')\r\n      }\r\n\r\n      const data = await response.json()\r\n\r\n      // Open the signed URL in a new tab\r\n      window.open(data.download_url, '_blank')\r\n\r\n      toast.success('Document download started')\r\n    } catch (error) {\r\n      console.error('Download error:', error)\r\n      toast.error('Failed to download document')\r\n    } finally {\r\n      setDownloading(null)\r\n    }\r\n  }\r\n\r\n  const handleDelete = async (documentId: string) => {\r\n    if (!confirm('Are you sure you want to delete this document? This action cannot be undone.')) {\r\n      return\r\n    }\r\n\r\n    setDeleting(documentId)\r\n\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/documents/${documentId}`, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to delete document')\r\n      }\r\n\r\n      toast.success('Document deleted successfully')\r\n      if (onRefresh) {\r\n        onRefresh()\r\n      }\r\n    } catch (error) {\r\n      console.error('Delete error:', error)\r\n      toast.error('Failed to delete document')\r\n    } finally {\r\n      setDeleting(null)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card className=\"border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n                <FileText className=\"h-5 w-5\" />\r\n                Deal Documents\r\n              </CardTitle>\r\n              <CardDescription>Documents scoped to this deal only</CardDescription>\r\n            </div>\r\n            <DataRoomDocumentUpload\r\n              dealId={dealId}\r\n              onUploadComplete={handleUploadComplete}\r\n              trigger={\r\n                <Button className=\"gap-2\">\r\n                  <Plus className=\"h-4 w-4\" />\r\n                  Upload Document\r\n                </Button>\r\n              }\r\n            />\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {documents.length === 0 ? (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              No documents uploaded yet. Click \"Upload Document\" to add files.\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-2\">\r\n              {documents.map((doc) => (\r\n                <div\r\n                  key={doc.id}\r\n                  className=\"flex items-center justify-between py-3 px-4 rounded-lg border border-border bg-muted/50 hover:bg-muted transition-colors\"\r\n                >\r\n                  <div className=\"flex items-center gap-3 flex-1\">\r\n                    <FileText className=\"h-5 w-5 text-muted-foreground\" />\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-medium text-foreground\">\r\n                          {doc.file_key.split('/').pop()}\r\n                        </span>\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Uploaded {new Date(doc.created_at).toLocaleDateString()}\r\n                        {doc.created_by_profile && ` by ${doc.created_by_profile.display_name}`}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className=\"gap-2\"\r\n                      onClick={() => setEditingDocument(doc)}\r\n                    >\r\n                      <Edit className=\"h-4 w-4\" />\r\n                      Edit\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className=\"gap-2\"\r\n                      onClick={() => setVersionHistoryDoc(doc.id)}\r\n                    >\r\n                      <History className=\"h-4 w-4\" />\r\n                      Versions\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className=\"gap-2\"\r\n                      onClick={() => handleDownload(doc.id)}\r\n                      disabled={downloading === doc.id}\r\n                    >\r\n                      <Download className=\"h-4 w-4\" />\r\n                      {downloading === doc.id ? 'Downloading...' : 'Download'}\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className=\"text-red-700 dark:text-red-200\"\r\n                      onClick={() => handleDelete(doc.id)}\r\n                      disabled={deleting === doc.id}\r\n                    >\r\n                      <Trash2 className=\"h-4 w-4\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Document Editor Dialog */}\r\n      {editingDocument && (\r\n        <DataRoomDocumentEditor\r\n          dealId={dealId}\r\n          documentId={editingDocument.id}\r\n          open={!!editingDocument}\r\n          onOpenChange={(open) => !open && setEditingDocument(null)}\r\n          onSaved={() => {\r\n            setEditingDocument(null)\r\n            if (onRefresh) {\r\n              onRefresh()\r\n            }\r\n          }}\r\n          initialData={{\r\n            file_name: editingDocument.file_name,\r\n            folder: editingDocument.folder,\r\n            visible_to_investors: editingDocument.visible_to_investors,\r\n            tags: editingDocument.tags,\r\n            document_notes: editingDocument.document_notes,\r\n            document_expires_at: editingDocument.document_expires_at\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Version History Dialog */}\r\n      {versionHistoryDoc && (\r\n        <DataRoomDocumentVersions\r\n          dealId={dealId}\r\n          documentId={versionHistoryDoc}\r\n          open={!!versionHistoryDoc}\r\n          onOpenChange={(open) => !open && setVersionHistoryDoc(null)}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Skeleton } from '@/components/ui/skeleton'\r\nimport { ScrollArea } from '@/components/ui/scroll-area'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport {\r\n  Activity,\r\n  FileText,\r\n  Users,\r\n  Heart,\r\n  Lock,\r\n  CheckCircle,\r\n  Edit,\r\n  AlertCircle,\r\n  Clock,\r\n  Filter,\r\n  RefreshCw\r\n} from 'lucide-react'\r\nimport { formatDistanceToNow, format } from 'date-fns'\r\n\r\ninterface DealActivityEvent {\r\n  id: string\r\n  timestamp: string\r\n  type: string\r\n  category: 'conversion' | 'audit' | 'membership' | 'interest' | 'access' | 'subscription'\r\n  actor: {\r\n    name: string\r\n    email: string\r\n    role: string\r\n  } | null\r\n  description: string\r\n  details?: Record<string, any>\r\n}\r\n\r\ninterface DealActivityTabProps {\r\n  dealId: string\r\n}\r\n\r\nconst categoryIcons = {\r\n  conversion: RefreshCw,\r\n  audit: Edit,\r\n  membership: Users,\r\n  interest: Heart,\r\n  access: Lock,\r\n  subscription: FileText\r\n}\r\n\r\nconst categoryColors = {\r\n  conversion: 'text-purple-500',\r\n  audit: 'text-muted-foreground',\r\n  membership: 'text-blue-500',\r\n  interest: 'text-pink-500',\r\n  access: 'text-orange-500',\r\n  subscription: 'text-green-500'\r\n}\r\n\r\nconst categoryBgColors = {\r\n  conversion: 'bg-purple-500/10',\r\n  audit: 'bg-muted',\r\n  membership: 'bg-blue-500/10',\r\n  interest: 'bg-pink-500/10',\r\n  access: 'bg-orange-500/10',\r\n  subscription: 'bg-green-500/10'\r\n}\r\n\r\nconst categoryLabels = {\r\n  conversion: 'Conversion',\r\n  audit: 'Audit',\r\n  membership: 'Membership',\r\n  interest: 'Interest',\r\n  access: 'Access',\r\n  subscription: 'Subscription'\r\n}\r\n\r\nexport function DealActivityTab({ dealId }: DealActivityTabProps) {\r\n  const [activities, setActivities] = useState<DealActivityEvent[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [filter, setFilter] = useState<string>('all')\r\n  const [hasMore, setHasMore] = useState(false)\r\n  const [offset, setOffset] = useState(0)\r\n  const limit = 50\r\n\r\n  const fetchActivities = async (loadMore = false) => {\r\n    try {\r\n      setLoading(true)\r\n      const currentOffset = loadMore ? offset : 0\r\n      const categoryParam = filter !== 'all' ? `&category=${filter}` : ''\r\n      const response = await fetch(\r\n        `/api/deals/${dealId}/activity?limit=${limit}&offset=${currentOffset}${categoryParam}`\r\n      )\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch activity timeline')\r\n      }\r\n\r\n      const data = await response.json()\r\n\r\n      if (loadMore) {\r\n        setActivities(prev => [...prev, ...(data.events || [])])\r\n      } else {\r\n        setActivities(data.events || [])\r\n      }\r\n\r\n      setHasMore(data.hasMore || false)\r\n      setOffset(currentOffset + (data.events?.length || 0))\r\n      setError(null)\r\n    } catch (err) {\r\n      console.error('Failed to fetch activities:', err)\r\n      setError('Failed to load activity timeline')\r\n      setActivities([])\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    setOffset(0)\r\n    fetchActivities(false)\r\n  }, [dealId, filter])\r\n\r\n  const handleLoadMore = () => {\r\n    fetchActivities(true)\r\n  }\r\n\r\n  if (loading && activities.length === 0) {\r\n    return (\r\n      <Card className=\"border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <Skeleton className=\"h-6 w-32\" />\r\n          <Skeleton className=\"h-4 w-48\" />\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {[1, 2, 3, 4, 5].map((i) => (\r\n              <div key={i} className=\"flex gap-4\">\r\n                <Skeleton className=\"h-10 w-10 rounded-full\" />\r\n                <div className=\"flex-1 space-y-2\">\r\n                  <Skeleton className=\"h-4 w-3/4\" />\r\n                  <Skeleton className=\"h-3 w-1/2\" />\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Card className=\"border-border bg-muted/50\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex items-center gap-2 text-destructive\">\r\n            <AlertCircle className=\"h-4 w-4\" />\r\n            <p>{error}</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Card className=\"border-border bg-muted/50\">\r\n      <CardHeader>\r\n        <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n          <div>\r\n            <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n              <Activity className=\"h-5 w-5\" />\r\n              Activity Log\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Complete audit trail of all deal actions\r\n            </CardDescription>\r\n          </div>\r\n          <Select value={filter} onValueChange={setFilter}>\r\n            <SelectTrigger className=\"w-[180px]\">\r\n              <Filter className=\"h-4 w-4 mr-2\" />\r\n              <SelectValue />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Activities</SelectItem>\r\n              <SelectItem value=\"conversion\">Conversions</SelectItem>\r\n              <SelectItem value=\"audit\">Audit Trail</SelectItem>\r\n              <SelectItem value=\"membership\">Membership</SelectItem>\r\n              <SelectItem value=\"interest\">Interest</SelectItem>\r\n              <SelectItem value=\"access\">Access Control</SelectItem>\r\n              <SelectItem value=\"subscription\">Subscriptions</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <ScrollArea style={{ height: '600px' }} className=\"pr-4\">\r\n          {activities.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <Clock className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\r\n              <p className=\"text-muted-foreground text-lg font-medium\">No activities found</p>\r\n              <p className=\"text-sm text-muted-foreground mt-2\">\r\n                {filter === 'all'\r\n                  ? 'There are no recorded activities for this deal in the last 90 days.'\r\n                  : `No ${categoryLabels[filter as keyof typeof categoryLabels]} activities found.`}\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {activities.map((activity, index) => {\r\n                const Icon = categoryIcons[activity.category]\r\n                const iconColor = categoryColors[activity.category]\r\n                const bgColor = categoryBgColors[activity.category]\r\n                const isLast = index === activities.length - 1 && !hasMore\r\n\r\n                return (\r\n                  <div key={activity.id} className=\"relative\">\r\n                    {/* Timeline line */}\r\n                    {!isLast && (\r\n                      <div className=\"absolute left-5 top-12 bottom-0 w-px bg-border\" />\r\n                    )}\r\n\r\n                    {/* Activity item */}\r\n                    <div className=\"flex gap-4\">\r\n                      {/* Icon */}\r\n                      <div\r\n                        className={`flex-shrink-0 w-10 h-10 rounded-full ${bgColor} flex items-center justify-center relative z-10`}\r\n                      >\r\n                        <Icon className={`h-5 w-5 ${iconColor}`} />\r\n                      </div>\r\n\r\n                      {/* Content */}\r\n                      <div className=\"flex-1 pb-8\">\r\n                        <div className=\"flex items-start justify-between gap-4\">\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\r\n                              <p className=\"font-semibold text-sm text-foreground\">\r\n                                {activity.type}\r\n                              </p>\r\n                              <Badge variant=\"outline\" className=\"text-xs\">\r\n                                {categoryLabels[activity.category]}\r\n                              </Badge>\r\n                            </div>\r\n                            <p className=\"text-sm text-muted-foreground mb-2\">\r\n                              {activity.description}\r\n                            </p>\r\n\r\n                            {/* Details metadata */}\r\n                            {activity.details && Object.keys(activity.details).length > 0 && (\r\n                              <div className=\"flex flex-wrap gap-2 mb-2\">\r\n                                {Object.entries(activity.details)\r\n                                  .filter(([key]) => !['id', 'userId', 'dealId'].includes(key))\r\n                                  .map(([key, value]) => {\r\n                                    // Format the value nicely\r\n                                    let displayValue = String(value)\r\n                                    if (typeof value === 'boolean') {\r\n                                      displayValue = value ? 'Yes' : 'No'\r\n                                    } else if (value === null || value === undefined) {\r\n                                      return null\r\n                                    }\r\n\r\n                                    return (\r\n                                      <div\r\n                                        key={key}\r\n                                        className=\"text-xs bg-muted px-2 py-1 rounded\"\r\n                                      >\r\n                                        <span className=\"font-medium\">\r\n                                          {key.replace(/_/g, ' ')}:\r\n                                        </span>{' '}\r\n                                        <span>{displayValue}</span>\r\n                                      </div>\r\n                                    )\r\n                                  })}\r\n                              </div>\r\n                            )}\r\n\r\n                            {/* Footer */}\r\n                            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                              {activity.actor && (\r\n                                <>\r\n                                  <span>\r\n                                    by {activity.actor.name}\r\n                                    {activity.actor.role && ` (${activity.actor.role})`}\r\n                                  </span>\r\n                                  <span>•</span>\r\n                                </>\r\n                              )}\r\n                              <span\r\n                                title={format(new Date(activity.timestamp), 'PPpp')}\r\n                              >\r\n                                {formatDistanceToNow(new Date(activity.timestamp), {\r\n                                  addSuffix: true\r\n                                })}\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n\r\n                          {/* Success/Error indicator */}\r\n                          {activity.details?.status === 'success' ||\r\n                          activity.details?.status === 'approved' ? (\r\n                            <CheckCircle className=\"h-4 w-4 text-green-600 flex-shrink-0\" />\r\n                          ) : null}\r\n                          {activity.details?.status === 'error' ||\r\n                          activity.details?.status === 'rejected' ? (\r\n                            <AlertCircle className=\"h-4 w-4 text-red-600 flex-shrink-0\" />\r\n                          ) : null}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )\r\n              })}\r\n\r\n              {/* Load More Button */}\r\n              {hasMore && (\r\n                <div className=\"flex justify-center pt-4\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={handleLoadMore}\r\n                    disabled={loading}\r\n                  >\r\n                    {loading ? (\r\n                      <>\r\n                        <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                        Loading...\r\n                      </>\r\n                    ) : (\r\n                      'Load More'\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </ScrollArea>\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}\r\n","'use client'\n\nimport { useEffect, useMemo, useRef, useState, useCallback } from 'react'\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle\n} from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle\n} from '@/components/ui/dialog'\nimport { Input } from '@/components/ui/input'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Label } from '@/components/ui/label'\nimport { Separator } from '@/components/ui/separator'\nimport { format } from 'date-fns'\nimport { Loader2, Plus, Copy, Rocket, Archive, Pencil, Upload, FileCheck, Users, Building2, Briefcase, Eye, Download, X, SendHorizontal } from 'lucide-react'\nimport FeePlanEditModal from '@/components/fees/FeePlanEditModal'\nimport { DocumentViewerFullscreen } from '@/components/documents/DocumentViewerFullscreen'\nimport type { DocumentReference } from '@/types/document-viewer.types'\nimport { usePersona } from '@/contexts/persona-context'\nimport { toast } from 'sonner'\n\ntype TermSheet = Record<string, any>\n\n/** Fee plan with entity and term sheet info for display */\ninterface LinkedFeePlan {\n  id: string\n  name: string\n  status: 'draft' | 'sent' | 'pending_signature' | 'accepted' | 'rejected'\n  term_sheet_id: string | null\n  accepted_at: string | null\n  accepted_by: string | null\n  introducer?: { id: string; name: string; company_name?: string } | null\n  partner?: { id: string; name: string; company_name?: string } | null\n  commercial_partner?: { id: string; name: string; company_name?: string } | null\n}\n\ninterface DealTermSheetTabProps {\n  dealId: string\n  termSheets: TermSheet[]\n}\n\ntype EditorMode = 'create' | 'edit' | 'clone'\n\nconst statusClasses: Record<string, string> = {\n  draft: 'bg-amber-500/20 text-amber-100',\n  published: 'bg-emerald-500/20 text-emerald-100',\n  archived: 'bg-muted text-muted-foreground'\n}\n\n/** Fee plan status styling */\nconst feePlanStatusClasses: Record<string, string> = {\n  draft: 'bg-muted text-muted-foreground border-border',\n  sent: 'bg-blue-500/20 text-blue-300 border-blue-500/30',\n  pending_signature: 'bg-amber-500/20 text-amber-300 border-amber-500/30',\n  accepted: 'bg-emerald-500/20 text-emerald-300 border-emerald-500/30',\n  rejected: 'bg-red-500/20 text-red-300 border-red-500/30'\n}\n\nconst feePlanStatusLabels: Record<string, string> = {\n  draft: 'Draft',\n  sent: 'Sent',\n  pending_signature: 'Pending',\n  accepted: 'Accepted',\n  rejected: 'Rejected'\n}\n\nconst emptyForm = {\n  term_sheet_date: '',\n  transaction_type: '',\n  opportunity_summary: '',\n  issuer: '',\n  vehicle: '',\n  exclusive_arranger: '',\n  purchaser: '',\n  seller: '',\n  structure: '',\n  allocation_up_to: '',\n  price_per_share_text: '',\n  price_per_share: '',\n  cost_per_share: '',\n  minimum_ticket: '',\n  subscription_fee_percent: '',\n  management_fee_percent: '',\n  management_fee_clause: '',\n  carried_interest_percent: '',\n  performance_fee_clause: '',\n  legal_counsel: '',\n  interest_confirmation_deadline: '',\n  validity_date: '',\n  completion_date: '',\n  completion_date_text: ''\n}\n\ntype FormState = typeof emptyForm\n\nfunction mapTermSheetToForm(termSheet?: TermSheet): FormState {\n  if (!termSheet) return emptyForm\n  return {\n    term_sheet_date: termSheet.term_sheet_date ? termSheet.term_sheet_date.slice(0, 10) : '',\n    transaction_type: termSheet.transaction_type ?? '',\n    opportunity_summary: termSheet.opportunity_summary ?? '',\n    issuer: termSheet.issuer ?? '',\n    vehicle: termSheet.vehicle ?? '',\n    exclusive_arranger: termSheet.exclusive_arranger ?? '',\n    purchaser: termSheet.purchaser ?? '',\n    seller: termSheet.seller ?? '',\n    structure: termSheet.structure ?? '',\n    allocation_up_to: termSheet.allocation_up_to ?? '',\n    price_per_share_text: termSheet.price_per_share_text ?? '',\n    price_per_share: termSheet.price_per_share != null ? String(termSheet.price_per_share) : '',\n    cost_per_share: termSheet.cost_per_share != null ? String(termSheet.cost_per_share) : '',\n    minimum_ticket: termSheet.minimum_ticket ?? '',\n    subscription_fee_percent: termSheet.subscription_fee_percent ?? '',\n    management_fee_percent: termSheet.management_fee_percent ?? '',\n    management_fee_clause: termSheet.management_fee_clause ?? '',\n    carried_interest_percent: termSheet.carried_interest_percent ?? '',\n    performance_fee_clause: termSheet.performance_fee_clause ?? '',\n    legal_counsel: termSheet.legal_counsel ?? '',\n    interest_confirmation_deadline: termSheet.interest_confirmation_deadline\n      ? termSheet.interest_confirmation_deadline.slice(0, 16)\n      : '',\n    validity_date: termSheet.validity_date ? termSheet.validity_date.slice(0, 16) : '',\n    completion_date: termSheet.completion_date ? termSheet.completion_date.slice(0, 10) : '',\n    completion_date_text: termSheet.completion_date_text ?? ''\n  }\n}\n\nfunction toNumber(value: string) {\n  if (!value) return null\n  const parsed = Number(value)\n  return Number.isFinite(parsed) ? parsed : null\n}\n\nfunction buildPayload(values: FormState) {\n  return {\n    term_sheet_date: values.term_sheet_date || null,\n    transaction_type: values.transaction_type || null,\n    opportunity_summary: values.opportunity_summary || null,\n    issuer: values.issuer || null,\n    vehicle: values.vehicle || null,\n    exclusive_arranger: values.exclusive_arranger || null,\n    purchaser: values.purchaser || null,\n    seller: values.seller || null,\n    structure: values.structure || null,\n    allocation_up_to: toNumber(values.allocation_up_to),\n    price_per_share_text: values.price_per_share_text || null,\n    price_per_share: toNumber(values.price_per_share),\n    cost_per_share: toNumber(values.cost_per_share),\n    minimum_ticket: toNumber(values.minimum_ticket),\n    subscription_fee_percent: toNumber(values.subscription_fee_percent),\n    management_fee_percent: toNumber(values.management_fee_percent),\n    management_fee_clause: values.management_fee_clause || null,\n    carried_interest_percent: toNumber(values.carried_interest_percent),\n    performance_fee_clause: values.performance_fee_clause || null,\n    legal_counsel: values.legal_counsel || null,\n    interest_confirmation_deadline: values.interest_confirmation_deadline || null,\n    validity_date: values.validity_date || null,\n    completion_date: values.completion_date || null,\n    completion_date_text: values.completion_date_text || null\n  }\n}\n\nexport function DealTermSheetTab({ dealId, termSheets }: DealTermSheetTabProps) {\n  const [items, setItems] = useState<TermSheet[]>(termSheets ?? [])\n  const [editorOpen, setEditorOpen] = useState(false)\n  const [editorMode, setEditorMode] = useState<EditorMode>('create')\n  const [targetId, setTargetId] = useState<string | null>(null)\n  const [formValues, setFormValues] = useState<FormState>(emptyForm)\n  const [isSubmitting, setIsSubmitting] = useState(false)\n  const [errorMessage, setErrorMessage] = useState<string | null>(null)\n  const [attachmentError, setAttachmentError] = useState<string | null>(null)\n  const [uploadingAttachmentId, setUploadingAttachmentId] = useState<string | null>(null)\n  const fileInputsRef = useRef<Record<string, HTMLInputElement | null>>({})\n\n  // Fee plan state\n  const [feePlans, setFeePlans] = useState<LinkedFeePlan[]>([])\n  const [feePlansLoading, setFeePlansLoading] = useState(false)\n  const [feePlanModalOpen, setFeePlanModalOpen] = useState(false)\n  const [selectedTermSheetIdForFeePlan, setSelectedTermSheetIdForFeePlan] = useState<string | undefined>()\n\n  // Document preview state (fullscreen viewer)\n  const [previewOpen, setPreviewOpen] = useState(false)\n  const [previewLoading, setPreviewLoading] = useState(false)\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null)\n  const [previewTermSheetId, setPreviewTermSheetId] = useState<string | null>(null)\n  const [previewError, setPreviewError] = useState<string | null>(null)\n  const [previewDocument, setPreviewDocument] = useState<DocumentReference | null>(null)\n\n  // PDF generation state\n  const [generatingId, setGeneratingId] = useState<string | null>(null)\n  const [requestingCloseId, setRequestingCloseId] = useState<string | null>(null)\n\n  // Persona for CEO/staff visibility of cost fields\n  const { isCEO, isStaff } = usePersona()\n  const canViewCost = isCEO || isStaff\n\n  useEffect(() => {\n    setItems(termSheets ?? [])\n  }, [termSheets])\n\n  // Fetch fee plans for this deal\n  const fetchFeePlans = useCallback(async () => {\n    setFeePlansLoading(true)\n    try {\n      const response = await fetch(`/api/deals/${dealId}/fee-plans`)\n      if (!response.ok) {\n        console.error('Failed to fetch fee plans')\n        return\n      }\n      const data = await response.json()\n      setFeePlans(data.feePlans || [])\n    } catch (error) {\n      console.error('Error fetching fee plans:', error)\n    } finally {\n      setFeePlansLoading(false)\n    }\n  }, [dealId])\n\n  useEffect(() => {\n    fetchFeePlans()\n  }, [fetchFeePlans])\n\n  // Group fee plans by term sheet ID\n  const feePlansByTermSheet = useMemo(() => {\n    const grouped: Record<string, LinkedFeePlan[]> = {}\n    for (const fp of feePlans) {\n      const tsId = fp.term_sheet_id || 'unlinked'\n      if (!grouped[tsId]) {\n        grouped[tsId] = []\n      }\n      grouped[tsId].push(fp)\n    }\n    return grouped\n  }, [feePlans])\n\n  // Get entity display info from a fee plan\n  const getEntityInfo = (fp: LinkedFeePlan) => {\n    if (fp.introducer) {\n      return {\n        type: 'Introducer',\n        name: fp.introducer.company_name || fp.introducer.name,\n        icon: Users\n      }\n    }\n    if (fp.partner) {\n      return {\n        type: 'Partner',\n        name: fp.partner.company_name || fp.partner.name,\n        icon: Building2\n      }\n    }\n    if (fp.commercial_partner) {\n      return {\n        type: 'Commercial Partner',\n        name: fp.commercial_partner.company_name || fp.commercial_partner.name,\n        icon: Briefcase\n      }\n    }\n    return null\n  }\n\n  // Handle opening the fee plan modal with a pre-selected term sheet\n  const openFeePlanModal = (termSheetId: string) => {\n    setSelectedTermSheetIdForFeePlan(termSheetId)\n    setFeePlanModalOpen(true)\n  }\n\n  const closeFeePlanModal = () => {\n    setFeePlanModalOpen(false)\n    setSelectedTermSheetIdForFeePlan(undefined)\n  }\n\n  const handleFeePlanSuccess = () => {\n    closeFeePlanModal()\n    fetchFeePlans()\n  }\n\n  // Document preview handlers (fullscreen viewer)\n  const openPreview = async (termSheetId: string) => {\n    // Find the term sheet to get filename info\n    const termSheet = items.find(ts => ts.id === termSheetId)\n    const fileName = termSheet?.term_sheet_attachment_key?.split('/').pop() || 'Term Sheet.pdf'\n\n    setPreviewTermSheetId(termSheetId)\n    setPreviewDocument({\n      id: termSheetId,\n      file_name: fileName,\n      name: fileName,\n      mime_type: 'application/pdf',\n      type: 'term_sheet'\n    })\n    setPreviewOpen(true)\n    setPreviewLoading(true)\n    setPreviewError(null)\n    setPreviewUrl(null)\n\n    try {\n      const response = await fetch(`/api/deals/${dealId}/fee-structures/${termSheetId}/attachment`)\n      if (!response.ok) {\n        const data = await response.json()\n        throw new Error(data.error || 'Failed to load document')\n      }\n      const data = await response.json()\n      setPreviewUrl(data.url)\n    } catch (error) {\n      setPreviewError(error instanceof Error ? error.message : 'Failed to load document')\n    } finally {\n      setPreviewLoading(false)\n    }\n  }\n\n  const closePreview = () => {\n    setPreviewOpen(false)\n    setPreviewUrl(null)\n    setPreviewTermSheetId(null)\n    setPreviewError(null)\n    setPreviewDocument(null)\n  }\n\n  const handleDownload = () => {\n    if (previewUrl) {\n      window.open(previewUrl, '_blank')\n    }\n  }\n\n  // Generate PDF handler - triggers n8n workflow\n  const handleGenerateTermsheet = async (structureId: string) => {\n    setGeneratingId(structureId)\n    setErrorMessage(null)\n    try {\n      const response = await fetch(\n        `/api/deals/${dealId}/fee-structures/${structureId}/generate`,\n        { method: 'POST' }\n      )\n      const data = await response.json()\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to generate term sheet')\n      }\n      // Refresh to show updated attachment (user can preview manually)\n      await refresh()\n    } catch (error) {\n      setErrorMessage(error instanceof Error ? error.message : 'Failed to generate term sheet')\n    } finally {\n      setGeneratingId(null)\n    }\n  }\n\n  // Request close approval handler - triggers CEO approval creation\n  const handleRequestClose = async (structureId: string) => {\n    setRequestingCloseId(structureId)\n    setErrorMessage(null)\n    try {\n      const response = await fetch(\n        `/api/deals/${dealId}/fee-structures/${structureId}/request-close`,\n        { method: 'POST' }\n      )\n      const data = await response.json()\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to request close approval')\n      }\n      // Show success message\n      toast.success('Close approval created', {\n        description: 'The CEO will review this request in the Approvals queue.'\n      })\n      await refresh()\n    } catch (error) {\n      const message = error instanceof Error ? error.message : 'Failed to request close approval'\n      setErrorMessage(message)\n      toast.error('Request failed', { description: message })\n    } finally {\n      setRequestingCloseId(null)\n    }\n  }\n\n  const ordered = useMemo(\n    () => [...items].sort((a, b) => (b.version ?? 0) - (a.version ?? 0)),\n    [items]\n  )\n\n  // Get ALL published term sheets (multiple allowed for different investor classes)\n  const publishedTermSheets = useMemo(\n    () => ordered.filter(item => item.status === 'published'),\n    [ordered]\n  )\n\n  // For backwards compat - first published\n  const published = publishedTermSheets[0]\n\n  const handleAttachmentUpload = async (structureId: string, file: File) => {\n    setAttachmentError(null)\n    setUploadingAttachmentId(structureId)\n    try {\n      const formData = new FormData()\n      formData.append('file', file)\n\n      const response = await fetch(\n        `/api/deals/${dealId}/fee-structures/${structureId}/attachment`,\n        {\n          method: 'POST',\n          body: formData\n        }\n      )\n\n      const payload = await response.json().catch(() => ({}))\n      if (!response.ok) {\n        throw new Error(payload?.error || 'Failed to upload attachment')\n      }\n\n      const nextItems = items.map(item =>\n        item.id === structureId\n          ? { ...item, term_sheet_attachment_key: payload.term_sheet_attachment_key }\n          : item\n      )\n      setItems(nextItems)\n\n      if (targetId === structureId) {\n        setFormValues(prev => ({\n          ...prev,\n          term_sheet_attachment_key: payload.term_sheet_attachment_key ?? ''\n        }))\n      }\n    } catch (error) {\n      console.error('Term sheet attachment upload failed', error)\n      setAttachmentError(\n        error instanceof Error ? error.message : 'Failed to upload attachment'\n      )\n    } finally {\n      const input = fileInputsRef.current[structureId]\n      if (input) {\n        input.value = ''\n      }\n      setUploadingAttachmentId(null)\n    }\n  }\n\n  const openEditor = (mode: EditorMode, termSheet?: TermSheet) => {\n    setEditorMode(mode)\n    setTargetId(mode === 'edit' ? termSheet?.id ?? null : null)\n    setFormValues(mapTermSheetToForm(mode === 'create' ? undefined : termSheet))\n    setErrorMessage(null)\n    setEditorOpen(true)\n  }\n\n  const closeEditor = () => {\n    setEditorOpen(false)\n    setTargetId(null)\n    setFormValues(emptyForm)\n  }\n\n  const refresh = async () => {\n    const response = await fetch(`/api/deals/${dealId}/fee-structures`)\n    if (!response.ok) {\n      setErrorMessage('Failed to refresh term sheets. Please reload the page.')\n      return\n    }\n    const data = await response.json()\n    setItems(data.term_sheets ?? [])\n  }\n\n  const submitForm = async () => {\n    setIsSubmitting(true)\n    setErrorMessage(null)\n    try {\n      const payload = buildPayload(formValues)\n      let response: Response\n      if (editorMode === 'create' || editorMode === 'clone') {\n        response = await fetch(`/api/deals/${dealId}/fee-structures`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(payload)\n        })\n      } else {\n        if (!targetId) throw new Error('Missing term sheet ID')\n        response = await fetch(`/api/deals/${dealId}/fee-structures`, {\n          method: 'PATCH',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            structure_id: targetId,\n            updates: payload\n          })\n        })\n      }\n\n      if (!response.ok) {\n        const text = await response.text()\n        throw new Error(text || 'Failed to save term sheet')\n      }\n\n      await refresh()\n      closeEditor()\n    } catch (error) {\n      setErrorMessage(error instanceof Error ? error.message : 'Unexpected error saving term sheet')\n    } finally {\n      setIsSubmitting(false)\n    }\n  }\n\n  const updateStatus = async (termSheet: TermSheet, status: 'draft' | 'published' | 'archived') => {\n    setIsSubmitting(true)\n    setErrorMessage(null)\n    try {\n      const response = await fetch(`/api/deals/${dealId}/fee-structures`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          structure_id: termSheet.id,\n          updates: { status }\n        })\n      })\n      if (!response.ok) {\n        const text = await response.text()\n        throw new Error(text || 'Failed to update status')\n      }\n      await refresh()\n    } catch (error) {\n      setErrorMessage(error instanceof Error ? error.message : 'Unexpected error updating status')\n    } finally {\n      setIsSubmitting(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-foreground\">Term Sheet Versions</h3>\n          <p className=\"text-sm text-muted-foreground\">\n            Draft, publish, and archive the structured economics that power the investor experience.\n          </p>\n        </div>\n      <Button\n        onClick={() => openEditor('create')}\n        disabled={isSubmitting}\n        className=\"gap-2\"\n      >\n        <Plus className=\"h-4 w-4\" />\n        New Term Sheet\n      </Button>\n    </div>\n\n    {errorMessage && (\n      <Card className=\"border border-destructive/30 bg-destructive/10\">\n        <CardContent className=\"text-sm text-destructive p-3\">\n          {errorMessage}\n        </CardContent>\n      </Card>\n    )}\n    {attachmentError && (\n      <Card className=\"border border-amber-400/30 bg-amber-500/10\">\n        <CardContent className=\"text-sm text-amber-800 p-3\">\n          {attachmentError}\n        </CardContent>\n      </Card>\n    )}\n\n      {/* Published Term Sheets Section */}\n      {publishedTermSheets.length > 0 && (\n        <div className=\"space-y-4\">\n          <h3 className=\"text-sm font-semibold text-emerald-400 uppercase tracking-wide\">\n            Published Term Sheets ({publishedTermSheets.length})\n          </h3>\n          <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-4\">\n            {publishedTermSheets.map((published) => (\n              <Card key={published.id} className=\"border border-emerald-400/30 bg-emerald-500/10\">\n                <CardHeader className=\"flex flex-row items-start justify-between space-y-0\">\n                  <div>\n                    <CardTitle className=\"text-foreground\">Version {published.version}</CardTitle>\n                    <CardDescription>\n                      Published{' '}\n                      {published.published_at ? format(new Date(published.published_at), 'dd MMM yyyy') : '—'}\n                      {published.term_sheet_date && <span className=\"ml-2\">• Dated: {format(new Date(published.term_sheet_date), 'dd MMM yyyy')}</span>}\n                      {published.vehicle && <span className=\"ml-2\">• {published.vehicle}</span>}\n                    </CardDescription>\n                  </div>\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"gap-2\"\n                onClick={() => openEditor('edit', published)}\n                disabled={isSubmitting}\n              >\n                <Pencil className=\"h-4 w-4\" />\n                Edit\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"gap-2\"\n                onClick={() => openEditor('clone', published)}\n                disabled={isSubmitting}\n              >\n                <Copy className=\"h-4 w-4\" />\n                Clone\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"gap-2\"\n                onClick={() => fileInputsRef.current[published.id]?.click()}\n                disabled={uploadingAttachmentId === published.id}\n              >\n                {uploadingAttachmentId === published.id ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    Uploading...\n                  </>\n                ) : (\n                  <>\n                    <Upload className=\"h-4 w-4\" />\n                    Upload Attachment\n                  </>\n                )}\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"gap-2 border-blue-500/30 hover:bg-blue-500/10\"\n                onClick={() => handleGenerateTermsheet(published.id)}\n                disabled={generatingId === published.id}\n              >\n                {generatingId === published.id ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    Generating...\n                  </>\n                ) : (\n                  <>\n                    <FileCheck className=\"h-4 w-4\" />\n                    Generate PDF\n                  </>\n                )}\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"gap-2 border-amber-500/30 hover:bg-amber-500/10\"\n                onClick={() => handleRequestClose(published.id)}\n                disabled={requestingCloseId === published.id || !!published.closed_processed_at}\n                title={published.closed_processed_at ? 'Already processed' : 'Request CEO approval to close this termsheet'}\n              >\n                {requestingCloseId === published.id ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    Requesting...\n                  </>\n                ) : (\n                  <>\n                    <SendHorizontal className=\"h-4 w-4\" />\n                    Request Close\n                  </>\n                )}\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"text-xs text-emerald-200\">\n                {published.term_sheet_attachment_key\n                  ? 'Attachment available for investors to download.'\n                  : 'No attachment uploaded yet.'}\n              </div>\n              {published.term_sheet_attachment_key && (\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"gap-2 border-emerald-500/30 hover:bg-emerald-500/10\"\n                  onClick={() => openPreview(published.id)}\n                >\n                  <Eye className=\"h-4 w-4\" />\n                  Preview\n                </Button>\n              )}\n            </div>\n\n            {/* Transaction Details */}\n            <div>\n              <h4 className=\"text-xs font-semibold text-emerald-300 uppercase tracking-wide mb-3\">Transaction Details</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Transaction Type</span>\n                  <span className=\"text-foreground font-medium\">{published.transaction_type || '—'}</span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Structure</span>\n                  <span className=\"text-foreground font-medium\">{published.structure || '—'}</span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Issuer</span>\n                  <span className=\"text-foreground font-medium\">{published.issuer || '—'}</span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Vehicle</span>\n                  <span className=\"text-foreground font-medium\">{published.vehicle || '—'}</span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Exclusive Arranger</span>\n                  <span className=\"text-foreground font-medium\">{published.exclusive_arranger || '—'}</span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Purchaser</span>\n                  <span className=\"text-foreground font-medium\">{published.purchaser || '—'}</span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Seller</span>\n                  <span className=\"text-foreground font-medium\">{published.seller || '—'}</span>\n                </div>\n              </div>\n            </div>\n\n            <Separator className=\"bg-emerald-400/20\" />\n\n            {/* Investment Terms */}\n            <div>\n              <h4 className=\"text-xs font-semibold text-emerald-300 uppercase tracking-wide mb-3\">Investment Terms</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Allocation Up To</span>\n                  <span className=\"text-foreground font-medium\">\n                    {published.allocation_up_to ? published.allocation_up_to.toLocaleString() : '—'}\n                  </span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Price Per Share</span>\n                  <span className=\"text-foreground font-medium\">{published.price_per_share_text || '—'}</span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Minimum Ticket</span>\n                  <span className=\"text-foreground font-medium\">\n                    {published.minimum_ticket ? published.minimum_ticket.toLocaleString() : '—'}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <Separator className=\"bg-emerald-400/20\" />\n\n            {/* Fee Structure */}\n            <div>\n              <h4 className=\"text-xs font-semibold text-emerald-300 uppercase tracking-wide mb-3\">Fee Structure</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Subscription Fee</span>\n                  <span className=\"text-foreground font-medium\">\n                    {published.subscription_fee_percent != null\n                      ? `${published.subscription_fee_percent}%`\n                      : '—'}\n                  </span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Management Fee</span>\n                  <span className=\"text-foreground font-medium\">\n                    {published.management_fee_percent != null\n                      ? `${published.management_fee_percent}% p.a.`\n                      : '—'}\n                  </span>\n                  {published.management_fee_clause && (\n                    <span className=\"text-muted-foreground block text-xs mt-1 italic\">{published.management_fee_clause}</span>\n                  )}\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Carried Interest</span>\n                  <span className=\"text-foreground font-medium\">\n                    {published.carried_interest_percent != null\n                      ? `${published.carried_interest_percent}%`\n                      : '—'}\n                  </span>\n                  {published.performance_fee_clause && (\n                    <span className=\"text-muted-foreground block text-xs mt-1 italic\">{published.performance_fee_clause}</span>\n                  )}\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Legal Counsel</span>\n                  <span className=\"text-foreground font-medium\">{published.legal_counsel || '—'}</span>\n                </div>\n              </div>\n            </div>\n\n            <Separator className=\"bg-emerald-400/20\" />\n\n            {/* Timeline */}\n            <div>\n              <h4 className=\"text-xs font-semibold text-emerald-300 uppercase tracking-wide mb-3\">Timeline & Deadlines</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Interest Deadline</span>\n                  <span className=\"text-foreground font-medium\">\n                    {published.interest_confirmation_deadline\n                      ? format(new Date(published.interest_confirmation_deadline), 'dd MMM yyyy HH:mm')\n                      : '—'}\n                  </span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Completion Date</span>\n                  <span className=\"text-foreground font-medium\">\n                    {published.completion_date\n                      ? format(new Date(published.completion_date), 'dd MMM yyyy')\n                      : published.completion_date_text || '—'}\n                  </span>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground block text-xs\">Validity Date</span>\n                  <span className=\"text-foreground font-medium\">\n                    {published.validity_date ? format(new Date(published.validity_date), 'dd MMM yyyy HH:mm') : '—'}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {published.term_sheet_html && (\n              <>\n                <Separator className=\"bg-emerald-400/20\" />\n                <div>\n                  <h4 className=\"text-xs font-semibold text-emerald-300 uppercase tracking-wide mb-3\">Opportunity Summary</h4>\n                  <div\n                    className=\"space-y-2 text-sm text-emerald-50/90 leading-relaxed\"\n                    dangerouslySetInnerHTML={{ __html: published.term_sheet_html }}\n                  />\n                </div>\n              </>\n            )}\n\n            <Separator className=\"bg-emerald-400/20\" />\n\n            {/* Linked Fee Plans Section */}\n            <div>\n              <div className=\"flex items-center justify-between mb-3\">\n                <h4 className=\"text-xs font-semibold text-emerald-300 uppercase tracking-wide flex items-center gap-2\">\n                  <FileCheck className=\"h-4 w-4\" />\n                  Linked Fee Plans\n                </h4>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"gap-1 text-xs h-7 border-emerald-500/30 hover:bg-emerald-500/10\"\n                  onClick={() => openFeePlanModal(published.id)}\n                >\n                  <Plus className=\"h-3 w-3\" />\n                  Create Fee Plan\n                </Button>\n              </div>\n\n              {feePlansLoading ? (\n                <div className=\"flex items-center gap-2 text-emerald-200/60 text-sm py-2\">\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  Loading fee plans...\n                </div>\n              ) : (feePlansByTermSheet[published.id] || []).length === 0 ? (\n                <div className=\"text-sm text-emerald-200/60 py-2\">\n                  No fee plans linked to this term sheet yet. Create one to define commission terms for introducers or partners.\n                </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  {(feePlansByTermSheet[published.id] || []).map(fp => {\n                    const entity = getEntityInfo(fp)\n                    return (\n                      <div\n                        key={fp.id}\n                        className=\"flex items-center justify-between p-2 rounded-md bg-muted/50 border border-emerald-500/10\"\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          {entity && (\n                            <div className=\"flex items-center gap-1 text-xs text-emerald-300/80\">\n                              <entity.icon className=\"h-3.5 w-3.5\" />\n                              <span>{entity.type}:</span>\n                              <span className=\"font-medium text-emerald-100\">{entity.name}</span>\n                            </div>\n                          )}\n                          <span className=\"text-sm text-emerald-100 font-medium\">{fp.name}</span>\n                        </div>\n                        <Badge className={`text-xs ${feePlanStatusClasses[fp.status] || feePlanStatusClasses.draft}`}>\n                          {feePlanStatusLabels[fp.status] || fp.status}\n                        </Badge>\n                      </div>\n                    )\n                  })}\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Draft & Archived Versions */}\n      <div className=\"space-y-4\">\n        <h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide\">\n          Other Versions ({ordered.filter(t => t.status !== 'published').length})\n        </h3>\n        <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-4\">\n          {ordered.filter(termSheet => termSheet.status !== 'published').map(termSheet => (\n          <Card key={termSheet.id} className=\"border-border bg-muted/50\">\n            <CardHeader className=\"flex items-start justify-between space-y-0\">\n              <div>\n                <CardTitle className=\"text-foreground text-lg\">\n                  Version {termSheet.version}\n                </CardTitle>\n                <CardDescription>\n                  Created {format(new Date(termSheet.created_at), 'dd MMM yyyy')}\n                  {termSheet.term_sheet_date && ` • Term Sheet Date: ${format(new Date(termSheet.term_sheet_date), 'dd MMM yyyy')}`}\n                </CardDescription>\n              </div>\n              <Badge className={statusClasses[termSheet.status] ?? statusClasses.draft}>\n                {termSheet.status.toUpperCase()}\n              </Badge>\n            </CardHeader>\n            <CardContent className=\"space-y-4 text-sm\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"text-xs text-muted-foreground\">\n                  {termSheet.term_sheet_attachment_key\n                    ? 'Attachment uploaded.'\n                    : 'No attachment uploaded yet.'}\n                </div>\n                {termSheet.term_sheet_attachment_key && (\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    className=\"gap-1 h-7 text-xs\"\n                    onClick={() => openPreview(termSheet.id)}\n                  >\n                    <Eye className=\"h-3 w-3\" />\n                    Preview\n                  </Button>\n                )}\n              </div>\n              {/* Transaction Details */}\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wide\">Transaction Details</h4>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Transaction Type</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.transaction_type || '—'}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Structure</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.structure || '—'}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Issuer</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.issuer || '—'}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Vehicle</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.vehicle || '—'}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Arranger</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.exclusive_arranger || '—'}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Purchaser</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.purchaser || '—'}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Seller</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.seller || '—'}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Legal Counsel</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.legal_counsel || '—'}</span>\n                  </div>\n                </div>\n              </div>\n\n              <Separator />\n\n              {/* Investment Terms */}\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wide\">Investment Terms</h4>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Allocation</span>\n                    <span className=\"text-foreground font-medium\">\n                      {termSheet.allocation_up_to ? termSheet.allocation_up_to.toLocaleString() : '—'}\n                    </span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Price Per Share</span>\n                    <span className=\"text-foreground font-medium\">{termSheet.price_per_share_text || '—'}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Min Ticket</span>\n                    <span className=\"text-foreground font-medium\">\n                      {termSheet.minimum_ticket ? termSheet.minimum_ticket.toLocaleString() : '—'}\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              <Separator />\n\n              {/* Fee Structure */}\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wide\">Fee Structure</h4>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Subscription Fee</span>\n                    <span className=\"text-foreground font-medium\">\n                      {termSheet.subscription_fee_percent != null\n                        ? `${termSheet.subscription_fee_percent}%`\n                        : '—'}\n                    </span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Management Fee</span>\n                    <span className=\"text-foreground font-medium\">\n                      {termSheet.management_fee_percent != null\n                        ? `${termSheet.management_fee_percent}% p.a.`\n                        : '—'}\n                    </span>\n                    {termSheet.management_fee_clause && (\n                      <span className=\"text-muted-foreground block text-xs italic mt-1\">{termSheet.management_fee_clause}</span>\n                    )}\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Carried Interest</span>\n                    <span className=\"text-foreground font-medium\">\n                      {termSheet.carried_interest_percent != null\n                        ? `${termSheet.carried_interest_percent}%`\n                        : '—'}\n                    </span>\n                    {termSheet.performance_fee_clause && (\n                      <span className=\"text-muted-foreground block text-xs italic mt-1\">{termSheet.performance_fee_clause}</span>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              <Separator />\n\n              {/* Timeline */}\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wide\">Timeline</h4>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Interest Deadline</span>\n                    <span className=\"text-foreground font-medium\">\n                      {termSheet.interest_confirmation_deadline\n                        ? format(new Date(termSheet.interest_confirmation_deadline), 'dd MMM yyyy HH:mm')\n                        : '—'}\n                    </span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Validity</span>\n                    <span className=\"text-foreground font-medium\">\n                      {termSheet.validity_date ? format(new Date(termSheet.validity_date), 'dd MMM yyyy HH:mm') : '—'}\n                    </span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground block text-xs\">Completion Date</span>\n                    <span className=\"text-foreground font-medium\">\n                      {termSheet.completion_date\n                        ? format(new Date(termSheet.completion_date), 'dd MMM yyyy')\n                        : termSheet.completion_date_text || '—'}\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              {termSheet.term_sheet_html && (\n                <>\n                  <div className=\"space-y-2 text-sm\">\n                    <h4 className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wide\">\n                      Opportunity Summary\n                    </h4>\n                  <div\n                    className=\"space-y-2 text-sm text-foreground/90 leading-relaxed\"\n                    dangerouslySetInnerHTML={{ __html: termSheet.term_sheet_html }}\n                  />\n                  </div>\n                  <Separator />\n                </>\n              )}\n              <div className=\"flex flex-wrap items-center gap-2\">\n                <input\n                  type=\"file\"\n                  accept=\".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n                  className=\"hidden\"\n                  ref={element => {\n                    fileInputsRef.current[termSheet.id] = element\n                  }}\n                  onChange={event => {\n                    const file = event.target.files?.[0]\n                    if (file) {\n                      handleAttachmentUpload(termSheet.id, file)\n                    }\n                  }}\n                />\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"gap-2\"\n                  onClick={() => openEditor('clone', termSheet)}\n                  disabled={isSubmitting}\n                >\n                  <Copy className=\"h-4 w-4\" />\n                  Clone\n                </Button>\n                {termSheet.status === 'draft' && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"gap-2\"\n                    onClick={() => openEditor('edit', termSheet)}\n                    disabled={isSubmitting}\n                  >\n                    <Pencil className=\"h-4 w-4\" />\n                    Edit\n                  </Button>\n                )}\n                {termSheet.status !== 'published' && (\n                  <Button\n                    size=\"sm\"\n                    className=\"gap-2\"\n                    onClick={() => updateStatus(termSheet, 'published')}\n                    disabled={isSubmitting}\n                  >\n                    <Rocket className=\"h-4 w-4\" />\n                    Publish\n                  </Button>\n                )}\n                {termSheet.status !== 'archived' && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"gap-2 text-rose-300\"\n                    onClick={() => updateStatus(termSheet, 'archived')}\n                    disabled={isSubmitting}\n                  >\n                    <Archive className=\"h-4 w-4\" />\n                    Archive\n                  </Button>\n                )}\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"gap-2\"\n                  onClick={() => fileInputsRef.current[termSheet.id]?.click()}\n                  disabled={uploadingAttachmentId === termSheet.id}\n                >\n                  {uploadingAttachmentId === termSheet.id ? (\n                    <>\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                      Uploading...\n                    </>\n                  ) : (\n                    <>\n                      <Upload className=\"h-4 w-4\" />\n                      Upload Attachment\n                    </>\n                  )}\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"gap-2\"\n                  onClick={() => handleGenerateTermsheet(termSheet.id)}\n                  disabled={generatingId === termSheet.id}\n                >\n                  {generatingId === termSheet.id ? (\n                    <>\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                      Generating...\n                    </>\n                  ) : (\n                    <>\n                      <FileCheck className=\"h-4 w-4\" />\n                      Generate PDF\n                    </>\n                  )}\n                </Button>\n              </div>\n\n              {/* Linked Fee Plans - Only show for published term sheets */}\n              {termSheet.status === 'published' && (\n                <>\n                  <Separator />\n                  <div>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <h4 className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wide flex items-center gap-1.5\">\n                        <FileCheck className=\"h-3.5 w-3.5\" />\n                        Linked Fee Plans\n                      </h4>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"gap-1 text-xs h-6 px-2\"\n                        onClick={() => openFeePlanModal(termSheet.id)}\n                      >\n                        <Plus className=\"h-3 w-3\" />\n                        Add\n                      </Button>\n                    </div>\n\n                    {feePlansLoading ? (\n                      <div className=\"flex items-center gap-2 text-muted-foreground text-xs py-1\">\n                        <Loader2 className=\"h-3 w-3 animate-spin\" />\n                        Loading...\n                      </div>\n                    ) : (feePlansByTermSheet[termSheet.id] || []).length === 0 ? (\n                      <div className=\"text-xs text-muted-foreground py-1\">\n                        No fee plans linked yet.\n                      </div>\n                    ) : (\n                      <div className=\"space-y-1.5\">\n                        {(feePlansByTermSheet[termSheet.id] || []).map(fp => {\n                          const entity = getEntityInfo(fp)\n                          return (\n                            <div\n                              key={fp.id}\n                              className=\"flex items-center justify-between py-1 px-2 rounded bg-muted/50 text-xs\"\n                            >\n                              <div className=\"flex items-center gap-2 min-w-0\">\n                                {entity && (\n                                  <span className=\"flex items-center gap-1 text-muted-foreground shrink-0\">\n                                    <entity.icon className=\"h-3 w-3\" />\n                                    {entity.name}\n                                  </span>\n                                )}\n                                <span className=\"text-foreground truncate\">{fp.name}</span>\n                              </div>\n                              <Badge className={`text-[10px] h-5 shrink-0 ${feePlanStatusClasses[fp.status] || feePlanStatusClasses.draft}`}>\n                                {feePlanStatusLabels[fp.status] || fp.status}\n                              </Badge>\n                            </div>\n                          )\n                        })}\n                      </div>\n                    )}\n                  </div>\n                </>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n        {ordered.length === 0 && (\n          <Card className=\"border border-dashed border-border bg-muted/50\">\n            <CardContent className=\"py-16 text-center space-y-3\">\n              <h4 className=\"text-lg font-semibold text-foreground\">No term sheets yet</h4>\n              <p className=\"text-sm text-muted-foreground\">\n                Create your first version to begin capturing structured economics and publishing investor-ready content.\n              </p>\n              <Button\n                variant=\"outline\"\n                className=\"gap-2\"\n                onClick={() => openEditor('create')}\n                disabled={isSubmitting}\n              >\n                <Plus className=\"h-4 w-4\" />\n                Create Term Sheet\n              </Button>\n            </CardContent>\n          </Card>\n        )}\n        </div>\n      </div>\n\n      <Dialog open={editorOpen} onOpenChange={open => !open && closeEditor()}>\n        <DialogContent className=\"sm:max-w-3xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editorMode === 'create' && 'Create Term Sheet'}\n              {editorMode === 'edit' && 'Edit Term Sheet'}\n              {editorMode === 'clone' && 'Clone Term Sheet'}\n            </DialogTitle>\n            <CardDescription>\n              Populate the structured fields that sync with investor-facing term sheets.\n            </CardDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-6 py-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"term_sheet_date\">Term Sheet Date</Label>\n                <Input\n                  id=\"term_sheet_date\"\n                  type=\"date\"\n                  value={formValues.term_sheet_date}\n                  onChange={event => setFormValues(prev => ({ ...prev, term_sheet_date: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"transaction_type\">Transaction Type</Label>\n                <Input\n                  id=\"transaction_type\"\n                  value={formValues.transaction_type}\n                  onChange={event => setFormValues(prev => ({ ...prev, transaction_type: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"structure\">Structure</Label>\n                <Input\n                  id=\"structure\"\n                  value={formValues.structure}\n                  onChange={event => setFormValues(prev => ({ ...prev, structure: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"allocation_up_to\">Allocation “Up to”</Label>\n                <Input\n                  id=\"allocation_up_to\"\n                  type=\"number\"\n                  value={formValues.allocation_up_to}\n                  onChange={event => setFormValues(prev => ({ ...prev, allocation_up_to: event.target.value }))}\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"opportunity_summary\">Opportunity Summary</Label>\n              <p className=\"text-xs text-muted-foreground\">\n                Supports basic Markdown for emphasis, lists, and headings. The rendered HTML is stored for the investor view.\n              </p>\n              <Textarea\n                id=\"opportunity_summary\"\n                rows={3}\n                value={formValues.opportunity_summary}\n                onChange={event => setFormValues(prev => ({ ...prev, opportunity_summary: event.target.value }))}\n              />\n            </div>\n\n            <Separator />\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"issuer\">Issuer</Label>\n                <Input\n                  id=\"issuer\"\n                  placeholder=\"e.g., VERSO Capital\"\n                  value={formValues.issuer}\n                  onChange={event => setFormValues(prev => ({ ...prev, issuer: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"vehicle\">Vehicle</Label>\n                <Input\n                  id=\"vehicle\"\n                  placeholder=\"e.g., VERSO SPV 2025-01\"\n                  value={formValues.vehicle}\n                  onChange={event => setFormValues(prev => ({ ...prev, vehicle: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"exclusive_arranger\">Exclusive Arranger</Label>\n                <Input\n                  id=\"exclusive_arranger\"\n                  placeholder=\"e.g., VERSO Management Limited\"\n                  value={formValues.exclusive_arranger}\n                  onChange={event => setFormValues(prev => ({ ...prev, exclusive_arranger: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"purchaser\">Purchaser</Label>\n                <Input\n                  id=\"purchaser\"\n                  placeholder=\"e.g., Qualified Limited Partners\"\n                  value={formValues.purchaser}\n                  onChange={event => setFormValues(prev => ({ ...prev, purchaser: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"seller\">Seller</Label>\n                <Input\n                  id=\"seller\"\n                  placeholder=\"e.g., GP of Transform Capital\"\n                  value={formValues.seller}\n                  onChange={event => setFormValues(prev => ({ ...prev, seller: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"legal_counsel\">Legal Counsel</Label>\n                <Input\n                  id=\"legal_counsel\"\n                  placeholder=\"e.g., Dupont & Partners Law Firm\"\n                  value={formValues.legal_counsel}\n                  onChange={event => setFormValues(prev => ({ ...prev, legal_counsel: event.target.value }))}\n                />\n              </div>\n            </div>\n\n            <Separator />\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"price_per_share_text\">Price per Share (Display Text)</Label>\n                <Input\n                  id=\"price_per_share_text\"\n                  placeholder=\"e.g., £10.00 per share\"\n                  value={formValues.price_per_share_text}\n                  onChange={event => setFormValues(prev => ({ ...prev, price_per_share_text: event.target.value }))}\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  Display text for investors (e.g., \"£10.00 per share\", \"~$15-20\")\n                </p>\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"price_per_share\">Price per Share (Numeric)</Label>\n                <Input\n                  id=\"price_per_share\"\n                  type=\"number\"\n                  step=\"0.01\"\n                  placeholder=\"e.g., 10.00\"\n                  value={formValues.price_per_share}\n                  onChange={event => setFormValues(prev => ({ ...prev, price_per_share: event.target.value }))}\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  Used for subscription calculations\n                </p>\n              </div>\n            </div>\n\n            {/* Cost & Spread - CEO/Staff only */}\n            {canViewCost && (\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 rounded-lg bg-amber-500/5 border border-amber-500/20\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"cost_per_share\" className=\"text-amber-200\">Cost per Share (Internal)</Label>\n                  <Input\n                    id=\"cost_per_share\"\n                    type=\"number\"\n                    step=\"0.01\"\n                    placeholder=\"e.g., 8.00\"\n                    value={formValues.cost_per_share}\n                    onChange={event => setFormValues(prev => ({ ...prev, cost_per_share: event.target.value }))}\n                    className=\"border-amber-500/30\"\n                  />\n                  <p className=\"text-xs text-amber-200/70\">\n                    VERSO's acquisition cost (not shown to investors)\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label className=\"text-amber-200\">Spread per Share</Label>\n                  <div className=\"h-10 px-3 rounded-md bg-background/50 border border-amber-500/30 flex items-center text-sm font-medium\">\n                    {(() => {\n                      const price = parseFloat(formValues.price_per_share) || 0\n                      const cost = parseFloat(formValues.cost_per_share) || 0\n                      if (price > 0 && cost > 0) {\n                        const spread = price - cost\n                        return `${spread.toFixed(2)}`\n                      }\n                      return '—'\n                    })()}\n                  </div>\n                  <p className=\"text-xs text-amber-200/70\">\n                    Calculated: price − cost\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label className=\"text-amber-200\">Margin %</Label>\n                  <div className=\"h-10 px-3 rounded-md bg-background/50 border border-amber-500/30 flex items-center text-sm font-medium\">\n                    {(() => {\n                      const price = parseFloat(formValues.price_per_share) || 0\n                      const cost = parseFloat(formValues.cost_per_share) || 0\n                      if (price > 0 && cost > 0) {\n                        const margin = ((price - cost) / cost) * 100\n                        return `${margin.toFixed(1)}%`\n                      }\n                      return '—'\n                    })()}\n                  </div>\n                  <p className=\"text-xs text-amber-200/70\">\n                    Margin on cost\n                  </p>\n                </div>\n              </div>\n            )}\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"minimum_ticket\">Minimum Ticket</Label>\n                <Input\n                  id=\"minimum_ticket\"\n                  type=\"number\"\n                  value={formValues.minimum_ticket}\n                  onChange={event => setFormValues(prev => ({ ...prev, minimum_ticket: event.target.value }))}\n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"subscription_fee_percent\">Subscription Fee %</Label>\n                <Input\n                  id=\"subscription_fee_percent\"\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={formValues.subscription_fee_percent}\n                  onChange={event => setFormValues(prev => ({ ...prev, subscription_fee_percent: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"management_fee_percent\">Management Fee %</Label>\n                <Input\n                  id=\"management_fee_percent\"\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={formValues.management_fee_percent}\n                  onChange={event => setFormValues(prev => ({ ...prev, management_fee_percent: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"carried_interest_percent\">Carried Interest %</Label>\n                <Input\n                  id=\"carried_interest_percent\"\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={formValues.carried_interest_percent}\n                  onChange={event => setFormValues(prev => ({ ...prev, carried_interest_percent: event.target.value }))}\n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"management_fee_clause\">Management Fee Clause</Label>\n                <p className=\"text-xs text-muted-foreground\">\n                  Optional descriptive text (e.g., \"Waived instead of 2.00% per annum\")\n                </p>\n                <Input\n                  id=\"management_fee_clause\"\n                  placeholder=\"e.g., Waived (instead of 2.00% per annum)\"\n                  value={formValues.management_fee_clause}\n                  onChange={event => setFormValues(prev => ({ ...prev, management_fee_clause: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"performance_fee_clause\">Performance Fee Clause</Label>\n                <p className=\"text-xs text-muted-foreground\">\n                  Optional descriptive text (e.g., \"Waived instead of 20% no hurdle\")\n                </p>\n                <Input\n                  id=\"performance_fee_clause\"\n                  placeholder=\"e.g., Waived (instead of 20.00% no hurdle rate)\"\n                  value={formValues.performance_fee_clause}\n                  onChange={event => setFormValues(prev => ({ ...prev, performance_fee_clause: event.target.value }))}\n                />\n              </div>\n            </div>\n\n            <Separator />\n\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"interest_confirmation_deadline\">Interest Confirmation Deadline</Label>\n                <Input\n                  id=\"interest_confirmation_deadline\"\n                  type=\"datetime-local\"\n                  value={formValues.interest_confirmation_deadline}\n                  onChange={event => setFormValues(prev => ({ ...prev, interest_confirmation_deadline: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"validity_date\">Validity Date</Label>\n                <Input\n                  id=\"validity_date\"\n                  type=\"datetime-local\"\n                  value={formValues.validity_date}\n                  onChange={event => setFormValues(prev => ({ ...prev, validity_date: event.target.value }))}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"completion_date\">Completion Date</Label>\n                <Input\n                  id=\"completion_date\"\n                  type=\"date\"\n                  value={formValues.completion_date}\n                  onChange={event => setFormValues(prev => ({ ...prev, completion_date: event.target.value }))}\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  When set, enables automatic CEO approval for deal closing.\n                </p>\n              </div>\n            </div>\n          </div>\n\n          <DialogFooter className=\"flex items-center justify-between\">\n            <Button\n              type=\"button\"\n              variant=\"ghost\"\n              onClick={closeEditor}\n              disabled={isSubmitting}\n            >\n              Cancel\n            </Button>\n            <Button onClick={submitForm} disabled={isSubmitting}>\n              {isSubmitting && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              Save Term Sheet\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Fee Plan Creation Modal */}\n      <FeePlanEditModal\n        open={feePlanModalOpen}\n        onClose={closeFeePlanModal}\n        onSuccess={handleFeePlanSuccess}\n        dealId={dealId}\n        initialTermSheetId={selectedTermSheetIdForFeePlan}\n      />\n\n      {/* Document Preview - Fullscreen Viewer */}\n      <DocumentViewerFullscreen\n        isOpen={previewOpen}\n        document={previewDocument}\n        previewUrl={previewUrl}\n        isLoading={previewLoading}\n        error={previewError}\n        onClose={closePreview}\n        onDownload={handleDownload}\n      />\n    </div>\n  )\n}\n","'use client'\n\nimport { useMemo } from 'react'\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle\n} from '@/components/ui/card'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow\n} from '@/components/ui/table'\nimport { Badge } from '@/components/ui/badge'\nimport Link from 'next/link'\nimport { format } from 'date-fns'\n\ninterface DealInterestTabProps {\n  dealId: string\n  interests: Array<Record<string, any>>\n  subscriptions: Array<Record<string, any>>\n}\n\nconst interestStatusStyles: Record<string, string> = {\n  pending_review: 'bg-amber-500/20 text-amber-100',\n  approved: 'bg-emerald-500/20 text-emerald-100',\n  rejected: 'bg-rose-500/20 text-rose-100',\n  withdrawn: 'bg-muted text-muted-foreground',\n  signal: 'bg-purple-500/20 text-purple-100'\n}\n\nconst subscriptionStatusStyles: Record<string, string> = {\n  pending_review: 'bg-amber-500/20 text-amber-100',\n  approved: 'bg-emerald-500/20 text-emerald-100',\n  rejected: 'bg-rose-500/20 text-rose-100',\n  cancelled: 'bg-muted text-muted-foreground'\n}\n\nexport function DealInterestTab({ dealId, interests, subscriptions }: DealInterestTabProps) {\n  const groupedInterests = useMemo(() => {\n    // Separate post-close signals from regular interests\n    const signals = interests?.filter(item => item.is_post_close) ?? []\n    const pending = interests?.filter(item => !item.is_post_close && item.status === 'pending_review') ?? []\n    const approved = interests?.filter(item => !item.is_post_close && item.status === 'approved') ?? []\n    const other = interests?.filter(item => !item.is_post_close && !['pending_review', 'approved'].includes(item.status)) ?? []\n    return { signals, pending, approved, other }\n  }, [interests])\n\n  return (\n    <div className=\"space-y-6\">\n      <Card className=\"border-border bg-muted/50\">\n        <CardHeader className=\"flex flex-row items-start justify-between\">\n          <div>\n            <CardTitle className=\"text-foreground\">Interest Pipeline</CardTitle>\n            <CardDescription>\n              Track investor signals and align approvals with NDA and data-room workflows.\n            </CardDescription>\n          </div>\n          <Link\n            href={`/versotech_main/approvals?entity=deal_interest&deal=${dealId}`}\n            className=\"text-sm font-medium text-sky-300 hover:text-sky-200\"\n          >\n            View related approvals ➜\n          </Link>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {groupedInterests.signals.length > 0 && (\n            <InterestTable title=\"Future Interest Signals (Closed Deal)\" interests={groupedInterests.signals} emptyLabel=\"\" />\n          )}\n          <InterestTable title=\"Pending Review\" interests={groupedInterests.pending} emptyLabel=\"No pending interests.\" />\n          <InterestTable title=\"Approved\" interests={groupedInterests.approved} emptyLabel=\"No approved interests yet.\" />\n          {groupedInterests.other.length > 0 && (\n            <InterestTable title=\"Completed\" interests={groupedInterests.other} emptyLabel=\"\" />\n          )}\n        </CardContent>\n      </Card>\n\n      <Card className=\"border-border bg-muted/50\">\n        <CardHeader className=\"flex flex-row items-start justify-between\">\n          <div>\n            <CardTitle className=\"text-foreground\">Subscription Submissions</CardTitle>\n            <CardDescription>\n              Monitor definitive commitments flowing in from the investor data room.\n            </CardDescription>\n          </div>\n          <Link\n            href={`/versotech_main/approvals?entity=deal_subscription&deal=${dealId}`}\n            className=\"text-sm font-medium text-sky-300 hover:text-sky-200\"\n          >\n            View related approvals ➜\n          </Link>\n        </CardHeader>\n        <CardContent>\n          <Table className=\"min-w-full\">\n            <TableHeader>\n              <TableRow>\n                <TableHead>Investor</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead>Submitted</TableHead>\n                <TableHead>Amount (derived)</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {subscriptions?.length ? (\n                subscriptions.map(subscription => {\n                  const rawAmount = subscription.payload_json?.amount ??\n                    subscription.payload_json?.subscription_amount ??\n                    subscription.payload_json?.commitment_amount\n                  const numericAmount = typeof rawAmount === 'number' ? rawAmount : parseFloat(rawAmount ?? '')\n                  const formattedAmount = Number.isFinite(numericAmount)\n                    ? numericAmount.toLocaleString()\n                    : undefined\n                  return (\n                    <TableRow key={subscription.id}>\n                      <TableCell>{subscription.investors?.legal_name || 'Unknown investor'}</TableCell>\n                      <TableCell>\n                        <Badge className={subscriptionStatusStyles[subscription.status] ?? 'bg-muted'}>\n                          {subscription.status.replace('_', ' ').toUpperCase()}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>\n                        {subscription.submitted_at\n                          ? format(new Date(subscription.submitted_at), 'dd MMM yyyy HH:mm')\n                          : '—'}\n                      </TableCell>\n                      <TableCell>{formattedAmount ?? '—'}</TableCell>\n                    </TableRow>\n                  )\n                })\n              ) : (\n                <TableRow>\n                  <TableCell colSpan={4} className=\"text-center text-muted-foreground py-6\">\n                    No subscription submissions yet.\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\ninterface InterestTableProps {\n  title: string\n  interests: Array<Record<string, any>>\n  emptyLabel: string\n}\n\nfunction InterestTable({ title, interests, emptyLabel }: InterestTableProps) {\n  return (\n    <div className=\"space-y-2\">\n      <h4 className=\"text-sm font-semibold text-foreground\">{title}</h4>\n      <Table className=\"min-w-full\">\n        <TableHeader>\n          <TableRow>\n            <TableHead>Investor</TableHead>\n            <TableHead>Action</TableHead>\n            <TableHead>Status</TableHead>\n            <TableHead>Indicative Amount</TableHead>\n            <TableHead>Submitted</TableHead>\n          </TableRow>\n        </TableHeader>\n        <TableBody>\n          {interests.length ? (\n            interests.map(interest => {\n              // Determine display status for post-close interests\n              const displayStatus = interest.is_post_close ? 'signal' : interest.status\n              const statusLabel = interest.is_post_close\n                ? 'SIGNAL'\n                : interest.status.replace('_', ' ').toUpperCase()\n\n              return (\n                <TableRow key={interest.id}>\n                  <TableCell>{interest.investors?.legal_name || 'Unknown investor'}</TableCell>\n                  <TableCell>\n                    {interest.is_post_close ? (\n                      <Badge className=\"bg-purple-500/20 text-purple-100\">\n                        Notify Me About Similar\n                      </Badge>\n                    ) : (\n                      <Badge className=\"bg-blue-500/20 text-blue-100\">\n                        I'm Interested\n                      </Badge>\n                    )}\n                  </TableCell>\n                  <TableCell>\n                    <Badge className={interestStatusStyles[displayStatus] ?? 'bg-muted'}>\n                      {statusLabel}\n                    </Badge>\n                  </TableCell>\n                  <TableCell>\n                    {interest.indicative_amount\n                      ? `${interest.indicative_currency ?? ''} ${interest.indicative_amount.toLocaleString()}`\n                      : '—'}\n                  </TableCell>\n                  <TableCell>\n                    {interest.submitted_at\n                      ? format(new Date(interest.submitted_at), 'dd MMM yyyy HH:mm')\n                      : '—'}\n                  </TableCell>\n                </TableRow>\n              )\n            })\n          ) : (\n            <TableRow>\n              <TableCell colSpan={5} className=\"text-center text-muted-foreground py-6\">\n                {emptyLabel}\n              </TableCell>\n            </TableRow>\n          )}\n        </TableBody>\n      </Table>\n    </div>\n  )\n}\n","'use client'\r\n\r\nimport { useEffect, useMemo, useState } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle\r\n} from '@/components/ui/card'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow\r\n} from '@/components/ui/table'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle\r\n} from '@/components/ui/dialog'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue\r\n} from '@/components/ui/select'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { Checkbox } from '@/components/ui/checkbox'\r\nimport { format, formatDistanceToNow } from 'date-fns'\r\nimport { Loader2, ShieldCheck, KeyRound, Clock, Trash2, Plus, Edit, Download, FileText, ExternalLink } from 'lucide-react'\r\nimport { DataRoomDocumentUpload } from './data-room-document-upload'\r\nimport { toast } from 'sonner'\r\n\r\ninterface DealDataRoomAccessTabProps {\r\n  dealId: string\r\n  dealName: string\r\n  memberships: Array<Record<string, any>>\r\n  accessRecords: Array<Record<string, any>>\r\n  documents: Array<Record<string, any>>\r\n}\r\n\r\ninterface AccessFormState {\r\n  investorId: string\r\n  expiresAt: string\r\n  autoGranted: boolean\r\n  notes: string\r\n}\r\n\r\nconst emptyForm: AccessFormState = {\r\n  investorId: '',\r\n  expiresAt: '',\r\n  autoGranted: false,\r\n  notes: ''\r\n}\r\n\r\nexport function DealDataRoomAccessTab({\r\n  dealId,\r\n  dealName,\r\n  memberships,\r\n  accessRecords,\r\n  documents\r\n}: DealDataRoomAccessTabProps) {\r\n  const router = useRouter()\r\n  const [isDialogOpen, setIsDialogOpen] = useState(false)\r\n  const [formValues, setFormValues] = useState<AccessFormState>(emptyForm)\r\n  const [editingAccessId, setEditingAccessId] = useState<string | null>(null)\r\n  const [isSubmitting, setIsSubmitting] = useState(false)\r\n  const [errorMessage, setErrorMessage] = useState<string | null>(null)\r\n  const [items, setItems] = useState(accessRecords ?? [])\r\n  const [editingDocId, setEditingDocId] = useState<string | null>(null)\r\n  const [docFormValues, setDocFormValues] = useState<any>({})\r\n  const [isDocDialogOpen, setIsDocDialogOpen] = useState(false)\r\n\r\n  useEffect(() => {\r\n    setItems(accessRecords ?? [])\r\n  }, [accessRecords])\r\n\r\n  const investorOptions = useMemo(() => {\r\n    const investors = memberships\r\n      ?.filter(member => member.investor_id && member.investors)\r\n      .map(member => ({\r\n        id: member.investor_id,\r\n        label: member.investors?.legal_name || 'Unnamed investor'\r\n      })) ?? []\r\n    return investors\r\n  }, [memberships])\r\n\r\n  const groupedDocuments = useMemo(() => {\r\n    const map = new Map<string, Array<Record<string, any>>>()\r\n    documents?.forEach(doc => {\r\n      const key = doc.folder || 'Uncategorised'\r\n      if (!map.has(key)) {\r\n        map.set(key, [])\r\n      }\r\n      map.get(key)!.push(doc)\r\n    })\r\n    return Array.from(map.entries())\r\n  }, [documents])\r\n\r\n  const resetForm = () => {\r\n    setFormValues(emptyForm)\r\n    setEditingAccessId(null)\r\n    setErrorMessage(null)\r\n  }\r\n\r\n  const openCreateDialog = () => {\r\n    resetForm()\r\n    setIsDialogOpen(true)\r\n  }\r\n\r\n  const openEditDialog = (record: Record<string, any>) => {\r\n    setFormValues({\r\n      investorId: record.investor_id,\r\n      expiresAt: record.expires_at ? record.expires_at.slice(0, 16) : '',\r\n      autoGranted: Boolean(record.auto_granted),\r\n      notes: record.notes ?? ''\r\n    })\r\n    setEditingAccessId(record.id)\r\n    setErrorMessage(null)\r\n    setIsDialogOpen(true)\r\n  }\r\n\r\n  const closeDialog = () => {\r\n    setIsDialogOpen(false)\r\n    resetForm()\r\n  }\r\n\r\n  const refresh = async () => {\r\n    const response = await fetch(`/api/deals/${dealId}/data-room-access`)\r\n    if (!response.ok) {\r\n      setErrorMessage('Failed to refresh access records. Please reload the page.')\r\n      return\r\n    }\r\n    const data = await response.json()\r\n    setItems(data.access ?? [])\r\n  }\r\n\r\n  const submitForm = async () => {\r\n    if (!formValues.investorId) {\r\n      setErrorMessage('Select an investor before submitting.')\r\n      return\r\n    }\r\n\r\n    setIsSubmitting(true)\r\n    setErrorMessage(null)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/data-room-access`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          investor_id: formValues.investorId,\r\n          expires_at: formValues.expiresAt ? new Date(formValues.expiresAt).toISOString() : null,\r\n          auto_granted: formValues.autoGranted,\r\n          notes: formValues.notes || null\r\n        })\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const text = await response.text()\r\n        throw new Error(text || 'Failed to save access record')\r\n      }\r\n\r\n      await refresh()\r\n      closeDialog()\r\n    } catch (error) {\r\n      setErrorMessage(error instanceof Error ? error.message : 'Unexpected error saving access record')\r\n    } finally {\r\n      setIsSubmitting(false)\r\n    }\r\n  }\r\n\r\n  const revokeAccess = async (record: Record<string, any>) => {\r\n    setIsSubmitting(true)\r\n    setErrorMessage(null)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/data-room-access`, {\r\n        method: 'DELETE',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ access_id: record.id, reason: 'Revoked via staff portal' })\r\n      })\r\n      if (!response.ok) {\r\n        const text = await response.text()\r\n        throw new Error(text || 'Failed to revoke access')\r\n      }\r\n      await refresh()\r\n    } catch (error) {\r\n      setErrorMessage(error instanceof Error ? error.message : 'Unexpected error revoking access')\r\n    } finally {\r\n      setIsSubmitting(false)\r\n    }\r\n  }\r\n\r\n  const handleDownloadDoc = async (doc: any) => {\r\n    try {\r\n      // If document has external link, open it directly\r\n      if (doc.external_link) {\r\n        window.open(doc.external_link, '_blank', 'noopener,noreferrer')\r\n        toast.success('Opening document in new tab')\r\n      } else {\r\n        // Otherwise, fetch download URL from API\r\n        const response = await fetch(`/api/deals/${dealId}/documents/${doc.id}/download`)\r\n        if (!response.ok) {\r\n          throw new Error('Failed to get download link')\r\n        }\r\n        const data = await response.json()\r\n        window.open(data.download_url, '_blank')\r\n        toast.success('Document download started')\r\n      }\r\n    } catch (error) {\r\n      toast.error('Failed to open document')\r\n    }\r\n  }\r\n\r\n  const openEditDocDialog = (doc: any) => {\r\n    setEditingDocId(doc.id)\r\n    setDocFormValues({\r\n      file_name: doc.file_name || '',\r\n      folder: doc.folder || 'Legal',\r\n      visible_to_investors: doc.visible_to_investors || false,\r\n      document_notes: doc.document_notes || '',\r\n      external_link: doc.external_link || ''\r\n    })\r\n    setIsDocDialogOpen(true)\r\n  }\r\n\r\n  const handleSaveDocEdit = async () => {\r\n    if (!editingDocId) return\r\n\r\n    setIsSubmitting(true)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/documents/${editingDocId}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(docFormValues)\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const error = await response.json()\r\n        throw new Error(error.error || 'Failed to update document')\r\n      }\r\n\r\n      toast.success('Document updated successfully')\r\n      setIsDocDialogOpen(false)\r\n      setEditingDocId(null)\r\n      router.refresh()\r\n    } catch (error) {\r\n      toast.error(error instanceof Error ? error.message : 'Failed to update document')\r\n    } finally {\r\n      setIsSubmitting(false)\r\n    }\r\n  }\r\n\r\n  const handleDeleteDoc = async (doc: any) => {\r\n    if (!confirm(`Are you sure you want to delete \"${doc.file_name}\"? This action cannot be undone.`)) {\r\n      return\r\n    }\r\n\r\n    setIsSubmitting(true)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/documents/${doc.id}`, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to delete document')\r\n      }\r\n\r\n      toast.success('Document deleted successfully')\r\n      router.refresh()\r\n    } catch (error) {\r\n      toast.error('Failed to delete document')\r\n    } finally {\r\n      setIsSubmitting(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card className=\"border-border bg-muted/50\">\r\n        <CardHeader className=\"flex flex-row items-start justify-between\">\r\n          <div>\r\n            <CardTitle className=\"text-foreground\">Data Room Access</CardTitle>\r\n            <CardDescription>\r\n              Manage NDA-cleared investors, extend access windows, and keep visibility in sync with documentation.\r\n            </CardDescription>\r\n          </div>\r\n          <Button onClick={openCreateDialog} className=\"gap-2\" disabled={isSubmitting}>\r\n            <KeyRound className=\"h-4 w-4\" />\r\n            Grant Access\r\n          </Button>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {errorMessage && (\r\n            <div className=\"mb-4 rounded-md border border-destructive/40 bg-destructive/10 px-4 py-3 text-sm text-destructive\">\r\n              {errorMessage}\r\n            </div>\r\n          )}\r\n\r\n          <Table className=\"min-w-full\">\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead>Investor</TableHead>\r\n                <TableHead>Granted</TableHead>\r\n                <TableHead>Expires</TableHead>\r\n                <TableHead>Status</TableHead>\r\n                <TableHead className=\"text-right\">Actions</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {items?.length ? (\r\n                items.map(record => {\r\n                  const isRevoked = Boolean(record.revoked_at)\r\n                  const expiresSoon = !record.revoked_at && record.expires_at && new Date(record.expires_at) < new Date(Date.now() + 3 * 24 * 60 * 60 * 1000)\r\n                  return (\r\n                    <TableRow key={record.id}>\r\n                      <TableCell className=\"font-medium\">\r\n                        {record.investors?.legal_name || 'Unknown investor'}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {record.granted_at ? format(new Date(record.granted_at), 'dd MMM yyyy HH:mm') : '—'}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {record.expires_at\r\n                          ? `${format(new Date(record.expires_at), 'dd MMM yyyy HH:mm')} (${formatDistanceToNow(new Date(record.expires_at), { addSuffix: true })})`\r\n                          : 'No expiry'}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge className={isRevoked ? 'bg-rose-500/20 text-rose-100' : expiresSoon ? 'bg-amber-500/20 text-amber-100' : 'bg-emerald-500/20 text-emerald-100'}>\r\n                          {isRevoked ? 'REVOKED' : expiresSoon ? 'EXPIRING' : 'ACTIVE'}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right space-x-2\">\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          className=\"gap-2\"\r\n                          onClick={() => openEditDialog(record)}\r\n                          disabled={isSubmitting || isRevoked}\r\n                        >\r\n                          <Clock className=\"h-4 w-4\" />\r\n                          Extend\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          className=\"gap-2 text-rose-300\"\r\n                          onClick={() => revokeAccess(record)}\r\n                          disabled={isSubmitting || isRevoked}\r\n                        >\r\n                          <Trash2 className=\"h-4 w-4\" />\r\n                          Revoke\r\n                        </Button>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  )\r\n                })\r\n              ) : (\r\n                <TableRow>\r\n                  <TableCell colSpan={5} className=\"text-center text-muted-foreground py-6\">\r\n                    No active access yet. Grant access once the NDA is signed.\r\n                  </TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"border-border bg-muted/50\">\r\n        <CardHeader className=\"flex flex-row items-start justify-between\">\r\n          <div>\r\n            <CardTitle className=\"text-foreground\">Data Room Documents</CardTitle>\r\n            <CardDescription>\r\n              Upload and manage documents that investors can access in their data room.\r\n            </CardDescription>\r\n          </div>\r\n          <DataRoomDocumentUpload\r\n            dealId={dealId}\r\n            onUploadComplete={refresh}\r\n            trigger={\r\n              <Button className=\"gap-2\">\r\n                <Plus className=\"h-4 w-4\" />\r\n                Upload Files\r\n              </Button>\r\n            }\r\n          />\r\n        </CardHeader>\r\n        <CardContent>\r\n          {documents?.length ? (\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Document</TableHead>\r\n                  <TableHead>Folder</TableHead>\r\n                  <TableHead>Visible to Investors</TableHead>\r\n                  <TableHead>Uploaded</TableHead>\r\n                  <TableHead className=\"text-right\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {documents.map(doc => (\r\n                  <TableRow key={doc.id}>\r\n                    <TableCell className=\"font-medium\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {doc.external_link ? (\r\n                          <ExternalLink className=\"h-4 w-4 text-blue-500\" />\r\n                        ) : (\r\n                          <FileText className=\"h-4 w-4 text-muted-foreground\" />\r\n                        )}\r\n                        {doc.file_name || doc.file_key?.split('/').pop() || 'Untitled'}\r\n                        {doc.external_link && (\r\n                          <Badge variant=\"outline\" className=\"ml-2 text-xs bg-blue-500/10 text-blue-400 border-blue-500/30\">\r\n                            Link\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Badge variant=\"outline\">{doc.folder || 'Uncategorized'}</Badge>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Badge className={doc.visible_to_investors ? 'bg-emerald-500/20 text-emerald-100' : 'bg-muted text-muted-foreground'}>\r\n                        {doc.visible_to_investors ? 'YES' : 'NO'}\r\n                      </Badge>\r\n                    </TableCell>\r\n                    <TableCell className=\"text-sm text-muted-foreground\">\r\n                      {doc.created_at ? format(new Date(doc.created_at), 'MMM d, yyyy') : '—'}\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right space-x-2\">\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"gap-2\"\r\n                        onClick={() => handleDownloadDoc(doc)}\r\n                        disabled={isSubmitting}\r\n                      >\r\n                        {doc.external_link ? (\r\n                          <>\r\n                            <ExternalLink className=\"h-4 w-4\" />\r\n                            View\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            <Download className=\"h-4 w-4\" />\r\n                            Download\r\n                          </>\r\n                        )}\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"gap-2\"\r\n                        onClick={() => openEditDocDialog(doc)}\r\n                        disabled={isSubmitting}\r\n                      >\r\n                        <Edit className=\"h-4 w-4\" />\r\n                        Edit\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"gap-2 text-rose-300\"\r\n                        onClick={() => handleDeleteDoc(doc)}\r\n                        disabled={isSubmitting}\r\n                      >\r\n                        <Trash2 className=\"h-4 w-4\" />\r\n                        Delete\r\n                      </Button>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          ) : (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              No documents have been published to the data room yet.\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Dialog open={isDialogOpen} onOpenChange={open => !open && closeDialog()}>\r\n        <DialogContent className=\"sm:max-w-lg\">\r\n          <DialogHeader>\r\n            <DialogTitle>{editingAccessId ? 'Update Data Room Access' : 'Grant Data Room Access'}</DialogTitle>\r\n            <CardDescription>\r\n              Select an investor and optionally set an expiry to control data room visibility for {dealName}.\r\n            </CardDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4 py-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label>Investor</Label>\r\n              <Select\r\n                value={formValues.investorId}\r\n                onValueChange={value => setFormValues(prev => ({ ...prev, investorId: value }))}\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Select investor\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {investorOptions.length ? (\r\n                    investorOptions.map(option => (\r\n                      <SelectItem key={option.id} value={option.id}>\r\n                        {option.label}\r\n                      </SelectItem>\r\n                    ))\r\n                  ) : (\r\n                    <SelectItem value=\"\">No investors invited yet</SelectItem>\r\n                  )}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"expiresAt\">Expiry</Label>\r\n              <Input\r\n                id=\"expiresAt\"\r\n                type=\"datetime-local\"\r\n                value={formValues.expiresAt}\r\n                onChange={event => setFormValues(prev => ({ ...prev, expiresAt: event.target.value }))}\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">Leave blank for open-ended access.</p>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Checkbox\r\n                id=\"autoGranted\"\r\n                checked={formValues.autoGranted}\r\n                onCheckedChange={checked =>\r\n                  setFormValues(prev => ({ ...prev, autoGranted: Boolean(checked) }))\r\n                }\r\n              />\r\n              <Label htmlFor=\"autoGranted\" className=\"text-sm font-medium\">\r\n                Mark as auto-granted (automation)\r\n              </Label>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"notes\">Notes</Label>\r\n              <Textarea\r\n                id=\"notes\"\r\n                rows={3}\r\n                value={formValues.notes}\r\n                onChange={event => setFormValues(prev => ({ ...prev, notes: event.target.value }))}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter className=\"flex items-center justify-between\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"ghost\"\r\n              onClick={closeDialog}\r\n              disabled={isSubmitting}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={submitForm} disabled={isSubmitting}>\r\n              {isSubmitting && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n              Save Access\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Document Edit Dialog */}\r\n      <Dialog open={isDocDialogOpen} onOpenChange={setIsDocDialogOpen}>\r\n        <DialogContent className=\"sm:max-w-lg\">\r\n          <DialogHeader>\r\n            <DialogTitle>Edit Document</DialogTitle>\r\n            <CardDescription>\r\n              Update document metadata, folder, and visibility settings.\r\n            </CardDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4 py-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"fileName\">Document Name</Label>\r\n              <Input\r\n                id=\"fileName\"\r\n                value={docFormValues.file_name || ''}\r\n                onChange={event => setDocFormValues((prev: any) => ({ ...prev, file_name: event.target.value }))}\r\n                placeholder=\"Enter document name...\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"externalLink\">External Link (optional)</Label>\r\n              <Input\r\n                id=\"externalLink\"\r\n                type=\"url\"\r\n                value={docFormValues.external_link || ''}\r\n                onChange={event => setDocFormValues((prev: any) => ({ ...prev, external_link: event.target.value }))}\r\n                placeholder=\"https://drive.google.com/file/d/...\"\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Leave empty for uploaded files. Add a Google Drive, Dropbox, or other external link to reference documents hosted elsewhere.\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>Folder</Label>\r\n              <Select\r\n                value={docFormValues.folder}\r\n                onValueChange={value => setDocFormValues((prev: any) => ({ ...prev, folder: value }))}\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"Legal\">Legal</SelectItem>\r\n                  <SelectItem value=\"KYC\">KYC</SelectItem>\r\n                  <SelectItem value=\"Reports\">Reports</SelectItem>\r\n                  <SelectItem value=\"Presentations\">Presentations</SelectItem>\r\n                  <SelectItem value=\"Financial Models\">Financial Models</SelectItem>\r\n                  <SelectItem value=\"Misc\">Misc</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Checkbox\r\n                id=\"docVisible\"\r\n                checked={docFormValues.visible_to_investors}\r\n                onCheckedChange={checked =>\r\n                  setDocFormValues((prev: any) => ({ ...prev, visible_to_investors: Boolean(checked) }))\r\n                }\r\n              />\r\n              <Label htmlFor=\"docVisible\" className=\"text-sm font-medium\">\r\n                Visible to investors\r\n              </Label>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"docNotes\">Notes</Label>\r\n              <Textarea\r\n                id=\"docNotes\"\r\n                rows={3}\r\n                value={docFormValues.document_notes}\r\n                onChange={event => setDocFormValues((prev: any) => ({ ...prev, document_notes: event.target.value }))}\r\n                placeholder=\"Internal notes about this document...\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter className=\"flex items-center justify-between\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"ghost\"\r\n              onClick={() => setIsDocDialogOpen(false)}\r\n              disabled={isSubmitting}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleSaveDocEdit} disabled={isSubmitting}>\r\n              {isSubmitting && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n              Save Changes\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState, useEffect, useCallback } from 'react'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { FileText, ExternalLink, Loader2 } from 'lucide-react'\r\nimport { toast } from 'sonner'\r\n\r\ninterface SubscriptionWithDocuments {\r\n  id: string\r\n  deal_id: string\r\n  investor_id: string\r\n  status: string\r\n  submitted_at: string\r\n  payload_json: {\r\n    amount?: number\r\n    subscription_amount?: number\r\n    currency?: string\r\n  }\r\n  investors: {\r\n    id: string\r\n    legal_name: string\r\n  }\r\n  pack_status?: 'no_pack' | 'draft' | 'final' | 'pending_signature' | 'signed'\r\n  pack_document_id?: string\r\n  document_count?: number\r\n  documents?: Array<{\r\n    id: string\r\n    name: string\r\n    type: string\r\n    status: string\r\n    file_key: string\r\n    mime_type: string\r\n    file_size_bytes: number\r\n    created_at: string\r\n    created_by: string\r\n  }>\r\n}\r\n\r\ninterface DealSubscriptionsTabProps {\r\n  dealId: string\r\n}\r\n\r\nexport function DealSubscriptionsTab({ dealId }: DealSubscriptionsTabProps) {\r\n  const [subscriptions, setSubscriptions] = useState<SubscriptionWithDocuments[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  const statusColors: Record<string, string> = {\r\n    pending_review: 'bg-yellow-100 dark:bg-yellow-500/20 text-yellow-700 dark:text-yellow-200',\r\n    approved: 'bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-200',\r\n    rejected: 'bg-red-100 dark:bg-red-500/20 text-red-700 dark:text-red-200',\r\n    pending_signature: 'bg-blue-100 dark:bg-blue-500/20 text-blue-700 dark:text-blue-200',\r\n    committed: 'bg-green-100 dark:bg-green-500/20 text-green-700 dark:text-green-200'\r\n  }\r\n\r\n  const packStatusColors: Record<string, string> = {\r\n    no_pack: 'bg-muted text-muted-foreground',\r\n    draft: 'bg-purple-100 dark:bg-purple-500/20 text-purple-700 dark:text-purple-200',\r\n    final: 'bg-cyan-100 dark:bg-cyan-500/20 text-cyan-700 dark:text-cyan-200',\r\n    pending_signature: 'bg-amber-100 dark:bg-amber-500/20 text-amber-700 dark:text-amber-200',\r\n    signed: 'bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-200'\r\n  }\r\n\r\n  const packStatusLabels: Record<string, string> = {\r\n    no_pack: 'No Pack',\r\n    draft: 'Draft Generated',\r\n    final: 'Final Uploaded',\r\n    pending_signature: 'Awaiting Signatures',\r\n    signed: 'Fully Executed'\r\n  }\r\n\r\n  const fetchSubscriptions = useCallback(async () => {\r\n    setLoading(true)\r\n    try {\r\n      const response = await fetch(`/api/deals/${dealId}/subscriptions`)\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch subscriptions')\r\n      }\r\n\r\n      const data = await response.json()\r\n\r\n      // API now returns enriched data with pack_status, pack_document_id, and document_count\r\n      // No need for additional fetching - all data is included in single query\r\n      setSubscriptions(data.submissions || [])\r\n    } catch (error) {\r\n      console.error('Error fetching subscriptions:', error)\r\n      toast.error('Failed to load subscriptions')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, [dealId])\r\n\r\n  useEffect(() => {\r\n    fetchSubscriptions()\r\n  }, [dealId, fetchSubscriptions])\r\n\r\n  const formatAmount = (subscription: SubscriptionWithDocuments) => {\r\n    const amount = subscription.payload_json?.amount || subscription.payload_json?.subscription_amount\r\n    const currency = subscription.payload_json?.currency || 'USD'\r\n\r\n    if (!amount) return 'Not specified'\r\n\r\n    return new Intl.NumberFormat('en-US', {\r\n      style: 'currency',\r\n      currency: currency\r\n    }).format(amount)\r\n  }\r\n\r\n  const handleViewDetails = (subscription: SubscriptionWithDocuments) => {\r\n    // First try to open the formal subscription if it exists\r\n    if ((subscription as any).subscription_id) {\r\n      window.open(`/versotech_main/subscriptions/${(subscription as any).subscription_id}`, '_blank')\r\n    } else if (subscription.pack_document_id) {\r\n      // Otherwise, if there's a subscription pack, download it\r\n      window.open(`/api/documents/${subscription.pack_document_id}/download`, '_blank')\r\n    } else {\r\n      // No converted subscription and no pack yet\r\n      toast.info('This subscription has not been converted to a formal commitment yet, and no subscription pack has been generated.')\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card className=\"border border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle className=\"text-foreground flex items-center gap-2\">\r\n                <FileText className=\"h-5 w-5\" />\r\n                Subscription Submissions\r\n              </CardTitle>\r\n              <CardDescription>Investor subscriptions and pack generation status</CardDescription>\r\n            </div>\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              {subscriptions.length} {subscriptions.length === 1 ? 'submission' : 'submissions'}\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {subscriptions.length === 0 ? (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              No subscription submissions yet for this deal.\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-2\">\r\n              {subscriptions.map((subscription) => (\r\n                <div\r\n                  key={subscription.id}\r\n                  className=\"flex items-center justify-between py-4 px-4 rounded-lg border border-border bg-muted/50 hover:bg-muted transition-colors\"\r\n                >\r\n                  <div className=\"flex items-center gap-4 flex-1\">\r\n                    <FileText className=\"h-5 w-5 text-muted-foreground\" />\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <span className=\"font-medium text-foreground\">\r\n                          {subscription.investors.legal_name}\r\n                        </span>\r\n                        <Badge className={statusColors[subscription.status] || statusColors.pending_review}>\r\n                          {subscription.status.replace(/_/g, ' ').toUpperCase()}\r\n                        </Badge>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\r\n                        <span>Amount: {formatAmount(subscription)}</span>\r\n                        <span>•</span>\r\n                        <span>Submitted {new Date(subscription.submitted_at).toLocaleDateString()}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"text-right mr-2\">\r\n                      <div className=\"text-xs text-muted-foreground mb-1\">Subscription Pack</div>\r\n                      <Badge className={packStatusColors[subscription.pack_status || 'no_pack']}>\r\n                        {packStatusLabels[subscription.pack_status || 'no_pack']}\r\n                      </Badge>\r\n                    </div>\r\n                    {((subscription as any).subscription_id || subscription.pack_document_id) && (\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"gap-2\"\r\n                        onClick={() => handleViewDetails(subscription)}\r\n                      >\r\n                        <ExternalLink className=\"h-4 w-4\" />\r\n                        {(subscription as any).subscription_id ? 'View Subscription' : 'View Pack'}\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"border border-border bg-muted/50\">\r\n        <CardHeader>\r\n          <CardTitle className=\"text-sm text-foreground\">Pack Status Legend</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-5 gap-3 text-sm\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge className={packStatusColors.no_pack}>No Pack</Badge>\r\n              <span className=\"text-muted-foreground\">No document generated</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge className={packStatusColors.draft}>Draft</Badge>\r\n              <span className=\"text-muted-foreground\">System generated draft</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge className={packStatusColors.final}>Final</Badge>\r\n              <span className=\"text-muted-foreground\">Staff uploaded final</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge className={packStatusColors.pending_signature}>Awaiting</Badge>\r\n              <span className=\"text-muted-foreground\">Sent for signatures</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge className={packStatusColors.signed}>Executed</Badge>\r\n              <span className=\"text-muted-foreground\">All parties signed</span>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n","'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Label } from '@/components/ui/label'\nimport { toast } from 'sonner'\nimport { Loader2 } from 'lucide-react'\n\ninterface FAQ {\n  id: string\n  question: string\n  answer: string\n  display_order: number\n  created_at: string\n  updated_at: string\n}\n\ninterface FaqFormDialogProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  dealId: string\n  faq: FAQ | null\n  onSave: () => void\n}\n\nexport function FaqFormDialog({ open, onOpenChange, dealId, faq, onSave }: FaqFormDialogProps) {\n  const [question, setQuestion] = useState('')\n  const [answer, setAnswer] = useState('')\n  const [loading, setLoading] = useState(false)\n\n  useEffect(() => {\n    if (faq) {\n      setQuestion(faq.question)\n      setAnswer(faq.answer)\n    } else {\n      setQuestion('')\n      setAnswer('')\n    }\n  }, [faq, open])\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    if (!question.trim() || !answer.trim()) {\n      toast.error('Question and answer are required')\n      return\n    }\n\n    setLoading(true)\n\n    try {\n      const url = faq\n        ? `/api/deals/${dealId}/faqs/${faq.id}`\n        : `/api/deals/${dealId}/faqs`\n\n      const method = faq ? 'PATCH' : 'POST'\n\n      const res = await fetch(url, {\n        method,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ question, answer }),\n      })\n\n      const data = await res.json()\n\n      if (!res.ok) {\n        throw new Error(data.error || 'Failed to save FAQ')\n      }\n\n      toast.success(faq ? 'FAQ updated successfully' : 'FAQ created successfully')\n\n      onSave()\n      onOpenChange(false)\n    } catch (error) {\n      console.error('Error saving FAQ:', error)\n      toast.error(error instanceof Error ? error.message : 'Failed to save FAQ')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[600px]\">\n        <form onSubmit={handleSubmit}>\n          <DialogHeader>\n            <DialogTitle>{faq ? 'Edit FAQ' : 'Add New FAQ'}</DialogTitle>\n            <DialogDescription>\n              {faq ? 'Update the question and answer' : 'Create a new frequently asked question for this deal'}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"grid gap-4 py-4\">\n            <div className=\"grid gap-2\">\n              <Label htmlFor=\"question\">Question</Label>\n              <Input\n                id=\"question\"\n                value={question}\n                onChange={(e) => setQuestion(e.target.value)}\n                placeholder=\"e.g., What is the minimum investment amount?\"\n                maxLength={500}\n                required\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                {question.length}/500 characters\n              </p>\n            </div>\n            <div className=\"grid gap-2\">\n              <Label htmlFor=\"answer\">Answer</Label>\n              <Textarea\n                id=\"answer\"\n                value={answer}\n                onChange={(e) => setAnswer(e.target.value)}\n                placeholder=\"Provide a clear and concise answer...\"\n                rows={6}\n                maxLength={5000}\n                required\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                {answer.length}/5000 characters\n              </p>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n              disabled={loading}\n            >\n              Cancel\n            </Button>\n            <Button type=\"submit\" disabled={loading}>\n              {loading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              {faq ? 'Update' : 'Create'} FAQ\n            </Button>\n          </DialogFooter>\n        </form>\n      </DialogContent>\n    </Dialog>\n  )\n}\n","'use client'\n\nimport { Card, CardContent } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Edit, Trash2 } from 'lucide-react'\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from '@/components/ui/alert-dialog'\n\ninterface FAQ {\n  id: string\n  question: string\n  answer: string\n  display_order: number\n  created_at: string\n  updated_at: string\n}\n\ninterface FaqItemProps {\n  faq: FAQ\n  onEdit: () => void\n  onDelete: () => void\n}\n\nexport function FaqItem({ faq, onEdit, onDelete }: FaqItemProps) {\n  return (\n    <Card>\n      <CardContent className=\"pt-6\">\n        <div className=\"flex items-start justify-between gap-4\">\n          <div className=\"flex-1 space-y-2\">\n            <h4 className=\"font-semibold text-sm\">{faq.question}</h4>\n            <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">\n              {faq.answer}\n            </p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onEdit}\n            >\n              <Edit className=\"h-4 w-4\" />\n            </Button>\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button variant=\"ghost\" size=\"sm\">\n                  <Trash2 className=\"h-4 w-4 text-destructive\" />\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Delete FAQ?</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    Are you sure you want to delete this FAQ? This action cannot be undone.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel>Cancel</AlertDialogCancel>\n                  <AlertDialogAction onClick={onDelete} className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\">\n                    Delete\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useState, useEffect, useCallback } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Plus, Loader2, HelpCircle } from 'lucide-react'\nimport { FaqFormDialog } from './faq-form-dialog'\nimport { FaqItem } from './faq-item'\nimport { toast } from 'sonner'\n\ninterface FAQ {\n  id: string\n  question: string\n  answer: string\n  display_order: number\n  created_at: string\n  updated_at: string\n}\n\nexport function DealFaqTab({ dealId }: { dealId: string }) {\n  const [faqs, setFaqs] = useState<FAQ[]>([])\n  const [loading, setLoading] = useState(true)\n  const [showDialog, setShowDialog] = useState(false)\n  const [editingFaq, setEditingFaq] = useState<FAQ | null>(null)\n\n  const fetchFaqs = useCallback(async () => {\n    try {\n      const res = await fetch(`/api/deals/${dealId}/faqs`)\n      const data = await res.json()\n      setFaqs(data.faqs || [])\n    } catch (error) {\n      console.error('Error fetching FAQs:', error)\n      toast.error('Failed to load FAQs')\n    } finally {\n      setLoading(false)\n    }\n  }, [dealId])\n\n  useEffect(() => {\n    fetchFaqs()\n  }, [fetchFaqs])\n\n  const handleDelete = async (faqId: string) => {\n    try {\n      const res = await fetch(`/api/deals/${dealId}/faqs/${faqId}`, {\n        method: 'DELETE',\n      })\n\n      if (!res.ok) {\n        const data = await res.json()\n        throw new Error(data.error || 'Failed to delete')\n      }\n\n      setFaqs(faqs.filter((f) => f.id !== faqId))\n      toast.success('FAQ deleted successfully')\n    } catch (error) {\n      console.error('Error deleting FAQ:', error)\n      toast.error(error instanceof Error ? error.message : 'Failed to delete FAQ')\n    }\n  }\n\n  const handleEdit = (faq: FAQ) => {\n    setEditingFaq(faq)\n    setShowDialog(true)\n  }\n\n  const handleSave = () => {\n    fetchFaqs()\n    setShowDialog(false)\n    setEditingFaq(null)\n  }\n\n  const handleAddNew = () => {\n    setEditingFaq(null)\n    setShowDialog(true)\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <div className=\"flex items-center gap-2\">\n                <HelpCircle className=\"h-5 w-5 text-primary\" />\n                <CardTitle>Deal FAQs</CardTitle>\n              </div>\n              <CardDescription className=\"mt-2\">\n                Manage frequently asked questions for this deal. Investors with data room access can view these FAQs.\n              </CardDescription>\n            </div>\n            <Button onClick={handleAddNew}>\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Add FAQ\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {faqs.length === 0 ? (\n            <div className=\"text-center py-12 border-2 border-dashed rounded-lg\">\n              <HelpCircle className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n              <p className=\"text-muted-foreground font-medium mb-2\">No FAQs yet</p>\n              <p className=\"text-sm text-muted-foreground mb-4\">\n                Add frequently asked questions to help investors understand this deal better.\n              </p>\n              <Button onClick={handleAddNew} variant=\"outline\">\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Add Your First FAQ\n              </Button>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {faqs.map((faq) => (\n                <FaqItem\n                  key={faq.id}\n                  faq={faq}\n                  onEdit={() => handleEdit(faq)}\n                  onDelete={() => handleDelete(faq.id)}\n                />\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <FaqFormDialog\n        open={showDialog}\n        onOpenChange={(open) => {\n          setShowDialog(open)\n          if (!open) setEditingFaq(null)\n        }}\n        dealId={dealId}\n        faq={editingFaq}\n        onSave={handleSave}\n      />\n    </div>\n  )\n}\n","'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle\r\n} from '@/components/ui/dialog'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport {\r\n  Building2,\r\n  Users,\r\n  Package,\r\n  DollarSign,\r\n  FileText,\r\n  Activity,\r\n  HandCoins,\r\n  ArrowLeft,\r\n  Edit,\r\n  Loader2\r\n} from 'lucide-react'\r\nimport Link from 'next/link'\r\nimport { useRouter } from 'next/navigation'\r\nimport { DealOverviewTab } from './deal-overview-tab'\r\nimport { DealInventoryTab } from './deal-inventory-tab'\r\nimport { DealMembersTab } from './deal-members-tab'\r\nimport { DealFeePlansTab } from './deal-fee-plans-tab'\r\nimport { DealDocumentsTab } from './deal-documents-tab'\r\nimport { DealActivityTab } from './deal-activity-tab'\r\nimport { DealTermSheetTab } from './deal-term-sheet-tab'\r\nimport { DealInterestTab } from './deal-interest-tab'\r\nimport { DealDataRoomAccessTab } from './deal-data-room-access-tab'\r\nimport { DealSubscriptionsTab } from './deal-subscriptions-tab'\r\nimport { DealFaqTab } from './deal-faq-tab'\r\n\r\nconst statusColors = {\r\n  draft: 'bg-muted text-foreground border border-border',\r\n  open: 'bg-emerald-500/20 text-emerald-200 border border-emerald-400/30',\r\n  allocation_pending: 'bg-amber-500/15 text-amber-200 border border-amber-400/30',\r\n  closed: 'bg-blue-500/20 text-blue-200 border border-blue-400/30',\r\n  cancelled: 'bg-red-500/20 text-red-200 border border-red-400/30'\r\n}\r\n\r\nconst dealTypeLabels = {\r\n  equity_secondary: 'Secondary',\r\n  equity_primary: 'Primary',\r\n  credit_trade_finance: 'Credit/Trade',\r\n  other: 'Other'\r\n}\r\n\r\ninterface DealDetailClientProps {\r\n  deal: any\r\n  inventorySummary: {\r\n    total_units: number\r\n    available_units: number\r\n    reserved_units: number\r\n    allocated_units: number\r\n  }\r\n  documents: any[]\r\n  termSheets: any[]\r\n  interests: any[]\r\n  dataRoomAccess: any[]\r\n  dataRoomDocuments: any[]\r\n  subscriptions: any[]\r\n  subscriptionsForJourney?: any[] // Subscriptions with journey tracking fields\r\n  activitySummary: Record<string, number>\r\n  userProfile: { role: string }\r\n  /** Arranger entities available for assignment */\r\n  arrangerEntities?: Array<{\r\n    id: string\r\n    legal_name: string\r\n    company_name?: string | null\r\n  }>\r\n}\r\n\r\nexport function DealDetailClient({\r\n  deal,\r\n  inventorySummary,\r\n  documents,\r\n  termSheets,\r\n  interests,\r\n  dataRoomAccess,\r\n  dataRoomDocuments,\r\n  subscriptions,\r\n  subscriptionsForJourney = [],\r\n  activitySummary,\r\n  userProfile,\r\n  arrangerEntities = []\r\n}: DealDetailClientProps) {\r\n  const [activeTab, setActiveTab] = useState('overview')\r\n  const [editDialogOpen, setEditDialogOpen] = useState(false)\r\n  const [shareLots, setShareLots] = useState<any[]>([])\r\n  const [isSaving, setIsSaving] = useState(false)\r\n  const [editFormData, setEditFormData] = useState({\r\n    name: deal?.name || '',\r\n    description: deal?.description || '',\r\n    investment_thesis: deal?.investment_thesis || '',\r\n    status: deal?.status || 'draft',\r\n    deal_type: deal?.deal_type || 'equity_secondary',\r\n    stock_type: deal?.stock_type || 'common',\r\n    company_name: deal?.company_name || '',\r\n    company_website: deal?.company_website || '',\r\n    sector: deal?.sector || '',\r\n    stage: deal?.stage || '',\r\n    location: deal?.location || '',\r\n    open_at: deal?.open_at ? deal.open_at.slice(0, 16) : '',\r\n    close_at: deal?.close_at ? deal.close_at.slice(0, 16) : '',\r\n    // Note: offer_unit_price, minimum_investment, maximum_investment are now ONLY in termsheet\r\n    target_amount: deal?.target_amount || '',\r\n    currency: deal?.currency || 'USD',\r\n    arranger_entity_id: deal?.arranger_entity_id || ''\r\n  })\r\n  const router = useRouter()\r\n\r\n  // Fetch share lots for inventory\r\n  const fetchShareLots = async () => {\r\n    try {\r\n      const response = await fetch(`/api/deals/${deal.id}/inventory`)\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        setShareLots(data.inventory || [])\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch share lots:', error)\r\n    }\r\n  }\r\n\r\n  // Fetch share lots on mount\r\n  useEffect(() => {\r\n    if (deal?.id) {\r\n      fetchShareLots()\r\n    }\r\n  }, [deal?.id])\r\n\r\n  // Refresh handler for inventory tab\r\n  const handleInventoryRefresh = () => {\r\n    fetchShareLots()\r\n  }\r\n\r\n  useEffect(() => {\r\n    // Log component mount for debugging\r\n    console.log('[DealDetailClient] Component mounted', {\r\n      dealId: deal?.id,\r\n      dealName: deal?.name,\r\n      dealStatus: deal?.status,\r\n      hasInventory: !!inventorySummary,\r\n      termSheetCount: termSheets?.length || 0,\r\n      interestCount: interests?.length || 0,\r\n      userRole: userProfile?.role\r\n    })\r\n  }, [deal, inventorySummary, termSheets, interests, userProfile])\r\n\r\n  const handleSaveDeal = async () => {\r\n    setIsSaving(true)\r\n    try {\r\n      const response = await fetch(`/api/deals/${deal.id}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          ...editFormData,\r\n          // Note: offer_unit_price, minimum_investment, maximum_investment are now ONLY in termsheet\r\n          target_amount: editFormData.target_amount ? parseFloat(editFormData.target_amount as string) : null,\r\n          arranger_entity_id: editFormData.arranger_entity_id === 'none' || !editFormData.arranger_entity_id ? null : editFormData.arranger_entity_id\r\n        })\r\n      })\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to update deal')\r\n      }\r\n\r\n      setEditDialogOpen(false)\r\n      router.refresh()\r\n    } catch (error) {\r\n      console.error('Error updating deal:', error)\r\n      alert('Failed to update deal. Please try again.')\r\n    } finally {\r\n      setIsSaving(false)\r\n    }\r\n  }\r\n\r\n  const publishedTermSheet = termSheets?.find((sheet: any) => sheet.status === 'published')\r\n  const pendingInterests = interests?.filter((interest: any) => interest.status === 'pending_review') ?? []\r\n  const approvedInterests = interests?.filter((interest: any) => interest.status === 'approved') ?? []\r\n  const activeAccess = dataRoomAccess?.filter((record: any) => !record.revoked_at) ?? []\r\n  const pendingSubscriptions = subscriptions?.filter((submission: any) => submission.status === 'pending_review') ?? []\r\n  const ndaCompletedCount = activitySummary?.nda_completed ?? 0\r\n  const subscriptionCompletedCount = activitySummary?.subscription_completed ?? 0\r\n\r\n  // Safety check - if no deal, show error state (server should handle redirect)\r\n  if (!deal || !deal.id) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <Card className=\"border border-destructive/50 bg-destructive/10\">\r\n          <CardContent className=\"p-6 text-center text-foreground\">\r\n            <p>Unable to load deal details</p>\r\n            <Link href=\"/versotech_main/deals\">\r\n              <Button variant=\"outline\" className=\"mt-4\">\r\n                Back to Deals\r\n              </Button>\r\n            </Link>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-start justify-between\">\r\n        <div className=\"space-y-1\">\r\n          <div className=\"flex items-center gap-3 mb-2\">\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"sm\" \r\n              className=\"gap-2 text-foreground hover:text-sky-400 hover:bg-muted\"\r\n              onClick={() => router.push('/versotech_main/deals')}\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4\" />\r\n              Back to Deals\r\n            </Button>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-3\">\r\n            <h1 className=\"text-3xl font-bold text-foreground\">{deal.name}</h1>\r\n            <Badge className={statusColors[deal.status as keyof typeof statusColors]}>\r\n              {deal.status.replace('_', ' ')}\r\n            </Badge>\r\n            <Badge variant=\"outline\" className=\"border-border text-foreground\">\r\n              {dealTypeLabels[deal.deal_type as keyof typeof dealTypeLabels]}\r\n            </Badge>\r\n          </div>\r\n\r\n          {deal.company_name && (\r\n            <p className=\"text-muted-foreground text-lg\">\r\n              {deal.company_name}\r\n              {deal.sector && ` • ${deal.sector}`}\r\n              {deal.location && ` • ${deal.location}`}\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            className=\"gap-2 border-border text-foreground hover:bg-muted\"\r\n            onClick={() => setEditDialogOpen(true)}\r\n          >\r\n            <Edit className=\"h-4 w-4\" />\r\n            Edit Deal\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Quick Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card className=\"border border-border bg-muted/50\">\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n              Interest Signals\r\n            </CardTitle>\r\n            <HandCoins className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-foreground\">\r\n              {interests?.length ?? 0}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">{pendingInterests.length} awaiting review</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border border-border bg-muted/50\">\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n              Active NDAs\r\n            </CardTitle>\r\n            <FileText className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-foreground\">\r\n              {activeAccess.length}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {approvedInterests.length} interests approved\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border border-border bg-muted/50\">\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n              Published Term Sheet\r\n            </CardTitle>\r\n            <Package className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-foreground\">\r\n              {publishedTermSheet ? `V${publishedTermSheet.version}` : '—'}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {publishedTermSheet\r\n                ? `Published ${publishedTermSheet.published_at ? new Date(publishedTermSheet.published_at).toLocaleDateString() : ''}`\r\n                : 'No published version'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border border-border bg-muted/50\">\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n              Subscriptions\r\n            </CardTitle>\r\n            <Package className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-foreground\">\r\n              {subscriptions?.length ?? 0}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {pendingSubscriptions.length} awaiting approval\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card className=\"border border-border bg-muted/50\">\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n              Conversions (90d)\r\n            </CardTitle>\r\n            <Badge variant=\"outline\">Analytics</Badge>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"flex flex-col gap-1 text-xs text-muted-foreground\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <span>NDA completed</span>\r\n                <span className=\"font-semibold text-foreground\">{ndaCompletedCount}</span>\r\n              </div>\r\n              <div className=\"flex items-center justify-between\">\r\n                <span>Subscriptions funded</span>\r\n                <span className=\"font-semibold text-foreground\">{subscriptionCompletedCount}</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Tabs defaultValue=\"overview\" value={activeTab} onValueChange={setActiveTab} id={`deal-tabs-${deal.id}`}>\r\n        <TabsList className=\"flex flex-wrap gap-2\">\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"term-sheet\">Term Sheets</TabsTrigger>\r\n          <TabsTrigger value=\"interests\">Interests</TabsTrigger>\r\n          <TabsTrigger value=\"data-room\">Data Room</TabsTrigger>\r\n          <TabsTrigger value=\"inventory\">Inventory</TabsTrigger>\r\n          <TabsTrigger value=\"members\">Members</TabsTrigger>\r\n          <TabsTrigger value=\"fees\">Fee Plans</TabsTrigger>\r\n          <TabsTrigger value=\"subscriptions\">Subscriptions</TabsTrigger>\r\n          <TabsTrigger value=\"documents\">Documents</TabsTrigger>\r\n          <TabsTrigger value=\"faq\">FAQ</TabsTrigger>\r\n          <TabsTrigger value=\"activity\">Activity</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\">\r\n          <DealOverviewTab\r\n            deal={deal}\r\n            memberships={deal.deal_memberships || []}\r\n            subscriptionsForJourney={subscriptionsForJourney}\r\n          />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"term-sheet\">\r\n          <DealTermSheetTab dealId={deal.id} termSheets={termSheets} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"interests\">\r\n          <DealInterestTab\r\n            dealId={deal.id}\r\n            interests={interests}\r\n            subscriptions={subscriptions}\r\n          />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"data-room\">\r\n          <DealDataRoomAccessTab\r\n            dealId={deal.id}\r\n            dealName={deal.name}\r\n            memberships={deal.deal_memberships || []}\r\n            accessRecords={dataRoomAccess}\r\n            documents={dataRoomDocuments}\r\n          />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"inventory\">\r\n          <DealInventoryTab dealId={deal.id} shareLots={shareLots} inventorySummary={inventorySummary} onRefresh={handleInventoryRefresh} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"members\">\r\n          <DealMembersTab dealId={deal.id} members={deal.deal_memberships || []} subscriptions={subscriptionsForJourney} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"fees\">\r\n          <DealFeePlansTab dealId={deal.id} feePlans={deal.fee_plans || []} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"subscriptions\">\r\n          <DealSubscriptionsTab dealId={deal.id} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"documents\">\r\n          <DealDocumentsTab dealId={deal.id} documents={documents} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"faq\">\r\n          <DealFaqTab dealId={deal.id} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"activity\">\r\n          <DealActivityTab dealId={deal.id} />\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Edit Deal Dialog */}\r\n      <Dialog open={editDialogOpen} onOpenChange={setEditDialogOpen}>\r\n        <DialogContent className=\"sm:max-w-3xl max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>Edit Deal</DialogTitle>\r\n            <DialogDescription>\r\n              Update deal information. Changes will be reflected immediately.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-6 py-4\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2 md:col-span-2\">\r\n                <Label htmlFor=\"edit-name\">Deal Name *</Label>\r\n                <Input\r\n                  id=\"edit-name\"\r\n                  value={editFormData.name}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, name: e.target.value })}\r\n                  placeholder=\"e.g., Revolut Secondary 2025\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-status\">Status</Label>\r\n                <Select\r\n                  value={editFormData.status}\r\n                  onValueChange={(value) => setEditFormData({ ...editFormData, status: value })}\r\n                >\r\n                  <SelectTrigger id=\"edit-status\">\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"draft\">Draft</SelectItem>\r\n                    <SelectItem value=\"open\">Open</SelectItem>\r\n                    <SelectItem value=\"allocation_pending\">Allocation Pending</SelectItem>\r\n                    <SelectItem value=\"closed\">Closed</SelectItem>\r\n                    <SelectItem value=\"cancelled\">Cancelled</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-deal-type\">Deal Type</Label>\r\n                <Select\r\n                  value={editFormData.deal_type}\r\n                  onValueChange={(value) => setEditFormData({ ...editFormData, deal_type: value })}\r\n                >\r\n                  <SelectTrigger id=\"edit-deal-type\">\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"equity_secondary\">Secondary</SelectItem>\r\n                    <SelectItem value=\"equity_primary\">Primary</SelectItem>\r\n                    <SelectItem value=\"credit_trade_finance\">Credit/Trade Finance</SelectItem>\r\n                    <SelectItem value=\"other\">Other</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-stock-type\">Stock Type</Label>\r\n                <Select\r\n                  value={editFormData.stock_type}\r\n                  onValueChange={(value) => setEditFormData({ ...editFormData, stock_type: value })}\r\n                >\r\n                  <SelectTrigger id=\"edit-stock-type\">\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"common\">Common/Ordinary Shares</SelectItem>\r\n                    <SelectItem value=\"preferred\">Preferred Shares</SelectItem>\r\n                    <SelectItem value=\"convertible\">Convertible Notes</SelectItem>\r\n                    <SelectItem value=\"warrant\">Warrants</SelectItem>\r\n                    <SelectItem value=\"bond\">Bonds</SelectItem>\r\n                    <SelectItem value=\"note\">Notes</SelectItem>\r\n                    <SelectItem value=\"other\">Other</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-company-name\">Company Name</Label>\r\n                <Input\r\n                  id=\"edit-company-name\"\r\n                  value={editFormData.company_name}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, company_name: e.target.value })}\r\n                  placeholder=\"e.g., Revolut Ltd\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-company-website\">Company Website</Label>\r\n                <Input\r\n                  id=\"edit-company-website\"\r\n                  type=\"url\"\r\n                  value={editFormData.company_website}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, company_website: e.target.value })}\r\n                  placeholder=\"https://...\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-sector\">Sector</Label>\r\n                <Input\r\n                  id=\"edit-sector\"\r\n                  value={editFormData.sector}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, sector: e.target.value })}\r\n                  placeholder=\"e.g., Fintech\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-stage\">Stage</Label>\r\n                <Input\r\n                  id=\"edit-stage\"\r\n                  value={editFormData.stage}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, stage: e.target.value })}\r\n                  placeholder=\"e.g., Series E\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-location\">Location</Label>\r\n                <Input\r\n                  id=\"edit-location\"\r\n                  value={editFormData.location}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, location: e.target.value })}\r\n                  placeholder=\"e.g., London, UK\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-currency\">Currency</Label>\r\n                <Select\r\n                  value={editFormData.currency}\r\n                  onValueChange={(value) => setEditFormData({ ...editFormData, currency: value })}\r\n                >\r\n                  <SelectTrigger id=\"edit-currency\">\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"USD\">USD</SelectItem>\r\n                    <SelectItem value=\"EUR\">EUR</SelectItem>\r\n                    <SelectItem value=\"GBP\">GBP</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-arranger\">Arranger (Mandate)</Label>\r\n                <Select\r\n                  value={editFormData.arranger_entity_id || 'none'}\r\n                  onValueChange={(value) => setEditFormData({ ...editFormData, arranger_entity_id: value === 'none' ? '' : value })}\r\n                >\r\n                  <SelectTrigger id=\"edit-arranger\">\r\n                    <SelectValue placeholder=\"Select arranger\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"none\">No Arranger</SelectItem>\r\n                    {arrangerEntities.map((arranger) => (\r\n                      <SelectItem key={arranger.id} value={arranger.id}>\r\n                        {arranger.company_name || arranger.legal_name}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Assign an arranger to manage this deal as their mandate\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-open-at\">Open Date</Label>\r\n                <Input\r\n                  id=\"edit-open-at\"\r\n                  type=\"datetime-local\"\r\n                  value={editFormData.open_at}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, open_at: e.target.value })}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-close-at\">Close Date</Label>\r\n                <Input\r\n                  id=\"edit-close-at\"\r\n                  type=\"datetime-local\"\r\n                  value={editFormData.close_at}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, close_at: e.target.value })}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"edit-target-amount\">Target Amount</Label>\r\n                <Input\r\n                  id=\"edit-target-amount\"\r\n                  type=\"number\"\r\n                  step=\"1\"\r\n                  value={editFormData.target_amount}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, target_amount: e.target.value })}\r\n                  placeholder=\"e.g., 5000000\"\r\n                />\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Investment terms (price, min/max) are set in the Term Sheet\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"space-y-2 md:col-span-2\">\r\n                <Label htmlFor=\"edit-description\">Description</Label>\r\n                <Textarea\r\n                  id=\"edit-description\"\r\n                  rows={3}\r\n                  value={editFormData.description}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, description: e.target.value })}\r\n                  placeholder=\"Brief description of the deal...\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2 md:col-span-2\">\r\n                <Label htmlFor=\"edit-investment-thesis\">Investment Thesis</Label>\r\n                <Textarea\r\n                  id=\"edit-investment-thesis\"\r\n                  rows={3}\r\n                  value={editFormData.investment_thesis}\r\n                  onChange={(e) => setEditFormData({ ...editFormData, investment_thesis: e.target.value })}\r\n                  placeholder=\"Why this is a good investment opportunity...\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex justify-end gap-2 pt-4\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => setEditDialogOpen(false)}\r\n                disabled={isSaving}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                onClick={handleSaveDeal}\r\n                disabled={isSaving || !editFormData.name}\r\n              >\r\n                {isSaving && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                Save Changes\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z',\n      key: '117uat',\n    },\n  ],\n  ['path', { d: 'M6 12h16', key: 's4cdu5' }],\n];\n\n/**\n * @component @name SendHorizontal\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMy43MTQgMy4wNDhhLjQ5OC40OTggMCAwIDAtLjY4My42MjdsMi44NDMgNy42MjdhMiAyIDAgMCAxIDAgMS4zOTZsLTIuODQyIDcuNjI3YS40OTguNDk4IDAgMCAwIC42ODIuNjI3bDE4LTguNWEuNS41IDAgMCAwIDAtLjkwNHoiIC8+CiAgPHBhdGggZD0iTTYgMTJoMTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/send-horizontal\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst SendHorizontal = createLucideIcon('send-horizontal', __iconNode);\n\nexport default SendHorizontal;\n"],"names":[],"mappings":"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","ignoreList":[19]}