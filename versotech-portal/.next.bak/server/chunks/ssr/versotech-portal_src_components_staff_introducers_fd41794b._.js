module.exports=[855798,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(289633);let e=(0,c.createContext)(void 0);function f({children:a}){let[f,g]=(0,c.useState)(!1),h=(0,d.useRouter)(),i=(0,c.useCallback)(()=>{h.refresh()},[h]);return(0,b.jsx)(e.Provider,{value:{open:f,setOpen:g,refresh:i},children:a})}function g(){let a=(0,c.useContext)(e);if(!a)throw Error("useAddIntroducer must be used within a AddIntroducerProvider");return a}a.s(["AddIntroducerProvider",()=>f,"useAddIntroducer",()=>g])},892926,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(289633),e=a.i(899750),f=a.i(497412),g=a.i(284169),h=a.i(15788),i=a.i(421908),j=a.i(663475),k=a.i(951870),l=a.i(167156),m=a.i(478870),n=a.i(155508),o=a.i(42329),p=a.i(405708),q=a.i(166457),r=a.i(487068),s=a.i(966494),t=a.i(405398),u=a.i(799373),v=a.i(816854),w=a.i(873785),x=a.i(703606),y=a.i(216316),z=a.i(283732),A=a.i(888987),B=a.i(201986),C=a.i(399580),D=a.i(855798),E=a.i(652412),F=a.i(470305),G=a.i(249464),H=a.i(191675),I=a.i(403205),J=a.i(838086),K=a.i(3321),L=a.i(58834);function M({open:a,onOpenChange:g,introducers:h,deals:l}){let[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useTransition)(),[y,z]=(0,c.useState)("none"),A=(0,d.useRouter)();(0,c.useEffect)(()=>{m?(async()=>{z("loading");try{let a=(0,L.createClient)(),b=new Date().toISOString().split("T")[0],{data:c,error:d}=await a.from("introducer_agreements").select("id, status, signed_date, expiry_date").eq("introducer_id",m).eq("status","active").not("signed_date","is",null).or(`expiry_date.is.null,expiry_date.gte.${b}`).limit(1);if(d){console.error("Error checking agreement:",d),z("invalid");return}c&&c.length>0?z("valid"):z("invalid")}catch(a){console.error("Error checking agreement:",a),z("invalid")}})():z("none")},[m]);let B=()=>{n(""),p(""),r(""),t(""),v(""),z("none")};return(0,b.jsx)(F.Dialog,{open:a,onOpenChange:a=>{g(a),a||B()},children:(0,b.jsxs)(F.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(F.DialogHeader,{children:[(0,b.jsx)(F.DialogTitle,{children:"Record Introduction"}),(0,b.jsx)(F.DialogDescription,{children:"Track a new referral from an introducer partner."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{children:"Introducer"}),(0,b.jsxs)(k.Select,{value:m,onValueChange:n,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select introducer"})}),(0,b.jsx)(k.SelectContent,{children:h.map(a=>(0,b.jsx)(k.SelectItem,{value:a.id,children:a.legalName},a.id))})]}),m&&"loading"===y&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-1",children:[(0,b.jsx)(K.Loader2,{className:"h-3 w-3 animate-spin"}),"Checking agreement status..."]}),m&&"valid"===y&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-600 mt-1",children:[(0,b.jsx)(C.CheckCircle2,{className:"h-3 w-3"}),"Valid signed agreement on file"]}),m&&"invalid"===y&&(0,b.jsxs)(I.Alert,{variant:"destructive",className:"mt-2",children:[(0,b.jsx)(J.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsxs)(I.AlertDescription,{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:"This introducer does not have a valid signed agreement."}),(0,b.jsx)(f.default,{href:`/versotech_main/introducers/${m}?tab=agreements`,className:"text-xs underline ml-2 whitespace-nowrap",children:"Create Agreement"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{htmlFor:"prospectEmail",children:"Prospect Email"}),(0,b.jsx)(j.Input,{id:"prospectEmail",type:"email",value:o,onChange:a=>p(a.target.value),placeholder:"prospect@example.com"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{children:"Deal"}),(0,b.jsxs)(k.Select,{value:q,onValueChange:r,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select deal"})}),(0,b.jsx)(k.SelectContent,{children:l.map(a=>(0,b.jsx)(k.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{htmlFor:"commissionOverride",children:"Commission Rate Override (bps, optional)"}),(0,b.jsx)(j.Input,{id:"commissionOverride",type:"number",min:0,max:300,value:s,onChange:a=>t(""===a.target.value?"":Number(a.target.value)),placeholder:"Leave empty to use introducer's default rate"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{htmlFor:"notes",children:"Notes"}),(0,b.jsx)(H.Textarea,{id:"notes",value:u,onChange:a=>v(a.target.value),placeholder:"Additional context about this introduction...",rows:3})]})]}),(0,b.jsxs)(F.DialogFooter,{children:[(0,b.jsx)(i.Button,{variant:"outline",onClick:()=>g(!1),disabled:w,children:"Cancel"}),(0,b.jsx)(i.Button,{onClick:()=>{x(async()=>{if(!m||""===m.trim())return void e.toast.error("Please select an introducer");if(!o.trim())return void e.toast.error("Prospect email is required");if(!q||""===q.trim())return void e.toast.error("Please select a deal");if(""!==s&&(0>Number(s)||Number(s)>300))return void e.toast.error("Commission override must be between 0 and 300 bps");try{let a={introducer_id:m,prospect_email:o.trim(),deal_id:q,commission_rate_override_bps:""===s?null:Number(s),notes:u.trim()||null},b=await fetch("/api/staff/introductions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok){let a,c=await b.text();try{a=JSON.parse(c)}catch(a){e.toast.error(`Failed to create introduction: ${c||"Unknown error"}`);return}a?.details?e.toast.error(`Validation failed: ${JSON.stringify(a.details.fieldErrors||a.details)}`):e.toast.error(a?.error??"Failed to create introduction");return}e.toast.success("Introduction recorded"),g(!1),B(),A.refresh()}catch(a){e.toast.error("Failed to create introduction")}})},disabled:w||"invalid"===y||"loading"===y,children:w?"Recording…":"Record Introduction"})]})]})})}function N({open:a,onOpenChange:f,introduction:g,introducers:h=[],deals:l=[]}){let[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useTransition)(),A=(0,d.useRouter)();return((0,c.useEffect)(()=>{g&&(n(g.introducerId||""),p(g.prospectEmail),r(g.dealId||""),t(g.status),v(g.commissionRateOverrideBps||""),x(g.notes||""))},[g]),g)?(0,b.jsx)(F.Dialog,{open:a,onOpenChange:f,children:(0,b.jsxs)(F.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(F.DialogHeader,{children:[(0,b.jsx)(F.DialogTitle,{children:"Edit Introduction"}),(0,b.jsx)(F.DialogDescription,{children:"Update introduction status and details."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{children:"Introducer"}),h.length>0?(0,b.jsxs)(k.Select,{value:m,onValueChange:n,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select introducer"})}),(0,b.jsx)(k.SelectContent,{children:h.map(a=>(0,b.jsx)(k.SelectItem,{value:a.id,children:a.legalName},a.id))})]}):(0,b.jsx)(j.Input,{value:g.introducerName,disabled:!0,className:"bg-muted"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{htmlFor:"prospectEmail",children:"Prospect Email"}),(0,b.jsx)(j.Input,{id:"prospectEmail",type:"email",value:o,onChange:a=>p(a.target.value),placeholder:"prospect@example.com"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{children:"Deal"}),l.length>0?(0,b.jsxs)(k.Select,{value:q,onValueChange:r,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select deal"})}),(0,b.jsx)(k.SelectContent,{children:l.map(a=>(0,b.jsx)(k.SelectItem,{value:a.id,children:a.name},a.id))})]}):(0,b.jsx)(j.Input,{value:g.dealName,disabled:!0,className:"bg-muted"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{children:"Status"}),(0,b.jsxs)(k.Select,{value:s,onValueChange:t,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select status"})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"invited",children:"Invited"}),(0,b.jsx)(k.SelectItem,{value:"joined",children:"Joined"}),(0,b.jsx)(k.SelectItem,{value:"allocated",children:"Allocated"}),(0,b.jsx)(k.SelectItem,{value:"lost",children:"Lost"}),(0,b.jsx)(k.SelectItem,{value:"inactive",children:"Inactive"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{htmlFor:"commissionOverride",children:"Commission Rate Override (bps, optional)"}),(0,b.jsx)(j.Input,{id:"commissionOverride",type:"number",min:0,max:300,value:u,onChange:a=>v(""===a.target.value?"":Number(a.target.value)),placeholder:"Leave empty to use introducer's default rate"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(G.Label,{htmlFor:"notes",children:"Notes"}),(0,b.jsx)(H.Textarea,{id:"notes",value:w,onChange:a=>x(a.target.value),placeholder:"Additional context about this introduction...",rows:3})]})]}),(0,b.jsxs)(F.DialogFooter,{className:"flex justify-between",children:[(0,b.jsx)(i.Button,{variant:"destructive",onClick:()=>{!g||confirm("Are you sure you want to delete this introduction? This action cannot be undone.")&&z(async()=>{try{let a=await fetch(`/api/staff/introductions/${g.id}`,{method:"DELETE"});if(!a.ok){let b=await a.json().catch(()=>null);e.toast.error(b?.error??"Failed to delete introduction");return}e.toast.success("Introduction deleted"),f(!1),A.refresh()}catch(a){e.toast.error("Failed to delete introduction")}})},disabled:y,children:"Delete"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(i.Button,{variant:"outline",onClick:()=>f(!1),disabled:y,children:"Cancel"}),(0,b.jsx)(i.Button,{onClick:()=>{g&&z(async()=>{if(!o.trim())return void e.toast.error("Prospect email is required");if(""!==u&&(0>Number(u)||Number(u)>300))return void e.toast.error("Commission override must be between 0 and 300 bps");try{let a={status:s,commission_rate_override_bps:""===u?null:Number(u),notes:w.trim()||null};m&&m!==g.introducerId&&(a.introducer_id=m),o.trim()!==g.prospectEmail&&(a.prospect_email=o.trim()),q&&q!==g.dealId&&(a.deal_id=q);let b=await fetch(`/api/staff/introductions/${g.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok){let a,c=await b.text();try{a=JSON.parse(c)}catch(a){e.toast.error(`Failed to update introduction: ${c||"Unknown error"}`);return}a?.details?e.toast.error(`Validation failed: ${JSON.stringify(a.details.fieldErrors||a.details)}`):e.toast.error(a?.error??"Failed to update introduction");return}e.toast.success("Introduction updated"),f(!1),A.refresh()}catch(a){e.toast.error("Failed to update introduction")}})},disabled:y,children:y?"Updating…":"Update Introduction"})]})]})]})}):null}var O=a.i(698004);let P=[{label:"All status",value:"all"},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"},{label:"Suspended",value:"suspended"}];function Q({summary:a,introducers:f,recentIntroductions:h,deals:s=[],isDemo:t=!1,showAddButtons:v=!0}){let w=(0,d.useRouter)(),[x,y]=(0,c.useState)(""),[A,C]=(0,c.useState)("all"),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!1),[L,Q]=(0,c.useState)(null),{setOpen:T}=(0,D.useAddIntroducer)(),[W,X]=(0,c.useState)(!1),[Y,Z]=(0,c.useState)(null),$=(0,c.useMemo)(()=>f.filter(a=>{let b="all"===A||a.status===A,c=!x||a.legalName.toLowerCase().includes(x.toLowerCase())||(a.contactName?.toLowerCase().includes(x.toLowerCase())??!1)||(a.email?.toLowerCase().includes(x.toLowerCase())??!1);return b&&c}),[f,A,x]);return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Introducer Management"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage introducer relationships, commissions, and performance tracking"})]}),v&&(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(i.Button,{variant:"outline",onClick:()=>K(!0),children:[(0,b.jsx)(u.UserPlus,{className:"h-4 w-4 mr-2"}),"Record Introduction"]}),(0,b.jsxs)(i.Button,{onClick:()=>T(!0),children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Add Introducer"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,b.jsx)(R,{icon:(0,b.jsx)(l.HandHeart,{className:"h-4 w-4"}),label:"Active Introducers",primary:a.activeIntroducers,secondary:`${a.totalIntroducers} total`}),(0,b.jsx)(R,{icon:(0,b.jsx)(m.Users,{className:"h-4 w-4"}),label:"Total Introductions",primary:a.totalIntroductions,secondary:`${a.totalAllocations} allocated`}),(0,b.jsx)(R,{icon:(0,b.jsx)(n.DollarSign,{className:"h-4 w-4"}),label:"Commissions Paid",primary:(0,B.formatCurrency)(a.totalCommissionPaid),secondary:"All-time"}),(0,b.jsx)(R,{icon:(0,b.jsx)(o.Clock,{className:"h-4 w-4"}),label:"Pending Commission",primary:(0,B.formatCurrency)(a.pendingCommission),secondary:"Awaiting payment",primaryClassName:"text-orange-500"})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Search & Filters"}),(0,b.jsx)(g.CardDescription,{children:"Narrow down introducers by status, performance, or keywords"})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(r.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(j.Input,{placeholder:"Search introducers, contacts, emails...",value:x,onChange:a=>y(a.target.value),className:"pl-10"})]})}),(0,b.jsxs)(k.Select,{value:A,onValueChange:C,children:[(0,b.jsx)(k.SelectTrigger,{className:"w-full md:w-48",children:(0,b.jsx)(k.SelectValue,{placeholder:"Filter status"})}),(0,b.jsx)(k.SelectContent,{children:P.map(a=>(0,b.jsx)(k.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),t&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(q.Filter,{className:"h-4 w-4"}),"Showing demo dataset. Re-run with a staff session to load live data."]})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Introducers"}),(0,b.jsx)(g.CardDescription,{children:"Performance summary for each introducer partner"})]}),(0,b.jsx)(g.CardContent,{className:"space-y-4",children:0===$.length?(0,b.jsx)(V,{message:x?"No introducers match your filters.":"No introducers available yet."}):$.map(a=>(0,b.jsx)(S,{introducer:a,onEdit:()=>G(a),onInvite:()=>Q(a),onCreateFeePlan:()=>{Z(a),X(!0)},onDispatchInvestor:()=>{e.toast.info(`To dispatch an investor through ${a.legalName}, go to a deal's Members tab and use "Add Participant"`)}},a.id))})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Recent Introductions"}),(0,b.jsx)(g.CardDescription,{children:"Latest introducer activity across deals"})]}),(0,b.jsx)(g.CardContent,{className:"space-y-4",children:0===h.length?(0,b.jsx)(V,{message:"No recent introductions "}):h.map(a=>(0,b.jsx)(U,{introduction:a,onEdit:()=>I(a)},a.id))})]}),(0,b.jsx)(E.EditIntroducerDialog,{open:!!F,onOpenChange:a=>!a&&G(null),introducer:F}),(0,b.jsx)(M,{open:J,onOpenChange:K,introducers:f.map(a=>({id:a.id,legalName:a.legalName})),deals:s}),(0,b.jsx)(N,{open:!!H,onOpenChange:a=>!a&&I(null),introduction:H,introducers:f.map(a=>({id:a.id,legalName:a.legalName})),deals:s}),L&&(0,b.jsx)(O.InviteUserDialog,{open:!!L,onOpenChange:a=>!a&&Q(null),entityType:"introducer",entityId:L.id,entityName:L.legalName}),(0,b.jsx)(z.default,{open:W,onClose:()=>{X(!1),Z(null)},onSuccess:()=>{X(!1),Z(null),e.toast.success("Fee plan created successfully"),w.refresh()}})]})}function R({icon:a,label:c,primary:d,secondary:e,primaryClassName:f}){return(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsxs)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[a,c]})}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:(0,A.cn)("text-2xl font-bold",f),children:d}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:e})]})]})}function S({introducer:a,onEdit:c,onInvite:d,onCreateFeePlan:e,onDispatchInvestor:g}){return(0,b.jsx)("div",{className:"border border-border rounded-lg p-4 bg-background/60 hover:bg-background/80 transition-colors",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-lg border border-primary/30 bg-primary/10 flex items-center justify-center",children:(0,b.jsx)(s.TrendingUp,{className:"h-6 w-6 text-primary"})}),(0,b.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.default,{href:`/versotech_main/introducers/${a.id}`,children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-foreground hover:text-primary transition-colors cursor-pointer",children:a.legalName})}),(0,b.jsxs)(y.DropdownMenu,{children:[(0,b.jsx)(y.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(i.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",children:(0,b.jsx)(x.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(y.DropdownMenuContent,{align:"start",children:[(0,b.jsx)(y.DropdownMenuLabel,{children:"Actions"}),(0,b.jsx)(y.DropdownMenuSeparator,{}),(0,b.jsxs)(y.DropdownMenuItem,{onClick:c,children:[(0,b.jsx)(t.Edit,{className:"mr-2 h-4 w-4"}),"Edit Introducer"]}),(0,b.jsxs)(y.DropdownMenuItem,{onClick:d,children:[(0,b.jsx)(u.UserPlus,{className:"mr-2 h-4 w-4"}),"Invite User"]}),(0,b.jsx)(y.DropdownMenuSeparator,{}),(0,b.jsxs)(y.DropdownMenuItem,{onClick:e,children:[(0,b.jsx)(v.FileText,{className:"mr-2 h-4 w-4"}),"Create Fee Plan"]}),(0,b.jsxs)(y.DropdownMenuItem,{onClick:g,children:[(0,b.jsx)(w.Send,{className:"mr-2 h-4 w-4"}),"Dispatch Investor"]})]})]})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.contactName||"No contact"," • ",a.email||"No email provided"]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground flex flex-wrap gap-2",children:[(0,b.jsxs)("span",{children:["Default commission: ",(0,B.formatBps)(a.defaultCommissionBps)]}),a.commissionCapAmount?(0,b.jsxs)("span",{children:["Cap: ",(0,B.formatCurrency)(a.commissionCapAmount)]}):null,a.paymentTerms?(0,b.jsxs)("span",{children:["Terms: ",a.paymentTerms]}):null]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-6",children:[(0,b.jsx)(T,{label:"Introductions",value:a.totalIntroductions}),(0,b.jsx)(T,{label:"Allocated",value:a.successfulAllocations}),a.feePlans&&(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-1 font-semibold tabular-nums",children:[(0,b.jsx)(v.FileText,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,b.jsxs)("span",{children:[a.feePlans.accepted,"/",a.feePlans.total]}),a.feePlans.accepted===a.feePlans.total&&a.feePlans.total>0&&(0,b.jsx)(C.CheckCircle2,{className:"h-3.5 w-3.5 text-green-400"}),a.feePlans.pending>0&&(0,b.jsx)(o.Clock,{className:"h-3.5 w-3.5 text-yellow-400"})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Fee Plans"})]}),(0,b.jsx)(T,{label:"Paid",value:(0,B.formatCurrency)(a.totalCommissionPaid)}),(0,b.jsx)(T,{label:"Pending",value:(0,B.formatCurrency)(a.pendingCommission),className:"text-orange-500"}),(0,b.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,b.jsx)(h.Badge,{className:(0,A.cn)("capitalize",{active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-yellow-100 text-yellow-800"}[a.status]??"bg-gray-100 text-foreground"),children:a.status}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Last intro: ",a.lastIntroductionAt?(0,B.formatDate)(a.lastIntroductionAt):"—"]})]})]})]})})}function T({label:a,value:c,className:d}){return(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:(0,A.cn)("font-semibold tabular-nums",d),children:c}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:a})]})}function U({introduction:a,onEdit:f}){let[g,h]=(0,c.useState)(a.status),[j,l]=(0,c.useTransition)(),m=(0,d.useRouter)();return(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 border border-border rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-foreground",children:a.prospectEmail}),(0,b.jsxs)(k.Select,{value:g,onValueChange:b=>{l(async()=>{try{if(!(await fetch(`/api/staff/introductions/${a.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})})).ok)return void e.toast.error("Failed to update introduction status");h(b),e.toast.success("Introduction status updated"),m.refresh()}catch(a){e.toast.error("Failed to update introduction status")}})},disabled:j,children:[(0,b.jsx)(k.SelectTrigger,{className:(0,A.cn)("w-32 h-7 text-xs capitalize",{allocated:"border-green-200 text-green-700",joined:"border-blue-200 text-blue-700",invited:"border-yellow-200 text-yellow-700",lost:"border-red-200 text-red-700",inactive:"border-gray-200 text-gray-700"}[g]??"border-gray-200 text-foreground"),children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"invited",children:"Invited"}),(0,b.jsx)(k.SelectItem,{value:"joined",children:"Joined"}),(0,b.jsx)(k.SelectItem,{value:"allocated",children:"Allocated"}),(0,b.jsx)(k.SelectItem,{value:"lost",children:"Lost"}),(0,b.jsx)(k.SelectItem,{value:"inactive",children:"Inactive"})]})]})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.introducerName," • ",a.dealName]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Introduced ",a.introducedAt?(0,B.formatDate)(a.introducedAt):"—"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:a.commissionAmount?(0,B.formatCurrency)(a.commissionAmount):"Commission TBD"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.commissionStatus?`Status: ${a.commissionStatus}`:"Awaiting accrual"})]}),(0,b.jsx)(i.Button,{variant:"outline",size:"sm",onClick:f,className:"h-8 w-8 p-0",children:(0,b.jsx)(t.Edit,{className:"h-4 w-4"})})]})]})}function V({message:a}){return(0,b.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,b.jsx)(s.TrendingUp,{className:"h-10 w-10 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a})]})}a.s(["IntroducersDashboard",()=>Q],892926)}];

//# sourceMappingURL=versotech-portal_src_components_staff_introducers_fd41794b._.js.map