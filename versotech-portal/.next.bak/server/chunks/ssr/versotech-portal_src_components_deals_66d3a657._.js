module.exports=[863133,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(663475),e=a.i(191675),f=a.i(421908),g=a.i(249464),h=a.i(266828),i=a.i(284169),j=a.i(3321),k=a.i(838086),l=a.i(966494),m=a.i(883236),n=a.i(951870),o=a.i(405708),p=a.i(278541),q=a.i(325866),r=a.i(899750),s=a.i(203002);function t({value:a,onChange:d}){let e,[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),[l,t]=(0,c.useState)(!1);(0,c.useEffect)(()=>{u()},[]);let u=async()=>{try{let a=await fetch("/api/investors/me/counterparty-entities");if(!a.ok)throw Error("Failed to load entities");let b=await a.json();i(b.entities||[])}catch(a){console.error("Error loading entities:",a),r.toast.error("Failed to load entities")}finally{k(!1)}},v=async()=>{t(!1),await u()},w=a=>({trust:"Trust",llc:"LLC",partnership:"Partnership",family_office:"Family Office",law_firm:"Law Firm",investment_bank:"Investment Bank",fund:"Fund",corporation:"Corporation",other:"Other"})[a]||a;return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(g.Label,{className:"text-base font-medium",children:"Investment Type"}),(0,b.jsxs)(m.RadioGroup,{value:a.subscription_type,onValueChange:b=>{d({subscription_type:b,counterparty_entity_id:"personal"===b?null:a.counterparty_entity_id})},className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3 rounded-lg border p-4 hover:bg-muted transition-colors",children:[(0,b.jsx)(m.RadioGroupItem,{value:"personal",id:"personal"}),(0,b.jsxs)(g.Label,{htmlFor:"personal",className:"flex-1 cursor-pointer",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(q.User,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"font-medium",children:"Invest Personally"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Subscribe using your personal investor profile"})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-3 rounded-lg border p-4 hover:bg-muted transition-colors",children:[(0,b.jsx)(m.RadioGroupItem,{value:"entity",id:"entity"}),(0,b.jsxs)(g.Label,{htmlFor:"entity",className:"flex-1 cursor-pointer",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.Building2,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"font-medium",children:"Invest Through Entity"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Subscribe through a legal entity (trust, LLC, partnership, etc.)"})]})]})]})]}),"entity"===a.subscription_type&&(0,b.jsxs)("div",{className:"space-y-3 pl-8 border-l-2 border-primary/20",children:[(0,b.jsx)(g.Label,{htmlFor:"entity-select",children:"Select Entity"}),j?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading entities..."}):0===h.length?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"You haven't added any entities yet. Create one to invest through a legal entity."}),(0,b.jsxs)(f.Button,{type:"button",variant:"outline",onClick:()=>t(!0),children:[(0,b.jsx)(o.Plus,{className:"w-4 h-4 mr-2"}),"Create Entity"]})]}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)(n.Select,{value:a.counterparty_entity_id||"",onValueChange:a=>{d({subscription_type:"entity",counterparty_entity_id:a})},children:[(0,b.jsx)(n.SelectTrigger,{id:"entity-select",className:"bg-background text-foreground border-border",children:(0,b.jsx)(n.SelectValue,{placeholder:"Select an entity"})}),(0,b.jsx)(n.SelectContent,{className:"bg-background text-foreground border-border",children:h.map(a=>(0,b.jsx)(n.SelectItem,{value:a.id,className:"text-foreground focus:bg-muted focus:text-foreground",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.legal_name}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground/70",children:["(",w(a.entity_type),")"]})]})},a.id))})]}),(0,b.jsxs)(f.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>t(!0),children:[(0,b.jsx)(o.Plus,{className:"w-4 h-4 mr-2"}),"Add New Entity"]}),a.counterparty_entity_id&&(0,b.jsx)("div",{className:"rounded-lg bg-muted border border-border p-3",children:(e=h.find(b=>b.id===a.counterparty_entity_id))?(0,b.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,b.jsx)("div",{className:"font-medium text-foreground",children:e.legal_name}),(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Type: ",w(e.entity_type)]}),e.jurisdiction&&(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Jurisdiction: ",e.jurisdiction]}),e.representative_name&&(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Representative: ",e.representative_name]})]}):null})]})]}),(0,b.jsx)(s.EntityFormDialog,{open:l,onClose:()=>t(!1),onSuccess:v})]})}var u=a.i(403205),v=a.i(778541);function w({dealId:a,currency:m,existingSubmission:n}){let[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(!1),[s,w]=(0,c.useState)(""),[x,y]=(0,c.useState)({subscription_type:"personal",counterparty_entity_id:null}),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!0);(0,c.useEffect)(()=>{!async function(){try{let b=await fetch(`/api/deals/${a}/capacity`);if(b.ok){let a=await b.json();G(a)}}catch(a){console.error("Failed to fetch deal capacity:",a)}finally{I(!1)}}()},[a]);let J=F?.target_raise?F.total_subscribed/F.target_raise*100:0,K=J>100;F?.target_raise&&(F.target_raise,F.total_subscribed);let L=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:m,minimumFractionDigits:0,maximumFractionDigits:0}).format(a),M=n&&"pending_review"===n.status,N=async b=>{if(b.preventDefault(),!M){A(!0),C(null),E(null);try{let b=parseFloat(o);if(!b||Number.isNaN(b)||b<=0){E("Enter a valid subscription amount."),A(!1);return}if("entity"===x.subscription_type&&!x.counterparty_entity_id){E("Please select an entity or create one to invest through an entity."),A(!1);return}let c=await fetch(`/api/deals/${a}/subscriptions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:{amount:b,currency:m,bank_confirmation:q,notes:s.trim()||null},subscription_type:x.subscription_type,counterparty_entity_id:x.counterparty_entity_id||null})}),d=await c.json();if(!c.ok)throw Error(d.error||"Failed to submit subscription");C("Subscription submitted for review. The VERSO team will follow up shortly."),p(""),r(!1),w("")}catch(a){E(a instanceof Error?a.message:"Unexpected error submitting subscription")}finally{A(!1)}}};if(M){let a=n?.submitted_at?new Date(n.submitted_at).toLocaleString():"Recently";return(0,b.jsx)(i.Card,{className:"border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20",children:(0,b.jsxs)(i.CardContent,{className:"py-4 text-sm text-muted-foreground space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-amber-700 dark:text-amber-300",children:[(0,b.jsx)(j.Loader2,{className:"h-4 w-4 animate-spin"}),"Subscription under review"]}),(0,b.jsxs)("p",{children:["Submitted on ",a,". The VERSO team is reviewing your request."]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"You'll be notified once a decision is made. Contact your relationship manager if you need to make urgent changes."})]})})}let O=parseFloat(o),P=[];return!isNaN(O)&&O>0&&(F?.min_ticket&&O<F.min_ticket&&P.push(`Below minimum investment of ${L(F.min_ticket)}`),F?.max_ticket&&O>F.max_ticket&&P.push(`Above maximum investment of ${L(F.max_ticket)}`)),(0,b.jsxs)("form",{onSubmit:N,className:"space-y-5",children:[!H&&F&&F.target_raise&&(0,b.jsx)(i.Card,{className:K?"border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20":"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20",children:(0,b.jsx)(i.CardContent,{className:"pt-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Deal Progress"}),(0,b.jsxs)("span",{className:"text-sm font-bold text-foreground",children:[J.toFixed(1),"% subscribed"]})]}),(0,b.jsx)(v.Progress,{value:Math.min(J,100),className:K?"bg-orange-200 dark:bg-orange-800":"bg-blue-200 dark:bg-blue-800"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,b.jsxs)("span",{children:[L(F.total_subscribed)," committed"]}),(0,b.jsxs)("span",{children:["Target: ",L(F.target_raise)]})]}),K&&(0,b.jsxs)(u.Alert,{className:"border-orange-300 bg-orange-100",children:[(0,b.jsx)(l.TrendingUp,{className:"h-4 w-4"}),(0,b.jsxs)(u.AlertDescription,{className:"text-xs",children:["This deal is oversubscribed by ",(J-100).toFixed(1),"%. You can still submit your interest, but allocation is not guaranteed."]})]}),F.min_ticket&&F.max_ticket&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground pt-1 border-t border-border",children:["Investment range: ",L(F.min_ticket)," - ",L(F.max_ticket)]})]})})}),(0,b.jsx)(t,{value:x,onChange:y}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:`subscription-amount-${a}`,className:"text-base font-semibold",children:["Subscription Amount (",m,")"]}),(0,b.jsx)(d.Input,{id:`subscription-amount-${a}`,type:"number",min:"0",step:"0.01",value:o,onChange:a=>p(a.target.value),placeholder:"e.g. 250000",className:"text-foreground text-lg h-12"}),P.length>0&&(0,b.jsxs)(u.Alert,{className:"mt-2 border-yellow-300 bg-yellow-50",children:[(0,b.jsx)(k.AlertTriangle,{className:"h-4 w-4 text-yellow-600"}),(0,b.jsxs)(u.AlertDescription,{className:"text-xs text-yellow-800",children:[P.join(". "),". You may still submit, but staff review is required."]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{className:"text-base font-semibold",children:"Bank & Compliance"}),(0,b.jsxs)("div",{className:"flex items-start space-x-3 rounded-md border-2 border-border px-4 py-3 bg-muted",children:[(0,b.jsx)(h.Checkbox,{id:`bank-confirmation-${a}`,checked:q,onCheckedChange:a=>r(!!a),className:"mt-0.5"}),(0,b.jsx)(g.Label,{htmlFor:`bank-confirmation-${a}`,className:"text-sm text-foreground font-normal cursor-pointer leading-relaxed",children:"I confirm my bank/KYC documentation is ready for the subscription pack."})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:`subscription-notes-${a}`,className:"text-base font-semibold",children:"Additional Notes (optional)"}),(0,b.jsx)(e.Textarea,{id:`subscription-notes-${a}`,value:s,onChange:a=>w(a.target.value),rows:3,placeholder:"Share wiring preferences, co-investor details, or other information for the VERSO team.",className:"text-foreground"})]}),D&&(0,b.jsx)("div",{className:"text-sm text-red-600 font-medium bg-red-50 p-3 rounded-md border border-red-200",children:D}),B&&(0,b.jsx)("div",{className:"text-sm text-emerald-600 font-medium bg-emerald-50 p-3 rounded-md border border-emerald-200",children:B}),(0,b.jsxs)(f.Button,{type:"submit",disabled:z,className:"w-full h-14 text-lg font-bold bg-blue-600 hover:bg-blue-700 text-white gap-2 shadow-md",children:[z&&(0,b.jsx)(j.Loader2,{className:"h-5 w-5 animate-spin"}),"Submit Subscription Request"]})]})}a.s(["SubmitSubscriptionForm",()=>w],863133)},172793,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(470305),e=a.i(421908),f=a.i(663475),g=a.i(249464),h=a.i(191675),i=a.i(403205),j=a.i(3321),k=a.i(399580),l=a.i(674875);function m({dealId:a,dealName:m,currency:n,investorId:o,defaultAmount:p,isClosed:q=!1,onSubmitted:r,children:s}){let[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(p?p.toString():""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!1),F=(0,c.useCallback)(()=>{w(p?p.toString():""),y(""),A(!1),C(null),E(!1)},[p]),G=a=>{u(a),a||F()},H=async b=>{b.preventDefault(),A(!0),C(null);try{let b=v.trim(),c={investor_id:o,notes:x.trim()||void 0};if(b){let a=Number(b.replace(/[^0-9.]/g,""));if(Number.isFinite(a)&&a>0)c.indicative_amount=a,n&&(c.indicative_currency=n);else throw Error("Enter a valid indicative amount or leave the field blank.")}q&&(c.is_post_close=!0);let d=await fetch(`/api/deals/${a}/interests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok){let a=await d.json().catch(()=>({}));throw Error(a?.error||"Unable to submit interest right now.")}E(!0),r&&await r(),setTimeout(()=>{u(!1),F()},1500)}catch(a){C(a instanceof Error?a.message:"Unexpected error")}finally{A(!1)}};return(0,b.jsxs)(d.Dialog,{open:t,onOpenChange:G,children:[(0,b.jsx)(d.DialogTrigger,{asChild:!0,children:s}),(0,b.jsxs)(d.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(d.DialogHeader,{children:[(0,b.jsxs)(d.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Sparkles,{className:"h-5 w-5 text-blue-600"}),q?"Notify Me About Similar Deals":"Submit Interest for Data Room"]}),(0,b.jsx)(d.DialogDescription,{children:q?`Let the VERSO team know you're interested in similar opportunities to ${m}. We'll notify you when comparable deals become available.`:`Submit your interest to access the data room for ${m}. Once approved, you'll receive the NDA to sign.`})]}),D?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 text-center",children:[(0,b.jsx)(k.CheckCircle2,{className:"h-12 w-12 text-green-500 mb-4"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-green-700",children:"Interest submitted"}),(0,b.jsx)("p",{className:"text-sm text-green-600",children:"We'll notify you as soon as the team responds."})]}):(0,b.jsxs)("form",{className:"space-y-5",onSubmit:H,children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"indicative-amount",children:"Indicative amount or range"}),(0,b.jsx)(f.Input,{id:"indicative-amount",placeholder:`e.g. ${n??""} 250k`,value:v,onChange:a=>w(a.target.value),inputMode:"decimal"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Optional â€” helps the team size the allocation. You can share a single number or range."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"interest-notes",children:"Notes for the team"}),(0,b.jsx)(h.Textarea,{id:"interest-notes",placeholder:"Add any context or questions you'd like the team to review.",value:x,onChange:a=>y(a.target.value),rows:4})]}),B&&(0,b.jsx)(i.Alert,{variant:"destructive",children:(0,b.jsx)(i.AlertDescription,{children:B})}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>G(!1),disabled:z,children:"Cancel"}),(0,b.jsx)(e.Button,{type:"submit",disabled:z,children:z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Loader2,{className:"h-4 w-4 animate-spin mr-2"}),"Sending"]}):"Submit interest"})]})]})]})]})}a.s(["InterestModal",()=>m])},509616,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(470305),e=a.i(863133),f=a.i(871057);function g({dealId:a,dealName:g,currency:h,children:i,existingSubmission:j}){let[k,l]=(0,c.useState)(!1),m=j?{id:j.id,status:j.status,submitted_at:j.submitted_at,payload_json:{}}:null;return(0,b.jsxs)(d.Dialog,{open:k,onOpenChange:l,children:[(0,b.jsx)(d.DialogTrigger,{asChild:!0,children:i}),(0,b.jsxs)(d.DialogContent,{className:"max-w-xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(d.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-emerald-100",children:(0,b.jsx)(f.Briefcase,{className:"h-5 w-5 text-emerald-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(d.DialogTitle,{className:"text-xl",children:"Subscribe to Investment Opportunity"}),(0,b.jsxs)(d.DialogDescription,{children:["Submit a subscription request for ",g,". The team will review it before sending the NDA and subscription documents.",(0,b.jsx)("span",{className:"block mt-1 text-amber-600 dark:text-amber-400 text-xs",children:"Note: This request does not include data room access."})]})]})]})}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(e.SubmitSubscriptionForm,{dealId:a,currency:h,existingSubmission:m})})]})]})}a.s(["SubscribeNowDialog",()=>g])}];

//# sourceMappingURL=versotech-portal_src_components_deals_66d3a657._.js.map