module.exports=[567516,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(289633),e=a.i(771088),f=a.i(421908),g=a.i(15788),h=a.i(105874),i=a.i(663475),j=a.i(284169),k=a.i(623157),l=a.i(723603),m=a.i(211374),n=a.i(877028),o=a.i(926076),p=a.i(168118),q=a.i(672606),r=a.i(487068),s=a.i(823879),t=a.i(696661),u=a.i(168405),v=a.i(166457),w=a.i(278541),x=a.i(478870),y=a.i(504839),z=a.i(13289),A=a.i(318525),B=a.i(203422),C=a.i(497412),D=a.i(888987);let E=[{value:"investor",label:"Investor"},{value:"partner",label:"Partner"},{value:"lawyer",label:"Law Firm"},{value:"commercial_partner",label:"Commercial Partner"},{value:"introducer",label:"Introducer"},{value:"arranger",label:"Arranger"}],F={investor:w.Building2,partner:x.Users,lawyer:y.Scale,commercial_partner:z.Handshake,introducer:A.Globe,arranger:B.Landmark},G={investor:"Investor",partner:"Partner",lawyer:"Law Firm",commercial_partner:"Commercial Partner",introducer:"Introducer",arranger:"Arranger"};function H({title:a,options:d,selected:e,onSelect:h,className:i}){let[j,m]=(0,c.useState)(!1);return(0,b.jsxs)(k.Popover,{open:j,onOpenChange:m,children:[(0,b.jsx)(k.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:(0,D.cn)("h-9 border-dashed",e.length>0&&"border-primary",i),children:[(0,b.jsx)(v.Filter,{className:"mr-2 h-4 w-4"}),a,e.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Separator,{orientation:"vertical",className:"mx-2 h-4"}),(0,b.jsx)(g.Badge,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:e.length})]}),(0,b.jsx)(u.ChevronsUpDown,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,b.jsx)(k.PopoverContent,{className:"w-52 p-0",align:"start",children:(0,b.jsxs)(l.Command,{children:[(0,b.jsx)(l.CommandInput,{placeholder:`Search ${a.toLowerCase()}...`}),(0,b.jsxs)(l.CommandList,{children:[(0,b.jsx)(l.CommandEmpty,{children:"No results found."}),(0,b.jsx)(l.CommandGroup,{children:d.map(a=>{let c=e.includes(a.value);return(0,b.jsxs)(l.CommandItem,{onSelect:()=>{var b;return b=a.value,void(e.includes(b)?h(e.filter(a=>a!==b)):h([...e,b]))},children:[(0,b.jsx)("div",{className:(0,D.cn)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",c?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:(0,b.jsx)(t.Check,{className:"h-3 w-3"})}),(0,b.jsx)("span",{children:a.label})]},a.value)})}),e.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.CommandSeparator,{}),(0,b.jsx)(l.CommandGroup,{children:(0,b.jsx)(l.CommandItem,{onSelect:()=>{h([]),m(!1)},className:"justify-center text-center",children:"Clear selection"})})]})]})]})})]})}function I(){return(0,b.jsx)("div",{className:"space-y-4",children:Array.from({length:5}).map((a,c)=>(0,b.jsx)(j.Card,{children:(0,b.jsx)(j.CardHeader,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(m.Skeleton,{className:"h-10 w-10 rounded-full"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Skeleton,{className:"h-5 w-48"}),(0,b.jsx)(m.Skeleton,{className:"h-4 w-24"})]})]})})},c))})}function J(){return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[(0,b.jsx)("div",{className:"rounded-full bg-muted p-4 mb-4",children:(0,b.jsx)(w.Building2,{className:"h-8 w-8 text-muted-foreground"})}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-1",children:"No entities found"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground text-center max-w-sm",children:"No entities match the current filters. Try adjusting your search or filter criteria."})]})}function K({entity:a}){let[d,i]=(0,c.useState)(!1),k=F[a.type];return(0,b.jsx)(o.Collapsible,{open:d,onOpenChange:i,children:(0,b.jsxs)(j.Card,{className:"overflow-hidden",children:[(0,b.jsx)(o.CollapsibleTrigger,{asChild:!0,children:(0,b.jsx)(j.CardHeader,{className:"py-4 cursor-pointer hover:bg-muted/50 transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex items-center justify-center h-10 w-10 rounded-full bg-muted",children:(0,b.jsx)(k,{className:"h-5 w-5 text-muted-foreground"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.CardTitle,{className:"text-base font-medium",children:a.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:G[a.type]}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[a.users.length," ",1===a.users.length?"user":"users"]})]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:d?(0,b.jsx)(p.ChevronDown,{className:"h-5 w-5 text-muted-foreground"}):(0,b.jsx)(q.ChevronRight,{className:"h-5 w-5 text-muted-foreground"})})]})})}),(0,b.jsx)(o.CollapsibleContent,{children:(0,b.jsx)(j.CardContent,{className:"pt-0 pb-4",children:(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(e.Table,{children:[(0,b.jsx)(e.TableHeader,{children:(0,b.jsxs)(e.TableRow,{children:[(0,b.jsx)(e.TableHead,{children:"User"}),(0,b.jsx)(e.TableHead,{children:"Email"}),(0,b.jsx)(e.TableHead,{children:"Role"}),(0,b.jsx)(e.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(e.TableBody,{children:a.users.map(a=>(0,b.jsxs)(e.TableRow,{children:[(0,b.jsx)(e.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(h.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(h.AvatarImage,{src:a.avatarUrl||void 0,alt:a.displayName}),(0,b.jsx)(h.AvatarFallback,{className:"text-xs",children:a.displayName.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2)})]}),(0,b.jsx)(C.default,{href:`/versotech_admin/users/${a.id}`,className:"font-medium hover:underline",children:a.displayName})]})}),(0,b.jsx)(e.TableCell,{className:"text-muted-foreground",children:a.email}),(0,b.jsx)(e.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Badge,{variant:a.isPrimary?"default":"secondary",children:a.isPrimary?"Primary":"Member"}),a.canSign&&(0,b.jsx)(g.Badge,{variant:"outline",children:"Can Sign"})]})}),(0,b.jsx)(e.TableCell,{className:"text-right",children:(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsx)(C.default,{href:`/versotech_admin/users/${a.id}`,children:"View"})})})]},a.id))})]})})})})]})})}function L(){let a=(0,d.useRouter)(),e=(0,d.usePathname)(),h=(0,d.useSearchParams)(),[k,l]=(0,c.useState)(h.get("search")||""),[m,n]=(0,c.useState)(h.get("type")?.split(",").filter(Boolean)||[]),[o,p]=(0,c.useState)([]),[q,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(null),w=function(a,b){let[d,e]=(0,c.useState)(a);return(0,c.useEffect)(()=>{let b=setTimeout(()=>{e(a)},300);return()=>{clearTimeout(b)}},[a,300]),d}(k,0),x=w.length>0||m.length>0,y=(0,c.useCallback)(b=>{let c=new URLSearchParams(h.toString());void 0!==b.search&&(b.search?c.set("search",b.search):c.delete("search")),void 0!==b.type&&(b.type.length>0?c.set("type",b.type.join(",")):c.delete("type"));let d=c.toString();a.push(`${e}${d?`?${d}`:""}`)},[e,a,h]),z=(0,c.useCallback)(async()=>{try{t(!0),v(null);let a=new URLSearchParams;w&&a.set("search",w),m.length>0&&a.set("type",m.join(","));let b=await fetch(`/api/admin/entities/users?${a}`),c=await b.json();if(!c.success)throw Error(c.error||"Failed to fetch entities");p(c.data||[])}catch(a){v(a instanceof Error?a.message:"An error occurred")}finally{t(!1)}},[w,m]);(0,c.useEffect)(()=>{z(),y({search:w,type:m})},[w,m]);let A={totalEntities:o.length,totalUsers:o.reduce((a,b)=>a+b.users.length,0),byType:E.map(a=>({type:a.value,label:a.label,count:o.filter(b=>b.type===a.value).length})).filter(a=>a.count>0)};return u?(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4",children:[(0,b.jsx)("h3",{className:"font-medium text-destructive",children:"Error loading entities"}),(0,b.jsx)("p",{className:"text-sm text-destructive/80 mt-1",children:u}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>z(),children:"Try Again"})]})}):(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Users by Entity"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"View users grouped by their entity associations"})]})}),!q&&o.length>0&&(0,b.jsxs)("div",{className:"grid gap-4 grid-cols-2 md:grid-cols-4",children:[(0,b.jsx)(j.Card,{children:(0,b.jsxs)(j.CardContent,{className:"pt-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Entities"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:A.totalEntities})]})}),(0,b.jsx)(j.Card,{children:(0,b.jsxs)(j.CardContent,{className:"pt-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Users"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:A.totalUsers})]})}),A.byType.slice(0,2).map(a=>(0,b.jsx)(j.Card,{children:(0,b.jsxs)(j.CardContent,{className:"pt-4",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.label,"s"]}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:a.count})]})},a.type))]}),(0,b.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,b.jsx)(r.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(i.Input,{placeholder:"Search entities or users...",value:k,onChange:a=>l(a.target.value),className:"pl-9 h-9"}),k&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0",onClick:()=>l(""),children:(0,b.jsx)(s.X,{className:"h-4 w-4"})})]}),(0,b.jsx)(H,{title:"Entity Type",options:E,selected:m,onSelect:n})]}),x&&(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:()=>{l(""),n([])},className:"h-9",children:[(0,b.jsx)(s.X,{className:"mr-2 h-4 w-4"}),"Clear filters"]})]}),x&&(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),w&&(0,b.jsxs)(g.Badge,{variant:"secondary",className:"rounded-sm px-2 py-1",children:['Search: "',w,'"',(0,b.jsx)("button",{className:"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20",onClick:()=>l(""),children:(0,b.jsx)(s.X,{className:"h-3 w-3"})})]}),m.map(a=>(0,b.jsxs)(g.Badge,{variant:"secondary",className:"rounded-sm px-2 py-1",children:["Type: ",E.find(b=>b.value===a)?.label||a,(0,b.jsx)("button",{className:"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20",onClick:()=>n(m.filter(b=>b!==a)),children:(0,b.jsx)(s.X,{className:"h-3 w-3"})})]},a))]}),q?(0,b.jsx)(I,{}):0===o.length?(0,b.jsx)(J,{}):(0,b.jsxs)("div",{className:"space-y-4",children:[o.map(a=>(0,b.jsx)(K,{entity:a},`${a.type}-${a.id}`)),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground text-center pt-4",children:["Showing ",o.length," ",1===o.length?"entity":"entities"," with ",A.totalUsers," linked users"]})]})]})}a.s(["default",()=>L])}];

//# sourceMappingURL=c6ad4_src_app_%28admin%29_versotech_admin_users_entities_page_tsx_cd072472._.js.map