{"version":3,"sources":["../../../../../versotech-portal/src/components/deals/deals-list-client.tsx/__nextjs-internal-proxy.mjs","../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/deals/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DealsListClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call DealsListClient() from the server but DealsListClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/components/deals/deals-list-client.tsx\",\n    \"DealsListClient\",\n);\n","import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { createServiceClient } from '@/lib/supabase/server'\r\nimport Link from 'next/link'\r\nimport {\r\n  Plus,\r\n  TrendingUp,\r\n  DollarSign,\r\n  Users,\r\n  Clock,\r\n  BarChart3,\r\n  Building2,\r\n  Handshake,\r\n  AlertCircle,\r\n  CheckCircle2,\r\n  Timer,\r\n  CircleDollarSign\r\n} from 'lucide-react'\r\nimport { DealsListClient } from '@/components/deals/deals-list-client'\r\n\r\nexport const dynamic = 'force-dynamic'\r\n\r\ninterface Deal {\r\n  id: string\r\n  name: string\r\n  deal_type: string\r\n  status: string\r\n  currency: string\r\n  offer_unit_price: number | null\r\n  created_at: string\r\n  vehicles?: {\r\n    name: string\r\n    type: string\r\n  }\r\n  deal_memberships: any[]\r\n  _inventory_summary?: {\r\n    total_units: number\r\n    available_units: number\r\n    reserved_units: number\r\n    allocated_units: number\r\n  }\r\n}\r\n\r\nconst dealTypeLabels = {\r\n  equity_secondary: 'Secondary',\r\n  equity_primary: 'Primary',\r\n  credit_trade_finance: 'Credit/Trade',\r\n  other: 'Other'\r\n}\r\n\r\nconst statusColors = {\r\n  draft: 'bg-white/10 text-foreground border border-white/20',\r\n  open: 'bg-emerald-500/20 text-emerald-200 border border-emerald-400/30',\r\n  allocation_pending: 'bg-amber-500/15 text-amber-200 border border-amber-400/30',\r\n  closed: 'bg-blue-500/20 text-blue-200 border border-blue-400/30',\r\n  cancelled: 'bg-red-500/20 text-red-200 border border-red-400/30'\r\n}\r\n\r\nexport default async function DealsPage() {\r\n  // Use service client to bypass RLS for staff users\r\n  const supabase = createServiceClient()\r\n\r\n  // Fetch deals data\r\n  const { data: deals, error } = await supabase\r\n    .from('deals')\r\n    .select(`\r\n      *,\r\n      vehicles (\r\n        name,\r\n        type\r\n      ),\r\n      deal_memberships (\r\n        user_id,\r\n        role\r\n      )\r\n    `)\r\n    .order('created_at', { ascending: false })\r\n\r\n  const dealsData: Deal[] = deals || []\r\n\r\n  // Calculate summary statistics\r\n  const summary = {\r\n    total: dealsData.length,\r\n    open: dealsData.filter(d => d.status === 'open').length,\r\n    draft: dealsData.filter(d => d.status === 'draft').length,\r\n    closed: dealsData.filter(d => d.status === 'closed').length,\r\n    totalValue: dealsData.reduce((sum, deal) => {\r\n      const price = deal.offer_unit_price || 0\r\n      return sum + price * 1000 // Approximate based on typical deal sizes\r\n    }, 0)\r\n  }\r\n\r\n  return (\r\n    <DealsListClient deals={dealsData} summary={summary} />\r\n    )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":[],"mappings":"saAEO,IAAM,EAAkB,CAAA,EAAA,AAD/B,EAAA,CAAA,CAAA,QAC+B,uBAAA,AAAuB,EAClD,WAAa,MAAM,AAAI,MAAM,4OAA8O,EAC3Q,4FACA,2EAHG,IAAM,EAAkB,CAAA,EAD/B,AAC+B,EAD/B,CAAA,CAAA,QAC+B,uBAAA,AAAuB,EAClD,WAAa,MAAM,AAAI,MAAM,4OAA8O,EAC3Q,wEACA,2HCFJ,EAAA,EAAA,CAAA,CAAA,QAgBA,EAAA,EAAA,CAAA,CAAA,OAwCe,eAAe,IAE5B,IAAM,EAAW,CAAA,EAAA,EAAA,mBAAA,AAAmB,IAG9B,CAAE,KAAM,CAAK,OAAE,CAAK,CAAE,CAAG,MAAM,EAClC,IAAI,CAAC,SACL,MAAM,CAAC,CAAC;;;;;;;;;;IAUT,CAAC,EACA,KAAK,CAAC,aAAc,CAAE,WAAW,CAAM,GAEpC,EAAoB,GAAS,EAAE,CAG/B,EAAU,CACd,MAAO,EAAU,MAAM,CACvB,KAAM,EAAU,MAAM,CAAC,GAAkB,SAAb,EAAE,MAAM,EAAa,MAAM,CACvD,MAAO,EAAU,MAAM,CAAC,GAAK,AAAa,YAAX,MAAM,EAAc,MAAM,CACzD,OAAQ,EAAU,MAAM,CAAC,GAAkB,WAAb,EAAE,MAAM,EAAe,MAAM,CAC3D,WAAY,EAAU,MAAM,CAAC,CAAC,EAAK,IAE1B,EAAM,AAAQ,KAAK,AADZ,EAAK,gBAAgB,EAAI,GAEtC,EACL,EAEA,MACE,CAAA,EAAA,EAAA,GAAA,CALsE,CAKrE,EAAA,eAAe,CAAA,CAAC,MAAO,EAAW,QAAS,GAEhD,kCA3EuB","ignoreList":[0]}