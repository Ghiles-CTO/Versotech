{"version":3,"sources":["../../../../../versotech-portal/src/components/documents/categorized-documents-client.tsx","../../../../../versotech-portal/src/types/documents.ts","../../../../../versotech-portal/src/components/documents/document-filters.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useMemo, useState } from 'react'\r\nimport Image from 'next/image'\r\nimport { Document, Vehicle, DocumentFilters } from '@/types/documents'\r\nimport { DocumentCard } from './document-card'\r\nimport { DocumentFiltersComponent } from './document-filters'\r\nimport { useDocumentViewer } from '@/hooks/useDocumentViewer'\r\nimport { DocumentViewerFullscreen } from './DocumentViewerFullscreen'\r\nimport { Card, CardContent } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  ArrowLeft,\r\n  BarChart3,\r\n  Building2,\r\n  ChevronDown,\r\n  ChevronRight,\r\n  FileCheck,\r\n  FileText,\r\n  Folder,\r\n  FolderOpen,\r\n  Home,\r\n  Lock,\r\n  Shield,\r\n  Briefcase\r\n} from 'lucide-react'\r\n\r\ninterface CategorizedDocumentsClientProps {\r\n  initialDocuments: Document[]\r\n  vehicles: Vehicle[]\r\n}\r\n\r\n// Document category configuration (excluding KYC - that stays in Profile)\r\nconst DOCUMENT_CATEGORIES = {\r\n  agreements: {\r\n    id: 'agreements',\r\n    name: 'Agreements',\r\n    icon: FileCheck,\r\n    color: 'blue',\r\n    description: 'Subscription agreements, LPAs, side letters',\r\n    types: ['Subscription', 'Agreement', 'subscription', 'agreement', 'subscription_pack', 'subscription_draft']\r\n  },\r\n  statements: {\r\n    id: 'statements',\r\n    name: 'Statements',\r\n    icon: BarChart3,\r\n    color: 'purple',\r\n    description: 'Position statements, capital calls, distributions',\r\n    types: ['Statement', 'statement', 'capital_call']\r\n  },\r\n  ndas: {\r\n    id: 'ndas',\r\n    name: 'NDAs',\r\n    icon: Lock,\r\n    color: 'amber',\r\n    description: 'Non-disclosure agreements',\r\n    types: ['NDA', 'nda']\r\n  },\r\n  reports: {\r\n    id: 'reports',\r\n    name: 'Reports & Tax',\r\n    icon: FileText,\r\n    color: 'indigo',\r\n    description: 'Performance reports, tax packs, investor letters',\r\n    types: ['Report', 'report', 'Tax', 'tax', 'memo']\r\n  }\r\n}\r\n\r\ntype CategoryId = keyof typeof DOCUMENT_CATEGORIES\r\n\r\ntype HoldingWithCategories = {\r\n  id: string\r\n  name: string\r\n  type: string | null\r\n  vehicle: Document['scope']['vehicle']\r\n  categories: Record<CategoryId, Document[]>\r\n  totalDocuments: number\r\n}\r\n\r\nfunction getCategoryForDocumentType(type: string): CategoryId | null {\r\n  for (const [categoryId, category] of Object.entries(DOCUMENT_CATEGORIES)) {\r\n    if (category.types.includes(type)) {\r\n      return categoryId as CategoryId\r\n    }\r\n  }\r\n  return 'reports' // Default to reports for unknown types\r\n}\r\n\r\nfunction getCategoryColor(color: string) {\r\n  const colors = {\r\n    blue: 'bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-700',\r\n    purple: 'bg-purple-100 dark:bg-purple-900/40 text-purple-700 dark:text-purple-300 border-purple-200 dark:border-purple-700',\r\n    amber: 'bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300 border-amber-200 dark:border-amber-700',\r\n    indigo: 'bg-indigo-100 dark:bg-indigo-900/40 text-indigo-700 dark:text-indigo-300 border-indigo-200 dark:border-indigo-700'\r\n  }\r\n  return colors[color as keyof typeof colors] || colors.blue\r\n}\r\n\r\nfunction getCategoryIconColor(color: string) {\r\n  const colors = {\r\n    blue: 'text-blue-600 dark:text-blue-400',\r\n    purple: 'text-purple-600 dark:text-purple-400',\r\n    amber: 'text-amber-600 dark:text-amber-400',\r\n    indigo: 'text-indigo-600 dark:text-indigo-400'\r\n  }\r\n  return colors[color as keyof typeof colors] || colors.blue\r\n}\r\n\r\nexport function CategorizedDocumentsClient({\r\n  initialDocuments,\r\n  vehicles\r\n}: CategorizedDocumentsClientProps) {\r\n  const [selectedHolding, setSelectedHolding] = useState<string | null>(null)\r\n  const [expandedCategories, setExpandedCategories] = useState<Set<string>>(new Set())\r\n  const [filters, setFilters] = useState<DocumentFilters>({})\r\n  const documentViewer = useDocumentViewer()\r\n\r\n  // Filter documents: exclude KYC (stays in Profile), exclude deal-specific except NDAs/subscriptions\r\n  const displayableDocuments = useMemo(() => {\r\n    let docs = initialDocuments.filter(doc => {\r\n      // Exclude KYC documents - they belong in Profile\r\n      if (doc.type.toLowerCase() === 'kyc') return false\r\n\r\n      // Include if no deal scope, or if it's an NDA/subscription\r\n      return !doc.scope.deal ||\r\n        doc.type === 'nda' ||\r\n        doc.type === 'subscription_pack' ||\r\n        doc.type === 'subscription'\r\n    })\r\n\r\n    // Apply vehicle/holding filter\r\n    if (filters.vehicle_id) {\r\n      docs = docs.filter(doc => doc.scope.vehicle?.id === filters.vehicle_id)\r\n    }\r\n\r\n    // Apply type filter\r\n    if (filters.type) {\r\n      docs = docs.filter(doc =>\r\n        doc.type.toLowerCase() === filters.type?.toLowerCase()\r\n      )\r\n    }\r\n\r\n    // Apply search filter\r\n    if (filters.search) {\r\n      const search = filters.search.toLowerCase()\r\n      docs = docs.filter(doc =>\r\n        doc.file_name?.toLowerCase().includes(search) ||\r\n        (doc as any).name?.toLowerCase().includes(search)\r\n      )\r\n    }\r\n\r\n    return docs\r\n  }, [initialDocuments, filters])\r\n\r\n  // Calculate type counts for filter badges\r\n  const typeCounts = useMemo(() => {\r\n    const counts: Record<string, number> = {}\r\n    displayableDocuments.forEach(doc => {\r\n      counts[doc.type] = (counts[doc.type] || 0) + 1\r\n    })\r\n    return counts\r\n  }, [displayableDocuments])\r\n\r\n  // Group documents by holding/investment FIRST, then by category within each holding\r\n  const holdingsWithDocuments = useMemo(() => {\r\n    const holdingMap = new Map<string, HoldingWithCategories>()\r\n\r\n    displayableDocuments.forEach((doc) => {\r\n      const vehicle = doc.scope.vehicle\r\n      const holdingId = vehicle?.id ?? 'general'\r\n      const holdingName = vehicle?.investment_name || vehicle?.name || 'General Documents'\r\n      const holdingType = vehicle?.type ?? null\r\n\r\n      if (!holdingMap.has(holdingId)) {\r\n        holdingMap.set(holdingId, {\r\n          id: holdingId,\r\n          name: holdingName,\r\n          type: holdingType,\r\n          vehicle,\r\n          categories: {\r\n            agreements: [],\r\n            statements: [],\r\n            ndas: [],\r\n            reports: []\r\n          },\r\n          totalDocuments: 0\r\n        })\r\n      }\r\n\r\n      const holding = holdingMap.get(holdingId)!\r\n      const categoryId = getCategoryForDocumentType(doc.type) ?? 'reports'\r\n      holding.categories[categoryId].push(doc)\r\n      holding.totalDocuments++\r\n    })\r\n\r\n    // Sort: named holdings first (alphabetically), then General at end\r\n    return Array.from(holdingMap.values()).sort((a, b) => {\r\n      if (a.id === 'general') return 1\r\n      if (b.id === 'general') return -1\r\n      return a.name.localeCompare(b.name)\r\n    })\r\n  }, [displayableDocuments])\r\n\r\n  const totalDocuments = displayableDocuments.length\r\n\r\n  const toggleCategory = (categoryKey: string) => {\r\n    const newExpanded = new Set(expandedCategories)\r\n    if (newExpanded.has(categoryKey)) {\r\n      newExpanded.delete(categoryKey)\r\n    } else {\r\n      newExpanded.add(categoryKey)\r\n    }\r\n    setExpandedCategories(newExpanded)\r\n  }\r\n\r\n  // Holdings overview (main view)\r\n  if (!selectedHolding) {\r\n    return (\r\n      <div className=\"p-6 space-y-8\">\r\n        {/* Header */}\r\n        <div className=\"relative border-b border-border pb-8 mb-2\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900/50 dark:via-blue-900/30 dark:to-indigo-900/30 opacity-60 rounded-t-2xl\" />\r\n          <div className=\"relative flex items-center justify-between\">\r\n            <div>\r\n              <div className=\"flex items-center gap-3 mb-2\">\r\n                <div className=\"w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg\">\r\n                  <Briefcase className=\"h-6 w-6 text-white\" />\r\n                </div>\r\n                <h1 className=\"text-4xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent\">\r\n                  Investment Documents\r\n                </h1>\r\n              </div>\r\n              <p className=\"text-lg text-muted-foreground ml-15\">\r\n                Access documents organized by your investments\r\n              </p>\r\n            </div>\r\n            <div className=\"text-right bg-background/80 backdrop-blur-sm rounded-xl px-6 py-4 shadow-sm border border-border\">\r\n              <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\">Total Documents</p>\r\n              <p className=\"text-3xl font-bold text-foreground mt-1\">{totalDocuments}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <DocumentFiltersComponent\r\n          vehicles={vehicles}\r\n          deals={[]}\r\n          typeCounts={typeCounts}\r\n          appliedFilters={filters}\r\n          onChange={setFilters}\r\n        />\r\n\r\n        {/* Holdings List */}\r\n        <div className=\"space-y-4\">\r\n          <h2 className=\"text-2xl font-bold text-foreground mb-6\">Your Investments</h2>\r\n\r\n          {holdingsWithDocuments.length === 0 ? (\r\n            <Card className=\"border-2 border-border\">\r\n              <CardContent className=\"p-12 text-center\">\r\n                <Folder className=\"h-16 w-16 text-muted-foreground mx-auto mb-6\" />\r\n                <h3 className=\"text-xl font-semibold text-foreground mb-3\">\r\n                  No documents available\r\n                </h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Documents will appear here once they are uploaded by the VERSO team.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              {holdingsWithDocuments.map((holding) => (\r\n                <Card\r\n                  key={holding.id}\r\n                  className=\"border-2 border-border hover:border-blue-400 dark:hover:border-blue-600 hover:shadow-xl transition-all duration-300 cursor-pointer group bg-card overflow-hidden\"\r\n                  onClick={() => setSelectedHolding(holding.id)}\r\n                >\r\n                  <CardContent className=\"p-0\">\r\n                    {/* Holding Header */}\r\n                    <div className=\"p-6 bg-gradient-to-r from-slate-50 to-blue-50 dark:from-slate-900/50 dark:to-blue-900/30 border-b border-border\">\r\n                      <div className=\"flex items-start justify-between\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <div className=\"w-14 h-14 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform overflow-hidden\">\r\n                            {holding.vehicle?.logo_url ? (\r\n                              <Image\r\n                                src={holding.vehicle.logo_url}\r\n                                alt={holding.name}\r\n                                width={56}\r\n                                height={56}\r\n                                className=\"object-cover w-full h-full\"\r\n                              />\r\n                            ) : (\r\n                              <div className=\"w-full h-full bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center\">\r\n                                <Building2 className=\"h-7 w-7 text-white\" />\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                          <div>\r\n                            <h3 className=\"text-xl font-bold text-foreground group-hover:text-blue-700 dark:group-hover:text-blue-400 transition-colors\">\r\n                              {holding.name}\r\n                            </h3>\r\n                            {holding.type && (\r\n                              <p className=\"text-sm text-muted-foreground uppercase tracking-wide mt-0.5\">\r\n                                {holding.type}\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <ChevronRight className=\"h-6 w-6 text-muted-foreground group-hover:text-blue-600 dark:group-hover:text-blue-400 group-hover:translate-x-1 transition-all\" />\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Category Summary */}\r\n                    <div className=\"p-6 space-y-3\">\r\n                      <div className=\"grid grid-cols-2 gap-2\">\r\n                        {Object.entries(DOCUMENT_CATEGORIES).map(([catId, category]) => {\r\n                          const docs = holding.categories[catId as CategoryId]\r\n                          if (docs.length === 0) return null\r\n                          const Icon = category.icon\r\n                          return (\r\n                            <div\r\n                              key={catId}\r\n                              className={`flex items-center gap-2 px-3 py-2 rounded-lg border ${getCategoryColor(category.color)}`}\r\n                            >\r\n                              <Icon className={`h-4 w-4 ${getCategoryIconColor(category.color)}`} />\r\n                              <span className=\"text-sm font-medium\">{category.name}</span>\r\n                              <Badge variant=\"secondary\" className=\"ml-auto text-xs\">\r\n                                {docs.length}\r\n                              </Badge>\r\n                            </div>\r\n                          )\r\n                        })}\r\n                      </div>\r\n\r\n                      <div className=\"pt-3 border-t border-border flex items-center justify-between\">\r\n                        <span className=\"text-sm text-muted-foreground\">Total documents</span>\r\n                        <Badge variant=\"outline\" className=\"font-semibold border-2\">\r\n                          {holding.totalDocuments}\r\n                        </Badge>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Security Notice */}\r\n        <Card className=\"border-blue-200 dark:border-blue-800 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/50 dark:to-indigo-950/50 border-2\">\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"p-3 bg-blue-100 dark:bg-blue-900/50 rounded-xl\">\r\n                <Shield className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\r\n              </div>\r\n              <div>\r\n                <div className=\"font-bold text-blue-900 dark:text-blue-100 text-lg mb-1\">Document Security & Compliance</div>\r\n                <div className=\"text-blue-700 dark:text-blue-300 leading-relaxed\">\r\n                  All documents are watermarked with your name and download timestamp.\r\n                  Access is logged for compliance and security purposes as required by BVI FSC and GDPR regulations.\r\n                  Download links expire after 15 minutes for security.\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Selected holding detail view\r\n  const selectedHoldingData = holdingsWithDocuments.find(h => h.id === selectedHolding)\r\n\r\n  if (!selectedHoldingData) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-8\">\r\n      {/* Header with breadcrumb */}\r\n      <div className=\"relative border-b border-border pb-8 mb-2\">\r\n        <div className=\"absolute inset-0 bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900/50 dark:via-blue-900/30 dark:to-indigo-900/30 opacity-60 rounded-t-2xl\" />\r\n        <div className=\"relative\">\r\n          {/* Breadcrumb */}\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() => setSelectedHolding(null)}\r\n              className=\"text-muted-foreground hover:text-foreground\"\r\n            >\r\n              <Home className=\"h-4 w-4 mr-2\" />\r\n              Investments\r\n            </Button>\r\n            <ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\r\n            <span className=\"text-sm font-medium text-foreground\">{selectedHoldingData.name}</span>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"lg\"\r\n                onClick={() => setSelectedHolding(null)}\r\n                className=\"border-2\"\r\n              >\r\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n                Back\r\n              </Button>\r\n\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"w-14 h-14 rounded-xl flex items-center justify-center shadow-lg overflow-hidden\">\r\n                  {selectedHoldingData.vehicle?.logo_url ? (\r\n                    <Image\r\n                      src={selectedHoldingData.vehicle.logo_url}\r\n                      alt={selectedHoldingData.name}\r\n                      width={56}\r\n                      height={56}\r\n                      className=\"object-cover w-full h-full\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-full h-full bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center\">\r\n                      <Building2 className=\"h-7 w-7 text-white\" />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div>\r\n                  <h1 className=\"text-3xl font-bold text-foreground\">{selectedHoldingData.name}</h1>\r\n                  {selectedHoldingData.type && (\r\n                    <p className=\"text-sm text-muted-foreground uppercase tracking-wide mt-0.5\">\r\n                      {selectedHoldingData.type}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <Badge variant=\"outline\" className=\"text-lg px-4 py-2 bg-background/80 backdrop-blur-sm border-2\">\r\n              {selectedHoldingData.totalDocuments} document{selectedHoldingData.totalDocuments !== 1 ? 's' : ''}\r\n            </Badge>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Document Categories as Expandable Folders */}\r\n      <div className=\"space-y-4\">\r\n        {Object.entries(DOCUMENT_CATEGORIES).map(([categoryId, category]) => {\r\n          const docs = selectedHoldingData.categories[categoryId as CategoryId]\r\n          if (docs.length === 0) return null\r\n\r\n          const Icon = category.icon\r\n          const isExpanded = expandedCategories.has(categoryId)\r\n          const categoryKey = `${selectedHolding}-${categoryId}`\r\n\r\n          return (\r\n            <div key={categoryId} className=\"border-2 border-border rounded-xl bg-card overflow-hidden shadow-sm\">\r\n              {/* Category Header (clickable) */}\r\n              <button\r\n                onClick={() => toggleCategory(categoryId)}\r\n                className=\"w-full px-6 py-4 flex items-center justify-between hover:bg-muted/50 transition-colors\"\r\n              >\r\n                <div className=\"flex items-center gap-4\">\r\n                  {isExpanded ? (\r\n                    <ChevronDown className=\"h-5 w-5 text-muted-foreground\" />\r\n                  ) : (\r\n                    <ChevronRight className=\"h-5 w-5 text-muted-foreground\" />\r\n                  )}\r\n                  <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${getCategoryColor(category.color)} border`}>\r\n                    {isExpanded ? (\r\n                      <FolderOpen className={`h-5 w-5 ${getCategoryIconColor(category.color)}`} />\r\n                    ) : (\r\n                      <Icon className={`h-5 w-5 ${getCategoryIconColor(category.color)}`} />\r\n                    )}\r\n                  </div>\r\n                  <div className=\"text-left\">\r\n                    <h3 className=\"text-lg font-semibold text-foreground\">{category.name}</h3>\r\n                    <p className=\"text-sm text-muted-foreground\">{category.description}</p>\r\n                  </div>\r\n                </div>\r\n                <Badge variant=\"outline\" className=\"text-sm font-semibold border-2\">\r\n                  {docs.length} document{docs.length !== 1 ? 's' : ''}\r\n                </Badge>\r\n              </button>\r\n\r\n              {/* Documents List (expanded) */}\r\n              {isExpanded && (\r\n                <div className=\"border-t border-border bg-muted/30\">\r\n                  <div className=\"p-4 space-y-3\">\r\n                    {docs.map((document) => (\r\n                      <DocumentCard\r\n                        key={document.id}\r\n                        document={document}\r\n                        onPreview={documentViewer.openPreview}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )\r\n        })}\r\n      </div>\r\n\r\n      {/* Security Notice */}\r\n      <Card className=\"border-blue-200 dark:border-blue-800 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/50 dark:to-indigo-950/50 border-2\">\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"flex items-start gap-4\">\r\n            <div className=\"p-3 bg-blue-100 dark:bg-blue-900/50 rounded-xl\">\r\n              <Shield className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\r\n            </div>\r\n            <div>\r\n              <div className=\"font-bold text-blue-900 dark:text-blue-100 text-lg mb-1\">Document Security</div>\r\n              <div className=\"text-blue-700 dark:text-blue-300 leading-relaxed\">\r\n                All documents are watermarked and tracked. Download links expire after 15 minutes.\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Document Preview - Full Screen */}\r\n      <DocumentViewerFullscreen\r\n        isOpen={documentViewer.isOpen}\r\n        document={documentViewer.document}\r\n        previewUrl={documentViewer.previewUrl}\r\n        isLoading={documentViewer.isLoading}\r\n        error={documentViewer.error}\r\n        onClose={documentViewer.closePreview}\r\n        onDownload={documentViewer.downloadDocument}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n","export enum DocumentType {\n  NDA = 'NDA',\n  SUBSCRIPTION = 'Subscription',\n  AGREEMENT = 'Agreement',\n  REPORT = 'Report',\n  STATEMENT = 'Statement',\n  KYC = 'KYC',\n  TAX = 'Tax',\n  TERM_SHEET = 'Term Sheet',\n  LEGAL = 'Legal',\n  OTHER = 'Other'\n}\n\nexport interface DocumentScope {\n  investor?: {\n    id: string\n    legal_name: string\n  }\n  vehicle?: {\n    id: string\n    name: string\n    type: string\n    investment_name?: string\n    logo_url?: string\n  }\n  deal?: {\n    id: string\n    name: string\n    status?: string\n  }\n}\n\nexport interface DocumentWatermark {\n  uploaded_by?: string\n  uploaded_at?: string\n  document_classification?: string\n  verso_holdings_notice?: string\n  compliance_notice?: string\n  original_filename?: string\n}\n\nexport interface Document {\n  id: string\n  type: DocumentType | string\n  file_name: string\n  file_key: string\n  file_size_bytes?: number\n  mime_type?: string\n  created_at: string\n  created_by?: {\n    display_name: string\n    email: string\n  }\n  scope: DocumentScope\n  watermark?: DocumentWatermark\n  metadata?: Record<string, unknown>\n  folder?: {\n    id: string\n    name: string\n    path: string\n  }\n}\n\nexport interface DocumentFilters {\n  type?: string\n  vehicle_id?: string\n  deal_id?: string\n  from_date?: string\n  to_date?: string\n  search?: string\n}\n\nexport interface DocumentsResponse {\n  documents: Document[]\n  pagination: {\n    total: number\n    limit: number\n    offset: number\n    has_more: boolean\n    current_page: number\n    total_pages: number\n  }\n  filters_applied: DocumentFilters\n}\n\nexport interface Vehicle {\n  id: string\n  name: string\n  type: string\n  investment_name?: string\n  logo_url?: string\n}\n\nexport interface Deal {\n  id: string\n  name: string\n  status: string\n}\n\n// ============================================\n// Navigation Types (Folder Explorer)\n// ============================================\n\n/**\n * Folder structure for document organization\n */\nexport interface DocumentFolder {\n  id: string\n  name: string\n  path: string // Full path like \"/Vehicle A/Investor Documents/KYC\"\n  parent_folder_id: string | null\n  folder_type: 'vehicle_root' | 'category' | 'custom'\n  vehicle_id?: string | null\n  created_by?: string\n  created_at: string\n  updated_at: string\n  // Virtual fields (from counts)\n  subfolder_count?: number\n  document_count?: number\n}\n\n/**\n * Breadcrumb segment for navigation\n */\nexport interface Breadcrumb {\n  id: string | null // null for root/home\n  name: string\n  path: string\n}\n\n/**\n * Navigation state for folder explorer\n */\nexport interface NavigationState {\n  currentFolderId: string | null\n  navigationHistory: string[] // Stack for back navigation\n  breadcrumbs: Breadcrumb[]\n}\n\n/**\n * Folder navigation actions\n */\nexport type NavigationAction =\n  | { type: 'NAVIGATE_TO_FOLDER'; folderId: string | null }\n  | { type: 'NAVIGATE_BACK' }\n  | { type: 'NAVIGATE_TO_ROOT' }\n  | { type: 'UPDATE_BREADCRUMBS'; breadcrumbs: Breadcrumb[] }","'use client'\n\nimport { DocumentType, Vehicle, Deal, DocumentFilters } from '@/types/documents'\nimport { Card, CardContent } from '@/components/ui/card'\nimport { Input } from '@/components/ui/input'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Search,\n  Filter,\n  X,\n  BarChart3,\n  FileBarChart,\n  Receipt,\n  Scale,\n  Lock,\n  PenTool,\n  FileCheck,\n  ClipboardList,\n  UserCheck,\n  Folder,\n  LucideIcon\n} from 'lucide-react'\nimport { useState } from 'react'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\n\ninterface DocumentFiltersProps {\n  vehicles: Vehicle[]\n  deals: Deal[]\n  typeCounts: Record<string, number>\n  appliedFilters: DocumentFilters\n  onChange: (filters: DocumentFilters) => void\n}\n\nexport function DocumentFiltersComponent({\n  vehicles,\n  deals,\n  typeCounts,\n  appliedFilters,\n  onChange\n}: DocumentFiltersProps) {\n  const ALL_VEHICLES_VALUE = '__all_vehicles__'\n  const ALL_DEALS_VALUE = '__all_deals__'\n\n  const [search, setSearch] = useState(appliedFilters.search || '')\n  const [type, setType] = useState(appliedFilters.type || '')\n  const [vehicleId, setVehicleId] = useState(appliedFilters.vehicle_id ?? ALL_VEHICLES_VALUE)\n  const [dealId, setDealId] = useState(appliedFilters.deal_id ?? ALL_DEALS_VALUE)\n\n  const handleApplyFilters = () => {\n    onChange({\n      search: search || undefined,\n      type: type || undefined,\n      vehicle_id: vehicleId === ALL_VEHICLES_VALUE ? undefined : vehicleId,\n      deal_id: dealId === ALL_DEALS_VALUE ? undefined : dealId\n    })\n  }\n\n  const handleClearFilters = () => {\n    setSearch('')\n    setType('')\n    setVehicleId(ALL_VEHICLES_VALUE)\n    setDealId(ALL_DEALS_VALUE)\n    onChange({})\n  }\n\n  const hasFilters = Boolean(\n    (search && search.trim()) ||\n    type ||\n    vehicleId !== ALL_VEHICLES_VALUE ||\n    dealId !== ALL_DEALS_VALUE\n  )\n\n  const documentTypes: { value: DocumentType; label: string; icon: LucideIcon }[] = [\n    { value: DocumentType.STATEMENT, label: 'Statements', icon: BarChart3 },\n    { value: DocumentType.REPORT, label: 'Reports', icon: FileBarChart },\n    { value: DocumentType.TAX, label: 'Tax', icon: Receipt },\n    { value: DocumentType.LEGAL, label: 'Legal', icon: Scale },\n    { value: DocumentType.NDA, label: 'NDAs', icon: Lock },\n    { value: DocumentType.SUBSCRIPTION, label: 'Subscriptions', icon: PenTool },\n    { value: DocumentType.AGREEMENT, label: 'Agreements', icon: FileCheck },\n    { value: DocumentType.TERM_SHEET, label: 'Term Sheets', icon: ClipboardList },\n    { value: DocumentType.KYC, label: 'KYC', icon: UserCheck },\n    { value: DocumentType.OTHER, label: 'Other', icon: Folder }\n  ]\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Quick type filters */}\n      <div className=\"flex flex-wrap gap-2\">\n        {documentTypes.map((docType) => {\n          const count = typeCounts[docType.value] || 0\n          const isActive = type === docType.value\n\n          return (\n            <Badge\n              key={docType.value}\n              variant={isActive ? 'default' : 'outline'}\n              className={`\n                cursor-pointer px-4 py-2 text-sm font-medium transition-all duration-200\n                ${isActive\n                  ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md'\n                  : 'border-2 hover:border-blue-300 hover:bg-blue-50'\n                }\n              `}\n              onClick={() => {\n                setType(isActive ? '' : docType.value)\n                onChange({\n                  ...appliedFilters,\n                  type: isActive ? undefined : docType.value\n                })\n              }}\n            >\n              <docType.icon className=\"h-4 w-4 mr-1.5\" />\n              {docType.label}\n              {count > 0 && (\n                <span className=\"ml-2 text-xs opacity-75\">({count})</span>\n              )}\n            </Badge>\n          )\n        })}\n      </div>\n\n      {/* Advanced filters */}\n      <Card>\n        <CardContent className=\"p-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n            {/* Search */}\n            <div className=\"lg:col-span-2\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\n                <Input\n                  placeholder=\"Search documents...\"\n                  value={search}\n                  onChange={(e) => setSearch(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') handleApplyFilters()\n                  }}\n                  className=\"pl-10\"\n                />\n              </div>\n            </div>\n\n            {/* Vehicle filter */}\n            {vehicles.length > 0 && (\n              <div>\n                <Select value={vehicleId} onValueChange={setVehicleId}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All vehicles\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value={ALL_VEHICLES_VALUE}>All vehicles</SelectItem>\n                    {vehicles.map((vehicle) => (\n                      <SelectItem key={vehicle.id} value={vehicle.id}>\n                        {vehicle.name}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            )}\n\n            {/* Deal filter */}\n            {deals.length > 0 && (\n              <div>\n                <Select value={dealId} onValueChange={setDealId}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All deals\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value={ALL_DEALS_VALUE}>All deals</SelectItem>\n                    {deals.map((deal) => (\n                      <SelectItem key={deal.id} value={deal.id}>\n                        {deal.name}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            )}\n\n            {/* Actions */}\n            <div className=\"flex gap-2 lg:col-span-4 md:col-span-2\">\n              <Button\n                onClick={handleApplyFilters}\n                className=\"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700\"\n              >\n                <Filter className=\"h-4 w-4 mr-2\" />\n                Apply Filters\n              </Button>\n\n              {hasFilters && (\n                <Button\n                  variant=\"outline\"\n                  onClick={handleClearFilters}\n                  className=\"border-2 hover:bg-red-50 hover:border-red-300\"\n                >\n                  <X className=\"h-4 w-4 mr-2\" />\n                  Clear\n                </Button>\n              )}\n            </div>\n          </div>\n\n          {/* Active filters display */}\n          {hasFilters && (\n            <div className=\"flex flex-wrap gap-2 mt-4 pt-4 border-t\">\n              <span className=\"text-sm text-gray-600 font-medium\">Active filters:</span>\n              {type && (\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  Type: {type}\n                  <X\n                    className=\"h-3 w-3 cursor-pointer hover:text-red-600\"\n                    onClick={() => {\n                      setType('')\n                      handleApplyFilters()\n                    }}\n                  />\n                </Badge>\n              )}\n              {vehicleId !== ALL_VEHICLES_VALUE && (\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  Vehicle: {vehicles.find(v => v.id === vehicleId)?.name || 'Unknown'}\n                  <X\n                    className=\"h-3 w-3 cursor-pointer hover:text-red-600\"\n                    onClick={() => {\n                      setVehicleId(ALL_VEHICLES_VALUE)\n                      handleApplyFilters()\n                    }}\n                  />\n                </Badge>\n              )}\n              {dealId !== ALL_DEALS_VALUE && (\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  Deal: {deals.find(d => d.id === dealId)?.name || 'Unknown'}\n                  <X\n                    className=\"h-3 w-3 cursor-pointer hover:text-red-600\"\n                    onClick={() => {\n                      setDealId(ALL_DEALS_VALUE)\n                      handleApplyFilters()\n                    }}\n                  />\n                </Badge>\n              )}\n              {search && (\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  Search: {search}\n                  <X\n                    className=\"h-3 w-3 cursor-pointer hover:text-red-600\"\n                    onClick={() => {\n                      setSearch('')\n                      handleApplyFilters()\n                    }}\n                  />\n                </Badge>\n              )}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}