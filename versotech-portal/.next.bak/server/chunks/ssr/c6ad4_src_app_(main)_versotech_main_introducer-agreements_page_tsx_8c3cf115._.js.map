{"version":3,"sources":["../../../../../versotech-portal/src/app/%28main%29/versotech_main/introducer-agreements/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectGroup,\r\n  SelectItem,\r\n  SelectLabel,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table'\r\nimport {\r\n  FileText,\r\n  Clock,\r\n  CheckCircle2,\r\n  Search,\r\n  Loader2,\r\n  AlertCircle,\r\n  FileSignature,\r\n  Calendar,\r\n  Globe,\r\n  Percent,\r\n  AlertTriangle,\r\n  FileDown,\r\n} from 'lucide-react'\r\nimport { toast } from 'sonner'\r\nimport { cn } from '@/lib/utils'\r\nimport { formatDate } from '@/lib/format'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useRouter } from 'next/navigation'\r\n\r\ntype Agreement = {\r\n  id: string\r\n  agreement_type: string\r\n  signed_date: string | null\r\n  effective_date: string | null\r\n  expiry_date: string | null\r\n  default_commission_bps: number\r\n  commission_cap_amount: number | null\r\n  payment_terms: string | null\r\n  territory: string | null\r\n  deal_types: string[] | null\r\n  exclusivity_level: string | null\r\n  status: string\r\n  created_at: string\r\n  pdf_url: string | null\r\n  reference_number: string | null\r\n}\r\n\r\ntype IntroducerInfo = {\r\n  id: string\r\n  legal_name: string\r\n  status: string\r\n  default_commission_bps: number | null\r\n  logo_url: string | null\r\n}\r\n\r\ntype Summary = {\r\n  totalAgreements: number\r\n  activeAgreements: number\r\n  pendingAgreements: number\r\n  expiringSoon: number\r\n}\r\n\r\nconst STATUS_STYLES: Record<string, { className: string; label: string }> = {\r\n  // Workflow statuses with distinctive colors\r\n  draft: {\r\n    className: 'bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-700',\r\n    label: 'Draft',\r\n  },\r\n  sent: {\r\n    className: 'bg-sky-100 text-sky-700 border-sky-200 dark:bg-sky-900/50 dark:text-sky-300 dark:border-sky-800',\r\n    label: 'Sent',\r\n  },\r\n  pending_approval: {\r\n    className: 'bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/50 dark:text-amber-300 dark:border-amber-800',\r\n    label: 'Pending Approval',\r\n  },\r\n  approved: {\r\n    className: 'bg-teal-100 text-teal-700 border-teal-200 dark:bg-teal-900/50 dark:text-teal-300 dark:border-teal-800',\r\n    label: 'Approved',\r\n  },\r\n  pending_ceo_signature: {\r\n    className: 'bg-indigo-100 text-indigo-700 border-indigo-200 dark:bg-indigo-900/50 dark:text-indigo-300 dark:border-indigo-800',\r\n    label: 'Awaiting CEO',\r\n  },\r\n  pending_introducer_signature: {\r\n    className: 'bg-violet-100 text-violet-700 border-violet-200 dark:bg-violet-900/50 dark:text-violet-300 dark:border-violet-800',\r\n    label: 'Awaiting Introducer',\r\n  },\r\n  active: {\r\n    className: 'bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-900/50 dark:text-emerald-300 dark:border-emerald-800',\r\n    label: 'Active',\r\n  },\r\n  rejected: {\r\n    className: 'bg-rose-100 text-rose-700 border-rose-200 dark:bg-rose-900/50 dark:text-rose-300 dark:border-rose-800',\r\n    label: 'Rejected',\r\n  },\r\n  expired: {\r\n    className: 'bg-orange-100 text-orange-700 border-orange-200 dark:bg-orange-900/50 dark:text-orange-300 dark:border-orange-800',\r\n    label: 'Expired',\r\n  },\r\n  terminated: {\r\n    className: 'bg-red-100 text-red-700 border-red-200 dark:bg-red-900/50 dark:text-red-300 dark:border-red-800',\r\n    label: 'Terminated',\r\n  },\r\n}\r\n\r\nconst STATUS_FILTERS = [\r\n  { label: 'All Agreements', value: 'all', group: null },\r\n  // In Progress\r\n  { label: 'Draft', value: 'draft', group: 'In Progress' },\r\n  { label: 'Sent', value: 'sent', group: 'In Progress' },\r\n  { label: 'Pending Approval', value: 'pending_approval', group: 'In Progress' },\r\n  { label: 'Approved', value: 'approved', group: 'In Progress' },\r\n  // Awaiting Signatures\r\n  { label: 'Awaiting CEO Signature', value: 'pending_ceo_signature', group: 'Signatures' },\r\n  { label: 'Awaiting Introducer Signature', value: 'pending_introducer_signature', group: 'Signatures' },\r\n  // Final States\r\n  { label: 'Active', value: 'active', group: 'Final' },\r\n  { label: 'Rejected', value: 'rejected', group: 'Final' },\r\n  { label: 'Expired', value: 'expired', group: 'Final' },\r\n  { label: 'Terminated', value: 'terminated', group: 'Final' },\r\n]\r\n\r\nconst AGREEMENT_TYPE_LABELS: Record<string, string> = {\r\n  referral: 'Referral Agreement',\r\n  revenue_share: 'Revenue Share',\r\n  fixed_fee: 'Fixed Fee',\r\n  hybrid: 'Hybrid',\r\n}\r\n\r\nexport default function IntroducerAgreementsPage() {\r\n  const router = useRouter()\r\n  const [introducerInfo, setIntroducerInfo] = useState<IntroducerInfo | null>(null)\r\n  const [agreements, setAgreements] = useState<Agreement[]>([])\r\n  const [summary, setSummary] = useState<Summary>({\r\n    totalAgreements: 0,\r\n    activeAgreements: 0,\r\n    pendingAgreements: 0,\r\n    expiringSoon: 0,\r\n  })\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [search, setSearch] = useState('')\r\n  const [statusFilter, setStatusFilter] = useState('all')\r\n  const [downloadingPdf, setDownloadingPdf] = useState<string | null>(null)\r\n\r\n  // Handle PDF download\r\n  const handleDownloadPdf = async (e: React.MouseEvent, pdfUrl: string, referenceNumber: string | null) => {\r\n    e.stopPropagation() // Prevent row click navigation\r\n    setDownloadingPdf(pdfUrl)\r\n    try {\r\n      const response = await fetch(`/api/storage/download?path=${encodeURIComponent(pdfUrl)}&bucket=deal-documents`)\r\n      if (!response.ok) {\r\n        throw new Error('Failed to download file')\r\n      }\r\n      const blob = await response.blob()\r\n      const url = window.URL.createObjectURL(blob)\r\n      const link = document.createElement('a')\r\n      link.href = url\r\n      // Extract actual filename from the storage path, or fall back to reference number\r\n      const actualFilename = pdfUrl.split('/').pop() || `${referenceNumber || 'Fee_Agreement'}.pdf`\r\n      link.download = actualFilename\r\n      document.body.appendChild(link)\r\n      link.click()\r\n      document.body.removeChild(link)\r\n      window.URL.revokeObjectURL(url)\r\n      toast.success('PDF downloaded successfully')\r\n    } catch (error) {\r\n      console.error('Error downloading PDF:', error)\r\n      toast.error('Failed to download PDF')\r\n    } finally {\r\n      setDownloadingPdf(null)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      try {\r\n        setLoading(true)\r\n        const supabase = createClient()\r\n\r\n        // Get current user\r\n        const { data: { user } } = await supabase.auth.getUser()\r\n        if (!user) {\r\n          setError('Not authenticated')\r\n          return\r\n        }\r\n\r\n        // Check if user is an introducer\r\n        const { data: introducerUser, error: introducerUserError } = await supabase\r\n          .from('introducer_users')\r\n          .select('introducer_id')\r\n          .eq('user_id', user.id)\r\n          .single()\r\n\r\n        if (introducerUserError || !introducerUser) {\r\n          // Maybe they're staff - show all agreements as placeholder\r\n          await fetchAllAgreements(supabase)\r\n          return\r\n        }\r\n\r\n        // Fetch introducer info\r\n        const { data: introducer, error: introducerError } = await supabase\r\n          .from('introducers')\r\n          .select('id, legal_name, status, default_commission_bps, logo_url')\r\n          .eq('id', introducerUser.introducer_id)\r\n          .single()\r\n\r\n        if (introducerError) throw introducerError\r\n        setIntroducerInfo(introducer)\r\n\r\n        // Fetch agreements for this introducer\r\n        const { data: agreementsData, error: agreementsError } = await supabase\r\n          .from('introducer_agreements')\r\n          .select('*')\r\n          .eq('introducer_id', introducerUser.introducer_id)\r\n          .order('created_at', { ascending: false })\r\n\r\n        if (agreementsError) throw agreementsError\r\n\r\n        processAgreements(agreementsData || [])\r\n        setError(null)\r\n      } catch (err) {\r\n        console.error('[IntroducerAgreementsPage] Error:', err)\r\n        setError(err instanceof Error ? err.message : 'Failed to load agreements')\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    async function fetchAllAgreements(supabase: any) {\r\n      // Staff view - show all agreements with introducer info\r\n      const { data: agreementsData, error: agreementsError } = await supabase\r\n        .from('introducer_agreements')\r\n        .select(`\r\n          *,\r\n          introducer:introducer_id (\r\n            id,\r\n            legal_name,\r\n            status\r\n          )\r\n        `)\r\n        .order('created_at', { ascending: false })\r\n        .limit(100)\r\n\r\n      if (agreementsError) throw agreementsError\r\n      processAgreements(agreementsData || [])\r\n    }\r\n\r\n    function processAgreements(data: any[]) {\r\n      const now = new Date()\r\n      const thirtyDaysFromNow = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000)\r\n\r\n      const processed: Agreement[] = data.map((agreement) => ({\r\n        id: agreement.id,\r\n        agreement_type: agreement.agreement_type || 'referral',\r\n        signed_date: agreement.signed_date,\r\n        effective_date: agreement.effective_date,\r\n        expiry_date: agreement.expiry_date,\r\n        default_commission_bps: agreement.default_commission_bps || 0,\r\n        commission_cap_amount: agreement.commission_cap_amount,\r\n        payment_terms: agreement.payment_terms,\r\n        territory: agreement.territory,\r\n        deal_types: agreement.deal_types,\r\n        exclusivity_level: agreement.exclusivity_level,\r\n        status: agreement.status || 'draft',\r\n        created_at: agreement.created_at,\r\n        pdf_url: agreement.pdf_url || null,\r\n        reference_number: agreement.reference_number || null,\r\n      }))\r\n\r\n      setAgreements(processed)\r\n\r\n      const active = processed.filter(a => a.status === 'active').length\r\n      // Count all \"in-progress\" statuses as pending\r\n      const pendingStatuses = ['draft', 'sent', 'pending_approval', 'approved', 'pending_ceo_signature', 'pending_introducer_signature']\r\n      const pending = processed.filter(a => pendingStatuses.includes(a.status)).length\r\n      const expiring = processed.filter(a => {\r\n        if (!a.expiry_date) return false\r\n        const expDate = new Date(a.expiry_date)\r\n        return expDate > now && expDate <= thirtyDaysFromNow && a.status === 'active'\r\n      }).length\r\n\r\n      setSummary({\r\n        totalAgreements: processed.length,\r\n        activeAgreements: active,\r\n        pendingAgreements: pending,\r\n        expiringSoon: expiring,\r\n      })\r\n    }\r\n\r\n    fetchData()\r\n  }, [])\r\n\r\n  // Check if agreement is expiring soon\r\n  function isExpiringSoon(expiryDate: string | null): boolean {\r\n    if (!expiryDate) return false\r\n    const now = new Date()\r\n    const expDate = new Date(expiryDate)\r\n    const thirtyDaysFromNow = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000)\r\n    return expDate > now && expDate <= thirtyDaysFromNow\r\n  }\r\n\r\n  // Format commission as percentage\r\n  function formatCommission(bps: number): string {\r\n    return `${(bps / 100).toFixed(2)}%`\r\n  }\r\n\r\n  // Filter agreements\r\n  const filteredAgreements = agreements.filter(agreement => {\r\n    const matchesStatus = statusFilter === 'all' || agreement.status === statusFilter\r\n    const matchesSearch = !search ||\r\n      agreement.agreement_type?.toLowerCase().includes(search.toLowerCase()) ||\r\n      agreement.territory?.toLowerCase().includes(search.toLowerCase())\r\n    return matchesStatus && matchesSearch\r\n  })\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-16\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\r\n        <span className=\"ml-3 text-muted-foreground\">Loading agreements...</span>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"text-center py-16\">\r\n        <AlertCircle className=\"h-12 w-12 text-destructive mx-auto mb-4\" />\r\n        <h3 className=\"text-lg font-medium text-foreground mb-2\">Error Loading Agreements</h3>\r\n        <p className=\"text-muted-foreground\">{error}</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-foreground\">Fee Agreements</h1>\r\n          <p className=\"text-muted-foreground mt-1\">\r\n            {introducerInfo\r\n              ? `Manage your commission agreements as ${introducerInfo.legal_name}`\r\n              : 'View and manage all introducer agreements'}\r\n          </p>\r\n        </div>\r\n        {introducerInfo && introducerInfo.default_commission_bps && (\r\n          <Badge variant=\"outline\" className=\"text-sm\">\r\n            Default: {formatCommission(introducerInfo.default_commission_bps)}\r\n          </Badge>\r\n        )}\r\n      </div>\r\n\r\n      {/* Summary Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <Card className=\"relative overflow-hidden group hover:shadow-md transition-shadow\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-br from-slate-500/5 to-slate-600/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <div className=\"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800\">\r\n                <FileText className=\"h-3.5 w-3.5 text-slate-600 dark:text-slate-400\" />\r\n              </div>\r\n              Total Agreements\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold tracking-tight\">{summary.totalAgreements}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              All fee arrangements\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"relative overflow-hidden group hover:shadow-md transition-shadow\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-green-600/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <div className=\"p-1.5 rounded-lg bg-emerald-100 dark:bg-emerald-900/50\">\r\n                <CheckCircle2 className=\"h-3.5 w-3.5 text-emerald-600 dark:text-emerald-400\" />\r\n              </div>\r\n              Active\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold tracking-tight text-emerald-600 dark:text-emerald-400\">{summary.activeAgreements}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Currently in effect\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"relative overflow-hidden group hover:shadow-md transition-shadow\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-yellow-600/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <div className=\"p-1.5 rounded-lg bg-amber-100 dark:bg-amber-900/50\">\r\n                <Clock className=\"h-3.5 w-3.5 text-amber-600 dark:text-amber-400\" />\r\n              </div>\r\n              In Progress\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold tracking-tight text-amber-600 dark:text-amber-400\">{summary.pendingAgreements}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Awaiting action\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"relative overflow-hidden group hover:shadow-md transition-shadow\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-red-600/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <div className=\"p-1.5 rounded-lg bg-orange-100 dark:bg-orange-900/50\">\r\n                <AlertTriangle className=\"h-3.5 w-3.5 text-orange-600 dark:text-orange-400\" />\r\n              </div>\r\n              Expiring Soon\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold tracking-tight text-orange-600 dark:text-orange-400\">{summary.expiringSoon}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Within 30 days\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex flex-col md:flex-row gap-4\">\r\n            <div className=\"flex-1\">\r\n              <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder=\"Search by type or territory...\"\r\n                  value={search}\r\n                  onChange={(e) => setSearch(e.target.value)}\r\n                  className=\"pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n              <SelectTrigger className=\"w-full md:w-56\">\r\n                <SelectValue placeholder=\"Filter by status\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {/* All option */}\r\n                <SelectItem value=\"all\">All Agreements</SelectItem>\r\n\r\n                {/* In Progress group */}\r\n                <SelectGroup>\r\n                  <SelectLabel className=\"text-xs text-muted-foreground font-semibold px-2 py-1.5\">\r\n                    In Progress\r\n                  </SelectLabel>\r\n                  {STATUS_FILTERS.filter(f => f.group === 'In Progress').map((option) => (\r\n                    <SelectItem key={option.value} value={option.value}>\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <span className={cn(\r\n                          'w-2 h-2 rounded-full',\r\n                          option.value === 'draft' && 'bg-slate-500',\r\n                          option.value === 'sent' && 'bg-sky-500',\r\n                          option.value === 'pending_approval' && 'bg-amber-500',\r\n                          option.value === 'approved' && 'bg-teal-500'\r\n                        )} />\r\n                        {option.label}\r\n                      </span>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectGroup>\r\n\r\n                {/* Signatures group */}\r\n                <SelectGroup>\r\n                  <SelectLabel className=\"text-xs text-muted-foreground font-semibold px-2 py-1.5\">\r\n                    Awaiting Signatures\r\n                  </SelectLabel>\r\n                  {STATUS_FILTERS.filter(f => f.group === 'Signatures').map((option) => (\r\n                    <SelectItem key={option.value} value={option.value}>\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <span className={cn(\r\n                          'w-2 h-2 rounded-full',\r\n                          option.value === 'pending_ceo_signature' && 'bg-indigo-500',\r\n                          option.value === 'pending_introducer_signature' && 'bg-violet-500'\r\n                        )} />\r\n                        {option.label}\r\n                      </span>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectGroup>\r\n\r\n                {/* Final States group */}\r\n                <SelectGroup>\r\n                  <SelectLabel className=\"text-xs text-muted-foreground font-semibold px-2 py-1.5\">\r\n                    Final States\r\n                  </SelectLabel>\r\n                  {STATUS_FILTERS.filter(f => f.group === 'Final').map((option) => (\r\n                    <SelectItem key={option.value} value={option.value}>\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <span className={cn(\r\n                          'w-2 h-2 rounded-full',\r\n                          option.value === 'active' && 'bg-emerald-500',\r\n                          option.value === 'rejected' && 'bg-rose-500',\r\n                          option.value === 'expired' && 'bg-orange-500',\r\n                          option.value === 'terminated' && 'bg-red-500'\r\n                        )} />\r\n                        {option.label}\r\n                      </span>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectGroup>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Agreements Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Agreements</CardTitle>\r\n          <CardDescription>\r\n            {filteredAgreements.length} agreement{filteredAgreements.length !== 1 ? 's' : ''} found\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {filteredAgreements.length === 0 ? (\r\n            <div className=\"border-2 border-dashed border-muted/50 rounded-xl py-16 flex flex-col items-center justify-center text-center space-y-4 bg-gradient-to-br from-muted/20 to-muted/5\">\r\n              <div className=\"p-4 rounded-2xl bg-muted/30\">\r\n                <FileSignature className=\"h-12 w-12 text-muted-foreground/60\" />\r\n              </div>\r\n              <div className=\"space-y-1\">\r\n                <p className=\"text-base font-medium text-muted-foreground\">\r\n                  {search || statusFilter !== 'all'\r\n                    ? 'No agreements match your filters'\r\n                    : introducerInfo\r\n                      ? 'No fee agreements on file'\r\n                      : 'No introducer agreements found'}\r\n                </p>\r\n                {introducerInfo && agreements.length === 0 && (\r\n                  <p className=\"text-sm text-muted-foreground/70 max-w-sm\">\r\n                    Contact your relationship manager to set up a fee agreement and start making introductions.\r\n                  </p>\r\n                )}\r\n                {(search || statusFilter !== 'all') && (\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"mt-2\"\r\n                    onClick={() => {\r\n                      setSearch('')\r\n                      setStatusFilter('all')\r\n                    }}\r\n                  >\r\n                    Clear filters\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"rounded-md border\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>Type</TableHead>\r\n                    <TableHead>Commission</TableHead>\r\n                    <TableHead>Territory</TableHead>\r\n                    <TableHead>Effective</TableHead>\r\n                    <TableHead>Expires</TableHead>\r\n                    <TableHead>Status</TableHead>\r\n                    <TableHead className=\"w-12\">PDF</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {filteredAgreements.map((agreement) => (\r\n                    <TableRow\r\n                      key={agreement.id}\r\n                      className=\"cursor-pointer hover:bg-muted/50 transition-colors duration-150 group\"\r\n                      onClick={() => router.push(`/versotech_main/introducer-agreements/${agreement.id}`)}\r\n                    >\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <FileText className=\"h-4 w-4 text-muted-foreground\" />\r\n                          <div>\r\n                            <div className=\"font-medium\">\r\n                              {AGREEMENT_TYPE_LABELS[agreement.agreement_type] || agreement.agreement_type}\r\n                            </div>\r\n                            {agreement.exclusivity_level && (\r\n                              <div className=\"text-xs text-muted-foreground capitalize\">\r\n                                {agreement.exclusivity_level}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <Percent className=\"h-3 w-3 text-muted-foreground\" />\r\n                          <span className=\"font-medium\">\r\n                            {formatCommission(agreement.default_commission_bps)}\r\n                          </span>\r\n                        </div>\r\n                        {agreement.commission_cap_amount && (\r\n                          <div className=\"text-xs text-muted-foreground\">\r\n                            Cap: ${agreement.commission_cap_amount.toLocaleString()}\r\n                          </div>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <Globe className=\"h-3 w-3 text-muted-foreground\" />\r\n                          <span>{agreement.territory || 'Global'}</span>\r\n                        </div>\r\n                        {agreement.deal_types && agreement.deal_types.length > 0 && (\r\n                          <div className=\"text-xs text-muted-foreground\">\r\n                            {agreement.deal_types.slice(0, 2).join(', ')}\r\n                            {agreement.deal_types.length > 2 && ` +${agreement.deal_types.length - 2}`}\r\n                          </div>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <Calendar className=\"h-3 w-3 text-muted-foreground\" />\r\n                          <span className=\"text-sm\">\r\n                            {agreement.effective_date\r\n                              ? formatDate(agreement.effective_date)\r\n                              : 'Not set'}\r\n                          </span>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className={cn(\r\n                          \"flex items-center gap-1\",\r\n                          isExpiringSoon(agreement.expiry_date) && \"text-orange-600\"\r\n                        )}>\r\n                          {isExpiringSoon(agreement.expiry_date) && (\r\n                            <AlertTriangle className=\"h-3 w-3\" />\r\n                          )}\r\n                          <span className=\"text-sm\">\r\n                            {agreement.expiry_date\r\n                              ? formatDate(agreement.expiry_date)\r\n                              : 'No expiry'}\r\n                          </span>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge\r\n                          variant=\"outline\"\r\n                          className={cn(\r\n                            'font-medium',\r\n                            (STATUS_STYLES[agreement.status] || STATUS_STYLES.draft).className\r\n                          )}\r\n                        >\r\n                          {(STATUS_STYLES[agreement.status] || STATUS_STYLES.draft).label}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {agreement.pdf_url ? (\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={(e) => handleDownloadPdf(e, agreement.pdf_url!, agreement.reference_number)}\r\n                            disabled={downloadingPdf === agreement.pdf_url}\r\n                            className=\"h-8 w-8 p-0 text-blue-500 hover:text-blue-400 hover:bg-blue-500/10\"\r\n                            title=\"Download PDF\"\r\n                          >\r\n                            {downloadingPdf === agreement.pdf_url ? (\r\n                              <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                            ) : (\r\n                              <FileDown className=\"h-4 w-4\" />\r\n                            )}\r\n                          </Button>\r\n                        ) : (\r\n                          <span className=\"text-xs text-muted-foreground\">â€”</span>\r\n                        )}\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}