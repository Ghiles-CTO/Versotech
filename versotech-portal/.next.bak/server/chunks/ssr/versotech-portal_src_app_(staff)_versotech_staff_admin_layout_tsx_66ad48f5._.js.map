{"version":3,"sources":["../../../../../versotech-portal/src/app/%28staff%29/versotech/staff/admin/layout.tsx"],"sourcesContent":["import { redirect } from 'next/navigation'\nimport { getCurrentUser } from '@/lib/auth'\nimport { createClient } from '@/lib/supabase/server'\n\nexport const dynamic = 'force-dynamic'\n\nexport default async function AdminLayout({\n  children,\r\n}: {\r\n  children: React.ReactNode\r\n}) {\r\n  const user = await getCurrentUser()\r\n\r\n  if (!user) {\r\n    redirect('/versotech/login')\r\n  }\r\n\r\n  // Check if user has super_admin permission\r\n  const supabase = await createClient()\r\n  const { data: permission } = await supabase\r\n    .from('staff_permissions')\r\n    .select('permission')\r\n    .eq('user_id', user.id)\r\n    .eq('permission', 'super_admin')\r\n    .single()\r\n\r\n  if (!permission) {\r\n    // Redirect non-super-admins to staff dashboard\r\n    redirect('/versotech/staff')\r\n  }\r\n\r\n  return <>{children}</>\r\n}\r\n"],"names":[],"mappings":"0DAAA,EAAA,CAAA,CAAA,QAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAIe,eAAe,EAAY,UACxC,CAAQ,CAGT,EACC,IAAM,EAAO,MAAM,CAAA,EAAA,EAAA,cAAA,AAAc,GAE7B,CAAC,GACH,CAAA,EADS,AACT,EAAA,QAAA,AAAQ,EAAC,oBAIX,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAC7B,CAAE,KAAM,CAAU,CAAE,CAAG,MAAM,EAChC,IAAI,CAAC,qBACL,MAAM,CAAC,cACP,EAAE,CAAC,UAAW,EAAK,EAAE,EACrB,EAAE,CAAC,aAAc,eACjB,MAAM,GAOT,OALI,AAAC,GAEH,CAAA,EAAA,EAAA,IAFe,IAEf,AAAQ,EAAC,oBAGJ,CAAA,EAAA,EAAA,GAAA,EAAA,EAAA,QAAA,CAAA,UAAG,GACZ,kCA5BuB"}