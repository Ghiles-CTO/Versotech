{"version":3,"sources":["../../../../../versotech-portal/src/app/%28main%29/versotech_main/escrow/page.tsx","../../../../../versotech-portal/src/components/lawyer/escrow-confirm-modal.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState, useCallback } from 'react'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table'\r\nimport {\r\n  Tabs,\r\n  TabsContent,\r\n  TabsList,\r\n  TabsTrigger,\r\n} from '@/components/ui/tabs'\r\nimport {\r\n  Lock,\r\n  DollarSign,\r\n  Clock,\r\n  CheckCircle2,\r\n  Search,\r\n  Loader2,\r\n  AlertCircle,\r\n  Building2,\r\n  Wallet,\r\n  ArrowUpRight,\r\n  AlertTriangle,\r\n  CreditCard,\r\n  BanknoteIcon,\r\n  Download,\r\n  Info,\r\n} from 'lucide-react'\r\nimport { cn } from '@/lib/utils'\r\nimport { formatCurrency, formatDate } from '@/lib/format'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { EscrowConfirmModal } from '@/components/lawyer/escrow-confirm-modal'\r\nimport { DateRangePicker } from '@/components/ui/date-range-picker'\r\nimport type { DateRange } from 'react-day-picker'\r\n\r\ntype LawyerInfo = {\r\n  id: string\r\n  firm_name: string\r\n  display_name: string\r\n  specializations: string[] | null\r\n  is_active: boolean\r\n}\r\n\r\ntype ArrangerInfo = {\r\n  id: string\r\n  legal_name: string\r\n  status: string  // 'active' | 'inactive' - arranger_entities uses status not is_active\r\n}\r\n\r\ntype EscrowDeal = {\r\n  id: string\r\n  deal_id: string\r\n  deal_name: string\r\n  company_name: string | null\r\n  status: string\r\n  legal_counsel: string | null\r\n  wire_escrow_agent: string | null\r\n  wire_bank_name: string | null\r\n  wire_account_holder: string | null\r\n  wire_iban: string | null\r\n  wire_bic: string | null\r\n  escrow_fee_text: string | null\r\n  target_amount: number\r\n  currency: string\r\n  subscriptions_count: number\r\n  pending_funding: number\r\n  funded_amount: number\r\n}\r\n\r\ntype PendingSettlement = {\r\n  id: string\r\n  investor_name: string\r\n  investor_entity: string | null\r\n  deal_name: string\r\n  deal_id: string\r\n  commitment_amount: number\r\n  funded_amount: number\r\n  outstanding_amount: number\r\n  currency: string\r\n  funding_due_at: string | null\r\n  status: string\r\n  days_overdue: number\r\n}\r\n\r\ntype FeeEvent = {\r\n  id: string\r\n  deal_id: string\r\n  deal_name: string\r\n  investor_name: string\r\n  subscription_id: string | null\r\n  fee_type: string | null\r\n  base_amount: number | null\r\n  computed_amount: number\r\n  currency: string\r\n  status: string\r\n  event_date: string\r\n  invoice_id: string | null\r\n  invoice_number: string | null\r\n  invoice_status: string | null\r\n  invoice_due_date: string | null\r\n  default_payment_type?: 'introducer' | 'commercial_partner' | 'partner' | 'seller'\r\n  default_recipient_id?: string | null\r\n}\r\n\r\ntype Summary = {\r\n  totalDeals: number\r\n  pendingSettlements: number\r\n  totalPendingValue: number\r\n  overdueSettlements: number\r\n}\r\n\r\nconst STATUS_STYLES: Record<string, string> = {\r\n  pending: 'bg-yellow-100 text-yellow-800 border-yellow-200',\r\n  funded: 'bg-green-100 text-green-800 border-green-200',\r\n  partially_funded: 'bg-blue-100 text-blue-800 border-blue-200',\r\n  overdue: 'bg-red-100 text-red-800 border-red-200',\r\n  cancelled: 'bg-gray-100 text-gray-800 border-gray-200',\r\n}\r\n\r\nconst FEE_STATUS_STYLES: Record<string, string> = {\r\n  accrued: 'bg-blue-100 text-blue-800 border-blue-200',\r\n  invoiced: 'bg-amber-100 text-amber-800 border-amber-200',\r\n  paid: 'bg-emerald-100 text-emerald-800 border-emerald-200',\r\n  waived: 'bg-gray-100 text-gray-800 border-gray-200',\r\n  cancelled: 'bg-gray-100 text-gray-800 border-gray-200',\r\n  disputed: 'bg-red-100 text-red-800 border-red-200',\r\n  voided: 'bg-gray-100 text-gray-800 border-gray-200'\r\n}\r\n\r\nconst STATUS_FILTERS = [\r\n  { label: 'All Status', value: 'all' },\r\n  { label: 'Pending', value: 'pending' },\r\n  { label: 'Partially Funded', value: 'partially_funded' },\r\n  { label: 'Funded', value: 'funded' },\r\n  { label: 'Overdue', value: 'overdue' },\r\n]\r\n\r\nexport default function EscrowPage() {\r\n  const [lawyerInfo, setLawyerInfo] = useState<LawyerInfo | null>(null)\r\n  const [arrangerInfo, setArrangerInfo] = useState<ArrangerInfo | null>(null)\r\n  const [escrowDeals, setEscrowDeals] = useState<EscrowDeal[]>([])\r\n  const [pendingSettlements, setPendingSettlements] = useState<PendingSettlement[]>([])\r\n  const [feeEvents, setFeeEvents] = useState<FeeEvent[]>([])\r\n  const [summary, setSummary] = useState<Summary>({\r\n    totalDeals: 0,\r\n    pendingSettlements: 0,\r\n    totalPendingValue: 0,\r\n    overdueSettlements: 0,\r\n  })\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [search, setSearch] = useState('')\r\n  const [statusFilter, setStatusFilter] = useState('all')\r\n  const [activeTab, setActiveTab] = useState('deals')\r\n  const [refreshKey, setRefreshKey] = useState(0)\r\n  const [dateRange, setDateRange] = useState<DateRange | undefined>(undefined)\r\n\r\n  // Modal state for escrow confirmations\r\n  const [confirmModalOpen, setConfirmModalOpen] = useState(false)\r\n  const [confirmMode, setConfirmMode] = useState<'funding' | 'payment'>('funding')\r\n  const [selectedSettlement, setSelectedSettlement] = useState<PendingSettlement | null>(null)\r\n  const [selectedFeeEvent, setSelectedFeeEvent] = useState<FeeEvent | null>(null)\r\n\r\n  const handleOpenConfirmFunding = (settlement: PendingSettlement) => {\r\n    setConfirmMode('funding')\r\n    setSelectedSettlement(settlement)\r\n    setSelectedFeeEvent(null)\r\n    setConfirmModalOpen(true)\r\n  }\r\n\r\n  const handleOpenConfirmPayment = (event: FeeEvent) => {\r\n    setConfirmMode('payment')\r\n    setSelectedFeeEvent(event)\r\n    setSelectedSettlement(null)\r\n    setConfirmModalOpen(true)\r\n  }\r\n\r\n  const handleConfirmSuccess = useCallback(() => {\r\n    // Refresh data after successful confirmation without full page reload\r\n    setRefreshKey(prev => prev + 1)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      try {\r\n        setLoading(true)\r\n        const supabase = createClient()\r\n\r\n        // Get current user\r\n        const { data: { user } } = await supabase.auth.getUser()\r\n        if (!user) {\r\n          setError('Not authenticated')\r\n          return\r\n        }\r\n\r\n        // Check if user is a lawyer FIRST (highest priority for escrow access)\r\n        const { data: lawyerUser, error: lawyerUserError } = await supabase\r\n          .from('lawyer_users')\r\n          .select('lawyer_id')\r\n          .eq('user_id', user.id)\r\n          .maybeSingle()\r\n\r\n        if (lawyerUser) {\r\n          // Fetch lawyer info\r\n          const { data: lawyer, error: lawyerError } = await supabase\r\n            .from('lawyers')\r\n            .select('id, firm_name, display_name, specializations, is_active, assigned_deals')\r\n            .eq('id', lawyerUser.lawyer_id)\r\n            .single()\r\n\r\n          if (!lawyerError && lawyer) {\r\n            setLawyerInfo(lawyer)\r\n            // Fetch deals assigned to this lawyer\r\n            await fetchLawyerEscrowData(supabase, lawyer.id, lawyer.assigned_deals)\r\n            return\r\n          }\r\n        }\r\n\r\n        // Check if user is an arranger SECOND (arrangers can view escrow for their deals)\r\n        const { data: arrangerUser, error: arrangerUserError } = await supabase\r\n          .from('arranger_users')\r\n          .select('arranger_id')\r\n          .eq('user_id', user.id)\r\n          .maybeSingle()\r\n\r\n        if (arrangerUser) {\r\n          // Fetch arranger info\r\n          // Note: arranger_entities uses 'status' not 'is_active', and has no 'company_name'\r\n          const { data: arranger, error: arrangerError } = await supabase\r\n            .from('arranger_entities')\r\n            .select('id, legal_name, status')\r\n            .eq('id', arrangerUser.arranger_id)\r\n            .single()\r\n\r\n          if (!arrangerError && arranger) {\r\n            setArrangerInfo(arranger)\r\n            // Fetch deals managed by this arranger\r\n            await fetchArrangerEscrowData(supabase, arranger.id)\r\n            return\r\n          }\r\n        }\r\n\r\n        // SECURITY: Block partners from accessing escrow/wire info\r\n        // Partners should not see sensitive bank routing information\r\n        // NOTE: This check comes AFTER lawyer/arranger checks to support multi-persona users\r\n        // (a user who is both partner and arranger should get arranger access)\r\n        const { data: partnerUser } = await supabase\r\n          .from('partner_users')\r\n          .select('partner_id')\r\n          .eq('user_id', user.id)\r\n          .maybeSingle()\r\n\r\n        if (partnerUser) {\r\n          setError('Access restricted. Partners cannot access escrow information.')\r\n          return\r\n        }\r\n\r\n        // Staff view - show all escrow data\r\n        await fetchAllEscrowData(supabase)\r\n\r\n        setError(null)\r\n      } catch (err) {\r\n        console.error('[EscrowPage] Error:', err)\r\n        setError(err instanceof Error ? err.message : 'Failed to load escrow data')\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    async function fetchArrangerEscrowData(supabase: any, arrangerId: string) {\r\n      // Get deals managed by this arranger (where arranger_entity_id matches)\r\n      const { data: managedDeals, error: dealsError } = await supabase\r\n        .from('deals')\r\n        .select('id')\r\n        .eq('arranger_entity_id', arrangerId)\r\n\r\n      const dealIds = (managedDeals || []).map((d: any) => d.id)\r\n\r\n      if (dealIds.length === 0) {\r\n        // No deals managed by this arranger\r\n        await processEscrowData(supabase, [])\r\n        return\r\n      }\r\n\r\n      // Get deal fee structures for managed deals\r\n      const { data: feeStructures, error: feeError } = await supabase\r\n        .from('deal_fee_structures')\r\n        .select(`\r\n          id,\r\n          deal_id,\r\n          status,\r\n          legal_counsel,\r\n          wire_escrow_agent,\r\n          wire_bank_name,\r\n          wire_account_holder,\r\n          wire_iban,\r\n          wire_bic,\r\n          escrow_fee_text,\r\n          deal:deal_id (\r\n            id,\r\n            name,\r\n            company_name,\r\n            target_amount,\r\n            currency,\r\n            status\r\n          )\r\n        `)\r\n        .in('deal_id', dealIds)\r\n        .eq('status', 'published')\r\n        .order('created_at', { ascending: false })\r\n\r\n      if (feeError) throw feeError\r\n\r\n      await processEscrowData(supabase, feeStructures || [])\r\n    }\r\n\r\n    async function fetchLawyerEscrowData(supabase: any, lawyerId: string, lawyerAssignedDeals: string[] | null) {\r\n      // Get deals assigned to this lawyer via deal_lawyer_assignments table\r\n      const { data: assignments, error: assignmentsError } = await supabase\r\n        .from('deal_lawyer_assignments')\r\n        .select('deal_id')\r\n        .eq('lawyer_id', lawyerId)\r\n\r\n      let dealIds = (assignments || []).map((a: any) => a.deal_id)\r\n\r\n      // Fallback to lawyers.assigned_deals array if no assignments found\r\n      if ((!dealIds.length || assignmentsError) && lawyerAssignedDeals?.length) {\r\n        dealIds = lawyerAssignedDeals\r\n      }\r\n\r\n      if (dealIds.length === 0) {\r\n        // No deals assigned\r\n        await processEscrowData(supabase, [])\r\n        return\r\n      }\r\n\r\n      // Get deal fee structures for assigned deals\r\n      const { data: feeStructures, error: feeError } = await supabase\r\n        .from('deal_fee_structures')\r\n        .select(`\r\n          id,\r\n          deal_id,\r\n          status,\r\n          legal_counsel,\r\n          wire_escrow_agent,\r\n          wire_bank_name,\r\n          wire_account_holder,\r\n          wire_iban,\r\n          wire_bic,\r\n          escrow_fee_text,\r\n          deal:deal_id (\r\n            id,\r\n            name,\r\n            company_name,\r\n            target_amount,\r\n            currency,\r\n            status\r\n          )\r\n        `)\r\n        .in('deal_id', dealIds)\r\n        .eq('status', 'published')\r\n        .order('created_at', { ascending: false })\r\n\r\n      if (feeError) throw feeError\r\n\r\n      await processEscrowData(supabase, feeStructures || [])\r\n    }\r\n\r\n    async function fetchAllEscrowData(supabase: any) {\r\n      // Staff view - get all deals with fee structures that have escrow data\r\n      const { data: feeStructures, error: feeError } = await supabase\r\n        .from('deal_fee_structures')\r\n        .select(`\r\n          id,\r\n          deal_id,\r\n          status,\r\n          legal_counsel,\r\n          wire_escrow_agent,\r\n          wire_bank_name,\r\n          wire_account_holder,\r\n          wire_iban,\r\n          wire_bic,\r\n          escrow_fee_text,\r\n          deal:deal_id (\r\n            id,\r\n            name,\r\n            company_name,\r\n            target_amount,\r\n            currency,\r\n            status\r\n          )\r\n        `)\r\n        .not('wire_escrow_agent', 'is', null)\r\n        .eq('status', 'published')\r\n        .order('created_at', { ascending: false })\r\n        .limit(100)\r\n\r\n      if (feeError) throw feeError\r\n\r\n      await processEscrowData(supabase, feeStructures || [])\r\n    }\r\n\r\n    async function processEscrowData(supabase: any, feeStructures: any[]) {\r\n      if (feeStructures.length === 0) {\r\n        setEscrowDeals([])\r\n        setPendingSettlements([])\r\n        setFeeEvents([])\r\n        setSummary({\r\n          totalDeals: 0,\r\n          pendingSettlements: 0,\r\n          totalPendingValue: 0,\r\n          overdueSettlements: 0,\r\n        })\r\n        return\r\n      }\r\n\r\n      const dealIds = feeStructures.map((fs: any) => fs.deal_id)\r\n\r\n      // Get subscriptions for these deals\r\n      const { data: subscriptions, error: subError } = await supabase\r\n        .from('subscriptions')\r\n        .select(`\r\n          id,\r\n          deal_id,\r\n          investor_id,\r\n          introducer_id,\r\n          proxy_commercial_partner_id,\r\n          commitment,\r\n          funded_amount,\r\n          outstanding_amount,\r\n          funding_due_at,\r\n          status,\r\n          funded_at,\r\n          investor:investor_id (\r\n            id,\r\n            display_name,\r\n            legal_name\r\n          )\r\n        `)\r\n        .in('deal_id', dealIds)\r\n        .in('status', ['committed', 'approved', 'funded', 'active', 'partially_funded'])\r\n        .order('created_at', { ascending: false })\r\n\r\n      if (subError) throw subError\r\n\r\n      // Process escrow deals\r\n      const deals: EscrowDeal[] = feeStructures.map((fs: any) => {\r\n        const dealSubs = (subscriptions || []).filter((s: any) => s.deal_id === fs.deal_id)\r\n        const pendingFunding = dealSubs.reduce((sum: number, s: any) =>\r\n          sum + (Number(s.outstanding_amount) || 0), 0)\r\n        const fundedAmount = dealSubs.reduce((sum: number, s: any) =>\r\n          sum + (Number(s.funded_amount) || 0), 0)\r\n\r\n        return {\r\n          id: fs.id,\r\n          deal_id: fs.deal_id,\r\n          deal_name: fs.deal?.name || 'Unknown Deal',\r\n          company_name: fs.deal?.company_name,\r\n          status: fs.status,\r\n          legal_counsel: fs.legal_counsel,\r\n          wire_escrow_agent: fs.wire_escrow_agent,\r\n          wire_bank_name: fs.wire_bank_name,\r\n          wire_account_holder: fs.wire_account_holder,\r\n          wire_iban: fs.wire_iban,\r\n          wire_bic: fs.wire_bic,\r\n          escrow_fee_text: fs.escrow_fee_text,\r\n          target_amount: Number(fs.deal?.target_amount) || 0,\r\n          currency: fs.deal?.currency || 'USD',\r\n          subscriptions_count: dealSubs.length,\r\n          pending_funding: pendingFunding,\r\n          funded_amount: fundedAmount,\r\n        }\r\n      })\r\n\r\n      setEscrowDeals(deals)\r\n\r\n      // Process pending settlements\r\n      const today = new Date()\r\n      const settlements: PendingSettlement[] = (subscriptions || [])\r\n        .filter((s: any) => (Number(s.outstanding_amount) || 0) > 0)\r\n        .map((s: any) => {\r\n          const dueDate = s.funding_due_at ? new Date(s.funding_due_at) : null\r\n          const daysOverdue = dueDate ? Math.floor((today.getTime() - dueDate.getTime()) / (1000 * 60 * 60 * 24)) : 0\r\n          const deal = feeStructures.find((fs: any) => fs.deal_id === s.deal_id)\r\n\r\n          let status = s.status\r\n          if (daysOverdue > 0) status = 'overdue'\r\n          else if (Number(s.funded_amount) > 0) status = 'partially_funded'\r\n          else status = 'pending'\r\n\r\n          return {\r\n            id: s.id,\r\n            investor_name: s.investor?.display_name || 'Unknown Investor',\r\n            investor_entity: s.investor?.legal_name,\r\n            deal_name: deal?.deal?.name || 'Unknown Deal',\r\n            deal_id: s.deal_id,\r\n            commitment_amount: Number(s.commitment) || 0,\r\n            funded_amount: Number(s.funded_amount) || 0,\r\n            outstanding_amount: Number(s.outstanding_amount) || 0,\r\n            currency: deal?.deal?.currency || 'USD',\r\n            funding_due_at: s.funding_due_at,\r\n            status,\r\n            days_overdue: Math.max(0, daysOverdue),\r\n          }\r\n        })\r\n\r\n      setPendingSettlements(settlements)\r\n\r\n      const subscriptionMetaById = new Map<string, { introducer_id: string | null; proxy_commercial_partner_id: string | null }>()\r\n      ;(subscriptions || []).forEach((sub: any) => {\r\n        if (sub?.id) {\r\n          subscriptionMetaById.set(sub.id, {\r\n            introducer_id: sub.introducer_id || null,\r\n            proxy_commercial_partner_id: sub.proxy_commercial_partner_id || null\r\n          })\r\n        }\r\n      })\r\n\r\n      // Calculate summary\r\n      const overdueCount = settlements.filter(s => s.days_overdue > 0).length\r\n      const totalPending = settlements.reduce((sum, s) => sum + s.outstanding_amount, 0)\r\n\r\n      setSummary({\r\n        totalDeals: deals.length,\r\n        pendingSettlements: settlements.length,\r\n        totalPendingValue: totalPending,\r\n        overdueSettlements: overdueCount,\r\n      })\r\n\r\n      // Fetch fee events for assigned deals (payment confirmations)\r\n      const { data: feeEventsData, error: feeEventsError } = await supabase\r\n        .from('fee_events')\r\n        .select(`\r\n          id,\r\n          deal_id,\r\n          investor_id,\r\n          fee_type,\r\n          base_amount,\r\n          computed_amount,\r\n          currency,\r\n          status,\r\n          event_date,\r\n          invoice_id,\r\n          allocation_id,\r\n          investors (\r\n            display_name,\r\n            legal_name\r\n          ),\r\n          invoices:invoice_id (\r\n            invoice_number,\r\n            status,\r\n            due_date\r\n          )\r\n        `)\r\n        .in('deal_id', dealIds)\r\n        .order('event_date', { ascending: false })\r\n\r\n      if (feeEventsError) {\r\n        console.error('[EscrowPage] Failed to load fee events:', feeEventsError)\r\n        setFeeEvents([])\r\n      } else {\r\n        const dealNameById = new Map<string, string>()\r\n        feeStructures.forEach((fs: any) => {\r\n          if (fs?.deal_id && fs?.deal?.name) {\r\n            dealNameById.set(fs.deal_id, fs.deal.name)\r\n          }\r\n        })\r\n\r\n        const mappedFeeEvents: FeeEvent[] = (feeEventsData || []).map((event: any) => {\r\n          const investor = Array.isArray(event.investors) ? event.investors[0] : event.investors\r\n          const invoice = Array.isArray(event.invoices) ? event.invoices[0] : event.invoices\r\n          const subscriptionMeta = event.allocation_id ? subscriptionMetaById.get(event.allocation_id) : null\r\n          let defaultPaymentType: FeeEvent['default_payment_type']\r\n          let defaultRecipientId: string | null = null\r\n\r\n          if (subscriptionMeta?.introducer_id) {\r\n            defaultPaymentType = 'introducer'\r\n            defaultRecipientId = subscriptionMeta.introducer_id\r\n          } else if (subscriptionMeta?.proxy_commercial_partner_id) {\r\n            defaultPaymentType = 'commercial_partner'\r\n            defaultRecipientId = subscriptionMeta.proxy_commercial_partner_id\r\n          }\r\n\r\n          return {\r\n            id: event.id,\r\n            deal_id: event.deal_id,\r\n            deal_name: dealNameById.get(event.deal_id) || 'Unknown Deal',\r\n            investor_name: investor?.display_name || investor?.legal_name || 'Unknown Investor',\r\n            subscription_id: event.allocation_id || null,\r\n            fee_type: event.fee_type || null,\r\n            base_amount: event.base_amount ?? null,\r\n            computed_amount: Number(event.computed_amount || 0),\r\n            currency: event.currency || 'USD',\r\n            status: event.status || 'accrued',\r\n            event_date: event.event_date,\r\n            invoice_id: event.invoice_id || null,\r\n            invoice_number: invoice?.invoice_number || null,\r\n            invoice_status: invoice?.status || null,\r\n            invoice_due_date: invoice?.due_date || null,\r\n            default_payment_type: defaultPaymentType,\r\n            default_recipient_id: defaultRecipientId\r\n          }\r\n        })\r\n\r\n        setFeeEvents(mappedFeeEvents)\r\n      }\r\n    }\r\n\r\n    fetchData()\r\n  }, [refreshKey])\r\n\r\n  // Filter settlements\r\n  const filteredSettlements = pendingSettlements.filter(settlement => {\r\n    const matchesStatus = statusFilter === 'all' || settlement.status === statusFilter\r\n    const matchesSearch = !search ||\r\n      settlement.investor_name?.toLowerCase().includes(search.toLowerCase()) ||\r\n      settlement.deal_name?.toLowerCase().includes(search.toLowerCase()) ||\r\n      settlement.investor_entity?.toLowerCase().includes(search.toLowerCase())\r\n\r\n    // Date range filter\r\n    let matchesDateRange = true\r\n    if (dateRange?.from && settlement.funding_due_at) {\r\n      const dueDate = new Date(settlement.funding_due_at)\r\n      matchesDateRange = dueDate >= dateRange.from\r\n      if (dateRange.to) {\r\n        matchesDateRange = matchesDateRange && dueDate <= dateRange.to\r\n      }\r\n    }\r\n\r\n    return matchesStatus && matchesSearch && matchesDateRange\r\n  })\r\n\r\n  // Filter deals\r\n  const filteredDeals = escrowDeals.filter(deal => {\r\n    const matchesSearch = !search ||\r\n      deal.deal_name?.toLowerCase().includes(search.toLowerCase()) ||\r\n      deal.company_name?.toLowerCase().includes(search.toLowerCase()) ||\r\n      deal.wire_escrow_agent?.toLowerCase().includes(search.toLowerCase())\r\n    return matchesSearch\r\n  })\r\n\r\n  // Filter fee events\r\n  const filteredFeeEvents = feeEvents.filter(event => {\r\n    const matchesSearch = !search ||\r\n      event.deal_name.toLowerCase().includes(search.toLowerCase()) ||\r\n      event.investor_name.toLowerCase().includes(search.toLowerCase())\r\n\r\n    // Date range filter\r\n    let matchesDateRange = true\r\n    if (dateRange?.from && event.event_date) {\r\n      const eventDate = new Date(event.event_date)\r\n      matchesDateRange = eventDate >= dateRange.from\r\n      if (dateRange.to) {\r\n        matchesDateRange = matchesDateRange && eventDate <= dateRange.to\r\n      }\r\n    }\r\n\r\n    return matchesSearch && matchesDateRange\r\n  })\r\n\r\n  // Export to CSV function\r\n  const exportToCSV = useCallback(() => {\r\n    const headers = ['Deal', 'Investor', 'Entity', 'Commitment', 'Funded', 'Outstanding', 'Status', 'Due Date']\r\n    const rows = filteredSettlements.map(s => [\r\n      s.deal_name,\r\n      s.investor_name,\r\n      s.investor_entity || '',\r\n      s.commitment_amount.toString(),\r\n      s.funded_amount.toString(),\r\n      s.outstanding_amount.toString(),\r\n      s.status.replace('_', ' '),\r\n      s.funding_due_at || ''\r\n    ])\r\n\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...rows.map(row => row.map(cell => `\"${cell.replace(/\"/g, '\"\"')}\"`).join(','))\r\n    ].join('\\n')\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })\r\n    const link = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    link.setAttribute('href', url)\r\n    link.setAttribute('download', `escrow-settlements-${new Date().toISOString().split('T')[0]}.csv`)\r\n    link.style.visibility = 'hidden'\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n    URL.revokeObjectURL(url)\r\n  }, [filteredSettlements])\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-16\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\r\n        <span className=\"ml-3 text-muted-foreground\">Loading escrow data...</span>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"text-center py-16\">\r\n        <AlertCircle className=\"h-12 w-12 text-destructive mx-auto mb-4\" />\r\n        <h3 className=\"text-lg font-medium text-foreground mb-2\">Error Loading Escrow Data</h3>\r\n        <p className=\"text-muted-foreground\">{error}</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-foreground\">Escrow Management</h1>\r\n          <p className=\"text-muted-foreground mt-1\">\r\n            {lawyerInfo\r\n              ? `Manage escrow accounts and settlements for ${lawyerInfo.display_name}`\r\n              : arrangerInfo\r\n                ? `View escrow status for deals managed by ${arrangerInfo.legal_name}`\r\n                : 'Monitor all escrow accounts and pending settlements'}\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          {pendingSettlements.length > 0 && (\r\n            <Button variant=\"outline\" size=\"sm\" onClick={exportToCSV}>\r\n              <Download className=\"h-4 w-4 mr-2\" />\r\n              Export CSV\r\n            </Button>\r\n          )}\r\n          {lawyerInfo && lawyerInfo.specializations && lawyerInfo.specializations.length > 0 && (\r\n            <div className=\"flex gap-1\">\r\n              {lawyerInfo.specializations.slice(0, 2).map((spec, idx) => (\r\n                <Badge key={idx} variant=\"outline\" className=\"capitalize\">\r\n                  {spec}\r\n                </Badge>\r\n              ))}\r\n            </div>\r\n          )}\r\n          {arrangerInfo && (\r\n            <Badge variant=\"secondary\" className=\"flex items-center gap-1\">\r\n              <Building2 className=\"h-3 w-3\" />\r\n              Arranger View\r\n            </Badge>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Arranger Info Banner - explains view-only access */}\r\n      {arrangerInfo && !lawyerInfo && (\r\n        <div className=\"flex items-start gap-3 rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-800 dark:bg-blue-950/30\">\r\n          <Info className=\"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 shrink-0\" />\r\n          <div className=\"text-sm\">\r\n            <p className=\"font-medium text-blue-900 dark:text-blue-100\">View-Only Access</p>\r\n            <p className=\"text-blue-700 dark:text-blue-300 mt-0.5\">\r\n              As an arranger, you can monitor escrow status and view transaction details for deals you manage.\r\n              Funding confirmations and fee payments are handled by assigned lawyers.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Summary Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <Lock className=\"h-4 w-4\" />\r\n              Escrow Deals\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{summary.totalDeals}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Active escrow accounts\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <Clock className=\"h-4 w-4\" />\r\n              Pending Settlements\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-yellow-600\">{summary.pendingSettlements}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Awaiting funding\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <DollarSign className=\"h-4 w-4\" />\r\n              Pending Value\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-blue-600\">\r\n              {formatCurrency(summary.totalPendingValue, 'USD')}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Total outstanding\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <AlertTriangle className=\"h-4 w-4\" />\r\n              Overdue\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-red-600\">{summary.overdueSettlements}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Past due date\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex flex-col md:flex-row gap-4\">\r\n            <div className=\"flex-1\">\r\n              <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder=\"Search deals, investors, or escrow agents...\"\r\n                  value={search}\r\n                  onChange={(e) => setSearch(e.target.value)}\r\n                  className=\"pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n            {activeTab === 'settlements' && (\r\n              <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                <SelectTrigger className=\"w-full md:w-48\">\r\n                  <SelectValue placeholder=\"Filter by status\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {STATUS_FILTERS.map((option) => (\r\n                    <SelectItem key={option.value} value={option.value}>\r\n                      {option.label}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            )}\r\n            {(activeTab === 'settlements' || activeTab === 'payments') && (\r\n              <DateRangePicker\r\n                value={dateRange}\r\n                onChange={setDateRange}\r\n                className=\"w-full md:w-auto\"\r\n              />\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Tabs */}\r\n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-4\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"deals\" className=\"flex items-center gap-2\">\r\n            <Wallet className=\"h-4 w-4\" />\r\n            Escrow Accounts ({escrowDeals.length})\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"settlements\" className=\"flex items-center gap-2\">\r\n            <BanknoteIcon className=\"h-4 w-4\" />\r\n            Pending Settlements ({pendingSettlements.length})\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"payments\" className=\"flex items-center gap-2\">\r\n            <CreditCard className=\"h-4 w-4\" />\r\n            Fee Payments ({feeEvents.length})\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"deals\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Escrow Accounts</CardTitle>\r\n              <CardDescription>\r\n                {filteredDeals.length} deal{filteredDeals.length !== 1 ? 's' : ''} with escrow accounts\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {filteredDeals.length === 0 ? (\r\n                <div className=\"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2\">\r\n                  <Lock className=\"h-10 w-10 text-muted-foreground\" />\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {search\r\n                      ? 'No escrow accounts match your search'\r\n                      : lawyerInfo\r\n                        ? 'No deals with you as legal counsel'\r\n                        : arrangerInfo\r\n                          ? 'No deals managed by your arranger entity'\r\n                          : 'No deals with escrow accounts found'}\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"rounded-md border\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Deal</TableHead>\r\n                        <TableHead>Escrow Agent</TableHead>\r\n                        <TableHead>Bank</TableHead>\r\n                        <TableHead>Subscriptions</TableHead>\r\n                        <TableHead>Funded / Pending</TableHead>\r\n                        <TableHead className=\"text-right\">Actions</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {filteredDeals.map((deal) => (\r\n                        <TableRow key={deal.id}>\r\n                          <TableCell>\r\n                            <div className=\"flex items-center gap-3\">\r\n                              <div className=\"h-10 w-10 rounded-lg bg-muted flex items-center justify-center\">\r\n                                <Building2 className=\"h-5 w-5 text-muted-foreground\" />\r\n                              </div>\r\n                              <div>\r\n                                <div className=\"font-medium\">{deal.deal_name}</div>\r\n                                {deal.company_name && (\r\n                                  <div className=\"text-xs text-muted-foreground\">\r\n                                    {deal.company_name}\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"font-medium\">\r\n                              {deal.wire_escrow_agent || '—'}\r\n                            </div>\r\n                            {deal.escrow_fee_text && (\r\n                              <div className=\"text-xs text-muted-foreground\">\r\n                                {deal.escrow_fee_text}\r\n                              </div>\r\n                            )}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div>\r\n                              <div className=\"text-sm\">{deal.wire_bank_name || '—'}</div>\r\n                              {deal.wire_iban && (\r\n                                <div className=\"text-xs text-muted-foreground font-mono\">\r\n                                  {deal.wire_iban.slice(0, 8)}...\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <Badge variant=\"secondary\">\r\n                              {deal.subscriptions_count} investor{deal.subscriptions_count !== 1 ? 's' : ''}\r\n                            </Badge>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"space-y-1\">\r\n                              <div className=\"text-sm font-medium text-green-600\">\r\n                                {formatCurrency(deal.funded_amount, deal.currency)} funded\r\n                              </div>\r\n                              {deal.pending_funding > 0 && (\r\n                                <div className=\"text-xs text-yellow-600\">\r\n                                  {formatCurrency(deal.pending_funding, deal.currency)} pending\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right\">\r\n                            <Button variant=\"ghost\" size=\"sm\" asChild>\r\n                              <a href={lawyerInfo ? `/versotech_main/lawyer-deal/${deal.deal_id}` : `/versotech_main/opportunities/${deal.deal_id}`}>\r\n                                <ArrowUpRight className=\"h-4 w-4\" />\r\n                              </a>\r\n                            </Button>\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"settlements\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Pending Settlements</CardTitle>\r\n              <CardDescription>\r\n                {filteredSettlements.length} settlement{filteredSettlements.length !== 1 ? 's' : ''} awaiting funding\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {filteredSettlements.length === 0 ? (\r\n                <div className=\"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2\">\r\n                  <CheckCircle2 className=\"h-10 w-10 text-muted-foreground\" />\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {search || statusFilter !== 'all'\r\n                      ? 'No settlements match your filters'\r\n                      : 'No pending settlements'}\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"rounded-md border\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Investor</TableHead>\r\n                        <TableHead>Deal</TableHead>\r\n                        <TableHead>Commitment</TableHead>\r\n                        <TableHead>Outstanding</TableHead>\r\n                        <TableHead>Due Date</TableHead>\r\n                        <TableHead>Status</TableHead>\r\n                        <TableHead className=\"text-right\">Actions</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {filteredSettlements.map((settlement) => (\r\n                        <TableRow key={settlement.id}>\r\n                          <TableCell>\r\n                            <div>\r\n                              <div className=\"font-medium\">{settlement.investor_name}</div>\r\n                              {settlement.investor_entity && (\r\n                                <div className=\"text-xs text-muted-foreground\">\r\n                                  {settlement.investor_entity}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <a\r\n                              href={lawyerInfo ? `/versotech_main/lawyer-deal/${settlement.deal_id}` : `/versotech_main/opportunities/${settlement.deal_id}`}\r\n                              className=\"text-primary hover:underline\"\r\n                            >\r\n                              {settlement.deal_name}\r\n                            </a>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"font-medium\">\r\n                              {formatCurrency(settlement.commitment_amount, settlement.currency)}\r\n                            </div>\r\n                            {settlement.funded_amount > 0 && (\r\n                              <div className=\"text-xs text-green-600\">\r\n                                {formatCurrency(settlement.funded_amount, settlement.currency)} received\r\n                              </div>\r\n                            )}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"font-medium text-yellow-600\">\r\n                              {formatCurrency(settlement.outstanding_amount, settlement.currency)}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            {settlement.funding_due_at ? (\r\n                              <div className={cn(\r\n                                \"text-sm\",\r\n                                settlement.days_overdue > 0 && \"text-red-600 font-medium\"\r\n                              )}>\r\n                                {formatDate(settlement.funding_due_at)}\r\n                                {settlement.days_overdue > 0 && (\r\n                                  <div className=\"text-xs\">\r\n                                    {settlement.days_overdue} day{settlement.days_overdue !== 1 ? 's' : ''} overdue\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            ) : (\r\n                              <span className=\"text-muted-foreground text-xs\">Not set</span>\r\n                            )}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <Badge\r\n                              variant=\"outline\"\r\n                              className={cn('capitalize', STATUS_STYLES[settlement.status] || STATUS_STYLES.pending)}\r\n                            >\r\n                              {settlement.status.replace('_', ' ')}\r\n                            </Badge>\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right\">\r\n                            {settlement.status !== 'funded' && lawyerInfo && (\r\n                              <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleOpenConfirmFunding(settlement)}\r\n                              >\r\n                                <CheckCircle2 className=\"h-4 w-4 mr-1\" />\r\n                                Confirm Funding\r\n                              </Button>\r\n                            )}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"payments\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Fee Payments</CardTitle>\r\n              <CardDescription>\r\n                {filteredFeeEvents.length} fee event{filteredFeeEvents.length !== 1 ? 's' : ''} for assigned deals\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {filteredFeeEvents.length === 0 ? (\r\n                <div className=\"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2\">\r\n                  <CreditCard className=\"h-10 w-10 text-muted-foreground\" />\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {search ? 'No fee events match your filters' : 'No fee events to display'}\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"rounded-md border\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Deal</TableHead>\r\n                        <TableHead>Investor</TableHead>\r\n                        <TableHead>Fee Type</TableHead>\r\n                        <TableHead>Amount</TableHead>\r\n                        <TableHead>Invoice</TableHead>\r\n                        <TableHead>Due Date</TableHead>\r\n                        <TableHead>Status</TableHead>\r\n                        <TableHead className=\"text-right\">Actions</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {filteredFeeEvents.map((event) => (\r\n                        <TableRow key={event.id}>\r\n                          <TableCell>\r\n                            <div className=\"font-medium\">{event.deal_name}</div>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"font-medium\">{event.investor_name}</div>\r\n                          </TableCell>\r\n                          <TableCell className=\"capitalize\">\r\n                            {(event.fee_type || 'fee').replace('_', ' ')}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"font-medium\">\r\n                              {formatCurrency(event.computed_amount, event.currency)}\r\n                            </div>\r\n                            {event.base_amount != null && (\r\n                              <div className=\"text-xs text-muted-foreground\">\r\n                                Base: {formatCurrency(event.base_amount, event.currency)}\r\n                              </div>\r\n                            )}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            {event.invoice_number ? (\r\n                              <div>\r\n                                <div className=\"text-sm font-medium\">{event.invoice_number}</div>\r\n                                {event.invoice_status && (\r\n                                  <div className=\"text-xs text-muted-foreground capitalize\">\r\n                                    {event.invoice_status.replace('_', ' ')}\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            ) : (\r\n                              <span className=\"text-xs text-muted-foreground\">Not issued</span>\r\n                            )}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            {event.invoice_due_date ? (\r\n                              <div className=\"text-sm\">{formatDate(event.invoice_due_date)}</div>\r\n                            ) : (\r\n                              <span className=\"text-xs text-muted-foreground\">Not set</span>\r\n                            )}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <Badge\r\n                              variant=\"outline\"\r\n                              className={cn('capitalize', FEE_STATUS_STYLES[event.status] || 'bg-gray-100 text-gray-800 border-gray-200')}\r\n                            >\r\n                              {event.status.replace('_', ' ')}\r\n                            </Badge>\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right\">\r\n                            {['accrued', 'invoiced'].includes(event.status) && event.subscription_id && lawyerInfo && (\r\n                              <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleOpenConfirmPayment(event)}\r\n                              >\r\n                                <CheckCircle2 className=\"h-4 w-4 mr-1\" />\r\n                                Confirm Payment\r\n                              </Button>\r\n                            )}\r\n                            {['accrued', 'invoiced'].includes(event.status) && !event.subscription_id && lawyerInfo && (\r\n                              <span className=\"text-xs text-muted-foreground\">No subscription</span>\r\n                            )}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Escrow Confirmation Modal */}\r\n      {(selectedSettlement || selectedFeeEvent) && (\r\n        <EscrowConfirmModal\r\n          open={confirmModalOpen}\r\n          onOpenChange={setConfirmModalOpen}\r\n          mode={confirmMode}\r\n          subscriptionId={selectedSettlement?.id || selectedFeeEvent?.subscription_id || ''}\r\n          investorName={selectedSettlement?.investor_name || selectedFeeEvent?.investor_name || 'Recipient'}\r\n          dealName={selectedSettlement?.deal_name || selectedFeeEvent?.deal_name || 'Deal'}\r\n          commitment={selectedSettlement?.commitment_amount || 0}\r\n          fundedAmount={selectedSettlement?.funded_amount || 0}\r\n          currency={selectedSettlement?.currency || selectedFeeEvent?.currency || 'USD'}\r\n          feeEventId={selectedFeeEvent?.id || null}\r\n          defaultAmount={selectedFeeEvent?.computed_amount || null}\r\n          defaultPaymentType={selectedFeeEvent?.default_payment_type}\r\n          defaultRecipientId={selectedFeeEvent?.default_recipient_id || null}\r\n          onSuccess={handleConfirmSuccess}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport { Loader2, CheckCircle } from 'lucide-react'\r\nimport { toast } from 'sonner'\r\n\r\ninterface EscrowConfirmModalProps {\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  subscriptionId: string\r\n  dealName: string\r\n  investorName: string\r\n  commitment: number\r\n  fundedAmount: number\r\n  currency: string\r\n  mode: 'funding' | 'payment'\r\n  onSuccess?: () => void\r\n  feeEventId?: string | null\r\n  defaultAmount?: number | null\r\n  defaultPaymentType?: 'partner' | 'introducer' | 'commercial_partner' | 'seller'\r\n  defaultRecipientId?: string | null\r\n}\r\n\r\nexport function EscrowConfirmModal({\r\n  open,\r\n  onOpenChange,\r\n  subscriptionId,\r\n  dealName,\r\n  investorName,\r\n  commitment,\r\n  fundedAmount,\r\n  currency,\r\n  mode,\r\n  onSuccess,\r\n  feeEventId = null,\r\n  defaultAmount = null,\r\n  defaultPaymentType = undefined,\r\n  defaultRecipientId = null\r\n}: EscrowConfirmModalProps) {\r\n  const [loading, setLoading] = useState(false)\r\n  const [amount, setAmount] = useState('')\r\n  const [bankReference, setBankReference] = useState('')\r\n  const [notes, setNotes] = useState('')\r\n  const [paymentType, setPaymentType] = useState<string>('')\r\n  const [recipientId, setRecipientId] = useState('')\r\n\r\n  const remainingAmount = commitment - fundedAmount\r\n\r\n  useEffect(() => {\r\n    if (!open) return\r\n    if (mode === 'payment') {\r\n      setAmount(defaultAmount != null ? String(defaultAmount) : '')\r\n      setPaymentType(defaultPaymentType || '')\r\n      setRecipientId(defaultRecipientId || '')\r\n    } else {\r\n      setAmount('')\r\n      setPaymentType('')\r\n      setRecipientId('')\r\n    }\r\n  }, [open, mode, defaultAmount, defaultPaymentType, defaultRecipientId])\r\n\r\n  const handleConfirmFunding = async () => {\r\n    if (!subscriptionId) {\r\n      toast.error('Invalid subscription reference')\r\n      return\r\n    }\r\n    if (!amount || parseFloat(amount) <= 0) {\r\n      toast.error('Please enter a valid amount')\r\n      return\r\n    }\r\n\r\n    setLoading(true)\r\n    try {\r\n      const response = await fetch(`/api/escrow/${subscriptionId}/confirm-funding`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          amount: parseFloat(amount),\r\n          bank_reference: bankReference || undefined,\r\n          confirmation_notes: notes || undefined\r\n        })\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to confirm funding')\r\n      }\r\n\r\n      toast.success(data.data.message)\r\n      onOpenChange(false)\r\n      onSuccess?.()\r\n\r\n      // Reset form\r\n      setAmount('')\r\n      setBankReference('')\r\n      setNotes('')\r\n    } catch (error) {\r\n      console.error('Funding confirmation error:', error)\r\n      toast.error(error instanceof Error ? error.message : 'Failed to confirm funding')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleConfirmPayment = async () => {\r\n    if (!subscriptionId) {\r\n      toast.error('Invalid subscription reference')\r\n      return\r\n    }\r\n    if (!amount || parseFloat(amount) <= 0) {\r\n      toast.error('Please enter a valid amount')\r\n      return\r\n    }\r\n    if (!paymentType) {\r\n      toast.error('Please select a payment type')\r\n      return\r\n    }\r\n    if (paymentType !== 'seller' && !recipientId) {\r\n      toast.error('Please enter a recipient ID')\r\n      return\r\n    }\r\n\r\n    setLoading(true)\r\n    try {\r\n      const payload: Record<string, unknown> = {\r\n        payment_type: paymentType,\r\n        amount: parseFloat(amount),\r\n        bank_reference: bankReference || undefined,\r\n        confirmation_notes: notes || undefined,\r\n        fee_event_id: feeEventId || undefined\r\n      }\r\n\r\n      if (paymentType !== 'seller') {\r\n        payload.recipient_id = recipientId\r\n      }\r\n\r\n      const response = await fetch(`/api/escrow/${subscriptionId}/confirm-payment`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to confirm payment')\r\n      }\r\n\r\n      toast.success(data.data.message)\r\n      onOpenChange(false)\r\n      onSuccess?.()\r\n\r\n      // Reset form\r\n      setAmount('')\r\n      setBankReference('')\r\n      setNotes('')\r\n      setPaymentType('')\r\n      setRecipientId('')\r\n    } catch (error) {\r\n      console.error('Payment confirmation error:', error)\r\n      toast.error(error instanceof Error ? error.message : 'Failed to confirm payment')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"sm:max-w-[500px]\">\r\n        <DialogHeader>\r\n          <DialogTitle>\r\n            {mode === 'funding' ? 'Confirm Escrow Funding' : 'Confirm Fee Payment'}\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            {mode === 'funding' ? (\r\n              <>\r\n                Confirm funding received for <strong>{investorName}</strong>'s subscription in <strong>{dealName}</strong>.\r\n              </>\r\n            ) : (\r\n              <>\r\n                Confirm fee payment processed for <strong>{dealName}</strong>.\r\n              </>\r\n            )}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4 py-4\">\r\n          {mode === 'funding' && (\r\n            <div className=\"rounded-lg bg-muted p-3 text-sm\">\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-muted-foreground\">Commitment:</span>\r\n                <span className=\"font-medium\">{commitment.toLocaleString()} {currency}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-muted-foreground\">Already Funded:</span>\r\n                <span className=\"font-medium\">{fundedAmount.toLocaleString()} {currency}</span>\r\n              </div>\r\n              <div className=\"flex justify-between border-t pt-2 mt-2\">\r\n                <span className=\"text-muted-foreground\">Remaining:</span>\r\n                <span className=\"font-bold text-amber-600\">{remainingAmount.toLocaleString()} {currency}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {mode === 'payment' && (\r\n            <>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"paymentType\">Payment Type</Label>\r\n                <Select value={paymentType} onValueChange={setPaymentType}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Select payment type\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"partner\">Partner Fee</SelectItem>\r\n                    <SelectItem value=\"introducer\">Introducer Fee</SelectItem>\r\n                    <SelectItem value=\"commercial_partner\">Commercial Partner Fee</SelectItem>\r\n                    <SelectItem value=\"seller\">Payment to Seller</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              {paymentType !== 'seller' && (\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"recipientId\">Recipient ID</Label>\r\n                  <Input\r\n                    id=\"recipientId\"\r\n                    placeholder=\"Enter recipient entity ID\"\r\n                    value={recipientId}\r\n                    onChange={(e) => setRecipientId(e.target.value)}\r\n                  />\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"amount\">Amount Confirmed ({currency})</Label>\r\n            <Input\r\n              id=\"amount\"\r\n              type=\"number\"\r\n              step=\"0.01\"\r\n              min=\"0\"\r\n              placeholder={mode === 'funding' ? `e.g., ${remainingAmount.toLocaleString()}` : 'Enter amount'}\r\n              value={amount}\r\n              onChange={(e) => setAmount(e.target.value)}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"bankReference\">Bank Reference (Optional)</Label>\r\n            <Input\r\n              id=\"bankReference\"\r\n              placeholder=\"Wire transfer reference\"\r\n              value={bankReference}\r\n              onChange={(e) => setBankReference(e.target.value)}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"notes\">Notes (Optional)</Label>\r\n            <Textarea\r\n              id=\"notes\"\r\n              placeholder=\"Any additional notes...\"\r\n              value={notes}\r\n              onChange={(e) => setNotes(e.target.value)}\r\n              rows={2}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={loading}>\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            onClick={mode === 'funding' ? handleConfirmFunding : handleConfirmPayment}\r\n            disabled={loading}\r\n          >\r\n            {loading ? (\r\n              <>\r\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                Confirming...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <CheckCircle className=\"mr-2 h-4 w-4\" />\r\n                Confirm {mode === 'funding' ? 'Funding' : 'Payment'}\r\n              </>\r\n            )}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}