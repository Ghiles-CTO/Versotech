module.exports=[143186,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(284169),e=a.i(15788),f=a.i(421908),g=a.i(663475),h=a.i(266828),i=a.i(771088),j=a.i(181608),k=a.i(155508),l=a.i(42329),m=a.i(399580),n=a.i(487068),o=a.i(3321),p=a.i(877918),q=a.i(816854),r=a.i(873785),s=a.i(947208),t=a.i(278541);let u=(0,a.i(95799).default)("arrow-down-left",[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]]);var v=a.i(324117),w=a.i(478870),x=a.i(871057),y=a.i(13289),z=a.i(439467),A=a.i(13542),B=a.i(264890),C=a.i(625473),D=a.i(600900),E=a.i(888987),F=a.i(201986),G=a.i(58834),H=a.i(924089),I=a.i(470305),J=a.i(249464),K=a.i(191675),L=a.i(951870),M=a.i(504839);let N={partner:"Partner",introducer:"Introducer","commercial-partner":"Commercial Partner"};function O({open:a,onOpenChange:d,commission:e,commissionType:g,onSuccess:h}){let[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{if(!a||!e?.deal_id)return t([]);v(!0);try{let a=(0,G.createClient)(),{data:b,error:c}=await a.from("deal_lawyer_assignments").select("lawyer_id").eq("deal_id",e.deal_id);if(c||!b?.length)return void t([]);let d=b.map(a=>a.lawyer_id),{data:f,error:g}=await a.from("lawyers").select("id, firm_name, display_name").in("id",d);if(g){console.error("[RequestPaymentDialog] Error fetching lawyers:",g),t([]);return}t(f||[])}catch(a){console.error("[RequestPaymentDialog] Unexpected error:",a),t([])}finally{v(!1)}})()},[a,e?.deal_id]),(0,c.useEffect)(()=>{a||(n(""),r(""),l(null))},[a]);let w=async()=>{if(e){j(!0),l(null);try{let a=`/api/arrangers/me/${g}-commissions/${e.id}/request-payment`,b={};m.trim()&&(b.notes=m.trim()),q&&"none"!==q&&(b.lawyer_id=q);let c=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to request payment")}await c.json(),h(),d(!1)}catch(a){console.error("[RequestPaymentDialog] Error:",a),l(a instanceof Error?a.message:"Failed to request payment")}finally{j(!1)}}};if(!e)return null;let x=N[g],y=(0,F.formatCurrency)(e.accrual_amount,e.currency||"USD");return(0,b.jsx)(I.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(I.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(I.DialogHeader,{children:[(0,b.jsxs)(I.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(A.CreditCard,{className:"h-5 w-5"}),"Request Payment"]}),(0,b.jsx)(I.DialogDescription,{children:"Send a payment request to lawyers and CEO for approval."})]}),(0,b.jsxs)("div",{className:"py-4 space-y-4",children:[k&&(0,b.jsxs)("div",{className:"bg-destructive/10 border border-destructive/30 text-destructive text-sm p-3 rounded flex items-start gap-2",children:[(0,b.jsx)(p.AlertCircle,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,b.jsx)("span",{children:k})]}),(0,b.jsxs)("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsxs)("span",{className:"text-muted-foreground",children:[x,":"]}),(0,b.jsx)("span",{className:"font-medium",children:e.entity_name||"Unknown"})]}),e.deal&&(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Deal:"}),(0,b.jsx)("span",{className:"font-medium",children:e.deal.name})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Amount:"}),(0,b.jsx)("span",{className:"font-medium text-green-600",children:y})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(J.Label,{htmlFor:"lawyer",className:"flex items-center gap-2",children:[(0,b.jsx)(M.Scale,{className:"h-4 w-4"}),"Priority Lawyer (Optional)"]}),u?(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-2",children:[(0,b.jsx)(o.Loader2,{className:"h-4 w-4 animate-spin"}),"Loading lawyers..."]}):s.length>0?(0,b.jsxs)(L.Select,{value:q,onValueChange:r,children:[(0,b.jsx)(L.SelectTrigger,{id:"lawyer",children:(0,b.jsx)(L.SelectValue,{placeholder:"Select a lawyer (optional)"})}),(0,b.jsxs)(L.SelectContent,{children:[(0,b.jsx)(L.SelectItem,{value:"none",children:"No specific lawyer"}),s.map(a=>(0,b.jsx)(L.SelectItem,{value:a.id,children:a.display_name||a.firm_name},a.id))]})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground py-2",children:e.deal_id?"No lawyers assigned to this deal":"No deal associated - CEO will be notified"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(J.Label,{htmlFor:"notes",children:"Notes (Optional)"}),(0,b.jsx)(K.Textarea,{id:"notes",placeholder:"Add any payment instructions or notes...",value:m,onChange:a=>n(a.target.value),rows:3})]}),(0,b.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 rounded-lg text-sm",children:[(0,b.jsx)("p",{className:"text-blue-800 dark:text-blue-200",children:(0,b.jsx)("strong",{children:"Who will be notified:"})}),(0,b.jsxs)("ul",{className:"mt-1 text-blue-700 dark:text-blue-300 list-disc list-inside space-y-0.5",children:[s.length>0&&(0,b.jsxs)("li",{children:["Lawyers assigned to this deal (",s.length,")"]}),(0,b.jsx)("li",{children:"CEO / Staff administrators"}),q&&"none"!==q&&(0,b.jsx)("li",{children:"Priority notification to selected lawyer"})]})]})]}),(0,b.jsxs)(I.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>d(!1),disabled:i,children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:w,disabled:i,children:i?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A.CreditCard,{className:"h-4 w-4 mr-2"}),"Request Payment"]})})]})]})})}var P=a.i(449448);let Q={accrued:"bg-blue-100 text-blue-800 border-blue-200",invoice_requested:"bg-amber-100 text-amber-800 border-amber-200",invoiced:"bg-purple-100 text-purple-800 border-purple-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200",paid:"bg-green-100 text-green-800 border-green-200",sent:"bg-purple-100 text-purple-800 border-purple-200",overdue:"bg-red-100 text-red-800 border-red-200",cancelled:"bg-gray-100 text-gray-800 border-gray-200"},R={accrued:"Accrued",invoice_requested:"Invoice Requested",invoiced:"Invoiced",paid:"Paid",cancelled:"Cancelled"},S={partner:(0,b.jsx)(x.Briefcase,{className:"h-3 w-3"}),introducer:(0,b.jsx)(y.Handshake,{className:"h-3 w-3"}),"commercial-partner":(0,b.jsx)(t.Building2,{className:"h-3 w-3"})};function T(){let[a,z]=(0,c.useState)(null),[A,B]=(0,c.useState)([]),[C,I]=(0,c.useState)([]),[J,K]=(0,c.useState)({pendingFees:0,pendingTotal:0,invoicedCount:0,invoicedTotal:0,paidCount:0,paidTotal:0}),[L,M]=(0,c.useState)([]),[N,T]=(0,c.useState)({total_accrued:0,total_invoice_requested:0,total_invoiced:0,total_paid:0,total_owed:0,count:0,by_type:{partner:{count:0,total:0},introducer:{count:0,total:0},commercial_partner:{count:0,total:0}}}),[V,W]=(0,c.useState)(!0),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)(""),[_,aa]=(0,c.useState)(new Set),[ab,ac]=(0,c.useState)(!1),[ad,ae]=(0,c.useState)("inbound"),[af,ag]=(0,c.useState)("pending"),[ah,ai]=(0,c.useState)("all"),[aj,ak]=(0,c.useState)(!1),[al,am]=(0,c.useState)(!1),[an,ao]=(0,c.useState)(!1),[ap,aq]=(0,c.useState)(null),ar=(0,c.useCallback)(async()=>{try{W(!0);let a=(0,G.createClient)(),{data:{user:b}}=await a.auth.getUser();if(!b)return void Y("Not authenticated");let{data:c,error:d}=await a.from("arranger_users").select("arranger_id").eq("user_id",b.id).maybeSingle();if(d||!c)return void Y("Only arrangers can access this page");let{data:e,error:f}=await a.from("arranger_entities").select("id, legal_name").eq("id",c.arranger_id).single();if(f)throw f;z(e);let[g,h]=await Promise.all([as(a,c.arranger_id),at(c.arranger_id)]);B(g.feeEvents),I(g.paymentRequests),K(g.summary),M(h.commissions),T(h.summary),Y(null)}catch(a){console.error("[PaymentRequestsPage] Error:",a),Y(a instanceof Error?a.message:"Failed to load data")}finally{W(!1)}},[]);async function as(a,b){let{data:c,error:d}=await a.from("fee_events").select(`
        id,
        deal_id,
        investor_id,
        fee_type,
        computed_amount,
        currency,
        status,
        event_date,
        invoice_id,
        deal:deal_id (id, name),
        investor:investor_id (id, display_name, legal_name)
      `).eq("payee_arranger_id",b).order("event_date",{ascending:!1});if(d)throw d;let e=(c||[]).map(a=>({id:a.id,deal_id:a.deal_id,deal_name:a.deal?.name||"Unknown Deal",investor_name:a.investor?.display_name||a.investor?.legal_name||"Unknown",fee_type:a.fee_type||"fee",computed_amount:Number(a.computed_amount)||0,currency:a.currency||"USD",status:a.status||"accrued",event_date:a.event_date,invoice_id:a.invoice_id})),f=[],g=await fetch("/api/arrangers/me/payment-requests");if(g.ok){let{payment_requests:a}=await g.json();f=(a||[]).map(a=>({id:a.id,invoice_number:a.invoice_number,deal_name:a.deal?.name||"Multiple",investor_name:a.investor?.display_name||a.investor?.legal_name||"Multiple",total:Number(a.total)||0,paid_amount:Number(a.paid_amount)||0,status:a.status,due_date:a.due_date,created_at:a.created_at}))}let h=e.filter(a=>"accrued"===a.status),i=e.filter(a=>"invoiced"===a.status),j=e.filter(a=>"paid"===a.status);return{feeEvents:e,paymentRequests:f,summary:{pendingFees:h.length,pendingTotal:h.reduce((a,b)=>a+b.computed_amount,0),invoicedCount:i.length,invoicedTotal:i.reduce((a,b)=>a+b.computed_amount,0),paidCount:j.length,paidTotal:j.reduce((a,b)=>a+b.computed_amount,0)}}}async function at(a){let[b,c,d]=await Promise.all([fetch("/api/arrangers/me/partner-commissions"),fetch("/api/arrangers/me/introducer-commissions"),fetch("/api/arrangers/me/commercial-partner-commissions")]),[e,f,g]=await Promise.all([b.ok?b.json():{data:[]},c.ok?c.json():{data:[]},d.ok?d.json():{data:[]}]),h=[];for(let a of e.data||[])h.push({id:a.id,type:"partner",entity_id:a.partner_id||a.partner?.id,entity_name:a.partner?.name||a.partner?.legal_name||"Unknown Partner",entity_type_label:"Partner",deal_id:a.deal_id||a.deal?.id||null,deal_name:a.deal?.name||null,accrual_amount:Number(a.accrual_amount)||0,currency:a.currency||"USD",status:a.status||"accrued",invoice_id:a.invoice_id||null,created_at:a.created_at,payment_due_date:a.payment_due_date||null});for(let a of f.data||[])h.push({id:a.id,type:"introducer",entity_id:a.introducer_id||a.introducer?.id,entity_name:a.introducer?.name||a.introducer?.legal_name||"Unknown Introducer",entity_type_label:"Introducer",deal_id:a.deal_id||a.deal?.id||null,deal_name:a.deal?.name||null,accrual_amount:Number(a.accrual_amount)||0,currency:a.currency||"USD",status:a.status||"accrued",invoice_id:a.invoice_id||null,created_at:a.created_at,payment_due_date:a.payment_due_date||null});for(let a of g.data||[])h.push({id:a.id,type:"commercial-partner",entity_id:a.commercial_partner_id||a.commercial_partner?.id,entity_name:a.commercial_partner?.name||a.commercial_partner?.legal_name||"Unknown Commercial Partner",entity_type_label:"Commercial Partner",deal_id:a.deal_id||a.deal?.id||null,deal_name:a.deal?.name||null,accrual_amount:Number(a.accrual_amount)||0,currency:a.currency||"USD",status:a.status||"accrued",invoice_id:a.invoice_id||null,created_at:a.created_at,payment_due_date:a.payment_due_date||null});h.sort((a,b)=>new Date(b.created_at).getTime()-new Date(a.created_at).getTime());let i=h.filter(a=>"cancelled"!==a.status),j=i.filter(a=>"accrued"===a.status),k=i.filter(a=>"invoice_requested"===a.status),l=i.filter(a=>"invoiced"===a.status),m=i.filter(a=>"paid"===a.status),n=i.filter(a=>"partner"===a.type),o=i.filter(a=>"introducer"===a.type),p=i.filter(a=>"commercial-partner"===a.type);return{commissions:h,summary:{total_accrued:j.reduce((a,b)=>a+b.accrual_amount,0),total_invoice_requested:k.reduce((a,b)=>a+b.accrual_amount,0),total_invoiced:l.reduce((a,b)=>a+b.accrual_amount,0),total_paid:m.reduce((a,b)=>a+b.accrual_amount,0),total_owed:[...j,...k,...l].reduce((a,b)=>a+b.accrual_amount,0),count:i.length,by_type:{partner:{count:n.length,total:n.reduce((a,b)=>a+b.accrual_amount,0)},introducer:{count:o.length,total:o.reduce((a,b)=>a+b.accrual_amount,0)},commercial_partner:{count:p.length,total:p.reduce((a,b)=>a+b.accrual_amount,0)}}}}}(0,c.useEffect)(()=>{ar()},[ar]);let au=async()=>{if(0!==_.size){ac(!0);try{let a=await fetch("/api/arrangers/me/payment-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fee_event_ids:Array.from(_)})});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to create payment request")}window.location.reload()}catch(a){Y(a instanceof Error?a.message:"Failed to submit payment request")}finally{ac(!1)}}},av=a=>{aq(a),ak(!0)},aw=a=>{aq(a),am(!0)},ax=a=>{aq(a),ao(!0)},ay=()=>{ar()},az=A.filter(a=>"accrued"===a.status).filter(a=>!Z||a.deal_name.toLowerCase().includes(Z.toLowerCase())||a.investor_name.toLowerCase().includes(Z.toLowerCase())),aA=C.filter(a=>!Z||a.invoice_number.toLowerCase().includes(Z.toLowerCase())||a.deal_name.toLowerCase().includes(Z.toLowerCase())),aB=L.filter(a=>"cancelled"!==a.status).filter(a=>"all"===ah||a.type===ah).filter(a=>{if(!Z)return!0;let b=Z.toLowerCase();return a.entity_name.toLowerCase().includes(b)||a.deal_name?.toLowerCase().includes(b)||a.entity_type_label.toLowerCase().includes(b)}),aC=A.filter(a=>_.has(a.id)).reduce((a,b)=>a+b.computed_amount,0);return V?(0,b.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,b.jsx)(o.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,b.jsx)("span",{className:"ml-3 text-muted-foreground",children:"Loading payment data..."})]}):X?(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(p.AlertCircle,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Error"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:X})]}):(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Payment Management"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:a?`Manage fees for ${a.legal_name}`:"Manage your fee collections and payments"})]}),a&&(0,b.jsxs)(e.Badge,{variant:"secondary",className:"flex items-center gap-1",children:[(0,b.jsx)(t.Building2,{className:"h-3 w-3"}),"Arranger"]})]}),(0,b.jsxs)(j.Tabs,{value:ad,onValueChange:a=>ae(a),className:"space-y-4",children:[(0,b.jsxs)(j.TabsList,{className:"grid w-full max-w-md grid-cols-2",children:[(0,b.jsxs)(j.TabsTrigger,{value:"inbound",className:"flex items-center gap-2",children:[(0,b.jsx)(u,{className:"h-4 w-4"}),"Fees Owed To Me",(0,b.jsx)(e.Badge,{variant:"secondary",className:"ml-1 text-xs",children:(0,F.formatCurrency)(J.pendingTotal+J.invoicedTotal,"USD")})]}),(0,b.jsxs)(j.TabsTrigger,{value:"outbound",className:"flex items-center gap-2",children:[(0,b.jsx)(v.ArrowUpRight,{className:"h-4 w-4"}),"Fees I Owe",(0,b.jsx)(e.Badge,{variant:"secondary",className:"ml-1 text-xs",children:(0,F.formatCurrency)(N.total_owed,"USD")})]})]}),(0,b.jsxs)(j.TabsContent,{value:"inbound",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(l.Clock,{className:"h-4 w-4"}),"Pending Fees"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(0,F.formatCurrency)(J.pendingTotal,"USD")}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[J.pendingFees," event",1!==J.pendingFees?"s":""," awaiting invoice"]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(q.FileText,{className:"h-4 w-4"}),"Invoiced"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:(0,F.formatCurrency)(J.invoicedTotal,"USD")}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[J.invoicedCount," event",1!==J.invoicedCount?"s":""," awaiting payment"]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(m.CheckCircle2,{className:"h-4 w-4"}),"Paid"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(0,F.formatCurrency)(J.paidTotal,"USD")}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[J.paidCount," event",1!==J.paidCount?"s":""," collected"]})]})]})]}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsx)("div",{className:"flex flex-col md:flex-row gap-4",children:(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(n.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(g.Input,{placeholder:"Search by deal or investor...",value:Z,onChange:a=>$(a.target.value),className:"pl-10"})]})})})})}),(0,b.jsxs)(j.Tabs,{value:af,onValueChange:ag,className:"space-y-4",children:[(0,b.jsxs)(j.TabsList,{children:[(0,b.jsxs)(j.TabsTrigger,{value:"pending",className:"flex items-center gap-2",children:[(0,b.jsx)(l.Clock,{className:"h-4 w-4"}),"Pending Fees (",J.pendingFees,")"]}),(0,b.jsxs)(j.TabsTrigger,{value:"requests",className:"flex items-center gap-2",children:[(0,b.jsx)(s.Receipt,{className:"h-4 w-4"}),"Payment Requests (",C.length,")"]})]}),(0,b.jsx)(j.TabsContent,{value:"pending",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Pending Fee Events"}),(0,b.jsx)(d.CardDescription,{children:"Select fee events to create a payment request"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[_.size>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[_.size," selected (",(0,F.formatCurrency)(aC,"USD"),")"]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>{aa(new Set)},children:"Clear"})]}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>{aa(new Set(A.filter(a=>"accrued"===a.status).map(a=>a.id)))},children:"Select All"}),(0,b.jsxs)(f.Button,{size:"sm",onClick:au,disabled:0===_.size||ab,children:[ab?(0,b.jsx)(o.Loader2,{className:"h-4 w-4 animate-spin mr-1"}):(0,b.jsx)(r.Send,{className:"h-4 w-4 mr-1"}),"Request Payment"]})]})]})}),(0,b.jsx)(d.CardContent,{children:0===az.length?(0,b.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,b.jsx)(k.DollarSign,{className:"h-10 w-10 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:Z?"No pending fees match your search":"No pending fee events to invoice"})]}):(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"w-12"}),(0,b.jsx)(i.TableHead,{children:"Deal"}),(0,b.jsx)(i.TableHead,{children:"Investor"}),(0,b.jsx)(i.TableHead,{children:"Fee Type"}),(0,b.jsx)(i.TableHead,{children:"Amount"}),(0,b.jsx)(i.TableHead,{children:"Date"}),(0,b.jsx)(i.TableHead,{children:"Status"})]})}),(0,b.jsx)(i.TableBody,{children:az.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Checkbox,{checked:_.has(a.id),onCheckedChange:()=>{var b;let c;return b=a.id,void((c=new Set(_)).has(b)?c.delete(b):c.add(b),aa(c))}})}),(0,b.jsx)(i.TableCell,{className:"font-medium",children:a.deal_name}),(0,b.jsx)(i.TableCell,{children:a.investor_name}),(0,b.jsx)(i.TableCell,{className:"capitalize",children:a.fee_type.replace("_"," ")}),(0,b.jsx)(i.TableCell,{className:"font-medium",children:(0,F.formatCurrency)(a.computed_amount,a.currency)}),(0,b.jsx)(i.TableCell,{children:(0,F.formatDate)(a.event_date)}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(e.Badge,{variant:"outline",className:(0,E.cn)("capitalize",Q[a.status]),children:a.status})})]},a.id))})]})})})]})}),(0,b.jsx)(j.TabsContent,{value:"requests",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Payment Requests"}),(0,b.jsxs)(d.CardDescription,{children:[aA.length," payment request",1!==aA.length?"s":""," submitted"]})]}),(0,b.jsx)(d.CardContent,{children:0===aA.length?(0,b.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,b.jsx)(s.Receipt,{className:"h-10 w-10 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:Z?"No payment requests match your search":"No payment requests submitted yet"})]}):(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"Invoice #"}),(0,b.jsx)(i.TableHead,{children:"Deal"}),(0,b.jsx)(i.TableHead,{children:"Amount"}),(0,b.jsx)(i.TableHead,{children:"Paid"}),(0,b.jsx)(i.TableHead,{children:"Due Date"}),(0,b.jsx)(i.TableHead,{children:"Status"}),(0,b.jsx)(i.TableHead,{children:"Created"})]})}),(0,b.jsx)(i.TableBody,{children:aA.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{className:"font-mono text-sm",children:a.invoice_number}),(0,b.jsx)(i.TableCell,{className:"font-medium",children:a.deal_name}),(0,b.jsx)(i.TableCell,{className:"font-medium",children:(0,F.formatCurrency)(a.total,"USD")}),(0,b.jsx)(i.TableCell,{children:a.paid_amount>0?(0,b.jsx)("span",{className:"text-green-600",children:(0,F.formatCurrency)(a.paid_amount,"USD")}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,b.jsx)(i.TableCell,{children:(0,F.formatDate)(a.due_date)}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(e.Badge,{variant:"outline",className:(0,E.cn)("capitalize",Q[a.status]),children:a.status})}),(0,b.jsx)(i.TableCell,{children:(0,F.formatDate)(a.created_at)})]},a.id))})]})})})]})})]})]}),(0,b.jsxs)(j.TabsContent,{value:"outbound",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)(d.Card,{className:"bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-950/30 dark:to-amber-950/30 border-orange-200 dark:border-orange-800",children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-orange-700 dark:text-orange-300 flex items-center gap-2",children:[(0,b.jsx)(D.Wallet,{className:"h-4 w-4"}),"Total Owed"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:(0,F.formatCurrency)(N.total_owed,"USD")}),(0,b.jsx)("p",{className:"text-xs text-orange-600/70 dark:text-orange-400/70 mt-1",children:"To partners, introducers & CPs"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(x.Briefcase,{className:"h-4 w-4"}),"Partners"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-xl font-bold text-foreground",children:(0,F.formatCurrency)(N.by_type.partner.total,"USD")}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[N.by_type.partner.count," commission",1!==N.by_type.partner.count?"s":""]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(y.Handshake,{className:"h-4 w-4"}),"Introducers"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-xl font-bold text-foreground",children:(0,F.formatCurrency)(N.by_type.introducer.total,"USD")}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[N.by_type.introducer.count," commission",1!==N.by_type.introducer.count?"s":""]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(t.Building2,{className:"h-4 w-4"}),"Commercial Partners"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-xl font-bold text-foreground",children:(0,F.formatCurrency)(N.by_type.commercial_partner.total,"USD")}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[N.by_type.commercial_partner.count," commission",1!==N.by_type.commercial_partner.count?"s":""]})]})]})]}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(n.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(g.Input,{placeholder:"Search by entity, deal, or type...",value:Z,onChange:a=>$(a.target.value),className:"pl-10"})]})}),(0,b.jsx)(j.Tabs,{value:ah,onValueChange:a=>ai(a),children:(0,b.jsxs)(j.TabsList,{children:[(0,b.jsxs)(j.TabsTrigger,{value:"all",className:"text-xs",children:["All (",N.count,")"]}),(0,b.jsxs)(j.TabsTrigger,{value:"partner",className:"text-xs",children:[(0,b.jsx)(x.Briefcase,{className:"h-3 w-3 mr-1"}),"Partners (",N.by_type.partner.count,")"]}),(0,b.jsxs)(j.TabsTrigger,{value:"introducer",className:"text-xs",children:[(0,b.jsx)(y.Handshake,{className:"h-3 w-3 mr-1"}),"Introducers (",N.by_type.introducer.count,")"]}),(0,b.jsxs)(j.TabsTrigger,{value:"commercial-partner",className:"text-xs",children:[(0,b.jsx)(t.Building2,{className:"h-3 w-3 mr-1"}),"CPs (",N.by_type.commercial_partner.count,")"]})]})})]})})}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(v.ArrowUpRight,{className:"h-5 w-5 text-orange-500"}),"Commissions To Pay"]}),(0,b.jsxs)(d.CardDescription,{children:[aB.length," commission",1!==aB.length?"s":""," to process"]})]}),(0,b.jsx)(d.CardContent,{children:0===aB.length?(0,b.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,b.jsx)(w.Users,{className:"h-10 w-10 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:Z?"No commissions match your search":"No commissions to pay"})]}):(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"w-[120px]",children:"Type"}),(0,b.jsx)(i.TableHead,{children:"Entity"}),(0,b.jsx)(i.TableHead,{children:"Deal"}),(0,b.jsx)(i.TableHead,{className:"text-right",children:"Amount"}),(0,b.jsx)(i.TableHead,{children:"Status"}),(0,b.jsx)(i.TableHead,{children:"Due Date"}),(0,b.jsx)(i.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(i.TableBody,{children:aB.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsxs)(e.Badge,{variant:"outline",className:"flex items-center gap-1 w-fit",children:[S[a.type],(0,b.jsx)("span",{className:"text-xs",children:a.entity_type_label})]})}),(0,b.jsx)(i.TableCell,{className:"font-medium",children:a.entity_name}),(0,b.jsx)(i.TableCell,{className:"text-muted-foreground",children:a.deal_name||"—"}),(0,b.jsx)(i.TableCell,{className:"text-right font-medium",children:(0,F.formatCurrency)(a.accrual_amount,a.currency)}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(e.Badge,{variant:"outline",className:(0,E.cn)(Q[a.status]),children:R[a.status]||a.status})}),(0,b.jsx)(i.TableCell,{children:a.payment_due_date?(0,F.formatDate)(a.payment_due_date):(0,b.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,b.jsx)(i.TableCell,{className:"text-right",children:(0,b.jsx)(U,{commission:a,onRequestInvoice:av,onRequestPayment:aw,onViewInvoice:ax})})]},`${a.type}-${a.id}`))})]})})})]})]})]}),(0,b.jsx)(H.RequestInvoiceDialog,{open:aj,onOpenChange:ak,commission:ap?{id:ap.id,accrual_amount:ap.accrual_amount,currency:ap.currency,entity_name:ap.entity_name,deal:ap.deal_name?{name:ap.deal_name}:void 0}:null,commissionType:ap?.type||"partner",onSuccess:ay}),(0,b.jsx)(O,{open:al,onOpenChange:am,commission:ap?{id:ap.id,accrual_amount:ap.accrual_amount,currency:ap.currency,entity_name:ap.entity_name,deal_id:ap.deal_id||void 0,deal:ap.deal_name?{id:ap.deal_id||"",name:ap.deal_name}:void 0}:null,commissionType:ap?.type||"partner",onSuccess:ay}),(0,b.jsx)(P.ViewInvoiceDialog,{open:an,onOpenChange:ao,commission:ap?{id:ap.id,accrual_amount:ap.accrual_amount,currency:ap.currency,entity_name:ap.entity_name,invoice_id:ap.invoice_id,deal:ap.deal_name?{name:ap.deal_name}:void 0}:null,commissionType:ap?.type||"partner"})]})}function U({commission:a,onRequestInvoice:c,onRequestPayment:d,onViewInvoice:g}){switch(a.status){case"accrued":return(0,b.jsxs)(f.Button,{size:"sm",variant:"outline",onClick:()=>c(a),className:"gap-1",children:[(0,b.jsx)(z.Mail,{className:"h-3.5 w-3.5"}),"Request Invoice"]});case"invoice_requested":return(0,b.jsxs)(e.Badge,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:[(0,b.jsx)(l.Clock,{className:"h-3 w-3 mr-1"}),"Awaiting Invoice"]});case"invoiced":return(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.invoice_id&&(0,b.jsxs)(f.Button,{size:"sm",variant:"ghost",onClick:()=>g(a),className:"gap-1",children:[(0,b.jsx)(B.Eye,{className:"h-3.5 w-3.5"}),"View"]}),(0,b.jsxs)(f.Button,{size:"sm",onClick:()=>d(a),className:"gap-1",children:[(0,b.jsx)(A.CreditCard,{className:"h-3.5 w-3.5"}),"Request Payment"]})]});case"paid":return(0,b.jsxs)(e.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[(0,b.jsx)(m.CheckCircle2,{className:"h-3 w-3 mr-1"}),"Paid"]});case"cancelled":return(0,b.jsxs)(e.Badge,{variant:"outline",className:"bg-gray-50 text-gray-500 border-gray-200",children:[(0,b.jsx)(C.XCircle,{className:"h-3 w-3 mr-1"}),"Cancelled"]});default:return null}}a.s(["default",()=>T],143186)}];

//# sourceMappingURL=c6ad4_src_app_%28main%29_versotech_main_payment-requests_page_tsx_dd240be6._.js.map