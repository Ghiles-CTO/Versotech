{"version":3,"sources":["../../../../../versotech-portal/src/app/%28admin%29/versotech_admin/users/entities/page.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport { useEffect, useState, useCallback } from 'react'\nimport { useSearchParams, useRouter, usePathname } from 'next/navigation'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar'\nimport { Input } from '@/components/ui/input'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n  CommandSeparator,\n} from '@/components/ui/command'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport { Separator } from '@/components/ui/separator'\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from '@/components/ui/collapsible'\nimport {\n  ChevronDown,\n  ChevronRight,\n  Search,\n  X,\n  Check,\n  ChevronsUpDown,\n  Filter,\n  Building2,\n  Users,\n  Scale,\n  Handshake,\n  Globe,\n  Landmark,\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { cn } from '@/lib/utils'\nimport type { LucideIcon } from 'lucide-react'\n\n// Types\ninterface EntityUser {\n  id: string\n  email: string\n  displayName: string\n  avatarUrl: string | null\n  isPrimary: boolean\n  canSign: boolean\n}\n\ninterface EntityGroup {\n  id: string\n  name: string\n  type: 'investor' | 'partner' | 'lawyer' | 'commercial_partner' | 'introducer' | 'arranger'\n  users: EntityUser[]\n}\n\ninterface EntitiesResponse {\n  success: boolean\n  data?: EntityGroup[]\n  error?: string\n}\n\n// Filter option types\ninterface FilterOption {\n  value: string\n  label: string\n}\n\n// Entity type options\nconst entityTypeOptions: FilterOption[] = [\n  { value: 'investor', label: 'Investor' },\n  { value: 'partner', label: 'Partner' },\n  { value: 'lawyer', label: 'Law Firm' },\n  { value: 'commercial_partner', label: 'Commercial Partner' },\n  { value: 'introducer', label: 'Introducer' },\n  { value: 'arranger', label: 'Arranger' },\n]\n\n// Entity type to icon mapping\nconst entityTypeIcons: Record<EntityGroup['type'], LucideIcon> = {\n  investor: Building2,\n  partner: Users,\n  lawyer: Scale,\n  commercial_partner: Handshake,\n  introducer: Globe,\n  arranger: Landmark,\n}\n\n// Entity type display names\nconst entityTypeLabels: Record<EntityGroup['type'], string> = {\n  investor: 'Investor',\n  partner: 'Partner',\n  lawyer: 'Law Firm',\n  commercial_partner: 'Commercial Partner',\n  introducer: 'Introducer',\n  arranger: 'Arranger',\n}\n\n// Multi-select filter component\ninterface MultiSelectFilterProps {\n  title: string\n  options: FilterOption[]\n  selected: string[]\n  onSelect: (values: string[]) => void\n  className?: string\n}\n\nfunction MultiSelectFilter({\n  title,\n  options,\n  selected,\n  onSelect,\n  className,\n}: MultiSelectFilterProps) {\n  const [open, setOpen] = useState(false)\n\n  const toggleOption = (value: string) => {\n    if (selected.includes(value)) {\n      onSelect(selected.filter(v => v !== value))\n    } else {\n      onSelect([...selected, value])\n    }\n  }\n\n  const clearSelection = () => {\n    onSelect([])\n    setOpen(false)\n  }\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className={cn(\n            'h-9 border-dashed',\n            selected.length > 0 && 'border-primary',\n            className\n          )}\n        >\n          <Filter className=\"mr-2 h-4 w-4\" />\n          {title}\n          {selected.length > 0 && (\n            <>\n              <Separator orientation=\"vertical\" className=\"mx-2 h-4\" />\n              <Badge\n                variant=\"secondary\"\n                className=\"rounded-sm px-1 font-normal\"\n              >\n                {selected.length}\n              </Badge>\n            </>\n          )}\n          <ChevronsUpDown className=\"ml-2 h-4 w-4 opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-52 p-0\" align=\"start\">\n        <Command>\n          <CommandInput placeholder={`Search ${title.toLowerCase()}...`} />\n          <CommandList>\n            <CommandEmpty>No results found.</CommandEmpty>\n            <CommandGroup>\n              {options.map((option) => {\n                const isSelected = selected.includes(option.value)\n                return (\n                  <CommandItem\n                    key={option.value}\n                    onSelect={() => toggleOption(option.value)}\n                  >\n                    <div\n                      className={cn(\n                        'mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary',\n                        isSelected\n                          ? 'bg-primary text-primary-foreground'\n                          : 'opacity-50 [&_svg]:invisible'\n                      )}\n                    >\n                      <Check className=\"h-3 w-3\" />\n                    </div>\n                    <span>{option.label}</span>\n                  </CommandItem>\n                )\n              })}\n            </CommandGroup>\n            {selected.length > 0 && (\n              <>\n                <CommandSeparator />\n                <CommandGroup>\n                  <CommandItem\n                    onSelect={clearSelection}\n                    className=\"justify-center text-center\"\n                  >\n                    Clear selection\n                  </CommandItem>\n                </CommandGroup>\n              </>\n            )}\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\n// Get initials from display name\nconst getInitials = (name: string): string => {\n  return name\n    .split(' ')\n    .map(n => n[0])\n    .join('')\n    .toUpperCase()\n    .slice(0, 2)\n}\n\n// Loading skeleton\nfunction EntitiesTableSkeleton() {\n  return (\n    <div className=\"space-y-4\">\n      {Array.from({ length: 5 }).map((_, i) => (\n        <Card key={i}>\n          <CardHeader className=\"py-4\">\n            <div className=\"flex items-center gap-3\">\n              <Skeleton className=\"h-10 w-10 rounded-full\" />\n              <div className=\"space-y-2\">\n                <Skeleton className=\"h-5 w-48\" />\n                <Skeleton className=\"h-4 w-24\" />\n              </div>\n            </div>\n          </CardHeader>\n        </Card>\n      ))}\n    </div>\n  )\n}\n\n// Empty state\nfunction EmptyState() {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-16 px-4\">\n      <div className=\"rounded-full bg-muted p-4 mb-4\">\n        <Building2 className=\"h-8 w-8 text-muted-foreground\" />\n      </div>\n      <h3 className=\"text-lg font-medium mb-1\">No entities found</h3>\n      <p className=\"text-sm text-muted-foreground text-center max-w-sm\">\n        No entities match the current filters. Try adjusting your search or filter criteria.\n      </p>\n    </div>\n  )\n}\n\n// Debounce hook\nfunction useDebounce<T>(value: T, delay: number): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value)\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value)\n    }, delay)\n\n    return () => {\n      clearTimeout(handler)\n    }\n  }, [value, delay])\n\n  return debouncedValue\n}\n\n// Entity Card Component\nfunction EntityCard({ entity }: { entity: EntityGroup }) {\n  const [isOpen, setIsOpen] = useState(false)\n  const Icon = entityTypeIcons[entity.type]\n\n  return (\n    <Collapsible open={isOpen} onOpenChange={setIsOpen}>\n      <Card className=\"overflow-hidden\">\n        <CollapsibleTrigger asChild>\n          <CardHeader className=\"py-4 cursor-pointer hover:bg-muted/50 transition-colors\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"flex items-center justify-center h-10 w-10 rounded-full bg-muted\">\n                  <Icon className=\"h-5 w-5 text-muted-foreground\" />\n                </div>\n                <div>\n                  <CardTitle className=\"text-base font-medium\">{entity.name}</CardTitle>\n                  <div className=\"flex items-center gap-2 mt-1\">\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      {entityTypeLabels[entity.type]}\n                    </Badge>\n                    <span className=\"text-xs text-muted-foreground\">\n                      {entity.users.length} {entity.users.length === 1 ? 'user' : 'users'}\n                    </span>\n                  </div>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {isOpen ? (\n                  <ChevronDown className=\"h-5 w-5 text-muted-foreground\" />\n                ) : (\n                  <ChevronRight className=\"h-5 w-5 text-muted-foreground\" />\n                )}\n              </div>\n            </div>\n          </CardHeader>\n        </CollapsibleTrigger>\n        <CollapsibleContent>\n          <CardContent className=\"pt-0 pb-4\">\n            <div className=\"rounded-md border\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>User</TableHead>\n                    <TableHead>Email</TableHead>\n                    <TableHead>Role</TableHead>\n                    <TableHead className=\"text-right\">Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {entity.users.map((user) => (\n                    <TableRow key={user.id}>\n                      <TableCell>\n                        <div className=\"flex items-center gap-3\">\n                          <Avatar className=\"h-8 w-8\">\n                            <AvatarImage src={user.avatarUrl || undefined} alt={user.displayName} />\n                            <AvatarFallback className=\"text-xs\">\n                              {getInitials(user.displayName)}\n                            </AvatarFallback>\n                          </Avatar>\n                          <Link\n                            href={`/versotech_admin/users/${user.id}`}\n                            className=\"font-medium hover:underline\"\n                          >\n                            {user.displayName}\n                          </Link>\n                        </div>\n                      </TableCell>\n                      <TableCell className=\"text-muted-foreground\">\n                        {user.email}\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-2\">\n                          <Badge variant={user.isPrimary ? 'default' : 'secondary'}>\n                            {user.isPrimary ? 'Primary' : 'Member'}\n                          </Badge>\n                          {user.canSign && (\n                            <Badge variant=\"outline\">Can Sign</Badge>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <Button variant=\"ghost\" size=\"sm\" asChild>\n                          <Link href={`/versotech_admin/users/${user.id}`}>\n                            View\n                          </Link>\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </CardContent>\n        </CollapsibleContent>\n      </Card>\n    </Collapsible>\n  )\n}\n\nexport default function EntitiesPage() {\n  const router = useRouter()\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n\n  // Initialize state from URL params\n  const [searchInput, setSearchInput] = useState(searchParams.get('search') || '')\n  const [entityTypeFilters, setEntityTypeFilters] = useState<string[]>(\n    searchParams.get('type')?.split(',').filter(Boolean) || []\n  )\n\n  const [entities, setEntities] = useState<EntityGroup[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  // Debounce search input\n  const debouncedSearch = useDebounce(searchInput, 300)\n\n  // Check if any filters are active\n  const hasActiveFilters = debouncedSearch.length > 0 || entityTypeFilters.length > 0\n\n  // Update URL params when filters change\n  const updateUrlParams = useCallback((params: {\n    search?: string\n    type?: string[]\n  }) => {\n    const newParams = new URLSearchParams(searchParams.toString())\n\n    if (params.search !== undefined) {\n      if (params.search) {\n        newParams.set('search', params.search)\n      } else {\n        newParams.delete('search')\n      }\n    }\n\n    if (params.type !== undefined) {\n      if (params.type.length > 0) {\n        newParams.set('type', params.type.join(','))\n      } else {\n        newParams.delete('type')\n      }\n    }\n\n    const queryString = newParams.toString()\n    router.push(`${pathname}${queryString ? `?${queryString}` : ''}`)\n  }, [pathname, router, searchParams])\n\n  // Fetch entities with users\n  const fetchEntities = useCallback(async () => {\n    try {\n      setLoading(true)\n      setError(null)\n\n      // Build query params\n      const params = new URLSearchParams()\n      if (debouncedSearch) {\n        params.set('search', debouncedSearch)\n      }\n      if (entityTypeFilters.length > 0) {\n        params.set('type', entityTypeFilters.join(','))\n      }\n\n      const response = await fetch(`/api/admin/entities/users?${params}`)\n      const data: EntitiesResponse = await response.json()\n\n      if (!data.success) {\n        throw new Error(data.error || 'Failed to fetch entities')\n      }\n\n      setEntities(data.data || [])\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An error occurred')\n    } finally {\n      setLoading(false)\n    }\n  }, [debouncedSearch, entityTypeFilters])\n\n  // Fetch when filters change\n  useEffect(() => {\n    fetchEntities()\n    updateUrlParams({\n      search: debouncedSearch,\n      type: entityTypeFilters,\n    })\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [debouncedSearch, entityTypeFilters])\n\n  // Clear all filters\n  const clearAllFilters = () => {\n    setSearchInput('')\n    setEntityTypeFilters([])\n  }\n\n  // Calculate statistics\n  const stats = {\n    totalEntities: entities.length,\n    totalUsers: entities.reduce((acc, e) => acc + e.users.length, 0),\n    byType: entityTypeOptions.map(opt => ({\n      type: opt.value,\n      label: opt.label,\n      count: entities.filter(e => e.type === opt.value).length\n    })).filter(s => s.count > 0)\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"rounded-lg border border-destructive/50 bg-destructive/10 p-4\">\n          <h3 className=\"font-medium text-destructive\">Error loading entities</h3>\n          <p className=\"text-sm text-destructive/80 mt-1\">{error}</p>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            className=\"mt-3\"\n            onClick={() => fetchEntities()}\n          >\n            Try Again\n          </Button>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Page Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-semibold\">Users by Entity</h1>\n          <p className=\"text-sm text-muted-foreground mt-1\">\n            View users grouped by their entity associations\n          </p>\n        </div>\n      </div>\n\n      {/* Stats Cards */}\n      {!loading && entities.length > 0 && (\n        <div className=\"grid gap-4 grid-cols-2 md:grid-cols-4\">\n          <Card>\n            <CardContent className=\"pt-4\">\n              <p className=\"text-sm text-muted-foreground\">Total Entities</p>\n              <p className=\"text-2xl font-bold\">{stats.totalEntities}</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-4\">\n              <p className=\"text-sm text-muted-foreground\">Total Users</p>\n              <p className=\"text-2xl font-bold\">{stats.totalUsers}</p>\n            </CardContent>\n          </Card>\n          {stats.byType.slice(0, 2).map((s) => (\n            <Card key={s.type}>\n              <CardContent className=\"pt-4\">\n                <p className=\"text-sm text-muted-foreground\">{s.label}s</p>\n                <p className=\"text-2xl font-bold\">{s.count}</p>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      )}\n\n      {/* Search and Filters */}\n      <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n        <div className=\"flex flex-1 items-center gap-2\">\n          {/* Search Input */}\n          <div className=\"relative flex-1 max-w-sm\">\n            <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search entities or users...\"\n              value={searchInput}\n              onChange={(e) => setSearchInput(e.target.value)}\n              className=\"pl-9 h-9\"\n            />\n            {searchInput && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0\"\n                onClick={() => setSearchInput('')}\n              >\n                <X className=\"h-4 w-4\" />\n              </Button>\n            )}\n          </div>\n\n          {/* Filter Dropdown */}\n          <MultiSelectFilter\n            title=\"Entity Type\"\n            options={entityTypeOptions}\n            selected={entityTypeFilters}\n            onSelect={setEntityTypeFilters}\n          />\n        </div>\n\n        {/* Clear All Filters */}\n        {hasActiveFilters && (\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={clearAllFilters}\n            className=\"h-9\"\n          >\n            <X className=\"mr-2 h-4 w-4\" />\n            Clear filters\n          </Button>\n        )}\n      </div>\n\n      {/* Active Filters Display */}\n      {hasActiveFilters && (\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <span className=\"text-sm text-muted-foreground\">Active filters:</span>\n          {debouncedSearch && (\n            <Badge variant=\"secondary\" className=\"rounded-sm px-2 py-1\">\n              Search: &quot;{debouncedSearch}&quot;\n              <button\n                className=\"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20\"\n                onClick={() => setSearchInput('')}\n              >\n                <X className=\"h-3 w-3\" />\n              </button>\n            </Badge>\n          )}\n          {entityTypeFilters.map((type) => (\n            <Badge key={type} variant=\"secondary\" className=\"rounded-sm px-2 py-1\">\n              Type: {entityTypeOptions.find(o => o.value === type)?.label || type}\n              <button\n                className=\"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20\"\n                onClick={() => setEntityTypeFilters(entityTypeFilters.filter(t => t !== type))}\n              >\n                <X className=\"h-3 w-3\" />\n              </button>\n            </Badge>\n          ))}\n        </div>\n      )}\n\n      {/* Content */}\n      {loading ? (\n        <EntitiesTableSkeleton />\n      ) : entities.length === 0 ? (\n        <EmptyState />\n      ) : (\n        <div className=\"space-y-4\">\n          {entities.map((entity) => (\n            <EntityCard key={`${entity.type}-${entity.id}`} entity={entity} />\n          ))}\n\n          {/* Total Count */}\n          <div className=\"text-sm text-muted-foreground text-center pt-4\">\n            Showing {entities.length} {entities.length === 1 ? 'entity' : 'entities'} with {stats.totalUsers} linked users\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}