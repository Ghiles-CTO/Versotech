module.exports=[389530,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(497412),e=a.i(284169),f=a.i(15788),g=a.i(421908),h=a.i(663475),i=a.i(951870),j=a.i(771088),k=a.i(478870),l=a.i(399580),m=a.i(487068),n=a.i(3321),o=a.i(877918),p=a.i(325866),q=a.i(278541),r=a.i(871057),s=a.i(966494),t=a.i(439467),u=a.i(816854),v=a.i(941766),w=a.i(438436);let x=(0,a.i(95799).default)("columns-3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);var y=a.i(292944),z=a.i(264890),A=a.i(752907),B=a.i(600900),C=a.i(425622),D=a.i(888987),E=a.i(201986);let F=[{key:"new_lead",label:"New Lead",color:"bg-slate-500",icon:p.User},{key:"interested",label:"Interested",color:"bg-blue-500",icon:z.Eye},{key:"subscribing",label:"Subscribing",color:"bg-purple-500",icon:A.PenTool},{key:"funded",label:"Funded",color:"bg-green-500",icon:B.Wallet},{key:"passed",label:"Passed",color:"bg-gray-400",icon:o.AlertCircle}],G={active:"bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 border-green-200 dark:border-green-700",pending:"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300 border-yellow-200 dark:border-yellow-700",approved:"bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 border-green-200 dark:border-green-700",funded:"bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300 border-blue-200 dark:border-blue-700",signed:"bg-purple-100 dark:bg-purple-900/40 text-purple-800 dark:text-purple-300 border-purple-200 dark:border-purple-700",committed:"bg-cyan-100 dark:bg-cyan-900/40 text-cyan-800 dark:text-cyan-300 border-cyan-200 dark:border-cyan-700",cancelled:"bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300 border-red-200 dark:border-red-700",rejected:"bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300 border-red-200 dark:border-red-700",withdrawn:"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-300 border-gray-200 dark:border-gray-600"},H=[{label:"All Clients",value:"all"},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}];function I(){let[a,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(null),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)({totalClients:0,activeClients:0,totalTransactions:0,totalValue:0,estimatedCommission:0}),[M,N]=(0,c.useState)(!0),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(""),[U,V]=(0,c.useState)("all"),[W,X]=(0,c.useState)("table");(0,c.useEffect)(()=>{!async function(){try{N(!0);let a=await fetch("/api/commercial-partners/me/client-transactions");if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to load client transactions")}let b=await a.json();z(b.partner||null),B(b.placement_agreement||null),J(b.clients||[]),L(b.summary||{totalClients:0,activeClients:0,totalTransactions:0,totalValue:0,estimatedCommission:0}),R(null)}catch(a){console.error("[ClientTransactionsPage] Error:",a),R(a instanceof Error?a.message:"Failed to load client transactions")}finally{N(!1)}}()},[]);let Y=async()=>{if(!O&&!Z){P(!0);try{let a=await fetch("/api/commercial-partners/me/clients/export");if(!a.ok){let b=await a.json();throw Error(b.error||"Export failed")}let b=await a.blob(),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`client-transactions-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c)}catch(a){console.error("Export error:",a),R(a instanceof Error?a.message:"Export failed")}finally{P(!1)}}},Z=null===a,$=I.filter(a=>{let b="all"===U||"active"===U&&a.is_active||"inactive"===U&&!a.is_active,c=!S||a.client_name?.toLowerCase().includes(S.toLowerCase())||a.client_email?.toLowerCase().includes(S.toLowerCase())||a.deal_name?.toLowerCase().includes(S.toLowerCase());return b&&c}),_=F.reduce((a,b)=>(a[b.key]=$.filter(a=>a.journey_stage===b.key),a),{});return M?(0,b.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,b.jsx)(n.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,b.jsx)("span",{className:"ml-3 text-muted-foreground",children:"Loading client transactions..."})]}):Q?(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(o.AlertCircle,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Error Loading Clients"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:Q})]}):(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Client Transactions"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:a?`Manage clients you've introduced as ${a.name}`:"View and manage all client transactions"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[!Z&&a&&(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",onClick:Y,disabled:O||0===I.length,children:[O?(0,b.jsx)(n.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(C.Download,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),A&&(0,b.jsxs)(f.Badge,{variant:"outline",className:"text-green-600 dark:text-green-400 border-green-200 dark:border-green-700 bg-green-50 dark:bg-green-900/30",children:[(0,b.jsx)(w.Percent,{className:"h-3 w-3 mr-1"}),(A.default_commission_bps/100).toFixed(2),"% Commission"]}),a&&(0,b.jsx)("div",{className:"flex items-center gap-2",children:a.logo_url?(0,b.jsx)("img",{src:a.logo_url,alt:a.name,className:"h-10 w-10 rounded-lg object-cover"}):(0,b.jsx)("div",{className:"h-10 w-10 rounded-lg bg-muted flex items-center justify-center",children:(0,b.jsx)(q.Building2,{className:"h-5 w-5 text-muted-foreground"})})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(k.Users,{className:"h-4 w-4"}),"Total Clients"]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:K.totalClients}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Clients introduced"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(l.CheckCircle2,{className:"h-4 w-4"}),"Active Clients"]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:K.activeClients}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Currently active"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(r.Briefcase,{className:"h-4 w-4"}),"Subscriptions"]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:K.totalTransactions}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Active investments"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(s.TrendingUp,{className:"h-4 w-4"}),"Total Value"]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-400",children:(0,E.formatCurrency)(K.totalValue,"USD")}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Total commitment"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(w.Percent,{className:"h-4 w-4"}),"Est. Commission"]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:(0,E.formatCurrency)(K.estimatedCommission,"USD")}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"On funded deals"})]})]})]}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[(0,b.jsx)("div",{className:"flex-1 max-w-md",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(h.Input,{placeholder:"Search by client name, email, or deal...",value:S,onChange:a=>T(a.target.value),className:"pl-10"})]})}),(0,b.jsxs)(i.Select,{value:U,onValueChange:V,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-full md:w-48",children:(0,b.jsx)(i.SelectValue,{placeholder:"Filter by status"})}),(0,b.jsx)(i.SelectContent,{children:H.map(a=>(0,b.jsx)(i.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(g.Button,{variant:"table"===W?"default":"outline",size:"sm",onClick:()=>X("table"),children:[(0,b.jsx)(y.List,{className:"h-4 w-4 mr-1"}),"Table"]}),(0,b.jsxs)(g.Button,{variant:"buckets"===W?"default":"outline",size:"sm",onClick:()=>X("buckets"),children:[(0,b.jsx)(x,{className:"h-4 w-4 mr-1"}),"Buckets"]})]})]})})}),"table"===W&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Client Transactions"}),(0,b.jsxs)(e.CardDescription,{children:[$.length," transaction",1!==$.length?"s":""," found"]})]}),(0,b.jsx)(e.CardContent,{children:0===$.length?(0,b.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,b.jsx)(k.Users,{className:"h-10 w-10 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:S||"all"!==U?"No clients match your filters":a?"No clients introduced yet":"No client transactions found"})]}):(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Client"}),(0,b.jsx)(j.TableHead,{children:"Deal"}),(0,b.jsx)(j.TableHead,{children:"Investment"}),(0,b.jsx)(j.TableHead,{children:"Stage"}),(0,b.jsx)(j.TableHead,{children:"Est. Commission"}),(0,b.jsx)(j.TableHead,{children:"Actions"})]})}),(0,b.jsx)(j.TableBody,{children:$.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-muted flex items-center justify-center",children:(0,b.jsx)(p.User,{className:"h-4 w-4 text-muted-foreground"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.client_name}),a.client_email&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(t.Mail,{className:"h-3 w-3"}),a.client_email]})]})]})}),(0,b.jsx)(j.TableCell,{children:a.deal_name?(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(r.Briefcase,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm",children:a.deal_name}),a.deal_status&&(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs ml-1",children:a.deal_status})]}):(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"No deal"})}),(0,b.jsx)(j.TableCell,{children:a.subscription_amount?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:(0,E.formatCurrency)(a.subscription_amount,"USD")}),a.subscription_status&&(0,b.jsx)(f.Badge,{variant:"outline",className:(0,D.cn)("text-xs capitalize mt-1",G[a.subscription_status]||""),children:a.subscription_status})]}):(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"No subscription"})}),(0,b.jsx)(j.TableCell,{children:F.find(b=>b.key===a.journey_stage)&&(0,b.jsx)(f.Badge,{className:(0,D.cn)("text-white",F.find(b=>b.key===a.journey_stage)?.color),children:F.find(b=>b.key===a.journey_stage)?.label})}),(0,b.jsx)(j.TableCell,{children:a.estimated_commission?(0,b.jsxs)("div",{className:"text-sm font-medium text-purple-600",children:[(0,E.formatCurrency)(a.estimated_commission,"USD"),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground ml-1",children:["(",(a.commission_rate_bps||0)/100,"%)"]})]}):(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"-"})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[a.deal_id&&a.has_termsheet&&(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",asChild:!0,title:"View Termsheet",children:(0,b.jsx)(d.default,{href:`/versotech_main/opportunities/${a.deal_id}`,children:(0,b.jsx)(u.FileText,{className:"h-4 w-4"})})}),a.deal_id&&a.has_dataroom_access&&(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",asChild:!0,title:"Access Dataroom",children:(0,b.jsx)(d.default,{href:`/versotech_main/opportunities/${a.deal_id}?tab=data-room${a.investor_id?`&client_investor_id=${a.investor_id}`:""}`,children:(0,b.jsx)(v.FolderOpen,{className:"h-4 w-4"})})})]})})]},a.id))})]})})})]}),"buckets"===W&&(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:F.map(a=>{let c=a.icon,h=_[a.key]||[],i=h.reduce((a,b)=>a+(b.subscription_amount||0),0);return(0,b.jsxs)(e.Card,{className:"flex flex-col",children:[(0,b.jsxs)(e.CardHeader,{className:(0,D.cn)("pb-2",a.color,"text-white rounded-t-lg"),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(c,{className:"h-4 w-4"}),(0,b.jsx)(e.CardTitle,{className:"text-sm",children:a.label})]}),(0,b.jsx)(f.Badge,{variant:"secondary",className:"bg-white/20 text-white",children:h.length})]}),i>0&&(0,b.jsx)("p",{className:"text-xs text-white/80 mt-1",children:(0,E.formatCurrency)(i,"USD")})]}),(0,b.jsx)(e.CardContent,{className:"flex-1 pt-4 space-y-2 min-h-[200px] max-h-[400px] overflow-y-auto",children:0===h.length?(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No clients in this stage"}):h.map(a=>(0,b.jsxs)("div",{className:"p-3 bg-muted/50 rounded-lg border border-border hover:bg-muted transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(p.User,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm font-medium truncate",children:a.client_name})]}),a.deal_name&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground truncate mb-1",children:a.deal_name}),a.subscription_amount?(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-xs font-medium",children:(0,E.formatCurrency)(a.subscription_amount,"USD")}),(0,b.jsx)(f.Badge,{variant:"outline",className:(0,D.cn)("text-xs",G[a.subscription_status||""]||""),children:a.subscription_status})]}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No subscription"}),a.deal_id&&(0,b.jsxs)("div",{className:"flex gap-1 mt-2",children:[(0,b.jsx)(g.Button,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",asChild:!0,children:(0,b.jsxs)(d.default,{href:`/versotech_main/opportunities/${a.deal_id}`,children:[(0,b.jsx)(u.FileText,{className:"h-3 w-3 mr-1"}),"Deal"]})}),(0,b.jsx)(g.Button,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",asChild:!0,children:(0,b.jsxs)(d.default,{href:`/versotech_main/opportunities/${a.deal_id}?tab=data-room${a.investor_id?`&client_investor_id=${a.investor_id}`:""}`,children:[(0,b.jsx)(v.FolderOpen,{className:"h-3 w-3 mr-1"}),"Files"]})})]})]},a.id))})]},a.key)})})]})}a.s(["default",()=>I],389530)}];

//# sourceMappingURL=c6ad4_src_app_%28main%29_versotech_main_client-transactions_page_tsx_8b99ff7d._.js.map