module.exports=[737172,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(421908),e=a.i(249464),f=a.i(772998),g=a.i(284169),h=a.i(191675),i=a.i(266828),j=a.i(479612),k=a.i(3321),l=a.i(113276),m=a.i(71459),n=a.i(47748),o=a.i(439467),p=a.i(231276),q=a.i(142015),r=a.i(425622),s=a.i(134303),t=a.i(496392),u=a.i(191363),v=a.i(408420),w=a.i(899750);function x({onUpdate:a,variant:x="investor"}){let y=(0,v.useTourOptional)(),z="staff"===x,A="arranger"===x,[B,C]=(0,c.useState)(!z&&!A),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)({notification_settings:{email_notifications:!0,deal_updates:!0,message_notifications:!0}}),R=(0,c.useCallback)(async()=>{C(!0);try{let a=await fetch("/api/dashboard-preferences"),b=await a.json();a.ok&&b.preferences&&Q({notification_settings:b.preferences.notification_settings||P.notification_settings})}catch(a){console.error("Error loading preferences:",a),w.toast.error("Failed to load preferences")}finally{C(!1)}},[]),S=(0,c.useCallback)(async()=>{try{let a=await fetch("/api/gdpr/deletion-request"),b=await a.json();a.ok&&b.has_pending&&O(!0)}catch(a){console.error("Error checking pending deletion:",a)}},[]);(0,c.useEffect)(()=>{z||A?C(!1):(R(),S())},[z,A,R,S]);let T=async()=>{G(!0);try{let a=await fetch("/api/gdpr/export",{method:"POST"});if(!a.ok)throw Error("Export failed");let b=await a.blob(),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`verso-data-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),d.remove(),w.toast.success("Your data has been exported successfully")}catch(a){console.error("Export error:",a),w.toast.error("Failed to export your data. Please try again.")}finally{G(!1)}},U=async()=>{if(!J||J.length<10)return void w.toast.error("Please provide a reason (at least 10 characters)");if(!L)return void w.toast.error("Please confirm you understand the consequences");I(!0);try{let a=await fetch("/api/gdpr/deletion-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:J,confirm_understood:L})}),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to submit request");w.toast.success("Your deletion request has been submitted and will be reviewed within 30 days."),O(!0),K(""),M(!1)}catch(a){console.error("Deletion request error:",a),w.toast.error(a.message||"Failed to submit deletion request")}finally{I(!1)}},V=(a,b)=>{Q(c=>({...c,notification_settings:{...c.notification_settings,[a]:b}}))},W=async b=>{b.preventDefault(),E(!0);try{let b=await fetch("/api/dashboard-preferences",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)}),c=await b.json();if(!b.ok)throw Error(c.error||"Failed to update preferences");w.toast.success("Preferences updated successfully"),a?.()}catch(a){console.error("Error updating preferences:",a),w.toast.error("Failed to update preferences",{description:a.message})}finally{E(!1)}};if(A){let a=[{label:"Mandate Updates",description:"Notifications about new mandates, status changes, and investor activity on your deals.",icon:o.Mail,configurable:!0},{label:"Subscription Packs",description:"Alerts when subscription packs require your signature or have status updates.",icon:q.MessageSquare,configurable:!0},{label:"Payment Requests",description:"Notifications about fee events, invoice submissions, and payment confirmations.",icon:m.Bell,configurable:!0},{label:"Compliance Alerts",description:"License expiry reminders, KYC renewal notices, and regulatory updates.",icon:n.ShieldCheck,configurable:!1}];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Bell,{className:"h-5 w-5 text-primary"}),(0,b.jsx)(g.CardTitle,{children:"Notification Preferences"})]}),(0,b.jsx)(g.CardDescription,{children:"Manage how you receive updates about your mandates and business activities"})]}),(0,b.jsx)(g.CardContent,{className:"space-y-4",children:a.map(a=>(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4 rounded-lg border p-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(a.icon,{className:"mt-1 h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:a.label}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description})]})]}),a.configurable?(0,b.jsx)(f.Switch,{defaultChecked:!0}):(0,b.jsx)("span",{className:"text-xs text-emerald-600 font-medium bg-emerald-50 px-2 py-1 rounded",children:"Always on"})]},a.label))})]}),(0,b.jsx)(g.Card,{className:"border-blue-200 bg-blue-50/50",children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(n.ShieldCheck,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("p",{className:"font-medium text-blue-900",children:"Compliance Notifications"}),(0,b.jsx)("p",{className:"text-blue-700 mt-1",children:"Some notifications cannot be disabled as they are required for regulatory compliance. These include license expiry warnings and mandatory KYC renewal reminders."})]})]})})}),y&&(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.PlayCircle,{className:"h-5 w-5 text-primary"}),(0,b.jsx)(g.CardTitle,{children:"Platform Tour"})]}),(0,b.jsx)(g.CardDescription,{children:"Take a guided tour of the platform features"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{children:"Restart Platform Tour"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Walk through the platform features again with an interactive guide"})]}),(0,b.jsxs)(d.Button,{type:"button",variant:"outline",onClick:()=>y.startTour(),children:[(0,b.jsx)(u.PlayCircle,{className:"mr-2 h-4 w-4"}),"Start Tour"]})]})})]})]})}if(z){let a=[{label:"Email Alerts",description:"Critical incidents, investor escalations, and compliance reminders are always routed to your inbox.",icon:o.Mail},{label:"In-App Notifications",description:"Task reminders, approvals, and operational updates show up in the notification center automatically.",icon:q.MessageSquare},{label:"SMS Escalations",description:"After-hours or high-priority issues trigger backup SMS alerts for the on-call operations lead.",icon:p.Phone}];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(g.Card,{className:"bg-white/5 border-white/10",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.ShieldCheck,{className:"h-5 w-5 text-primary"}),(0,b.jsx)(g.CardTitle,{className:"text-white",children:"Notifications are centrally managed"})]}),(0,b.jsx)(g.CardDescription,{className:"text-white/70",children:"Staff alerts follow an operations-wide policy so nothing critical can be turned off accidentally."})]}),(0,b.jsx)(g.CardContent,{className:"space-y-4",children:a.map(a=>(0,b.jsxs)("div",{className:"flex items-start gap-3 rounded-lg border border-white/10 bg-white/5 p-4",children:[(0,b.jsx)(a.icon,{className:"mt-1 h-4 w-4 text-primary"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-white",children:a.label}),(0,b.jsx)("p",{className:"text-sm text-white/70",children:a.description}),(0,b.jsx)("p",{className:"text-xs text-emerald-300/90 mt-1",children:"Status: Always on"})]})]},a.label))})]}),(0,b.jsxs)(g.Card,{className:"bg-white/5 border-white/10",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:"text-white",children:"Need to adjust routing?"}),(0,b.jsx)(g.CardDescription,{className:"text-white/70",children:"Changes go through the Platform team so audit trails stay intact."})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-sm text-white/70",children:"Share the context (investor, deal, urgency) and the team will update the notification matrix or escalate to engineering."}),(0,b.jsx)(d.Button,{asChild:!0,className:"bg-white/10 text-white border border-white/20 hover:bg-white/20",children:(0,b.jsx)("a",{href:"mailto:admin@versotech.com?subject=Notification%20routing%20update",children:"Contact Platform Team"})})]})]}),y&&(0,b.jsxs)(g.Card,{className:"bg-white/5 border-white/10",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.PlayCircle,{className:"h-5 w-5 text-primary"}),(0,b.jsx)(g.CardTitle,{className:"text-white",children:"Platform Tour"})]}),(0,b.jsx)(g.CardDescription,{className:"text-white/70",children:"Take a guided tour of the platform features"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{className:"text-white",children:"Restart Platform Tour"}),(0,b.jsx)("p",{className:"text-sm text-white/70",children:"Walk through the platform features again with an interactive guide"})]}),(0,b.jsxs)(d.Button,{type:"button",variant:"outline",className:"border-white/20 text-white hover:bg-white/10",onClick:()=>y.startTour(),children:[(0,b.jsx)(u.PlayCircle,{className:"mr-2 h-4 w-4"}),"Start Tour"]})]})})]}),(0,b.jsxs)(g.Card,{className:"bg-white/5 border-amber-500/30",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(t.Shield,{className:"h-5 w-5 text-amber-400"}),(0,b.jsx)(g.CardTitle,{className:"text-white",children:"Data & Privacy"})]}),(0,b.jsx)(g.CardDescription,{className:"text-white/70",children:"Manage your personal data in accordance with GDPR regulations"})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{className:"text-white",children:"Export Your Data"}),(0,b.jsx)("p",{className:"text-sm text-white/70",children:"Download a copy of all your personal data stored in our system"})]}),(0,b.jsx)(d.Button,{type:"button",variant:"outline",className:"border-white/20 text-white hover:bg-white/10",onClick:T,disabled:F,children:F?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Exporting..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Download,{className:"mr-2 h-4 w-4"}),"Export My Data"]})})]}),(0,b.jsx)("div",{className:"border-t border-white/10 pt-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{className:"text-red-400",children:"Request Account Deletion"}),(0,b.jsx)("p",{className:"text-sm text-white/70",children:"Request permanent deletion of your account and all associated data. This action is irreversible and will be reviewed by our team."})]}),N?(0,b.jsx)("div",{className:"rounded-lg border border-amber-500/30 bg-amber-500/10 p-4",children:(0,b.jsx)("p",{className:"text-sm text-amber-300",children:"You have a pending deletion request. Our team will review it within 30 days."})}):(0,b.jsxs)(j.AlertDialog,{children:[(0,b.jsx)(j.AlertDialogTrigger,{asChild:!0,children:(0,b.jsxs)(d.Button,{type:"button",variant:"destructive",className:"w-full sm:w-auto",children:[(0,b.jsx)(s.Trash2,{className:"mr-2 h-4 w-4"}),"Request Account Deletion"]})}),(0,b.jsxs)(j.AlertDialogContent,{children:[(0,b.jsxs)(j.AlertDialogHeader,{children:[(0,b.jsx)(j.AlertDialogTitle,{children:"Request Account Deletion"}),(0,b.jsx)(j.AlertDialogDescription,{asChild:!0,children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("p",{children:"This will submit a request to permanently delete your account and all associated data. This action cannot be undone."}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(e.Label,{htmlFor:"staff-deletion-reason",children:"Please tell us why you want to delete your account:"}),(0,b.jsx)(h.Textarea,{id:"staff-deletion-reason",placeholder:"Enter your reason (minimum 10 characters)",value:J,onChange:a=>K(a.target.value),className:"min-h-[100px]"})]}),(0,b.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"staff-deletion-confirm",checked:L,onCheckedChange:a=>M(!0===a)}),(0,b.jsx)("label",{htmlFor:"staff-deletion-confirm",className:"text-sm text-muted-foreground leading-tight",children:"I understand that this will permanently delete my account, all my data, and I will lose access to the platform."})]})]})})]}),(0,b.jsxs)(j.AlertDialogFooter,{children:[(0,b.jsx)(j.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(j.AlertDialogAction,{onClick:U,disabled:H||!J||J.length<10||!L,className:"bg-red-600 hover:bg-red-700",children:H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Deletion Request"})]})]})]})]})})]})]})]})}return B?(0,b.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,b.jsx)(k.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,b.jsxs)("form",{onSubmit:W,className:"space-y-6",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Bell,{className:"h-5 w-5"}),(0,b.jsx)(g.CardTitle,{children:"Notification Preferences"})]}),(0,b.jsx)(g.CardDescription,{children:"Manage how you receive notifications and updates"})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{htmlFor:"email_notifications",children:"Email Notifications"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Receive notifications via email"})]}),(0,b.jsx)(f.Switch,{id:"email_notifications",checked:P.notification_settings.email_notifications,onCheckedChange:a=>V("email_notifications",a)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{htmlFor:"deal_updates",children:"Deal Updates"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Get notified about deal status changes"})]}),(0,b.jsx)(f.Switch,{id:"deal_updates",checked:P.notification_settings.deal_updates,onCheckedChange:a=>V("deal_updates",a)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{htmlFor:"message_notifications",children:"Message Notifications"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Get notified about new messages"})]}),(0,b.jsx)(f.Switch,{id:"message_notifications",checked:P.notification_settings.message_notifications,onCheckedChange:a=>V("message_notifications",a)})]})]})]}),y&&(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.PlayCircle,{className:"h-5 w-5"}),(0,b.jsx)(g.CardTitle,{children:"Platform Tour"})]}),(0,b.jsx)(g.CardDescription,{children:"Take a guided tour of the platform features"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{children:"Restart Platform Tour"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Walk through the platform features again with an interactive guide"})]}),(0,b.jsxs)(d.Button,{type:"button",variant:"outline",onClick:()=>y.startTour(),children:[(0,b.jsx)(u.PlayCircle,{className:"mr-2 h-4 w-4"}),"Start Tour"]})]})})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(d.Button,{type:"submit",disabled:D,className:"w-full sm:w-auto",children:D?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving Preferences..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Save,{className:"mr-2 h-4 w-4"}),"Save Preferences"]})})}),(0,b.jsxs)(g.Card,{className:"border-amber-200",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(t.Shield,{className:"h-5 w-5 text-amber-600"}),(0,b.jsx)(g.CardTitle,{children:"Data & Privacy"})]}),(0,b.jsx)(g.CardDescription,{children:"Manage your personal data in accordance with GDPR regulations"})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{children:"Export Your Data"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Download a copy of all your personal data stored in our system"})]}),(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:T,disabled:F,children:F?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Exporting..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Download,{className:"mr-2 h-4 w-4"}),"Export My Data"]})})]}),(0,b.jsx)("div",{className:"border-t pt-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(e.Label,{className:"text-destructive",children:"Request Account Deletion"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Request permanent deletion of your account and all associated data. This action is irreversible and will be reviewed by our team."})]}),N?(0,b.jsx)("div",{className:"rounded-lg border border-amber-300 bg-amber-50 p-4",children:(0,b.jsx)("p",{className:"text-sm text-amber-800",children:"You have a pending deletion request. Our team will review it within 30 days."})}):(0,b.jsxs)(j.AlertDialog,{children:[(0,b.jsx)(j.AlertDialogTrigger,{asChild:!0,children:(0,b.jsxs)(d.Button,{type:"button",variant:"destructive",className:"w-full sm:w-auto",children:[(0,b.jsx)(s.Trash2,{className:"mr-2 h-4 w-4"}),"Request Account Deletion"]})}),(0,b.jsxs)(j.AlertDialogContent,{children:[(0,b.jsxs)(j.AlertDialogHeader,{children:[(0,b.jsx)(j.AlertDialogTitle,{children:"Request Account Deletion"}),(0,b.jsx)(j.AlertDialogDescription,{asChild:!0,children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("p",{children:"This will submit a request to permanently delete your account and all associated data. This action cannot be undone."}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(e.Label,{htmlFor:"deletion-reason",children:"Please tell us why you want to delete your account:"}),(0,b.jsx)(h.Textarea,{id:"deletion-reason",placeholder:"Enter your reason (minimum 10 characters)",value:J,onChange:a=>K(a.target.value),className:"min-h-[100px]"})]}),(0,b.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"deletion-confirm",checked:L,onCheckedChange:a=>M(!0===a)}),(0,b.jsx)("label",{htmlFor:"deletion-confirm",className:"text-sm text-muted-foreground leading-tight",children:"I understand that this will permanently delete my account, all my data, and I will lose access to all investments and documents."})]})]})})]}),(0,b.jsxs)(j.AlertDialogFooter,{children:[(0,b.jsx)(j.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(j.AlertDialogAction,{onClick:U,disabled:H||!J||J.length<10||!L,className:"bg-destructive hover:bg-destructive/90",children:H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Deletion Request"})]})]})]})]})})]})]})]})}a.s(["PreferencesEditor",()=>x])},466932,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(478870),e=a.i(799373),f=a.i(439467),g=a.i(42329),h=a.i(399580),i=a.i(625473),j=a.i(134303),k=a.i(919014),l=a.i(752907),m=a.i(496392),n=a.i(703606),o=a.i(3321),p=a.i(873785),q=a.i(877918),r=a.i(405398),s=a.i(421908),t=a.i(284169),u=a.i(15788),v=a.i(771088),w=a.i(470305),x=a.i(663475),y=a.i(249464),z=a.i(951870),A=a.i(216316),B=a.i(266828),C=a.i(899750),D=a.i(181608);let E=[{value:"admin",label:"Administrator"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}];function F({entityType:a,entityId:F,entityName:G,initialMembers:H=[],currentUserRole:I="member",isCurrentUserPrimary:J=!1,canManageMembers:K=!1,showSignatoryOption:L=!0,onMembersChange:M}){let[N,O]=(0,c.useState)(H),[P,Q]=(0,c.useState)([]),[R,S]=(0,c.useState)(!0),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)({role:I,is_primary:J,can_manage:K}),[_,aa]=(0,c.useState)(""),[ab,ac]=(0,c.useState)("member"),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)(!1),[ah,ai]=(0,c.useState)(null),[aj,ak]=(0,c.useState)("member"),[al,am]=(0,c.useState)(!1),[an,ao]=(0,c.useState)(!1),[ap,aq]=(0,c.useState)(!1);(0,c.useEffect)(()=>{ar(),as()},[a,F]);let ar=async()=>{try{let b=await fetch(`/api/members?entity_type=${a}&entity_id=${F}`);if(b.ok){let a=await b.json();O(a.members||[]),a.current_user&&$(a.current_user)}}catch(a){console.error("Error fetching members:",a)}},as=async()=>{try{let b=await fetch(`/api/members/invite?entity_type=${a}&entity_id=${F}`);if(b.ok){let a=await b.json();Q(a.invitations||[])}}catch(a){console.error("Error fetching invitations:",a)}finally{S(!1)}},at=async()=>{if(ah){aq(!0);try{let b=await fetch(`/api/members/${ah.user_id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_type:a,entity_id:F,role:aj,can_sign:al,is_primary:an})}),c=await b.json();if(!b.ok)return void C.toast.error(c.error||"Failed to update member");C.toast.success("Member updated successfully"),ag(!1),ai(null),ar()}catch(a){console.error("Error updating member:",a),C.toast.error("Failed to update member")}finally{aq(!1)}}},au=async b=>{if(confirm("Are you sure you want to remove this member?"))try{let c=await fetch(`/api/members/${b}?entity_type=${a}&entity_id=${F}`,{method:"DELETE"}),d=await c.json();if(!c.ok)return void C.toast.error(d.error||"Failed to remove member");C.toast.success("Member removed successfully"),ar()}catch(a){console.error("Error removing member:",a),C.toast.error("Failed to remove member")}},av=async()=>{if(!_)return void C.toast.error("Please enter an email address");W(!0);try{let b=await fetch("/api/members/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_type:a,entity_id:F,email:_,role:ab,is_signatory:ad})}),c=await b.json();if(!b.ok)return void C.toast.error(c.error||"Failed to send invitation");c.requires_approval?C.toast.success(`Invitation request created for ${_}. Awaiting CEO approval.`,{description:"The invitation email will be sent after approval.",duration:5e3}):C.toast.success(`Invitation sent to ${_}`),U(!1),aa(""),ac("member"),ae(!1),as(),c.invitation?.accept_url&&(await navigator.clipboard.writeText(c.invitation.accept_url),C.toast.info("Invitation link copied to clipboard"))}catch(a){C.toast.error("Failed to send invitation")}finally{W(!1)}},aw=async a=>{Y(a);try{let b=await fetch(`/api/members/invite?id=${a}`,{method:"DELETE"});if(!b.ok){let a=await b.json();C.toast.error(a.error||"Failed to cancel invitation");return}C.toast.success("Invitation cancelled"),as()}catch(a){C.toast.error("Failed to cancel invitation")}finally{Y(null)}},ax=async a=>{let b=`${window.location.origin}/invitation/accept?token=${a}`;await navigator.clipboard.writeText(b),C.toast.success("Invitation link copied!")},ay=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),az=P.filter(a=>["pending","pending_approval"].includes(a.status)),aA=P.filter(a=>!["pending","pending_approval"].includes(a.status));return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,b.jsx)(d.Users,{className:"h-5 w-5"}),"Team Members"]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Manage who has access to ",G]})]}),Z.can_manage&&(0,b.jsxs)(s.Button,{onClick:()=>U(!0),children:[(0,b.jsx)(e.UserPlus,{className:"h-4 w-4 mr-2"}),"Invite Member"]})]}),(0,b.jsxs)(D.Tabs,{defaultValue:"members",className:"w-full",id:"members-management-tabs",children:[(0,b.jsxs)(D.TabsList,{children:[(0,b.jsxs)(D.TabsTrigger,{value:"members",className:"flex items-center gap-2",children:[(0,b.jsx)(d.Users,{className:"h-4 w-4"}),"Members (",N.length,")"]}),(0,b.jsxs)(D.TabsTrigger,{value:"invitations",className:"flex items-center gap-2",children:[(0,b.jsx)(f.Mail,{className:"h-4 w-4"}),"Invitations (",az.length,")"]})]}),(0,b.jsx)(D.TabsContent,{value:"members",className:"mt-4",children:(0,b.jsx)(t.Card,{children:(0,b.jsx)(t.CardContent,{className:"p-0",children:0===N.length?(0,b.jsxs)("div",{className:"py-12 text-center",children:[(0,b.jsx)(d.Users,{className:"h-10 w-10 mx-auto text-muted-foreground mb-3"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No members yet"}),Z.can_manage&&(0,b.jsxs)(s.Button,{variant:"outline",size:"sm",className:"mt-4",onClick:()=>U(!0),children:[(0,b.jsx)(e.UserPlus,{className:"h-4 w-4 mr-2"}),"Invite First Member"]})]}):(0,b.jsxs)(v.Table,{children:[(0,b.jsx)(v.TableHeader,{children:(0,b.jsxs)(v.TableRow,{children:[(0,b.jsx)(v.TableHead,{children:"Member"}),(0,b.jsx)(v.TableHead,{children:"Role"}),(0,b.jsx)(v.TableHead,{children:"Status"}),(0,b.jsx)(v.TableHead,{children:"Joined"}),Z.can_manage&&(0,b.jsx)(v.TableHead,{className:"w-10"})]})}),(0,b.jsx)(v.TableBody,{children:N.map(a=>(0,b.jsxs)(v.TableRow,{children:[(0,b.jsx)(v.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center",children:a.profile?.avatar_url?(0,b.jsx)("img",{src:a.profile.avatar_url,alt:"",className:"w-8 h-8 rounded-full object-cover"}):(0,b.jsx)("span",{className:"text-sm font-medium",children:(a.profile?.display_name||a.profile?.email||"?")[0].toUpperCase()})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.profile?.display_name||"Unknown User"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.profile?.email})]})]})}),(0,b.jsx)(v.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Badge,{variant:"outline",className:"capitalize",children:a.role}),a.is_primary&&(0,b.jsxs)(u.Badge,{variant:"secondary",children:[(0,b.jsx)(m.Shield,{className:"w-3 h-3 mr-1"}),"Primary"]}),a.can_sign&&(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[(0,b.jsx)(l.PenTool,{className:"w-3 h-3 mr-1"}),"Signatory"]})]})}),(0,b.jsx)(v.TableCell,{children:a.can_sign&&!a.signature_specimen_url?(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[(0,b.jsx)(q.AlertCircle,{className:"w-3 h-3 mr-1"}),"Needs Signature"]}):(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[(0,b.jsx)(h.CheckCircle2,{className:"w-3 h-3 mr-1"}),"Active"]})}),(0,b.jsx)(v.TableCell,{className:"text-muted-foreground",children:ay(a.created_at)}),Z.can_manage&&(0,b.jsx)(v.TableCell,{children:(0,b.jsxs)(A.DropdownMenu,{children:[(0,b.jsx)(A.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(s.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(n.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(A.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(A.DropdownMenuItem,{onClick:()=>{ai(a),ak(a.role),am(a.can_sign||!1),ao(a.is_primary),ag(!0)},children:[(0,b.jsx)(r.Edit,{className:"h-4 w-4 mr-2"}),"Edit Member"]}),!a.is_primary&&(0,b.jsxs)(A.DropdownMenuItem,{className:"text-destructive",onClick:()=>au(a.user_id),children:[(0,b.jsx)(j.Trash2,{className:"h-4 w-4 mr-2"}),"Remove Member"]})]})]})})]},a.id))})]})})})}),(0,b.jsxs)(D.TabsContent,{value:"invitations",className:"mt-4 space-y-4",children:[(0,b.jsxs)(t.Card,{children:[(0,b.jsxs)(t.CardHeader,{children:[(0,b.jsx)(t.CardTitle,{className:"text-base",children:"Pending Invitations"}),(0,b.jsx)(t.CardDescription,{children:"Invitations waiting to be accepted"})]}),(0,b.jsx)(t.CardContent,{className:"p-0",children:R?(0,b.jsx)("div",{className:"py-8 text-center",children:(0,b.jsx)(o.Loader2,{className:"h-6 w-6 animate-spin mx-auto text-muted-foreground"})}):0===az.length?(0,b.jsxs)("div",{className:"py-8 text-center text-muted-foreground",children:[(0,b.jsx)(f.Mail,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No pending invitations"})]}):(0,b.jsxs)(v.Table,{children:[(0,b.jsx)(v.TableHeader,{children:(0,b.jsxs)(v.TableRow,{children:[(0,b.jsx)(v.TableHead,{children:"Email"}),(0,b.jsx)(v.TableHead,{children:"Role"}),(0,b.jsx)(v.TableHead,{children:"Invited By"}),(0,b.jsx)(v.TableHead,{children:"Expires"}),(0,b.jsx)(v.TableHead,{className:"w-10"})]})}),(0,b.jsx)(v.TableBody,{children:az.map(a=>(0,b.jsxs)(v.TableRow,{children:[(0,b.jsx)(v.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Mail,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{children:a.email}),a.is_signatory&&(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-500/30",children:[(0,b.jsx)(l.PenTool,{className:"w-3 h-3 mr-1"}),"Signatory"]})]})}),(0,b.jsx)(v.TableCell,{children:(0,b.jsx)(u.Badge,{variant:"outline",className:"capitalize",children:a.role})}),(0,b.jsx)(v.TableCell,{className:"text-muted-foreground",children:a.invited_by_name}),(0,b.jsx)(v.TableCell,{className:"text-muted-foreground",children:ay(a.expires_at)}),(0,b.jsx)(v.TableCell,{children:(0,b.jsxs)(A.DropdownMenu,{children:[(0,b.jsx)(A.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(s.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(n.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(A.DropdownMenuContent,{align:"end",children:[a.invitation_token&&(0,b.jsxs)(A.DropdownMenuItem,{onClick:()=>ax(a.invitation_token),children:[(0,b.jsx)(k.Copy,{className:"h-4 w-4 mr-2"}),"Copy Link"]}),Z.can_manage&&(0,b.jsxs)(A.DropdownMenuItem,{className:"text-destructive",onClick:()=>aw(a.id),disabled:X===a.id,children:[X===a.id?(0,b.jsx)(o.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(i.XCircle,{className:"h-4 w-4 mr-2"}),"Cancel Invitation"]})]})]})})]},a.id))})]})})]}),aA.length>0&&(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsx)(t.CardTitle,{className:"text-base",children:"Invitation History"})}),(0,b.jsx)(t.CardContent,{className:"p-0",children:(0,b.jsxs)(v.Table,{children:[(0,b.jsx)(v.TableHeader,{children:(0,b.jsxs)(v.TableRow,{children:[(0,b.jsx)(v.TableHead,{children:"Email"}),(0,b.jsx)(v.TableHead,{children:"Status"}),(0,b.jsx)(v.TableHead,{children:"Date"})]})}),(0,b.jsx)(v.TableBody,{children:aA.slice(0,10).map(a=>(0,b.jsxs)(v.TableRow,{children:[(0,b.jsx)(v.TableCell,{children:a.email}),(0,b.jsx)(v.TableCell,{children:(a=>{switch(a){case"pending":return(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[(0,b.jsx)(g.Clock,{className:"w-3 h-3 mr-1"}),"Pending"]});case"pending_approval":return(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-orange-500/10 text-orange-600 border-orange-500/30",children:[(0,b.jsx)(g.Clock,{className:"w-3 h-3 mr-1"}),"Awaiting CEO Approval"]});case"accepted":return(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[(0,b.jsx)(h.CheckCircle2,{className:"w-3 h-3 mr-1"}),"Accepted"]});case"expired":return(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-gray-500/10 text-gray-600 border-gray-500/30",children:[(0,b.jsx)(g.Clock,{className:"w-3 h-3 mr-1"}),"Expired"]});case"cancelled":return(0,b.jsxs)(u.Badge,{variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30",children:[(0,b.jsx)(i.XCircle,{className:"w-3 h-3 mr-1"}),"Cancelled"]});default:return(0,b.jsx)(u.Badge,{variant:"outline",children:a})}})(a.status)}),(0,b.jsx)(v.TableCell,{className:"text-muted-foreground",children:ay(a.accepted_at||a.created_at)})]},a.id))})]})})]})]})]}),(0,b.jsx)(w.Dialog,{open:T,onOpenChange:U,children:(0,b.jsxs)(w.DialogContent,{children:[(0,b.jsxs)(w.DialogHeader,{children:[(0,b.jsx)(w.DialogTitle,{children:"Invite Team Member"}),(0,b.jsxs)(w.DialogDescription,{children:["Send an invitation to join ",G]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"email",children:"Email Address"}),(0,b.jsx)(x.Input,{id:"email",type:"email",placeholder:"colleague@example.com",value:_,onChange:a=>aa(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"role",children:"Role"}),(0,b.jsxs)(z.Select,{value:ab,onValueChange:ac,children:[(0,b.jsx)(z.SelectTrigger,{children:(0,b.jsx)(z.SelectValue,{placeholder:"Select role"})}),(0,b.jsx)(z.SelectContent,{children:E.map(a=>(0,b.jsx)(z.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),L&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,b.jsx)(B.Checkbox,{id:"signatory",checked:ad,onCheckedChange:a=>ae(!0===a)}),(0,b.jsxs)(y.Label,{htmlFor:"signatory",className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)(l.PenTool,{className:"h-4 w-4"}),"Authorized Signatory",(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"(can sign documents)"})]})]})]}),(0,b.jsxs)(w.DialogFooter,{children:[(0,b.jsx)(s.Button,{variant:"outline",onClick:()=>U(!1),disabled:V,children:"Cancel"}),(0,b.jsx)(s.Button,{onClick:av,disabled:V||!_,children:V?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Send,{className:"h-4 w-4 mr-2"}),"Send Invitation"]})})]})]})}),(0,b.jsx)(w.Dialog,{open:af,onOpenChange:ag,children:(0,b.jsxs)(w.DialogContent,{children:[(0,b.jsxs)(w.DialogHeader,{children:[(0,b.jsx)(w.DialogTitle,{children:"Edit Team Member"}),(0,b.jsxs)(w.DialogDescription,{children:["Update ",ah?.profile?.display_name||ah?.profile?.email||"member"," settings"]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{children:"Role"}),(0,b.jsxs)(z.Select,{value:aj,onValueChange:ak,children:[(0,b.jsx)(z.SelectTrigger,{children:(0,b.jsx)(z.SelectValue,{placeholder:"Select role"})}),(0,b.jsx)(z.SelectContent,{children:E.map(a=>(0,b.jsx)(z.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),L&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,b.jsx)(B.Checkbox,{id:"edit-signatory",checked:al,onCheckedChange:a=>am(!0===a)}),(0,b.jsxs)(y.Label,{htmlFor:"edit-signatory",className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)(l.PenTool,{className:"h-4 w-4"}),"Authorized Signatory",(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"(can sign documents)"})]})]}),Z.is_primary&&!ah?.is_primary&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,b.jsx)(B.Checkbox,{id:"edit-primary",checked:an,onCheckedChange:a=>ao(!0===a)}),(0,b.jsxs)(y.Label,{htmlFor:"edit-primary",className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)(m.Shield,{className:"h-4 w-4"}),"Make Primary Contact",(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"(transfers primary status)"})]})]}),ah?.is_primary&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-lg",children:[(0,b.jsx)(m.Shield,{className:"h-4 w-4 inline mr-2"}),"This member is the primary contact. To change primary status, select another member and make them primary."]})]}),(0,b.jsxs)(w.DialogFooter,{children:[(0,b.jsx)(s.Button,{variant:"outline",onClick:()=>ag(!1),disabled:ap,children:"Cancel"}),(0,b.jsx)(s.Button,{onClick:at,disabled:ap,children:ap?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})})]})}a.s(["MembersManagementTab",()=>F])},354726,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(284169),e=a.i(421908),f=a.i(663475),g=a.i(249464),h=a.i(181608),i=a.i(403205),j=a.i(752907),k=a.i(468095),l=a.i(134303),m=a.i(113276),n=a.i(38125),o=a.i(399580),p=a.i(3321),q=a.i(877918);let r=(0,a.i(95799).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var s=a.i(899750),t=a.i(888987),u=a.i(477594);function v({currentSignatureUrl:a,onSignatureUpdate:v,entityType:w="investor"}){let x=function(a="investor"){switch(a){case"commercial_partner":return{get:"/api/commercial-partners/me/signature",post:"/api/commercial-partners/me/upload-signature",delete:"/api/commercial-partners/me/signature"};case"partner":return{get:"/api/partners/me/signature",post:"/api/partners/me/upload-signature",delete:"/api/partners/me/signature"};case"introducer":return{get:"/api/introducers/me/signature",post:"/api/introducers/me/upload-signature",delete:"/api/introducers/me/signature"};case"lawyer":return{get:"/api/lawyers/me/signature",post:"/api/lawyers/me/upload-signature",delete:"/api/lawyers/me/signature"};default:return{get:"/api/signature-specimen",post:"/api/signature-specimen",delete:"/api/signature-specimen"}}}(w),y=(0,c.useRef)(null),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(a||null),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)("draw"),[N,O]=(0,c.useState)(null);(0,c.useEffect)(()=>{P()},[]);let P=async()=>{E(!0);try{let a=await fetch(x.get);if(a.ok){let b=await a.json();b.signature_url&&C(b.signature_url)}}catch(a){console.error("Error loading signature:",a)}finally{E(!1)}},Q=()=>{y.current&&(y.current.clear(),A(!1))},R=()=>{I(null),K(null)},S=async()=>{G(!0),O(null);try{let a;if("draw"===L){if(!y.current||y.current.isEmpty()){O("Please draw your signature first"),G(!1);return}let b=y.current.getTrimmedCanvas().toDataURL("image/png"),c=await fetch(b);a=await c.blob()}else{if(!H){O("Please upload an image first"),G(!1);return}a=H}let b=new FormData;b.append("signature",a,"signature.png");let c=await fetch(x.post,{method:"POST",body:b});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to save signature")}let d=await c.json();C(d.signature_url),v?.(d.signature_url),"draw"===L?Q():R(),s.toast.success("Signature saved successfully")}catch(a){console.error("Error saving signature:",a),O(a instanceof Error?a.message:"Failed to save signature"),s.toast.error("Failed to save signature")}finally{G(!1)}},T=async()=>{if(B){G(!0);try{if(!(await fetch(x.delete,{method:"DELETE"})).ok)throw Error("Failed to delete signature");C(null),v?.(null),s.toast.success("Signature removed")}catch(a){console.error("Error deleting signature:",a),s.toast.error("Failed to remove signature")}finally{G(!1)}}};return D?(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"py-12",children:(0,b.jsx)("div",{className:"flex items-center justify-center",children:(0,b.jsx)(p.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})})})}):(0,b.jsxs)("div",{className:"space-y-6",children:[B&&(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(d.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(o.CheckCircle2,{className:"h-5 w-5 text-green-600"}),"Current Signature"]}),(0,b.jsx)(d.CardDescription,{children:"Your signature specimen on file"})]}),(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:T,disabled:F,className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-950/50",children:[F?(0,b.jsx)(p.Loader2,{className:"h-4 w-4 animate-spin mr-2"}):(0,b.jsx)(l.Trash2,{className:"h-4 w-4 mr-2"}),"Remove"]})]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"border rounded-lg p-4 bg-white flex items-center justify-center",children:(0,b.jsx)("img",{src:B,alt:"Your signature",className:"max-h-24 object-contain"})})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-base",children:B?"Update Signature":"Add Signature"}),(0,b.jsx)(d.CardDescription,{children:"Draw your signature or upload an image. This will be used for document signing."})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[N&&(0,b.jsxs)(i.Alert,{variant:"destructive",children:[(0,b.jsx)(q.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(i.AlertDescription,{children:N})]}),(0,b.jsxs)(h.Tabs,{value:L,onValueChange:a=>M(a),children:[(0,b.jsxs)(h.TabsList,{className:"grid w-full grid-cols-2",children:[(0,b.jsxs)(h.TabsTrigger,{value:"draw",className:"gap-2",children:[(0,b.jsx)(j.PenTool,{className:"h-4 w-4"}),"Draw"]}),(0,b.jsxs)(h.TabsTrigger,{value:"upload",className:"gap-2",children:[(0,b.jsx)(k.Upload,{className:"h-4 w-4"}),"Upload"]})]}),(0,b.jsxs)(h.TabsContent,{value:"draw",className:"mt-4 space-y-4",children:[(0,b.jsx)("div",{className:"border-2 border-dashed rounded-lg bg-white overflow-hidden",children:(0,b.jsx)(u.default,{ref:y,canvasProps:{className:"w-full h-40 cursor-crosshair",style:{width:"100%",height:"160px"}},penColor:"black",backgroundColor:"white",onEnd:()=>{y.current&&!y.current.isEmpty()&&(A(!0),O(null))}})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Draw your signature using your mouse or touch screen"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",onClick:Q,disabled:!z,className:"flex-1",children:[(0,b.jsx)(n.RotateCcw,{className:"h-4 w-4 mr-2"}),"Clear"]}),(0,b.jsxs)(e.Button,{onClick:S,disabled:!z||F,className:"flex-1",children:[F?(0,b.jsx)(p.Loader2,{className:"h-4 w-4 animate-spin mr-2"}):(0,b.jsx)(m.Save,{className:"h-4 w-4 mr-2"}),"Save Signature"]})]})]}),(0,b.jsx)(h.TabsContent,{value:"upload",className:"mt-4 space-y-4",children:J?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"border rounded-lg p-4 bg-white flex items-center justify-center",children:(0,b.jsx)("img",{src:J,alt:"Signature preview",className:"max-h-32 object-contain"})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",onClick:R,className:"flex-1",children:[(0,b.jsx)(n.RotateCcw,{className:"h-4 w-4 mr-2"}),"Choose Different"]}),(0,b.jsxs)(e.Button,{onClick:S,disabled:F,className:"flex-1",children:[F?(0,b.jsx)(p.Loader2,{className:"h-4 w-4 animate-spin mr-2"}):(0,b.jsx)(m.Save,{className:"h-4 w-4 mr-2"}),"Save Signature"]})]})]}):(0,b.jsx)("div",{children:(0,b.jsxs)(g.Label,{htmlFor:"signature-upload",className:(0,t.cn)("flex flex-col items-center justify-center w-full h-40 border-2 border-dashed rounded-lg cursor-pointer","bg-muted/50 hover:bg-muted transition-colors"),children:[(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,b.jsx)(r,{className:"h-10 w-10 text-muted-foreground mb-3"}),(0,b.jsxs)("p",{className:"mb-2 text-sm text-muted-foreground",children:[(0,b.jsx)("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPEG or WebP (max 2MB)"})]}),(0,b.jsx)(f.Input,{id:"signature-upload",type:"file",accept:"image/png,image/jpeg,image/webp",className:"hidden",onChange:a=>{let b=a.target.files?.[0];if(!b)return;if(!["image/png","image/jpeg","image/webp"].includes(b.type))return void O("Please upload a PNG, JPEG, or WebP image");if(b.size>2097152)return void O("File size must be less than 2MB");I(b),O(null);let c=new FileReader;c.onload=a=>{K(a.target?.result)},c.readAsDataURL(b)}})]})})})]})]})]}),(0,b.jsx)(d.Card,{className:"bg-blue-50/50 border-blue-200 dark:bg-blue-950/30 dark:border-blue-900",children:(0,b.jsx)(d.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(j.PenTool,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("p",{className:"font-medium text-blue-900 dark:text-blue-100",children:"About Signature Specimens"}),(0,b.jsx)("p",{className:"text-blue-700 dark:text-blue-300 mt-1",children:"Your signature specimen will be used for digitally signing documents such as subscription agreements, NDAs, and introducer agreements. Make sure your signature is clear and consistent with your legal documents."})]})]})})})]})}a.s(["SignatureSpecimenTab",()=>v],354726)},149159,a=>{"use strict";var b=a.i(352584),c=a.i(611038),d=a.i(478870),e=a.i(799373),f=a.i(405398),g=a.i(134303),h=a.i(47748),i=a.i(42329),j=a.i(877918),k=a.i(421908),l=a.i(284169),m=a.i(15788),n=a.i(771088),o=a.i(479612),p=a.i(899750),q=a.i(832784);let r={director:"Director",shareholder:"Shareholder",beneficial_owner:"Beneficial Owner",authorized_signatory:"Authorized Signatory",officer:"Officer",partner:"Partner",ubo:"UBO",signatory:"Signatory",authorized_representative:"Authorized Representative",beneficiary:"Beneficiary",trustee:"Trustee",managing_member:"Managing Member",general_partner:"General Partner",limited_partner:"Limited Partner",other:"Other"};function s({entityType:a,entityId:s,entityName:t,apiEndpoint:u,canManage:v=!0,title:w="Entity Members",description:x="Manage directors, shareholders, and beneficial owners"}){let[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1);(0,c.useEffect)(()=>{O()},[u]);let O=async()=>{B(!0),D(null);try{let a=await fetch(u);if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to load members")}let b=await a.json();z(b.members||[])}catch(a){console.error("Error loading members:",a),D(a instanceof Error?a.message:"Failed to load members")}finally{B(!1)}},P=()=>{H(null),F(!0)},Q=async()=>{if(K){N(!0);try{let a=await fetch(`${u}/${K}`,{method:"DELETE"});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to delete member")}p.toast.success("Member removed successfully"),J(!1),L(null),await O()}catch(a){console.error("Error deleting member:",a),p.toast.error(a instanceof Error?a.message:"Failed to delete member")}finally{N(!1)}}},R=a=>{if(a.full_name)return a.full_name;let b=[a.first_name,a.middle_name,a.last_name,a.name_suffix].filter(Boolean);return b.length>0?b.join(" "):"Unknown"};return A?(0,b.jsx)(l.Card,{children:(0,b.jsx)(l.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("div",{className:"animate-pulse",children:"Loading members..."})})}):C?(0,b.jsx)(l.Card,{children:(0,b.jsxs)(l.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(j.AlertCircle,{className:"w-12 h-12 mx-auto text-destructive mb-4"}),(0,b.jsx)("p",{className:"text-destructive",children:C}),(0,b.jsx)(k.Button,{onClick:O,variant:"outline",className:"mt-4",children:"Retry"})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(l.Card,{children:[(0,b.jsx)(l.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Users,{className:"h-5 w-5"}),w]}),(0,b.jsx)(l.CardDescription,{children:x})]}),v&&(0,b.jsxs)(k.Button,{onClick:P,children:[(0,b.jsx)(e.UserPlus,{className:"w-4 h-4 mr-2"}),"Add Member"]})]})}),(0,b.jsx)(l.CardContent,{children:0===y.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(d.Users,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"No members added yet. Add directors, shareholders, or beneficial owners."}),v&&(0,b.jsxs)(k.Button,{onClick:P,variant:"outline",children:[(0,b.jsx)(e.UserPlus,{className:"w-4 h-4 mr-2"}),"Add Your First Member"]})]}):(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:"Name"}),(0,b.jsx)(n.TableHead,{children:"Role"}),(0,b.jsx)(n.TableHead,{children:"Email"}),(0,b.jsx)(n.TableHead,{children:"Ownership %"}),(0,b.jsx)(n.TableHead,{children:"KYC Status"}),v&&(0,b.jsx)(n.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(n.TableBody,{children:y.map(a=>{let c;return(0,b.jsxs)(n.TableRow,{children:[(0,b.jsxs)(n.TableCell,{className:"font-medium",children:[R(a),a.is_beneficial_owner&&(0,b.jsx)(m.Badge,{variant:"secondary",className:"ml-2 text-xs",children:"UBO"}),a.is_signatory&&(0,b.jsx)(m.Badge,{variant:"secondary",className:"ml-2 text-xs",children:"Signatory"})]}),(0,b.jsxs)(n.TableCell,{children:[(c=a.role,(0,b.jsx)(m.Badge,{variant:"outline",children:r[c]||c})),a.role_title&&(0,b.jsxs)("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.role_title,")"]})]}),(0,b.jsx)(n.TableCell,{children:a.email||"N/A"}),(0,b.jsx)(n.TableCell,{children:null!=a.ownership_percentage?`${a.ownership_percentage}%`:"N/A"}),(0,b.jsx)(n.TableCell,{children:(a=>{switch(a){case"approved":return(0,b.jsxs)(m.Badge,{className:"bg-green-500",children:[(0,b.jsx)(h.ShieldCheck,{className:"w-3 h-3 mr-1"}),"Approved"]});case"pending":case"submitted":return(0,b.jsxs)(m.Badge,{className:"bg-yellow-500",children:[(0,b.jsx)(i.Clock,{className:"w-3 h-3 mr-1"}),"Pending"]});case"rejected":return(0,b.jsxs)(m.Badge,{className:"bg-red-500",children:[(0,b.jsx)(j.AlertCircle,{className:"w-3 h-3 mr-1"}),"Rejected"]});default:return(0,b.jsx)(m.Badge,{variant:"outline",children:"Not Submitted"})}})(a.kyc_status)}),v&&(0,b.jsx)(n.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(k.Button,{variant:"outline",size:"sm",onClick:()=>{H(a),F(!0)},children:(0,b.jsx)(f.Edit,{className:"w-4 h-4"})}),(0,b.jsx)(k.Button,{variant:"outline",size:"sm",onClick:()=>{L(a.id),J(!0)},children:(0,b.jsx)(g.Trash2,{className:"w-4 h-4"})})]})})]},a.id)})})]})})]}),(0,b.jsx)(q.MemberKYCEditDialog,{open:E,onOpenChange:F,entityType:a,entityId:s,memberId:G?.id,memberName:G?R(G):void 0,initialData:(a=>{if(a)return{role:a.role,first_name:a.first_name||"",middle_name:a.middle_name||"",last_name:a.last_name||"",name_suffix:a.name_suffix||"",date_of_birth:a.date_of_birth||"",country_of_birth:a.country_of_birth||"",nationality:a.nationality||"",email:a.email||"",phone_mobile:a.phone_mobile||"",phone_office:a.phone_office||"",residential_street:a.residential_street||"",residential_line_2:a.residential_line_2||"",residential_city:a.residential_city||"",residential_state:a.residential_state||"",residential_postal_code:a.residential_postal_code||"",residential_country:a.residential_country||"",is_us_citizen:a.is_us_citizen||!1,is_us_taxpayer:a.is_us_taxpayer||!1,us_taxpayer_id:a.us_taxpayer_id||"",country_of_tax_residency:a.country_of_tax_residency||"",tax_id_number:a.tax_id_number||"",id_type:a.id_type||"",id_number:a.id_number||"",id_issue_date:a.id_issue_date||"",id_expiry_date:a.id_expiry_date||"",id_issuing_country:a.id_issuing_country||"",ownership_percentage:a.ownership_percentage}})(G),apiEndpoint:u,onSuccess:()=>{O()},mode:G?"edit":"create"}),(0,b.jsx)(o.AlertDialog,{open:I,onOpenChange:J,children:(0,b.jsxs)(o.AlertDialogContent,{children:[(0,b.jsxs)(o.AlertDialogHeader,{children:[(0,b.jsx)(o.AlertDialogTitle,{children:"Remove Member"}),(0,b.jsx)(o.AlertDialogDescription,{children:"Are you sure you want to remove this member? This action can be undone by contacting support."})]}),(0,b.jsxs)(o.AlertDialogFooter,{children:[(0,b.jsx)(o.AlertDialogCancel,{disabled:M,children:"Cancel"}),(0,b.jsx)(o.AlertDialogAction,{onClick:Q,disabled:M,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:M?"Removing...":"Remove"})]})]})})]})}a.s(["GenericEntityMembersTab",()=>s])}];

//# sourceMappingURL=versotech-portal_src_components_4eea5159._.js.map