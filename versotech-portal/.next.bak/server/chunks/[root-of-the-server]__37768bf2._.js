module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},270406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},433669,e=>{"use strict";e.i(814247);var t=e.i(150615),r=e.i(12049),s=e.i(57824);let n=async()=>{let e=await (0,s.cookies)();return(0,t.createServerClient)("https://ipguxdssecfexudnvtia.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlwZ3V4ZHNzZWNmZXh1ZG52dGlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzNjE4MzcsImV4cCI6MjA3MzkzNzgzN30.AGxM_YW9hfxuu7xDpi_4xhOoRhYM7iGTS1vJ0z2FByE",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:s})=>{e.set(t,r,s)})}catch(e){}}}})};e.s(["createClient",0,n,"createServiceClient",0,()=>(0,r.createClient)("https://ipguxdssecfexudnvtia.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})])},911357,e=>{"use strict";var t=e.i(433669);class r{static instance;static getInstance(){return r.instance||(r.instance=new r),r.instance}async log(e){try{let r=await (0,t.createClient)();await r.from("audit_logs").insert({event_type:"system",actor_id:e.actor_user_id||null,action:e.action,entity_type:e.entity,entity_id:e.entity_id||null,action_details:e.metadata||null,timestamp:new Date().toISOString()})}catch(e){console.error("Audit logging failed:",e)}}async logMany(e){for(let t of e)await this.log(t)}}let s=r.getInstance();e.s(["AuditActions",0,{LOGIN:"login",LOGOUT:"logout",PASSWORD_CHANGE:"password_change",CREATE:"create",READ:"read",UPDATE:"update",DELETE:"delete",DOCUMENT_UPLOAD:"document_upload",DOCUMENT_DOWNLOAD:"document_download",DOCUMENT_DELETE:"document_delete",WORKFLOW_TRIGGER:"workflow_trigger",WORKFLOW_COMPLETED:"workflow_completed",WORKFLOW_FAILED:"workflow_failed",USER_CREATED:"user_created",PROFILE_UPDATED:"profile_updated",ROLE_CHANGED:"role_changed",SUBSCRIPTION_CREATED:"subscription_created",CAPITAL_CALL_CREATED:"capital_call_created",DISTRIBUTION_CREATED:"distribution_created",REPORT_REQUESTED:"report_requested",MESSAGE_SENT:"message_sent",COMMISSION_CREATED:"commission_created",COMMISSION_ACCRUED:"commission_accrued",COMMISSION_INVOICE_REQUESTED:"commission_invoice_requested",COMMISSION_INVOICED:"commission_invoiced",COMMISSION_PAID:"commission_paid",COMMISSION_CANCELLED:"commission_cancelled",AGREEMENT_CREATED:"agreement_created",AGREEMENT_SENT:"agreement_sent",AGREEMENT_APPROVED:"agreement_approved",AGREEMENT_SIGNED:"agreement_signed",AGREEMENT_ACTIVATED:"agreement_activated",AGREEMENT_REJECTED:"agreement_rejected",AGREEMENT_EXPIRED:"agreement_expired"},"AuditEntities",0,{USERS:"users",PROFILES:"profiles",INVESTORS:"investors",VEHICLES:"vehicles",SUBSCRIPTIONS:"subscriptions",POSITIONS:"positions",DOCUMENTS:"documents",WORKFLOWS:"workflows",WORKFLOW_RUNS:"workflow_runs",CONVERSATIONS:"conversations",MESSAGES:"messages",REQUEST_TICKETS:"request_tickets",CAPITAL_CALLS:"capital_calls",DISTRIBUTIONS:"distributions",DEALS:"deals",ALLOCATIONS:"allocations",FEE_EVENTS:"fee_events",INVOICES:"invoices",BANK_TRANSACTIONS:"bank_transactions",PAYMENTS:"payments",ARRANGER:"arranger_entities",INTRODUCER:"introducers",PARTNER:"partners",COMMERCIAL_PARTNER:"commercial_partners",FEE_PLANS:"arranger_fee_plans",CEO_ENTITY:"ceo_entity",CEO_USERS:"ceo_users",INTRODUCER_COMMISSIONS:"introducer_commissions",PARTNER_COMMISSIONS:"partner_commissions",COMMERCIAL_PARTNER_COMMISSIONS:"commercial_partner_commissions",INTRODUCER_AGREEMENTS:"introducer_agreements",PARTNER_AGREEMENTS:"partner_agreements",COMMERCIAL_PARTNER_AGREEMENTS:"commercial_partner_agreements",INTRODUCTIONS:"introductions"},"auditLogger",0,s])},221640,e=>{"use strict";async function t(e){let{data:{user:t},error:r}=await e.auth.getUser();return{user:t,error:r}}async function r(e,t){let{data:r}=await e.from("profiles").select("role").eq("id",t.id).single();return r?.role||null}async function s(e,t,r){let{data:s}=await e.from("profiles").select("role").eq("id",t).single();if(s?.role==="ceo")return!0;let{data:n}=await e.from("ceo_users").select("user_id").eq("user_id",t).maybeSingle();if(n)return!0;let{data:i}=await e.from("staff_permissions").select("permission").eq("user_id",t).in("permission",r).limit(1).maybeSingle();return!!i}async function n(e,t){return s(e,t,["super_admin"])}async function i(e,t){let s=await r(e,t);if(s&&(s.startsWith("staff_")||"ceo"===s))return!0;if("multi_persona"===s)try{let{data:r}=await e.rpc("get_user_personas",{p_user_id:t.id});if(r&&Array.isArray(r))return r.some(e=>"staff"===e.persona_type||"ceo"===e.persona_type)}catch(e){console.error("[isStaffUser] Error checking personas:",e)}return!1}e.s(["getAuthenticatedUser",()=>t,"hasPermission",()=>s,"isStaffUser",()=>i,"isSuperAdmin",()=>n])},610875,(e,t,r)=>{"use strict";t.exports=e.r(918607).vendored["react-rsc"].ReactServerDOMTurbopackServer},714890,e=>{"use strict";e.s(["createClient",()=>r,"hasActiveSession",()=>s,"resetClient",()=>n]);var t=e.i(610875);let r=(0,t.registerClientReference)(function(){throw Error("Attempted to call createClient() from the server but createClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/lib/supabase/client.ts <module evaluation>","createClient"),s=(0,t.registerClientReference)(function(){throw Error("Attempted to call hasActiveSession() from the server but hasActiveSession is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/lib/supabase/client.ts <module evaluation>","hasActiveSession"),n=(0,t.registerClientReference)(function(){throw Error("Attempted to call resetClient() from the server but resetClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/lib/supabase/client.ts <module evaluation>","resetClient")},499017,e=>{"use strict";e.s(["createClient",()=>r,"hasActiveSession",()=>s,"resetClient",()=>n]);var t=e.i(610875);let r=(0,t.registerClientReference)(function(){throw Error("Attempted to call createClient() from the server but createClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/lib/supabase/client.ts","createClient"),s=(0,t.registerClientReference)(function(){throw Error("Attempted to call hasActiveSession() from the server but hasActiveSession is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/lib/supabase/client.ts","hasActiveSession"),n=(0,t.registerClientReference)(function(){throw Error("Attempted to call resetClient() from the server but resetClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/versotech-portal/src/lib/supabase/client.ts","resetClient")},209363,e=>{"use strict";e.i(714890);var t=e.i(499017);e.n(t)},185325,e=>{"use strict";function t(e){let t=Array.isArray(e?.conversation_participants)?e.conversation_participants.map(e=>{let t=e?.profiles||{};return{id:t.id||e.user_id,displayName:t.display_name||t.email||null,email:t.email||null,role:t.role||null,avatarUrl:t.avatar_url??null,participantRole:e?.participant_role??"member",joinedAt:e?.joined_at,lastReadAt:e?.last_read_at??null,lastNotifiedAt:e?.last_notified_at??null,isMuted:e?.is_muted??!1,isPinned:e?.is_pinned??!1}}):[],s=Array.isArray(e?.messages)?e.messages[0]:null,n=s?r(s):null;return{id:e.id,subject:e.subject??null,preview:e.preview??null,type:e.type??"dm",visibility:e.visibility??"internal",ownerTeam:e.owner_team??null,dealId:e.deal_id??null,createdBy:e.created_by??null,createdAt:e.created_at,updatedAt:e.updated_at,lastMessageAt:e.last_message_at??null,lastMessageId:e.last_message_id??null,archivedAt:e.archived_at??null,metadata:e.metadata??{},participants:t,unreadCount:e.unreadCount??0,latestMessage:n,participantCount:t.length}}function r(e){let t=e.sender;return{id:e.id,conversationId:e.conversation_id,senderId:e.sender_id,body:e.body??null,messageType:e.message_type??"text",fileKey:e.file_key??null,replyToMessageId:e.reply_to_message_id??null,metadata:e.metadata??{},createdAt:e.created_at,editedAt:e.edited_at??null,deletedAt:e.deleted_at??null,sender:t?{id:t.id??null,displayName:t.displayName??t.display_name??null,email:t.email??null,role:t.role??null,avatarUrl:t.avatarUrl??t.avatar_url??null}:null,readBy:Array.isArray(e.read_by)?e.read_by:[]}}e.i(209363),e.s(["normalizeConversation",()=>t,"normalizeMessage",()=>r])},261365,e=>{e.v(e=>Promise.resolve().then(()=>e(368899)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__37768bf2._.js.map