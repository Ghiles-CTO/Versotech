module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},270406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},433669,e=>{"use strict";e.i(814247);var t=e.i(150615),r=e.i(12049),a=e.i(57824);let s=async()=>{let e=await (0,a.cookies)();return(0,t.createServerClient)("https://ipguxdssecfexudnvtia.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlwZ3V4ZHNzZWNmZXh1ZG52dGlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzNjE4MzcsImV4cCI6MjA3MzkzNzgzN30.AGxM_YW9hfxuu7xDpi_4xhOoRhYM7iGTS1vJ0z2FByE",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:a})=>{e.set(t,r,a)})}catch(e){}}}})};e.s(["createClient",0,s,"createServiceClient",0,()=>(0,r.createClient)("https://ipguxdssecfexudnvtia.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})])},911357,e=>{"use strict";var t=e.i(433669);class r{static instance;static getInstance(){return r.instance||(r.instance=new r),r.instance}async log(e){try{let r=await (0,t.createClient)();await r.from("audit_logs").insert({event_type:"system",actor_id:e.actor_user_id||null,action:e.action,entity_type:e.entity,entity_id:e.entity_id||null,action_details:e.metadata||null,timestamp:new Date().toISOString()})}catch(e){console.error("Audit logging failed:",e)}}async logMany(e){for(let t of e)await this.log(t)}}let a=r.getInstance();e.s(["AuditActions",0,{LOGIN:"login",LOGOUT:"logout",PASSWORD_CHANGE:"password_change",CREATE:"create",READ:"read",UPDATE:"update",DELETE:"delete",DOCUMENT_UPLOAD:"document_upload",DOCUMENT_DOWNLOAD:"document_download",DOCUMENT_DELETE:"document_delete",WORKFLOW_TRIGGER:"workflow_trigger",WORKFLOW_COMPLETED:"workflow_completed",WORKFLOW_FAILED:"workflow_failed",USER_CREATED:"user_created",PROFILE_UPDATED:"profile_updated",ROLE_CHANGED:"role_changed",SUBSCRIPTION_CREATED:"subscription_created",CAPITAL_CALL_CREATED:"capital_call_created",DISTRIBUTION_CREATED:"distribution_created",REPORT_REQUESTED:"report_requested",MESSAGE_SENT:"message_sent",COMMISSION_CREATED:"commission_created",COMMISSION_ACCRUED:"commission_accrued",COMMISSION_INVOICE_REQUESTED:"commission_invoice_requested",COMMISSION_INVOICED:"commission_invoiced",COMMISSION_PAID:"commission_paid",COMMISSION_CANCELLED:"commission_cancelled",AGREEMENT_CREATED:"agreement_created",AGREEMENT_SENT:"agreement_sent",AGREEMENT_APPROVED:"agreement_approved",AGREEMENT_SIGNED:"agreement_signed",AGREEMENT_ACTIVATED:"agreement_activated",AGREEMENT_REJECTED:"agreement_rejected",AGREEMENT_EXPIRED:"agreement_expired"},"AuditEntities",0,{USERS:"users",PROFILES:"profiles",INVESTORS:"investors",VEHICLES:"vehicles",SUBSCRIPTIONS:"subscriptions",POSITIONS:"positions",DOCUMENTS:"documents",WORKFLOWS:"workflows",WORKFLOW_RUNS:"workflow_runs",CONVERSATIONS:"conversations",MESSAGES:"messages",REQUEST_TICKETS:"request_tickets",CAPITAL_CALLS:"capital_calls",DISTRIBUTIONS:"distributions",DEALS:"deals",ALLOCATIONS:"allocations",FEE_EVENTS:"fee_events",INVOICES:"invoices",BANK_TRANSACTIONS:"bank_transactions",PAYMENTS:"payments",ARRANGER:"arranger_entities",INTRODUCER:"introducers",PARTNER:"partners",COMMERCIAL_PARTNER:"commercial_partners",FEE_PLANS:"arranger_fee_plans",CEO_ENTITY:"ceo_entity",CEO_USERS:"ceo_users",INTRODUCER_COMMISSIONS:"introducer_commissions",PARTNER_COMMISSIONS:"partner_commissions",COMMERCIAL_PARTNER_COMMISSIONS:"commercial_partner_commissions",INTRODUCER_AGREEMENTS:"introducer_agreements",PARTNER_AGREEMENTS:"partner_agreements",COMMERCIAL_PARTNER_AGREEMENTS:"commercial_partner_agreements",INTRODUCTIONS:"introductions"},"auditLogger",0,a])},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},430586,e=>{"use strict";let t={storage:{bucket:process.env.SIGNATURES_BUCKET||"signatures",paths:{unsigned:(e,t)=>`${e}/${t}_unsigned.pdf`,signed:(e,t)=>`${e}/${t}_signed.pdf`}},token:{lengthBytes:32,expiryDays:7},pdf:{signature:{width:150,height:50},table:{bottom:433,height:112},positions:{party_a:{xPercent:.292},party_b:{xPercent:.704}},metadata:{timestampFontSize:7,timestampOffsetY:12,signerNameOffsetY:22,textColor:{r:.3,g:.3,b:.3}}},email:{fromAddress:"signatures@versoholdings.com",replyTo:"support@versoholdings.com"}};e.s(["SIGNATURE_CONFIG",0,t])},522734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},40697,e=>{e.v("/server/assets/pdf.worker.6654537e.mjs")},411164,e=>{"use strict";var t=e.i(522734),r=e.i(792509),a=e.i(430586);async function s(a){let s=await e.A(908258),n=[process.env.PDFJS_WORKER_SRC,new URL(e.R(40697)).toString(),new URL(e.R(40697)).toString()].filter(Boolean),o=n.find(e=>{try{let a=e.startsWith("file:")?(0,r.fileURLToPath)(e):e;return(0,t.existsSync)(a)}catch{return!1}})||n[0];s.GlobalWorkerOptions.workerSrc=o;let i=[];try{let e=s.getDocument({data:a,useSystemFonts:!0,disableFontFace:!0}),t=await e.promise;console.log(`üîç [ANCHOR] Scanning ${t.numPages} pages for SIG_ANCHOR markers...`);for(let e=1;e<=t.numPages;e++){let r=await t.getPage(e),a=await r.getTextContent(),s=r.getViewport({scale:1});for(let t of a.items){if(!("str"in t))continue;let r=t.str,a=r.includes("SIG_ANCHOR:"),n=r.includes("SIG ANCHOR:");if(!a&&!n)continue;let o=null;if(a){let e=r.match(/SIG_ANCHOR:(\S+)/);e&&(o=e[1])}else if(n){let e=r.match(/SIG ANCHOR:([a-z0-9_ ]+)/i);e&&(o=e[1].trim().replace(/ /g,"_"),console.log(`   üîß Normalized space-corrupted anchor: "${e[1]}" -> "${o}"`))}if(!o)continue;let c=t.transform[4],l=t.transform[5];i.push({anchorId:o,pageNumber:e,rawX:c,rawY:l,xPercent:c/s.width,yFromBottom:l,pageWidth:s.width,pageHeight:s.height}),console.log(`   üìç Found ${o} on page ${e} at (${c.toFixed(1)}, ${l.toFixed(1)}) - ${(c/s.width*100).toFixed(1)}% from left`)}}}catch(e){throw console.error("‚ùå [ANCHOR] PDF parsing error:",e),e}return console.log(`‚úÖ [ANCHOR] Found ${i.length} anchor(s) total`),i}function n(e,t){let r=new Set(e.map(e=>e.anchorId)),a=t.filter(e=>!r.has(e));if(a.length>0){let e=Array.from(r).join(", ")||"(none)";throw Error(`MISSING_ANCHORS: ${a.join(", ")}. Found: ${e}`)}}function o(e,t,r="subscription"){let s=function(e,t="subscription"){return"introducer_agreement"===t?[{anchorId:e,label:"introducer_agreement"}]:e.startsWith("party_a")?[{anchorId:`${e}_form`,label:"subscription_form"},{anchorId:e,label:"main_agreement"}]:"party_b"===e?[{anchorId:"party_b_form",label:"subscription_form"},{anchorId:"party_b_wire",label:"wire_instructions"},{anchorId:"party_b",label:"main_agreement"},{anchorId:"party_b_tcs",label:"tcs"}]:"party_c"===e?[{anchorId:"party_c",label:"main_agreement"},{anchorId:"party_c_tcs",label:"tcs"}]:(console.warn(`‚ö†Ô∏è [ANCHOR] Unknown position: ${e}`),[])}(t,r),n=[];for(let o of(console.log(`üìç [PLACEMENT] Calculating placements for ${t} (${r}, anchor-based Y)...`),s)){let s=e.find(e=>e.anchorId===o.anchorId);if(s){let e="introducer_agreement"===r?s.xPercent:function(e,t,r="subscription"){return e.startsWith("party_a")?"subscription_form"===t?.63:.29:"party_b"===e?"tcs"===t?.43:"main_agreement"===t?.29:"subscription_form"===t?.2:.25:"party_c"===e&&"tcs"===t?.43:.29}(t,o.label,r),i=function(e,t,r="subscription"){let{metadata:s}=a.SIGNATURE_CONFIG.pdf,n="wire_instructions"===t?14:s.signerNameOffsetY;return e.rawY+n+4}(s,o.label,r);console.log(`   üîç [ANCHOR] ${o.anchorId} on page ${s.pageNumber}`),console.log(`      Anchor position (for reference): (${s.rawX.toFixed(0)}pt, ${s.rawY.toFixed(0)}pt)`),console.log(`   üìç [PLACEMENT] ${t} -> page ${s.pageNumber}`),console.log(`      FIXED X: ${(100*e).toFixed(0)}% | ANCHOR Y: ${i.toFixed(0)}pt (${o.label})`),n.push({page:s.pageNumber,x:e,y:i,label:o.label}),console.log(`   ‚úì ${o.anchorId} -> page ${s.pageNumber}, x=${(100*e).toFixed(0)}%, y=${i.toFixed(0)}pt (${o.label})`)}else console.warn(`   ‚ö†Ô∏è Anchor not found: ${o.anchorId} (expected for ${t})`)}return console.log(`‚úÖ [PLACEMENT] Created ${n.length} placement(s) for ${t}`),n}function i(e){let t=["party_a"];for(let r=1;r<=e;r++){let e=1===r?"party_b":`party_b_${r}`;t.push(e)}return t}e.s(["detectAnchors",()=>s,"getPlacementsFromAnchors",()=>o,"getRequiredAnchorsForIntroducerAgreement",()=>i,"validateRequiredAnchors",()=>n])},28885,e=>{"use strict";var t=e.i(430586);class r{supabase;constructor(e){this.supabase=e}async uploadUnsignedPDF(e,r,a,s){let n=t.SIGNATURE_CONFIG.storage.paths.unsigned(e,r),{data:o,error:i}=await this.supabase.storage.from(t.SIGNATURE_CONFIG.storage.bucket).upload(n,a,{contentType:"application/pdf",metadata:s});if(i)throw Error(`Failed to upload unsigned PDF: ${i.message}`);return o.path}async uploadSignedPDF(e,r,a,s){let n=t.SIGNATURE_CONFIG.storage.paths.signed(e,r),{data:o,error:i}=await this.supabase.storage.from(t.SIGNATURE_CONFIG.storage.bucket).upload(n,a,{contentType:"application/pdf",metadata:s});if(i)throw Error(`Failed to upload signed PDF: ${i.message}`);return o.path}async downloadPDF(e){let r=e.startsWith("subscriptions/")||e.startsWith("introducer-agreements/")||e.startsWith("placement-agreements/")?"deal-documents":t.SIGNATURE_CONFIG.storage.bucket,{data:a,error:s}=await this.supabase.storage.from(r).download(e);if(s)throw Error(`Failed to download PDF: ${s.message}`);return new Uint8Array(await a.arrayBuffer())}async getSignedUrl(e,r=3600){let a=e.startsWith("subscriptions/")||e.startsWith("introducer-agreements/")||e.startsWith("placement-agreements/")?"deal-documents":t.SIGNATURE_CONFIG.storage.bucket,{data:s,error:n}=await this.supabase.storage.from(a).createSignedUrl(e,r);if(n)throw Error(`Failed to create signed URL: ${n.message}`);return s.signedUrl}}async function a(e){let t=await fetch(e);if(!t.ok)throw Error(`Failed to download PDF: ${t.statusText}`);return new Uint8Array(await t.arrayBuffer())}e.s(["SignatureStorageManager",()=>r,"downloadPDFFromUrl",()=>a])},261365,e=>{e.v(e=>Promise.resolve().then(()=>e(368899)))},908258,e=>{e.v(t=>Promise.all(["server/chunks/6d6b6_pdfjs-dist_legacy_build_pdf_mjs_b9aeef59._.js"].map(t=>e.l(t))).then(()=>t(217503)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__57becbe1._.js.map