module.exports = [
"[project]/versotech-portal/src/app/favicon.ico.mjs { IMAGE => \"[project]/versotech-portal/src/app/favicon.ico (static in ecmascript, tag client)\" } [app-rsc] (structured image object, ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/favicon.ico.mjs { IMAGE => \"[project]/versotech-portal/src/app/favicon.ico (static in ecmascript, tag client)\" } [app-rsc] (structured image object, ecmascript)"));
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[project]/versotech-portal/src/app/layout.tsx [app-rsc] (ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/layout.tsx [app-rsc] (ecmascript)"));
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/layout.tsx [app-rsc] (ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/(main)/versotech_main/layout.tsx [app-rsc] (ecmascript)"));
}),
"[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx [app-rsc] (client reference proxy) <module evaluation>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CalendarSplitView",
    ()=>CalendarSplitView
]);
// This file is generated by next-core EcmascriptClientReferenceModule.
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.js [app-rsc] (ecmascript)");
;
const CalendarSplitView = (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call CalendarSplitView() from the server but CalendarSplitView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx <module evaluation>", "CalendarSplitView");
}),
"[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx [app-rsc] (client reference proxy)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CalendarSplitView",
    ()=>CalendarSplitView
]);
// This file is generated by next-core EcmascriptClientReferenceModule.
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.js [app-rsc] (ecmascript)");
;
const CalendarSplitView = (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call CalendarSplitView() from the server but CalendarSplitView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx", "CalendarSplitView");
}),
"[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$components$2f$calendar$2f$calendar$2d$split$2d$view$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx [app-rsc] (client reference proxy) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$components$2f$calendar$2f$calendar$2d$split$2d$view$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__ = __turbopack_context__.i("[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx [app-rsc] (client reference proxy)");
;
__turbopack_context__.n(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$components$2f$calendar$2f$calendar$2d$split$2d$view$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__);
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>CalendarPage,
    "dynamic",
    ()=>dynamic
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-dev-runtime.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$components$2f$calendar$2f$calendar$2d$split$2d$view$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/src/components/calendar/calendar-split-view.tsx [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$lib$2f$supabase$2f$server$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/src/lib/supabase/server.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__ = __turbopack_context__.i("[project]/versotech-portal/node_modules/lucide-react/dist/esm/icons/circle-alert.js [app-rsc] (ecmascript) <export default as AlertCircle>");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$lib$2f$auth$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/src/lib/auth.ts [app-rsc] (ecmascript)");
;
;
;
;
;
const dynamic = 'force-dynamic';
// Color palettes for different event types
const TASK_PALETTE = {
    high: {
        id: 'task-high',
        name: 'Task • High priority',
        color: '#dc2626'
    },
    medium: {
        id: 'task-medium',
        name: 'Task • Medium priority',
        color: '#f97316'
    },
    low: {
        id: 'task-low',
        name: 'Task • Standard priority',
        color: '#2563eb'
    }
};
const REQUEST_PALETTE = {
    urgent: {
        id: 'request-urgent',
        name: 'Investor request • Urgent',
        color: '#be123c'
    },
    high: {
        id: 'request-high',
        name: 'Investor request • High',
        color: '#b45309'
    },
    normal: {
        id: 'request-normal',
        name: 'Investor request • Standard',
        color: '#0ea5e9'
    },
    low: {
        id: 'request-low',
        name: 'Investor request • Low',
        color: '#64748b'
    }
};
const DEAL_PALETTE = {
    open: {
        id: 'deal-open',
        name: 'Deal close • Open',
        color: '#7c3aed'
    },
    allocation_pending: {
        id: 'deal-allocation',
        name: 'Deal close • Allocation pending',
        color: '#a855f7'
    },
    due_diligence: {
        id: 'deal-dd',
        name: 'Deal close • Due diligence',
        color: '#9333ea'
    },
    closed: {
        id: 'deal-closed',
        name: 'Deal close • Closed',
        color: '#64748b'
    }
};
const CAPITAL_CALL_PALETTE = {
    pending: {
        id: 'call-pending',
        name: 'Capital call due',
        color: '#dc2626'
    },
    draft: {
        id: 'call-draft',
        name: 'Capital call • Draft',
        color: '#f97316'
    }
};
const DISTRIBUTION_PALETTE = {
    scheduled: {
        id: 'dist-scheduled',
        name: 'Distribution',
        color: '#16a34a'
    }
};
const KYC_PALETTE = {
    expiring_soon: {
        id: 'kyc-expiring',
        name: 'KYC expiring',
        color: '#f59e0b'
    },
    expired: {
        id: 'kyc-expired',
        name: 'KYC expired',
        color: '#dc2626'
    },
    accred_expiring: {
        id: 'accred-expiring',
        name: 'Accreditation expiring',
        color: '#ea580c'
    }
};
const APPROVAL_PALETTE = {
    sla_breach: {
        id: 'approval-breach',
        name: 'Approval • SLA breach',
        color: '#dc2626'
    },
    pending: {
        id: 'approval-pending',
        name: 'Approval pending',
        color: '#f59e0b'
    }
};
const FEE_PALETTE = {
    accrued: {
        id: 'fee-accrued',
        name: 'Fee event',
        color: '#14b8a6'
    }
};
const DATA_ROOM_PALETTE = {
    expiring: {
        id: 'data-room-expiring',
        name: 'Data room access expiring',
        color: '#8b5cf6'
    }
};
const SUBSCRIPTION_PALETTE = {
    funding: {
        id: 'sub-funding',
        name: 'Subscription funding due',
        color: '#10b981'
    }
};
function addDays(base, days) {
    return new Date(base.getTime() + days * 86_400_000);
}
function sentenceCase(input) {
    if (!input) return undefined;
    return input.toLowerCase().split('_').map((part)=>part.charAt(0).toUpperCase() + part.slice(1)).join(' ');
}
async function CalendarPage() {
    const clientSupabase = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$lib$2f$supabase$2f$server$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["createClient"])();
    const { data: { user }, error: userError } = await clientSupabase.auth.getUser();
    if (!user || userError) {
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "p-6",
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "text-center py-16",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__["AlertCircle"], {
                        className: "h-12 w-12 text-gray-400 mx-auto mb-4"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                        lineNumber: 90,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                        className: "text-lg font-medium text-foreground mb-2",
                        children: "Authentication Required"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                        lineNumber: 91,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-muted-foreground",
                        children: "Please log in to view calendar."
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                        lineNumber: 94,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                lineNumber: 89,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
            lineNumber: 88,
            columnNumber: 7
        }, this);
    }
    // Check if user has staff/CEO persona for full access
    const hasStaffAccess = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$lib$2f$auth$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["checkStaffAccess"])(user.id);
    const serviceSupabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$lib$2f$supabase$2f$server$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["createServiceClient"])();
    if (!hasStaffAccess) {
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "p-6",
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "text-center py-16",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__["AlertCircle"], {
                        className: "h-12 w-12 text-gray-400 mx-auto mb-4"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                        lineNumber: 110,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                        className: "text-lg font-medium text-foreground mb-2",
                        children: "Access Restricted"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                        lineNumber: 111,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-muted-foreground",
                        children: "Calendar is only available to staff members."
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                        lineNumber: 114,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                lineNumber: 109,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
            lineNumber: 108,
            columnNumber: 7
        }, this);
    }
    const calendarEvents = [];
    // 1. TASKS - All staff tasks
    const { data: taskRows } = await serviceSupabase.from('tasks').select('id, title, status, priority, due_at, category, created_at').not('status', 'eq', 'completed').not('owner_user_id', 'is', null).order('due_at', {
        ascending: true,
        nullsFirst: false
    }).limit(50);
    for (const task of taskRows ?? []){
        const priorityKey = task.priority || 'medium';
        const palette = TASK_PALETTE[priorityKey] ?? TASK_PALETTE.low;
        const endDate = task.due_at ? new Date(task.due_at) : new Date(task.created_at);
        const startDate = task.due_at ? addDays(endDate, -1) : new Date(task.created_at);
        calendarEvents.push({
            id: `task-${task.id}`,
            name: task.title,
            startAt: startDate.toISOString(),
            endAt: endDate.toISOString(),
            status: palette,
            description: task.category ? `Category • ${sentenceCase(task.category)}` : undefined
        });
    }
    // 2. DEALS - Target close dates
    const { data: dealRows } = await serviceSupabase.from('deals').select('id, name, status, close_at, created_at, vehicles ( name )').in('status', [
        'open',
        'allocation_pending',
        'draft'
    ]).not('close_at', 'is', null).order('close_at', {
        ascending: true
    }).limit(30);
    for (const deal of dealRows ?? []){
        const statusKey = deal.status ?? 'open';
        const palette = DEAL_PALETTE[statusKey] ?? DEAL_PALETTE.open;
        const closeDate = new Date(deal.close_at);
        const startDate = addDays(closeDate, -7);
        calendarEvents.push({
            id: `deal-${deal.id}`,
            name: `Deal Close: ${deal.name}`,
            startAt: startDate.toISOString(),
            endAt: deal.close_at,
            status: palette,
            description: deal.vehicles?.[0]?.name ? `Vehicle • ${deal.vehicles[0].name}` : undefined
        });
    }
    // 3. CAPITAL CALLS - Due dates
    const { data: capitalCallRows } = await serviceSupabase.from('capital_calls').select('id, name, due_date, status, vehicles ( name )').in('status', [
        'draft',
        'pending',
        'active'
    ]).not('due_date', 'is', null).order('due_date', {
        ascending: true
    }).limit(30);
    for (const call of capitalCallRows ?? []){
        const palette = call.status === 'pending' ? CAPITAL_CALL_PALETTE.pending : CAPITAL_CALL_PALETTE.draft;
        const dueDate = new Date(call.due_date);
        const startDate = addDays(dueDate, -3);
        calendarEvents.push({
            id: `call-${call.id}`,
            name: call.name,
            startAt: startDate.toISOString(),
            endAt: call.due_date,
            status: palette,
            description: call.vehicles?.[0]?.name ? `Vehicle • ${call.vehicles[0].name}` : undefined
        });
    }
    // 4. DISTRIBUTIONS - Distribution dates
    const { data: distributionRows } = await serviceSupabase.from('distributions').select('id, name, date, vehicles ( name )').gte('date', new Date(Date.now() - 30 * 86_400_000).toISOString().split('T')[0]).order('date', {
        ascending: true
    }).limit(30);
    for (const dist of distributionRows ?? []){
        const distDate = new Date(dist.date);
        calendarEvents.push({
            id: `dist-${dist.id}`,
            name: dist.name,
            startAt: distDate.toISOString(),
            endAt: distDate.toISOString(),
            status: DISTRIBUTION_PALETTE.scheduled,
            description: dist.vehicles?.[0]?.name ? `Vehicle • ${dist.vehicles[0].name}` : undefined
        });
    }
    // 5. KYC RENEWALS - KYC and accreditation expiry dates
    const ninetyDaysFromNow = new Date(Date.now() + 90 * 86_400_000).toISOString().split('T')[0];
    const { data: kycRows } = await serviceSupabase.from('investors').select('id, legal_name, kyc_expiry_date, accreditation_expiry').or(`kyc_expiry_date.lte.${ninetyDaysFromNow},accreditation_expiry.lte.${ninetyDaysFromNow}`).limit(50);
    for (const investor of kycRows ?? []){
        if (investor.kyc_expiry_date) {
            const expiryDate = new Date(investor.kyc_expiry_date);
            const isExpired = expiryDate < new Date();
            const palette = isExpired ? KYC_PALETTE.expired : KYC_PALETTE.expiring_soon;
            const startDate = addDays(expiryDate, -14);
            calendarEvents.push({
                id: `kyc-${investor.id}`,
                name: `KYC Renewal: ${investor.legal_name}`,
                startAt: startDate.toISOString(),
                endAt: investor.kyc_expiry_date,
                status: palette,
                description: isExpired ? 'Expired' : 'Expiring soon'
            });
        }
        if (investor.accreditation_expiry) {
            const expiryDate = new Date(investor.accreditation_expiry);
            const startDate = addDays(expiryDate, -14);
            calendarEvents.push({
                id: `accred-${investor.id}`,
                name: `Accreditation Renewal: ${investor.legal_name}`,
                startAt: startDate.toISOString(),
                endAt: investor.accreditation_expiry,
                status: KYC_PALETTE.accred_expiring,
                description: 'Accreditation expiring'
            });
        }
    }
    // 6. APPROVALS - Pending approvals with SLA tracking
    const { data: approvalRows } = await serviceSupabase.from('approvals').select('id, entity_type, action, entity_id, created_at, sla_breach_at, requested_by:profiles!requested_by ( display_name )').eq('status', 'pending').order('sla_breach_at', {
        ascending: true,
        nullsFirst: false
    }).limit(30);
    for (const approval of approvalRows ?? []){
        const breachDate = approval.sla_breach_at ? new Date(approval.sla_breach_at) : addDays(new Date(approval.created_at), 3);
        const isBreach = breachDate < new Date();
        const palette = isBreach ? APPROVAL_PALETTE.sla_breach : APPROVAL_PALETTE.pending;
        const startDate = new Date(approval.created_at);
        const approvalType = approval.action ? sentenceCase(approval.action) : sentenceCase(approval.entity_type);
        calendarEvents.push({
            id: `approval-${approval.id}`,
            name: `Approval: ${approvalType}`,
            startAt: startDate.toISOString(),
            endAt: breachDate.toISOString(),
            status: palette,
            description: Array.isArray(approval.requested_by) && approval.requested_by[0]?.display_name ? `Requested by ${approval.requested_by[0].display_name}` : undefined
        });
    }
    // 7. SUBSCRIPTION FUNDING - Funding due dates
    const { data: subscriptionRows } = await serviceSupabase.from('subscriptions').select('id, subscription_number, funding_due_at, investors ( legal_name ), vehicles ( name )').in('status', [
        'committed',
        'active'
    ]).not('funding_due_at', 'is', null).gte('funding_due_at', new Date().toISOString()).order('funding_due_at', {
        ascending: true
    }).limit(30);
    for (const sub of subscriptionRows ?? []){
        const fundingDate = new Date(sub.funding_due_at);
        const startDate = addDays(fundingDate, -5);
        calendarEvents.push({
            id: `sub-${sub.id}`,
            name: `Funding Due: ${(Array.isArray(sub.investors) ? sub.investors[0]?.legal_name : null) || sub.subscription_number}`,
            startAt: startDate.toISOString(),
            endAt: sub.funding_due_at,
            status: SUBSCRIPTION_PALETTE.funding,
            description: sub.vehicles?.[0]?.name ? `Vehicle • ${sub.vehicles[0].name}` : undefined
        });
    }
    // 8. FEE EVENTS - Fee accrual/payment dates
    const { data: feeRows } = await serviceSupabase.from('fee_events').select('id, fee_type, event_date, computed_amount, deals ( name ), investors ( legal_name, display_name )').in('status', [
        'accrued',
        'invoiced'
    ]).gte('event_date', new Date(Date.now() - 30 * 86_400_000).toISOString().split('T')[0]).order('event_date', {
        ascending: true
    }).limit(30);
    for (const fee of feeRows ?? []){
        const feeDate = new Date(fee.event_date);
        const dealName = Array.isArray(fee.deals) && fee.deals[0]?.name ? fee.deals[0].name : null;
        const investorName = Array.isArray(fee.investors) && fee.investors[0] ? fee.investors[0].display_name || fee.investors[0].legal_name : null;
        const description = dealName ? `Deal • ${dealName}` : investorName ? `Investor • ${investorName}` : undefined;
        calendarEvents.push({
            id: `fee-${fee.id}`,
            name: `Fee Event: ${sentenceCase(fee.fee_type)}`,
            startAt: feeDate.toISOString(),
            endAt: feeDate.toISOString(),
            status: FEE_PALETTE.accrued,
            description
        });
    }
    // 9. REQUEST TICKETS - Custom requests with due dates
    const { data: requestRows } = await serviceSupabase.from('request_tickets').select('id, subject, status, priority, due_date, created_at, investors ( legal_name )').in('status', [
        'open',
        'in_progress'
    ]).order('due_date', {
        ascending: true,
        nullsFirst: false
    }).limit(30);
    for (const request of requestRows ?? []){
        const palette = REQUEST_PALETTE[request.priority] ?? REQUEST_PALETTE.normal;
        const endDate = request.due_date ? new Date(request.due_date) : addDays(new Date(request.created_at), 5);
        const startDate = new Date(request.created_at);
        calendarEvents.push({
            id: `request-${request.id}`,
            name: request.subject || 'Investor Request',
            startAt: startDate.toISOString(),
            endAt: endDate.toISOString(),
            status: palette,
            description: Array.isArray(request.investors) && request.investors[0]?.legal_name ? `Investor • ${request.investors[0].legal_name}` : undefined
        });
    }
    // 10. DATA ROOM ACCESS - Expiring access
    const thirtyDaysFromNow = new Date(Date.now() + 30 * 86_400_000).toISOString();
    const { data: dataRoomRows } = await serviceSupabase.from('deal_data_room_access').select('id, expires_at, deals ( name ), investors ( legal_name, display_name )').is('revoked_at', null).lte('expires_at', thirtyDaysFromNow).order('expires_at', {
        ascending: true
    }).limit(30);
    for (const access of dataRoomRows ?? []){
        const expiryDate = new Date(access.expires_at);
        const startDate = addDays(expiryDate, -3);
        const investorName = Array.isArray(access.investors) && access.investors[0] ? access.investors[0].display_name || access.investors[0].legal_name : null;
        calendarEvents.push({
            id: `dataroom-${access.id}`,
            name: `Data Room Expiry: ${(Array.isArray(access.deals) ? access.deals[0]?.name : null) || 'Deal'}`,
            startAt: startDate.toISOString(),
            endAt: access.expires_at,
            status: DATA_ROOM_PALETTE.expiring,
            description: investorName ? `Investor • ${investorName}` : undefined
        });
    }
    // Sort events by start date
    calendarEvents.sort((a, b)=>new Date(a.startAt).getTime() - new Date(b.startAt).getTime());
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "space-y-8 px-6 py-8",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "space-y-2",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("h1", {
                        className: "text-3xl font-bold",
                        children: "Calendar"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                        lineNumber: 413,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-muted-foreground",
                        children: "View all important deadlines, events, and tasks across the platform"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                        lineNumber: 414,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                lineNumber: 412,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$components$2f$calendar$2f$calendar$2d$split$2d$view$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["CalendarSplitView"], {
                calendarEvents: calendarEvents,
                emptyCalendarMessage: "No upcoming events or deadlines scheduled.",
                brand: "versotech"
            }, void 0, false, {
                fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
                lineNumber: 418,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx",
        lineNumber: 411,
        columnNumber: 5
    }, this);
}
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx [app-rsc] (ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/(main)/versotech_main/calendar/page.tsx [app-rsc] (ecmascript)"));
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__160feae1._.js.map