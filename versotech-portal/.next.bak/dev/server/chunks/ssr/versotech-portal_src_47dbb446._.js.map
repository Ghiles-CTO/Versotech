{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/navigation/FolderBreadcrumbs.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React, { Fragment } from 'react'\r\nimport { Home, ChevronRight, Folder } from 'lucide-react'\r\nimport { Breadcrumb, DocumentFolder } from '@/types/documents'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface FolderBreadcrumbsProps {\r\n  currentFolder: DocumentFolder | null\r\n  onNavigate: (folderId: string | null) => void\r\n  className?: string\r\n}\r\n\r\n/**\r\n * FolderBreadcrumbs - Institutional Navigation Component\r\n *\r\n * Professional breadcrumb navigation for folder hierarchy.\r\n * Features:\r\n * - Precise typography hierarchy\r\n * - Subtle hover states\r\n * - Responsive collapsing on mobile\r\n * - Keyboard accessible\r\n *\r\n * Design: Financial Terminal Elegance\r\n */\r\nexport function FolderBreadcrumbs({\r\n  currentFolder,\r\n  onNavigate,\r\n  className,\r\n}: FolderBreadcrumbsProps) {\r\n  // Parse folder path into breadcrumb segments\r\n  const breadcrumbs = React.useMemo((): Breadcrumb[] => {\r\n    if (!currentFolder) return []\r\n\r\n    const segments = currentFolder.path.split('/').filter(Boolean)\r\n    const crumbs: Breadcrumb[] = []\r\n\r\n    // Build breadcrumbs from path segments\r\n    let accumulatedPath = ''\r\n    segments.forEach((segment, index) => {\r\n      accumulatedPath += `/${segment}`\r\n      crumbs.push({\r\n        id: index === segments.length - 1 ? currentFolder.id : null, // Only last segment has ID\r\n        name: segment,\r\n        path: accumulatedPath,\r\n      })\r\n    })\r\n\r\n    return crumbs\r\n  }, [currentFolder])\r\n\r\n  // Responsive: Show only last 3 breadcrumbs on mobile\r\n  const displayBreadcrumbs = breadcrumbs.length > 3\r\n    ? [\r\n        ...breadcrumbs.slice(0, 1),\r\n        { id: '...', name: '...', path: '...' },\r\n        ...breadcrumbs.slice(-2),\r\n      ]\r\n    : breadcrumbs\r\n\r\n  return (\r\n    <nav\r\n      className={cn(\r\n        'flex items-center gap-2 px-6 py-3.5',\r\n        'bg-black/40 border-b border-white/10',\r\n        'transition-colors duration-200',\r\n        className\r\n      )}\r\n      aria-label=\"Folder navigation breadcrumbs\"\r\n    >\r\n      {/* Home Button */}\r\n      <button\r\n        onClick={() => onNavigate(null)}\r\n        className={cn(\r\n          'inline-flex items-center justify-center',\r\n          'w-8 h-8 rounded-md',\r\n          'transition-all duration-150',\r\n          !currentFolder\r\n            ? 'bg-blue-500/20 text-blue-400 border border-blue-400/30'\r\n            : 'text-gray-400 hover:bg-white/10 hover:text-white',\r\n          'focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2'\r\n        )}\r\n        aria-label=\"Navigate to root\"\r\n        aria-current={!currentFolder ? 'page' : undefined}\r\n      >\r\n        <Home className=\"w-4 h-4\" strokeWidth={2} />\r\n      </button>\r\n\r\n      {/* Breadcrumb Trail */}\r\n      {displayBreadcrumbs.map((crumb, index) => {\r\n        const isLast = index === displayBreadcrumbs.length - 1\r\n        const isEllipsis = crumb.id === '...'\r\n\r\n        return (\r\n          <Fragment key={crumb.id || index}>\r\n            {/* Separator */}\r\n            <ChevronRight\r\n              className=\"w-4 h-4 text-gray-600 flex-shrink-0\"\r\n              strokeWidth={2}\r\n              aria-hidden=\"true\"\r\n            />\r\n\r\n            {/* Breadcrumb Segment */}\r\n            {isEllipsis ? (\r\n              // Ellipsis indicator\r\n              <span className=\"text-sm text-gray-500 px-2 select-none\">\r\n                {crumb.name}\r\n              </span>\r\n            ) : isLast ? (\r\n              // Current location - not clickable, emphasized\r\n              <div className=\"flex items-center gap-2 px-3 py-1.5 bg-white/5 border border-white/10 rounded-md\">\r\n                <Folder className=\"w-3.5 h-3.5 text-blue-400 flex-shrink-0\" strokeWidth={2} />\r\n                <span className=\"text-sm font-medium text-white truncate max-w-[200px]\">\r\n                  {crumb.name}\r\n                </span>\r\n              </div>\r\n            ) : (\r\n              // Previous locations - clickable\r\n              <button\r\n                onClick={() => {\r\n                  // Find the folder ID for this breadcrumb\r\n                  // For now, we navigate to root then manually to this level\r\n                  // In production, you'd store folder IDs in breadcrumbs\r\n                  onNavigate(crumb.id)\r\n                }}\r\n                className={cn(\r\n                  'text-sm text-gray-400 px-3 py-1.5 rounded-md',\r\n                  'hover:text-white hover:bg-white/10',\r\n                  'focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2',\r\n                  'transition-all duration-150',\r\n                  'truncate max-w-[160px]'\r\n                )}\r\n                title={crumb.name}\r\n              >\r\n                {crumb.name}\r\n              </button>\r\n            )}\r\n          </Fragment>\r\n        )\r\n      })}\r\n\r\n      {/* Path Display (for reference, hidden on mobile) */}\r\n      {currentFolder && (\r\n        <div className=\"ml-auto hidden lg:flex items-center gap-2 text-xs text-gray-400 font-mono\">\r\n          <span className=\"opacity-60\">Path:</span>\r\n          <span className=\"px-2 py-1 bg-white/5 rounded border border-white/10 text-gray-300\">\r\n            {currentFolder.path}\r\n          </span>\r\n        </div>\r\n      )}\r\n    </nav>\r\n  )\r\n}\r\n\r\n/**\r\n * Compact Breadcrumb variant (for mobile or compact layouts)\r\n */\r\nexport function FolderBreadcrumbsCompact({\r\n  currentFolder,\r\n  onNavigate,\r\n  className,\r\n}: FolderBreadcrumbsProps) {\r\n  return (\r\n    <nav\r\n      className={cn(\r\n        'flex items-center gap-2 px-4 py-2.5',\r\n        'bg-black/40 border-b border-white/10',\r\n        className\r\n      )}\r\n      aria-label=\"Folder navigation\"\r\n    >\r\n      {/* Back Button */}\r\n      <button\r\n        onClick={() => onNavigate(null)}\r\n        className=\"text-gray-400 hover:text-white transition-colors\"\r\n        aria-label=\"Back to root\"\r\n      >\r\n        <Home className=\"w-4 h-4\" />\r\n      </button>\r\n\r\n      <ChevronRight className=\"w-3.5 h-3.5 text-gray-600\" />\r\n\r\n      {/* Current Folder Name */}\r\n      <span className=\"text-sm font-medium text-white truncate\">\r\n        {currentFolder?.name || 'All Documents'}\r\n      </span>\r\n    </nav>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AAAA;AAEA;AALA;;;;;AAyBO,SAAS,kBAAkB,EAChC,aAAa,EACb,UAAU,EACV,SAAS,EACc;IACvB,6CAA6C;IAC7C,MAAM,cAAc,uOAAK,CAAC,OAAO,CAAC;QAChC,IAAI,CAAC,eAAe,OAAO,EAAE;QAE7B,MAAM,WAAW,cAAc,IAAI,CAAC,KAAK,CAAC,KAAK,MAAM,CAAC;QACtD,MAAM,SAAuB,EAAE;QAE/B,uCAAuC;QACvC,IAAI,kBAAkB;QACtB,SAAS,OAAO,CAAC,CAAC,SAAS;YACzB,mBAAmB,CAAC,CAAC,EAAE,SAAS;YAChC,OAAO,IAAI,CAAC;gBACV,IAAI,UAAU,SAAS,MAAM,GAAG,IAAI,cAAc,EAAE,GAAG;gBACvD,MAAM;gBACN,MAAM;YACR;QACF;QAEA,OAAO;IACT,GAAG;QAAC;KAAc;IAElB,qDAAqD;IACrD,MAAM,qBAAqB,YAAY,MAAM,GAAG,IAC5C;WACK,YAAY,KAAK,CAAC,GAAG;QACxB;YAAE,IAAI;YAAO,MAAM;YAAO,MAAM;QAAM;WACnC,YAAY,KAAK,CAAC,CAAC;KACvB,GACD;IAEJ,qBACE,qQAAC;QACC,WAAW,IAAA,gJAAE,EACX,uCACA,wCACA,kCACA;QAEF,cAAW;;0BAGX,qQAAC;gBACC,SAAS,IAAM,WAAW;gBAC1B,WAAW,IAAA,gJAAE,EACX,2CACA,sBACA,+BACA,CAAC,gBACG,2DACA,oDACJ;gBAEF,cAAW;gBACX,gBAAc,CAAC,gBAAgB,SAAS;0BAExC,cAAA,qQAAC,kOAAI;oBAAC,WAAU;oBAAU,aAAa;;;;;;;;;;;YAIxC,mBAAmB,GAAG,CAAC,CAAC,OAAO;gBAC9B,MAAM,SAAS,UAAU,mBAAmB,MAAM,GAAG;gBACrD,MAAM,aAAa,MAAM,EAAE,KAAK;gBAEhC,qBACE,qQAAC,wOAAQ;;sCAEP,qQAAC,6PAAY;4BACX,WAAU;4BACV,aAAa;4BACb,eAAY;;;;;;wBAIb,aACC,qBAAqB;sCACrB,qQAAC;4BAAK,WAAU;sCACb,MAAM,IAAI;;;;;mCAEX,SACF,+CAA+C;sCAC/C,qQAAC;4BAAI,WAAU;;8CACb,qQAAC,uOAAM;oCAAC,WAAU;oCAA0C,aAAa;;;;;;8CACzE,qQAAC;oCAAK,WAAU;8CACb,MAAM,IAAI;;;;;;;;;;;mCAIf,iCAAiC;sCACjC,qQAAC;4BACC,SAAS;gCACP,yCAAyC;gCACzC,2DAA2D;gCAC3D,uDAAuD;gCACvD,WAAW,MAAM,EAAE;4BACrB;4BACA,WAAW,IAAA,gJAAE,EACX,gDACA,sCACA,2EACA,+BACA;4BAEF,OAAO,MAAM,IAAI;sCAEhB,MAAM,IAAI;;;;;;;mBAxCF,MAAM,EAAE,IAAI;;;;;YA6C/B;YAGC,+BACC,qQAAC;gBAAI,WAAU;;kCACb,qQAAC;wBAAK,WAAU;kCAAa;;;;;;kCAC7B,qQAAC;wBAAK,WAAU;kCACb,cAAc,IAAI;;;;;;;;;;;;;;;;;;AAM/B;AAKO,SAAS,yBAAyB,EACvC,aAAa,EACb,UAAU,EACV,SAAS,EACc;IACvB,qBACE,qQAAC;QACC,WAAW,IAAA,gJAAE,EACX,uCACA,wCACA;QAEF,cAAW;;0BAGX,qQAAC;gBACC,SAAS,IAAM,WAAW;gBAC1B,WAAU;gBACV,cAAW;0BAEX,cAAA,qQAAC,kOAAI;oBAAC,WAAU;;;;;;;;;;;0BAGlB,qQAAC,6PAAY;gBAAC,WAAU;;;;;;0BAGxB,qQAAC;gBAAK,WAAU;0BACb,eAAe,QAAQ;;;;;;;;;;;;AAIhC"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/lib/design-tokens.ts"],"sourcesContent":["/**\r\n * Design Tokens - Institutional Finance UI\r\n *\r\n * Professional color palette and design system for\r\n * private equity/investment banking document management.\r\n *\r\n * Philosophy: Refined precision, authoritative presence,\r\n * sophisticated monochrome with strategic accents.\r\n */\r\n\r\nexport const DESIGN_TOKENS = {\r\n  // Color Palette - Institutional Slate & Navy\r\n  colors: {\r\n    // Neutrals - Foundation (Slate)\r\n    slate: {\r\n      950: '#020617', // Deep background (dark mode)\r\n      900: '#0f172a', // Surface dark\r\n      800: '#1e293b', // Elevated surface\r\n      700: '#334155', // Strong borders\r\n      600: '#475569', // Muted borders\r\n      500: '#64748b', // Muted text\r\n      400: '#94a3b8', // Subtle text\r\n      300: '#cbd5e1', // Disabled\r\n      200: '#e2e8f0', // Light borders\r\n      100: '#f1f5f9', // Light surface\r\n      50: '#f8fafc',  // Background (light mode)\r\n    },\r\n\r\n    // Primary - Authority & Trust (Navy Blue)\r\n    navy: {\r\n      950: '#172554', // Deep institutional blue\r\n      900: '#1e3a8a', // Primary dark\r\n      800: '#1e40af', // Primary\r\n      700: '#1d4ed8', // Primary hover\r\n      600: '#2563eb', // Active state\r\n      500: '#3b82f6', // Bright accent\r\n      100: '#dbeafe', // Subtle highlight\r\n      50: '#eff6ff',  // Pale highlight\r\n    },\r\n\r\n    // Semantic Colors (Muted, Professional)\r\n    semantic: {\r\n      success: '#047857',    // Emerald 700 - Approval, complete\r\n      warning: '#b45309',    // Amber 700 - Pending, caution\r\n      error: '#b91c1c',      // Red 700 - Critical, delete\r\n      info: '#0369a1',       // Sky 700 - Information\r\n    },\r\n  },\r\n\r\n  // Spacing Scale (4px base)\r\n  spacing: {\r\n    xs: '0.25rem',   // 4px - Tight spacing\r\n    sm: '0.5rem',    // 8px - Compact elements\r\n    md: '0.75rem',   // 12px - Standard gap\r\n    lg: '1rem',      // 16px - Section spacing\r\n    xl: '1.5rem',    // 24px - Large gaps\r\n    '2xl': '2rem',   // 32px - Major sections\r\n    '3xl': '3rem',   // 48px - Page sections\r\n  },\r\n\r\n  // Border Radius (Subtle, Professional)\r\n  radius: {\r\n    sm: '0.375rem',  // 6px - Buttons, inputs\r\n    md: '0.5rem',    // 8px - Cards\r\n    lg: '0.75rem',   // 12px - Modals\r\n    xl: '1rem',      // 16px - Large surfaces\r\n    full: '9999px',  // Pills, badges\r\n  },\r\n\r\n  // Shadows (Soft, Refined)\r\n  shadow: {\r\n    sm: '0 1px 2px 0 rgb(0 0 0 / 0.03), 0 1px 3px 0 rgb(0 0 0 / 0.02)',\r\n    md: '0 2px 4px -1px rgb(0 0 0 / 0.04), 0 4px 6px -1px rgb(0 0 0 / 0.06)',\r\n    lg: '0 4px 6px -2px rgb(0 0 0 / 0.05), 0 10px 15px -3px rgb(0 0 0 / 0.08)',\r\n    xl: '0 10px 25px -5px rgb(0 0 0 / 0.08), 0 20px 25px -5px rgb(0 0 0 / 0.06)',\r\n  },\r\n\r\n  // Typography Scale\r\n  fontSize: {\r\n    xs: '0.75rem',    // 12px - Captions, metadata\r\n    sm: '0.875rem',   // 14px - Body small, labels\r\n    base: '0.9375rem', // 15px - Body text\r\n    lg: '1rem',       // 16px - Emphasized body\r\n    xl: '1.125rem',   // 18px - Subheadings\r\n    '2xl': '1.5rem',  // 24px - Headings\r\n    '3xl': '2rem',    // 32px - Page titles\r\n  },\r\n\r\n  // Font Weights\r\n  fontWeight: {\r\n    normal: 400,\r\n    medium: 500,\r\n    semibold: 600,\r\n    bold: 700,\r\n  },\r\n\r\n  // Transitions (Precise, Responsive)\r\n  transition: {\r\n    fast: '120ms cubic-bezier(0.4, 0, 0.2, 1)',      // Quick feedback\r\n    base: '180ms cubic-bezier(0.4, 0, 0.2, 1)',      // Standard\r\n    smooth: '250ms cubic-bezier(0.4, 0, 0.2, 1)',    // Smooth animations\r\n    slow: '350ms cubic-bezier(0.4, 0, 0.2, 1)',      // Deliberate\r\n  },\r\n\r\n  // Z-index Layers\r\n  zIndex: {\r\n    base: 0,\r\n    dropdown: 1000,\r\n    sticky: 1100,\r\n    drawer: 1200,\r\n    modal: 1300,\r\n    popover: 1400,\r\n    tooltip: 1500,\r\n  },\r\n} as const\r\n\r\n/**\r\n * Folder Icon Colors (Subtle, Professional Variants)\r\n */\r\nexport const FOLDER_ICON_COLORS = {\r\n  vehicle_root: {\r\n    bg: 'bg-navy-50',\r\n    border: 'border-navy-200',\r\n    icon: 'text-navy-700',\r\n    hoverBg: 'group-hover:bg-navy-100',\r\n    hoverBorder: 'group-hover:border-navy-300',\r\n  },\r\n  category: {\r\n    bg: 'bg-slate-50',\r\n    border: 'border-slate-200',\r\n    icon: 'text-slate-600',\r\n    hoverBg: 'group-hover:bg-slate-100',\r\n    hoverBorder: 'group-hover:border-slate-300',\r\n  },\r\n  custom: {\r\n    bg: 'bg-slate-50',\r\n    border: 'border-slate-200',\r\n    icon: 'text-slate-500',\r\n    hoverBg: 'group-hover:bg-slate-100',\r\n    hoverBorder: 'group-hover:border-slate-300',\r\n  },\r\n} as const\r\n\r\n/**\r\n * Document Type Colors (Professional Semantic Coding)\r\n */\r\nexport const DOCUMENT_TYPE_COLORS = {\r\n  Agreement: {\r\n    badge: 'bg-navy-100 text-navy-800 border-navy-200',\r\n    icon: 'text-navy-600',\r\n  },\r\n  Subscription: {\r\n    badge: 'bg-emerald-50 text-emerald-800 border-emerald-200',\r\n    icon: 'text-emerald-600',\r\n  },\r\n  KYC: {\r\n    badge: 'bg-amber-50 text-amber-800 border-amber-200',\r\n    icon: 'text-amber-600',\r\n  },\r\n  Statement: {\r\n    badge: 'bg-slate-100 text-slate-800 border-slate-200',\r\n    icon: 'text-slate-600',\r\n  },\r\n  NDA: {\r\n    badge: 'bg-purple-50 text-purple-800 border-purple-200',\r\n    icon: 'text-purple-600',\r\n  },\r\n  Report: {\r\n    badge: 'bg-blue-50 text-blue-800 border-blue-200',\r\n    icon: 'text-blue-600',\r\n  },\r\n  Tax: {\r\n    badge: 'bg-orange-50 text-orange-800 border-orange-200',\r\n    icon: 'text-orange-600',\r\n  },\r\n  Legal: {\r\n    badge: 'bg-red-50 text-red-800 border-red-200',\r\n    icon: 'text-red-600',\r\n  },\r\n  Other: {\r\n    badge: 'bg-slate-100 text-slate-700 border-slate-200',\r\n    icon: 'text-slate-500',\r\n  },\r\n} as const\r\n\r\n/**\r\n * Grid Layout Constants\r\n */\r\nexport const GRID_CONSTANTS = {\r\n  // Responsive column counts\r\n  columns: {\r\n    mobile: 1,\r\n    tablet: 2,\r\n    desktop: 3,\r\n    wide: 4,\r\n  },\r\n\r\n  // Item sizing\r\n  minCardWidth: '240px',\r\n  maxCardWidth: '320px',\r\n  cardHeight: 'auto',\r\n\r\n  // Spacing\r\n  gap: DESIGN_TOKENS.spacing.lg,\r\n  padding: DESIGN_TOKENS.spacing.xl,\r\n} as const\r\n\r\n/**\r\n * Animation Presets (Subtle, Professional)\r\n */\r\nexport const ANIMATIONS = {\r\n  // Fade in with slight upward movement\r\n  fadeInUp: {\r\n    initial: { opacity: 0, y: 8 },\r\n    animate: { opacity: 1, y: 0 },\r\n    transition: { duration: 0.2, ease: [0.4, 0, 0.2, 1] },\r\n  },\r\n\r\n  // Scale in (for modals, drawers)\r\n  scaleIn: {\r\n    initial: { opacity: 0, scale: 0.96 },\r\n    animate: { opacity: 1, scale: 1 },\r\n    exit: { opacity: 0, scale: 0.96 },\r\n    transition: { duration: 0.18, ease: [0.4, 0, 0.2, 1] },\r\n  },\r\n\r\n  // Slide in from right (for drawers)\r\n  slideInRight: {\r\n    initial: { x: '100%' },\r\n    animate: { x: 0 },\r\n    exit: { x: '100%' },\r\n    transition: { duration: 0.25, ease: [0.4, 0, 0.2, 1] },\r\n  },\r\n} as const\r\n\r\n/**\r\n * Utility function to generate consistent hover states\r\n */\r\nexport const hoverStates = {\r\n  card: 'hover:shadow-md hover:border-slate-300 transition-all duration-180',\r\n  button: 'hover:bg-opacity-90 active:scale-[0.98] transition-all duration-120',\r\n  link: 'hover:text-navy-700 transition-colors duration-150',\r\n} as const\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 493, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/navigation/FolderCard.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React from 'react'\r\nimport {\r\n  Folder,\r\n  FolderOpen,\r\n  MoreVertical,\r\n  Edit,\r\n  Trash2,\r\n  FolderPlus,\r\n  ChevronRight,\r\n} from 'lucide-react'\r\nimport { DocumentFolder } from '@/types/documents'\r\nimport { FOLDER_ICON_COLORS } from '@/lib/design-tokens'\r\nimport { cn } from '@/lib/utils'\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu'\r\n\r\ninterface FolderCardProps {\r\n  folder: DocumentFolder\r\n  onNavigate: (folderId: string) => void\r\n  onRename?: (folderId: string) => void\r\n  onDelete?: (folderId: string) => void\r\n  onCreateSubfolder?: (parentId: string) => void\r\n  className?: string\r\n  variant?: 'default' | 'compact'\r\n}\r\n\r\n/**\r\n * FolderCard - Professional Folder Display Component\r\n *\r\n * Institutional-grade folder card with:\r\n * - Refined hover states\r\n * - Precise iconography\r\n * - Context menu actions\r\n * - Keyboard navigation support\r\n *\r\n * Design: Financial Terminal Elegance\r\n */\r\nexport function FolderCard({\r\n  folder,\r\n  onNavigate,\r\n  onRename,\r\n  onDelete,\r\n  onCreateSubfolder,\r\n  className,\r\n  variant = 'default',\r\n}: FolderCardProps) {\r\n  const [isHovered, setIsHovered] = React.useState(false)\r\n  const [isMenuOpen, setIsMenuOpen] = React.useState(false)\r\n\r\n  // Get folder type styling\r\n  const colorScheme = FOLDER_ICON_COLORS[folder.folder_type] || FOLDER_ICON_COLORS.custom\r\n\r\n  // Handle keyboard navigation\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' || e.key === ' ') {\r\n      e.preventDefault()\r\n      onNavigate(folder.id)\r\n    }\r\n  }\r\n\r\n  if (variant === 'compact') {\r\n    return (\r\n      <button\r\n        onClick={() => onNavigate(folder.id)}\r\n        onKeyDown={handleKeyDown}\r\n        className={cn(\r\n          'group flex items-center gap-3 w-full',\r\n          'px-4 py-3 rounded-md',\r\n          'hover:bg-white/10 transition-colors duration-150',\r\n          'focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1',\r\n          className\r\n        )}\r\n      >\r\n        <Folder className=\"w-5 h-5 text-blue-400 flex-shrink-0\" strokeWidth={2} />\r\n        <span className=\"text-sm font-medium text-white flex-1 text-left break-words line-clamp-1\">\r\n          {folder.name}\r\n        </span>\r\n        <ChevronRight className=\"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0\" />\r\n      </button>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'group relative',\r\n        'bg-white/5 border border-white/10 rounded-lg',\r\n        'hover:bg-white/10 hover:border-white/20',\r\n        'transition-all duration-200',\r\n        'cursor-pointer',\r\n        className\r\n      )}\r\n      onMouseEnter={() => setIsHovered(true)}\r\n      onMouseLeave={() => setIsHovered(false)}\r\n      onClick={() => onNavigate(folder.id)}\r\n      onKeyDown={handleKeyDown}\r\n      role=\"button\"\r\n      tabIndex={0}\r\n      aria-label={`Navigate to folder ${folder.name}`}\r\n    >\r\n      {/* Main Content */}\r\n      <div className=\"p-5\">\r\n        <div className=\"flex items-start gap-4\">\r\n          {/* Folder Icon */}\r\n          <div\r\n            className={cn(\r\n              'w-14 h-14 rounded-lg border flex items-center justify-center',\r\n              'flex-shrink-0 transition-all duration-200',\r\n              colorScheme.bg,\r\n              colorScheme.border,\r\n              colorScheme.hoverBg,\r\n              colorScheme.hoverBorder\r\n            )}\r\n          >\r\n            {isHovered ? (\r\n              <FolderOpen className={cn('w-6 h-6', colorScheme.icon)} strokeWidth={2} />\r\n            ) : (\r\n              <Folder className={cn('w-6 h-6', colorScheme.icon)} strokeWidth={2} />\r\n            )}\r\n          </div>\r\n\r\n          {/* Folder Info */}\r\n          <div className=\"flex-1 min-w-0 overflow-hidden\">\r\n            {/* Folder Name - Allow wrapping for long names */}\r\n            <h3 className=\"font-semibold text-white text-sm leading-tight mb-2 break-words line-clamp-2\">\r\n              {folder.name}\r\n            </h3>\r\n\r\n            {/* Metadata */}\r\n            <div className=\"flex items-center gap-3 text-sm text-gray-400\">\r\n              {folder.subfolder_count !== undefined && (\r\n                <span className=\"inline-flex items-center gap-1.5\">\r\n                  <Folder className=\"w-3.5 h-3.5\" strokeWidth={2} />\r\n                  <span>{folder.subfolder_count}</span>\r\n                </span>\r\n              )}\r\n              {folder.document_count !== undefined && (\r\n                <span className=\"inline-flex items-center gap-1.5\">\r\n                  <span className=\"w-3.5 h-3.5 inline-flex items-center justify-center\">\r\n                    <svg\r\n                      viewBox=\"0 0 16 16\"\r\n                      fill=\"none\"\r\n                      className=\"w-3.5 h-3.5 text-gray-400\"\r\n                      strokeWidth={2}\r\n                    >\r\n                      <path\r\n                        d=\"M9 1H3a1 1 0 00-1 1v12a1 1 0 001 1h10a1 1 0 001-1V6M9 1l5 5M9 1v5h5\"\r\n                        stroke=\"currentColor\"\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                      />\r\n                    </svg>\r\n                  </span>\r\n                  <span>{folder.document_count}</span>\r\n                </span>\r\n              )}\r\n            </div>\r\n\r\n            {/* Folder Type Badge (subtle) */}\r\n            {folder.folder_type === 'vehicle_root' && (\r\n              <div className=\"mt-2\">\r\n                <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-500/20 text-blue-200 border border-blue-400/30\">\r\n                  Vehicle Root\r\n                </span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Context Menu */}\r\n          {(onRename || onDelete || onCreateSubfolder) && (\r\n            <DropdownMenu open={isMenuOpen} onOpenChange={setIsMenuOpen}>\r\n              <DropdownMenuTrigger\r\n                className={cn(\r\n                  'opacity-0 group-hover:opacity-100 transition-opacity duration-150',\r\n                  'p-1 rounded hover:bg-white/10',\r\n                  'focus:outline-none focus:ring-2 focus:ring-blue-500',\r\n                  isMenuOpen && 'opacity-100'\r\n                )}\r\n                onClick={(e) => {\r\n                  e.stopPropagation() // Prevent folder navigation\r\n                }}\r\n              >\r\n                <MoreVertical className=\"w-4 h-4 text-gray-400\" strokeWidth={2} />\r\n                <span className=\"sr-only\">Folder actions</span>\r\n              </DropdownMenuTrigger>\r\n              <DropdownMenuContent align=\"end\" className=\"w-48 bg-zinc-900 border-white/10\">\r\n                {onCreateSubfolder && (\r\n                  <DropdownMenuItem\r\n                    onClick={(e) => {\r\n                      e.stopPropagation()\r\n                      onCreateSubfolder(folder.id)\r\n                    }}\r\n                    className=\"text-gray-200 focus:bg-white/10 focus:text-white\"\r\n                  >\r\n                    <FolderPlus className=\"w-4 h-4 mr-2 text-blue-400\" strokeWidth={2} />\r\n                    <span>New Subfolder</span>\r\n                  </DropdownMenuItem>\r\n                )}\r\n                {onRename && (\r\n                  <DropdownMenuItem\r\n                    onClick={(e) => {\r\n                      e.stopPropagation()\r\n                      onRename(folder.id)\r\n                    }}\r\n                    className=\"text-gray-200 focus:bg-white/10 focus:text-white\"\r\n                  >\r\n                    <Edit className=\"w-4 h-4 mr-2 text-gray-400\" strokeWidth={2} />\r\n                    <span>Rename</span>\r\n                  </DropdownMenuItem>\r\n                )}\r\n                {onDelete && (\r\n                  <>\r\n                    <DropdownMenuSeparator className=\"bg-white/10\" />\r\n                    <DropdownMenuItem\r\n                      onClick={(e) => {\r\n                        e.stopPropagation()\r\n                        onDelete(folder.id)\r\n                      }}\r\n                      className=\"text-red-400 focus:text-red-300 focus:bg-red-500/20\"\r\n                    >\r\n                      <Trash2 className=\"w-4 h-4 mr-2\" strokeWidth={2} />\r\n                      <span>Delete</span>\r\n                    </DropdownMenuItem>\r\n                  </>\r\n                )}\r\n              </DropdownMenuContent>\r\n            </DropdownMenu>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Hover Indicator (subtle bottom border) */}\r\n      <div\r\n        className={cn(\r\n          'absolute bottom-0 left-0 right-0 h-0.5 bg-blue-500',\r\n          'transform scale-x-0 group-hover:scale-x-100',\r\n          'transition-transform duration-200 origin-left',\r\n          'rounded-b-lg'\r\n        )}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\n/**\r\n * Folder Card Skeleton (for loading states)\r\n */\r\nexport function FolderCardSkeleton({ className }: { className?: string }) {\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'bg-white/5 border border-white/10 rounded-lg p-4',\r\n        'animate-pulse',\r\n        className\r\n      )}\r\n    >\r\n      <div className=\"flex items-start gap-3\">\r\n        {/* Icon skeleton */}\r\n        <div className=\"w-11 h-11 rounded-lg bg-white/10 flex-shrink-0\" />\r\n\r\n        {/* Content skeleton */}\r\n        <div className=\"flex-1 min-w-0\">\r\n          <div className=\"h-4 bg-white/10 rounded w-3/4 mb-2\" />\r\n          <div className=\"h-3 bg-white/10 rounded w-1/2\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 931, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/document-card.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Document, DocumentType } from '@/types/documents'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport {\r\n  Download,\r\n  Shield,\r\n  Clock,\r\n  Building2,\r\n  Folder,\r\n  Eye,\r\n  FileText,\r\n  FileSpreadsheet,\r\n  FileCheck,\r\n  Scale,\r\n  Receipt,\r\n  Lock,\r\n  FileSignature,\r\n  Clipboard,\r\n  UserCheck,\r\n  MoreVertical,\r\n  Edit,\r\n  Trash2,\r\n} from 'lucide-react'\r\nimport { useState } from 'react'\r\nimport { toast } from 'sonner'\r\nimport { cn } from '@/lib/utils'\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu'\r\n\r\ninterface DocumentCardProps {\r\n  document: Document\r\n  onPreview?: (document: Document) => void\r\n  onRename?: (documentId: string) => void\r\n  onDelete?: (documentId: string) => void\r\n  variant?: 'default' | 'compact'\r\n  className?: string\r\n}\r\n\r\n/**\r\n * Get professional icon for document type (no emojis)\r\n */\r\nfunction getDocumentIcon(type: string) {\r\n  const iconMap: Record<string, typeof FileText> = {\r\n    statement: FileSpreadsheet,\r\n    report: FileCheck,\r\n    legal: Scale,\r\n    tax: Receipt,\r\n    nda: Lock,\r\n    subscription: FileSignature,\r\n    agreement: FileSignature,\r\n    term_sheet: Clipboard,\r\n    kyc: UserCheck,\r\n    other: FileText,\r\n  }\r\n  const IconComponent = iconMap[type.toLowerCase()] || FileText\r\n  return IconComponent\r\n}\r\n\r\nfunction formatFileSize(bytes?: number): string {\r\n  if (!bytes) return 'Unknown size'\r\n  if (bytes < 1024) return bytes + ' B'\r\n  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB'\r\n  return (bytes / (1024 * 1024)).toFixed(1) + ' MB'\r\n}\r\n\r\nfunction formatDocumentType(type: DocumentType | string) {\r\n  const normalized = (type || 'Document').toString().replace(/_/g, ' ')\r\n  return normalized\r\n    .split(' ')\r\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\r\n    .join(' ')\r\n}\r\n\r\n\r\n/**\r\n * DocumentCard - Professional Document Display Component\r\n *\r\n * Refined institutional design matching FolderCard aesthetic.\r\n * Features:\r\n * - Clean iconography (no emojis)\r\n * - Muted professional colors\r\n * - Subtle hover states\r\n * - Context menu actions\r\n *\r\n * Design: Financial Terminal Elegance\r\n */\r\nexport function DocumentCard({\r\n  document,\r\n  onPreview,\r\n  onRename,\r\n  onDelete,\r\n  variant = 'default',\r\n  className,\r\n}: DocumentCardProps) {\r\n  const [isDownloading, setIsDownloading] = useState(false)\r\n  const [isMenuOpen, setIsMenuOpen] = useState(false)\r\n\r\n  const handleDownload = async () => {\r\n    setIsDownloading(true)\r\n\r\n    try {\r\n      const response = await fetch(`/api/documents/${document.id}/download`)\r\n\r\n      if (!response.ok) {\r\n        if (response.status === 404) {\r\n          toast.error('Document not found or access denied')\r\n        } else if (response.status === 401) {\r\n          toast.error('Please sign in to download documents')\r\n        } else {\r\n          toast.error('Failed to generate download link')\r\n        }\r\n        return\r\n      }\r\n\r\n      const { download_url, watermark, expires_in_seconds } = await response.json()\r\n\r\n      if (watermark) {\r\n        toast.info(`Document will be watermarked with: ${watermark.downloaded_by}`, {\r\n          duration: 5000,\r\n        })\r\n      }\r\n\r\n      window.open(download_url, '_blank')\r\n\r\n      toast.success(\r\n        `Download link generated. Expires in ${Math.floor(expires_in_seconds / 60)} minutes`,\r\n        { duration: 5000 }\r\n      )\r\n    } catch (error) {\r\n      toast.error('Failed to download document. Please try again.')\r\n    } finally {\r\n      setIsDownloading(false)\r\n    }\r\n  }\r\n\r\n  // Handle both file_name and name (for different document types)\r\n  const displayName = document.file_name || (document as any).name || 'Untitled Document'\r\n\r\n  const formattedSize = formatFileSize(document.file_size_bytes)\r\n  const formattedType = formatDocumentType(document.type)\r\n  const vehicle = document.scope?.vehicle\r\n  const formattedDate = new Date(document.created_at).toLocaleDateString('en-US', {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric',\r\n  })\r\n  const DocIcon = getDocumentIcon(document.type)\r\n\r\n  // Compact variant for list view\r\n  if (variant === 'compact') {\r\n    return (\r\n      <button\r\n        onClick={() => onPreview?.(document)}\r\n        className={cn(\r\n          'group flex items-center gap-3 w-full px-4 py-3 rounded-md',\r\n          'hover:bg-muted transition-colors duration-150',\r\n          'focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-1',\r\n          className\r\n        )}\r\n      >\r\n        <DocIcon className=\"w-5 h-5 text-primary flex-shrink-0\" strokeWidth={2} />\r\n        <span className=\"text-sm font-medium text-foreground flex-1 text-left break-words line-clamp-1\">\r\n          {displayName}\r\n        </span>\r\n        <span className=\"text-sm text-muted-foreground flex-shrink-0\">{formattedSize}</span>\r\n      </button>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'group relative bg-card border border-border rounded-lg shadow-sm',\r\n        'hover:bg-muted/50 hover:border-border hover:shadow-md',\r\n        'transition-all duration-200',\r\n        'cursor-pointer',\r\n        className\r\n      )}\r\n      onClick={() => onPreview?.(document)}\r\n    >\r\n      <div className=\"p-5\">\r\n        <div className=\"flex items-start gap-4\">\r\n          {/* Document Icon */}\r\n          <div\r\n            className={cn(\r\n              'w-14 h-14 rounded-lg border border-border flex items-center justify-center',\r\n              'flex-shrink-0 transition-all duration-200',\r\n              'bg-muted/50'\r\n            )}\r\n          >\r\n            <DocIcon className=\"w-6 h-6 text-primary\" strokeWidth={2} />\r\n          </div>\r\n\r\n          {/* Document Info */}\r\n          <div className=\"flex-1 min-w-0 overflow-hidden\">\r\n            {/* File Name - Allow wrapping for long names */}\r\n            <h3 className=\"font-semibold text-foreground text-sm leading-tight mb-2 break-words line-clamp-2\">\r\n              {displayName}\r\n            </h3>\r\n\r\n            {/* Type & Size */}\r\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-2\">\r\n              <span>{formattedType}</span>\r\n              <span>•</span>\r\n              <span>{formattedSize}</span>\r\n              <span>•</span>\r\n              <span className=\"flex items-center gap-1\">\r\n                <Clock className=\"w-3.5 h-3.5\" strokeWidth={2} />\r\n                {formattedDate}\r\n              </span>\r\n            </div>\r\n\r\n            {/* Badges */}\r\n            <div className=\"flex flex-wrap items-center gap-1.5\">\r\n              {vehicle && (\r\n                <Badge\r\n                  variant=\"outline\"\r\n                  className=\"text-xs border-blue-200 bg-blue-50 text-blue-700\"\r\n                >\r\n                  <Building2 className=\"w-3.5 h-3.5 mr-1\" strokeWidth={2} />\r\n                  {vehicle.name}\r\n                </Badge>\r\n              )}\r\n              {document.folder && (\r\n                <Badge\r\n                  variant=\"outline\"\r\n                  className=\"text-xs border-purple-200 bg-purple-50 text-purple-700\"\r\n                >\r\n                  <Folder className=\"w-3.5 h-3.5 mr-1\" strokeWidth={2} />\r\n                  {document.folder.path}\r\n                </Badge>\r\n              )}\r\n              {document.watermark && (\r\n                <Badge\r\n                  variant=\"outline\"\r\n                  className=\"text-xs border-emerald-200 bg-emerald-50 text-emerald-700\"\r\n                >\r\n                  <Shield className=\"w-3.5 h-3.5 mr-1\" strokeWidth={2} />\r\n                  Watermarked\r\n                </Badge>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Context Menu */}\r\n          <DropdownMenu open={isMenuOpen} onOpenChange={setIsMenuOpen}>\r\n            <DropdownMenuTrigger\r\n              className={cn(\r\n                'opacity-0 group-hover:opacity-100 transition-opacity duration-150',\r\n                'p-1 rounded hover:bg-muted',\r\n                'focus:outline-none focus:ring-2 focus:ring-primary',\r\n                isMenuOpen && 'opacity-100'\r\n              )}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <MoreVertical className=\"w-4 h-4 text-muted-foreground\" strokeWidth={2} />\r\n              <span className=\"sr-only\">Document actions</span>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\" className=\"w-48\">\r\n              {onPreview && (\r\n                <DropdownMenuItem\r\n                  onClick={(e) => {\r\n                    e.stopPropagation()\r\n                    onPreview(document)\r\n                  }}\r\n                >\r\n                  <Eye className=\"w-4 h-4 mr-2 text-primary\" strokeWidth={2} />\r\n                  <span>Preview</span>\r\n                </DropdownMenuItem>\r\n              )}\r\n              <DropdownMenuItem\r\n                onClick={(e) => {\r\n                  e.stopPropagation()\r\n                  handleDownload()\r\n                }}\r\n                disabled={isDownloading}\r\n              >\r\n                {isDownloading ? (\r\n                  <>\r\n                    <Clock className=\"w-4 h-4 mr-2 animate-spin text-muted-foreground\" strokeWidth={2} />\r\n                    <span>Generating...</span>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <Download className=\"w-4 h-4 mr-2 text-muted-foreground\" strokeWidth={2} />\r\n                    <span>Download</span>\r\n                  </>\r\n                )}\r\n              </DropdownMenuItem>\r\n              {onRename && (\r\n                <DropdownMenuItem\r\n                  onClick={(e) => {\r\n                    e.stopPropagation()\r\n                    onRename(document.id)\r\n                  }}\r\n                >\r\n                  <Edit className=\"w-4 h-4 mr-2 text-muted-foreground\" strokeWidth={2} />\r\n                  <span>Rename</span>\r\n                </DropdownMenuItem>\r\n              )}\r\n              {onDelete && (\r\n                <>\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem\r\n                    onClick={(e) => {\r\n                      e.stopPropagation()\r\n                      onDelete(document.id)\r\n                    }}\r\n                    className=\"text-destructive focus:text-destructive\"\r\n                  >\r\n                    <Trash2 className=\"w-4 h-4 mr-2\" strokeWidth={2} />\r\n                    <span>Delete</span>\r\n                  </DropdownMenuItem>\r\n                </>\r\n              )}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Hover Indicator (subtle bottom border) */}\r\n      <div\r\n        className={cn(\r\n          'absolute bottom-0 left-0 right-0 h-0.5 bg-primary',\r\n          'transform scale-x-0 group-hover:scale-x-100',\r\n          'transition-transform duration-200 origin-left',\r\n          'rounded-b-lg'\r\n        )}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\n/**\r\n * Document Card Skeleton (for loading states)\r\n */\r\nexport function DocumentCardSkeleton({ className }: { className?: string }) {\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'bg-card border border-border rounded-lg p-4 shadow-sm',\r\n        'animate-pulse',\r\n        className\r\n      )}\r\n    >\r\n      <div className=\"flex items-start gap-3\">\r\n        <div className=\"w-11 h-11 rounded-lg bg-muted flex-shrink-0\" />\r\n        <div className=\"flex-1 min-w-0\">\r\n          <div className=\"h-4 bg-muted rounded w-3/4 mb-2\" />\r\n          <div className=\"h-3 bg-muted rounded w-1/2\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1502, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/navigation/FolderNavigator.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React from 'react'\r\nimport {\r\n  FolderOpen,\r\n  FileText,\r\n  Upload,\r\n  FolderPlus,\r\n  Search,\r\n  Grid3x3,\r\n  List,\r\n  ArrowUpDown,\r\n} from 'lucide-react'\r\nimport { DocumentFolder, Document } from '@/types/documents'\r\nimport { FolderCard, FolderCardSkeleton } from './FolderCard'\r\nimport { DocumentCard } from '../document-card'\r\nimport { cn } from '@/lib/utils'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\n\r\ninterface FolderNavigatorProps {\r\n  currentFolderId: string | null\r\n  currentFolder: DocumentFolder | null\r\n  subfolders: DocumentFolder[]\r\n  documents: Document[]\r\n  isLoading?: boolean\r\n  viewMode?: 'grid' | 'list'\r\n  sortBy?: 'name' | 'date' | 'type'\r\n  onNavigateToFolder: (folderId: string) => void\r\n  onDocumentClick: (documentId: string) => void\r\n  onUploadClick: () => void\r\n  onCreateFolderClick: () => void\r\n  onRenameFolder?: (folderId: string) => void\r\n  onDeleteFolder?: (folderId: string) => void\r\n  onCreateSubfolder?: (parentId: string) => void\r\n  onRenameDocument?: (documentId: string) => void\r\n  onDeleteDocument?: (documentId: string) => void\r\n  onViewModeChange?: (mode: 'grid' | 'list') => void\r\n  onSortChange?: (sort: 'name' | 'date' | 'type') => void\r\n  onSearchChange?: (query: string) => void\r\n  searchQuery?: string\r\n  className?: string\r\n}\r\n\r\n/**\r\n * FolderNavigator - Main Folder/Document Grid Component\r\n *\r\n * Professional file explorer with:\r\n * - Grid/list view toggle\r\n * - Sorting and search\r\n * - Empty states\r\n * - Loading skeletons\r\n * - Keyboard navigation\r\n *\r\n * Design: Financial Terminal Elegance\r\n */\r\nexport function FolderNavigator({\r\n  currentFolderId,\r\n  currentFolder,\r\n  subfolders,\r\n  documents,\r\n  isLoading = false,\r\n  viewMode = 'grid',\r\n  sortBy = 'name',\r\n  onNavigateToFolder,\r\n  onDocumentClick,\r\n  onUploadClick,\r\n  onCreateFolderClick,\r\n  onRenameFolder,\r\n  onDeleteFolder,\r\n  onCreateSubfolder,\r\n  onRenameDocument,\r\n  onDeleteDocument,\r\n  onViewModeChange,\r\n  onSortChange,\r\n  onSearchChange,\r\n  searchQuery = '',\r\n  className,\r\n}: FolderNavigatorProps) {\r\n  const isEmpty = !isLoading && subfolders.length === 0 && documents.length === 0\r\n  const hasContent = subfolders.length > 0 || documents.length > 0\r\n\r\n  return (\r\n    <div className={cn('flex flex-col h-full bg-[#0a0a0a]', className)}>\r\n      {/* Toolbar - Always visible for search access */}\r\n      <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 px-6 py-4 bg-black/40 border-b border-white/10\">\r\n        {/* Left: Search */}\r\n        <div className=\"relative w-full sm:w-auto sm:min-w-[300px]\">\r\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" strokeWidth={2} />\r\n          <Input\r\n            type=\"text\"\r\n            placeholder=\"Search folders and documents...\"\r\n            value={searchQuery}\r\n            onChange={(e) => onSearchChange?.(e.target.value)}\r\n            className=\"pl-10 h-9 text-sm bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-blue-500 focus:ring-blue-500\"\r\n          />\r\n        </div>\r\n\r\n        {/* Right: Controls */}\r\n        <div className=\"flex items-center gap-2 w-full sm:w-auto\">\r\n          {/* Sort */}\r\n          <Select value={sortBy} onValueChange={(value) => onSortChange?.(value as any)}>\r\n            <SelectTrigger className=\"w-[140px] h-9 text-sm bg-white/5 border-white/10 text-white\">\r\n              <ArrowUpDown className=\"w-3.5 h-3.5 mr-2 text-gray-400\" strokeWidth={2} />\r\n              <SelectValue />\r\n            </SelectTrigger>\r\n            <SelectContent className=\"bg-zinc-900 border-white/10 text-white\">\r\n              <SelectItem value=\"name\" className=\"text-white focus:bg-white/10 focus:text-white\">Name</SelectItem>\r\n              <SelectItem value=\"date\" className=\"text-white focus:bg-white/10 focus:text-white\">Date Modified</SelectItem>\r\n              <SelectItem value=\"type\" className=\"text-white focus:bg-white/10 focus:text-white\">Type</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n\r\n          {/* View Mode Toggle */}\r\n          {onViewModeChange && (\r\n            <div className=\"flex items-center border border-white/10 rounded-md overflow-hidden\">\r\n              <button\r\n                onClick={() => onViewModeChange('grid')}\r\n                className={cn(\r\n                  'p-1.5 transition-colors',\r\n                  viewMode === 'grid'\r\n                    ? 'bg-blue-500/20 text-blue-400'\r\n                    : 'text-gray-400 hover:bg-white/10'\r\n                )}\r\n                aria-label=\"Grid view\"\r\n              >\r\n                <Grid3x3 className=\"w-4 h-4\" strokeWidth={2} />\r\n              </button>\r\n              <div className=\"w-px h-6 bg-white/10\" />\r\n              <button\r\n                onClick={() => onViewModeChange('list')}\r\n                className={cn(\r\n                  'p-1.5 transition-colors',\r\n                  viewMode === 'list'\r\n                    ? 'bg-blue-500/20 text-blue-400'\r\n                    : 'text-gray-400 hover:bg-white/10'\r\n                )}\r\n                aria-label=\"List view\"\r\n              >\r\n                <List className=\"w-4 h-4\" strokeWidth={2} />\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content Area */}\r\n      <div className=\"flex-1 overflow-auto\">\r\n        {/* Loading State */}\r\n        {isLoading && (\r\n          <div className=\"p-6\">\r\n            <div\r\n              className={cn(\r\n                'grid gap-4',\r\n                viewMode === 'grid'\r\n                  ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4'\r\n                  : 'grid-cols-1'\r\n              )}\r\n            >\r\n              {Array.from({ length: 8 }).map((_, i) => (\r\n                <FolderCardSkeleton key={i} />\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Empty State */}\r\n        {isEmpty && !isLoading && <EmptyState onUploadClick={onUploadClick} onCreateFolderClick={onCreateFolderClick} />}\r\n\r\n        {/* Content Grid */}\r\n        {!isEmpty && !isLoading && (\r\n          <div className=\"p-6 space-y-8\">\r\n            {/* Folders Section */}\r\n            {subfolders.length > 0 && (\r\n              <div>\r\n                <div className=\"flex items-center gap-3 mb-4\">\r\n                  <h2 className=\"text-sm font-semibold text-gray-400 uppercase tracking-wider\">\r\n                    Folders\r\n                  </h2>\r\n                  <div className=\"flex-1 h-px bg-white/10\" />\r\n                  <span className=\"text-xs text-gray-500\">{subfolders.length}</span>\r\n                </div>\r\n                <div\r\n                  className={cn(\r\n                    'grid gap-4',\r\n                    viewMode === 'grid'\r\n                      ? 'grid-cols-1 md:grid-cols-2 xl:grid-cols-4'\r\n                      : 'grid-cols-1 max-w-4xl'\r\n                  )}\r\n                >\r\n                  {subfolders.map((folder) => (\r\n                    <FolderCard\r\n                      key={folder.id}\r\n                      folder={folder}\r\n                      onNavigate={onNavigateToFolder}\r\n                      onRename={onRenameFolder}\r\n                      onDelete={onDeleteFolder}\r\n                      onCreateSubfolder={onCreateSubfolder}\r\n                      variant={viewMode === 'list' ? 'compact' : 'default'}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Documents Section */}\r\n            {documents.length > 0 && (\r\n              <div>\r\n                <div className=\"flex items-center gap-3 mb-4\">\r\n                  <h2 className=\"text-sm font-semibold text-gray-400 uppercase tracking-wider\">\r\n                    Documents\r\n                  </h2>\r\n                  <div className=\"flex-1 h-px bg-white/10\" />\r\n                  <span className=\"text-xs text-gray-500\">{documents.length}</span>\r\n                </div>\r\n                <div\r\n                  className={cn(\r\n                    'grid gap-4',\r\n                    viewMode === 'grid'\r\n                      ? 'grid-cols-1 md:grid-cols-2 xl:grid-cols-4'\r\n                      : 'grid-cols-1 max-w-4xl'\r\n                  )}\r\n                >\r\n                  {documents.map((document) => (\r\n                    <DocumentCard\r\n                      key={document.id}\r\n                      document={document}\r\n                      onPreview={() => onDocumentClick(document.id)}\r\n                      onRename={onRenameDocument}\r\n                      onDelete={onDeleteDocument}\r\n                      variant={viewMode === 'list' ? 'compact' : 'default'}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n/**\r\n * Empty State Component (Professional, Actionable)\r\n */\r\nfunction EmptyState({\r\n  onUploadClick,\r\n  onCreateFolderClick,\r\n}: {\r\n  onUploadClick: () => void\r\n  onCreateFolderClick: () => void\r\n}) {\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center py-16 px-4\">\r\n      {/* Icon */}\r\n      <div className=\"w-20 h-20 rounded-full bg-white/5 flex items-center justify-center mb-6 border border-white/10\">\r\n        <FolderOpen className=\"w-10 h-10 text-gray-400\" strokeWidth={1.5} />\r\n      </div>\r\n\r\n      {/* Heading */}\r\n      <h3 className=\"text-lg font-semibold text-white mb-2\">\r\n        This folder is empty\r\n      </h3>\r\n\r\n      {/* Description */}\r\n      <p className=\"text-sm text-gray-400 mb-8 text-center max-w-md leading-relaxed\">\r\n        Get started by uploading documents or creating subfolders to organize your files.\r\n      </p>\r\n\r\n      {/* Actions */}\r\n      <div className=\"flex flex-col sm:flex-row gap-3\">\r\n        <Button onClick={onUploadClick} size=\"default\" className=\"min-w-[160px] bg-blue-600 hover:bg-blue-700 text-white\">\r\n          <Upload className=\"w-4 h-4 mr-2\" strokeWidth={2} />\r\n          Upload Documents\r\n        </Button>\r\n        <Button onClick={onCreateFolderClick} variant=\"outline\" size=\"default\" className=\"min-w-[160px] border-white/20 text-white hover:bg-white/10\">\r\n          <FolderPlus className=\"w-4 h-4 mr-2\" strokeWidth={2} />\r\n          New Folder\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1968, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,2BAAa,0OAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,qQAAC,yMAAwB;QACvB,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;0BAET,qQAAC,6MAA4B;gBAAC,WAAU;0BACrC;;;;;;0BAEH,qQAAC;;;;;0BACD,qQAAC,2MAA0B;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,yMAAwB,CAAC,WAAW;AAE7D,MAAM,0BAAY,0OAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,cAAc,UAAU,EAAE,GAAG,OAAO,EAAE,oBACpD,qQAAC,wNAAuC;QACtC,KAAK;QACL,aAAa;QACb,WAAW,IAAA,gJAAE,EACX,iDACA,gBAAgB,cACd,sDACF,gBAAgB,gBACd,wDACF;QAED,GAAG,KAAK;kBAET,cAAA,qQAAC,oNAAmC;YAAC,WAAU;;;;;;;;;;;AAGnD,UAAU,WAAW,GAAG,wNAAuC,CAAC,WAAW"}},
    {"offset": {"line": 2036, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/navigation/FolderTreeDrawer.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React, { useState, useMemo } from 'react'\r\nimport {\r\n  Folder,\r\n  FolderOpen,\r\n  ChevronRight,\r\n  ChevronDown,\r\n  Search,\r\n  X,\r\n} from 'lucide-react'\r\nimport { DocumentFolder } from '@/types/documents'\r\nimport { FOLDER_ICON_COLORS } from '@/lib/design-tokens'\r\nimport { cn } from '@/lib/utils'\r\nimport {\r\n  Sheet,\r\n  SheetContent,\r\n  SheetHeader,\r\n  SheetTitle,\r\n  SheetDescription,\r\n} from '@/components/ui/sheet'\r\nimport { Input } from '@/components/ui/input'\r\nimport { ScrollArea } from '@/components/ui/scroll-area'\r\n\r\ninterface FolderTreeDrawerProps {\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  folders: DocumentFolder[]\r\n  currentFolderId: string | null\r\n  onNavigate: (folderId: string | null) => void\r\n}\r\n\r\n/**\r\n * FolderTreeDrawer - Collapsible Sidebar with Full Tree\r\n *\r\n * Professional drawer component for power users who want\r\n * quick access to any folder in the hierarchy.\r\n *\r\n * Features:\r\n * - Searchable folder tree\r\n * - Expand/collapse folders\r\n * - Highlights current folder\r\n * - Keyboard shortcut support\r\n *\r\n * Design: Financial Terminal Elegance\r\n */\r\nexport function FolderTreeDrawer({\r\n  open,\r\n  onOpenChange,\r\n  folders,\r\n  currentFolderId,\r\n  onNavigate,\r\n}: FolderTreeDrawerProps) {\r\n  const [expandedFolders, setExpandedFolders] = useState<Set<string>>(new Set())\r\n  const [searchQuery, setSearchQuery] = useState('')\r\n\r\n  // Build tree structure from flat folder list\r\n  const folderTree = useMemo(() => {\r\n    return buildFolderTree(folders)\r\n  }, [folders])\r\n\r\n  // Filter tree based on search\r\n  const filteredTree = useMemo(() => {\r\n    if (!searchQuery.trim()) return folderTree\r\n    return filterTreeBySearch(folderTree, searchQuery.toLowerCase())\r\n  }, [folderTree, searchQuery])\r\n\r\n  // Toggle folder expansion\r\n  const toggleFolder = (folderId: string) => {\r\n    const newExpanded = new Set(expandedFolders)\r\n    if (newExpanded.has(folderId)) {\r\n      newExpanded.delete(folderId)\r\n    } else {\r\n      newExpanded.add(folderId)\r\n    }\r\n    setExpandedFolders(newExpanded)\r\n  }\r\n\r\n  // Handle folder navigation\r\n  const handleNavigate = (folderId: string | null) => {\r\n    onNavigate(folderId)\r\n    onOpenChange(false) // Close drawer after navigation\r\n  }\r\n\r\n  // Auto-expand current folder's ancestors\r\n  React.useEffect(() => {\r\n    if (currentFolderId && folders.length > 0) {\r\n      const currentFolder = folders.find(f => f.id === currentFolderId)\r\n      if (currentFolder) {\r\n        const ancestorIds = getAncestorIds(currentFolder, folders)\r\n        setExpandedFolders(prev => new Set([...prev, ...ancestorIds]))\r\n      }\r\n    }\r\n  }, [currentFolderId, folders])\r\n\r\n  return (\r\n    <Sheet open={open} onOpenChange={onOpenChange}>\r\n      <SheetContent side=\"left\" className=\"w-[400px] sm:w-[500px] p-0 bg-background border-border\">\r\n        {/* Header */}\r\n        <SheetHeader className=\"px-6 py-4 border-b border-border\">\r\n          <SheetTitle className=\"text-foreground\">Browse All Folders</SheetTitle>\r\n          <SheetDescription className=\"text-muted-foreground\">\r\n            Quick access to any folder in the hierarchy\r\n          </SheetDescription>\r\n        </SheetHeader>\r\n\r\n        {/* Search */}\r\n        <div className=\"px-6 py-4 border-b border-border bg-muted/50\">\r\n          <div className=\"relative\">\r\n            <Search\r\n              className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\"\r\n              strokeWidth={2}\r\n            />\r\n            <Input\r\n              type=\"text\"\r\n              placeholder=\"Search folders...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-10 pr-10 h-9 text-sm\"\r\n            />\r\n            {searchQuery && (\r\n              <button\r\n                onClick={() => setSearchQuery('')}\r\n                className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors\"\r\n              >\r\n                <X className=\"w-4 h-4\" strokeWidth={2} />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Folder Tree */}\r\n        <ScrollArea className=\"flex-1 h-[calc(100vh-180px)]\">\r\n          <div className=\"px-4 py-4\">\r\n            {/* Root Option */}\r\n            <button\r\n              onClick={() => handleNavigate(null)}\r\n              className={cn(\r\n                'flex items-center gap-2 w-full px-3 py-2 rounded-md text-sm font-medium transition-colors',\r\n                currentFolderId === null\r\n                  ? 'bg-primary/20 text-primary border border-primary'\r\n                  : 'text-muted-foreground hover:bg-muted border border-transparent'\r\n              )}\r\n            >\r\n              <Folder className=\"w-4 h-4 flex-shrink-0\" strokeWidth={2} />\r\n              <span>All Documents (Root)</span>\r\n            </button>\r\n\r\n            {/* Tree Nodes */}\r\n            <div className=\"mt-2 space-y-0.5\">\r\n              {filteredTree.map((node) => (\r\n                <FolderTreeNode\r\n                  key={node.folder.id}\r\n                  node={node}\r\n                  level={0}\r\n                  currentFolderId={currentFolderId}\r\n                  expandedFolders={expandedFolders}\r\n                  onToggle={toggleFolder}\r\n                  onNavigate={handleNavigate}\r\n                />\r\n              ))}\r\n            </div>\r\n\r\n            {/* Empty State */}\r\n            {filteredTree.length === 0 && (\r\n              <div className=\"text-center py-8 text-sm text-muted-foreground\">\r\n                {searchQuery ? 'No folders match your search' : 'No folders found'}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </ScrollArea>\r\n\r\n        {/* Footer */}\r\n        <div className=\"px-6 py-3 border-t border-border bg-muted/50\">\r\n          <p className=\"text-xs text-muted-foreground\">\r\n            <kbd className=\"px-1.5 py-0.5 bg-muted border border-border rounded text-xs font-mono text-foreground\">\r\n              Cmd+K\r\n            </kbd>{' '}\r\n            to open this drawer\r\n          </p>\r\n        </div>\r\n      </SheetContent>\r\n    </Sheet>\r\n  )\r\n}\r\n\r\n/**\r\n * Tree Node Component (Recursive)\r\n */\r\ninterface TreeNode {\r\n  folder: DocumentFolder\r\n  children: TreeNode[]\r\n}\r\n\r\ninterface FolderTreeNodeProps {\r\n  node: TreeNode\r\n  level: number\r\n  currentFolderId: string | null\r\n  expandedFolders: Set<string>\r\n  onToggle: (folderId: string) => void\r\n  onNavigate: (folderId: string) => void\r\n}\r\n\r\nfunction FolderTreeNode({\r\n  node,\r\n  level,\r\n  currentFolderId,\r\n  expandedFolders,\r\n  onToggle,\r\n  onNavigate,\r\n}: FolderTreeNodeProps) {\r\n  const isExpanded = expandedFolders.has(node.folder.id)\r\n  const hasChildren = node.children.length > 0\r\n  const isCurrent = currentFolderId === node.folder.id\r\n\r\n  // Get folder color scheme\r\n  const colorScheme =\r\n    FOLDER_ICON_COLORS[node.folder.folder_type] || FOLDER_ICON_COLORS.custom\r\n\r\n  return (\r\n    <div>\r\n      {/* Folder Row */}\r\n      <div\r\n        className={cn(\r\n          'flex items-center gap-1 rounded-md transition-colors',\r\n          isCurrent ? 'bg-primary/20 border border-primary' : 'hover:bg-muted border border-transparent'\r\n        )}\r\n        style={{ paddingLeft: `${level * 16 + 8}px` }}\r\n      >\r\n        {/* Expand/Collapse Icon */}\r\n        {hasChildren ? (\r\n          <button\r\n            onClick={() => onToggle(node.folder.id)}\r\n            className=\"p-1 hover:bg-accent rounded transition-colors\"\r\n            aria-label={isExpanded ? 'Collapse folder' : 'Expand folder'}\r\n          >\r\n            {isExpanded ? (\r\n              <ChevronDown className=\"w-3.5 h-3.5 text-muted-foreground\" strokeWidth={2} />\r\n            ) : (\r\n              <ChevronRight className=\"w-3.5 h-3.5 text-muted-foreground\" strokeWidth={2} />\r\n            )}\r\n          </button>\r\n        ) : (\r\n          <div className=\"w-5\" /> // Spacer for alignment\r\n        )}\r\n\r\n        {/* Folder Button */}\r\n        <button\r\n          onClick={() => onNavigate(node.folder.id)}\r\n          className=\"flex items-center gap-2 flex-1 py-2 pr-3 text-left text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-1 rounded\"\r\n        >\r\n          {isExpanded ? (\r\n            <FolderOpen\r\n              className={cn(\r\n                'w-4 h-4 flex-shrink-0',\r\n                colorScheme === FOLDER_ICON_COLORS.vehicle_root ? 'text-blue-500' :\r\n                colorScheme === FOLDER_ICON_COLORS.category ? 'text-green-500' :\r\n                'text-muted-foreground'\r\n              )}\r\n              strokeWidth={2}\r\n            />\r\n          ) : (\r\n            <Folder\r\n              className={cn(\r\n                'w-4 h-4 flex-shrink-0',\r\n                colorScheme === FOLDER_ICON_COLORS.vehicle_root ? 'text-blue-500' :\r\n                colorScheme === FOLDER_ICON_COLORS.category ? 'text-green-500' :\r\n                'text-muted-foreground'\r\n              )}\r\n              strokeWidth={2}\r\n            />\r\n          )}\r\n          <span\r\n            className={cn(\r\n              'truncate font-medium',\r\n              isCurrent ? 'text-foreground' : 'text-muted-foreground'\r\n            )}\r\n          >\r\n            {node.folder.name}\r\n          </span>\r\n          {node.folder.subfolder_count !== undefined && node.folder.subfolder_count > 0 && (\r\n            <span className=\"text-xs text-muted-foreground\">({node.folder.subfolder_count})</span>\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Children (Recursive) */}\r\n      {isExpanded && hasChildren && (\r\n        <div className=\"mt-0.5\">\r\n          {node.children.map((child) => (\r\n            <FolderTreeNode\r\n              key={child.folder.id}\r\n              node={child}\r\n              level={level + 1}\r\n              currentFolderId={currentFolderId}\r\n              expandedFolders={expandedFolders}\r\n              onToggle={onToggle}\r\n              onNavigate={onNavigate}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n/**\r\n * Helper Functions\r\n */\r\n\r\nfunction buildFolderTree(folders: DocumentFolder[]): TreeNode[] {\r\n  const folderMap = new Map<string | null, TreeNode[]>()\r\n\r\n  // Initialize map\r\n  folders.forEach((folder) => {\r\n    if (!folderMap.has(folder.parent_folder_id)) {\r\n      folderMap.set(folder.parent_folder_id, [])\r\n    }\r\n    folderMap.get(folder.parent_folder_id)!.push({\r\n      folder,\r\n      children: [],\r\n    })\r\n  })\r\n\r\n  // Build tree recursively\r\n  function buildChildren(parentId: string | null): TreeNode[] {\r\n    const children = folderMap.get(parentId) || []\r\n    return children.map((node) => ({\r\n      ...node,\r\n      children: buildChildren(node.folder.id),\r\n    }))\r\n  }\r\n\r\n  return buildChildren(null)\r\n}\r\n\r\nfunction filterTreeBySearch(tree: TreeNode[], query: string): TreeNode[] {\r\n  return tree\r\n    .map((node) => {\r\n      const nameMatches = node.folder.name.toLowerCase().includes(query)\r\n      const pathMatches = node.folder.path.toLowerCase().includes(query)\r\n      const filteredChildren = filterTreeBySearch(node.children, query)\r\n\r\n      if (nameMatches || pathMatches || filteredChildren.length > 0) {\r\n        return {\r\n          ...node,\r\n          children: filteredChildren,\r\n        }\r\n      }\r\n      return null\r\n    })\r\n    .filter((node): node is TreeNode => node !== null)\r\n}\r\n\r\nfunction getAncestorIds(folder: DocumentFolder, allFolders: DocumentFolder[]): string[] {\r\n  const ancestors: string[] = []\r\n  let currentFolder: DocumentFolder | undefined = folder\r\n\r\n  while (currentFolder?.parent_folder_id) {\r\n    ancestors.push(currentFolder.parent_folder_id)\r\n    currentFolder = allFolders.find((f) => f.id === currentFolder!.parent_folder_id)\r\n  }\r\n\r\n  return ancestors\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AAOA;AACA;AAtBA;;;;;;;;;AA8CO,SAAS,iBAAiB,EAC/B,IAAI,EACJ,YAAY,EACZ,OAAO,EACP,eAAe,EACf,UAAU,EACY;IACtB,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,wOAAQ,EAAc,IAAI;IACxE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,wOAAQ,EAAC;IAE/C,6CAA6C;IAC7C,MAAM,aAAa,IAAA,uOAAO,EAAC;QACzB,OAAO,gBAAgB;IACzB,GAAG;QAAC;KAAQ;IAEZ,8BAA8B;IAC9B,MAAM,eAAe,IAAA,uOAAO,EAAC;QAC3B,IAAI,CAAC,YAAY,IAAI,IAAI,OAAO;QAChC,OAAO,mBAAmB,YAAY,YAAY,WAAW;IAC/D,GAAG;QAAC;QAAY;KAAY;IAE5B,0BAA0B;IAC1B,MAAM,eAAe,CAAC;QACpB,MAAM,cAAc,IAAI,IAAI;QAC5B,IAAI,YAAY,GAAG,CAAC,WAAW;YAC7B,YAAY,MAAM,CAAC;QACrB,OAAO;YACL,YAAY,GAAG,CAAC;QAClB;QACA,mBAAmB;IACrB;IAEA,2BAA2B;IAC3B,MAAM,iBAAiB,CAAC;QACtB,WAAW;QACX,aAAa,QAAO,gCAAgC;IACtD;IAEA,yCAAyC;IACzC,uOAAK,CAAC,SAAS,CAAC;QACd,IAAI,mBAAmB,QAAQ,MAAM,GAAG,GAAG;YACzC,MAAM,gBAAgB,QAAQ,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;YACjD,IAAI,eAAe;gBACjB,MAAM,cAAc,eAAe,eAAe;gBAClD,mBAAmB,CAAA,OAAQ,IAAI,IAAI;2BAAI;2BAAS;qBAAY;YAC9D;QACF;IACF,GAAG;QAAC;QAAiB;KAAQ;IAE7B,qBACE,qQAAC,iKAAK;QAAC,MAAM;QAAM,cAAc;kBAC/B,cAAA,qQAAC,wKAAY;YAAC,MAAK;YAAO,WAAU;;8BAElC,qQAAC,uKAAW;oBAAC,WAAU;;sCACrB,qQAAC,sKAAU;4BAAC,WAAU;sCAAkB;;;;;;sCACxC,qQAAC,4KAAgB;4BAAC,WAAU;sCAAwB;;;;;;;;;;;;8BAMtD,qQAAC;oBAAI,WAAU;8BACb,cAAA,qQAAC;wBAAI,WAAU;;0CACb,qQAAC,uOAAM;gCACL,WAAU;gCACV,aAAa;;;;;;0CAEf,qQAAC,iKAAK;gCACJ,MAAK;gCACL,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;gCAC9C,WAAU;;;;;;4BAEX,6BACC,qQAAC;gCACC,SAAS,IAAM,eAAe;gCAC9B,WAAU;0CAEV,cAAA,qQAAC,wNAAC;oCAAC,WAAU;oCAAU,aAAa;;;;;;;;;;;;;;;;;;;;;;8BAO5C,qQAAC,+KAAU;oBAAC,WAAU;8BACpB,cAAA,qQAAC;wBAAI,WAAU;;0CAEb,qQAAC;gCACC,SAAS,IAAM,eAAe;gCAC9B,WAAW,IAAA,gJAAE,EACX,6FACA,oBAAoB,OAChB,qDACA;;kDAGN,qQAAC,uOAAM;wCAAC,WAAU;wCAAwB,aAAa;;;;;;kDACvD,qQAAC;kDAAK;;;;;;;;;;;;0CAIR,qQAAC;gCAAI,WAAU;0CACZ,aAAa,GAAG,CAAC,CAAC,qBACjB,qQAAC;wCAEC,MAAM;wCACN,OAAO;wCACP,iBAAiB;wCACjB,iBAAiB;wCACjB,UAAU;wCACV,YAAY;uCANP,KAAK,MAAM,CAAC,EAAE;;;;;;;;;;4BAYxB,aAAa,MAAM,KAAK,mBACvB,qQAAC;gCAAI,WAAU;0CACZ,cAAc,iCAAiC;;;;;;;;;;;;;;;;;8BAOxD,qQAAC;oBAAI,WAAU;8BACb,cAAA,qQAAC;wBAAE,WAAU;;0CACX,qQAAC;gCAAI,WAAU;0CAAwF;;;;;;4BAEhG;4BAAI;;;;;;;;;;;;;;;;;;;;;;;AAOvB;AAmBA,SAAS,eAAe,EACtB,IAAI,EACJ,KAAK,EACL,eAAe,EACf,eAAe,EACf,QAAQ,EACR,UAAU,EACU;IACpB,MAAM,aAAa,gBAAgB,GAAG,CAAC,KAAK,MAAM,CAAC,EAAE;IACrD,MAAM,cAAc,KAAK,QAAQ,CAAC,MAAM,GAAG;IAC3C,MAAM,YAAY,oBAAoB,KAAK,MAAM,CAAC,EAAE;IAEpD,0BAA0B;IAC1B,MAAM,cACJ,2KAAkB,CAAC,KAAK,MAAM,CAAC,WAAW,CAAC,IAAI,2KAAkB,CAAC,MAAM;IAE1E,qBACE,qQAAC;;0BAEC,qQAAC;gBACC,WAAW,IAAA,gJAAE,EACX,wDACA,YAAY,wCAAwC;gBAEtD,OAAO;oBAAE,aAAa,GAAG,QAAQ,KAAK,EAAE,EAAE,CAAC;gBAAC;;oBAG3C,4BACC,qQAAC;wBACC,SAAS,IAAM,SAAS,KAAK,MAAM,CAAC,EAAE;wBACtC,WAAU;wBACV,cAAY,aAAa,oBAAoB;kCAE5C,2BACC,qQAAC,0PAAW;4BAAC,WAAU;4BAAoC,aAAa;;;;;iDAExE,qQAAC,6PAAY;4BAAC,WAAU;4BAAoC,aAAa;;;;;;;;;;6CAI7E,qQAAC;wBAAI,WAAU;;;;;;kCAIjB,qQAAC;wBACC,SAAS,IAAM,WAAW,KAAK,MAAM,CAAC,EAAE;wBACxC,WAAU;;4BAET,2BACC,qQAAC,uPAAU;gCACT,WAAW,IAAA,gJAAE,EACX,yBACA,gBAAgB,2KAAkB,CAAC,YAAY,GAAG,kBAClD,gBAAgB,2KAAkB,CAAC,QAAQ,GAAG,mBAC9C;gCAEF,aAAa;;;;;qDAGf,qQAAC,uOAAM;gCACL,WAAW,IAAA,gJAAE,EACX,yBACA,gBAAgB,2KAAkB,CAAC,YAAY,GAAG,kBAClD,gBAAgB,2KAAkB,CAAC,QAAQ,GAAG,mBAC9C;gCAEF,aAAa;;;;;;0CAGjB,qQAAC;gCACC,WAAW,IAAA,gJAAE,EACX,wBACA,YAAY,oBAAoB;0CAGjC,KAAK,MAAM,CAAC,IAAI;;;;;;4BAElB,KAAK,MAAM,CAAC,eAAe,KAAK,aAAa,KAAK,MAAM,CAAC,eAAe,GAAG,mBAC1E,qQAAC;gCAAK,WAAU;;oCAAgC;oCAAE,KAAK,MAAM,CAAC,eAAe;oCAAC;;;;;;;;;;;;;;;;;;;YAMnF,cAAc,6BACb,qQAAC;gBAAI,WAAU;0BACZ,KAAK,QAAQ,CAAC,GAAG,CAAC,CAAC,sBAClB,qQAAC;wBAEC,MAAM;wBACN,OAAO,QAAQ;wBACf,iBAAiB;wBACjB,iBAAiB;wBACjB,UAAU;wBACV,YAAY;uBANP,MAAM,MAAM,CAAC,EAAE;;;;;;;;;;;;;;;;AAalC;AAEA;;CAEC,GAED,SAAS,gBAAgB,OAAyB;IAChD,MAAM,YAAY,IAAI;IAEtB,iBAAiB;IACjB,QAAQ,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,UAAU,GAAG,CAAC,OAAO,gBAAgB,GAAG;YAC3C,UAAU,GAAG,CAAC,OAAO,gBAAgB,EAAE,EAAE;QAC3C;QACA,UAAU,GAAG,CAAC,OAAO,gBAAgB,EAAG,IAAI,CAAC;YAC3C;YACA,UAAU,EAAE;QACd;IACF;IAEA,yBAAyB;IACzB,SAAS,cAAc,QAAuB;QAC5C,MAAM,WAAW,UAAU,GAAG,CAAC,aAAa,EAAE;QAC9C,OAAO,SAAS,GAAG,CAAC,CAAC,OAAS,CAAC;gBAC7B,GAAG,IAAI;gBACP,UAAU,cAAc,KAAK,MAAM,CAAC,EAAE;YACxC,CAAC;IACH;IAEA,OAAO,cAAc;AACvB;AAEA,SAAS,mBAAmB,IAAgB,EAAE,KAAa;IACzD,OAAO,KACJ,GAAG,CAAC,CAAC;QACJ,MAAM,cAAc,KAAK,MAAM,CAAC,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC;QAC5D,MAAM,cAAc,KAAK,MAAM,CAAC,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC;QAC5D,MAAM,mBAAmB,mBAAmB,KAAK,QAAQ,EAAE;QAE3D,IAAI,eAAe,eAAe,iBAAiB,MAAM,GAAG,GAAG;YAC7D,OAAO;gBACL,GAAG,IAAI;gBACP,UAAU;YACZ;QACF;QACA,OAAO;IACT,GACC,MAAM,CAAC,CAAC,OAA2B,SAAS;AACjD;AAEA,SAAS,eAAe,MAAsB,EAAE,UAA4B;IAC1E,MAAM,YAAsB,EAAE;IAC9B,IAAI,gBAA4C;IAEhD,MAAO,eAAe,iBAAkB;QACtC,UAAU,IAAI,CAAC,cAAc,gBAAgB;QAC7C,gBAAgB,WAAW,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,cAAe,gBAAgB;IACjF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 2471, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/upload/UploadDestinationBanner.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React from 'react'\r\nimport { Upload, Folder, ChevronRight } from 'lucide-react'\r\nimport { DocumentFolder } from '@/types/documents'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface UploadDestinationBannerProps {\r\n  currentFolder: DocumentFolder | null\r\n  className?: string\r\n}\r\n\r\n/**\r\n * UploadDestinationBanner - Clear Upload Context Component\r\n *\r\n * Displays the current upload destination in a professional banner.\r\n * Solves the \"where are my files going?\" problem.\r\n *\r\n * Design: Financial Terminal Elegance\r\n */\r\nexport function UploadDestinationBanner({\r\n  currentFolder,\r\n  className,\r\n}: UploadDestinationBannerProps) {\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'px-6 py-2.5 border-b',\r\n        'bg-navy-50 border-navy-100',\r\n        'transition-colors duration-200',\r\n        className\r\n      )}\r\n    >\r\n      <div className=\"flex items-center gap-2 text-sm\">\r\n        {/* Upload Icon */}\r\n        <Upload className=\"w-4 h-4 text-navy-600 flex-shrink-0\" strokeWidth={2} />\r\n\r\n        {/* Label */}\r\n        <span className=\"text-slate-700 font-medium\">Upload destination:</span>\r\n\r\n        {/* Current Folder Path */}\r\n        {currentFolder ? (\r\n          <div className=\"flex items-center gap-1.5\">\r\n            {/* Parse path into breadcrumb-style display */}\r\n            {currentFolder.path.split('/').filter(Boolean).map((segment, index, arr) => (\r\n              <React.Fragment key={index}>\r\n                {index > 0 && (\r\n                  <ChevronRight\r\n                    className=\"w-3.5 h-3.5 text-navy-400 flex-shrink-0\"\r\n                    strokeWidth={2}\r\n                  />\r\n                )}\r\n                <span\r\n                  className={cn(\r\n                    'font-medium',\r\n                    index === arr.length - 1\r\n                      ? 'text-navy-900' // Last segment (current folder)\r\n                      : 'text-navy-700' // Parent segments\r\n                  )}\r\n                >\r\n                  {segment}\r\n                </span>\r\n              </React.Fragment>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <span className=\"font-medium text-navy-900\">Root / All Documents</span>\r\n        )}\r\n\r\n        {/* Folder Icon */}\r\n        <Folder\r\n          className=\"w-4 h-4 text-navy-600 ml-1 flex-shrink-0\"\r\n          strokeWidth={2}\r\n        />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n/**\r\n * Compact variant for dialogs/modals\r\n */\r\nexport function UploadDestinationBadge({\r\n  currentFolder,\r\n  className,\r\n}: UploadDestinationBannerProps) {\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'inline-flex items-center gap-2 px-3 py-1.5 rounded-md',\r\n        'bg-navy-50 border border-navy-200',\r\n        'text-sm',\r\n        className\r\n      )}\r\n    >\r\n      <Folder className=\"w-3.5 h-3.5 text-navy-600 flex-shrink-0\" strokeWidth={2} />\r\n      <span className=\"text-slate-700\">Uploading to:</span>\r\n      <span className=\"font-medium text-navy-900\">\r\n        {currentFolder?.name || 'Root'}\r\n      </span>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AAAA;AAEA;AALA;;;;;AAoBO,SAAS,wBAAwB,EACtC,aAAa,EACb,SAAS,EACoB;IAC7B,qBACE,qQAAC;QACC,WAAW,IAAA,gJAAE,EACX,wBACA,8BACA,kCACA;kBAGF,cAAA,qQAAC;YAAI,WAAU;;8BAEb,qQAAC,uOAAM;oBAAC,WAAU;oBAAsC,aAAa;;;;;;8BAGrE,qQAAC;oBAAK,WAAU;8BAA6B;;;;;;gBAG5C,8BACC,qQAAC;oBAAI,WAAU;8BAEZ,cAAc,IAAI,CAAC,KAAK,CAAC,KAAK,MAAM,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,OAAO,oBAClE,qQAAC,uOAAK,CAAC,QAAQ;;gCACZ,QAAQ,mBACP,qQAAC,6PAAY;oCACX,WAAU;oCACV,aAAa;;;;;;8CAGjB,qQAAC;oCACC,WAAW,IAAA,gJAAE,EACX,eACA,UAAU,IAAI,MAAM,GAAG,IACnB,gBAAgB,gCAAgC;uCAChD,gBAAgB,kBAAkB;;8CAGvC;;;;;;;2BAfgB;;;;;;;;;yCAqBzB,qQAAC;oBAAK,WAAU;8BAA4B;;;;;;8BAI9C,qQAAC,uOAAM;oBACL,WAAU;oBACV,aAAa;;;;;;;;;;;;;;;;;AAKvB;AAKO,SAAS,uBAAuB,EACrC,aAAa,EACb,SAAS,EACoB;IAC7B,qBACE,qQAAC;QACC,WAAW,IAAA,gJAAE,EACX,yDACA,qCACA,WACA;;0BAGF,qQAAC,uOAAM;gBAAC,WAAU;gBAA0C,aAAa;;;;;;0BACzE,qQAAC;gBAAK,WAAU;0BAAiB;;;;;;0BACjC,qQAAC;gBAAK,WAAU;0BACb,eAAe,QAAQ;;;;;;;;;;;;AAIhC"}},
    {"offset": {"line": 2609, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAIA,MAAM,yBAAW,0OAAgB,CAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,qQAAC;QACC,WAAW,IAAA,gJAAE,EACX,+RACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 2636, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/document-upload-dialog.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useCallback, useEffect } from 'react'\r\nimport { useDropzone } from 'react-dropzone'\r\nimport { Upload, X, FileText, AlertCircle, Loader2, CheckCircle2, Folder } from 'lucide-react'\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { toast } from 'sonner'\r\nimport { cn } from '@/lib/utils'\r\nimport { DocumentFolder } from '@/types/documents'\r\n\r\ninterface DocumentUploadDialogProps {\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  folderId?: string | null\r\n  vehicleId?: string | null\r\n  currentFolder?: DocumentFolder | null\r\n  onSuccess?: () => void\r\n}\r\n\r\ninterface FileWithMetadata extends File {\r\n  id: string\r\n  progress: number\r\n  status: 'pending' | 'uploading' | 'success' | 'error'\r\n  error?: string\r\n}\r\n\r\nexport function DocumentUploadDialog({\r\n  open,\r\n  onOpenChange,\r\n  folderId,\r\n  vehicleId,\r\n  currentFolder,\r\n  onSuccess\r\n}: DocumentUploadDialogProps) {\r\n  const [files, setFiles] = useState<FileWithMetadata[]>([])\r\n  const [documentType, setDocumentType] = useState('Other')\r\n  const [tags, setTags] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const [uploading, setUploading] = useState(false)\r\n  const [selectedFolderId, setSelectedFolderId] = useState<string | null>(folderId || null)\r\n  const [folders, setFolders] = useState<DocumentFolder[]>([])\r\n  const [loadingFolders, setLoadingFolders] = useState(false)\r\n\r\n  // Fetch available folders\r\n  useEffect(() => {\r\n    if (!open) return\r\n\r\n    const fetchFolders = async () => {\r\n      setLoadingFolders(true)\r\n      try {\r\n        const response = await fetch('/api/staff/documents/folders')\r\n        if (response.ok) {\r\n          const data = await response.json()\r\n          setFolders(data.folders || [])\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching folders:', error)\r\n      } finally {\r\n        setLoadingFolders(false)\r\n      }\r\n    }\r\n\r\n    fetchFolders()\r\n  }, [open])\r\n\r\n  // Reset selected folder when folderId prop changes\r\n  useEffect(() => {\r\n    setSelectedFolderId(folderId || null)\r\n  }, [folderId])\r\n\r\n  const onDrop = useCallback((acceptedFiles: File[]) => {\r\n    const newFiles: FileWithMetadata[] = acceptedFiles.map((file, index) => ({\r\n      ...file,\r\n      id: `${Date.now()}-${index}`,\r\n      progress: 0,\r\n      status: 'pending' as const\r\n    }))\r\n    setFiles(prev => [...prev, ...newFiles])\r\n  }, [])\r\n\r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop,\r\n    accept: {\r\n      'application/pdf': ['.pdf'],\r\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx'],\r\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx'],\r\n      'text/plain': ['.txt'],\r\n      'image/jpeg': ['.jpg', '.jpeg'],\r\n      'image/png': ['.png']\r\n    },\r\n    maxSize: 50 * 1024 * 1024, // 50MB\r\n    disabled: uploading\r\n  })\r\n\r\n  const removeFile = (fileId: string) => {\r\n    setFiles(files.filter(f => f.id !== fileId))\r\n  }\r\n\r\n  const uploadFiles = async () => {\r\n    if (files.length === 0) {\r\n      toast.error('Please select at least one file')\r\n      return\r\n    }\r\n\r\n    setUploading(true)\r\n\r\n    // Track results during the loop (not relying on React state)\r\n    let successCount = 0\r\n    let failedCount = 0\r\n    const totalFiles = files.length\r\n\r\n    try {\r\n      // Upload files one by one for better progress tracking\r\n      for (const file of files) {\r\n        const formData = new FormData()\r\n        formData.append('file', file)\r\n        formData.append('type', documentType)\r\n        formData.append('tags', tags)\r\n        formData.append('description', description)\r\n        if (selectedFolderId) formData.append('folder_id', selectedFolderId)\r\n        if (vehicleId) formData.append('vehicle_id', vehicleId)\r\n\r\n        // Update file status\r\n        setFiles(prev => prev.map(f =>\r\n          f.id === file.id ? { ...f, status: 'uploading' as const } : f\r\n        ))\r\n\r\n        try {\r\n          const response = await fetch('/api/documents/upload', {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n\r\n          if (!response.ok) {\r\n            throw new Error('Upload failed')\r\n          }\r\n\r\n          // Mark as success\r\n          setFiles(prev => prev.map(f =>\r\n            f.id === file.id ? { ...f, status: 'success' as const, progress: 100 } : f\r\n          ))\r\n          successCount++\r\n\r\n        } catch (error) {\r\n          // Mark as error\r\n          setFiles(prev => prev.map(f =>\r\n            f.id === file.id\r\n              ? { ...f, status: 'error' as const, error: 'Upload failed' }\r\n              : f\r\n          ))\r\n          failedCount++\r\n          console.error(`Error uploading ${file.name}:`, error)\r\n        }\r\n      }\r\n\r\n      // Check results using tracked counts (not stale React state)\r\n      if (failedCount === 0) {\r\n        toast.success(`Successfully uploaded ${totalFiles} file(s)`)\r\n        onSuccess?.()\r\n        handleClose()\r\n      } else {\r\n        toast.error(`${failedCount} file(s) failed to upload`)\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Upload error:', error)\r\n      toast.error('Failed to upload files')\r\n    } finally {\r\n      setUploading(false)\r\n    }\r\n  }\r\n\r\n  const handleClose = () => {\r\n    if (!uploading) {\r\n      setFiles([])\r\n      setDocumentType('Other')\r\n      setTags('')\r\n      setDescription('')\r\n      onOpenChange(false)\r\n    }\r\n  }\r\n\r\n  const formatFileSize = (bytes: number) => {\r\n    if (bytes === 0) return '0 Bytes'\r\n    const k = 1024\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB']\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n    return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i]\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleClose}>\r\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>Upload Documents</DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          {/* Drag and Drop Area */}\r\n          <div\r\n            {...getRootProps()}\r\n            className={cn(\r\n              'border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors',\r\n              isDragActive\r\n                ? 'border-blue-500 bg-blue-50'\r\n                : 'border-gray-300 hover:border-gray-400',\r\n              uploading && 'opacity-50 cursor-not-allowed'\r\n            )}\r\n          >\r\n            <input {...getInputProps()} />\r\n            <Upload className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\r\n            {isDragActive ? (\r\n              <p className=\"text-sm text-gray-600\">Drop files here...</p>\r\n            ) : (\r\n              <>\r\n                <p className=\"text-sm text-gray-600 mb-1\">\r\n                  Drag & drop files here, or click to select\r\n                </p>\r\n                <p className=\"text-xs text-gray-500\">\r\n                  Supported: PDF, DOCX, XLSX, TXT, JPG, PNG (max 50MB each)\r\n                </p>\r\n              </>\r\n            )}\r\n          </div>\r\n\r\n          {/* File List */}\r\n          {files.length > 0 && (\r\n            <div className=\"space-y-2\">\r\n              <Label>Selected Files ({files.length})</Label>\r\n              <div className=\"border rounded-lg divide-y max-h-48 overflow-y-auto\">\r\n                {files.map((file) => (\r\n                  <div key={file.id} className=\"flex items-center gap-3 p-3\">\r\n                    <FileText className=\"h-5 w-5 text-gray-400 flex-shrink-0\" />\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <p className=\"text-sm font-medium truncate\">{file.name}</p>\r\n                      <p className=\"text-xs text-gray-500\">\r\n                        {formatFileSize(file.size)}\r\n                      </p>\r\n                    </div>\r\n                    {file.status === 'uploading' && (\r\n                      <Loader2 className=\"h-4 w-4 animate-spin text-blue-500\" />\r\n                    )}\r\n                    {file.status === 'success' && (\r\n                      <CheckCircle2 className=\"h-4 w-4 text-green-500\" />\r\n                    )}\r\n                    {file.status === 'error' && (\r\n                      <AlertCircle className=\"h-4 w-4 text-red-500\" />\r\n                    )}\r\n                    {file.status === 'pending' && !uploading && (\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => removeFile(file.id)}\r\n                        className=\"h-6 w-6 p-0\"\r\n                      >\r\n                        <X className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Metadata Fields */}\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"document-type\">Document Type</Label>\r\n              <Select value={documentType} onValueChange={setDocumentType} disabled={uploading}>\r\n                <SelectTrigger id=\"document-type\">\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"Agreement\">Agreement</SelectItem>\r\n                  <SelectItem value=\"Subscription\">Subscription</SelectItem>\r\n                  <SelectItem value=\"KYC\">KYC</SelectItem>\r\n                  <SelectItem value=\"Statement\">Statement</SelectItem>\r\n                  <SelectItem value=\"NDA\">NDA</SelectItem>\r\n                  <SelectItem value=\"Report\">Report</SelectItem>\r\n                  <SelectItem value=\"Tax\">Tax</SelectItem>\r\n                  <SelectItem value=\"Legal\">Legal</SelectItem>\r\n                  <SelectItem value=\"Other\">Other</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"folder\">Destination Folder</Label>\r\n              <Select\r\n                value={selectedFolderId || 'root'}\r\n                onValueChange={(value) => setSelectedFolderId(value === 'root' ? null : value)}\r\n                disabled={uploading || loadingFolders}\r\n              >\r\n                <SelectTrigger id=\"folder\">\r\n                  <SelectValue>\r\n                    {loadingFolders ? (\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                        Loading folders...\r\n                      </span>\r\n                    ) : selectedFolderId ? (\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <Folder className=\"h-4 w-4\" />\r\n                        {folders.find(f => f.id === selectedFolderId)?.path || 'Unknown folder'}\r\n                      </span>\r\n                    ) : (\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <Folder className=\"h-4 w-4\" />\r\n                        Root / No Folder\r\n                      </span>\r\n                    )}\r\n                  </SelectValue>\r\n                </SelectTrigger>\r\n                <SelectContent className=\"max-h-[300px]\">\r\n                  <SelectItem value=\"root\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <Folder className=\"h-4 w-4\" />\r\n                      Root / No Folder\r\n                    </span>\r\n                  </SelectItem>\r\n                  {folders.map((folder) => {\r\n                    const depth = (folder.path.match(/\\//g) || []).length - 1\r\n                    return (\r\n                      <SelectItem key={folder.id} value={folder.id}>\r\n                        <span className=\"flex items-center gap-2\" style={{ paddingLeft: `${depth * 16}px` }}>\r\n                          <Folder className=\"h-4 w-4 flex-shrink-0\" />\r\n                          <span className=\"truncate\">{folder.path}</span>\r\n                        </span>\r\n                      </SelectItem>\r\n                    )\r\n                  })}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"tags\">Tags (comma-separated)</Label>\r\n              <Input\r\n                id=\"tags\"\r\n                placeholder=\"quarterly, 2024, financial\"\r\n                value={tags}\r\n                onChange={(e) => setTags(e.target.value)}\r\n                disabled={uploading}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"description\">Description (optional)</Label>\r\n              <Textarea\r\n                id=\"description\"\r\n                placeholder=\"Add a description for these documents...\"\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n                disabled={uploading}\r\n                rows={3}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={handleClose} disabled={uploading}>\r\n            Cancel\r\n          </Button>\r\n          <Button onClick={uploadFiles} disabled={files.length === 0 || uploading}>\r\n            {uploading ? (\r\n              <>\r\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                Uploading...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Upload className=\"h-4 w-4 mr-2\" />\r\n                Upload {files.length} File{files.length !== 1 ? 's' : ''}\r\n              </>\r\n            )}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3430, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/move-document-dialog.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { FolderTree, Loader2 } from 'lucide-react'\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Label } from '@/components/ui/label'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue\r\n} from '@/components/ui/select'\r\nimport { toast } from 'sonner'\r\n\r\ninterface MoveDocumentDialogProps {\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  documentId: string | null\r\n  documentName?: string\r\n  currentFolderId?: string | null\r\n  onSuccess?: () => void\r\n}\r\n\r\ninterface Folder {\r\n  id: string\r\n  name: string\r\n  path: string\r\n  folder_type: string\r\n}\r\n\r\nexport function MoveDocumentDialog({\r\n  open,\r\n  onOpenChange,\r\n  documentId,\r\n  documentName,\r\n  currentFolderId,\r\n  onSuccess\r\n}: MoveDocumentDialogProps) {\r\n  const [folders, setFolders] = useState<Folder[]>([])\r\n  const [selectedFolderId, setSelectedFolderId] = useState<string>('')\r\n  const [loading, setLoading] = useState(false)\r\n  const [moving, setMoving] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (open) {\r\n      loadFolders()\r\n    }\r\n  }, [open])\r\n\r\n  const loadFolders = async () => {\r\n    try {\r\n      setLoading(true)\r\n      const response = await fetch('/api/staff/documents/folders')\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        setFolders(data.folders || [])\r\n      } else {\r\n        toast.error('Failed to load folders')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading folders:', error)\r\n      toast.error('Failed to load folders')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleMove = async () => {\r\n    if (!documentId) return\r\n\r\n    try {\r\n      setMoving(true)\r\n      // Convert \"__root__\" placeholder to null for the API\r\n      const folderId = selectedFolderId === '__root__' ? null : selectedFolderId || null\r\n      const response = await fetch(`/api/staff/documents/${documentId}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          folder_id: folderId\r\n        })\r\n      })\r\n\r\n      if (response.ok) {\r\n        toast.success('Document moved successfully')\r\n        onSuccess?.()\r\n        onOpenChange(false)\r\n      } else {\r\n        const error = await response.json()\r\n        toast.error(error.error || 'Failed to move document')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error moving document:', error)\r\n      toast.error('Failed to move document')\r\n    } finally {\r\n      setMoving(false)\r\n    }\r\n  }\r\n\r\n  // Filter out current folder\r\n  const availableFolders = folders.filter(f => f.id !== currentFolderId)\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent>\r\n        <DialogHeader>\r\n          <DialogTitle>Move Document - {documentName}</DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label>Select Destination Folder</Label>\r\n            {loading ? (\r\n              <div className=\"text-center py-4\">\r\n                <Loader2 className=\"h-6 w-6 animate-spin mx-auto text-blue-500\" />\r\n              </div>\r\n            ) : (\r\n              <Select value={selectedFolderId} onValueChange={setSelectedFolderId}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Select a folder...\" />\r\n                </SelectTrigger>\r\n                <SelectContent className=\"max-h-80\">\r\n                  <SelectItem value=\"__root__\">\r\n                    Root (No Folder)\r\n                  </SelectItem>\r\n                  {availableFolders.map(folder => (\r\n                    <SelectItem key={folder.id} value={folder.id}>\r\n                      {folder.path}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            )}\r\n          </div>\r\n\r\n          {currentFolderId && (\r\n            <p className=\"text-sm text-gray-500\">\r\n              Current: {folders.find(f => f.id === currentFolderId)?.path || 'Root'}\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n            Cancel\r\n          </Button>\r\n          <Button onClick={handleMove} disabled={!selectedFolderId || moving}>\r\n            {moving ? (\r\n              <>\r\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                Moving...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <FolderTree className=\"h-4 w-4 mr-2\" />\r\n                Move\r\n              </>\r\n            )}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3695, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/create-folder-dialog.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { FolderPlus, Loader2 } from 'lucide-react'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { toast } from 'sonner'\n\ninterface CreateFolderDialogProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  parentFolderId?: string | null\n  onSuccess?: () => void\n}\n\nexport function CreateFolderDialog({\n  open,\n  onOpenChange,\n  parentFolderId,\n  onSuccess\n}: CreateFolderDialogProps) {\n  const [folderName, setFolderName] = useState('')\n  const [creating, setCreating] = useState(false)\n\n  const handleCreate = async () => {\n    if (!folderName.trim()) {\n      toast.error('Please enter a folder name')\n      return\n    }\n\n    try {\n      setCreating(true)\n      const payload = {\n        name: folderName.trim(),\n        folder_type: 'custom' as const,\n        ...(parentFolderId && { parent_folder_id: parentFolderId })\n      }\n\n      const response = await fetch('/api/staff/documents/folders', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      })\n\n      const responseText = await response.text()\n      \n      if (response.ok) {\n        toast.success('Folder created successfully')\n        setFolderName('')\n        onSuccess?.()\n        onOpenChange(false)\n      } else {\n        interface ErrorResponse {\n          error?: string\n          details?: unknown\n        }\n\n        let error: ErrorResponse = {}\n        try {\n          error = JSON.parse(responseText)\n        } catch (e) {\n          error = { error: responseText || 'Unknown error' }\n        }\n        console.error('[CreateFolder] Error response:', error)\n        const errorMsg = error.details\n          ? `${error.error}: ${JSON.stringify(error.details)}`\n          : error.error || 'Failed to create folder'\n        toast.error(errorMsg)\n      }\n    } catch (error) {\n      console.error('Error creating folder:', error)\n      toast.error('Failed to create folder')\n    } finally {\n      setCreating(false)\n    }\n  }\n\n  const handleClose = () => {\n    if (!creating) {\n      setFolderName('')\n      onOpenChange(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {parentFolderId ? 'Create Subfolder' : 'Create Folder'}\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"folder-name\">Folder Name</Label>\n            <Input\n              id=\"folder-name\"\n              placeholder=\"Enter folder name...\"\n              value={folderName}\n              onChange={(e) => setFolderName(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter' && !creating) {\n                  handleCreate()\n                }\n              }}\n              disabled={creating}\n              autoFocus\n            />\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={handleClose} disabled={creating}>\n            Cancel\n          </Button>\n          <Button onClick={handleCreate} disabled={!folderName.trim() || creating}>\n            {creating ? (\n              <>\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                Creating...\n              </>\n            ) : (\n              <>\n                <FolderPlus className=\"h-4 w-4 mr-2\" />\n                Create Folder\n              </>\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAiBO,SAAS,mBAAmB,EACjC,IAAI,EACJ,YAAY,EACZ,cAAc,EACd,SAAS,EACe;IACxB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,wOAAQ,EAAC;IAC7C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wOAAQ,EAAC;IAEzC,MAAM,eAAe;QACnB,IAAI,CAAC,WAAW,IAAI,IAAI;YACtB,wKAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,IAAI;YACF,YAAY;YACZ,MAAM,UAAU;gBACd,MAAM,WAAW,IAAI;gBACrB,aAAa;gBACb,GAAI,kBAAkB;oBAAE,kBAAkB;gBAAe,CAAC;YAC5D;YAEA,MAAM,WAAW,MAAM,MAAM,gCAAgC;gBAC3D,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,MAAM,eAAe,MAAM,SAAS,IAAI;YAExC,IAAI,SAAS,EAAE,EAAE;gBACf,wKAAK,CAAC,OAAO,CAAC;gBACd,cAAc;gBACd;gBACA,aAAa;YACf,OAAO;gBAML,IAAI,QAAuB,CAAC;gBAC5B,IAAI;oBACF,QAAQ,KAAK,KAAK,CAAC;gBACrB,EAAE,OAAO,GAAG;oBACV,QAAQ;wBAAE,OAAO,gBAAgB;oBAAgB;gBACnD;gBACA,QAAQ,KAAK,CAAC,kCAAkC;gBAChD,MAAM,WAAW,MAAM,OAAO,GAC1B,GAAG,MAAM,KAAK,CAAC,EAAE,EAAE,KAAK,SAAS,CAAC,MAAM,OAAO,GAAG,GAClD,MAAM,KAAK,IAAI;gBACnB,wKAAK,CAAC,KAAK,CAAC;YACd;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,wKAAK,CAAC,KAAK,CAAC;QACd,SAAU;YACR,YAAY;QACd;IACF;IAEA,MAAM,cAAc;QAClB,IAAI,CAAC,UAAU;YACb,cAAc;YACd,aAAa;QACf;IACF;IAEA,qBACE,qQAAC,mKAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,qQAAC,0KAAa;;8BACZ,qQAAC,yKAAY;8BACX,cAAA,qQAAC,wKAAW;kCACT,iBAAiB,qBAAqB;;;;;;;;;;;8BAI3C,qQAAC;oBAAI,WAAU;8BACb,cAAA,qQAAC;wBAAI,WAAU;;0CACb,qQAAC,iKAAK;gCAAC,SAAQ;0CAAc;;;;;;0CAC7B,qQAAC,iKAAK;gCACJ,IAAG;gCACH,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;gCAC7C,WAAW,CAAC;oCACV,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,UAAU;wCAClC;oCACF;gCACF;gCACA,UAAU;gCACV,SAAS;;;;;;;;;;;;;;;;;8BAKf,qQAAC,yKAAY;;sCACX,qQAAC,mKAAM;4BAAC,SAAQ;4BAAU,SAAS;4BAAa,UAAU;sCAAU;;;;;;sCAGpE,qQAAC,mKAAM;4BAAC,SAAS;4BAAc,UAAU,CAAC,WAAW,IAAI,MAAM;sCAC5D,yBACC;;kDACE,qQAAC,mPAAO;wCAAC,WAAU;;;;;;oCAA8B;;6DAInD;;kDACE,qQAAC,uPAAU;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;;;;;;;;;;;;;;;;;;;AASvD"}},
    {"offset": {"line": 3897, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/rename-folder-dialog.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { toast } from 'sonner'\r\n\r\ninterface RenameFolderDialogProps {\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  folderId: string | null\r\n  currentName: string\r\n  onSuccess: () => void\r\n}\r\n\r\nexport function RenameFolderDialog({\r\n  open,\r\n  onOpenChange,\r\n  folderId,\r\n  currentName,\r\n  onSuccess,\r\n}: RenameFolderDialogProps) {\r\n  const [newName, setNewName] = useState(currentName)\r\n  const [isSubmitting, setIsSubmitting] = useState(false)\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n\r\n    if (!folderId || !newName.trim()) {\r\n      toast.error('Folder name is required')\r\n      return\r\n    }\r\n\r\n    if (newName.trim() === currentName) {\r\n      toast.info('Name unchanged')\r\n      onOpenChange(false)\r\n      return\r\n    }\r\n\r\n    setIsSubmitting(true)\r\n\r\n    try {\r\n      const response = await fetch(`/api/staff/documents/folders/${folderId}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ name: newName.trim() }),\r\n      })\r\n\r\n      if (response.ok) {\r\n        toast.success('Folder renamed successfully')\r\n        onSuccess()\r\n        onOpenChange(false)\r\n        setNewName('')\r\n      } else {\r\n        const errorData = await response.json().catch(() => ({ error: 'Unknown error' }))\r\n        const errorMsg = errorData.details || errorData.error || 'Unknown error'\r\n        toast.error(`Failed to rename folder: ${errorMsg}`)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error renaming folder:', error)\r\n      toast.error('Failed to rename folder')\r\n    } finally {\r\n      setIsSubmitting(false)\r\n    }\r\n  }\r\n\r\n  // Reset name when dialog opens\r\n  const handleOpenChange = (open: boolean) => {\r\n    if (open) {\r\n      setNewName(currentName)\r\n    }\r\n    onOpenChange(open)\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogContent className=\"bg-zinc-900 border-white/10 text-white\">\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogHeader>\r\n            <DialogTitle className=\"text-white\">Rename Folder</DialogTitle>\r\n            <DialogDescription className=\"text-gray-400\">\r\n              Enter a new name for this folder\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"py-4\">\r\n            <Label htmlFor=\"folder-name\" className=\"text-white\">\r\n              Folder Name\r\n            </Label>\r\n            <Input\r\n              id=\"folder-name\"\r\n              value={newName}\r\n              onChange={(e) => setNewName(e.target.value)}\r\n              placeholder=\"Enter folder name\"\r\n              className=\"mt-2 bg-white/5 border-white/10 text-white placeholder:text-gray-500\"\r\n              disabled={isSubmitting}\r\n              autoFocus\r\n            />\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              onClick={() => onOpenChange(false)}\r\n              disabled={isSubmitting}\r\n              className=\"border-white/20 text-white hover:bg-white/10\"\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              type=\"submit\"\r\n              disabled={isSubmitting || !newName.trim()}\r\n              className=\"bg-blue-600 hover:bg-blue-700 text-white\"\r\n            >\r\n              {isSubmitting ? 'Renaming...' : 'Rename'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAQA;AACA;AACA;AAdA;;;;;;;;AAwBO,SAAS,mBAAmB,EACjC,IAAI,EACJ,YAAY,EACZ,QAAQ,EACR,WAAW,EACX,SAAS,EACe;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wOAAQ,EAAC;IACvC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,wOAAQ,EAAC;IAEjD,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAEhB,IAAI,CAAC,YAAY,CAAC,QAAQ,IAAI,IAAI;YAChC,wKAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,IAAI,QAAQ,IAAI,OAAO,aAAa;YAClC,wKAAK,CAAC,IAAI,CAAC;YACX,aAAa;YACb;QACF;QAEA,gBAAgB;QAEhB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,CAAC,6BAA6B,EAAE,UAAU,EAAE;gBACvE,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,MAAM,QAAQ,IAAI;gBAAG;YAC9C;YAEA,IAAI,SAAS,EAAE,EAAE;gBACf,wKAAK,CAAC,OAAO,CAAC;gBACd;gBACA,aAAa;gBACb,WAAW;YACb,OAAO;gBACL,MAAM,YAAY,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;wBAAE,OAAO;oBAAgB,CAAC;gBAC/E,MAAM,WAAW,UAAU,OAAO,IAAI,UAAU,KAAK,IAAI;gBACzD,wKAAK,CAAC,KAAK,CAAC,CAAC,yBAAyB,EAAE,UAAU;YACpD;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,wKAAK,CAAC,KAAK,CAAC;QACd,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,+BAA+B;IAC/B,MAAM,mBAAmB,CAAC;QACxB,IAAI,MAAM;YACR,WAAW;QACb;QACA,aAAa;IACf;IAEA,qBACE,qQAAC,mKAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,qQAAC,0KAAa;YAAC,WAAU;sBACvB,cAAA,qQAAC;gBAAK,UAAU;;kCACd,qQAAC,yKAAY;;0CACX,qQAAC,wKAAW;gCAAC,WAAU;0CAAa;;;;;;0CACpC,qQAAC,8KAAiB;gCAAC,WAAU;0CAAgB;;;;;;;;;;;;kCAK/C,qQAAC;wBAAI,WAAU;;0CACb,qQAAC,iKAAK;gCAAC,SAAQ;gCAAc,WAAU;0CAAa;;;;;;0CAGpD,qQAAC,iKAAK;gCACJ,IAAG;gCACH,OAAO;gCACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;gCAC1C,aAAY;gCACZ,WAAU;gCACV,UAAU;gCACV,SAAS;;;;;;;;;;;;kCAIb,qQAAC,yKAAY;;0CACX,qQAAC,mKAAM;gCACL,MAAK;gCACL,SAAQ;gCACR,SAAS,IAAM,aAAa;gCAC5B,UAAU;gCACV,WAAU;0CACX;;;;;;0CAGD,qQAAC,mKAAM;gCACL,MAAK;gCACL,UAAU,gBAAgB,CAAC,QAAQ,IAAI;gCACvC,WAAU;0CAET,eAAe,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO9C"}},
    {"offset": {"line": 4081, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/rename-document-dialog.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { toast } from 'sonner'\r\n\r\ninterface RenameDocumentDialogProps {\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  documentId: string | null\r\n  currentName: string\r\n  onSuccess: () => void\r\n}\r\n\r\nexport function RenameDocumentDialog({\r\n  open,\r\n  onOpenChange,\r\n  documentId,\r\n  currentName,\r\n  onSuccess,\r\n}: RenameDocumentDialogProps) {\r\n  const [newName, setNewName] = useState(currentName)\r\n  const [isSubmitting, setIsSubmitting] = useState(false)\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n\r\n    if (!documentId || !newName.trim()) {\r\n      toast.error('Document name is required')\r\n      return\r\n    }\r\n\r\n    if (newName.trim() === currentName) {\r\n      toast.info('Name unchanged')\r\n      onOpenChange(false)\r\n      return\r\n    }\r\n\r\n    setIsSubmitting(true)\r\n\r\n    try {\r\n      const response = await fetch(`/api/staff/documents/${documentId}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ name: newName.trim() }),\r\n      })\r\n\r\n      if (response.ok) {\r\n        toast.success('Document renamed successfully')\r\n        onSuccess()\r\n        onOpenChange(false)\r\n        setNewName('')\r\n      } else {\r\n        const errorData = await response.json().catch(() => ({ error: 'Unknown error' }))\r\n        const errorMsg = errorData.details || errorData.error || 'Unknown error'\r\n        toast.error(`Failed to rename document: ${errorMsg}`)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error renaming document:', error)\r\n      toast.error('Failed to rename document')\r\n    } finally {\r\n      setIsSubmitting(false)\r\n    }\r\n  }\r\n\r\n  // Reset name when dialog opens\r\n  const handleOpenChange = (open: boolean) => {\r\n    if (open) {\r\n      setNewName(currentName)\r\n    }\r\n    onOpenChange(open)\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogContent className=\"bg-zinc-900 border-white/10 text-white\">\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogHeader>\r\n            <DialogTitle className=\"text-white\">Rename Document</DialogTitle>\r\n            <DialogDescription className=\"text-gray-400\">\r\n              Enter a new name for this document\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"py-4\">\r\n            <Label htmlFor=\"document-name\" className=\"text-white\">\r\n              Document Name\r\n            </Label>\r\n            <Input\r\n              id=\"document-name\"\r\n              value={newName}\r\n              onChange={(e) => setNewName(e.target.value)}\r\n              placeholder=\"Enter document name\"\r\n              className=\"mt-2 bg-white/5 border-white/10 text-white placeholder:text-gray-500\"\r\n              disabled={isSubmitting}\r\n              autoFocus\r\n            />\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              onClick={() => onOpenChange(false)}\r\n              disabled={isSubmitting}\r\n              className=\"border-white/20 text-white hover:bg-white/10\"\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              type=\"submit\"\r\n              disabled={isSubmitting || !newName.trim()}\r\n              className=\"bg-blue-600 hover:bg-blue-700 text-white\"\r\n            >\r\n              {isSubmitting ? 'Renaming...' : 'Rename'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAQA;AACA;AACA;AAdA;;;;;;;;AAwBO,SAAS,qBAAqB,EACnC,IAAI,EACJ,YAAY,EACZ,UAAU,EACV,WAAW,EACX,SAAS,EACiB;IAC1B,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wOAAQ,EAAC;IACvC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,wOAAQ,EAAC;IAEjD,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAEhB,IAAI,CAAC,cAAc,CAAC,QAAQ,IAAI,IAAI;YAClC,wKAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,IAAI,QAAQ,IAAI,OAAO,aAAa;YAClC,wKAAK,CAAC,IAAI,CAAC;YACX,aAAa;YACb;QACF;QAEA,gBAAgB;QAEhB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,CAAC,qBAAqB,EAAE,YAAY,EAAE;gBACjE,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,MAAM,QAAQ,IAAI;gBAAG;YAC9C;YAEA,IAAI,SAAS,EAAE,EAAE;gBACf,wKAAK,CAAC,OAAO,CAAC;gBACd;gBACA,aAAa;gBACb,WAAW;YACb,OAAO;gBACL,MAAM,YAAY,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;wBAAE,OAAO;oBAAgB,CAAC;gBAC/E,MAAM,WAAW,UAAU,OAAO,IAAI,UAAU,KAAK,IAAI;gBACzD,wKAAK,CAAC,KAAK,CAAC,CAAC,2BAA2B,EAAE,UAAU;YACtD;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,wKAAK,CAAC,KAAK,CAAC;QACd,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,+BAA+B;IAC/B,MAAM,mBAAmB,CAAC;QACxB,IAAI,MAAM;YACR,WAAW;QACb;QACA,aAAa;IACf;IAEA,qBACE,qQAAC,mKAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,qQAAC,0KAAa;YAAC,WAAU;sBACvB,cAAA,qQAAC;gBAAK,UAAU;;kCACd,qQAAC,yKAAY;;0CACX,qQAAC,wKAAW;gCAAC,WAAU;0CAAa;;;;;;0CACpC,qQAAC,8KAAiB;gCAAC,WAAU;0CAAgB;;;;;;;;;;;;kCAK/C,qQAAC;wBAAI,WAAU;;0CACb,qQAAC,iKAAK;gCAAC,SAAQ;gCAAgB,WAAU;0CAAa;;;;;;0CAGtD,qQAAC,iKAAK;gCACJ,IAAG;gCACH,OAAO;gCACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;gCAC1C,aAAY;gCACZ,WAAU;gCACV,UAAU;gCACV,SAAS;;;;;;;;;;;;kCAIb,qQAAC,yKAAY;;0CACX,qQAAC,mKAAM;gCACL,MAAK;gCACL,SAAQ;gCACR,SAAS,IAAM,aAAa;gCAC5B,UAAU;gCACV,WAAU;0CACX;;;;;;0CAGD,qQAAC,mKAAM;gCACL,MAAK;gCACL,UAAU,gBAAgB,CAAC,QAAQ,IAAI;gCACvC,WAAU;0CAET,eAAe,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO9C"}},
    {"offset": {"line": 4265, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/types/document-viewer.types.ts"],"sourcesContent":["/**\r\n * Type definitions for the document viewer system\r\n */\r\n\r\n/**\r\n * Minimal document reference needed for preview\r\n * Flexible to support different document sources (general docs, entity docs, deal docs, etc.)\r\n */\r\nexport interface DocumentReference {\r\n  id: string\r\n  file_name?: string | null  // Optional to support different document types\r\n  name?: string | null       // Some documents use 'name' instead of 'file_name'\r\n  mime_type?: string | null\r\n  file_size_bytes?: number | null\r\n  type?: string | null\r\n  [key: string]: any // Allow additional properties\r\n}\r\n\r\n/**\r\n * Response from document download/preview API endpoints\r\n */\r\nexport interface DocumentUrlResponse {\r\n  download_url: string\r\n  mode?: 'preview' | 'download'\r\n  document: {\r\n    id: string\r\n    name: string\r\n    type: string\r\n    file_key?: string\r\n    external_url?: string\r\n    [key: string]: any\r\n  }\r\n  watermark?: {\r\n    uploaded_by?: string\r\n    uploaded_at?: string\r\n    document_classification?: string\r\n    [key: string]: any\r\n  }\r\n  expires_in_seconds: number\r\n}\r\n\r\n/**\r\n * State shape for document viewer\r\n */\r\nexport interface DocumentViewerState {\r\n  isOpen: boolean\r\n  document: DocumentReference | null\r\n  previewUrl: string | null\r\n  isLoading: boolean\r\n  error: string | null\r\n}\r\n\r\n/**\r\n * Custom error class for document operations\r\n */\r\nexport class DocumentError extends Error {\r\n  constructor(\r\n    message: string,\r\n    public statusCode: number,\r\n    public originalError?: any\r\n  ) {\r\n    super(message)\r\n    this.name = 'DocumentError'\r\n  }\r\n}\r\n\r\n/**\r\n * Options for opening a document preview\r\n */\r\nexport interface PreviewOptions {\r\n  /** Force download mode instead of preview */\r\n  forceDownload?: boolean\r\n  /** Custom error handler */\r\n  onError?: (error: DocumentError) => void\r\n  /** Success callback after preview opens */\r\n  onSuccess?: () => void\r\n}\r\n"],"names":[],"mappings":"AAAA;;CAEC,GAED;;;CAGC;;;;AAgDM,MAAM,sBAAsB;;;IACjC,YACE,OAAe,EACf,AAAO,UAAkB,EACzB,AAAO,aAAmB,CAC1B;QACA,KAAK,CAAC,eAHC,aAAA,iBACA,gBAAA;QAGP,IAAI,CAAC,IAAI,GAAG;IACd;AACF"}},
    {"offset": {"line": 4286, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/services/document.service.ts"],"sourcesContent":["/**\r\n * Document Service\r\n * Centralized service for all document-related API operations\r\n */\r\n\r\nimport { DocumentError, DocumentUrlResponse } from '@/types/document-viewer.types'\r\n\r\nexport class DocumentService {\r\n  /**\r\n   * Validate that a URL is a valid storage URL from Supabase\r\n   */\r\n  private static isValidStorageUrl(url: string): boolean {\r\n    if (!url) return false\r\n\r\n    // Check if it's a valid HTTPS URL\r\n    if (!url.startsWith('https://')) return false\r\n\r\n    // Check if it's from Supabase storage or a blob URL\r\n    return (\r\n      url.includes('supabase.co/storage') ||\r\n      url.includes('supabase.com/storage') ||\r\n      url.startsWith('blob:')\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Parse and validate API response\r\n   */\r\n  private static async parseResponse(\r\n    response: Response\r\n  ): Promise<DocumentUrlResponse> {\r\n    let data: any\r\n\r\n    try {\r\n      data = await response.json()\r\n    } catch (e) {\r\n      throw new DocumentError(\r\n        'Invalid response from server',\r\n        response.status,\r\n        e\r\n      )\r\n    }\r\n\r\n    // Check for error response\r\n    if (!response.ok) {\r\n      const errorMessage = data.error || data.message || 'Failed to load document'\r\n      throw new DocumentError(errorMessage, response.status, data)\r\n    }\r\n\r\n    // Validate required fields - check for both 'url' and 'download_url' for compatibility\r\n    const downloadUrl = data.url || data.download_url\r\n    if (!downloadUrl) {\r\n      throw new DocumentError(\r\n        'No download URL in response',\r\n        500,\r\n        data\r\n      )\r\n    }\r\n\r\n    // Validate URL format\r\n    if (!this.isValidStorageUrl(downloadUrl)) {\r\n      throw new DocumentError(\r\n        'Invalid download URL format',\r\n        500,\r\n        data\r\n      )\r\n    }\r\n\r\n    // Normalize response to always have both fields for compatibility\r\n    data.url = downloadUrl\r\n    data.download_url = downloadUrl\r\n\r\n    return data as DocumentUrlResponse\r\n  }\r\n\r\n  /**\r\n   * Get preview URL for a general document\r\n   */\r\n  static async getPreviewUrl(documentId: string): Promise<DocumentUrlResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `/api/documents/${documentId}/download?mode=preview`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      )\r\n\r\n      return await this.parseResponse(response)\r\n    } catch (error) {\r\n      if (error instanceof DocumentError) {\r\n        throw error\r\n      }\r\n\r\n      throw new DocumentError(\r\n        'Network error while loading preview',\r\n        0,\r\n        error\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get download URL for a general document\r\n   */\r\n  static async getDownloadUrl(documentId: string): Promise<DocumentUrlResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `/api/documents/${documentId}/download?mode=download`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      )\r\n\r\n      return await this.parseResponse(response)\r\n    } catch (error) {\r\n      if (error instanceof DocumentError) {\r\n        throw error\r\n      }\r\n\r\n      throw new DocumentError(\r\n        'Network error while loading download',\r\n        0,\r\n        error\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get preview URL for a deal data room document\r\n   */\r\n  static async getDealDocumentPreviewUrl(\r\n    dealId: string,\r\n    documentId: string\r\n  ): Promise<DocumentUrlResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `/api/deals/${dealId}/documents/${documentId}/download?mode=preview`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      )\r\n\r\n      return await this.parseResponse(response)\r\n    } catch (error) {\r\n      if (error instanceof DocumentError) {\r\n        throw error\r\n      }\r\n\r\n      throw new DocumentError(\r\n        'Network error while loading deal document preview',\r\n        0,\r\n        error\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get download URL for a deal data room document\r\n   */\r\n  static async getDealDocumentDownloadUrl(\r\n    dealId: string,\r\n    documentId: string\r\n  ): Promise<DocumentUrlResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `/api/deals/${dealId}/documents/${documentId}/download?mode=download`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      )\r\n\r\n      return await this.parseResponse(response)\r\n    } catch (error) {\r\n      if (error instanceof DocumentError) {\r\n        throw error\r\n      }\r\n\r\n      throw new DocumentError(\r\n        'Network error while loading deal document download',\r\n        0,\r\n        error\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Map HTTP status codes to user-friendly error messages\r\n   */\r\n  static getErrorMessage(error: DocumentError): string {\r\n    switch (error.statusCode) {\r\n      case 401:\r\n        return 'You do not have permission to view this document.'\r\n      case 403:\r\n        return 'Access to this document is forbidden.'\r\n      case 404:\r\n        return 'Document not found or has been deleted.'\r\n      case 413:\r\n        return 'File is too large to process.'\r\n      case 500:\r\n        return 'Server error while loading document. Please try again.'\r\n      case 0:\r\n        return 'Network error. Please check your connection and try again.'\r\n      default:\r\n        return error.message || 'Failed to load document preview.'\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4430, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/constants/document-preview.constants.ts"],"sourcesContent":["/**\r\n * Document Preview Configuration\r\n * Defines limits and supported types for the document preview system\r\n */\r\n\r\nexport const PREVIEW_CONFIG = {\r\n  /** Maximum file size for preview (10MB) */\r\n  MAX_FILE_SIZE_BYTES: 10 * 1024 * 1024,\r\n\r\n  /** Timeout for iframe loading (30 seconds) */\r\n  IFRAME_TIMEOUT_MS: 30000,\r\n\r\n  /** Supported MIME types for preview */\r\n  SUPPORTED_MIME_TYPES: [\r\n    'application/pdf',\r\n    'image/png',\r\n    'image/jpeg',\r\n    'image/jpg',\r\n    'image/gif',\r\n    'image/webp',\r\n    'text/plain',\r\n  ] as const,\r\n\r\n  /** Supported file extensions for preview */\r\n  SUPPORTED_EXTENSIONS: [\r\n    'pdf',\r\n    'png',\r\n    'jpeg',\r\n    'jpg',\r\n    'gif',\r\n    'webp',\r\n    'txt',\r\n    'text',\r\n  ] as const,\r\n} as const\r\n\r\n/**\r\n * User-friendly error messages for document preview\r\n */\r\nexport const PREVIEW_ERROR_MESSAGES = {\r\n  FILE_TOO_LARGE: 'File is too large for preview (maximum 10MB). Please download to view.',\r\n  UNSUPPORTED_TYPE: 'Preview not supported for this file type. Please download to view.',\r\n  LOAD_FAILED: 'Failed to load document preview. Please try downloading instead.',\r\n  UNAUTHORIZED: 'You do not have permission to view this document.',\r\n  NOT_FOUND: 'Document not found or has been deleted.',\r\n  NETWORK_ERROR: 'Network error while loading preview. Please check your connection.',\r\n  INVALID_URL: 'Invalid preview URL received. Please try again.',\r\n  TIMEOUT: 'Preview loading timed out. The file may be too large or your connection too slow.',\r\n} as const\r\n\r\n/**\r\n * Check if a file extension is supported for preview\r\n */\r\nexport function isPreviewableExtension(filename: string): boolean {\r\n  const extension = filename.split('.').pop()?.toLowerCase()\r\n  if (!extension) return false\r\n\r\n  return (PREVIEW_CONFIG.SUPPORTED_EXTENSIONS as readonly string[]).includes(extension)\r\n}\r\n\r\n/**\r\n * Check if a MIME type is supported for preview\r\n */\r\nexport function isPreviewableMimeType(mimeType: string): boolean {\r\n  return (PREVIEW_CONFIG.SUPPORTED_MIME_TYPES as readonly string[]).includes(mimeType)\r\n}\r\n\r\n/**\r\n * Check if a file is within size limits for preview\r\n */\r\nexport function isWithinSizeLimit(sizeBytes: number): boolean {\r\n  return sizeBytes <= PREVIEW_CONFIG.MAX_FILE_SIZE_BYTES\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;;;AAEM,MAAM,iBAAiB;IAC5B,yCAAyC,GACzC,qBAAqB,KAAK,OAAO;IAEjC,4CAA4C,GAC5C,mBAAmB;IAEnB,qCAAqC,GACrC,sBAAsB;QACpB;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,0CAA0C,GAC1C,sBAAsB;QACpB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;AACH;AAKO,MAAM,yBAAyB;IACpC,gBAAgB;IAChB,kBAAkB;IAClB,aAAa;IACb,cAAc;IACd,WAAW;IACX,eAAe;IACf,aAAa;IACb,SAAS;AACX;AAKO,SAAS,uBAAuB,QAAgB;IACrD,MAAM,YAAY,SAAS,KAAK,CAAC,KAAK,GAAG,IAAI;IAC7C,IAAI,CAAC,WAAW,OAAO;IAEvB,OAAO,AAAC,eAAe,oBAAoB,CAAuB,QAAQ,CAAC;AAC7E;AAKO,SAAS,sBAAsB,QAAgB;IACpD,OAAO,AAAC,eAAe,oBAAoB,CAAuB,QAAQ,CAAC;AAC7E;AAKO,SAAS,kBAAkB,SAAiB;IACjD,OAAO,aAAa,eAAe,mBAAmB;AACxD"}},
    {"offset": {"line": 4493, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/hooks/useDocumentViewer.ts"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useCallback } from 'react'\r\nimport { toast } from 'sonner'\r\nimport { DocumentService } from '@/services/document.service'\r\nimport { DocumentReference, DocumentError } from '@/types/document-viewer.types'\r\nimport {\r\n  PREVIEW_CONFIG,\r\n  PREVIEW_ERROR_MESSAGES,\r\n  isPreviewableExtension,\r\n  isPreviewableMimeType,\r\n  isWithinSizeLimit,\r\n} from '@/constants/document-preview.constants'\r\n\r\n/**\r\n * Hook for managing document preview state and operations\r\n */\r\nexport function useDocumentViewer() {\r\n  const [isOpen, setIsOpen] = useState(false)\r\n  const [document, setDocument] = useState<DocumentReference | null>(null)\r\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null)\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  /**\r\n   * Validate if document can be previewed\r\n   */\r\n  const validateDocument = (doc: DocumentReference): string | null => {\r\n    // Check file size\r\n    if (doc.file_size_bytes && !isWithinSizeLimit(doc.file_size_bytes)) {\r\n      return PREVIEW_ERROR_MESSAGES.FILE_TOO_LARGE\r\n    }\r\n\r\n    // Check file type by extension\r\n    const fileName = doc.file_name || doc.name || ''\r\n    const canPreviewByExtension = fileName ? isPreviewableExtension(fileName) : false\r\n\r\n    // Check file type by MIME type if available\r\n    const mimeType = doc.mime_type || ''\r\n    const canPreviewByMimeType = mimeType\r\n      ? isPreviewableMimeType(mimeType)\r\n      : false // If no MIME type, must fail validation (was incorrectly true)\r\n\r\n    // Explicitly check for Office documents that cannot be previewed\r\n    const fileExt = fileName.split('.').pop()?.toLowerCase() || ''\r\n    const officeExtensions = ['docx', 'doc', 'xlsx', 'xls', 'pptx', 'ppt', 'odt', 'ods', 'odp']\r\n    const isOfficeByExtension = officeExtensions.includes(fileExt)\r\n\r\n    const isOfficeDocument = isOfficeByExtension || (mimeType && (\r\n      mimeType.includes('officedocument') || // Office 2007+ formats\r\n      mimeType.includes('msword') || // Old Word format\r\n      mimeType.includes('ms-excel') || // Old Excel format\r\n      mimeType.includes('ms-powerpoint') || // Old PowerPoint format\r\n      mimeType.includes('opendocument') // OpenOffice/LibreOffice formats\r\n    ))\r\n\r\n    if (isOfficeDocument) {\r\n      return 'Office documents cannot be previewed. Please download to view.'\r\n    }\r\n\r\n    if (!canPreviewByExtension && !canPreviewByMimeType) {\r\n      return PREVIEW_ERROR_MESSAGES.UNSUPPORTED_TYPE\r\n    }\r\n\r\n    return null // Valid for preview\r\n  }\r\n\r\n  /**\r\n   * Open document preview\r\n   */\r\n  const openPreview = useCallback(async (doc: DocumentReference, dealId?: string) => {\r\n    // Reset state\r\n    setError(null)\r\n    setPreviewUrl(null)\r\n\r\n    // Validate document\r\n    const validationError = validateDocument(doc)\r\n    if (validationError) {\r\n      toast.error(validationError)\r\n      return\r\n    }\r\n\r\n    // Set document and open immediately (for better UX)\r\n    setDocument(doc)\r\n    setIsOpen(true)\r\n    setIsLoading(true)\r\n\r\n    try {\r\n      // Fetch preview URL based on document type\r\n      const response = dealId\r\n        ? await DocumentService.getDealDocumentPreviewUrl(dealId, doc.id)\r\n        : await DocumentService.getPreviewUrl(doc.id)\r\n\r\n      // Set preview URL\r\n      setPreviewUrl(response.download_url)\r\n      setIsLoading(false)\r\n    } catch (err) {\r\n      console.error('Failed to load document preview:', err)\r\n\r\n      const errorMessage =\r\n        err instanceof DocumentError\r\n          ? DocumentService.getErrorMessage(err)\r\n          : PREVIEW_ERROR_MESSAGES.LOAD_FAILED\r\n\r\n      setError(errorMessage)\r\n      setIsLoading(false)\r\n\r\n      // Also show toast for immediate feedback\r\n      toast.error(errorMessage)\r\n    }\r\n  }, [])\r\n\r\n  /**\r\n   * Close document preview\r\n   */\r\n  const closePreview = useCallback(() => {\r\n    setIsOpen(false)\r\n    // Delay cleanup to allow closing animation\r\n    setTimeout(() => {\r\n      setDocument(null)\r\n      setPreviewUrl(null)\r\n      setError(null)\r\n      setIsLoading(false)\r\n    }, 300)\r\n  }, [])\r\n\r\n  /**\r\n   * Download document from preview\r\n   */\r\n  const downloadDocument = useCallback(async () => {\r\n    if (!document) return\r\n\r\n    try {\r\n      // Use previewUrl if available (already fetched)\r\n      if (previewUrl) {\r\n        window.open(previewUrl, '_blank')\r\n        return\r\n      }\r\n\r\n      // Otherwise fetch download URL\r\n      const response = await DocumentService.getDownloadUrl(document.id)\r\n      window.open(response.download_url, '_blank')\r\n    } catch (err) {\r\n      console.error('Failed to download document:', err)\r\n\r\n      const errorMessage =\r\n        err instanceof DocumentError\r\n          ? DocumentService.getErrorMessage(err)\r\n          : 'Failed to download document'\r\n\r\n      toast.error(errorMessage)\r\n    }\r\n  }, [document, previewUrl])\r\n\r\n  return {\r\n    // State\r\n    isOpen,\r\n    document,\r\n    previewUrl,\r\n    isLoading,\r\n    error,\r\n\r\n    // Methods\r\n    openPreview,\r\n    closePreview,\r\n    downloadDocument,\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;AAiBO,SAAS;IACd,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,wOAAQ,EAAC;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wOAAQ,EAA2B;IACnE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,wOAAQ,EAAgB;IAC5D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,wOAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wOAAQ,EAAgB;IAElD;;GAEC,GACD,MAAM,mBAAmB,CAAC;QACxB,kBAAkB;QAClB,IAAI,IAAI,eAAe,IAAI,CAAC,IAAA,gMAAiB,EAAC,IAAI,eAAe,GAAG;YAClE,OAAO,qMAAsB,CAAC,cAAc;QAC9C;QAEA,+BAA+B;QAC/B,MAAM,WAAW,IAAI,SAAS,IAAI,IAAI,IAAI,IAAI;QAC9C,MAAM,wBAAwB,WAAW,IAAA,qMAAsB,EAAC,YAAY;QAE5E,4CAA4C;QAC5C,MAAM,WAAW,IAAI,SAAS,IAAI;QAClC,MAAM,uBAAuB,WACzB,IAAA,oMAAqB,EAAC,YACtB,MAAM,+DAA+D;;QAEzE,iEAAiE;QACjE,MAAM,UAAU,SAAS,KAAK,CAAC,KAAK,GAAG,IAAI,iBAAiB;QAC5D,MAAM,mBAAmB;YAAC;YAAQ;YAAO;YAAQ;YAAO;YAAQ;YAAO;YAAO;YAAO;SAAM;QAC3F,MAAM,sBAAsB,iBAAiB,QAAQ,CAAC;QAEtD,MAAM,mBAAmB,uBAAwB,YAAY,CAC3D,SAAS,QAAQ,CAAC,qBAAqB,uBAAuB;QAC9D,SAAS,QAAQ,CAAC,aAAa,kBAAkB;QACjD,SAAS,QAAQ,CAAC,eAAe,mBAAmB;QACpD,SAAS,QAAQ,CAAC,oBAAoB,wBAAwB;QAC9D,SAAS,QAAQ,CAAC,gBAAgB,iCAAiC;QACrE;QAEA,IAAI,kBAAkB;YACpB,OAAO;QACT;QAEA,IAAI,CAAC,yBAAyB,CAAC,sBAAsB;YACnD,OAAO,qMAAsB,CAAC,gBAAgB;QAChD;QAEA,OAAO,KAAK,oBAAoB;;IAClC;IAEA;;GAEC,GACD,MAAM,cAAc,IAAA,2OAAW,EAAC,OAAO,KAAwB;QAC7D,cAAc;QACd,SAAS;QACT,cAAc;QAEd,oBAAoB;QACpB,MAAM,kBAAkB,iBAAiB;QACzC,IAAI,iBAAiB;YACnB,wKAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,oDAAoD;QACpD,YAAY;QACZ,UAAU;QACV,aAAa;QAEb,IAAI;YACF,2CAA2C;YAC3C,MAAM,WAAW,SACb,MAAM,gLAAe,CAAC,yBAAyB,CAAC,QAAQ,IAAI,EAAE,IAC9D,MAAM,gLAAe,CAAC,aAAa,CAAC,IAAI,EAAE;YAE9C,kBAAkB;YAClB,cAAc,SAAS,YAAY;YACnC,aAAa;QACf,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,oCAAoC;YAElD,MAAM,eACJ,eAAe,mLAAa,GACxB,gLAAe,CAAC,eAAe,CAAC,OAChC,qMAAsB,CAAC,WAAW;YAExC,SAAS;YACT,aAAa;YAEb,yCAAyC;YACzC,wKAAK,CAAC,KAAK,CAAC;QACd;IACF,GAAG,EAAE;IAEL;;GAEC,GACD,MAAM,eAAe,IAAA,2OAAW,EAAC;QAC/B,UAAU;QACV,2CAA2C;QAC3C,WAAW;YACT,YAAY;YACZ,cAAc;YACd,SAAS;YACT,aAAa;QACf,GAAG;IACL,GAAG,EAAE;IAEL;;GAEC,GACD,MAAM,mBAAmB,IAAA,2OAAW,EAAC;QACnC,IAAI,CAAC,UAAU;QAEf,IAAI;YACF,gDAAgD;YAChD,IAAI,YAAY;gBACd,OAAO,IAAI,CAAC,YAAY;gBACxB;YACF;YAEA,+BAA+B;YAC/B,MAAM,WAAW,MAAM,gLAAe,CAAC,cAAc,CAAC,SAAS,EAAE;YACjE,OAAO,IAAI,CAAC,SAAS,YAAY,EAAE;QACrC,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,gCAAgC;YAE9C,MAAM,eACJ,eAAe,mLAAa,GACxB,gLAAe,CAAC,eAAe,CAAC,OAChC;YAEN,wKAAK,CAAC,KAAK,CAAC;QACd;IACF,GAAG;QAAC;QAAU;KAAW;IAEzB,OAAO;QACL,QAAQ;QACR;QACA;QACA;QACA;QACA;QAEA,UAAU;QACV;QACA;QACA;IACF;AACF"}},
    {"offset": {"line": 4639, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/DocumentViewerFullscreen.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState, useMemo } from 'react'\r\nimport { createPortal } from 'react-dom'\r\nimport { X, Download, Loader2, AlertCircle, FileText } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { formatFileSize } from '@/lib/utils'\r\nimport { DocumentReference } from '@/types/document-viewer.types'\r\n\r\ninterface DocumentViewerFullscreenProps {\r\n  isOpen: boolean\r\n  document: DocumentReference | null\r\n  previewUrl: string | null\r\n  isLoading: boolean\r\n  error: string | null\r\n  onClose: () => void\r\n  onDownload: () => void\r\n}\r\n\r\n/**\r\n * Check if a file is a PDF based on filename or URL\r\n */\r\nfunction isPdfFile(fileName?: string | null, url?: string | null): boolean {\r\n  if (fileName?.toLowerCase().endsWith('.pdf')) return true\r\n  if (url?.toLowerCase().includes('.pdf')) return true\r\n  // Supabase signed URLs have the file path in them\r\n  if (url?.includes('deal-documents') && url?.includes('.pdf')) return true\r\n  return false\r\n}\r\n\r\n/**\r\n * Append PDF viewer parameters to URL to fix browser rendering issues\r\n * - navpanes=0: Hide thumbnail sidebar (fixes Brave issue)\r\n * - view=FitH: Fit to width for better viewing\r\n * - pagemode=none: Don't show bookmarks/thumbnails\r\n */\r\nfunction getPdfViewerUrl(url: string): string {\r\n  // Don't add hash if URL already has one\r\n  if (url.includes('#')) return url\r\n  return `${url}#navpanes=0&view=FitH&pagemode=none`\r\n}\r\n\r\nexport function DocumentViewerFullscreen({\r\n  isOpen,\r\n  document,\r\n  previewUrl,\r\n  isLoading,\r\n  error,\r\n  onClose,\r\n  onDownload,\r\n}: DocumentViewerFullscreenProps) {\r\n  const [iframeError, setIframeError] = useState(false)\r\n  const [mounted, setMounted] = useState(false)\r\n\r\n  // Track mount state for portal rendering\r\n  useEffect(() => {\r\n    setMounted(true)\r\n    return () => setMounted(false)\r\n  }, [])\r\n\r\n  // Compute the final iframe URL with PDF parameters if needed\r\n  const iframeSrc = useMemo(() => {\r\n    if (!previewUrl) return null\r\n    const fileName = document?.file_name || document?.name\r\n    if (isPdfFile(fileName, previewUrl)) {\r\n      return getPdfViewerUrl(previewUrl)\r\n    }\r\n    return previewUrl\r\n  }, [previewUrl, document])\r\n\r\n  // Handle ESC key to close\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onClose()\r\n      }\r\n      if (e.ctrlKey && e.key === 'd') {\r\n        e.preventDefault()\r\n        onDownload()\r\n      }\r\n    }\r\n\r\n    if (isOpen && typeof window !== 'undefined') {\r\n      window.addEventListener('keydown', handleKeyDown)\r\n      // Prevent body scroll when viewer is open\r\n      if (window.document?.body) {\r\n        window.document.body.style.overflow = 'hidden'\r\n      }\r\n\r\n      return () => {\r\n        window.removeEventListener('keydown', handleKeyDown)\r\n        if (window.document?.body) {\r\n          window.document.body.style.overflow = ''\r\n        }\r\n      }\r\n    }\r\n  }, [isOpen, onClose, onDownload])\r\n\r\n  // Reset iframe error when URL changes\r\n  useEffect(() => {\r\n    setIframeError(false)\r\n  }, [previewUrl])\r\n\r\n  // Don't render until mounted (for portal) or if not open\r\n  if (!isOpen || !mounted) return null\r\n\r\n  // Use portal to render at body level, escaping backdrop-blur containing blocks\r\n  const modalContent = (\r\n    <div className=\"fixed inset-0 z-[9999] bg-black/95 overflow-hidden\">\r\n      {/* Toolbar */}\r\n      <div className=\"h-16 bg-white border-b shadow-md flex items-center justify-between px-6\">\r\n        <div className=\"flex items-center gap-4 flex-1 min-w-0\">\r\n          <FileText className=\"h-5 w-5 text-gray-500 flex-shrink-0\" />\r\n          <div className=\"min-w-0 flex-1\">\r\n            <h2 className=\"text-lg font-semibold text-gray-900 truncate\">\r\n              {document?.file_name || document?.name || 'Document Preview'}\r\n            </h2>\r\n            <div className=\"flex items-center gap-3 text-sm text-gray-500\">\r\n              {document?.type && (\r\n                <span className=\"capitalize\">{document.type}</span>\r\n              )}\r\n              {document?.file_size_bytes && (\r\n                <>\r\n                  <span>•</span>\r\n                  <span>{formatFileSize(document.file_size_bytes)}</span>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={onDownload}\r\n            className=\"gap-2\"\r\n          >\r\n            <Download className=\"h-4 w-4\" />\r\n            Download\r\n          </Button>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={onClose}\r\n            className=\"gap-2\"\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n            Close\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main viewport */}\r\n      <div className=\"h-[calc(100vh-4rem)] bg-gray-900\">\r\n        {/* Loading/error states need centering */}\r\n        {(isLoading || error || iframeError) && (\r\n          <div className=\"w-full h-full flex items-center justify-center\">\r\n            {isLoading && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white\">\r\n                <Loader2 className=\"h-12 w-12 animate-spin\" />\r\n                <p className=\"text-lg\">Loading document...</p>\r\n              </div>\r\n            )}\r\n\r\n            {error && !isLoading && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white max-w-md mx-auto px-4\">\r\n                <AlertCircle className=\"h-16 w-16 text-red-400\" />\r\n                <h3 className=\"text-xl font-semibold\">Failed to Load Preview</h3>\r\n                <p className=\"text-gray-300 text-center\">{error}</p>\r\n                <Button\r\n                  onClick={onDownload}\r\n                  variant=\"secondary\"\r\n                  className=\"gap-2 mt-4\"\r\n                >\r\n                  <Download className=\"h-4 w-4\" />\r\n                  Download Instead\r\n                </Button>\r\n              </div>\r\n            )}\r\n\r\n            {iframeError && !isLoading && !error && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white max-w-md mx-auto px-4\">\r\n                <AlertCircle className=\"h-16 w-16 text-red-400\" />\r\n                <h3 className=\"text-xl font-semibold\">Preview Unavailable</h3>\r\n                <p className=\"text-gray-300 text-center\">\r\n                  This document cannot be previewed in your browser.\r\n                </p>\r\n                <Button\r\n                  onClick={onDownload}\r\n                  variant=\"secondary\"\r\n                  className=\"gap-2 mt-4\"\r\n                >\r\n                  <Download className=\"h-4 w-4\" />\r\n                  Download to View\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Iframe fills the entire viewport when ready */}\r\n        {iframeSrc && !isLoading && !error && !iframeError && (\r\n          <iframe\r\n            src={iframeSrc}\r\n            className=\"w-full h-full border-0\"\r\n            title=\"Document Preview\"\r\n            onError={() => {\r\n              console.error('iframe failed to load preview')\r\n              setIframeError(true)\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer hint */}\r\n      {!isLoading && !error && (\r\n        <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 text-white/60 text-sm bg-black/50 px-4 py-2 rounded-full\">\r\n          Press <kbd className=\"px-2 py-1 bg-white/10 rounded mx-1\">ESC</kbd> to close\r\n          or <kbd className=\"px-2 py-1 bg-white/10 rounded mx-1\">Ctrl+D</kbd> to download\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  // Render portal to document.body to escape backdrop-blur containing blocks\r\n  const portalTarget = typeof window !== 'undefined' ? window.document.body : null\r\n  if (!portalTarget) return null\r\n  return createPortal(modalContent, portalTarget)\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5056, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/staff-documents-client.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect, useMemo, useCallback } from 'react'\r\nimport {\r\n  Upload,\r\n  FolderPlus,\r\n  RefreshCw,\r\n  Menu,\r\n  ArrowLeft,\r\n  Home\r\n} from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger\r\n} from '@/components/ui/dropdown-menu'\r\nimport { FolderBreadcrumbs } from './navigation/FolderBreadcrumbs'\r\nimport { FolderNavigator } from './navigation/FolderNavigator'\r\nimport { FolderTreeDrawer } from './navigation/FolderTreeDrawer'\r\nimport { ScrollArea } from '@/components/ui/scroll-area'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Search, X, Folder, FolderOpen, ChevronRight, ChevronDown } from 'lucide-react'\r\nimport { FOLDER_ICON_COLORS } from '@/lib/design-tokens'\r\nimport { cn } from '@/lib/utils'\r\nimport { UploadDestinationBanner } from './upload/UploadDestinationBanner'\r\nimport { DocumentUploadDialog } from './document-upload-dialog'\r\nimport { MoveDocumentDialog } from './move-document-dialog'\r\nimport { CreateFolderDialog } from './create-folder-dialog'\r\nimport { RenameFolderDialog } from './rename-folder-dialog'\r\nimport { RenameDocumentDialog } from './rename-document-dialog'\r\nimport { DocumentFolder } from '@/types/documents'\r\nimport { toast } from 'sonner'\r\nimport { useDocumentViewer } from '@/hooks/useDocumentViewer'\r\nimport { DocumentViewerFullscreen } from './DocumentViewerFullscreen'\r\n\r\ninterface Vehicle {\r\n  id: string\r\n  name: string\r\n  type: string\r\n}\r\n\r\ninterface StaffDocument {\r\n  id: string\r\n  name: string\r\n  type: string\r\n  status: string\r\n  file_size_bytes: number\r\n  is_published: boolean\r\n  created_at: string\r\n  mime_type?: string\r\n  folder?: {\r\n    id: string\r\n    name: string\r\n    path: string\r\n  }\r\n  vehicle?: {\r\n    id: string\r\n    name: string\r\n  }\r\n  created_by_profile?: {\r\n    display_name: string\r\n  }\r\n}\r\n\r\ninterface StaffDocumentsClientProps {\r\n  initialVehicles: Vehicle[]\r\n  userProfile: {\r\n    role: string\r\n    display_name: string\r\n    title?: string\r\n  }\r\n}\r\n\r\nexport function StaffDocumentsClient({ initialVehicles, userProfile }: StaffDocumentsClientProps) {\r\n  // Navigation State\r\n  const [currentFolderId, setCurrentFolderId] = useState<string | null>(null)\r\n  const [currentFolder, setCurrentFolder] = useState<DocumentFolder | null>(null)\r\n  const [navigationHistory, setNavigationHistory] = useState<string[]>([])\r\n  const [showTreeDrawer, setShowTreeDrawer] = useState(false)\r\n\r\n  // Data State\r\n  const [folders, setFolders] = useState<DocumentFolder[]>([])\r\n  const [documents, setDocuments] = useState<StaffDocument[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  // Dialog State\r\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false)\r\n  const [createFolderDialogOpen, setCreateFolderDialogOpen] = useState(false)\r\n  const [createFolderParentId, setCreateFolderParentId] = useState<string | null>(null)\r\n  const [moveDialogOpen, setMoveDialogOpen] = useState(false)\r\n  const [moveDialogDocId, setMoveDialogDocId] = useState<string | null>(null)\r\n  const [moveDialogDocName, setMoveDialogDocName] = useState<string>('')\r\n  const [moveDialogCurrentFolder, setMoveDialogCurrentFolder] = useState<string | null>(null)\r\n  const [renameFolderDialogOpen, setRenameFolderDialogOpen] = useState(false)\r\n  const [renameFolderId, setRenameFolderId] = useState<string | null>(null)\r\n  const [renameFolderName, setRenameFolderName] = useState<string>('')\r\n  const [renameDocumentDialogOpen, setRenameDocumentDialogOpen] = useState(false)\r\n  const [renameDocumentId, setRenameDocumentId] = useState<string | null>(null)\r\n  const [renameDocumentName, setRenameDocumentName] = useState<string>('')\r\n\r\n  // UI State\r\n  const [searchQuery, setSearchQuery] = useState('')\r\n  const [statusFilter, setStatusFilter] = useState<string>('all')\r\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid')\r\n  const [sortBy, setSortBy] = useState<'name' | 'date' | 'type'>('name')\r\n\r\n  // Tree Sidebar State\r\n  const [treeSearchQuery, setTreeSearchQuery] = useState('')\r\n  const [expandedFolders, setExpandedFolders] = useState<Set<string>>(new Set())\r\n\r\n  // Document viewer hook\r\n  const {\r\n    isOpen: previewOpen,\r\n    document: previewDocument,\r\n    previewUrl,\r\n    isLoading: isLoadingPreview,\r\n    error: previewError,\r\n    openPreview,\r\n    closePreview,\r\n    downloadDocument: downloadFromPreview\r\n  } = useDocumentViewer()\r\n\r\n  // Navigation Functions (NEW)\r\n  const navigateToFolder = (folderId: string | null) => {\r\n    if (currentFolderId !== null && currentFolderId !== folderId) {\r\n      setNavigationHistory(prev => [...prev, currentFolderId])\r\n    }\r\n\r\n    setCurrentFolderId(folderId)\r\n\r\n    const folder = folders.find(f => f.id === folderId)\r\n    setCurrentFolder(folder || null)\r\n  }\r\n\r\n  const navigateBack = () => {\r\n    if (navigationHistory.length === 0) return\r\n\r\n    const previousId = navigationHistory[navigationHistory.length - 1]\r\n    setNavigationHistory(prev => prev.slice(0, -1))\r\n    setCurrentFolderId(previousId)\r\n\r\n    const folder = folders.find(f => f.id === previousId)\r\n    setCurrentFolder(folder || null)\r\n  }\r\n\r\n  // Get subfolders of current location (with search filtering)\r\n  const getSubfolders = useMemo((): DocumentFolder[] => {\r\n    let result = folders.filter(f => f.parent_folder_id === (currentFolderId || null))\r\n\r\n    // Filter folders by search query\r\n    if (searchQuery) {\r\n      const query = searchQuery.toLowerCase()\r\n      result = result.filter(folder => {\r\n        const nameMatch = folder.name.toLowerCase().includes(query)\r\n        const pathMatch = folder.path.toLowerCase().includes(query)\r\n        return nameMatch || pathMatch\r\n      })\r\n    }\r\n\r\n    return result\r\n  }, [folders, currentFolderId, searchQuery])\r\n\r\n  // Get filtered documents\r\n  const filteredDocuments = useMemo(() => {\r\n    let result = documents\r\n\r\n    // Search filter - comprehensive search across all relevant fields\r\n    if (searchQuery) {\r\n      const query = searchQuery.toLowerCase()\r\n      result = result.filter(doc => {\r\n        const nameMatch = doc.name.toLowerCase().includes(query)\r\n        const vehicleNameMatch = doc.vehicle?.name.toLowerCase().includes(query) || false\r\n        const folderNameMatch = doc.folder?.name.toLowerCase().includes(query) || false\r\n        const folderPathMatch = doc.folder?.path.toLowerCase().includes(query) || false\r\n        const typeMatch = doc.type.toLowerCase().includes(query)\r\n        const createdByMatch = doc.created_by_profile?.display_name.toLowerCase().includes(query) || false\r\n\r\n        return nameMatch || vehicleNameMatch || folderNameMatch || folderPathMatch || typeMatch || createdByMatch\r\n      })\r\n    }\r\n\r\n    // Sort\r\n    result = [...result].sort((a, b) => {\r\n      if (sortBy === 'name') {\r\n        return a.name.localeCompare(b.name)\r\n      } else if (sortBy === 'date') {\r\n        return new Date(b.created_at).getTime() - new Date(a.created_at).getTime()\r\n      } else if (sortBy === 'type') {\r\n        return a.type.localeCompare(b.type)\r\n      }\r\n      return 0\r\n    })\r\n\r\n    return result\r\n  }, [documents, searchQuery, sortBy])\r\n\r\n  // Build tree structure for sidebar\r\n  interface TreeNode {\r\n    folder: DocumentFolder\r\n    children: TreeNode[]\r\n  }\r\n\r\n  const buildFolderTree = useCallback((folders: DocumentFolder[]): TreeNode[] => {\r\n    const folderMap = new Map<string | null, TreeNode[]>()\r\n\r\n    folders.forEach((folder) => {\r\n      if (!folderMap.has(folder.parent_folder_id)) {\r\n        folderMap.set(folder.parent_folder_id, [])\r\n      }\r\n      folderMap.get(folder.parent_folder_id)!.push({\r\n        folder,\r\n        children: [],\r\n      })\r\n    })\r\n\r\n    function buildChildren(parentId: string | null): TreeNode[] {\r\n      const children = folderMap.get(parentId) || []\r\n      return children.map((node) => ({\r\n        ...node,\r\n        children: buildChildren(node.folder.id),\r\n      }))\r\n    }\r\n\r\n    return buildChildren(null)\r\n  }, [])\r\n\r\n  const folderTree = useMemo(() => {\r\n    return buildFolderTree(folders)\r\n  }, [folders, buildFolderTree])\r\n\r\n  // Filter tree based on sidebar search\r\n  const filterTreeBySearch = useCallback((tree: TreeNode[], query: string): TreeNode[] => {\r\n    return tree\r\n      .map((node) => {\r\n        const nameMatches = node.folder.name.toLowerCase().includes(query)\r\n        const pathMatches = node.folder.path.toLowerCase().includes(query)\r\n        const filteredChildren = filterTreeBySearch(node.children, query)\r\n\r\n        if (nameMatches || pathMatches || filteredChildren.length > 0) {\r\n          return {\r\n            ...node,\r\n            children: filteredChildren,\r\n          }\r\n        }\r\n        return null\r\n      })\r\n      .filter((node): node is TreeNode => node !== null)\r\n  }, [])\r\n\r\n  const filteredTree = useMemo(() => {\r\n    if (!treeSearchQuery.trim()) return folderTree\r\n    return filterTreeBySearch(folderTree, treeSearchQuery.toLowerCase())\r\n  }, [folderTree, treeSearchQuery, filterTreeBySearch])\r\n\r\n  // Toggle folder expansion in sidebar\r\n  const toggleSidebarFolder = (folderId: string) => {\r\n    setExpandedFolders((prev) => {\r\n      const next = new Set(prev)\r\n      if (next.has(folderId)) {\r\n        next.delete(folderId)\r\n      } else {\r\n        next.add(folderId)\r\n      }\r\n      return next\r\n    })\r\n  }\r\n\r\n  // Auto-expand current folder's ancestors\r\n  useEffect(() => {\r\n    if (currentFolderId && folders.length > 0) {\r\n      const getAncestorIds = (folder: DocumentFolder): string[] => {\r\n        const ancestors: string[] = []\r\n        let currentFolder: DocumentFolder | undefined = folder\r\n\r\n        while (currentFolder?.parent_folder_id) {\r\n          ancestors.push(currentFolder.parent_folder_id)\r\n          currentFolder = folders.find((f) => f.id === currentFolder!.parent_folder_id)\r\n        }\r\n        return ancestors\r\n      }\r\n\r\n      const currentFolder = folders.find((f) => f.id === currentFolderId)\r\n      if (currentFolder) {\r\n        const ancestorIds = getAncestorIds(currentFolder)\r\n        setExpandedFolders((prev) => new Set([...prev, ...ancestorIds]))\r\n      }\r\n    }\r\n  }, [currentFolderId, folders])\r\n\r\n  const loadFolders = useCallback(async () => {\r\n    try {\r\n      const response = await fetch('/api/staff/documents/folders?tree=true')\r\n\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        const foldersList = data.folders || []\r\n\r\n        // Flatten tree structure to flat array\r\n        interface FolderTreeNode extends DocumentFolder {\r\n          children?: FolderTreeNode[]\r\n        }\r\n\r\n        const flattenFolders = (nodes: FolderTreeNode[]): DocumentFolder[] => {\r\n          const result: DocumentFolder[] = []\r\n          nodes.forEach((node: FolderTreeNode) => {\r\n            result.push({\r\n              id: node.id,\r\n              name: node.name,\r\n              path: node.path,\r\n              parent_folder_id: node.parent_folder_id,\r\n              folder_type: node.folder_type,\r\n              vehicle_id: node.vehicle_id,\r\n              created_by: node.created_by,\r\n              created_at: node.created_at,\r\n              updated_at: node.updated_at,\r\n              subfolder_count: node.children?.length || 0,\r\n              document_count: node.document_count || 0,\r\n            })\r\n            if (node.children && node.children.length > 0) {\r\n              result.push(...flattenFolders(node.children))\r\n            }\r\n          })\r\n          return result\r\n        }\r\n\r\n        setFolders(flattenFolders(foldersList))\r\n      } else {\r\n        const errorData = await response.json().catch(() => ({ error: 'Unknown error' }))\r\n        const errorMsg = errorData.details || errorData.error || 'Unknown error'\r\n        toast.error(`Failed to load folders: ${errorMsg}`)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading folders:', error)\r\n      toast.error('Failed to load folders')\r\n    }\r\n  }, [])\r\n\r\n  const getDescendantFolderIds = useCallback((folderId: string): string[] => {\r\n    const result = [folderId]\r\n\r\n    const findChildren = (parentId: string) => {\r\n      const children = folders.filter(f => f.parent_folder_id === parentId)\r\n      children.forEach(child => {\r\n        result.push(child.id)\r\n        findChildren(child.id)\r\n      })\r\n    }\r\n\r\n    findChildren(folderId)\r\n    return result\r\n  }, [folders])\r\n\r\n  const loadDocuments = useCallback(async () => {\r\n    try {\r\n      setLoading(true)\r\n      const params = new URLSearchParams()\r\n\r\n      // When searching, search globally across ALL folders\r\n      // When NOT searching, limit to current folder and descendants\r\n      if (!searchQuery && currentFolderId) {\r\n        // Get all descendant folder IDs for recursive display\r\n        const folderIds = getDescendantFolderIds(currentFolderId)\r\n        folderIds.forEach(id => params.append('folder_ids', id))\r\n        params.append('include_subfolders', 'true')\r\n      }\r\n      if (searchQuery) {\r\n        params.append('search', searchQuery)\r\n      }\r\n      if (statusFilter !== 'all') {\r\n        params.append('status', statusFilter)\r\n      }\r\n\r\n      const response = await fetch(`/api/staff/documents?${params.toString()}`)\r\n\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        setDocuments(data.documents || [])\r\n      } else {\r\n        const errorData = await response.json().catch(() => ({ error: 'Unknown error' }))\r\n        const errorMsg = errorData.details || errorData.error || 'Unknown error'\r\n        toast.error(`Failed to load documents: ${errorMsg}`)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading documents:', error)\r\n      toast.error('Failed to load documents')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, [currentFolderId, searchQuery, statusFilter, getDescendantFolderIds])\r\n\r\n  // Load data on mount and when filters change\r\n  useEffect(() => {\r\n    loadFolders()\r\n  }, [loadFolders])\r\n\r\n  useEffect(() => {\r\n    loadDocuments()\r\n  }, [loadDocuments])\r\n\r\n  const oldGetDescendantFolderIds = (folderId: string): string[] => {\r\n    const result = [folderId]\r\n\r\n    const findChildren = (parentId: string) => {\r\n      const children = folders.filter(f => f.parent_folder_id === parentId)\r\n      children.forEach(child => {\r\n        result.push(child.id)\r\n        findChildren(child.id)\r\n      })\r\n    }\r\n\r\n    findChildren(folderId)\r\n    return result\r\n  }\r\n\r\n  const handleCreateFolder = (parentId: string | null = null) => {\r\n    setCreateFolderParentId(parentId || currentFolderId)\r\n    setCreateFolderDialogOpen(true)\r\n  }\r\n\r\n  const handleInitVehicleFolders = async (vehicleId: string) => {\r\n    try {\r\n      const vehicle = initialVehicles.find(v => v.id === vehicleId)\r\n      const response = await fetch('/api/staff/documents/init-vehicle-folders', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ vehicle_id: vehicleId })\r\n      })\r\n\r\n      if (response.ok) {\r\n        toast.success(`Default folders created for ${vehicle?.name || 'vehicle'}`)\r\n        loadFolders()\r\n      } else {\r\n        toast.error('Failed to create vehicle folders')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error initializing folders:', error)\r\n      toast.error('Failed to create vehicle folders')\r\n    }\r\n  }\r\n\r\n  const handleMoveDocument = (documentId: string, documentName: string, currentFolderId: string | null) => {\r\n    setMoveDialogDocId(documentId)\r\n    setMoveDialogDocName(documentName)\r\n    setMoveDialogCurrentFolder(currentFolderId)\r\n    setMoveDialogOpen(true)\r\n  }\r\n\r\n  const handleDeleteDocument = async (documentId: string) => {\r\n    if (!confirm('Are you sure you want to delete this document?')) return\r\n\r\n    try {\r\n      const response = await fetch(`/api/staff/documents/${documentId}`, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      if (response.ok) {\r\n        toast.success('Document deleted successfully')\r\n        loadDocuments()\r\n      } else {\r\n        toast.error('Failed to delete document')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting document:', error)\r\n      toast.error('Failed to delete document')\r\n    }\r\n  }\r\n\r\n  const handlePublishDocument = async (documentId: string) => {\r\n    try {\r\n      const response = await fetch(`/api/staff/documents/${documentId}/publish`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ immediate: true })\r\n      })\r\n\r\n      if (response.ok) {\r\n        toast.success('Document published successfully')\r\n        loadDocuments()\r\n      } else {\r\n        toast.error('Failed to publish document')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error publishing document:', error)\r\n      toast.error('Failed to publish document')\r\n    }\r\n  }\r\n\r\n  const handlePreview = async (doc: StaffDocument) => {\r\n    const fileName = doc.name || ''\r\n    const fileExt = fileName.split('.').pop()?.toLowerCase() || ''\r\n    const officeExtensions = ['docx', 'doc', 'xlsx', 'xls', 'pptx', 'ppt', 'odt', 'ods', 'odp']\r\n\r\n    if (officeExtensions.includes(fileExt)) {\r\n      toast.info('Office documents cannot be previewed. Use Download to view.')\r\n      handleDownload(doc.id)\r\n      return\r\n    }\r\n\r\n    await openPreview({\r\n      id: doc.id,\r\n      file_name: doc.name,\r\n      name: doc.name,\r\n      file_size_bytes: doc.file_size_bytes,\r\n      type: doc.type,\r\n      mime_type: doc.mime_type,\r\n    })\r\n  }\r\n\r\n  const handleDownload = async (documentId: string) => {\r\n    try {\r\n      const response = await fetch(`/api/documents/${documentId}/download`)\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        const downloadUrl = data.url || data.download_url\r\n        if (downloadUrl) {\r\n          window.open(downloadUrl, '_blank')\r\n          toast.success('Download started')\r\n        } else {\r\n          toast.error('No download URL in response')\r\n        }\r\n      } else {\r\n        toast.error('Failed to generate download link')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error downloading document:', error)\r\n      toast.error('Failed to download document')\r\n    }\r\n  }\r\n\r\n  const handleRenameFolder = (folderId: string) => {\r\n    const folder = folders.find(f => f.id === folderId)\r\n    if (!folder) return\r\n\r\n    setRenameFolderId(folderId)\r\n    setRenameFolderName(folder.name)\r\n    setRenameFolderDialogOpen(true)\r\n  }\r\n\r\n  const handleRenameDocument = (documentId: string) => {\r\n    const doc = documents.find(d => d.id === documentId)\r\n    if (!doc) return\r\n\r\n    setRenameDocumentId(documentId)\r\n    setRenameDocumentName(doc.name)\r\n    setRenameDocumentDialogOpen(true)\r\n  }\r\n\r\n  const handleDeleteFolder = async (folderId: string) => {\r\n    const folder = folders.find(f => f.id === folderId)\r\n    if (!folder) return\r\n\r\n    if (!confirm(`Are you sure you want to delete \"${folder.name}\"? This will also delete all documents and subfolders within it.`)) {\r\n      return\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`/api/staff/documents/folders/${folderId}`, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      if (response.ok) {\r\n        toast.success('Folder deleted successfully')\r\n        loadFolders()\r\n        loadDocuments()\r\n      } else {\r\n        const errorData = await response.json().catch(() => ({ error: 'Unknown error' }))\r\n        const errorMsg = errorData.details || errorData.error || 'Unknown error'\r\n        toast.error(`Failed to delete folder: ${errorMsg}`)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting folder:', error)\r\n      toast.error('Failed to delete folder')\r\n    }\r\n  }\r\n\r\n  // Check for vehicles without folders\r\n  const vehiclesWithoutFolders = initialVehicles.filter(vehicle => {\r\n    return !folders.some(folder =>\r\n      folder.vehicle_id === vehicle.id &&\r\n      folder.folder_type === 'vehicle_root'\r\n    )\r\n  })\r\n\r\n  // Recursive tree node renderer for sidebar\r\n  const renderSidebarTreeNode = (node: TreeNode, level: number = 0) => {\r\n    const isExpanded = expandedFolders.has(node.folder.id)\r\n    const hasChildren = node.children.length > 0\r\n    const isCurrent = currentFolderId === node.folder.id\r\n\r\n    return (\r\n      <div key={node.folder.id}>\r\n        <div\r\n          className={cn(\r\n            'flex items-center gap-1 rounded-md transition-colors',\r\n            isCurrent ? 'bg-primary/20 border border-primary' : 'hover:bg-muted border border-transparent'\r\n          )}\r\n          style={{ paddingLeft: `${level * 16 + 8}px` }}\r\n        >\r\n          {hasChildren ? (\r\n            <button\r\n              onClick={() => toggleSidebarFolder(node.folder.id)}\r\n              className=\"p-1 hover:bg-accent rounded transition-colors\"\r\n              aria-label={isExpanded ? 'Collapse folder' : 'Expand folder'}\r\n            >\r\n              {isExpanded ? (\r\n                <ChevronDown className=\"w-3.5 h-3.5 text-muted-foreground\" />\r\n              ) : (\r\n                <ChevronRight className=\"w-3.5 h-3.5 text-muted-foreground\" />\r\n              )}\r\n            </button>\r\n          ) : (\r\n            <div className=\"w-5\" />\r\n          )}\r\n          <button\r\n            onClick={() => navigateToFolder(node.folder.id)}\r\n            className=\"flex items-center gap-2 flex-1 py-2 pr-3 text-left text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-1 rounded\"\r\n          >\r\n            {isExpanded ? (\r\n              <FolderOpen\r\n                className={cn(\r\n                  'w-4 h-4 flex-shrink-0',\r\n                  node.folder.folder_type === 'vehicle_root' ? 'text-blue-500' :\r\n                  node.folder.folder_type === 'category' ? 'text-green-500' :\r\n                  'text-muted-foreground'\r\n                )}\r\n              />\r\n            ) : (\r\n              <Folder\r\n                className={cn(\r\n                  'w-4 h-4 flex-shrink-0',\r\n                  node.folder.folder_type === 'vehicle_root' ? 'text-blue-500' :\r\n                  node.folder.folder_type === 'category' ? 'text-green-500' :\r\n                  'text-muted-foreground'\r\n                )}\r\n              />\r\n            )}\r\n            <span\r\n              className={cn(\r\n                'truncate font-medium',\r\n                isCurrent ? 'text-foreground' : 'text-muted-foreground'\r\n              )}\r\n            >\r\n              {node.folder.name}\r\n            </span>\r\n            {node.folder.document_count !== undefined && node.folder.document_count > 0 && (\r\n              <span className=\"text-xs text-muted-foreground ml-auto\">({node.folder.document_count})</span>\r\n            )}\r\n          </button>\r\n        </div>\r\n\r\n        {isExpanded && hasChildren && (\r\n          <div className=\"mt-0.5\">\r\n            {node.children.map((child) => renderSidebarTreeNode(child, level + 1))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full bg-background\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between px-6 py-4 bg-muted/50 border-b border-border\">\r\n        <div className=\"flex items-center gap-3\">\r\n          {/* Mobile hamburger toggle */}\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"icon\"\r\n            className=\"lg:hidden\"\r\n            onClick={() => setShowTreeDrawer(true)}\r\n          >\r\n            <Menu className=\"h-5 w-5\" />\r\n            <span className=\"sr-only\">Open folder tree</span>\r\n          </Button>\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-foreground\">Document Management</h1>\r\n            <p className=\"text-muted-foreground mt-1 hidden sm:block\">\r\n              Manage documents with hierarchical folder structure\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={() => loadDocuments()}\r\n          >\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            <span className=\"hidden sm:inline\">Refresh</span>\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Grid Layout - Sidebar + Content */}\r\n      <div className=\"flex-1 grid grid-cols-1 lg:grid-cols-[280px_1fr] overflow-hidden\">\r\n        {/* Desktop Sidebar - Always Visible */}\r\n        <aside className=\"hidden lg:flex flex-col border-r border-border bg-muted/30\">\r\n          {/* Sidebar Header */}\r\n          <div className=\"px-4 py-3 border-b border-border\">\r\n            <h2 className=\"text-sm font-semibold text-foreground\">Folders</h2>\r\n          </div>\r\n\r\n          {/* Sidebar Search */}\r\n          <div className=\"px-3 py-3 border-b border-border\">\r\n            <div className=\"relative\">\r\n              <Search\r\n                className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\"\r\n              />\r\n              <Input\r\n                type=\"text\"\r\n                placeholder=\"Search folders...\"\r\n                value={treeSearchQuery}\r\n                onChange={(e) => setTreeSearchQuery(e.target.value)}\r\n                className=\"pl-10 pr-10 h-9 text-sm\"\r\n              />\r\n              {treeSearchQuery && (\r\n                <button\r\n                  onClick={() => setTreeSearchQuery('')}\r\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors\"\r\n                >\r\n                  <X className=\"w-4 h-4\" />\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Sidebar Tree */}\r\n          <ScrollArea className=\"flex-1\">\r\n            <div className=\"px-2 py-2\">\r\n              {/* Root Option */}\r\n              <button\r\n                onClick={() => navigateToFolder(null)}\r\n                className={cn(\r\n                  'flex items-center gap-2 w-full px-3 py-2 rounded-md text-sm font-medium transition-colors',\r\n                  currentFolderId === null\r\n                    ? 'bg-primary/20 text-primary border border-primary'\r\n                    : 'text-muted-foreground hover:bg-muted border border-transparent'\r\n                )}\r\n              >\r\n                <Home className=\"w-4 h-4 flex-shrink-0\" />\r\n                <span>All Documents</span>\r\n              </button>\r\n\r\n              {/* Tree Nodes */}\r\n              <div className=\"mt-2 space-y-0.5\">\r\n                {filteredTree.map((node) => renderSidebarTreeNode(node, 0))}\r\n              </div>\r\n\r\n              {/* Empty State */}\r\n              {filteredTree.length === 0 && (\r\n                <div className=\"text-center py-8 text-sm text-muted-foreground\">\r\n                  {treeSearchQuery ? 'No folders match your search' : 'No folders found'}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </ScrollArea>\r\n\r\n          {/* Initialize Vehicle Folders (if needed) */}\r\n          {vehiclesWithoutFolders.length > 0 && (\r\n            <div className=\"p-3 border-t border-border\">\r\n              <DropdownMenu>\r\n                <DropdownMenuTrigger asChild>\r\n                  <Button variant=\"outline\" size=\"sm\" className=\"w-full border-amber-500/50 bg-amber-500/10 text-amber-600 dark:text-amber-400 hover:bg-amber-500/20\">\r\n                    <FolderPlus className=\"h-4 w-4 mr-2\" />\r\n                    Init Folders ({vehiclesWithoutFolders.length})\r\n                  </Button>\r\n                </DropdownMenuTrigger>\r\n                <DropdownMenuContent>\r\n                  {vehiclesWithoutFolders.map(vehicle => (\r\n                    <DropdownMenuItem\r\n                      key={vehicle.id}\r\n                      onClick={() => handleInitVehicleFolders(vehicle.id)}\r\n                    >\r\n                      {vehicle.name} ({vehicle.type})\r\n                    </DropdownMenuItem>\r\n                  ))}\r\n                </DropdownMenuContent>\r\n              </DropdownMenu>\r\n            </div>\r\n          )}\r\n        </aside>\r\n\r\n        {/* Main Content Area */}\r\n        <main className=\"flex flex-col overflow-hidden\">\r\n          {/* Breadcrumbs */}\r\n          {currentFolder && (\r\n            <FolderBreadcrumbs\r\n              currentFolder={currentFolder}\r\n              onNavigate={navigateToFolder}\r\n            />\r\n          )}\r\n\r\n          {/* Upload Destination Banner */}\r\n          {currentFolder && (\r\n            <UploadDestinationBanner currentFolder={currentFolder} />\r\n          )}\r\n\r\n          {/* Actions Bar */}\r\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-border bg-muted/50\">\r\n            <div className=\"flex items-center gap-3\">\r\n              {navigationHistory.length > 0 && (\r\n                <Button variant=\"ghost\" onClick={navigateBack}>\r\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n                  Back\r\n                </Button>\r\n              )}\r\n              {/* Mobile-only: Initialize Vehicle Folders */}\r\n              {vehiclesWithoutFolders.length > 0 && (\r\n                <div className=\"lg:hidden\">\r\n                  <DropdownMenu>\r\n                    <DropdownMenuTrigger asChild>\r\n                      <Button variant=\"outline\" size=\"sm\" className=\"border-amber-500/50 bg-amber-500/10 text-amber-600 dark:text-amber-400 hover:bg-amber-500/20\">\r\n                        <FolderPlus className=\"h-4 w-4 mr-2\" />\r\n                        Init ({vehiclesWithoutFolders.length})\r\n                      </Button>\r\n                    </DropdownMenuTrigger>\r\n                    <DropdownMenuContent>\r\n                      {vehiclesWithoutFolders.map(vehicle => (\r\n                        <DropdownMenuItem\r\n                          key={vehicle.id}\r\n                          onClick={() => handleInitVehicleFolders(vehicle.id)}\r\n                        >\r\n                          {vehicle.name} ({vehicle.type})\r\n                        </DropdownMenuItem>\r\n                      ))}\r\n                    </DropdownMenuContent>\r\n                  </DropdownMenu>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Button onClick={() => setUploadDialogOpen(true)}>\r\n                <Upload className=\"w-4 h-4 mr-2\" />\r\n                <span className=\"hidden sm:inline\">Upload</span>\r\n              </Button>\r\n              <Button variant=\"outline\" onClick={() => handleCreateFolder()}>\r\n                <FolderPlus className=\"w-4 h-4 mr-2\" />\r\n                <span className=\"hidden sm:inline\">New Folder</span>\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Main Navigator (Folders + Documents) */}\r\n          <div className=\"flex-1 overflow-hidden\">\r\n            <FolderNavigator\r\n              currentFolderId={currentFolderId}\r\n              currentFolder={currentFolder}\r\n              subfolders={getSubfolders}\r\n              documents={filteredDocuments as any}\r\n              isLoading={loading}\r\n              viewMode={viewMode}\r\n              sortBy={sortBy}\r\n              searchQuery={searchQuery}\r\n              onNavigateToFolder={navigateToFolder}\r\n              onDocumentClick={(docId) => {\r\n                const doc = documents.find(d => d.id === docId)\r\n                if (doc) handlePreview(doc)\r\n              }}\r\n              onUploadClick={() => setUploadDialogOpen(true)}\r\n              onCreateFolderClick={() => handleCreateFolder()}\r\n              onRenameFolder={handleRenameFolder}\r\n              onDeleteFolder={handleDeleteFolder}\r\n              onCreateSubfolder={handleCreateFolder}\r\n              onRenameDocument={handleRenameDocument}\r\n              onDeleteDocument={handleDeleteDocument}\r\n              onViewModeChange={setViewMode}\r\n              onSortChange={setSortBy}\r\n              onSearchChange={setSearchQuery}\r\n            />\r\n          </div>\r\n        </main>\r\n      </div>\r\n\r\n      {/* Mobile Tree Drawer */}\r\n      <FolderTreeDrawer\r\n        open={showTreeDrawer}\r\n        onOpenChange={setShowTreeDrawer}\r\n        folders={folders}\r\n        currentFolderId={currentFolderId}\r\n        onNavigate={navigateToFolder}\r\n      />\r\n\r\n      {/* Upload Dialog */}\r\n      <DocumentUploadDialog\r\n        open={uploadDialogOpen}\r\n        onOpenChange={setUploadDialogOpen}\r\n        folderId={currentFolderId}\r\n        currentFolder={currentFolder}\r\n        vehicleId={currentFolder?.vehicle_id || undefined}\r\n        onSuccess={() => loadDocuments()}\r\n      />\r\n\r\n      {/* Move Document Dialog */}\r\n      <MoveDocumentDialog\r\n        open={moveDialogOpen}\r\n        onOpenChange={setMoveDialogOpen}\r\n        documentId={moveDialogDocId}\r\n        documentName={moveDialogDocName}\r\n        currentFolderId={moveDialogCurrentFolder}\r\n        onSuccess={() => loadDocuments()}\r\n      />\r\n\r\n      {/* Create Folder Dialog */}\r\n      <CreateFolderDialog\r\n        open={createFolderDialogOpen}\r\n        onOpenChange={setCreateFolderDialogOpen}\r\n        parentFolderId={createFolderParentId}\r\n        onSuccess={() => loadFolders()}\r\n      />\r\n\r\n      {/* Rename Folder Dialog */}\r\n      <RenameFolderDialog\r\n        open={renameFolderDialogOpen}\r\n        onOpenChange={setRenameFolderDialogOpen}\r\n        folderId={renameFolderId}\r\n        currentName={renameFolderName}\r\n        onSuccess={() => loadFolders()}\r\n      />\r\n\r\n      {/* Rename Document Dialog */}\r\n      <RenameDocumentDialog\r\n        open={renameDocumentDialogOpen}\r\n        onOpenChange={setRenameDocumentDialogOpen}\r\n        documentId={renameDocumentId}\r\n        currentName={renameDocumentName}\r\n        onSuccess={() => loadDocuments()}\r\n      />\r\n\r\n      {/* Document Preview Modal */}\r\n      <DocumentViewerFullscreen\r\n        isOpen={previewOpen}\r\n        document={previewDocument}\r\n        previewUrl={previewUrl}\r\n        isLoading={isLoadingPreview}\r\n        error={previewError}\r\n        onClose={closePreview}\r\n        onDownload={downloadFromPreview}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6309, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/types/documents.ts"],"sourcesContent":["export enum DocumentType {\n  NDA = 'NDA',\n  SUBSCRIPTION = 'Subscription',\n  AGREEMENT = 'Agreement',\n  REPORT = 'Report',\n  STATEMENT = 'Statement',\n  KYC = 'KYC',\n  TAX = 'Tax',\n  TERM_SHEET = 'Term Sheet',\n  LEGAL = 'Legal',\n  OTHER = 'Other'\n}\n\nexport interface DocumentScope {\n  investor?: {\n    id: string\n    legal_name: string\n  }\n  vehicle?: {\n    id: string\n    name: string\n    type: string\n    investment_name?: string\n    logo_url?: string\n  }\n  deal?: {\n    id: string\n    name: string\n    status?: string\n  }\n}\n\nexport interface DocumentWatermark {\n  uploaded_by?: string\n  uploaded_at?: string\n  document_classification?: string\n  verso_holdings_notice?: string\n  compliance_notice?: string\n  original_filename?: string\n}\n\nexport interface Document {\n  id: string\n  type: DocumentType | string\n  file_name: string\n  file_key: string\n  file_size_bytes?: number\n  mime_type?: string\n  created_at: string\n  created_by?: {\n    display_name: string\n    email: string\n  }\n  scope: DocumentScope\n  watermark?: DocumentWatermark\n  metadata?: Record<string, unknown>\n  folder?: {\n    id: string\n    name: string\n    path: string\n  }\n}\n\nexport interface DocumentFilters {\n  type?: string\n  vehicle_id?: string\n  deal_id?: string\n  from_date?: string\n  to_date?: string\n  search?: string\n}\n\nexport interface DocumentsResponse {\n  documents: Document[]\n  pagination: {\n    total: number\n    limit: number\n    offset: number\n    has_more: boolean\n    current_page: number\n    total_pages: number\n  }\n  filters_applied: DocumentFilters\n}\n\nexport interface Vehicle {\n  id: string\n  name: string\n  type: string\n  investment_name?: string\n  logo_url?: string\n}\n\nexport interface Deal {\n  id: string\n  name: string\n  status: string\n}\n\n// ============================================\n// Navigation Types (Folder Explorer)\n// ============================================\n\n/**\n * Folder structure for document organization\n */\nexport interface DocumentFolder {\n  id: string\n  name: string\n  path: string // Full path like \"/Vehicle A/Investor Documents/KYC\"\n  parent_folder_id: string | null\n  folder_type: 'vehicle_root' | 'category' | 'custom'\n  vehicle_id?: string | null\n  created_by?: string\n  created_at: string\n  updated_at: string\n  // Virtual fields (from counts)\n  subfolder_count?: number\n  document_count?: number\n}\n\n/**\n * Breadcrumb segment for navigation\n */\nexport interface Breadcrumb {\n  id: string | null // null for root/home\n  name: string\n  path: string\n}\n\n/**\n * Navigation state for folder explorer\n */\nexport interface NavigationState {\n  currentFolderId: string | null\n  navigationHistory: string[] // Stack for back navigation\n  breadcrumbs: Breadcrumb[]\n}\n\n/**\n * Folder navigation actions\n */\nexport type NavigationAction =\n  | { type: 'NAVIGATE_TO_FOLDER'; folderId: string | null }\n  | { type: 'NAVIGATE_BACK' }\n  | { type: 'NAVIGATE_TO_ROOT' }\n  | { type: 'UPDATE_BREADCRUMBS'; breadcrumbs: Breadcrumb[] }"],"names":[],"mappings":";;;;AAAO,IAAA,AAAK,sCAAA;;;;;;;;;;;WAAA"}},
    {"offset": {"line": 6330, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 6432, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/document-filters.tsx"],"sourcesContent":["'use client'\n\nimport { DocumentType, Vehicle, Deal, DocumentFilters } from '@/types/documents'\nimport { Card, CardContent } from '@/components/ui/card'\nimport { Input } from '@/components/ui/input'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Search,\n  Filter,\n  X,\n  BarChart3,\n  FileBarChart,\n  Receipt,\n  Scale,\n  Lock,\n  PenTool,\n  FileCheck,\n  ClipboardList,\n  UserCheck,\n  Folder,\n  LucideIcon\n} from 'lucide-react'\nimport { useState } from 'react'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\n\ninterface DocumentFiltersProps {\n  vehicles: Vehicle[]\n  deals: Deal[]\n  typeCounts: Record<string, number>\n  appliedFilters: DocumentFilters\n  onChange: (filters: DocumentFilters) => void\n}\n\nexport function DocumentFiltersComponent({\n  vehicles,\n  deals,\n  typeCounts,\n  appliedFilters,\n  onChange\n}: DocumentFiltersProps) {\n  const ALL_VEHICLES_VALUE = '__all_vehicles__'\n  const ALL_DEALS_VALUE = '__all_deals__'\n\n  const [search, setSearch] = useState(appliedFilters.search || '')\n  const [type, setType] = useState(appliedFilters.type || '')\n  const [vehicleId, setVehicleId] = useState(appliedFilters.vehicle_id ?? ALL_VEHICLES_VALUE)\n  const [dealId, setDealId] = useState(appliedFilters.deal_id ?? ALL_DEALS_VALUE)\n\n  const handleApplyFilters = () => {\n    onChange({\n      search: search || undefined,\n      type: type || undefined,\n      vehicle_id: vehicleId === ALL_VEHICLES_VALUE ? undefined : vehicleId,\n      deal_id: dealId === ALL_DEALS_VALUE ? undefined : dealId\n    })\n  }\n\n  const handleClearFilters = () => {\n    setSearch('')\n    setType('')\n    setVehicleId(ALL_VEHICLES_VALUE)\n    setDealId(ALL_DEALS_VALUE)\n    onChange({})\n  }\n\n  const hasFilters = Boolean(\n    (search && search.trim()) ||\n    type ||\n    vehicleId !== ALL_VEHICLES_VALUE ||\n    dealId !== ALL_DEALS_VALUE\n  )\n\n  const documentTypes: { value: DocumentType; label: string; icon: LucideIcon }[] = [\n    { value: DocumentType.STATEMENT, label: 'Statements', icon: BarChart3 },\n    { value: DocumentType.REPORT, label: 'Reports', icon: FileBarChart },\n    { value: DocumentType.TAX, label: 'Tax', icon: Receipt },\n    { value: DocumentType.LEGAL, label: 'Legal', icon: Scale },\n    { value: DocumentType.NDA, label: 'NDAs', icon: Lock },\n    { value: DocumentType.SUBSCRIPTION, label: 'Subscriptions', icon: PenTool },\n    { value: DocumentType.AGREEMENT, label: 'Agreements', icon: FileCheck },\n    { value: DocumentType.TERM_SHEET, label: 'Term Sheets', icon: ClipboardList },\n    { value: DocumentType.KYC, label: 'KYC', icon: UserCheck },\n    { value: DocumentType.OTHER, label: 'Other', icon: Folder }\n  ]\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Quick type filters */}\n      <div className=\"flex flex-wrap gap-2\">\n        {documentTypes.map((docType) => {\n          const count = typeCounts[docType.value] || 0\n          const isActive = type === docType.value\n\n          return (\n            <Badge\n              key={docType.value}\n              variant={isActive ? 'default' : 'outline'}\n              className={`\n                cursor-pointer px-4 py-2 text-sm font-medium transition-all duration-200\n                ${isActive\n                  ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md'\n                  : 'border-2 hover:border-blue-300 hover:bg-blue-50'\n                }\n              `}\n              onClick={() => {\n                setType(isActive ? '' : docType.value)\n                onChange({\n                  ...appliedFilters,\n                  type: isActive ? undefined : docType.value\n                })\n              }}\n            >\n              <docType.icon className=\"h-4 w-4 mr-1.5\" />\n              {docType.label}\n              {count > 0 && (\n                <span className=\"ml-2 text-xs opacity-75\">({count})</span>\n              )}\n            </Badge>\n          )\n        })}\n      </div>\n\n      {/* Advanced filters */}\n      <Card>\n        <CardContent className=\"p-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n            {/* Search */}\n            <div className=\"lg:col-span-2\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\n                <Input\n                  placeholder=\"Search documents...\"\n                  value={search}\n                  onChange={(e) => setSearch(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') handleApplyFilters()\n                  }}\n                  className=\"pl-10\"\n                />\n              </div>\n            </div>\n\n            {/* Vehicle filter */}\n            {vehicles.length > 0 && (\n              <div>\n                <Select value={vehicleId} onValueChange={setVehicleId}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All vehicles\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value={ALL_VEHICLES_VALUE}>All vehicles</SelectItem>\n                    {vehicles.map((vehicle) => (\n                      <SelectItem key={vehicle.id} value={vehicle.id}>\n                        {vehicle.name}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            )}\n\n            {/* Deal filter */}\n            {deals.length > 0 && (\n              <div>\n                <Select value={dealId} onValueChange={setDealId}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All deals\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value={ALL_DEALS_VALUE}>All deals</SelectItem>\n                    {deals.map((deal) => (\n                      <SelectItem key={deal.id} value={deal.id}>\n                        {deal.name}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            )}\n\n            {/* Actions */}\n            <div className=\"flex gap-2 lg:col-span-4 md:col-span-2\">\n              <Button\n                onClick={handleApplyFilters}\n                className=\"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700\"\n              >\n                <Filter className=\"h-4 w-4 mr-2\" />\n                Apply Filters\n              </Button>\n\n              {hasFilters && (\n                <Button\n                  variant=\"outline\"\n                  onClick={handleClearFilters}\n                  className=\"border-2 hover:bg-red-50 hover:border-red-300\"\n                >\n                  <X className=\"h-4 w-4 mr-2\" />\n                  Clear\n                </Button>\n              )}\n            </div>\n          </div>\n\n          {/* Active filters display */}\n          {hasFilters && (\n            <div className=\"flex flex-wrap gap-2 mt-4 pt-4 border-t\">\n              <span className=\"text-sm text-gray-600 font-medium\">Active filters:</span>\n              {type && (\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  Type: {type}\n                  <X\n                    className=\"h-3 w-3 cursor-pointer hover:text-red-600\"\n                    onClick={() => {\n                      setType('')\n                      handleApplyFilters()\n                    }}\n                  />\n                </Badge>\n              )}\n              {vehicleId !== ALL_VEHICLES_VALUE && (\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  Vehicle: {vehicles.find(v => v.id === vehicleId)?.name || 'Unknown'}\n                  <X\n                    className=\"h-3 w-3 cursor-pointer hover:text-red-600\"\n                    onClick={() => {\n                      setVehicleId(ALL_VEHICLES_VALUE)\n                      handleApplyFilters()\n                    }}\n                  />\n                </Badge>\n              )}\n              {dealId !== ALL_DEALS_VALUE && (\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  Deal: {deals.find(d => d.id === dealId)?.name || 'Unknown'}\n                  <X\n                    className=\"h-3 w-3 cursor-pointer hover:text-red-600\"\n                    onClick={() => {\n                      setDealId(ALL_DEALS_VALUE)\n                      handleApplyFilters()\n                    }}\n                  />\n                </Badge>\n              )}\n              {search && (\n                <Badge variant=\"secondary\" className=\"gap-1\">\n                  Search: {search}\n                  <X\n                    className=\"h-3 w-3 cursor-pointer hover:text-red-600\"\n                    onClick={() => {\n                      setSearch('')\n                      handleApplyFilters()\n                    }}\n                  />\n                </Badge>\n              )}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6928, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/categorized-documents-client.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useMemo, useState } from 'react'\r\nimport Image from 'next/image'\r\nimport { Document, Vehicle, DocumentFilters } from '@/types/documents'\r\nimport { DocumentCard } from './document-card'\r\nimport { DocumentFiltersComponent } from './document-filters'\r\nimport { useDocumentViewer } from '@/hooks/useDocumentViewer'\r\nimport { DocumentViewerFullscreen } from './DocumentViewerFullscreen'\r\nimport { Card, CardContent } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  ArrowLeft,\r\n  BarChart3,\r\n  Building2,\r\n  ChevronDown,\r\n  ChevronRight,\r\n  FileCheck,\r\n  FileText,\r\n  Folder,\r\n  FolderOpen,\r\n  Home,\r\n  Lock,\r\n  Shield,\r\n  Briefcase\r\n} from 'lucide-react'\r\n\r\ninterface CategorizedDocumentsClientProps {\r\n  initialDocuments: Document[]\r\n  vehicles: Vehicle[]\r\n}\r\n\r\n// Document category configuration (excluding KYC - that stays in Profile)\r\nconst DOCUMENT_CATEGORIES = {\r\n  agreements: {\r\n    id: 'agreements',\r\n    name: 'Agreements',\r\n    icon: FileCheck,\r\n    color: 'blue',\r\n    description: 'Subscription agreements, LPAs, side letters',\r\n    types: ['Subscription', 'Agreement', 'subscription', 'agreement', 'subscription_pack', 'subscription_draft']\r\n  },\r\n  statements: {\r\n    id: 'statements',\r\n    name: 'Statements',\r\n    icon: BarChart3,\r\n    color: 'purple',\r\n    description: 'Position statements, capital calls, distributions',\r\n    types: ['Statement', 'statement', 'capital_call']\r\n  },\r\n  ndas: {\r\n    id: 'ndas',\r\n    name: 'NDAs',\r\n    icon: Lock,\r\n    color: 'amber',\r\n    description: 'Non-disclosure agreements',\r\n    types: ['NDA', 'nda']\r\n  },\r\n  reports: {\r\n    id: 'reports',\r\n    name: 'Reports & Tax',\r\n    icon: FileText,\r\n    color: 'indigo',\r\n    description: 'Performance reports, tax packs, investor letters',\r\n    types: ['Report', 'report', 'Tax', 'tax', 'memo']\r\n  }\r\n}\r\n\r\ntype CategoryId = keyof typeof DOCUMENT_CATEGORIES\r\n\r\ntype HoldingWithCategories = {\r\n  id: string\r\n  name: string\r\n  type: string | null\r\n  vehicle: Document['scope']['vehicle']\r\n  categories: Record<CategoryId, Document[]>\r\n  totalDocuments: number\r\n}\r\n\r\nfunction getCategoryForDocumentType(type: string): CategoryId | null {\r\n  for (const [categoryId, category] of Object.entries(DOCUMENT_CATEGORIES)) {\r\n    if (category.types.includes(type)) {\r\n      return categoryId as CategoryId\r\n    }\r\n  }\r\n  return 'reports' // Default to reports for unknown types\r\n}\r\n\r\nfunction getCategoryColor(color: string) {\r\n  const colors = {\r\n    blue: 'bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-700',\r\n    purple: 'bg-purple-100 dark:bg-purple-900/40 text-purple-700 dark:text-purple-300 border-purple-200 dark:border-purple-700',\r\n    amber: 'bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300 border-amber-200 dark:border-amber-700',\r\n    indigo: 'bg-indigo-100 dark:bg-indigo-900/40 text-indigo-700 dark:text-indigo-300 border-indigo-200 dark:border-indigo-700'\r\n  }\r\n  return colors[color as keyof typeof colors] || colors.blue\r\n}\r\n\r\nfunction getCategoryIconColor(color: string) {\r\n  const colors = {\r\n    blue: 'text-blue-600 dark:text-blue-400',\r\n    purple: 'text-purple-600 dark:text-purple-400',\r\n    amber: 'text-amber-600 dark:text-amber-400',\r\n    indigo: 'text-indigo-600 dark:text-indigo-400'\r\n  }\r\n  return colors[color as keyof typeof colors] || colors.blue\r\n}\r\n\r\nexport function CategorizedDocumentsClient({\r\n  initialDocuments,\r\n  vehicles\r\n}: CategorizedDocumentsClientProps) {\r\n  const [selectedHolding, setSelectedHolding] = useState<string | null>(null)\r\n  const [expandedCategories, setExpandedCategories] = useState<Set<string>>(new Set())\r\n  const [filters, setFilters] = useState<DocumentFilters>({})\r\n  const documentViewer = useDocumentViewer()\r\n\r\n  // Filter documents: exclude KYC (stays in Profile), exclude deal-specific except NDAs/subscriptions\r\n  const displayableDocuments = useMemo(() => {\r\n    let docs = initialDocuments.filter(doc => {\r\n      // Exclude KYC documents - they belong in Profile\r\n      if (doc.type.toLowerCase() === 'kyc') return false\r\n\r\n      // Include if no deal scope, or if it's an NDA/subscription\r\n      return !doc.scope.deal ||\r\n        doc.type === 'nda' ||\r\n        doc.type === 'subscription_pack' ||\r\n        doc.type === 'subscription'\r\n    })\r\n\r\n    // Apply vehicle/holding filter\r\n    if (filters.vehicle_id) {\r\n      docs = docs.filter(doc => doc.scope.vehicle?.id === filters.vehicle_id)\r\n    }\r\n\r\n    // Apply type filter\r\n    if (filters.type) {\r\n      docs = docs.filter(doc =>\r\n        doc.type.toLowerCase() === filters.type?.toLowerCase()\r\n      )\r\n    }\r\n\r\n    // Apply search filter\r\n    if (filters.search) {\r\n      const search = filters.search.toLowerCase()\r\n      docs = docs.filter(doc =>\r\n        doc.file_name?.toLowerCase().includes(search) ||\r\n        (doc as any).name?.toLowerCase().includes(search)\r\n      )\r\n    }\r\n\r\n    return docs\r\n  }, [initialDocuments, filters])\r\n\r\n  // Calculate type counts for filter badges\r\n  const typeCounts = useMemo(() => {\r\n    const counts: Record<string, number> = {}\r\n    displayableDocuments.forEach(doc => {\r\n      counts[doc.type] = (counts[doc.type] || 0) + 1\r\n    })\r\n    return counts\r\n  }, [displayableDocuments])\r\n\r\n  // Group documents by holding/investment FIRST, then by category within each holding\r\n  const holdingsWithDocuments = useMemo(() => {\r\n    const holdingMap = new Map<string, HoldingWithCategories>()\r\n\r\n    displayableDocuments.forEach((doc) => {\r\n      const vehicle = doc.scope.vehicle\r\n      const holdingId = vehicle?.id ?? 'general'\r\n      const holdingName = vehicle?.investment_name || vehicle?.name || 'General Documents'\r\n      const holdingType = vehicle?.type ?? null\r\n\r\n      if (!holdingMap.has(holdingId)) {\r\n        holdingMap.set(holdingId, {\r\n          id: holdingId,\r\n          name: holdingName,\r\n          type: holdingType,\r\n          vehicle,\r\n          categories: {\r\n            agreements: [],\r\n            statements: [],\r\n            ndas: [],\r\n            reports: []\r\n          },\r\n          totalDocuments: 0\r\n        })\r\n      }\r\n\r\n      const holding = holdingMap.get(holdingId)!\r\n      const categoryId = getCategoryForDocumentType(doc.type) ?? 'reports'\r\n      holding.categories[categoryId].push(doc)\r\n      holding.totalDocuments++\r\n    })\r\n\r\n    // Sort: named holdings first (alphabetically), then General at end\r\n    return Array.from(holdingMap.values()).sort((a, b) => {\r\n      if (a.id === 'general') return 1\r\n      if (b.id === 'general') return -1\r\n      return a.name.localeCompare(b.name)\r\n    })\r\n  }, [displayableDocuments])\r\n\r\n  const totalDocuments = displayableDocuments.length\r\n\r\n  const toggleCategory = (categoryKey: string) => {\r\n    const newExpanded = new Set(expandedCategories)\r\n    if (newExpanded.has(categoryKey)) {\r\n      newExpanded.delete(categoryKey)\r\n    } else {\r\n      newExpanded.add(categoryKey)\r\n    }\r\n    setExpandedCategories(newExpanded)\r\n  }\r\n\r\n  // Holdings overview (main view)\r\n  if (!selectedHolding) {\r\n    return (\r\n      <div className=\"p-6 space-y-8\">\r\n        {/* Header */}\r\n        <div className=\"relative border-b border-border pb-8 mb-2\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900/50 dark:via-blue-900/30 dark:to-indigo-900/30 opacity-60 rounded-t-2xl\" />\r\n          <div className=\"relative flex items-center justify-between\">\r\n            <div>\r\n              <div className=\"flex items-center gap-3 mb-2\">\r\n                <div className=\"w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg\">\r\n                  <Briefcase className=\"h-6 w-6 text-white\" />\r\n                </div>\r\n                <h1 className=\"text-4xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent\">\r\n                  Investment Documents\r\n                </h1>\r\n              </div>\r\n              <p className=\"text-lg text-muted-foreground ml-15\">\r\n                Access documents organized by your investments\r\n              </p>\r\n            </div>\r\n            <div className=\"text-right bg-background/80 backdrop-blur-sm rounded-xl px-6 py-4 shadow-sm border border-border\">\r\n              <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\">Total Documents</p>\r\n              <p className=\"text-3xl font-bold text-foreground mt-1\">{totalDocuments}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <DocumentFiltersComponent\r\n          vehicles={vehicles}\r\n          deals={[]}\r\n          typeCounts={typeCounts}\r\n          appliedFilters={filters}\r\n          onChange={setFilters}\r\n        />\r\n\r\n        {/* Holdings List */}\r\n        <div className=\"space-y-4\">\r\n          <h2 className=\"text-2xl font-bold text-foreground mb-6\">Your Investments</h2>\r\n\r\n          {holdingsWithDocuments.length === 0 ? (\r\n            <Card className=\"border-2 border-border\">\r\n              <CardContent className=\"p-12 text-center\">\r\n                <Folder className=\"h-16 w-16 text-muted-foreground mx-auto mb-6\" />\r\n                <h3 className=\"text-xl font-semibold text-foreground mb-3\">\r\n                  No documents available\r\n                </h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Documents will appear here once they are uploaded by the VERSO team.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              {holdingsWithDocuments.map((holding) => (\r\n                <Card\r\n                  key={holding.id}\r\n                  className=\"border-2 border-border hover:border-blue-400 dark:hover:border-blue-600 hover:shadow-xl transition-all duration-300 cursor-pointer group bg-card overflow-hidden\"\r\n                  onClick={() => setSelectedHolding(holding.id)}\r\n                >\r\n                  <CardContent className=\"p-0\">\r\n                    {/* Holding Header */}\r\n                    <div className=\"p-6 bg-gradient-to-r from-slate-50 to-blue-50 dark:from-slate-900/50 dark:to-blue-900/30 border-b border-border\">\r\n                      <div className=\"flex items-start justify-between\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <div className=\"w-14 h-14 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform overflow-hidden\">\r\n                            {holding.vehicle?.logo_url ? (\r\n                              <Image\r\n                                src={holding.vehicle.logo_url}\r\n                                alt={holding.name}\r\n                                width={56}\r\n                                height={56}\r\n                                className=\"object-cover w-full h-full\"\r\n                              />\r\n                            ) : (\r\n                              <div className=\"w-full h-full bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center\">\r\n                                <Building2 className=\"h-7 w-7 text-white\" />\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                          <div>\r\n                            <h3 className=\"text-xl font-bold text-foreground group-hover:text-blue-700 dark:group-hover:text-blue-400 transition-colors\">\r\n                              {holding.name}\r\n                            </h3>\r\n                            {holding.type && (\r\n                              <p className=\"text-sm text-muted-foreground uppercase tracking-wide mt-0.5\">\r\n                                {holding.type}\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <ChevronRight className=\"h-6 w-6 text-muted-foreground group-hover:text-blue-600 dark:group-hover:text-blue-400 group-hover:translate-x-1 transition-all\" />\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Category Summary */}\r\n                    <div className=\"p-6 space-y-3\">\r\n                      <div className=\"grid grid-cols-2 gap-2\">\r\n                        {Object.entries(DOCUMENT_CATEGORIES).map(([catId, category]) => {\r\n                          const docs = holding.categories[catId as CategoryId]\r\n                          if (docs.length === 0) return null\r\n                          const Icon = category.icon\r\n                          return (\r\n                            <div\r\n                              key={catId}\r\n                              className={`flex items-center gap-2 px-3 py-2 rounded-lg border ${getCategoryColor(category.color)}`}\r\n                            >\r\n                              <Icon className={`h-4 w-4 ${getCategoryIconColor(category.color)}`} />\r\n                              <span className=\"text-sm font-medium\">{category.name}</span>\r\n                              <Badge variant=\"secondary\" className=\"ml-auto text-xs\">\r\n                                {docs.length}\r\n                              </Badge>\r\n                            </div>\r\n                          )\r\n                        })}\r\n                      </div>\r\n\r\n                      <div className=\"pt-3 border-t border-border flex items-center justify-between\">\r\n                        <span className=\"text-sm text-muted-foreground\">Total documents</span>\r\n                        <Badge variant=\"outline\" className=\"font-semibold border-2\">\r\n                          {holding.totalDocuments}\r\n                        </Badge>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Security Notice */}\r\n        <Card className=\"border-blue-200 dark:border-blue-800 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/50 dark:to-indigo-950/50 border-2\">\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"p-3 bg-blue-100 dark:bg-blue-900/50 rounded-xl\">\r\n                <Shield className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\r\n              </div>\r\n              <div>\r\n                <div className=\"font-bold text-blue-900 dark:text-blue-100 text-lg mb-1\">Document Security & Compliance</div>\r\n                <div className=\"text-blue-700 dark:text-blue-300 leading-relaxed\">\r\n                  All documents are watermarked with your name and download timestamp.\r\n                  Access is logged for compliance and security purposes as required by BVI FSC and GDPR regulations.\r\n                  Download links expire after 15 minutes for security.\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Selected holding detail view\r\n  const selectedHoldingData = holdingsWithDocuments.find(h => h.id === selectedHolding)\r\n\r\n  if (!selectedHoldingData) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-8\">\r\n      {/* Header with breadcrumb */}\r\n      <div className=\"relative border-b border-border pb-8 mb-2\">\r\n        <div className=\"absolute inset-0 bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900/50 dark:via-blue-900/30 dark:to-indigo-900/30 opacity-60 rounded-t-2xl\" />\r\n        <div className=\"relative\">\r\n          {/* Breadcrumb */}\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() => setSelectedHolding(null)}\r\n              className=\"text-muted-foreground hover:text-foreground\"\r\n            >\r\n              <Home className=\"h-4 w-4 mr-2\" />\r\n              Investments\r\n            </Button>\r\n            <ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\r\n            <span className=\"text-sm font-medium text-foreground\">{selectedHoldingData.name}</span>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"lg\"\r\n                onClick={() => setSelectedHolding(null)}\r\n                className=\"border-2\"\r\n              >\r\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n                Back\r\n              </Button>\r\n\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"w-14 h-14 rounded-xl flex items-center justify-center shadow-lg overflow-hidden\">\r\n                  {selectedHoldingData.vehicle?.logo_url ? (\r\n                    <Image\r\n                      src={selectedHoldingData.vehicle.logo_url}\r\n                      alt={selectedHoldingData.name}\r\n                      width={56}\r\n                      height={56}\r\n                      className=\"object-cover w-full h-full\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-full h-full bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center\">\r\n                      <Building2 className=\"h-7 w-7 text-white\" />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div>\r\n                  <h1 className=\"text-3xl font-bold text-foreground\">{selectedHoldingData.name}</h1>\r\n                  {selectedHoldingData.type && (\r\n                    <p className=\"text-sm text-muted-foreground uppercase tracking-wide mt-0.5\">\r\n                      {selectedHoldingData.type}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <Badge variant=\"outline\" className=\"text-lg px-4 py-2 bg-background/80 backdrop-blur-sm border-2\">\r\n              {selectedHoldingData.totalDocuments} document{selectedHoldingData.totalDocuments !== 1 ? 's' : ''}\r\n            </Badge>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Document Categories as Expandable Folders */}\r\n      <div className=\"space-y-4\">\r\n        {Object.entries(DOCUMENT_CATEGORIES).map(([categoryId, category]) => {\r\n          const docs = selectedHoldingData.categories[categoryId as CategoryId]\r\n          if (docs.length === 0) return null\r\n\r\n          const Icon = category.icon\r\n          const isExpanded = expandedCategories.has(categoryId)\r\n          const categoryKey = `${selectedHolding}-${categoryId}`\r\n\r\n          return (\r\n            <div key={categoryId} className=\"border-2 border-border rounded-xl bg-card overflow-hidden shadow-sm\">\r\n              {/* Category Header (clickable) */}\r\n              <button\r\n                onClick={() => toggleCategory(categoryId)}\r\n                className=\"w-full px-6 py-4 flex items-center justify-between hover:bg-muted/50 transition-colors\"\r\n              >\r\n                <div className=\"flex items-center gap-4\">\r\n                  {isExpanded ? (\r\n                    <ChevronDown className=\"h-5 w-5 text-muted-foreground\" />\r\n                  ) : (\r\n                    <ChevronRight className=\"h-5 w-5 text-muted-foreground\" />\r\n                  )}\r\n                  <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${getCategoryColor(category.color)} border`}>\r\n                    {isExpanded ? (\r\n                      <FolderOpen className={`h-5 w-5 ${getCategoryIconColor(category.color)}`} />\r\n                    ) : (\r\n                      <Icon className={`h-5 w-5 ${getCategoryIconColor(category.color)}`} />\r\n                    )}\r\n                  </div>\r\n                  <div className=\"text-left\">\r\n                    <h3 className=\"text-lg font-semibold text-foreground\">{category.name}</h3>\r\n                    <p className=\"text-sm text-muted-foreground\">{category.description}</p>\r\n                  </div>\r\n                </div>\r\n                <Badge variant=\"outline\" className=\"text-sm font-semibold border-2\">\r\n                  {docs.length} document{docs.length !== 1 ? 's' : ''}\r\n                </Badge>\r\n              </button>\r\n\r\n              {/* Documents List (expanded) */}\r\n              {isExpanded && (\r\n                <div className=\"border-t border-border bg-muted/30\">\r\n                  <div className=\"p-4 space-y-3\">\r\n                    {docs.map((document) => (\r\n                      <DocumentCard\r\n                        key={document.id}\r\n                        document={document}\r\n                        onPreview={documentViewer.openPreview}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )\r\n        })}\r\n      </div>\r\n\r\n      {/* Security Notice */}\r\n      <Card className=\"border-blue-200 dark:border-blue-800 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/50 dark:to-indigo-950/50 border-2\">\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"flex items-start gap-4\">\r\n            <div className=\"p-3 bg-blue-100 dark:bg-blue-900/50 rounded-xl\">\r\n              <Shield className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\r\n            </div>\r\n            <div>\r\n              <div className=\"font-bold text-blue-900 dark:text-blue-100 text-lg mb-1\">Document Security</div>\r\n              <div className=\"text-blue-700 dark:text-blue-300 leading-relaxed\">\r\n                All documents are watermarked and tracked. Download links expire after 15 minutes.\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Document Preview - Full Screen */}\r\n      <DocumentViewerFullscreen\r\n        isOpen={documentViewer.isOpen}\r\n        document={documentViewer.document}\r\n        previewUrl={documentViewer.previewUrl}\r\n        isLoading={documentViewer.isLoading}\r\n        error={documentViewer.error}\r\n        onClose={documentViewer.closePreview}\r\n        onDownload={documentViewer.downloadDocument}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}