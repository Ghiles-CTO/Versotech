{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28staff%29/versotech/staff/versosign/versosign-page-client.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const VersoSignPageClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call VersoSignPageClient() from the server but VersoSignPageClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/app/(staff)/versotech/staff/versosign/versosign-page-client.tsx <module evaluation>\",\n    \"VersoSignPageClient\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,sBAAsB,IAAA,+RAAuB,EACtD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,sHACA","ignoreList":[0]}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28staff%29/versotech/staff/versosign/versosign-page-client.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const VersoSignPageClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call VersoSignPageClient() from the server but VersoSignPageClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/app/(staff)/versotech/staff/versosign/versosign-page-client.tsx\",\n    \"VersoSignPageClient\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,sBAAsB,IAAA,+RAAuB,EACtD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,kGACA","ignoreList":[0]}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28main%29/versotech_main/versosign/placement-agreement-signing-section.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const PlacementAgreementSigningSection = registerClientReference(\n    function() { throw new Error(\"Attempted to call PlacementAgreementSigningSection() from the server but PlacementAgreementSigningSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/app/(main)/versotech_main/versosign/placement-agreement-signing-section.tsx <module evaluation>\",\n    \"PlacementAgreementSigningSection\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,mCAAmC,IAAA,+RAAuB,EACnE;IAAa,MAAM,IAAI,MAAM;AAAgR,GAC7S,kIACA","ignoreList":[0]}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28main%29/versotech_main/versosign/placement-agreement-signing-section.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const PlacementAgreementSigningSection = registerClientReference(\n    function() { throw new Error(\"Attempted to call PlacementAgreementSigningSection() from the server but PlacementAgreementSigningSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/app/(main)/versotech_main/versosign/placement-agreement-signing-section.tsx\",\n    \"PlacementAgreementSigningSection\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,mCAAmC,IAAA,+RAAuB,EACnE;IAAa,MAAM,IAAI,MAAM;AAAgR,GAC7S,8GACA","ignoreList":[0]}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28main%29/versotech_main/versosign/page.tsx"],"sourcesContent":["import { createClient, createServiceClient } from '@/lib/supabase/server'\r\nimport { VersoSignPageClient } from '@/app/(staff)/versotech/staff/versosign/versosign-page-client'\r\nimport { AlertCircle } from 'lucide-react'\r\nimport type { SignatureGroup, SignatureTask, ExpiredSignature } from '@/app/(staff)/versotech/staff/versosign/page'\r\n// IntroducerAgreementSigningSection removed - introducer agreements now use standard task flow\r\nimport { PlacementAgreementSigningSection } from './placement-agreement-signing-section'\r\nimport { checkStaffAccess } from '@/lib/auth'\r\nimport { cookies } from 'next/headers'\r\n\r\nexport const dynamic = 'force-dynamic'\r\n\r\ntype PlacementAgreementForSigning = {\r\n  id: string\r\n  status: string\r\n  default_commission_bps: number | null\r\n  commercial_partner: {\r\n    id: string\r\n    legal_name: string\r\n    display_name: string | null\r\n    email: string | null\r\n  }\r\n  ceo_signature_request_id: string | null\r\n  cp_signature_request_id: string | null\r\n  arranger_signature_request_id: string | null\r\n  arranger_id: string | null\r\n  pdf_url: string | null\r\n  created_at: string\r\n}\r\n\r\n/**\r\n * VersoSign Page for Unified Portal (versotech_main)\r\n *\r\n * Persona-aware signature management:\r\n * - Staff/CEO personas: Full access to all signature tasks\r\n * - Lawyers: Access to subscription pack signature tasks for their assigned deals\r\n * - Investors/Partners/CPs: Access to their own signature tasks (countersignatures, sub packs)\r\n */\r\nexport default async function VersoSignPage() {\r\n  const clientSupabase = await createClient()\r\n  const { data: { user }, error: userError } = await clientSupabase.auth.getUser()\r\n\r\n  if (!user || userError) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"text-center py-16\">\r\n          <AlertCircle className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n          <h3 className=\"text-lg font-medium text-foreground mb-2\">\r\n            Authentication Required\r\n          </h3>\r\n          <p className=\"text-muted-foreground\">\r\n            Please log in to view VersoSign.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Check user personas for access level\r\n  const isStaff = await checkStaffAccess(user.id)\r\n  const serviceSupabase = createServiceClient()\r\n\r\n  const { data: personas } = await serviceSupabase.rpc('get_user_personas', {\r\n    p_user_id: user.id\r\n  })\r\n  const isLawyer = personas?.some((p: any) => p.persona_type === 'lawyer') || false\r\n  const isIntroducer = personas?.some((p: any) => p.persona_type === 'introducer') || false\r\n  const isArranger = personas?.some((p: any) => p.persona_type === 'arranger') || false\r\n  const isPartner = personas?.some((p: any) => p.persona_type === 'partner') || false\r\n  const isCommercialPartner = personas?.some((p: any) => p.persona_type === 'commercial_partner') || false\r\n\r\n  // Get ACTIVE persona from cookie - filter tasks by active persona only\r\n  const cookieStore = await cookies()\r\n  const activePersonaType = cookieStore.get('verso_active_persona_type')?.value\r\n\r\n  // Determine which persona queries should run based on ACTIVE persona\r\n  const shouldShowStaffTasks = isStaff && (activePersonaType === 'ceo' || activePersonaType === 'staff' || !activePersonaType)\r\n  const shouldShowArrangerTasks = isArranger && activePersonaType === 'arranger'\r\n  const shouldShowInvestorTasks = activePersonaType === 'investor'\r\n  const shouldShowLawyerTasks = isLawyer && activePersonaType === 'lawyer'\r\n  const shouldShowIntroducerTasks = isIntroducer && activePersonaType === 'introducer'\r\n  const shouldShowCPTasks = isCommercialPartner && activePersonaType === 'commercial_partner'\r\n\r\n  // Get partner IDs if user has partner persona\r\n  let partnerIds: string[] = []\r\n  if (isPartner) {\r\n    const { data: partnerLinks } = await serviceSupabase\r\n      .from('partner_users')\r\n      .select('partner_id')\r\n      .eq('user_id', user.id)\r\n    partnerIds = partnerLinks?.map(link => link.partner_id) || []\r\n  }\r\n\r\n  // Get arranger IDs if user has arranger persona\r\n  let arrangerIds: string[] = []\r\n  if (isArranger) {\r\n    const { data: arrangerLinks } = await serviceSupabase\r\n      .from('arranger_users')\r\n      .select('arranger_id')\r\n      .eq('user_id', user.id)\r\n    arrangerIds = arrangerLinks?.map(link => link.arranger_id) || []\r\n  }\r\n\r\n  // Get introducer IDs if user has introducer persona\r\n  let introducerIds: string[] = []\r\n  if (isIntroducer) {\r\n    const { data: introducerLinks } = await serviceSupabase\r\n      .from('introducer_users')\r\n      .select('introducer_id')\r\n      .eq('user_id', user.id)\r\n    introducerIds = introducerLinks?.map(link => link.introducer_id) || []\r\n  }\r\n\r\n  // Get commercial partner IDs if user has commercial_partner persona\r\n  let commercialPartnerIds: string[] = []\r\n  if (isCommercialPartner) {\r\n    const { data: cpLinks } = await serviceSupabase\r\n      .from('commercial_partner_users')\r\n      .select('commercial_partner_id')\r\n      .eq('user_id', user.id)\r\n    commercialPartnerIds = cpLinks?.map(link => link.commercial_partner_id) || []\r\n  }\r\n\r\n  // Get CEO entity ID if user is a CEO member\r\n  // This allows CEO members to see tasks owned by the CEO entity\r\n  let ceoEntityId: string | null = null\r\n  const { data: ceoMembership } = await serviceSupabase\r\n    .from('ceo_users')\r\n    .select('user_id')\r\n    .eq('user_id', user.id)\r\n    .maybeSingle()\r\n\r\n  if (ceoMembership) {\r\n    const { data: ceoEntity } = await serviceSupabase\r\n      .from('ceo_entity')\r\n      .select('id')\r\n      .limit(1)\r\n      .single()\r\n    ceoEntityId = ceoEntity?.id || null\r\n  }\r\n\r\n  // Introducer agreements now use standard task flow - no separate section needed\r\n\r\n  // Fetch placement agreements pending signature\r\n  let placementAgreementsForSigning: PlacementAgreementForSigning[] = []\r\n  const fetchedPlacementAgreementIds = new Set<string>()\r\n\r\n  if (isStaff) {\r\n    // CEO/Staff: See agreements approved and waiting for CEO signature (non-arranger agreements)\r\n    const { data: placementData } = await serviceSupabase\r\n      .from('placement_agreements')\r\n      .select(`\r\n        id, status, default_commission_bps, pdf_url, created_at,\r\n        ceo_signature_request_id, cp_signature_request_id,\r\n        arranger_signature_request_id, arranger_id,\r\n        commercial_partner:commercial_partner_id (id, legal_name, display_name, email)\r\n      `)\r\n      .eq('status', 'approved')\r\n      .is('arranger_id', null)  // Only non-arranger agreements for CEO\r\n      .order('created_at', { ascending: false })\r\n\r\n    for (const agreement of (placementData || [])) {\r\n      if (!fetchedPlacementAgreementIds.has(agreement.id)) {\r\n        placementAgreementsForSigning.push(agreement as unknown as PlacementAgreementForSigning)\r\n        fetchedPlacementAgreementIds.add(agreement.id)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (isArranger && arrangerIds.length > 0) {\r\n    // Arranger: See their placement agreements pending signature\r\n    const { data: arrangerPlacementData } = await serviceSupabase\r\n      .from('placement_agreements')\r\n      .select(`\r\n        id, status, default_commission_bps, pdf_url, created_at,\r\n        ceo_signature_request_id, cp_signature_request_id,\r\n        arranger_signature_request_id, arranger_id,\r\n        commercial_partner:commercial_partner_id (id, legal_name, display_name, email)\r\n      `)\r\n      .in('arranger_id', arrangerIds)\r\n      .eq('status', 'approved')\r\n      .order('created_at', { ascending: false })\r\n\r\n    for (const agreement of (arrangerPlacementData || [])) {\r\n      if (!fetchedPlacementAgreementIds.has(agreement.id)) {\r\n        placementAgreementsForSigning.push(agreement as unknown as PlacementAgreementForSigning)\r\n        fetchedPlacementAgreementIds.add(agreement.id)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Get investor IDs if user has investor persona\r\n  let investorIds: string[] = []\r\n  const hasInvestorAccess = personas?.some((p: any) => p.persona_type === 'investor') || false\r\n  if (hasInvestorAccess) {\r\n    const { data: investorLinks } = await serviceSupabase\r\n      .from('investor_users')\r\n      .select('investor_id')\r\n      .eq('user_id', user.id)\r\n\r\n    investorIds = investorLinks?.map(link => link.investor_id) || []\r\n  }\r\n\r\n  // Get lawyer IDs if user has lawyer persona\r\n  let lawyerIds: string[] = []\r\n  if (isLawyer) {\r\n    const { data: lawyerLinks } = await serviceSupabase\r\n      .from('lawyer_users')\r\n      .select('lawyer_id')\r\n      .eq('user_id', user.id)\r\n    lawyerIds = lawyerLinks?.map(link => link.lawyer_id) || []\r\n  }\r\n\r\n  // Fetch signature tasks for this user using ADDITIVE model\r\n  // Users with multiple personas see tasks from ALL their personas (no more else-if priority bug)\r\n  let tasks: any[] = []\r\n  const fetchedTaskIds = new Set<string>()\r\n\r\n  // Helper to add tasks without duplicates\r\n  const addTasksWithDedup = (newTasks: any[]) => {\r\n    for (const task of newTasks) {\r\n      if (!fetchedTaskIds.has(task.id)) {\r\n        tasks.push(task)\r\n        fetchedTaskIds.add(task.id)\r\n      }\r\n    }\r\n  }\r\n\r\n  // 1. Staff/CEO: See their OWN signature tasks AND tasks owned by CEO entity (if CEO member)\r\n  // ONLY runs if active persona is ceo/staff\r\n  if (shouldShowStaffTasks) {\r\n    // Build query for staff tasks: user-owned OR CEO-entity-owned (if user is CEO member)\r\n    let staffTasksQuery = serviceSupabase\r\n      .from('tasks')\r\n      .select('*')\r\n      .in('kind', ['countersignature', 'subscription_pack_signature', 'other'])\r\n      .order('due_at', { ascending: true, nullsFirst: false })\r\n\r\n    if (ceoEntityId) {\r\n      // CEO member: see both user-owned AND CEO-entity-owned tasks\r\n      staffTasksQuery = staffTasksQuery.or(`owner_user_id.eq.${user.id},owner_ceo_entity_id.eq.${ceoEntityId}`)\r\n    } else {\r\n      // Non-CEO staff: only see their own tasks\r\n      staffTasksQuery = staffTasksQuery.eq('owner_user_id', user.id)\r\n    }\r\n\r\n    const { data: staffTasks } = await staffTasksQuery\r\n    addTasksWithDedup(staffTasks || [])\r\n  }\r\n\r\n  // 2. Lawyer: See subscription_pack_signature tasks for assigned deals\r\n  // ONLY runs if active persona is lawyer\r\n  if (shouldShowLawyerTasks && lawyerIds.length > 0) {\r\n    const { data: lawyerAssignments } = await serviceSupabase\r\n      .from('deal_lawyer_assignments')\r\n      .select('deal_id')\r\n      .in('lawyer_id', lawyerIds)\r\n\r\n    const assignedDealIds = lawyerAssignments?.map(a => a.deal_id) || []\r\n\r\n    if (assignedDealIds.length > 0) {\r\n      const { data: lawyerTasks } = await serviceSupabase\r\n        .from('tasks')\r\n        .select('*')\r\n        .eq('kind', 'subscription_pack_signature')\r\n        .in('related_deal_id', assignedDealIds)\r\n        .order('due_at', { ascending: true, nullsFirst: false })\r\n      addTasksWithDedup(lawyerTasks || [])\r\n    }\r\n  }\r\n\r\n  // 3. Investor: Tasks owned by user OR by their investor entities\r\n  // ONLY runs if active persona is investor\r\n  if (shouldShowInvestorTasks && investorIds.length > 0) {\r\n    const { data: investorTasks } = await serviceSupabase\r\n      .from('tasks')\r\n      .select('*')\r\n      .in('kind', ['countersignature', 'subscription_pack_signature', 'other'])\r\n      .or(`owner_user_id.eq.${user.id},owner_investor_id.in.(${investorIds.join(',')})`)\r\n      .order('due_at', { ascending: true, nullsFirst: false })\r\n    addTasksWithDedup(investorTasks || [])\r\n  }\r\n\r\n  // 4. Introducer: Tasks owned by user OR by their introducer entities\r\n  // ONLY runs if active persona is introducer\r\n  // This enables entity-level visibility: User A can see tasks for Introducer X\r\n  // even if those tasks were created for User B (another user at Introducer X)\r\n  if (shouldShowIntroducerTasks && introducerIds.length > 0) {\r\n    const { data: introducerTasks } = await serviceSupabase\r\n      .from('tasks')\r\n      .select('*')\r\n      .in('kind', ['countersignature', 'subscription_pack_signature', 'other'])\r\n      .or(`owner_user_id.eq.${user.id},owner_introducer_id.in.(${introducerIds.join(',')})`)\r\n      .order('due_at', { ascending: true, nullsFirst: false })\r\n    addTasksWithDedup(introducerTasks || [])\r\n  } else if (shouldShowIntroducerTasks) {\r\n    // Fallback: if no introducer IDs found, just check user-owned tasks\r\n    const { data: introducerTasks } = await serviceSupabase\r\n      .from('tasks')\r\n      .select('*')\r\n      .in('kind', ['countersignature', 'subscription_pack_signature', 'other'])\r\n      .eq('owner_user_id', user.id)\r\n      .order('due_at', { ascending: true, nullsFirst: false })\r\n    addTasksWithDedup(introducerTasks || [])\r\n  }\r\n\r\n  // 5. Arranger: Tasks for their mandates (deals they arrange)\r\n  // ONLY runs if active persona is arranger\r\n  // IMPORTANT: Exclude CEO-owned tasks (owner_ceo_entity_id IS NOT NULL) to prevent\r\n  // arranger seeing CEO countersign tasks when both are on the same deal\r\n  if (shouldShowArrangerTasks && arrangerIds.length > 0) {\r\n    const { data: arrangerDeals } = await serviceSupabase\r\n      .from('deals')\r\n      .select('id')\r\n      .in('arranger_entity_id', arrangerIds)\r\n\r\n    const arrangerDealIds = arrangerDeals?.map(d => d.id) || []\r\n\r\n    if (arrangerDealIds.length > 0) {\r\n      const { data: arrangerTasks } = await serviceSupabase\r\n        .from('tasks')\r\n        .select('*')\r\n        .in('kind', ['countersignature', 'subscription_pack_signature'])\r\n        .in('related_deal_id', arrangerDealIds)\r\n        .is('owner_ceo_entity_id', null)  // Exclude CEO tasks\r\n        .order('due_at', { ascending: true, nullsFirst: false })\r\n      addTasksWithDedup(arrangerTasks || [])\r\n    }\r\n  }\r\n\r\n  // 6. Commercial Partner: Tasks owned by user OR by their commercial partner entities\r\n  // ONLY runs if active persona is commercial_partner\r\n  // This enables entity-level visibility similar to introducer visibility\r\n  if (shouldShowCPTasks && commercialPartnerIds.length > 0) {\r\n    const { data: cpTasks } = await serviceSupabase\r\n      .from('tasks')\r\n      .select('*')\r\n      .in('kind', ['countersignature', 'subscription_pack_signature', 'other'])\r\n      .or(`owner_user_id.eq.${user.id},owner_commercial_partner_id.in.(${commercialPartnerIds.join(',')})`)\r\n      .order('due_at', { ascending: true, nullsFirst: false })\r\n    addTasksWithDedup(cpTasks || [])\r\n  } else if (shouldShowCPTasks) {\r\n    // Fallback: if no CP IDs found, just check user-owned tasks\r\n    const { data: cpTasks } = await serviceSupabase\r\n      .from('tasks')\r\n      .select('*')\r\n      .in('kind', ['countersignature', 'subscription_pack_signature', 'other'])\r\n      .eq('owner_user_id', user.id)\r\n      .order('due_at', { ascending: true, nullsFirst: false })\r\n    addTasksWithDedup(cpTasks || [])\r\n  }\r\n\r\n  // 7. Fallback: If no tasks found and no personas matched above, get user's direct tasks\r\n  if (tasks.length === 0 && !isStaff && !isLawyer && investorIds.length === 0 && !isArranger && !isCommercialPartner) {\r\n    const { data: userTasks } = await serviceSupabase\r\n      .from('tasks')\r\n      .select('*')\r\n      .in('kind', ['countersignature', 'subscription_pack_signature', 'other'])\r\n      .eq('owner_user_id', user.id)\r\n      .order('due_at', { ascending: true, nullsFirst: false })\r\n    addTasksWithDedup(userTasks || [])\r\n  }\r\n\r\n  // Filter out pending/in_progress tasks where the linked signature request has expired\r\n  // This prevents showing \"Sign Document\" for expired signature requests\r\n  if (tasks.length > 0) {\r\n    const pendingTasksWithSignatureRef = tasks.filter(\r\n      t => (t.status === 'pending' || t.status === 'in_progress') &&\r\n           t.related_entity_type === 'signature_request' &&\r\n           t.related_entity_id\r\n    )\r\n\r\n    if (pendingTasksWithSignatureRef.length > 0) {\r\n      const signatureRequestIds = pendingTasksWithSignatureRef.map(t => t.related_entity_id)\r\n\r\n      // Check which signature requests are expired\r\n      const { data: expiredSigRequests } = await serviceSupabase\r\n        .from('signature_requests')\r\n        .select('id')\r\n        .in('id', signatureRequestIds)\r\n        .eq('status', 'expired')\r\n\r\n      const expiredIds = new Set((expiredSigRequests || []).map(s => s.id))\r\n\r\n      // Mark tasks with expired signature requests\r\n      tasks = tasks.map(t => {\r\n        if (expiredIds.has(t.related_entity_id) &&\r\n            (t.status === 'pending' || t.status === 'in_progress')) {\r\n          return { ...t, _expired: true }\r\n        }\r\n        return t\r\n      })\r\n    }\r\n  }\r\n\r\n  // Fetch expired signature requests (staff/CEO only)\r\n  let expiredSignatures: ExpiredSignature[] = []\r\n  if (isStaff) {\r\n    const { data: expiredData } = await serviceSupabase\r\n      .from('signature_requests')\r\n      .select(`\r\n        id, signer_name, signer_email, document_type,\r\n        token_expires_at, created_at, investor_id,\r\n        investor:investors(display_name, legal_name)\r\n      `)\r\n      .eq('status', 'expired')\r\n      .order('token_expires_at', { ascending: false })\r\n      .limit(50)\r\n    expiredSignatures = (expiredData as unknown as ExpiredSignature[]) || []\r\n  }\r\n\r\n  // If user has no signature tasks and no agreements to sign and is not staff/lawyer/introducer/arranger/partner, show appropriate message\r\n  const hasTasks = tasks && tasks.length > 0\r\n  const hasAgreementsToSign = placementAgreementsForSigning.length > 0\r\n  const hasRelevantPersona = isStaff || isLawyer || isIntroducer || isArranger || isPartner || isCommercialPartner\r\n\r\n  if (!hasTasks && !hasAgreementsToSign && !hasRelevantPersona) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"text-center py-16\">\r\n          <AlertCircle className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n          <h3 className=\"text-lg font-medium text-foreground mb-2\">\r\n            No Signature Tasks\r\n          </h3>\r\n          <p className=\"text-muted-foreground\">\r\n            You don&apos;t have any pending signature tasks at this time.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Sort by priority (high → medium → low), then by due_at\r\n  const priorityOrder: Record<string, number> = { high: 0, medium: 1, low: 2 }\r\n  const sortedTasks = ((tasks as SignatureTask[]) || []).sort((a, b) => {\r\n    const pA = priorityOrder[a.priority] ?? 99\r\n    const pB = priorityOrder[b.priority] ?? 99\r\n    if (pA !== pB) return pA - pB\r\n    if (!a.due_at && !b.due_at) return 0\r\n    if (!a.due_at) return 1\r\n    if (!b.due_at) return -1\r\n    return new Date(a.due_at).getTime() - new Date(b.due_at).getTime()\r\n  })\r\n\r\n  // Separate expired tasks from actionable tasks\r\n  const actionableTasks = sortedTasks.filter(t => !(t as any)._expired)\r\n  const expiredTasks = sortedTasks.filter(t => (t as any)._expired)\r\n\r\n  // Group tasks by type\r\n  const signatureGroups: SignatureGroup[] = [\r\n    {\r\n      category: 'countersignatures',\r\n      title: 'Pending Countersignatures',\r\n      description: 'Subscription agreements awaiting your countersignature',\r\n      // Only show non-expired tasks in actionable view\r\n      tasks: actionableTasks.filter(t =>\r\n        t.kind === 'countersignature' &&\r\n        (t.status === 'pending' || t.status === 'in_progress')\r\n      )\r\n    },\r\n    {\r\n      category: 'follow_ups',\r\n      title: 'Manual Follow-ups Required',\r\n      description: 'Investors without platform accounts - manual intervention needed',\r\n      tasks: actionableTasks.filter(t =>\r\n        t.metadata?.issue === 'investor_no_user_account' &&\r\n        t.status === 'pending'\r\n      )\r\n    },\r\n    {\r\n      category: 'other',\r\n      title: 'Completed Signatures',\r\n      description: 'Recently completed signature tasks',\r\n      tasks: sortedTasks.filter(t =>\r\n        (t.kind === 'countersignature' || t.kind === 'subscription_pack_signature') &&\r\n        t.status === 'completed'\r\n      ).slice(0, 10) // Show last 10 completed\r\n    },\r\n    {\r\n      category: 'expired',\r\n      title: 'Expired Signatures',\r\n      description: 'Signature requests that have expired - may need to be resent',\r\n      // Include both expired signature requests AND tasks with expired signatures\r\n      tasks: expiredTasks,\r\n      expiredSignatures: expiredSignatures\r\n    }\r\n  ]\r\n\r\n  // Get stats for dashboard (only count actionable tasks)\r\n  const stats = {\r\n    pending: actionableTasks.filter(t => t.status === 'pending').length,\r\n    in_progress: actionableTasks.filter(t => t.status === 'in_progress').length,\r\n    completed_today: sortedTasks.filter(t =>\r\n      t.status === 'completed' &&\r\n      t.completed_at &&\r\n      new Date(t.completed_at).toDateString() === new Date().toDateString()\r\n    ).length,\r\n    overdue: actionableTasks.filter(t =>\r\n      t.status === 'pending' &&\r\n      t.due_at &&\r\n      new Date(t.due_at) < new Date()\r\n    ).length,\r\n    expired: expiredSignatures.length + expiredTasks.length\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      {/* Placement Agreement Signing Section - Staff and Arrangers */}\r\n      {(isStaff || isArranger) && placementAgreementsForSigning.length > 0 && (\r\n        <PlacementAgreementSigningSection\r\n          agreements={placementAgreementsForSigning}\r\n          isStaff={isStaff}\r\n          isArranger={isArranger}\r\n        />\r\n      )}\r\n\r\n      {/* Partner Empty State - when Partner has no tasks or agreements */}\r\n      {isPartner && !hasTasks && !hasAgreementsToSign && (\r\n        <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-950/20 dark:to-teal-950/20 border border-emerald-200 dark:border-emerald-800 rounded-xl p-8 text-center\">\r\n          <div className=\"w-16 h-16 bg-emerald-100 dark:bg-emerald-900/30 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n            <svg className=\"w-8 h-8 text-emerald-600 dark:text-emerald-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n            </svg>\r\n          </div>\r\n          <h3 className=\"text-lg font-semibold text-emerald-900 dark:text-emerald-100 mb-2\">\r\n            All Caught Up!\r\n          </h3>\r\n          <p className=\"text-emerald-700 dark:text-emerald-300 max-w-md mx-auto\">\r\n            You don&apos;t have any pending signature tasks as a Partner. When your referred investors have documents requiring your signature, they&apos;ll appear here.\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Standard VersaSign Tasks */}\r\n      <VersoSignPageClient\r\n        userId={user.id}\r\n        signatureGroups={signatureGroups}\r\n        stats={stats}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}