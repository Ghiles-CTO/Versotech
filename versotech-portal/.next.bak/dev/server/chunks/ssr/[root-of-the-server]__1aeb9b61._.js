module.exports = [
"[project]/versotech-portal/src/app/favicon.ico.mjs { IMAGE => \"[project]/versotech-portal/src/app/favicon.ico (static in ecmascript, tag client)\" } [app-rsc] (structured image object, ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/favicon.ico.mjs { IMAGE => \"[project]/versotech-portal/src/app/favicon.ico (static in ecmascript, tag client)\" } [app-rsc] (structured image object, ecmascript)"));
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[project]/versotech-portal/src/app/layout.tsx [app-rsc] (ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/layout.tsx [app-rsc] (ecmascript)"));
}),
"[project]/versotech-portal/src/app/not-found.tsx [app-rsc] (ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/not-found.tsx [app-rsc] (ecmascript)"));
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/layout.tsx [app-rsc] (ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/(main)/versotech_main/layout.tsx [app-rsc] (ecmascript)"));
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/subscription-packs-client.tsx [app-rsc] (client reference proxy) <module evaluation>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "SubscriptionPacksClient",
    ()=>SubscriptionPacksClient
]);
// This file is generated by next-core EcmascriptClientReferenceModule.
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.js [app-rsc] (ecmascript)");
;
const SubscriptionPacksClient = (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call SubscriptionPacksClient() from the server but SubscriptionPacksClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/subscription-packs-client.tsx <module evaluation>", "SubscriptionPacksClient");
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/subscription-packs-client.tsx [app-rsc] (client reference proxy)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "SubscriptionPacksClient",
    ()=>SubscriptionPacksClient
]);
// This file is generated by next-core EcmascriptClientReferenceModule.
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.js [app-rsc] (ecmascript)");
;
const SubscriptionPacksClient = (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call SubscriptionPacksClient() from the server but SubscriptionPacksClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/subscription-packs-client.tsx", "SubscriptionPacksClient");
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/subscription-packs-client.tsx [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$app$2f28$main$292f$versotech_main$2f$subscription$2d$packs$2f$subscription$2d$packs$2d$client$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/subscription-packs-client.tsx [app-rsc] (client reference proxy) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$app$2f28$main$292f$versotech_main$2f$subscription$2d$packs$2f$subscription$2d$packs$2d$client$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__ = __turbopack_context__.i("[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/subscription-packs-client.tsx [app-rsc] (client reference proxy)");
;
__turbopack_context__.n(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$app$2f28$main$292f$versotech_main$2f$subscription$2d$packs$2f$subscription$2d$packs$2d$client$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__);
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>SubscriptionPacksPage,
    "dynamic",
    ()=>dynamic
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-dev-runtime.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$lib$2f$supabase$2f$server$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/src/lib/supabase/server.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__ = __turbopack_context__.i("[project]/versotech-portal/node_modules/lucide-react/dist/esm/icons/circle-alert.js [app-rsc] (ecmascript) <export default as AlertCircle>");
var __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$app$2f28$main$292f$versotech_main$2f$subscription$2d$packs$2f$subscription$2d$packs$2d$client$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/subscription-packs-client.tsx [app-rsc] (ecmascript)");
;
;
;
;
const dynamic = 'force-dynamic';
async function SubscriptionPacksPage() {
    const clientSupabase = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$lib$2f$supabase$2f$server$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["createClient"])();
    const { data: { user }, error: userError } = await clientSupabase.auth.getUser();
    if (!user || userError) {
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "p-6",
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "text-center py-16",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__["AlertCircle"], {
                        className: "h-12 w-12 text-gray-400 mx-auto mb-4"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 15,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                        className: "text-lg font-medium text-foreground mb-2",
                        children: "Authentication Required"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 16,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-muted-foreground",
                        children: "Please log in to view subscription packs."
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 19,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                lineNumber: 14,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
            lineNumber: 13,
            columnNumber: 7
        }, this);
    }
    const serviceSupabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$lib$2f$supabase$2f$server$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["createServiceClient"])();
    // Check user personas for access level
    const { data: personas, error: personasError } = await serviceSupabase.rpc('get_user_personas', {
        p_user_id: user.id
    });
    // Handle RPC errors gracefully
    if (personasError) {
        console.error('Failed to fetch user personas:', personasError);
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "p-6",
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "text-center py-16",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__["AlertCircle"], {
                        className: "h-12 w-12 text-red-500 mx-auto mb-4"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 40,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                        className: "text-lg font-medium text-foreground mb-2",
                        children: "Service Temporarily Unavailable"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 41,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-muted-foreground",
                        children: "Failed to load your profile. Please refresh the page or try again later."
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 44,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                lineNumber: 39,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
            lineNumber: 38,
            columnNumber: 7
        }, this);
    }
    const isLawyer = personas?.some((p)=>p.persona_type === 'lawyer') || false;
    const isArranger = personas?.some((p)=>p.persona_type === 'arranger') || false;
    // Allow access for both lawyers and arrangers
    if (!isLawyer && !isArranger) {
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "p-6",
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "text-center py-16",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__["AlertCircle"], {
                        className: "h-12 w-12 text-gray-400 mx-auto mb-4"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 60,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                        className: "text-lg font-medium text-foreground mb-2",
                        children: "Access Restricted"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 61,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-muted-foreground",
                        children: "This section is available to arrangers and assigned legal counsel."
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 64,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                lineNumber: 59,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
            lineNumber: 58,
            columnNumber: 7
        }, this);
    }
    // ===== LAWYER DATA FETCHING =====
    let lawyerUser = null;
    let lawyer = null;
    if (isLawyer) {
        const { data: lu } = await serviceSupabase.from('lawyer_users').select('lawyer_id').eq('user_id', user.id).maybeSingle();
        lawyerUser = lu;
        if (lawyerUser?.lawyer_id) {
            const { data: l } = await serviceSupabase.from('lawyers').select('id, firm_name, display_name, specializations, is_active, assigned_deals').eq('id', lawyerUser.lawyer_id).maybeSingle();
            lawyer = l;
        }
    }
    // ===== ARRANGER DATA FETCHING =====
    let arrangerUser = null;
    let arrangerEntity = null;
    if (isArranger) {
        const { data: au } = await serviceSupabase.from('arranger_users').select('arranger_id').eq('user_id', user.id).maybeSingle();
        arrangerUser = au;
        if (arrangerUser?.arranger_id) {
            const { data: ae } = await serviceSupabase.from('arranger_entities').select('id, legal_name, status').eq('id', arrangerUser.arranger_id).maybeSingle();
            arrangerEntity = ae;
        }
    }
    // Check if user has valid entity link
    const hasLawyerAccess = isLawyer && lawyerUser?.lawyer_id;
    const hasArrangerAccess = isArranger && arrangerUser?.arranger_id;
    if (!hasLawyerAccess && !hasArrangerAccess) {
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "p-6",
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "text-center py-16",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__["AlertCircle"], {
                        className: "h-12 w-12 text-gray-400 mx-auto mb-4"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 139,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                        className: "text-lg font-medium text-foreground mb-2",
                        children: "No Profile Linked"
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 140,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-muted-foreground",
                        children: "Please contact the VERSO team to link your profile."
                    }, void 0, false, {
                        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                        lineNumber: 143,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
                lineNumber: 138,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
            lineNumber: 137,
            columnNumber: 7
        }, this);
    }
    // ===== GET DEAL IDs BASED ON PERSONA =====
    let dealIds = [];
    if (hasLawyerAccess && lawyerUser?.lawyer_id) {
        // Lawyer: Get deals from assignments table
        const { data: assignments, error: assignmentsError } = await serviceSupabase.from('deal_lawyer_assignments').select('deal_id').eq('lawyer_id', lawyerUser.lawyer_id);
        dealIds = (assignments || []).map((assignment)=>assignment.deal_id);
        // Fallback to lawyers.assigned_deals array if no assignments found
        if ((!dealIds.length || assignmentsError) && lawyer?.assigned_deals?.length) {
            dealIds = lawyer.assigned_deals;
        }
    } else if (hasArrangerAccess && arrangerUser?.arranger_id) {
        // Arranger: Get deals where arranger_entity_id matches
        const { data: arrangerDeals } = await serviceSupabase.from('deals').select('id').eq('arranger_entity_id', arrangerUser.arranger_id);
        dealIds = (arrangerDeals || []).map((d)=>d.id);
    }
    // ===== CREATE ENTITY INFO OBJECT =====
    const entityInfo = hasLawyerAccess && lawyer ? {
        id: lawyer.id,
        firm_name: lawyer.firm_name,
        display_name: lawyer.display_name,
        specializations: lawyer.specializations ?? null,
        is_active: lawyer.is_active,
        entity_type: 'lawyer'
    } : hasArrangerAccess && arrangerEntity ? {
        id: arrangerEntity.id,
        firm_name: arrangerEntity.legal_name,
        display_name: arrangerEntity.legal_name,
        specializations: null,
        is_active: arrangerEntity.status === 'active',
        entity_type: 'arranger'
    } : null;
    // If no deals found, show empty state
    if (!dealIds.length) {
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$app$2f28$main$292f$versotech_main$2f$subscription$2d$packs$2f$subscription$2d$packs$2d$client$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["SubscriptionPacksClient"], {
            entityInfo: entityInfo,
            subscriptions: []
        }, void 0, false, {
            fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
            lineNumber: 201,
            columnNumber: 7
        }, this);
    }
    // Fetch SIGNED subscriptions (committed, partially_funded, funded, active) for relevant deals
    // Note: signed_at is the actual signature date, committed_at may be null
    const { data: subscriptionsData } = await serviceSupabase.from('subscriptions').select(`
      id,
      deal_id,
      investor_id,
      status,
      commitment,
      currency,
      funded_amount,
      signed_at,
      committed_at,
      funded_at,
      subscription_number,
      subscription_date,
      effective_date,
      funding_due_at,
      num_shares,
      price_per_share,
      pack_sent_at,
      deals (
        id,
        name
      ),
      investors (
        id,
        legal_name,
        display_name
      )
    `).in('deal_id', dealIds).in('status', [
        'committed',
        'partially_funded',
        'funded',
        'active'
    ]).order('signed_at', {
        ascending: false,
        nullsFirst: false
    });
    const subscriptionIds = (subscriptionsData || []).map((s)=>s.id);
    // Fetch signed documents for these subscriptions
    let documentsMap = {};
    if (subscriptionIds.length > 0) {
        const { data: documents } = await serviceSupabase.from('documents').select('id, subscription_id, file_key, name, created_at, status, type, mime_type, file_size_bytes').in('subscription_id', subscriptionIds).eq('status', 'published').or('type.eq.subscription,type.eq.subscription_pack,type.is.null').order('created_at', {
            ascending: false
        });
        // Group documents by subscription_id (take first/latest for each)
        if (documents) {
            for (const doc of documents){
                if (doc.subscription_id && !documentsMap[doc.subscription_id]) {
                    documentsMap[doc.subscription_id] = doc;
                }
            }
        }
    }
    const subscriptions = (subscriptionsData || []).map((sub)=>{
        // PostgREST returns single object for many-to-one relationships (not arrays)
        const deal = Array.isArray(sub.deals) ? sub.deals[0] : sub.deals;
        const investor = Array.isArray(sub.investors) ? sub.investors[0] : sub.investors;
        const document = documentsMap[sub.id];
        // Log missing data for debugging (helps identify data integrity issues)
        if (!deal) {
            console.warn(`Subscription ${sub.id} missing deal data (deal_id: ${sub.deal_id})`);
        }
        if (!investor) {
            console.warn(`Subscription ${sub.id} missing investor data (investor_id: ${sub.investor_id})`);
        }
        return {
            id: sub.id,
            deal_id: sub.deal_id,
            investor_id: sub.investor_id,
            status: sub.status,
            commitment: sub.commitment,
            currency: sub.currency || 'USD',
            funded_amount: sub.funded_amount || 0,
            // Use signed_at as primary (actual signature date), fallback to committed_at
            signed_at: sub.signed_at || sub.committed_at,
            committed_at: sub.committed_at,
            funded_at: sub.funded_at,
            subscription_number: sub.subscription_number,
            subscription_date: sub.subscription_date,
            // Additional useful fields
            effective_date: sub.effective_date,
            funding_due_at: sub.funding_due_at,
            num_shares: sub.num_shares,
            price_per_share: sub.price_per_share,
            pack_sent_at: sub.pack_sent_at,
            // Improved null safety: Show ID as fallback to help staff lookup missing records
            deal_name: deal?.name || `Unknown (ID: ${sub.deal_id?.slice(0, 8) || 'N/A'})`,
            investor_name: investor?.display_name || investor?.legal_name || `Unknown (ID: ${sub.investor_id?.slice(0, 8) || 'N/A'})`,
            document_id: document?.id || null,
            document_file_key: document?.file_key || null,
            document_file_name: document?.name || null,
            document_mime_type: document?.mime_type || null,
            document_file_size: document?.file_size_bytes || null,
            document_type: document?.type || null
        };
    });
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$versotech$2d$portal$2f$src$2f$app$2f28$main$292f$versotech_main$2f$subscription$2d$packs$2f$subscription$2d$packs$2d$client$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["SubscriptionPacksClient"], {
        entityInfo: entityInfo,
        subscriptions: subscriptions
    }, void 0, false, {
        fileName: "[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx",
        lineNumber: 314,
        columnNumber: 5
    }, this);
}
}),
"[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx [app-rsc] (ecmascript, Next.js Server Component)", ((__turbopack_context__) => {

__turbopack_context__.n(__turbopack_context__.i("[project]/versotech-portal/src/app/(main)/versotech_main/subscription-packs/page.tsx [app-rsc] (ecmascript)"));
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__1aeb9b61._.js.map