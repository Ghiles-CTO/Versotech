{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/subscriptions/subscription-detail-client.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const SubscriptionDetailClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call SubscriptionDetailClient() from the server but SubscriptionDetailClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/components/subscriptions/subscription-detail-client.tsx <module evaluation>\",\n    \"SubscriptionDetailClient\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,2BAA2B,IAAA,+RAAuB,EAC3D;IAAa,MAAM,IAAI,MAAM;AAAgQ,GAC7R,8GACA","ignoreList":[0]}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/subscriptions/subscription-detail-client.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const SubscriptionDetailClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call SubscriptionDetailClient() from the server but SubscriptionDetailClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/versotech-portal/src/components/subscriptions/subscription-detail-client.tsx\",\n    \"SubscriptionDetailClient\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,2BAA2B,IAAA,+RAAuB,EAC3D;IAAa,MAAM,IAAI,MAAM;AAAgQ,GAC7R,0FACA","ignoreList":[0]}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28main%29/versotech_main/subscriptions/%5Bid%5D/page.tsx"],"sourcesContent":["import { createClient } from '@/lib/supabase/server'\nimport { requireStaffAuth } from '@/lib/auth'\nimport { notFound } from 'next/navigation'\nimport { SubscriptionDetailClient } from '@/components/subscriptions/subscription-detail-client'\n\nexport const dynamic = 'force-dynamic'\n\nexport default async function SubscriptionDetailPage({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n\n  await requireStaffAuth()\n  const supabase = await createClient()\n\n  // Fetch subscription with all related data\n  const { data: subscription, error } = await supabase\n    .from('subscriptions')\n    .select(\n      `\n        *,\n        investor:investors (\n          id,\n          legal_name,\n          display_name,\n          type,\n          country,\n          email,\n          phone,\n          kyc_status,\n          status,\n          aml_risk_rating,\n          is_pep,\n          primary_rm,\n          primary_rm_profile:profiles!investors_primary_rm_fkey (\n            id,\n            display_name,\n            email\n          )\n        ),\n        vehicle:vehicles (\n          id,\n          name,\n          entity_code,\n          type,\n          currency,\n          status,\n          domicile,\n          formation_date\n        )\n      `\n    )\n    .eq('id', id)\n    .single()\n\n  if (error || !subscription) {\n    console.error('[Subscription Detail] Error:', error)\n    notFound()\n  }\n\n  // Fetch capital activity (cashflows)\n  const { data: cashflows } = await supabase\n    .from('cashflows')\n    .select('*')\n    .eq('investor_id', subscription.investor_id)\n    .eq('vehicle_id', subscription.vehicle_id)\n    .order('date', { ascending: false })\n\n  // Fetch capital calls related to this vehicle\n  const { data: capitalCalls } = await supabase\n    .from('capital_calls')\n    .select('*')\n    .eq('vehicle_id', subscription.vehicle_id)\n    .order('due_date', { ascending: false })\n\n  // Fetch distributions related to this vehicle\n  const { data: distributions } = await supabase\n    .from('distributions')\n    .select('*')\n    .eq('vehicle_id', subscription.vehicle_id)\n    .order('date', { ascending: false })\n\n  // Calculate metrics\n  const contributions = cashflows?.filter((cf) => cf.type === 'contribution') || []\n  const distributionsFlow = cashflows?.filter((cf) => cf.type === 'distribution') || []\n\n  const total_contributed = contributions.reduce((sum, cf) => sum + Number(cf.amount), 0)\n  const total_distributed = distributionsFlow.reduce((sum, cf) => sum + Number(cf.amount), 0)\n  const unfunded_commitment = Number(subscription.commitment) - total_contributed\n  const current_nav = total_contributed - total_distributed\n\n  const metrics = {\n    total_commitment: Number(subscription.commitment),\n    total_contributed,\n    total_distributed,\n    unfunded_commitment,\n    current_nav,\n    total_calls: capitalCalls?.length || 0,\n    pending_calls: capitalCalls?.filter((cc) => cc.status === 'pending')?.length || 0,\n  }\n\n  return (\n    <SubscriptionDetailClient\n      subscription={subscription}\n      cashflows={cashflows || []}\n      capitalCalls={capitalCalls || []}\n      distributions={distributions || []}\n      metrics={metrics}\n    />\n  )\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AAAA;AACA;;;;;;AAEO,MAAM,UAAU;AAER,eAAe,uBAAuB,EACnD,MAAM,EAGP;IACC,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IAErB,MAAM,IAAA,6JAAgB;IACtB,MAAM,WAAW,MAAM,IAAA,uKAAY;IAEnC,2CAA2C;IAC3C,MAAM,EAAE,MAAM,YAAY,EAAE,KAAK,EAAE,GAAG,MAAM,SACzC,IAAI,CAAC,iBACL,MAAM,CACL,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MA+BD,CAAC,EAEF,EAAE,CAAC,MAAM,IACT,MAAM;IAET,IAAI,SAAS,CAAC,cAAc;QAC1B,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,IAAA,wNAAQ;IACV;IAEA,qCAAqC;IACrC,MAAM,EAAE,MAAM,SAAS,EAAE,GAAG,MAAM,SAC/B,IAAI,CAAC,aACL,MAAM,CAAC,KACP,EAAE,CAAC,eAAe,aAAa,WAAW,EAC1C,EAAE,CAAC,cAAc,aAAa,UAAU,EACxC,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAM;IAEpC,8CAA8C;IAC9C,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,MAAM,SAClC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,cAAc,aAAa,UAAU,EACxC,KAAK,CAAC,YAAY;QAAE,WAAW;IAAM;IAExC,8CAA8C;IAC9C,MAAM,EAAE,MAAM,aAAa,EAAE,GAAG,MAAM,SACnC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,cAAc,aAAa,UAAU,EACxC,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAM;IAEpC,oBAAoB;IACpB,MAAM,gBAAgB,WAAW,OAAO,CAAC,KAAO,GAAG,IAAI,KAAK,mBAAmB,EAAE;IACjF,MAAM,oBAAoB,WAAW,OAAO,CAAC,KAAO,GAAG,IAAI,KAAK,mBAAmB,EAAE;IAErF,MAAM,oBAAoB,cAAc,MAAM,CAAC,CAAC,KAAK,KAAO,MAAM,OAAO,GAAG,MAAM,GAAG;IACrF,MAAM,oBAAoB,kBAAkB,MAAM,CAAC,CAAC,KAAK,KAAO,MAAM,OAAO,GAAG,MAAM,GAAG;IACzF,MAAM,sBAAsB,OAAO,aAAa,UAAU,IAAI;IAC9D,MAAM,cAAc,oBAAoB;IAExC,MAAM,UAAU;QACd,kBAAkB,OAAO,aAAa,UAAU;QAChD;QACA;QACA;QACA;QACA,aAAa,cAAc,UAAU;QACrC,eAAe,cAAc,OAAO,CAAC,KAAO,GAAG,MAAM,KAAK,YAAY,UAAU;IAClF;IAEA,qBACE,qQAAC,0NAAwB;QACvB,cAAc;QACd,WAAW,aAAa,EAAE;QAC1B,cAAc,gBAAgB,EAAE;QAChC,eAAe,iBAAiB,EAAE;QAClC,SAAS;;;;;;AAGf"}}]
}