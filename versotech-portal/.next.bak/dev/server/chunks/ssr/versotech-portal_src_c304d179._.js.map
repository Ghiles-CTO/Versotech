{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAIA,MAAM,yBAAW,0OAAgB,CAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,qQAAC;QACC,WAAW,IAAA,gJAAE,EACX,+RACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/tooltip.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst TooltipProvider = TooltipPrimitive.Provider\r\n\r\nconst Tooltip = TooltipPrimitive.Root\r\n\r\nconst TooltipTrigger = TooltipPrimitive.Trigger\r\n\r\nconst TooltipContent = React.forwardRef<\r\n    React.ElementRef<typeof TooltipPrimitive.Content>,\r\n    React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\r\n>(({ className, sideOffset = 4, ...props }, ref) => (\r\n    <TooltipPrimitive.Content\r\n        ref={ref}\r\n        sideOffset={sideOffset}\r\n        className={cn(\r\n            \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\r\n            className\r\n        )}\r\n        {...props}\r\n    />\r\n))\r\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\r\n\r\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\r\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,kBAAkB,sMAAyB;AAEjD,MAAM,UAAU,kMAAqB;AAErC,MAAM,iBAAiB,qMAAwB;AAE/C,MAAM,+BAAiB,0OAAgB,CAGrC,CAAC,EAAE,SAAS,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBACxC,qQAAC,qMAAwB;QACrB,KAAK;QACL,YAAY;QACZ,WAAW,IAAA,gJAAE,EACT,sYACA;QAEH,GAAG,KAAK;;;;;;AAGjB,eAAe,WAAW,GAAG,qMAAwB,CAAC,WAAW"}},
    {"offset": {"line": 171, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/table.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Table({ className, ...props }: React.ComponentProps<\"table\">) {\n  return (\n    <div\n      data-slot=\"table-container\"\n      className=\"relative w-full overflow-x-auto\"\n    >\n      <table\n        data-slot=\"table\"\n        className={cn(\"w-full caption-bottom text-sm\", className)}\n        {...props}\n      />\n    </div>\n  )\n}\n\nfunction TableHeader({ className, ...props }: React.ComponentProps<\"thead\">) {\n  return (\n    <thead\n      data-slot=\"table-header\"\n      className={cn(\"[&_tr]:border-b\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableBody({ className, ...props }: React.ComponentProps<\"tbody\">) {\n  return (\n    <tbody\n      data-slot=\"table-body\"\n      className={cn(\"[&_tr:last-child]:border-0\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableFooter({ className, ...props }: React.ComponentProps<\"tfoot\">) {\n  return (\n    <tfoot\n      data-slot=\"table-footer\"\n      className={cn(\n        \"bg-muted/50 border-t font-medium [&>tr]:last:border-b-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableRow({ className, ...props }: React.ComponentProps<\"tr\">) {\n  return (\n    <tr\n      data-slot=\"table-row\"\n      className={cn(\n        \"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableHead({ className, ...props }: React.ComponentProps<\"th\">) {\n  return (\n    <th\n      data-slot=\"table-head\"\n      className={cn(\n        // Responsive: smaller text on mobile, allow text wrapping for narrow screens\n        \"text-foreground h-11 md:h-10 px-2 text-left align-middle font-medium text-xs sm:text-sm [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCell({ className, ...props }: React.ComponentProps<\"td\">) {\n  return (\n    <td\n      data-slot=\"table-cell\"\n      className={cn(\n        // Responsive: smaller text on mobile, allow text wrapping for narrow screens\n        \"p-2 align-middle text-xs sm:text-sm [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCaption({\n  className,\n  ...props\n}: React.ComponentProps<\"caption\">) {\n  return (\n    <caption\n      data-slot=\"table-caption\"\n      className={cn(\"text-muted-foreground mt-4 text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAIA;AAJA;;;AAMA,SAAS,MAAM,EAAE,SAAS,EAAE,GAAG,OAAsC;IACnE,qBACE,qQAAC;QACC,aAAU;QACV,WAAU;kBAEV,cAAA,qQAAC;YACC,aAAU;YACV,WAAW,IAAA,gJAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;AAIjB;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,mBAAmB;QAChC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAsC;IACvE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,2DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAmC;IACnE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,+EACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,6EAA6E;QAC7E,+JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EACX,6EAA6E;QAC7E,2GACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OAC6B;IAChC,qBACE,qQAAC;QACC,aAAU;QACV,WAAW,IAAA,gJAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/DocumentViewerFullscreen.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState, useMemo } from 'react'\r\nimport { createPortal } from 'react-dom'\r\nimport { X, Download, Loader2, AlertCircle, FileText } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { formatFileSize } from '@/lib/utils'\r\nimport { DocumentReference } from '@/types/document-viewer.types'\r\n\r\ninterface DocumentViewerFullscreenProps {\r\n  isOpen: boolean\r\n  document: DocumentReference | null\r\n  previewUrl: string | null\r\n  isLoading: boolean\r\n  error: string | null\r\n  onClose: () => void\r\n  onDownload: () => void\r\n}\r\n\r\n/**\r\n * Check if a file is a PDF based on filename or URL\r\n */\r\nfunction isPdfFile(fileName?: string | null, url?: string | null): boolean {\r\n  if (fileName?.toLowerCase().endsWith('.pdf')) return true\r\n  if (url?.toLowerCase().includes('.pdf')) return true\r\n  // Supabase signed URLs have the file path in them\r\n  if (url?.includes('deal-documents') && url?.includes('.pdf')) return true\r\n  return false\r\n}\r\n\r\n/**\r\n * Append PDF viewer parameters to URL to fix browser rendering issues\r\n * - navpanes=0: Hide thumbnail sidebar (fixes Brave issue)\r\n * - view=FitH: Fit to width for better viewing\r\n * - pagemode=none: Don't show bookmarks/thumbnails\r\n */\r\nfunction getPdfViewerUrl(url: string): string {\r\n  // Don't add hash if URL already has one\r\n  if (url.includes('#')) return url\r\n  return `${url}#navpanes=0&view=FitH&pagemode=none`\r\n}\r\n\r\nexport function DocumentViewerFullscreen({\r\n  isOpen,\r\n  document,\r\n  previewUrl,\r\n  isLoading,\r\n  error,\r\n  onClose,\r\n  onDownload,\r\n}: DocumentViewerFullscreenProps) {\r\n  const [iframeError, setIframeError] = useState(false)\r\n  const [mounted, setMounted] = useState(false)\r\n\r\n  // Track mount state for portal rendering\r\n  useEffect(() => {\r\n    setMounted(true)\r\n    return () => setMounted(false)\r\n  }, [])\r\n\r\n  // Compute the final iframe URL with PDF parameters if needed\r\n  const iframeSrc = useMemo(() => {\r\n    if (!previewUrl) return null\r\n    const fileName = document?.file_name || document?.name\r\n    if (isPdfFile(fileName, previewUrl)) {\r\n      return getPdfViewerUrl(previewUrl)\r\n    }\r\n    return previewUrl\r\n  }, [previewUrl, document])\r\n\r\n  // Handle ESC key to close\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onClose()\r\n      }\r\n      if (e.ctrlKey && e.key === 'd') {\r\n        e.preventDefault()\r\n        onDownload()\r\n      }\r\n    }\r\n\r\n    if (isOpen && typeof window !== 'undefined') {\r\n      window.addEventListener('keydown', handleKeyDown)\r\n      // Prevent body scroll when viewer is open\r\n      if (window.document?.body) {\r\n        window.document.body.style.overflow = 'hidden'\r\n      }\r\n\r\n      return () => {\r\n        window.removeEventListener('keydown', handleKeyDown)\r\n        if (window.document?.body) {\r\n          window.document.body.style.overflow = ''\r\n        }\r\n      }\r\n    }\r\n  }, [isOpen, onClose, onDownload])\r\n\r\n  // Reset iframe error when URL changes\r\n  useEffect(() => {\r\n    setIframeError(false)\r\n  }, [previewUrl])\r\n\r\n  // Don't render until mounted (for portal) or if not open\r\n  if (!isOpen || !mounted) return null\r\n\r\n  // Use portal to render at body level, escaping backdrop-blur containing blocks\r\n  const modalContent = (\r\n    <div className=\"fixed inset-0 z-[9999] bg-black/95 overflow-hidden\">\r\n      {/* Toolbar */}\r\n      <div className=\"h-16 bg-white border-b shadow-md flex items-center justify-between px-6\">\r\n        <div className=\"flex items-center gap-4 flex-1 min-w-0\">\r\n          <FileText className=\"h-5 w-5 text-gray-500 flex-shrink-0\" />\r\n          <div className=\"min-w-0 flex-1\">\r\n            <h2 className=\"text-lg font-semibold text-gray-900 truncate\">\r\n              {document?.file_name || document?.name || 'Document Preview'}\r\n            </h2>\r\n            <div className=\"flex items-center gap-3 text-sm text-gray-500\">\r\n              {document?.type && (\r\n                <span className=\"capitalize\">{document.type}</span>\r\n              )}\r\n              {document?.file_size_bytes && (\r\n                <>\r\n                  <span>•</span>\r\n                  <span>{formatFileSize(document.file_size_bytes)}</span>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={onDownload}\r\n            className=\"gap-2\"\r\n          >\r\n            <Download className=\"h-4 w-4\" />\r\n            Download\r\n          </Button>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={onClose}\r\n            className=\"gap-2\"\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n            Close\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main viewport */}\r\n      <div className=\"h-[calc(100vh-4rem)] bg-gray-900\">\r\n        {/* Loading/error states need centering */}\r\n        {(isLoading || error || iframeError) && (\r\n          <div className=\"w-full h-full flex items-center justify-center\">\r\n            {isLoading && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white\">\r\n                <Loader2 className=\"h-12 w-12 animate-spin\" />\r\n                <p className=\"text-lg\">Loading document...</p>\r\n              </div>\r\n            )}\r\n\r\n            {error && !isLoading && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white max-w-md mx-auto px-4\">\r\n                <AlertCircle className=\"h-16 w-16 text-red-400\" />\r\n                <h3 className=\"text-xl font-semibold\">Failed to Load Preview</h3>\r\n                <p className=\"text-gray-300 text-center\">{error}</p>\r\n                <Button\r\n                  onClick={onDownload}\r\n                  variant=\"secondary\"\r\n                  className=\"gap-2 mt-4\"\r\n                >\r\n                  <Download className=\"h-4 w-4\" />\r\n                  Download Instead\r\n                </Button>\r\n              </div>\r\n            )}\r\n\r\n            {iframeError && !isLoading && !error && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white max-w-md mx-auto px-4\">\r\n                <AlertCircle className=\"h-16 w-16 text-red-400\" />\r\n                <h3 className=\"text-xl font-semibold\">Preview Unavailable</h3>\r\n                <p className=\"text-gray-300 text-center\">\r\n                  This document cannot be previewed in your browser.\r\n                </p>\r\n                <Button\r\n                  onClick={onDownload}\r\n                  variant=\"secondary\"\r\n                  className=\"gap-2 mt-4\"\r\n                >\r\n                  <Download className=\"h-4 w-4\" />\r\n                  Download to View\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Iframe fills the entire viewport when ready */}\r\n        {iframeSrc && !isLoading && !error && !iframeError && (\r\n          <iframe\r\n            src={iframeSrc}\r\n            className=\"w-full h-full border-0\"\r\n            title=\"Document Preview\"\r\n            onError={() => {\r\n              console.error('iframe failed to load preview')\r\n              setIframeError(true)\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer hint */}\r\n      {!isLoading && !error && (\r\n        <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 text-white/60 text-sm bg-black/50 px-4 py-2 rounded-full\">\r\n          Press <kbd className=\"px-2 py-1 bg-white/10 rounded mx-1\">ESC</kbd> to close\r\n          or <kbd className=\"px-2 py-1 bg-white/10 rounded mx-1\">Ctrl+D</kbd> to download\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  // Render portal to document.body to escape backdrop-blur containing blocks\r\n  const portalTarget = typeof window !== 'undefined' ? window.document.body : null\r\n  if (!portalTarget) return null\r\n  return createPortal(modalContent, portalTarget)\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 714, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/types/document-viewer.types.ts"],"sourcesContent":["/**\r\n * Type definitions for the document viewer system\r\n */\r\n\r\n/**\r\n * Minimal document reference needed for preview\r\n * Flexible to support different document sources (general docs, entity docs, deal docs, etc.)\r\n */\r\nexport interface DocumentReference {\r\n  id: string\r\n  file_name?: string | null  // Optional to support different document types\r\n  name?: string | null       // Some documents use 'name' instead of 'file_name'\r\n  mime_type?: string | null\r\n  file_size_bytes?: number | null\r\n  type?: string | null\r\n  [key: string]: any // Allow additional properties\r\n}\r\n\r\n/**\r\n * Response from document download/preview API endpoints\r\n */\r\nexport interface DocumentUrlResponse {\r\n  download_url: string\r\n  mode?: 'preview' | 'download'\r\n  document: {\r\n    id: string\r\n    name: string\r\n    type: string\r\n    file_key?: string\r\n    external_url?: string\r\n    [key: string]: any\r\n  }\r\n  watermark?: {\r\n    uploaded_by?: string\r\n    uploaded_at?: string\r\n    document_classification?: string\r\n    [key: string]: any\r\n  }\r\n  expires_in_seconds: number\r\n}\r\n\r\n/**\r\n * State shape for document viewer\r\n */\r\nexport interface DocumentViewerState {\r\n  isOpen: boolean\r\n  document: DocumentReference | null\r\n  previewUrl: string | null\r\n  isLoading: boolean\r\n  error: string | null\r\n}\r\n\r\n/**\r\n * Custom error class for document operations\r\n */\r\nexport class DocumentError extends Error {\r\n  constructor(\r\n    message: string,\r\n    public statusCode: number,\r\n    public originalError?: any\r\n  ) {\r\n    super(message)\r\n    this.name = 'DocumentError'\r\n  }\r\n}\r\n\r\n/**\r\n * Options for opening a document preview\r\n */\r\nexport interface PreviewOptions {\r\n  /** Force download mode instead of preview */\r\n  forceDownload?: boolean\r\n  /** Custom error handler */\r\n  onError?: (error: DocumentError) => void\r\n  /** Success callback after preview opens */\r\n  onSuccess?: () => void\r\n}\r\n"],"names":[],"mappings":"AAAA;;CAEC,GAED;;;CAGC;;;;AAgDM,MAAM,sBAAsB;;;IACjC,YACE,OAAe,EACf,AAAO,UAAkB,EACzB,AAAO,aAAmB,CAC1B;QACA,KAAK,CAAC,eAHC,aAAA,iBACA,gBAAA;QAGP,IAAI,CAAC,IAAI,GAAG;IACd;AACF"}},
    {"offset": {"line": 735, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/services/document.service.ts"],"sourcesContent":["/**\r\n * Document Service\r\n * Centralized service for all document-related API operations\r\n */\r\n\r\nimport { DocumentError, DocumentUrlResponse } from '@/types/document-viewer.types'\r\n\r\nexport class DocumentService {\r\n  /**\r\n   * Validate that a URL is a valid storage URL from Supabase\r\n   */\r\n  private static isValidStorageUrl(url: string): boolean {\r\n    if (!url) return false\r\n\r\n    // Check if it's a valid HTTPS URL\r\n    if (!url.startsWith('https://')) return false\r\n\r\n    // Check if it's from Supabase storage or a blob URL\r\n    return (\r\n      url.includes('supabase.co/storage') ||\r\n      url.includes('supabase.com/storage') ||\r\n      url.startsWith('blob:')\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Parse and validate API response\r\n   */\r\n  private static async parseResponse(\r\n    response: Response\r\n  ): Promise<DocumentUrlResponse> {\r\n    let data: any\r\n\r\n    try {\r\n      data = await response.json()\r\n    } catch (e) {\r\n      throw new DocumentError(\r\n        'Invalid response from server',\r\n        response.status,\r\n        e\r\n      )\r\n    }\r\n\r\n    // Check for error response\r\n    if (!response.ok) {\r\n      const errorMessage = data.error || data.message || 'Failed to load document'\r\n      throw new DocumentError(errorMessage, response.status, data)\r\n    }\r\n\r\n    // Validate required fields - check for both 'url' and 'download_url' for compatibility\r\n    const downloadUrl = data.url || data.download_url\r\n    if (!downloadUrl) {\r\n      throw new DocumentError(\r\n        'No download URL in response',\r\n        500,\r\n        data\r\n      )\r\n    }\r\n\r\n    // Validate URL format\r\n    if (!this.isValidStorageUrl(downloadUrl)) {\r\n      throw new DocumentError(\r\n        'Invalid download URL format',\r\n        500,\r\n        data\r\n      )\r\n    }\r\n\r\n    // Normalize response to always have both fields for compatibility\r\n    data.url = downloadUrl\r\n    data.download_url = downloadUrl\r\n\r\n    return data as DocumentUrlResponse\r\n  }\r\n\r\n  /**\r\n   * Get preview URL for a general document\r\n   */\r\n  static async getPreviewUrl(documentId: string): Promise<DocumentUrlResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `/api/documents/${documentId}/download?mode=preview`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      )\r\n\r\n      return await this.parseResponse(response)\r\n    } catch (error) {\r\n      if (error instanceof DocumentError) {\r\n        throw error\r\n      }\r\n\r\n      throw new DocumentError(\r\n        'Network error while loading preview',\r\n        0,\r\n        error\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get download URL for a general document\r\n   */\r\n  static async getDownloadUrl(documentId: string): Promise<DocumentUrlResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `/api/documents/${documentId}/download?mode=download`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      )\r\n\r\n      return await this.parseResponse(response)\r\n    } catch (error) {\r\n      if (error instanceof DocumentError) {\r\n        throw error\r\n      }\r\n\r\n      throw new DocumentError(\r\n        'Network error while loading download',\r\n        0,\r\n        error\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get preview URL for a deal data room document\r\n   */\r\n  static async getDealDocumentPreviewUrl(\r\n    dealId: string,\r\n    documentId: string\r\n  ): Promise<DocumentUrlResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `/api/deals/${dealId}/documents/${documentId}/download?mode=preview`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      )\r\n\r\n      return await this.parseResponse(response)\r\n    } catch (error) {\r\n      if (error instanceof DocumentError) {\r\n        throw error\r\n      }\r\n\r\n      throw new DocumentError(\r\n        'Network error while loading deal document preview',\r\n        0,\r\n        error\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get download URL for a deal data room document\r\n   */\r\n  static async getDealDocumentDownloadUrl(\r\n    dealId: string,\r\n    documentId: string\r\n  ): Promise<DocumentUrlResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `/api/deals/${dealId}/documents/${documentId}/download?mode=download`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      )\r\n\r\n      return await this.parseResponse(response)\r\n    } catch (error) {\r\n      if (error instanceof DocumentError) {\r\n        throw error\r\n      }\r\n\r\n      throw new DocumentError(\r\n        'Network error while loading deal document download',\r\n        0,\r\n        error\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Map HTTP status codes to user-friendly error messages\r\n   */\r\n  static getErrorMessage(error: DocumentError): string {\r\n    switch (error.statusCode) {\r\n      case 401:\r\n        return 'You do not have permission to view this document.'\r\n      case 403:\r\n        return 'Access to this document is forbidden.'\r\n      case 404:\r\n        return 'Document not found or has been deleted.'\r\n      case 413:\r\n        return 'File is too large to process.'\r\n      case 500:\r\n        return 'Server error while loading document. Please try again.'\r\n      case 0:\r\n        return 'Network error. Please check your connection and try again.'\r\n      default:\r\n        return error.message || 'Failed to load document preview.'\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 879, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/constants/document-preview.constants.ts"],"sourcesContent":["/**\r\n * Document Preview Configuration\r\n * Defines limits and supported types for the document preview system\r\n */\r\n\r\nexport const PREVIEW_CONFIG = {\r\n  /** Maximum file size for preview (10MB) */\r\n  MAX_FILE_SIZE_BYTES: 10 * 1024 * 1024,\r\n\r\n  /** Timeout for iframe loading (30 seconds) */\r\n  IFRAME_TIMEOUT_MS: 30000,\r\n\r\n  /** Supported MIME types for preview */\r\n  SUPPORTED_MIME_TYPES: [\r\n    'application/pdf',\r\n    'image/png',\r\n    'image/jpeg',\r\n    'image/jpg',\r\n    'image/gif',\r\n    'image/webp',\r\n    'text/plain',\r\n  ] as const,\r\n\r\n  /** Supported file extensions for preview */\r\n  SUPPORTED_EXTENSIONS: [\r\n    'pdf',\r\n    'png',\r\n    'jpeg',\r\n    'jpg',\r\n    'gif',\r\n    'webp',\r\n    'txt',\r\n    'text',\r\n  ] as const,\r\n} as const\r\n\r\n/**\r\n * User-friendly error messages for document preview\r\n */\r\nexport const PREVIEW_ERROR_MESSAGES = {\r\n  FILE_TOO_LARGE: 'File is too large for preview (maximum 10MB). Please download to view.',\r\n  UNSUPPORTED_TYPE: 'Preview not supported for this file type. Please download to view.',\r\n  LOAD_FAILED: 'Failed to load document preview. Please try downloading instead.',\r\n  UNAUTHORIZED: 'You do not have permission to view this document.',\r\n  NOT_FOUND: 'Document not found or has been deleted.',\r\n  NETWORK_ERROR: 'Network error while loading preview. Please check your connection.',\r\n  INVALID_URL: 'Invalid preview URL received. Please try again.',\r\n  TIMEOUT: 'Preview loading timed out. The file may be too large or your connection too slow.',\r\n} as const\r\n\r\n/**\r\n * Check if a file extension is supported for preview\r\n */\r\nexport function isPreviewableExtension(filename: string): boolean {\r\n  const extension = filename.split('.').pop()?.toLowerCase()\r\n  if (!extension) return false\r\n\r\n  return (PREVIEW_CONFIG.SUPPORTED_EXTENSIONS as readonly string[]).includes(extension)\r\n}\r\n\r\n/**\r\n * Check if a MIME type is supported for preview\r\n */\r\nexport function isPreviewableMimeType(mimeType: string): boolean {\r\n  return (PREVIEW_CONFIG.SUPPORTED_MIME_TYPES as readonly string[]).includes(mimeType)\r\n}\r\n\r\n/**\r\n * Check if a file is within size limits for preview\r\n */\r\nexport function isWithinSizeLimit(sizeBytes: number): boolean {\r\n  return sizeBytes <= PREVIEW_CONFIG.MAX_FILE_SIZE_BYTES\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;;;AAEM,MAAM,iBAAiB;IAC5B,yCAAyC,GACzC,qBAAqB,KAAK,OAAO;IAEjC,4CAA4C,GAC5C,mBAAmB;IAEnB,qCAAqC,GACrC,sBAAsB;QACpB;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,0CAA0C,GAC1C,sBAAsB;QACpB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;AACH;AAKO,MAAM,yBAAyB;IACpC,gBAAgB;IAChB,kBAAkB;IAClB,aAAa;IACb,cAAc;IACd,WAAW;IACX,eAAe;IACf,aAAa;IACb,SAAS;AACX;AAKO,SAAS,uBAAuB,QAAgB;IACrD,MAAM,YAAY,SAAS,KAAK,CAAC,KAAK,GAAG,IAAI;IAC7C,IAAI,CAAC,WAAW,OAAO;IAEvB,OAAO,AAAC,eAAe,oBAAoB,CAAuB,QAAQ,CAAC;AAC7E;AAKO,SAAS,sBAAsB,QAAgB;IACpD,OAAO,AAAC,eAAe,oBAAoB,CAAuB,QAAQ,CAAC;AAC7E;AAKO,SAAS,kBAAkB,SAAiB;IACjD,OAAO,aAAa,eAAe,mBAAmB;AACxD"}},
    {"offset": {"line": 942, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/hooks/useDocumentViewer.ts"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useCallback } from 'react'\r\nimport { toast } from 'sonner'\r\nimport { DocumentService } from '@/services/document.service'\r\nimport { DocumentReference, DocumentError } from '@/types/document-viewer.types'\r\nimport {\r\n  PREVIEW_CONFIG,\r\n  PREVIEW_ERROR_MESSAGES,\r\n  isPreviewableExtension,\r\n  isPreviewableMimeType,\r\n  isWithinSizeLimit,\r\n} from '@/constants/document-preview.constants'\r\n\r\n/**\r\n * Hook for managing document preview state and operations\r\n */\r\nexport function useDocumentViewer() {\r\n  const [isOpen, setIsOpen] = useState(false)\r\n  const [document, setDocument] = useState<DocumentReference | null>(null)\r\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null)\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  /**\r\n   * Validate if document can be previewed\r\n   */\r\n  const validateDocument = (doc: DocumentReference): string | null => {\r\n    // Check file size\r\n    if (doc.file_size_bytes && !isWithinSizeLimit(doc.file_size_bytes)) {\r\n      return PREVIEW_ERROR_MESSAGES.FILE_TOO_LARGE\r\n    }\r\n\r\n    // Check file type by extension\r\n    const fileName = doc.file_name || doc.name || ''\r\n    const canPreviewByExtension = fileName ? isPreviewableExtension(fileName) : false\r\n\r\n    // Check file type by MIME type if available\r\n    const mimeType = doc.mime_type || ''\r\n    const canPreviewByMimeType = mimeType\r\n      ? isPreviewableMimeType(mimeType)\r\n      : false // If no MIME type, must fail validation (was incorrectly true)\r\n\r\n    // Explicitly check for Office documents that cannot be previewed\r\n    const fileExt = fileName.split('.').pop()?.toLowerCase() || ''\r\n    const officeExtensions = ['docx', 'doc', 'xlsx', 'xls', 'pptx', 'ppt', 'odt', 'ods', 'odp']\r\n    const isOfficeByExtension = officeExtensions.includes(fileExt)\r\n\r\n    const isOfficeDocument = isOfficeByExtension || (mimeType && (\r\n      mimeType.includes('officedocument') || // Office 2007+ formats\r\n      mimeType.includes('msword') || // Old Word format\r\n      mimeType.includes('ms-excel') || // Old Excel format\r\n      mimeType.includes('ms-powerpoint') || // Old PowerPoint format\r\n      mimeType.includes('opendocument') // OpenOffice/LibreOffice formats\r\n    ))\r\n\r\n    if (isOfficeDocument) {\r\n      return 'Office documents cannot be previewed. Please download to view.'\r\n    }\r\n\r\n    if (!canPreviewByExtension && !canPreviewByMimeType) {\r\n      return PREVIEW_ERROR_MESSAGES.UNSUPPORTED_TYPE\r\n    }\r\n\r\n    return null // Valid for preview\r\n  }\r\n\r\n  /**\r\n   * Open document preview\r\n   */\r\n  const openPreview = useCallback(async (doc: DocumentReference, dealId?: string) => {\r\n    // Reset state\r\n    setError(null)\r\n    setPreviewUrl(null)\r\n\r\n    // Validate document\r\n    const validationError = validateDocument(doc)\r\n    if (validationError) {\r\n      toast.error(validationError)\r\n      return\r\n    }\r\n\r\n    // Set document and open immediately (for better UX)\r\n    setDocument(doc)\r\n    setIsOpen(true)\r\n    setIsLoading(true)\r\n\r\n    try {\r\n      // Fetch preview URL based on document type\r\n      const response = dealId\r\n        ? await DocumentService.getDealDocumentPreviewUrl(dealId, doc.id)\r\n        : await DocumentService.getPreviewUrl(doc.id)\r\n\r\n      // Set preview URL\r\n      setPreviewUrl(response.download_url)\r\n      setIsLoading(false)\r\n    } catch (err) {\r\n      console.error('Failed to load document preview:', err)\r\n\r\n      const errorMessage =\r\n        err instanceof DocumentError\r\n          ? DocumentService.getErrorMessage(err)\r\n          : PREVIEW_ERROR_MESSAGES.LOAD_FAILED\r\n\r\n      setError(errorMessage)\r\n      setIsLoading(false)\r\n\r\n      // Also show toast for immediate feedback\r\n      toast.error(errorMessage)\r\n    }\r\n  }, [])\r\n\r\n  /**\r\n   * Close document preview\r\n   */\r\n  const closePreview = useCallback(() => {\r\n    setIsOpen(false)\r\n    // Delay cleanup to allow closing animation\r\n    setTimeout(() => {\r\n      setDocument(null)\r\n      setPreviewUrl(null)\r\n      setError(null)\r\n      setIsLoading(false)\r\n    }, 300)\r\n  }, [])\r\n\r\n  /**\r\n   * Download document from preview\r\n   */\r\n  const downloadDocument = useCallback(async () => {\r\n    if (!document) return\r\n\r\n    try {\r\n      // Use previewUrl if available (already fetched)\r\n      if (previewUrl) {\r\n        window.open(previewUrl, '_blank')\r\n        return\r\n      }\r\n\r\n      // Otherwise fetch download URL\r\n      const response = await DocumentService.getDownloadUrl(document.id)\r\n      window.open(response.download_url, '_blank')\r\n    } catch (err) {\r\n      console.error('Failed to download document:', err)\r\n\r\n      const errorMessage =\r\n        err instanceof DocumentError\r\n          ? DocumentService.getErrorMessage(err)\r\n          : 'Failed to download document'\r\n\r\n      toast.error(errorMessage)\r\n    }\r\n  }, [document, previewUrl])\r\n\r\n  return {\r\n    // State\r\n    isOpen,\r\n    document,\r\n    previewUrl,\r\n    isLoading,\r\n    error,\r\n\r\n    // Methods\r\n    openPreview,\r\n    closePreview,\r\n    downloadDocument,\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1088, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,0BAAY,0OAAgB,CAIhC,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,qQAAC,oMAAuB;QACtB,KAAK;QACL,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,gJAAE,EACX,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;AAIf,UAAU,WAAW,GAAG,oMAAuB,CAAC,WAAW"}},
    {"offset": {"line": 1118, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/kyc/schemas/kyc-questionnaire-schema.ts"],"sourcesContent":["import { z } from 'zod'\r\n\r\n// ============================================================================\r\n// STEP 1: About You (Subscriber Information)\r\n// ============================================================================\r\nexport const step1Schema = z.object({\r\n  fullName: z.string().min(2, 'Full name is required'),\r\n  dateOfBirth: z.string().min(1, 'Date of birth is required'),\r\n  nationality: z.string().min(2, 'Nationality is required'),\r\n  countryOfResidence: z.string().min(2, 'Country of residence is required'),\r\n  residentialAddress: z.string().min(5, 'Residential address is required'),\r\n  city: z.string().min(2, 'City is required'),\r\n  postalCode: z.string().min(2, 'Postal code is required'),\r\n  email: z.string().email('Valid email is required'),\r\n  phone: z.string().min(7, 'Phone number is required'),\r\n  taxIdNumber: z.string().optional(),\r\n  taxResidencyCountry: z.string().min(2, 'Tax residency country is required'),\r\n})\r\n\r\n// ============================================================================\r\n// STEP 2: Investment Type\r\n// ============================================================================\r\nexport const investmentTypeOptions = [\r\n  { value: 'individual', label: 'Individual (Personal Assets)' },\r\n  { value: 'joint', label: 'Joint Account' },\r\n  { value: 'trust', label: 'Trust or Estate' },\r\n  { value: 'corporation', label: 'Corporation / LLC' },\r\n  { value: 'partnership', label: 'Partnership' },\r\n  { value: 'other', label: 'Other' },\r\n] as const\r\n\r\nexport const step2Schema = z.object({\r\n  investmentType: z.enum(['individual', 'joint', 'trust', 'corporation', 'partnership', 'other']),\r\n  investmentTypeOther: z.string().optional(),\r\n}).refine(\r\n  (data) => data.investmentType !== 'other' || (data.investmentTypeOther && data.investmentTypeOther.length > 0),\r\n  { message: 'Please specify the investment type', path: ['investmentTypeOther'] }\r\n)\r\n\r\n// ============================================================================\r\n// STEP 3: Well-Informed Investor Status\r\n// ============================================================================\r\nexport const wellInformedBasisOptions = [\r\n  { value: 'net_worth', label: 'Net worth exceeds €1,250,000' },\r\n  { value: 'professional', label: 'Professional investor (regulated entity)' },\r\n  { value: 'institutional', label: 'Institutional investor' },\r\n  { value: 'experience', label: 'Significant investment experience' },\r\n  { value: 'advised', label: 'Advised by regulated advisor' },\r\n] as const\r\n\r\n// BUG FIX 3.5: Use proper enum array for wellInformedBasis\r\nconst wellInformedBasisValues = ['net_worth', 'professional', 'institutional', 'experience', 'advised'] as const\r\n\r\nexport const step3Schema = z.object({\r\n  isWellInformed: z.enum(['yes', 'no', 'unsure']),\r\n  wellInformedBasis: z.array(z.enum(wellInformedBasisValues)).optional(),\r\n  wellInformedEvidence: z.string().optional(),\r\n})\r\n\r\n// ============================================================================\r\n// STEP 4: Compliance Overview (12 questions)\r\n// ============================================================================\r\nexport const step4Schema = z.object({\r\n  // PEP Status\r\n  isPEP: z.enum(['yes', 'no']),\r\n  pepDetails: z.string().optional(),\r\n\r\n  // Family/Associate PEP\r\n  isRelatedToPEP: z.enum(['yes', 'no']),\r\n  relatedPEPDetails: z.string().optional(),\r\n\r\n  // Sanctions\r\n  isSanctioned: z.enum(['yes', 'no']),\r\n  sanctionedDetails: z.string().optional(),\r\n\r\n  // Criminal Record\r\n  hasCriminalRecord: z.enum(['yes', 'no']),\r\n  criminalDetails: z.string().optional(),\r\n\r\n  // Under Investigation\r\n  isUnderInvestigation: z.enum(['yes', 'no']),\r\n  investigationDetails: z.string().optional(),\r\n\r\n  // Bankruptcy\r\n  hasBankruptcy: z.enum(['yes', 'no']),\r\n  bankruptcyDetails: z.string().optional(),\r\n\r\n  // US Person indicator (triggers Steps 5-7)\r\n  isUSPerson: z.enum(['yes', 'no']),\r\n\r\n  // Source of Funds\r\n  sourceOfFunds: z.string().min(10, 'Please describe your source of funds'),\r\n\r\n  // Source of Wealth\r\n  sourceOfWealth: z.string().min(10, 'Please describe your source of wealth'),\r\n})\r\n\r\n// ============================================================================\r\n// STEP 5: US Person Definition (CONDITIONAL - only if isUSPerson = 'yes')\r\n// ============================================================================\r\nexport const step5Schema = z.object({\r\n  isUSCitizen: z.enum(['yes', 'no']),\r\n  isUSResident: z.enum(['yes', 'no']),\r\n  hasUSGreenCard: z.enum(['yes', 'no']),\r\n  hasSubstantialUSPresence: z.enum(['yes', 'no']),\r\n  hasUSMailingAddress: z.enum(['yes', 'no']),\r\n  hasUSPhoneNumber: z.enum(['yes', 'no']),\r\n  hasUSBankAccount: z.enum(['yes', 'no']),\r\n  hasUSPowerOfAttorney: z.enum(['yes', 'no']),\r\n  usConnectionDetails: z.string().optional(),\r\n})\r\n\r\n// ============================================================================\r\n// STEP 6: Offer Details (CONDITIONAL)\r\n// ============================================================================\r\nexport const step6Schema = z.object({\r\n  isAccreditedInvestor: z.enum(['yes', 'no']),\r\n  accreditationBasis: z.enum(['income', 'net_worth', 'professional', 'entity', 'other']).optional(),\r\n  hasReceivedOfferingMaterials: z.enum(['yes', 'no']),\r\n  understandsRestrictions: z.enum(['yes', 'no']),\r\n})\r\n\r\n// ============================================================================\r\n// STEP 7: Additional US Compliance (CONDITIONAL)\r\n// ============================================================================\r\nexport const step7Schema = z.object({\r\n  acknowledgesFATCA: z.boolean().refine(val => val === true, 'You must acknowledge FATCA requirements'),\r\n  willProvideW9: z.boolean().refine(val => val === true, 'You must agree to provide W-9 if required'),\r\n  understandsWithholding: z.boolean().refine(val => val === true, 'You must acknowledge withholding requirements'),\r\n  certifiesTaxCompliance: z.boolean().refine(val => val === true, 'You must certify tax compliance'),\r\n  acknowledgesReportingObligations: z.boolean().refine(val => val === true, 'You must acknowledge reporting obligations'),\r\n})\r\n\r\n// ============================================================================\r\n// STEP 8: Investment Suitability\r\n// ============================================================================\r\nexport const educationLevelOptions = [\r\n  { value: 'high_school', label: 'High School' },\r\n  { value: 'bachelors', label: \"Bachelor's Degree\" },\r\n  { value: 'masters', label: \"Master's Degree\" },\r\n  { value: 'doctorate', label: 'Doctorate' },\r\n  { value: 'professional', label: 'Professional Certification (CFA, CPA, etc.)' },\r\n] as const\r\n\r\nexport const employmentStatusOptions = [\r\n  { value: 'employed', label: 'Employed' },\r\n  { value: 'self_employed', label: 'Self-Employed' },\r\n  { value: 'retired', label: 'Retired' },\r\n  { value: 'unemployed', label: 'Unemployed' },\r\n  { value: 'student', label: 'Student' },\r\n] as const\r\n\r\nexport const incomeRangeOptions = [\r\n  { value: 'under_100k', label: 'Under $100,000' },\r\n  { value: '100k_250k', label: '$100,000 - $250,000' },\r\n  { value: '250k_500k', label: '$250,000 - $500,000' },\r\n  { value: '500k_1m', label: '$500,000 - $1,000,000' },\r\n  { value: '1m_plus', label: 'Over $1,000,000' },\r\n] as const\r\n\r\nexport const netWorthRangeOptions = [\r\n  { value: 'under_500k', label: 'Under $500,000' },\r\n  { value: '500k_1m', label: '$500,000 - $1,000,000' },\r\n  { value: '1m_5m', label: '$1,000,000 - $5,000,000' },\r\n  { value: '5m_10m', label: '$5,000,000 - $10,000,000' },\r\n  { value: '10m_plus', label: 'Over $10,000,000' },\r\n] as const\r\n\r\nexport const investmentObjectiveOptions = [\r\n  { value: 'capital_preservation', label: 'Capital Preservation' },\r\n  { value: 'income', label: 'Income Generation' },\r\n  { value: 'growth', label: 'Growth' },\r\n  { value: 'speculation', label: 'Speculation' },\r\n] as const\r\n\r\nexport const riskToleranceOptions = [\r\n  { value: 'conservative', label: 'Conservative - Prefer stability over returns' },\r\n  { value: 'moderate', label: 'Moderate - Balance of risk and return' },\r\n  { value: 'aggressive', label: 'Aggressive - Willing to accept higher risk' },\r\n] as const\r\n\r\nexport const timeHorizonOptions = [\r\n  { value: 'under_3_years', label: 'Less than 3 years' },\r\n  { value: '3_5_years', label: '3 - 5 years' },\r\n  { value: '5_10_years', label: '5 - 10 years' },\r\n  { value: 'over_10_years', label: 'Over 10 years' },\r\n] as const\r\n\r\nexport const step8Schema = z.object({\r\n  // Education & Experience\r\n  educationLevel: z.enum(['high_school', 'bachelors', 'masters', 'doctorate', 'professional']),\r\n  employmentStatus: z.enum(['employed', 'self_employed', 'retired', 'unemployed', 'student']),\r\n  occupation: z.string().optional(),\r\n  employer: z.string().optional(),\r\n  yearsInvestingExperience: z.string().min(1, 'Please indicate your investment experience'),\r\n\r\n  // Financial Profile\r\n  annualIncome: z.enum(['under_100k', '100k_250k', '250k_500k', '500k_1m', '1m_plus']),\r\n  netWorth: z.enum(['under_500k', '500k_1m', '1m_5m', '5m_10m', '10m_plus']),\r\n  liquidNetWorth: z.enum(['under_500k', '500k_1m', '1m_5m', '5m_10m', '10m_plus']),\r\n\r\n  // Investment Preferences\r\n  investmentObjective: z.enum(['capital_preservation', 'income', 'growth', 'speculation']),\r\n  riskTolerance: z.enum(['conservative', 'moderate', 'aggressive']),\r\n  investmentHorizon: z.enum(['under_3_years', '3_5_years', '5_10_years', 'over_10_years']),\r\n\r\n  // Investment Allocation\r\n  percentageOfNetWorthToInvest: z.string().min(1, 'Please indicate the percentage'),\r\n  hasAlternativeInvestmentExperience: z.enum(['yes', 'no']),\r\n  alternativeInvestmentTypes: z.array(z.string()).optional(),\r\n})\r\n\r\n// ============================================================================\r\n// STEP 9: Waiver & Risk Awareness\r\n// ============================================================================\r\nexport const step9Schema = z.object({\r\n  acknowledgesIlliquidity: z.boolean().refine(val => val === true, 'You must acknowledge this risk'),\r\n  acknowledgesLossRisk: z.boolean().refine(val => val === true, 'You must acknowledge this risk'),\r\n  acknowledgesNoGuarantees: z.boolean().refine(val => val === true, 'You must acknowledge this'),\r\n  acknowledgesLimitedInfo: z.boolean().refine(val => val === true, 'You must acknowledge this'),\r\n  acknowledgesNoRegulation: z.boolean().refine(val => val === true, 'You must acknowledge this'),\r\n  acknowledgesConflicts: z.boolean().refine(val => val === true, 'You must acknowledge this'),\r\n  acknowledgesTaxImplications: z.boolean().refine(val => val === true, 'You must acknowledge this'),\r\n  acknowledgesFees: z.boolean().refine(val => val === true, 'You must acknowledge this'),\r\n  hasReadOfferingDocs: z.boolean().refine(val => val === true, 'You must confirm this'),\r\n  hasSoughtIndependentAdvice: z.boolean().refine(val => val === true, 'You must confirm this'),\r\n})\r\n\r\n// ============================================================================\r\n// STEP 10: Signature & Certification\r\n// ============================================================================\r\nexport const step10Schema = z.object({\r\n  certifiesAccuracy: z.boolean().refine(val => val === true, 'You must certify accuracy'),\r\n  certifiesNoOmissions: z.boolean().refine(val => val === true, 'You must certify no omissions'),\r\n  agreesToUpdates: z.boolean().refine(val => val === true, 'You must agree to provide updates'),\r\n  consentToProcessing: z.boolean().refine(val => val === true, 'You must consent to data processing'),\r\n  signatureName: z.string().min(2, 'Please type your full name as signature'),\r\n  signatureDate: z.string().min(1, 'Signature date is required'),\r\n})\r\n\r\n// ============================================================================\r\n// Combined Schema\r\n// ============================================================================\r\nexport const kycQuestionnaireSchema = z.object({\r\n  step1: step1Schema,\r\n  step2: step2Schema,\r\n  step3: step3Schema,\r\n  step4: step4Schema,\r\n  step5: step5Schema.optional(), // Conditional\r\n  step6: step6Schema.optional(), // Conditional\r\n  step7: step7Schema.optional(), // Conditional\r\n  step8: step8Schema,\r\n  step9: step9Schema,\r\n  step10: step10Schema,\r\n  // Metadata\r\n  lastCompletedStep: z.number().optional(),\r\n  wizardVersion: z.string().default('2.0'),\r\n})\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\nexport type Step1Data = z.infer<typeof step1Schema>\r\nexport type Step2Data = z.infer<typeof step2Schema>\r\nexport type Step3Data = z.infer<typeof step3Schema>\r\nexport type Step4Data = z.infer<typeof step4Schema>\r\nexport type Step5Data = z.infer<typeof step5Schema>\r\nexport type Step6Data = z.infer<typeof step6Schema>\r\nexport type Step7Data = z.infer<typeof step7Schema>\r\nexport type Step8Data = z.infer<typeof step8Schema>\r\nexport type Step9Data = z.infer<typeof step9Schema>\r\nexport type Step10Data = z.infer<typeof step10Schema>\r\nexport type KYCQuestionnaireData = z.infer<typeof kycQuestionnaireSchema>\r\n\r\n// ============================================================================\r\n// Step Configuration\r\n// ============================================================================\r\nexport const STEP_CONFIG = [\r\n  { key: 'step1', title: 'About You', description: \"Let's start with your basic information\", icon: 'User', isConditional: false },\r\n  { key: 'step2', title: 'Investment Type', description: 'How will you be investing?', icon: 'Briefcase', isConditional: false },\r\n  { key: 'step3', title: 'Investor Status', description: 'Your investment experience', icon: 'GraduationCap', isConditional: false },\r\n  { key: 'step4', title: 'Compliance Check', description: 'Regulatory declarations', icon: 'Shield', isConditional: false },\r\n  { key: 'step5', title: 'US Person Status', description: 'US tax residency details', icon: 'Flag', isConditional: true },\r\n  { key: 'step6', title: 'Offer Details', description: 'Investment acknowledgments', icon: 'FileText', isConditional: true },\r\n  { key: 'step7', title: 'US Tax Compliance', description: 'FATCA and reporting requirements', icon: 'FileCheck', isConditional: true },\r\n  { key: 'step8', title: 'Suitability', description: 'Your financial profile', icon: 'TrendingUp', isConditional: false },\r\n  { key: 'step9', title: 'Risk Awareness', description: 'Understanding the risks', icon: 'AlertTriangle', isConditional: false },\r\n  { key: 'step10', title: 'Sign & Submit', description: 'Review and certify', icon: 'PenTool', isConditional: false },\r\n] as const\r\n\r\n// Helper to get schema for a step\r\nexport function getStepSchema(stepNumber: number) {\r\n  const schemas: Record<number, z.ZodTypeAny> = {\r\n    1: step1Schema,\r\n    2: step2Schema,\r\n    3: step3Schema,\r\n    4: step4Schema,\r\n    5: step5Schema,\r\n    6: step6Schema,\r\n    7: step7Schema,\r\n    8: step8Schema,\r\n    9: step9Schema,\r\n    10: step10Schema,\r\n  }\r\n  return schemas[stepNumber]\r\n}\r\n\r\n// Helper to check if US Person steps should be shown\r\nexport function shouldShowUSPersonSteps(step4Data?: Step4Data): boolean {\r\n  return step4Data?.isUSPerson === 'yes'\r\n}\r\n\r\n// Get visible steps based on form data\r\nexport function getVisibleSteps(formData: Partial<KYCQuestionnaireData>): number[] {\r\n  const showUSSteps = shouldShowUSPersonSteps(formData.step4)\r\n\r\n  if (showUSSteps) {\r\n    return [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\r\n  }\r\n\r\n  // Skip steps 5, 6, 7 for non-US persons\r\n  return [1, 2, 3, 4, 8, 9, 10]\r\n}\r\n\r\n// BUG FIX 2.7: Compute signature date at runtime, not module load time\r\nfunction getTodayDate(): string {\r\n  return new Date().toISOString().split('T')[0]\r\n}\r\n\r\n// Get default values for each step\r\nexport function getStepDefaults(stepNumber: number): Record<string, unknown> {\r\n  // BUG FIX 2.7: Step 10 defaults are computed dynamically for signatureDate\r\n  if (stepNumber === 10) {\r\n    return {\r\n      certifiesAccuracy: false,\r\n      certifiesNoOmissions: false,\r\n      agreesToUpdates: false,\r\n      consentToProcessing: false,\r\n      signatureName: '',\r\n      signatureDate: getTodayDate(), // Computed at call time, not module load\r\n    }\r\n  }\r\n\r\n  const defaults: Record<number, Record<string, unknown>> = {\r\n    1: {\r\n      fullName: '',\r\n      dateOfBirth: '',\r\n      nationality: '',\r\n      countryOfResidence: '',\r\n      residentialAddress: '',\r\n      city: '',\r\n      postalCode: '',\r\n      email: '',\r\n      phone: '',\r\n      taxIdNumber: '',\r\n      taxResidencyCountry: '',\r\n    },\r\n    2: {\r\n      investmentType: undefined,\r\n      investmentTypeOther: '',\r\n    },\r\n    3: {\r\n      isWellInformed: undefined,\r\n      wellInformedBasis: [],\r\n      wellInformedEvidence: '',\r\n    },\r\n    4: {\r\n      isPEP: undefined,\r\n      pepDetails: '',\r\n      isRelatedToPEP: undefined,\r\n      relatedPEPDetails: '',\r\n      isSanctioned: undefined,\r\n      sanctionedDetails: '',\r\n      hasCriminalRecord: undefined,\r\n      criminalDetails: '',\r\n      isUnderInvestigation: undefined,\r\n      investigationDetails: '',\r\n      hasBankruptcy: undefined,\r\n      bankruptcyDetails: '',\r\n      isUSPerson: undefined,\r\n      sourceOfFunds: '',\r\n      sourceOfWealth: '',\r\n    },\r\n    5: {\r\n      isUSCitizen: undefined,\r\n      isUSResident: undefined,\r\n      hasUSGreenCard: undefined,\r\n      hasSubstantialUSPresence: undefined,\r\n      hasUSMailingAddress: undefined,\r\n      hasUSPhoneNumber: undefined,\r\n      hasUSBankAccount: undefined,\r\n      hasUSPowerOfAttorney: undefined,\r\n      usConnectionDetails: '',\r\n    },\r\n    6: {\r\n      isAccreditedInvestor: undefined,\r\n      accreditationBasis: undefined,\r\n      hasReceivedOfferingMaterials: undefined,\r\n      understandsRestrictions: undefined,\r\n    },\r\n    7: {\r\n      acknowledgesFATCA: false,\r\n      willProvideW9: false,\r\n      understandsWithholding: false,\r\n      certifiesTaxCompliance: false,\r\n      acknowledgesReportingObligations: false,\r\n    },\r\n    8: {\r\n      educationLevel: undefined,\r\n      employmentStatus: undefined,\r\n      occupation: '',\r\n      employer: '',\r\n      yearsInvestingExperience: '',\r\n      annualIncome: undefined,\r\n      netWorth: undefined,\r\n      liquidNetWorth: undefined,\r\n      investmentObjective: undefined,\r\n      riskTolerance: undefined,\r\n      investmentHorizon: undefined,\r\n      percentageOfNetWorthToInvest: '',\r\n      hasAlternativeInvestmentExperience: undefined,\r\n      alternativeInvestmentTypes: [],\r\n    },\r\n    9: {\r\n      acknowledgesIlliquidity: false,\r\n      acknowledgesLossRisk: false,\r\n      acknowledgesNoGuarantees: false,\r\n      acknowledgesLimitedInfo: false,\r\n      acknowledgesNoRegulation: false,\r\n      acknowledgesConflicts: false,\r\n      acknowledgesTaxImplications: false,\r\n      acknowledgesFees: false,\r\n      hasReadOfferingDocs: false,\r\n      hasSoughtIndependentAdvice: false,\r\n    },\r\n  }\r\n  return defaults[stepNumber] || {}\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1848, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/kyc/questionnaire-viewer.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Separator } from '@/components/ui/separator'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  User,\r\n  Briefcase,\r\n  GraduationCap,\r\n  Shield,\r\n  Flag,\r\n  FileText,\r\n  FileCheck,\r\n  TrendingUp,\r\n  AlertTriangle,\r\n  PenTool,\r\n  AlertCircle,\r\n  CheckCircle,\r\n  XCircle,\r\n} from 'lucide-react'\r\nimport { STEP_CONFIG, shouldShowUSPersonSteps } from './schemas/kyc-questionnaire-schema'\r\n\r\n// Field labels for human-readable display\r\nconst FIELD_LABELS: Record<string, string> = {\r\n  // Step 1: About You\r\n  fullName: 'Full Legal Name',\r\n  dateOfBirth: 'Date of Birth',\r\n  nationality: 'Nationality',\r\n  countryOfResidence: 'Country of Residence',\r\n  residentialAddress: 'Residential Address',\r\n  city: 'City',\r\n  postalCode: 'Postal Code',\r\n  email: 'Email Address',\r\n  phone: 'Phone Number',\r\n  taxIdNumber: 'Tax ID Number',\r\n  taxResidencyCountry: 'Tax Residency Country',\r\n\r\n  // Step 2: Investment Type\r\n  investmentType: 'Investment Type',\r\n  investmentTypeOther: 'Other Investment Type',\r\n\r\n  // Step 3: Well-Informed Status\r\n  isWellInformed: 'Well-Informed Investor?',\r\n  wellInformedBasis: 'Basis for Well-Informed Status',\r\n  wellInformedEvidence: 'Supporting Evidence',\r\n\r\n  // Step 4: Compliance (HIGH RISK)\r\n  isPEP: 'Politically Exposed Person (PEP)?',\r\n  pepDetails: 'PEP Details',\r\n  isRelatedToPEP: 'Related to a PEP?',\r\n  relatedPEPDetails: 'Related PEP Details',\r\n  isSanctioned: 'Subject to Sanctions?',\r\n  sanctionedDetails: 'Sanctions Details',\r\n  hasCriminalRecord: 'Criminal Record?',\r\n  criminalDetails: 'Criminal Record Details',\r\n  isUnderInvestigation: 'Under Investigation?',\r\n  investigationDetails: 'Investigation Details',\r\n  hasBankruptcy: 'Bankruptcy History?',\r\n  bankruptcyDetails: 'Bankruptcy Details',\r\n  isUSPerson: 'US Person?',\r\n  sourceOfFunds: 'Source of Funds',\r\n  sourceOfWealth: 'Source of Wealth',\r\n\r\n  // Step 5: US Person Status\r\n  isUSCitizen: 'US Citizen?',\r\n  isUSResident: 'US Resident?',\r\n  hasUSGreenCard: 'US Green Card Holder?',\r\n  hasSubstantialUSPresence: 'Substantial US Presence?',\r\n  hasUSMailingAddress: 'US Mailing Address?',\r\n  hasUSPhoneNumber: 'US Phone Number?',\r\n  hasUSBankAccount: 'US Bank Account?',\r\n  hasUSPowerOfAttorney: 'US Power of Attorney?',\r\n  usConnectionDetails: 'US Connection Details',\r\n\r\n  // Step 6: Offer Details\r\n  isAccreditedInvestor: 'Accredited Investor?',\r\n  accreditationBasis: 'Accreditation Basis',\r\n  hasReceivedOfferingMaterials: 'Received Offering Materials?',\r\n  understandsRestrictions: 'Understands Restrictions?',\r\n\r\n  // Step 7: US Tax Compliance\r\n  acknowledgesFATCA: 'FATCA Acknowledgment',\r\n  willProvideW9: 'Will Provide W-9?',\r\n  understandsWithholding: 'Understands Withholding?',\r\n  certifiesTaxCompliance: 'Certifies Tax Compliance?',\r\n  acknowledgesReportingObligations: 'Reporting Obligations Acknowledged?',\r\n\r\n  // Step 8: Investment Suitability\r\n  educationLevel: 'Education Level',\r\n  employmentStatus: 'Employment Status',\r\n  occupation: 'Occupation',\r\n  employer: 'Employer',\r\n  yearsInvestingExperience: 'Years of Investment Experience',\r\n  annualIncome: 'Annual Income',\r\n  netWorth: 'Net Worth',\r\n  liquidNetWorth: 'Liquid Net Worth',\r\n  investmentObjective: 'Investment Objective',\r\n  riskTolerance: 'Risk Tolerance',\r\n  investmentHorizon: 'Investment Time Horizon',\r\n  percentageOfNetWorthToInvest: '% of Net Worth to Invest',\r\n  hasAlternativeInvestmentExperience: 'Alternative Investment Experience?',\r\n  alternativeInvestmentTypes: 'Types of Alternative Investments',\r\n\r\n  // Step 9: Risk Awareness\r\n  acknowledgesIlliquidity: 'Acknowledges Illiquidity Risk',\r\n  acknowledgesLossRisk: 'Acknowledges Loss Risk',\r\n  acknowledgesNoGuarantees: 'Acknowledges No Guarantees',\r\n  acknowledgesLimitedInfo: 'Acknowledges Limited Information',\r\n  acknowledgesNoRegulation: 'Acknowledges Limited Regulation',\r\n  acknowledgesConflicts: 'Acknowledges Conflicts of Interest',\r\n  acknowledgesTaxImplications: 'Acknowledges Tax Implications',\r\n  acknowledgesFees: 'Acknowledges Fees',\r\n  hasReadOfferingDocs: 'Has Read Offering Documents',\r\n  hasSoughtIndependentAdvice: 'Has Sought Independent Advice',\r\n\r\n  // Step 10: Signature\r\n  certifiesAccuracy: 'Certifies Accuracy',\r\n  certifiesNoOmissions: 'Certifies No Omissions',\r\n  agreesToUpdates: 'Agrees to Provide Updates',\r\n  consentToProcessing: 'Consents to Data Processing',\r\n  signatureName: 'Signature Name',\r\n  signatureDate: 'Signature Date',\r\n\r\n  // Metadata\r\n  lastCompletedStep: 'Last Completed Step',\r\n  wizardVersion: 'Form Version',\r\n}\r\n\r\n// High-risk fields that should be highlighted\r\nconst HIGH_RISK_FIELDS = [\r\n  'isPEP',\r\n  'isRelatedToPEP',\r\n  'isSanctioned',\r\n  'hasCriminalRecord',\r\n  'isUnderInvestigation',\r\n  'hasBankruptcy',\r\n]\r\n\r\n// Fields organized by step\r\nconst STEP_FIELDS: Record<string, string[]> = {\r\n  step1: ['fullName', 'dateOfBirth', 'nationality', 'countryOfResidence', 'residentialAddress', 'city', 'postalCode', 'email', 'phone', 'taxIdNumber', 'taxResidencyCountry'],\r\n  step2: ['investmentType', 'investmentTypeOther'],\r\n  step3: ['isWellInformed', 'wellInformedBasis', 'wellInformedEvidence'],\r\n  step4: ['isPEP', 'pepDetails', 'isRelatedToPEP', 'relatedPEPDetails', 'isSanctioned', 'sanctionedDetails', 'hasCriminalRecord', 'criminalDetails', 'isUnderInvestigation', 'investigationDetails', 'hasBankruptcy', 'bankruptcyDetails', 'isUSPerson', 'sourceOfFunds', 'sourceOfWealth'],\r\n  step5: ['isUSCitizen', 'isUSResident', 'hasUSGreenCard', 'hasSubstantialUSPresence', 'hasUSMailingAddress', 'hasUSPhoneNumber', 'hasUSBankAccount', 'hasUSPowerOfAttorney', 'usConnectionDetails'],\r\n  step6: ['isAccreditedInvestor', 'accreditationBasis', 'hasReceivedOfferingMaterials', 'understandsRestrictions'],\r\n  step7: ['acknowledgesFATCA', 'willProvideW9', 'understandsWithholding', 'certifiesTaxCompliance', 'acknowledgesReportingObligations'],\r\n  step8: ['educationLevel', 'employmentStatus', 'occupation', 'employer', 'yearsInvestingExperience', 'annualIncome', 'netWorth', 'liquidNetWorth', 'investmentObjective', 'riskTolerance', 'investmentHorizon', 'percentageOfNetWorthToInvest', 'hasAlternativeInvestmentExperience', 'alternativeInvestmentTypes'],\r\n  step9: ['acknowledgesIlliquidity', 'acknowledgesLossRisk', 'acknowledgesNoGuarantees', 'acknowledgesLimitedInfo', 'acknowledgesNoRegulation', 'acknowledgesConflicts', 'acknowledgesTaxImplications', 'acknowledgesFees', 'hasReadOfferingDocs', 'hasSoughtIndependentAdvice'],\r\n  step10: ['certifiesAccuracy', 'certifiesNoOmissions', 'agreesToUpdates', 'consentToProcessing', 'signatureName', 'signatureDate'],\r\n}\r\n\r\n// Icon mapping for steps\r\nconst STEP_ICONS: Record<string, typeof User> = {\r\n  step1: User,\r\n  step2: Briefcase,\r\n  step3: GraduationCap,\r\n  step4: Shield,\r\n  step5: Flag,\r\n  step6: FileText,\r\n  step7: FileCheck,\r\n  step8: TrendingUp,\r\n  step9: AlertTriangle,\r\n  step10: PenTool,\r\n}\r\n\r\n// Format value for display\r\nfunction formatValue(key: string, value: unknown): string {\r\n  if (value === null || value === undefined || value === '') {\r\n    return '—'\r\n  }\r\n\r\n  // Boolean values\r\n  if (typeof value === 'boolean') {\r\n    return value ? 'Yes' : 'No'\r\n  }\r\n\r\n  // Yes/No string values\r\n  if (value === 'yes' || value === 'no') {\r\n    return value === 'yes' ? 'Yes' : 'No'\r\n  }\r\n\r\n  // Arrays\r\n  if (Array.isArray(value)) {\r\n    if (value.length === 0) return '—'\r\n    return value.map(v => formatEnumValue(String(v))).join(', ')\r\n  }\r\n\r\n  // Enum-like values (snake_case or camelCase)\r\n  if (typeof value === 'string' && (value.includes('_') || /^[a-z]+[A-Z]/.test(value))) {\r\n    return formatEnumValue(value)\r\n  }\r\n\r\n  return String(value)\r\n}\r\n\r\n// Format enum values to readable text\r\nfunction formatEnumValue(value: string): string {\r\n  return value\r\n    .replace(/_/g, ' ')\r\n    .replace(/([A-Z])/g, ' $1')\r\n    .replace(/\\b\\w/g, l => l.toUpperCase())\r\n    .trim()\r\n}\r\n\r\n// Check if a field has a high-risk value\r\nfunction isHighRiskValue(key: string, value: unknown): boolean {\r\n  if (!HIGH_RISK_FIELDS.includes(key)) return false\r\n  return value === 'yes' || value === true\r\n}\r\n\r\ninterface QuestionnaireViewerProps {\r\n  open: boolean\r\n  onClose: () => void\r\n  investorName: string\r\n  submittedAt: string\r\n  metadata: Record<string, unknown>\r\n}\r\n\r\nexport function QuestionnaireViewer({\r\n  open,\r\n  onClose,\r\n  investorName,\r\n  submittedAt,\r\n  metadata,\r\n}: QuestionnaireViewerProps) {\r\n  if (!metadata) return null\r\n\r\n  // Flatten nested step data (e.g., { step1: {...}, step2: {...} })\r\n  const flattenedData: Record<string, unknown> = {}\r\n\r\n  for (const [key, value] of Object.entries(metadata)) {\r\n    if (key.startsWith('step') && typeof value === 'object' && value !== null) {\r\n      // It's a step object, flatten its contents\r\n      Object.assign(flattenedData, value)\r\n    } else {\r\n      // It's a top-level field\r\n      flattenedData[key] = value\r\n    }\r\n  }\r\n\r\n  // Check if US Person steps should be shown\r\n  const showUSSteps = flattenedData.isUSPerson === 'yes'\r\n\r\n  // Determine which steps to show\r\n  const visibleSteps = showUSSteps\r\n    ? ['step1', 'step2', 'step3', 'step4', 'step5', 'step6', 'step7', 'step8', 'step9', 'step10']\r\n    : ['step1', 'step2', 'step3', 'step4', 'step8', 'step9', 'step10']\r\n\r\n  // Get step config info\r\n  const getStepInfo = (stepKey: string) => {\r\n    const index = parseInt(stepKey.replace('step', '')) - 1\r\n    return STEP_CONFIG[index]\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={(isOpen) => !isOpen && onClose()}>\r\n      <DialogContent className=\"max-w-3xl max-h-[85vh] flex flex-col overflow-hidden\">\r\n        <DialogHeader className=\"flex-shrink-0\">\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <FileText className=\"h-5 w-5\" />\r\n            KYC Questionnaire Responses\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Submitted by <span className=\"font-medium text-foreground\">{investorName}</span> on{' '}\r\n            {new Date(submittedAt).toLocaleDateString('en-US', {\r\n              year: 'numeric',\r\n              month: 'long',\r\n              day: 'numeric',\r\n            })}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        {/* Scrollable content area with explicit height and overflow */}\r\n        <div className=\"flex-1 min-h-0 -mx-6 px-6 overflow-y-auto\">\r\n          <div className=\"space-y-6 py-4\">\r\n            {visibleSteps.map((stepKey) => {\r\n              const stepInfo = getStepInfo(stepKey)\r\n              const StepIcon = STEP_ICONS[stepKey] || FileText\r\n              const fields = STEP_FIELDS[stepKey] || []\r\n\r\n              // Filter to fields that have values\r\n              const fieldsWithValues = fields.filter(\r\n                field => flattenedData[field] !== undefined && flattenedData[field] !== ''\r\n              )\r\n\r\n              if (fieldsWithValues.length === 0) return null\r\n\r\n              return (\r\n                <Card key={stepKey} className=\"border-border/50\">\r\n                  <CardHeader className=\"pb-3\">\r\n                    <CardTitle className=\"text-base font-semibold flex items-center gap-2\">\r\n                      <StepIcon className=\"h-4 w-4 text-muted-foreground\" />\r\n                      {stepInfo?.title || `Step ${stepKey.replace('step', '')}`}\r\n                      {stepKey === 'step4' && (\r\n                        <Badge variant=\"outline\" className=\"ml-2 text-xs font-normal\">\r\n                          Compliance\r\n                        </Badge>\r\n                      )}\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <div className=\"grid gap-3\">\r\n                      {fieldsWithValues.map((field) => {\r\n                        const value = flattenedData[field]\r\n                        const isHighRisk = isHighRiskValue(field, value)\r\n                        const label = FIELD_LABELS[field] || formatEnumValue(field)\r\n                        const formattedValue = formatValue(field, value)\r\n\r\n                        return (\r\n                          <div\r\n                            key={field}\r\n                            className={`flex flex-col gap-1 p-3 rounded-lg ${\r\n                              isHighRisk\r\n                                ? 'bg-destructive/10 border border-destructive/30'\r\n                                : 'bg-muted/50'\r\n                            }`}\r\n                          >\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <span className=\"text-sm font-medium text-muted-foreground\">\r\n                                {label}\r\n                              </span>\r\n                              {isHighRisk && (\r\n                                <Badge variant=\"destructive\" className=\"text-xs\">\r\n                                  <AlertCircle className=\"h-3 w-3 mr-1\" />\r\n                                  Requires Review\r\n                                </Badge>\r\n                              )}\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2\">\r\n                              {typeof value === 'boolean' || value === 'yes' || value === 'no' ? (\r\n                                <>\r\n                                  {value === true || value === 'yes' ? (\r\n                                    <CheckCircle className={`h-4 w-4 ${isHighRisk ? 'text-destructive' : 'text-emerald-500'}`} />\r\n                                  ) : (\r\n                                    <XCircle className=\"h-4 w-4 text-muted-foreground\" />\r\n                                  )}\r\n                                  <span className={`text-sm ${isHighRisk ? 'font-semibold text-destructive' : 'text-foreground'}`}>\r\n                                    {formattedValue}\r\n                                  </span>\r\n                                </>\r\n                              ) : (\r\n                                <span className=\"text-sm text-foreground\">\r\n                                  {formattedValue}\r\n                                </span>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )\r\n                      })}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              )\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        <Separator className=\"flex-shrink-0\" />\r\n\r\n        <DialogFooter className=\"pt-4 flex-shrink-0\">\r\n          <Button onClick={onClose}>Close</Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2435, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/constants/kyc-document-types.ts"],"sourcesContent":["/**\r\n * KYC Document Types - VERSO Holdings\r\n *\r\n * Compulsory KYC documents for all entities including investors, partners,\r\n * introducers, lawyers, arrangers, and commercial partners.\r\n */\r\n\r\nexport interface KYCDocumentTypeInfo {\r\n  label: string\r\n  description: string\r\n  category: 'individual' | 'entity' | 'both'\r\n  /** For member-specific documents */\r\n  memberOnly?: boolean\r\n}\r\n\r\n/**\r\n * KYC document types\r\n *\r\n * Entity documents: Required for entity-level KYC\r\n * Individual documents: Required for individuals, directors, shareholders, and members\r\n */\r\nexport const SUGGESTED_KYC_DOCUMENT_TYPES: Record<string, KYCDocumentTypeInfo> = {\r\n  // ===== QUESTIONNAIRE =====\r\n  questionnaire: {\r\n    label: 'KYC Questionnaire',\r\n    description: 'Investor questionnaire responses',\r\n    category: 'both',\r\n  },\r\n\r\n  // ===== ENTITY DOCUMENTS - FORMATION =====\r\n  nda_ndnc: {\r\n    label: 'NDA / NDNC',\r\n    description: 'Non-Disclosure and Non-Circumvention Agreement',\r\n    category: 'entity',\r\n  },\r\n  incorporation_certificate: {\r\n    label: 'Incorporation Certificate',\r\n    description: 'Certificate of Incorporation',\r\n    category: 'entity',\r\n  },\r\n  memo_articles: {\r\n    label: 'Memo & Articles of Association',\r\n    description: 'Memorandum and Articles of Association',\r\n    category: 'entity',\r\n  },\r\n  certificate_of_good_standing: {\r\n    label: 'Certificate of Good Standing',\r\n    description: 'Certificate confirming entity is in good standing with registry',\r\n    category: 'entity',\r\n  },\r\n  certificate_of_incumbency: {\r\n    label: 'Certificate of Incumbency',\r\n    description: 'Certificate listing current directors and officers',\r\n    category: 'entity',\r\n  },\r\n  company_register_extract: {\r\n    label: 'Company Register Extract',\r\n    description: 'Official extract from company registry',\r\n    category: 'entity',\r\n  },\r\n  partnership_agreement: {\r\n    label: 'Partnership Agreement',\r\n    description: 'Limited Partnership or General Partnership Agreement',\r\n    category: 'entity',\r\n  },\r\n  operating_agreement: {\r\n    label: 'Operating Agreement',\r\n    description: 'LLC Operating Agreement or equivalent',\r\n    category: 'entity',\r\n  },\r\n\r\n  // ===== ENTITY DOCUMENTS - GOVERNANCE =====\r\n  register_members: {\r\n    label: 'Register of Members',\r\n    description: 'Current register of all members/shareholders',\r\n    category: 'entity',\r\n  },\r\n  register_directors: {\r\n    label: 'Register of Directors',\r\n    description: 'Current register of all directors',\r\n    category: 'entity',\r\n  },\r\n  register_beneficial_owners: {\r\n    label: 'Register of Beneficial Owners',\r\n    description: 'Register of ultimate beneficial owners (UBOs)',\r\n    category: 'entity',\r\n  },\r\n  directors_declaration: {\r\n    label: 'Directors Declaration',\r\n    description: 'Signed declaration from board of directors',\r\n    category: 'entity',\r\n  },\r\n  board_resolution: {\r\n    label: 'Board Resolution',\r\n    description: 'Board resolution authorizing investment or account opening',\r\n    category: 'entity',\r\n  },\r\n  authorized_signatory_list: {\r\n    label: 'Authorized Signatory List',\r\n    description: 'List of persons authorized to sign on behalf of entity',\r\n    category: 'entity',\r\n  },\r\n  power_of_attorney: {\r\n    label: 'Power of Attorney',\r\n    description: 'Power of Attorney document',\r\n    category: 'entity',\r\n  },\r\n\r\n  // ===== ENTITY DOCUMENTS - FINANCIAL =====\r\n  bank_confirmation: {\r\n    label: 'Bank Confirmation',\r\n    description: 'Confirmation of bank name and jurisdiction for wire transfers',\r\n    category: 'entity',\r\n  },\r\n  financial_statements: {\r\n    label: 'Financial Statements',\r\n    description: 'Audited Financial Statements',\r\n    category: 'entity',\r\n  },\r\n  beneficial_ownership: {\r\n    label: 'Beneficial Ownership Declaration',\r\n    description: 'Declaration of ultimate beneficial owners',\r\n    category: 'entity',\r\n  },\r\n\r\n  // ===== TRUST DOCUMENTS =====\r\n  trust_deed: {\r\n    label: 'Trust Deed',\r\n    description: 'Trust Deed or Declaration of Trust',\r\n    category: 'entity',\r\n  },\r\n  trust_schedule: {\r\n    label: 'Trust Schedule',\r\n    description: 'Schedule of beneficiaries and settlors',\r\n    category: 'entity',\r\n  },\r\n  letter_of_wishes: {\r\n    label: 'Letter of Wishes',\r\n    description: 'Settlor letter of wishes',\r\n    category: 'entity',\r\n  },\r\n\r\n  // ===== INDIVIDUAL / MEMBER ID DOCUMENTS =====\r\n  passport_id: {\r\n    label: 'ID / Passport',\r\n    description: 'Valid government-issued ID or passport',\r\n    category: 'both',\r\n  },\r\n  passport: {\r\n    label: 'Passport',\r\n    description: 'Valid passport (photo page)',\r\n    category: 'both',\r\n  },\r\n  national_id_card: {\r\n    label: 'National ID Card',\r\n    description: 'Government-issued national identification card',\r\n    category: 'both',\r\n  },\r\n  drivers_license: {\r\n    label: \"Driver's License\",\r\n    description: 'Government-issued driving license',\r\n    category: 'both',\r\n  },\r\n  residence_permit: {\r\n    label: 'Residence Permit',\r\n    description: 'Valid residence permit or visa',\r\n    category: 'both',\r\n  },\r\n\r\n  // ===== PROOF OF ADDRESS DOCUMENTS =====\r\n  utility_bill: {\r\n    label: 'Utility Bill',\r\n    description: 'Recent utility bill (less than 3 months old)',\r\n    category: 'both',\r\n  },\r\n  bank_statement: {\r\n    label: 'Bank Statement',\r\n    description: 'Recent bank statement (less than 3 months old)',\r\n    category: 'both',\r\n  },\r\n  proof_of_address: {\r\n    label: 'Proof of Address',\r\n    description: 'Recent utility bill, bank statement, or official letter',\r\n    category: 'both',\r\n  },\r\n  government_correspondence: {\r\n    label: 'Government Correspondence',\r\n    description: 'Recent letter from government agency with address',\r\n    category: 'both',\r\n  },\r\n  council_tax_bill: {\r\n    label: 'Council Tax Bill',\r\n    description: 'Council tax or property tax statement',\r\n    category: 'both',\r\n  },\r\n\r\n  // ===== ACCREDITATION / QUALIFICATION =====\r\n  accreditation_letter: {\r\n    label: 'Accreditation Letter',\r\n    description: 'Accredited Investor verification letter',\r\n    category: 'individual',\r\n  },\r\n  professional_qualification: {\r\n    label: 'Professional Qualification',\r\n    description: 'Professional investor qualification or certification',\r\n    category: 'individual',\r\n  },\r\n  sophistication_declaration: {\r\n    label: 'Sophistication Declaration',\r\n    description: 'Self-certification as sophisticated investor',\r\n    category: 'individual',\r\n  },\r\n\r\n  // ===== TAX DOCUMENTS =====\r\n  tax_w8_ben: {\r\n    label: 'W-8BEN / W-8BEN-E',\r\n    description: 'IRS form for foreign persons/entities',\r\n    category: 'both',\r\n  },\r\n  tax_w9: {\r\n    label: 'W-9',\r\n    description: 'IRS form for US persons',\r\n    category: 'individual',\r\n  },\r\n  tax_return: {\r\n    label: 'Tax Return',\r\n    description: 'Recent tax return or tax filing',\r\n    category: 'both',\r\n  },\r\n  tax_residency_certificate: {\r\n    label: 'Tax Residency Certificate',\r\n    description: 'Certificate of tax residency from tax authority',\r\n    category: 'both',\r\n  },\r\n\r\n  // ===== AML / SOURCE OF FUNDS =====\r\n  source_of_funds: {\r\n    label: 'Source of Funds',\r\n    description: 'Source of Funds Declaration',\r\n    category: 'both',\r\n  },\r\n  source_of_wealth: {\r\n    label: 'Source of Wealth',\r\n    description: 'Source of Wealth Declaration',\r\n    category: 'both',\r\n  },\r\n  employment_letter: {\r\n    label: 'Employment Letter',\r\n    description: 'Letter confirming employment and salary',\r\n    category: 'individual',\r\n  },\r\n  business_ownership_proof: {\r\n    label: 'Business Ownership Proof',\r\n    description: 'Documentation proving business ownership',\r\n    category: 'both',\r\n  },\r\n\r\n  // ===== PARTNER / INTRODUCER SPECIFIC =====\r\n  introducer_agreement: {\r\n    label: 'Introducer Agreement',\r\n    description: 'Signed introducer/referral agreement',\r\n    category: 'entity',\r\n  },\r\n  fee_agreement: {\r\n    label: 'Fee Agreement',\r\n    description: 'Signed fee sharing or commission agreement',\r\n    category: 'entity',\r\n  },\r\n  regulatory_license: {\r\n    label: 'Regulatory License',\r\n    description: 'Financial services or regulatory license',\r\n    category: 'entity',\r\n  },\r\n  professional_indemnity_insurance: {\r\n    label: 'Professional Indemnity Insurance',\r\n    description: 'Certificate of professional indemnity insurance',\r\n    category: 'entity',\r\n  },\r\n\r\n  // ===== LAWYER SPECIFIC =====\r\n  practicing_certificate: {\r\n    label: 'Practicing Certificate',\r\n    description: 'Current practicing certificate from bar association',\r\n    category: 'entity',\r\n  },\r\n  bar_membership: {\r\n    label: 'Bar Membership',\r\n    description: 'Bar association membership certificate',\r\n    category: 'entity',\r\n  },\r\n  law_firm_letterhead: {\r\n    label: 'Law Firm Letterhead',\r\n    description: 'Official letterhead confirming association',\r\n    category: 'entity',\r\n  },\r\n\r\n  // ===== MEMBER-SPECIFIC DOCUMENTS =====\r\n  member_passport: {\r\n    label: 'Member Passport/ID',\r\n    description: 'Passport or ID for director/UBO/signatory',\r\n    category: 'both',\r\n    memberOnly: true,\r\n  },\r\n  member_proof_of_address: {\r\n    label: 'Member Proof of Address',\r\n    description: 'Proof of address for director/UBO/signatory',\r\n    category: 'both',\r\n    memberOnly: true,\r\n  },\r\n  specimen_signature: {\r\n    label: 'Specimen Signature',\r\n    description: 'Specimen signature for authorized signatory',\r\n    category: 'both',\r\n    memberOnly: true,\r\n  },\r\n\r\n  // ===== OTHER =====\r\n  other: {\r\n    label: 'Other Document',\r\n    description: 'Any other supporting document',\r\n    category: 'both',\r\n  },\r\n} as const\r\n\r\nexport type KYCDocumentType = keyof typeof SUGGESTED_KYC_DOCUMENT_TYPES\r\n\r\n/**\r\n * Get display label for a document type\r\n */\r\nexport function getDocumentTypeLabel(documentType: string, customLabel?: string | null): string {\r\n  if (customLabel) {\r\n    return customLabel\r\n  }\r\n\r\n  const typeInfo = SUGGESTED_KYC_DOCUMENT_TYPES[documentType]\r\n  return typeInfo?.label || formatDocumentType(documentType)\r\n}\r\n\r\n/**\r\n * Format document type string for display (fallback for unknown types)\r\n */\r\nfunction formatDocumentType(documentType: string): string {\r\n  return documentType\r\n    .split('_')\r\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n    .join(' ')\r\n}\r\n\r\n/**\r\n * Get suggested document types for a specific category\r\n */\r\nexport function getSuggestedDocumentTypes(\r\n  category?: 'individual' | 'entity' | 'both',\r\n  options?: { includeMemberOnly?: boolean }\r\n): Array<{\r\n  value: string\r\n  label: string\r\n  description: string\r\n  memberOnly?: boolean\r\n}> {\r\n  return Object.entries(SUGGESTED_KYC_DOCUMENT_TYPES)\r\n    .filter(([_, info]) => {\r\n      // Filter by category\r\n      const categoryMatch = !category || info.category === category || info.category === 'both'\r\n      // Filter member-only documents unless explicitly included\r\n      const memberMatch = options?.includeMemberOnly || !info.memberOnly\r\n      return categoryMatch && memberMatch\r\n    })\r\n    .map(([value, info]) => ({\r\n      value,\r\n      label: info.label,\r\n      description: info.description,\r\n      memberOnly: info.memberOnly,\r\n    }))\r\n}\r\n\r\n/**\r\n * ==============================================\r\n * SIMPLIFIED KYC DOCUMENT TYPES\r\n * ==============================================\r\n *\r\n * INDIVIDUAL INVESTOR: ID + Proof of Address\r\n * ENTITY INVESTOR: Company docs + ID/Address for each director/UBO\r\n */\r\n\r\n/**\r\n * Documents for INDIVIDUAL investors - ID + Proof of Address\r\n */\r\nexport const INDIVIDUAL_REQUIRED_DOCS = [\r\n  { value: 'passport', label: 'Passport', description: 'Valid passport (photo page)' },\r\n  { value: 'utility_bill', label: 'Utility Bill / Proof of Address', description: 'Recent utility bill or bank statement (less than 3 months)' },\r\n] as const\r\n\r\n/**\r\n * Documents for ENTITY-LEVEL (the company itself)\r\n * NO NDA - that's handled separately in deal flow\r\n */\r\nexport const ENTITY_REQUIRED_DOCS = [\r\n  { value: 'incorporation_certificate', label: 'Incorporation Certificate', description: 'Certificate of Incorporation' },\r\n  { value: 'memo_articles', label: 'Memo & Articles', description: 'Memorandum and Articles of Association' },\r\n  { value: 'register_directors', label: 'Register of Directors', description: 'Current list of all directors' },\r\n  { value: 'register_members', label: 'Register of Members/Shareholders', description: 'Current list of shareholders' },\r\n  { value: 'register_beneficial_owners', label: 'Register of UBOs', description: 'List of beneficial owners (>25%)' },\r\n  { value: 'bank_confirmation', label: 'Bank Confirmation Letter', description: 'Bank details for wire transfers' },\r\n] as const\r\n\r\n/**\r\n * Documents for MEMBERS (Directors, UBOs) - personal ID docs\r\n */\r\nexport const MEMBER_REQUIRED_DOCS = [\r\n  { value: 'passport', label: 'Passport / ID', description: 'Valid passport or government ID' },\r\n  { value: 'utility_bill', label: 'Proof of Address', description: 'Utility bill or bank statement (less than 3 months)' },\r\n] as const\r\n\r\n/**\r\n * Get document types for INDIVIDUAL investors\r\n */\r\nexport function getIndividualDocumentTypes() {\r\n  return [...INDIVIDUAL_REQUIRED_DOCS]\r\n}\r\n\r\n/**\r\n * Get document types for ENTITY-level uploads\r\n */\r\nexport function getEntityDocumentTypes() {\r\n  return [...ENTITY_REQUIRED_DOCS]\r\n}\r\n\r\n/**\r\n * Get document types for MEMBER uploads (personal ID for directors/UBOs)\r\n */\r\nexport function getMemberDocumentTypes() {\r\n  return [...MEMBER_REQUIRED_DOCS]\r\n}\r\n\r\n/**\r\n * Check if a document type is a predefined type\r\n */\r\nexport function isPredefinedDocumentType(documentType: string): boolean {\r\n  return documentType in SUGGESTED_KYC_DOCUMENT_TYPES\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2855, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28staff%29/versotech/staff/kyc-review/kyc-review-client.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect, useCallback } from 'react'\r\nimport { CheckCircle, XCircle, Clock, AlertCircle, FileText, Download, Eye, ChevronLeft, ChevronRight, ChevronsLeft, ChevronsRight, ExternalLink, User, ClipboardList, Calendar, MessageSquare } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from '@/components/ui/tooltip'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table'\r\nimport { toast } from 'sonner'\r\nimport { DocumentViewerFullscreen } from '@/components/documents/DocumentViewerFullscreen'\r\nimport { useDocumentViewer } from '@/hooks/useDocumentViewer'\r\nimport { QuestionnaireViewer } from '@/components/kyc/questionnaire-viewer'\r\nimport { getDocumentTypeLabel } from '@/constants/kyc-document-types'\r\nimport { formatFileSize } from '@/lib/utils'\r\n\r\ninterface KYCSubmission {\r\n  id: string\r\n  investor_id: string\r\n  counterparty_entity_id?: string | null\r\n  investor_member_id?: string | null\r\n  document_type: string\r\n  custom_label?: string | null\r\n  status: 'draft' | 'pending' | 'under_review' | 'approved' | 'rejected' | 'expired'\r\n  submitted_at: string\r\n  reviewed_at?: string\r\n  rejection_reason?: string\r\n  version?: number\r\n  previous_submission_id?: string | null\r\n  metadata?: any\r\n  investor?: {\r\n    id: string\r\n    legal_name: string\r\n    display_name: string\r\n    email: string\r\n    type: string\r\n    kyc_status: string\r\n  }\r\n  counterparty_entity?: {\r\n    id: string\r\n    legal_name: string\r\n    entity_type: string\r\n  } | null\r\n  investor_member?: {\r\n    id: string\r\n    full_name: string\r\n    role: string\r\n    role_title?: string\r\n  } | null\r\n  document?: {\r\n    id: string\r\n    name: string\r\n    file_key: string\r\n    file_size_bytes: number\r\n    mime_type: string\r\n  }\r\n  reviewer?: {\r\n    display_name: string\r\n    email: string\r\n  }\r\n}\r\n\r\ninterface Statistics {\r\n  total: number\r\n  draft: number\r\n  pending: number\r\n  under_review: number\r\n  approved: number\r\n  rejected: number\r\n  expired: number\r\n}\r\n\r\ninterface Pagination {\r\n  page: number\r\n  pageSize: number\r\n  totalCount: number\r\n  totalPages: number\r\n  hasNextPage: boolean\r\n  hasPrevPage: boolean\r\n}\r\n\r\nexport function KYCReviewClient() {\r\n  const [submissions, setSubmissions] = useState<KYCSubmission[]>([])\r\n  const [statistics, setStatistics] = useState<Statistics | null>(null)\r\n  const [pagination, setPagination] = useState<Pagination | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [statusFilter, setStatusFilter] = useState<string>('all')\r\n  const [documentTypeFilter, setDocumentTypeFilter] = useState<string>('all')\r\n  const [investorFilter, setInvestorFilter] = useState<string>('all')\r\n  const [searchQuery, setSearchQuery] = useState('')\r\n  const [page, setPage] = useState(1)\r\n  const [pageSize, setPageSize] = useState(25)\r\n\r\n  // Review dialog state\r\n  const [reviewDialogOpen, setReviewDialogOpen] = useState(false)\r\n  const [selectedSubmission, setSelectedSubmission] = useState<KYCSubmission | null>(null)\r\n  const [reviewAction, setReviewAction] = useState<'approve' | 'reject' | 'request_info'>('approve')\r\n  const [rejectionReason, setRejectionReason] = useState('')\r\n  const [reviewNotes, setReviewNotes] = useState('')\r\n  const [reviewing, setReviewing] = useState(false)\r\n\r\n  // Bulk selection state\r\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set())\r\n  const [bulkRejectOpen, setBulkRejectOpen] = useState(false)\r\n  const [bulkRejectionReason, setBulkRejectionReason] = useState('')\r\n\r\n  // Get reviewable submissions (pending or under_review)\r\n  const reviewableSubmissions = submissions.filter(s => ['pending', 'under_review'].includes(s.status))\r\n\r\n  const toggleSelect = (id: string) => {\r\n    setSelectedIds(prev => {\r\n      const next = new Set(prev)\r\n      if (next.has(id)) {\r\n        next.delete(id)\r\n      } else {\r\n        next.add(id)\r\n      }\r\n      return next\r\n    })\r\n  }\r\n\r\n  const selectAllReviewable = () => {\r\n    const ids = reviewableSubmissions.map(s => s.id)\r\n    setSelectedIds(new Set(ids))\r\n  }\r\n\r\n  const clearSelection = () => setSelectedIds(new Set())\r\n\r\n  const handleBulkAction = async (action: 'approve' | 'reject', reason?: string) => {\r\n    if (selectedIds.size === 0) return\r\n\r\n    setReviewing(true)\r\n    try {\r\n      const promises = Array.from(selectedIds).map(id =>\r\n        fetch(`/api/staff/kyc-submissions/${id}/review`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            action,\r\n            rejection_reason: action === 'reject' ? reason : undefined\r\n          })\r\n        })\r\n      )\r\n\r\n      const results = await Promise.all(promises)\r\n      const successCount = results.filter(r => r.ok).length\r\n\r\n      toast.success(`${successCount} document${successCount !== 1 ? 's' : ''} ${action === 'approve' ? 'approved' : 'rejected'}`)\r\n\r\n      clearSelection()\r\n      setBulkRejectOpen(false)\r\n      setBulkRejectionReason('')\r\n      await loadSubmissions()\r\n    } catch (error: any) {\r\n      console.error('Bulk action error:', error)\r\n      toast.error('Failed to process some documents')\r\n    } finally {\r\n      setReviewing(false)\r\n    }\r\n  }\r\n\r\n  // Document viewer hook (fullscreen)\r\n  const {\r\n    isOpen: previewOpen,\r\n    document: previewDocument,\r\n    previewUrl,\r\n    isLoading: isLoadingPreview,\r\n    error: previewError,\r\n    openPreview,\r\n    closePreview,\r\n    downloadDocument: downloadFromPreview\r\n  } = useDocumentViewer()\r\n\r\n  // Questionnaire viewer state\r\n  const [viewingQuestionnaire, setViewingQuestionnaire] = useState<KYCSubmission | null>(null)\r\n\r\n  // Handle document preview\r\n  const handlePreview = (submission: KYCSubmission) => {\r\n    if (!submission.document) return\r\n\r\n    // Open fullscreen preview\r\n    openPreview({\r\n      id: submission.document.id,\r\n      file_name: submission.document.name,\r\n      name: submission.document.name,\r\n      mime_type: submission.document.mime_type,\r\n      file_size_bytes: submission.document.file_size_bytes,\r\n    })\r\n  }\r\n\r\n  const loadSubmissions = useCallback(async () => {\r\n    try {\r\n      const params = new URLSearchParams()\r\n      if (statusFilter !== 'all') params.append('status', statusFilter)\r\n      if (documentTypeFilter !== 'all') params.append('document_type', documentTypeFilter)\r\n      if (investorFilter !== 'all') params.append('investor_id', investorFilter)\r\n      params.append('page', String(page))\r\n      params.append('pageSize', String(pageSize))\r\n\r\n      const response = await fetch(`/api/staff/kyc-submissions?${params.toString()}`)\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json()\r\n        console.error('API error response:', errorData)\r\n        throw new Error(errorData.error || 'Failed to load submissions')\r\n      }\r\n\r\n      const data = await response.json()\r\n      setSubmissions(data.submissions || [])\r\n      setStatistics(data.statistics || null)\r\n      setPagination(data.pagination || null)\r\n    } catch (error: any) {\r\n      console.error('Error loading submissions:', error)\r\n      toast.error('Failed to load KYC submissions', {\r\n        description: error.message\r\n      })\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, [statusFilter, documentTypeFilter, investorFilter, page, pageSize])\r\n\r\n  // Reset to page 1 when filters change\r\n  useEffect(() => {\r\n    setPage(1)\r\n  }, [statusFilter, documentTypeFilter, investorFilter])\r\n\r\n  useEffect(() => {\r\n    loadSubmissions()\r\n  }, [loadSubmissions])\r\n\r\n  const openReviewDialog = (submission: KYCSubmission, action: 'approve' | 'reject' | 'request_info') => {\r\n    setSelectedSubmission(submission)\r\n    setReviewAction(action)\r\n    setRejectionReason('')\r\n    setReviewNotes('')\r\n    setReviewDialogOpen(true)\r\n  }\r\n\r\n  const handleReview = async () => {\r\n    if (!selectedSubmission) return\r\n\r\n    if ((reviewAction === 'reject' || reviewAction === 'request_info') && !rejectionReason.trim()) {\r\n      toast.error(reviewAction === 'request_info'\r\n        ? 'Please specify what additional information is needed'\r\n        : 'Please provide a rejection reason')\r\n      return\r\n    }\r\n\r\n    setReviewing(true)\r\n\r\n    try {\r\n      const response = await fetch(`/api/staff/kyc-submissions/${selectedSubmission.id}/review`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          action: reviewAction,\r\n          rejection_reason: (reviewAction === 'reject' || reviewAction === 'request_info') ? rejectionReason : undefined,\r\n          notes: reviewNotes || undefined\r\n        })\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const error = await response.json()\r\n        throw new Error(error.error || 'Review failed')\r\n      }\r\n\r\n      const successMessages = {\r\n        approve: 'Document approved successfully',\r\n        reject: 'Document rejected successfully',\r\n        request_info: 'Information request sent to investor'\r\n      }\r\n      toast.success(successMessages[reviewAction])\r\n\r\n      setReviewDialogOpen(false)\r\n      await loadSubmissions()\r\n    } catch (error: any) {\r\n      console.error('Review error:', error)\r\n      toast.error(error.message || 'Failed to review document')\r\n    } finally {\r\n      setReviewing(false)\r\n    }\r\n  }\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status) {\r\n      case 'approved':\r\n        return <Badge className=\"bg-green-500\"><CheckCircle className=\"w-3 h-3 mr-1\" />Approved</Badge>\r\n      case 'rejected':\r\n        return <Badge variant=\"destructive\"><XCircle className=\"w-3 h-3 mr-1\" />Rejected</Badge>\r\n      case 'under_review':\r\n        return <Badge variant=\"secondary\"><Clock className=\"w-3 h-3 mr-1\" />Under Review</Badge>\r\n      case 'pending':\r\n        return <Badge className=\"bg-amber-500\"><Clock className=\"w-3 h-3 mr-1\" />Pending</Badge>\r\n      case 'draft':\r\n        return <Badge variant=\"outline\" className=\"border-slate-400 text-slate-400\"><Clock className=\"w-3 h-3 mr-1\" />Draft</Badge>\r\n      case 'expired':\r\n        return <Badge variant=\"outline\"><AlertCircle className=\"w-3 h-3 mr-1\" />Expired</Badge>\r\n      default:\r\n        return null\r\n    }\r\n  }\r\n\r\n  // Get unique document types from submissions\r\n  const uniqueDocumentTypes = Array.from(\r\n    new Set(submissions.map(sub => sub.document_type))\r\n  ).sort()\r\n\r\n  // Get unique investors from submissions\r\n  const uniqueInvestors = Array.from(\r\n    new Map(\r\n      submissions\r\n        .filter(sub => sub.investor)\r\n        .map(sub => [sub.investor!.id, sub.investor!])\r\n    ).values()\r\n  ).sort((a, b) => (a.display_name || a.legal_name).localeCompare(b.display_name || b.legal_name))\r\n\r\n  const filteredSubmissions = submissions.filter(sub => {\r\n    if (searchQuery) {\r\n      const query = searchQuery.toLowerCase()\r\n      const documentTypeLabel = getDocumentTypeLabel(sub.document_type, sub.custom_label).toLowerCase()\r\n      return (\r\n        sub.investor?.display_name.toLowerCase().includes(query) ||\r\n        sub.investor?.legal_name.toLowerCase().includes(query) ||\r\n        sub.investor?.email.toLowerCase().includes(query) ||\r\n        documentTypeLabel.includes(query) ||\r\n        (sub.counterparty_entity?.legal_name.toLowerCase().includes(query))\r\n      )\r\n    }\r\n    return true\r\n  })\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">KYC Document Review</h1>\r\n        <p className=\"text-muted-foreground mt-1\">\r\n          Review and approve investor KYC documents\r\n        </p>\r\n      </div>\r\n\r\n      {/* Statistics Cards */}\r\n      {statistics && (\r\n        <div className=\"grid gap-4 md:grid-cols-4 lg:grid-cols-7\">\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">Total</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-foreground\">{statistics.total}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">Draft</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-slate-500\">{statistics.draft}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">Pending</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-amber-500\">{statistics.pending}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">Under Review</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-blue-400\">{statistics.under_review}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">Approved</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-emerald-500\">{statistics.approved}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">Rejected</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-rose-500\">{statistics.rejected}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">Expired</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-slate-400\">{statistics.expired}</div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      )}\r\n\r\n      {/* Filters */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Filters</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n            <div>\r\n              <Label htmlFor=\"status-filter\">Status</Label>\r\n              <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                <SelectTrigger id=\"status-filter\">\r\n                  <SelectValue placeholder=\"All statuses\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">All Statuses</SelectItem>\r\n                  <SelectItem value=\"draft\">Draft</SelectItem>\r\n                  <SelectItem value=\"pending\">Pending</SelectItem>\r\n                  <SelectItem value=\"under_review\">Under Review</SelectItem>\r\n                  <SelectItem value=\"approved\">Approved</SelectItem>\r\n                  <SelectItem value=\"rejected\">Rejected</SelectItem>\r\n                  <SelectItem value=\"expired\">Expired</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n            <div>\r\n              <Label htmlFor=\"type-filter\">Document Type</Label>\r\n              <Select value={documentTypeFilter} onValueChange={setDocumentTypeFilter}>\r\n                <SelectTrigger id=\"type-filter\">\r\n                  <SelectValue placeholder=\"All types\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">All Types</SelectItem>\r\n                  {uniqueDocumentTypes.map(type => (\r\n                    <SelectItem key={type} value={type}>\r\n                      {getDocumentTypeLabel(type)}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n            <div>\r\n              <Label htmlFor=\"investor-filter\">Investor</Label>\r\n              <Select value={investorFilter} onValueChange={setInvestorFilter}>\r\n                <SelectTrigger id=\"investor-filter\">\r\n                  <SelectValue placeholder=\"All investors\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">All Investors</SelectItem>\r\n                  {uniqueInvestors.map(investor => (\r\n                    <SelectItem key={investor.id} value={investor.id}>\r\n                      {investor.display_name || investor.legal_name}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n            <div>\r\n              <Label htmlFor=\"search\">Search</Label>\r\n              <Input\r\n                id=\"search\"\r\n                placeholder=\"Search investor name or email...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n              />\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Submissions Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Submissions ({filteredSubmissions.length})</CardTitle>\r\n          <CardDescription>\r\n            Review pending KYC documents and approve or reject them\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead className=\"w-10\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedIds.size > 0 && selectedIds.size === reviewableSubmissions.length}\r\n                    onChange={(e) => e.target.checked ? selectAllReviewable() : clearSelection()}\r\n                    className=\"h-4 w-4 rounded border-gray-300\"\r\n                  />\r\n                </TableHead>\r\n                <TableHead>Investor</TableHead>\r\n                <TableHead>Document Type</TableHead>\r\n                <TableHead>Content</TableHead>\r\n                <TableHead>Submitted</TableHead>\r\n                <TableHead>Status</TableHead>\r\n                <TableHead>Reviewer</TableHead>\r\n                <TableHead className=\"text-right\">Actions</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {filteredSubmissions.length === 0 ? (\r\n                <TableRow>\r\n                  <TableCell colSpan={8} className=\"text-center text-muted-foreground py-8\">\r\n                    No submissions found\r\n                  </TableCell>\r\n                </TableRow>\r\n              ) : (\r\n                filteredSubmissions.map((submission) => (\r\n                  <TableRow key={submission.id}>\r\n                    <TableCell>\r\n                      {['pending', 'under_review'].includes(submission.status) && (\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedIds.has(submission.id)}\r\n                          onChange={() => toggleSelect(submission.id)}\r\n                          className=\"h-4 w-4 rounded border-gray-300\"\r\n                        />\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div>\r\n                        <div className=\"font-medium flex items-center gap-1\">\r\n                          {submission.counterparty_entity ? (\r\n                            <>\r\n                              {submission.counterparty_entity.legal_name}\r\n                              <Badge variant=\"outline\" className=\"ml-2 text-xs\">Entity</Badge>\r\n                            </>\r\n                          ) : (\r\n                            <>\r\n                              {submission.investor?.display_name || submission.investor?.legal_name || 'Unknown'}\r\n                              {submission.investor?.id && (\r\n                                <a\r\n                                  href={`/versotech/staff/investors/${submission.investor.id}`}\r\n                                  target=\"_blank\"\r\n                                  rel=\"noopener noreferrer\"\r\n                                  className=\"ml-1 text-muted-foreground hover:text-foreground transition-colors\"\r\n                                  title=\"View investor profile\"\r\n                                >\r\n                                  <ExternalLink className=\"w-3 h-3\" />\r\n                                </a>\r\n                              )}\r\n                            </>\r\n                          )}\r\n                        </div>\r\n                        <div className=\"text-sm text-muted-foreground flex items-center gap-1 flex-wrap\">\r\n                          {submission.investor?.email || ''}\r\n                          {submission.investor?.type && ['entity', 'corporate', 'institution'].includes(submission.investor.type) && (\r\n                            <Badge variant=\"secondary\" className=\"text-xs\">{submission.investor.type}</Badge>\r\n                          )}\r\n                          {submission.investor?.kyc_status && (\r\n                            <Badge\r\n                              variant=\"outline\"\r\n                              className={`text-xs ${\r\n                                submission.investor.kyc_status === 'approved'\r\n                                  ? 'border-emerald-500 text-emerald-500'\r\n                                  : submission.investor.kyc_status === 'pending'\r\n                                    ? 'border-amber-500 text-amber-500'\r\n                                    : submission.investor.kyc_status === 'rejected'\r\n                                      ? 'border-rose-500 text-rose-500'\r\n                                      : 'border-muted-foreground text-muted-foreground'\r\n                              }`}\r\n                            >\r\n                              KYC: {submission.investor.kyc_status}\r\n                            </Badge>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div>\r\n                        <div className=\"font-medium\">\r\n                          {getDocumentTypeLabel(submission.document_type, submission.custom_label)}\r\n                        </div>\r\n                        {submission.investor_member && (\r\n                          <div className=\"text-xs text-muted-foreground mt-0.5\">\r\n                            <Badge variant=\"outline\" className=\"text-xs font-normal\">\r\n                              {submission.investor_member.full_name}\r\n                              {submission.investor_member.role_title && ` (${submission.investor_member.role_title})`}\r\n                            </Badge>\r\n                          </div>\r\n                        )}\r\n                        {submission.version && submission.version > 1 && (\r\n                          <div className=\"text-xs text-amber-500 mt-0.5\">\r\n                            v{submission.version}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {submission.document ? (\r\n                        <div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <FileText className=\"w-4 h-4 text-muted-foreground flex-shrink-0\" />\r\n                            <span className=\"text-sm truncate max-w-[200px]\">{submission.document.name}</span>\r\n                          </div>\r\n                          <div className=\"text-xs text-muted-foreground ml-6\">\r\n                            {formatFileSize(submission.document.file_size_bytes)}\r\n                          </div>\r\n                        </div>\r\n                      ) : submission.metadata && submission.document_type === 'questionnaire' ? (\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <ClipboardList className=\"w-4 h-4 text-blue-500\" />\r\n                          <span className=\"text-sm text-blue-500 font-medium\">Questionnaire Responses</span>\r\n                        </div>\r\n                      ) : (\r\n                        <span className=\"text-sm text-muted-foreground\">No content</span>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"text-sm\">\r\n                        {new Date(submission.submitted_at).toLocaleDateString()}\r\n                      </div>\r\n                      <div className=\"text-xs text-muted-foreground\">\r\n                        {new Date(submission.submitted_at).toLocaleTimeString()}\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div>\r\n                        {getStatusBadge(submission.status)}\r\n                        {submission.status === 'rejected' && submission.rejection_reason && (\r\n                          <TooltipProvider>\r\n                            <Tooltip>\r\n                              <TooltipTrigger asChild>\r\n                                <div className=\"text-xs text-rose-400 mt-1 max-w-[200px] truncate cursor-help\">\r\n                                  {submission.rejection_reason}\r\n                                </div>\r\n                              </TooltipTrigger>\r\n                              <TooltipContent className=\"max-w-[300px]\">\r\n                                <p className=\"text-sm\">{submission.rejection_reason}</p>\r\n                              </TooltipContent>\r\n                            </Tooltip>\r\n                          </TooltipProvider>\r\n                        )}\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {submission.reviewer ? (\r\n                        <div className=\"text-sm\">\r\n                          <div>{submission.reviewer.display_name}</div>\r\n                          <div className=\"text-xs text-muted-foreground\">\r\n                            {new Date(submission.reviewed_at!).toLocaleDateString()}\r\n                          </div>\r\n                        </div>\r\n                      ) : (\r\n                        <span className=\"text-sm text-muted-foreground\">-</span>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right\">\r\n                      <div className=\"flex items-center justify-end gap-2\">\r\n                        {submission.document && (\r\n                          <TooltipProvider>\r\n                            <Tooltip>\r\n                              <TooltipTrigger asChild>\r\n                                <Button\r\n                                  variant=\"ghost\"\r\n                                  size=\"sm\"\r\n                                  onClick={() => handlePreview(submission)}\r\n                                >\r\n                                  <FileText className=\"w-4 h-4\" />\r\n                                </Button>\r\n                              </TooltipTrigger>\r\n                              <TooltipContent>\r\n                                <p>View Document</p>\r\n                              </TooltipContent>\r\n                            </Tooltip>\r\n                          </TooltipProvider>\r\n                        )}\r\n                        {submission.metadata && submission.document_type === 'questionnaire' && (\r\n                          <TooltipProvider>\r\n                            <Tooltip>\r\n                              <TooltipTrigger asChild>\r\n                                <Button\r\n                                  variant=\"ghost\"\r\n                                  size=\"sm\"\r\n                                  onClick={() => setViewingQuestionnaire(submission)}\r\n                                >\r\n                                  <ClipboardList className=\"w-4 h-4\" />\r\n                                </Button>\r\n                              </TooltipTrigger>\r\n                              <TooltipContent>\r\n                                <p>View Questionnaire Answers</p>\r\n                              </TooltipContent>\r\n                            </Tooltip>\r\n                          </TooltipProvider>\r\n                        )}\r\n                        {['pending', 'under_review'].includes(submission.status) && (\r\n                          <>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              className=\"text-emerald-500 border-emerald-500 hover:bg-emerald-950 hover:text-emerald-400\"\r\n                              onClick={() => openReviewDialog(submission, 'approve')}\r\n                            >\r\n                              <CheckCircle className=\"w-4 h-4 mr-1\" />\r\n                              Approve\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              className=\"text-amber-500 border-amber-500 hover:bg-amber-950 hover:text-amber-400\"\r\n                              onClick={() => openReviewDialog(submission, 'request_info')}\r\n                            >\r\n                              <MessageSquare className=\"w-4 h-4 mr-1\" />\r\n                              Request Info\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              className=\"text-rose-500 border-rose-500 hover:bg-rose-950 hover:text-rose-400\"\r\n                              onClick={() => openReviewDialog(submission, 'reject')}\r\n                            >\r\n                              <XCircle className=\"w-4 h-4 mr-1\" />\r\n                              Reject\r\n                            </Button>\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n\r\n          {/* Pagination Controls */}\r\n          {pagination && pagination.totalPages > 1 && (\r\n            <div className=\"flex items-center justify-between px-2 py-4 border-t\">\r\n              <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                <span>\r\n                  Showing {((pagination.page - 1) * pagination.pageSize) + 1} to{' '}\r\n                  {Math.min(pagination.page * pagination.pageSize, pagination.totalCount)} of{' '}\r\n                  {pagination.totalCount} submissions\r\n                </span>\r\n                <Select\r\n                  value={String(pageSize)}\r\n                  onValueChange={(value) => {\r\n                    setPageSize(Number(value))\r\n                    setPage(1)\r\n                  }}\r\n                >\r\n                  <SelectTrigger className=\"h-8 w-[70px]\">\r\n                    <SelectValue placeholder={pageSize} />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"10\">10</SelectItem>\r\n                    <SelectItem value=\"25\">25</SelectItem>\r\n                    <SelectItem value=\"50\">50</SelectItem>\r\n                    <SelectItem value=\"100\">100</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n                <span>per page</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-1\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"icon\"\r\n                  className=\"h-8 w-8\"\r\n                  onClick={() => setPage(1)}\r\n                  disabled={!pagination.hasPrevPage}\r\n                >\r\n                  <ChevronsLeft className=\"h-4 w-4\" />\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"icon\"\r\n                  className=\"h-8 w-8\"\r\n                  onClick={() => setPage(page - 1)}\r\n                  disabled={!pagination.hasPrevPage}\r\n                >\r\n                  <ChevronLeft className=\"h-4 w-4\" />\r\n                </Button>\r\n                <span className=\"flex items-center gap-1 px-2 text-sm\">\r\n                  Page {pagination.page} of {pagination.totalPages}\r\n                </span>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"icon\"\r\n                  className=\"h-8 w-8\"\r\n                  onClick={() => setPage(page + 1)}\r\n                  disabled={!pagination.hasNextPage}\r\n                >\r\n                  <ChevronRight className=\"h-4 w-4\" />\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"icon\"\r\n                  className=\"h-8 w-8\"\r\n                  onClick={() => setPage(pagination.totalPages)}\r\n                  disabled={!pagination.hasNextPage}\r\n                >\r\n                  <ChevronsRight className=\"h-4 w-4\" />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Review Dialog */}\r\n      <Dialog open={reviewDialogOpen} onOpenChange={setReviewDialogOpen}>\r\n        <DialogContent className=\"max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {reviewAction === 'approve' && 'Approve Document'}\r\n              {reviewAction === 'reject' && 'Reject Document'}\r\n              {reviewAction === 'request_info' && 'Request Additional Information'}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {selectedSubmission && (\r\n                <>\r\n                  {getDocumentTypeLabel(selectedSubmission.document_type, selectedSubmission.custom_label)} for{' '}\r\n                  {selectedSubmission.counterparty_entity\r\n                    ? `${selectedSubmission.counterparty_entity.legal_name} (Entity of ${selectedSubmission.investor?.display_name || selectedSubmission.investor?.legal_name || 'Unknown'})`\r\n                    : selectedSubmission.investor?.display_name || selectedSubmission.investor?.legal_name || 'Unknown'\r\n                  }\r\n                </>\r\n              )}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4 py-4\">\r\n            {(reviewAction === 'reject' || reviewAction === 'request_info') && (\r\n              <div>\r\n                <Label htmlFor=\"rejection-reason\">\r\n                  {reviewAction === 'request_info'\r\n                    ? 'What information is needed?'\r\n                    : 'Rejection Reason'\r\n                  } <span className=\"text-red-500\">*</span>\r\n                </Label>\r\n                <Textarea\r\n                  id=\"rejection-reason\"\r\n                  placeholder={reviewAction === 'request_info'\r\n                    ? 'Please specify what additional information or documents the investor needs to provide...'\r\n                    : 'Please explain why this document is being rejected...'\r\n                  }\r\n                  value={rejectionReason}\r\n                  onChange={(e) => setRejectionReason(e.target.value)}\r\n                  rows={4}\r\n                  className=\"mt-1\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            <div>\r\n              <Label htmlFor=\"review-notes\">Notes (Optional)</Label>\r\n              <Textarea\r\n                id=\"review-notes\"\r\n                placeholder=\"Any additional notes...\"\r\n                value={reviewNotes}\r\n                onChange={(e) => setReviewNotes(e.target.value)}\r\n                rows={3}\r\n                className=\"mt-1\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setReviewDialogOpen(false)}\r\n              disabled={reviewing}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleReview}\r\n              disabled={reviewing}\r\n              className={\r\n                reviewAction === 'approve'\r\n                  ? 'bg-emerald-600 hover:bg-emerald-700'\r\n                  : reviewAction === 'request_info'\r\n                    ? 'bg-amber-600 hover:bg-amber-700'\r\n                    : ''\r\n              }\r\n            >\r\n              {reviewing\r\n                ? 'Processing...'\r\n                : reviewAction === 'approve'\r\n                  ? 'Approve'\r\n                  : reviewAction === 'request_info'\r\n                    ? 'Send Request'\r\n                    : 'Reject'\r\n              }\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Fullscreen Document Viewer */}\r\n      <DocumentViewerFullscreen\r\n        isOpen={previewOpen}\r\n        document={previewDocument}\r\n        previewUrl={previewUrl}\r\n        isLoading={isLoadingPreview}\r\n        error={previewError}\r\n        onClose={closePreview}\r\n        onDownload={downloadFromPreview}\r\n      />\r\n\r\n      {/* Questionnaire Viewer */}\r\n      {viewingQuestionnaire && (\r\n        <QuestionnaireViewer\r\n          open={!!viewingQuestionnaire}\r\n          onClose={() => setViewingQuestionnaire(null)}\r\n          investorName={viewingQuestionnaire.investor?.display_name || viewingQuestionnaire.investor?.legal_name || 'Unknown'}\r\n          submittedAt={viewingQuestionnaire.submitted_at}\r\n          metadata={viewingQuestionnaire.metadata || {}}\r\n        />\r\n      )}\r\n\r\n      {/* Bulk Action Bar */}\r\n      {selectedIds.size > 0 && (\r\n        <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 bg-background border border-border rounded-lg shadow-lg p-4 flex items-center gap-4 z-50\">\r\n          <span className=\"text-sm text-muted-foreground font-medium\">\r\n            {selectedIds.size} selected\r\n          </span>\r\n          <Button\r\n            size=\"sm\"\r\n            className=\"bg-emerald-600 hover:bg-emerald-700\"\r\n            onClick={() => handleBulkAction('approve')}\r\n            disabled={reviewing}\r\n          >\r\n            <CheckCircle className=\"h-4 w-4 mr-1\" />\r\n            Approve All\r\n          </Button>\r\n          <Button\r\n            size=\"sm\"\r\n            variant=\"destructive\"\r\n            onClick={() => setBulkRejectOpen(true)}\r\n            disabled={reviewing}\r\n          >\r\n            <XCircle className=\"h-4 w-4 mr-1\" />\r\n            Reject All\r\n          </Button>\r\n          <Button\r\n            size=\"sm\"\r\n            variant=\"ghost\"\r\n            onClick={clearSelection}\r\n            disabled={reviewing}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Bulk Reject Dialog */}\r\n      <Dialog open={bulkRejectOpen} onOpenChange={setBulkRejectOpen}>\r\n        <DialogContent className=\"max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>Reject {selectedIds.size} Documents</DialogTitle>\r\n            <DialogDescription>\r\n              This will reject all selected documents with the same reason.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"py-4\">\r\n            <Label htmlFor=\"bulk-rejection-reason\">\r\n              Rejection Reason <span className=\"text-red-500\">*</span>\r\n            </Label>\r\n            <Textarea\r\n              id=\"bulk-rejection-reason\"\r\n              placeholder=\"Please explain why these documents are being rejected...\"\r\n              value={bulkRejectionReason}\r\n              onChange={(e) => setBulkRejectionReason(e.target.value)}\r\n              rows={4}\r\n              className=\"mt-1\"\r\n            />\r\n          </div>\r\n          <DialogFooter>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setBulkRejectOpen(false)}\r\n              disabled={reviewing}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              variant=\"destructive\"\r\n              onClick={() => handleBulkAction('reject', bulkRejectionReason)}\r\n              disabled={reviewing || !bulkRejectionReason.trim()}\r\n            >\r\n              {reviewing ? 'Processing...' : 'Reject All'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}