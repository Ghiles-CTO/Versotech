{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\nimport { createClient as createSupabaseClient } from '@supabase/supabase-js'\nimport { cookies } from 'next/headers'\n\nexport const createClient = async () => {\n  const cookieStore = await cookies()\n\n  return createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll()\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) => {\n              cookieStore.set(name, value, options)\n            })\n          } catch (error) {\n            // The `setAll` method was called from a Server Component.\n            // This can be ignored if you have middleware refreshing\n            // user sessions.\n          }\n        },\n      },\n    }\n  )\n}\n\n// Server client with service role for admin operations\n// Uses raw supabase-js client which properly bypasses RLS with service role\nexport const createServiceClient = () => {\n  return createSupabaseClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\n    {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false,\n      },\n    }\n  )\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AACA;;;;AAEO,MAAM,eAAe;IAC1B,MAAM,cAAc,MAAM,IAAA,mKAAO;IAEjC,OAAO,IAAA,wNAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE;wBAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;oBAC/B;gBACF,EAAE,OAAO,OAAO;gBACd,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ;AAIO,MAAM,sBAAsB;IACjC,OAAO,IAAA,gOAAoB,gFAEzB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AAEJ"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/api/partners/me/dashboard/route.ts"],"sourcesContent":["import { createClient, createServiceClient } from '@/lib/supabase/server'\nimport { NextResponse } from 'next/server'\n\ntype ReferralRow = {\n  deal_id: string | null\n  investor_id: string | null\n  role: string | null\n  dispatched_at: string | null\n  interest_confirmed_at: string | null\n  deal: { id: string; name: string; status: string } | { id: string; name: string; status: string }[] | null\n  investor: { id: string; legal_name: string | null; display_name: string | null } | { id: string; legal_name: string | null; display_name: string | null }[] | null\n}\n\nfunction normalizeJoin<T>(value: T | T[] | null): T | null {\n  if (!value) return null\n  return Array.isArray(value) ? value[0] || null : value\n}\n\n/**\n * GET /api/partners/me/dashboard\n * Returns partner dashboard metrics and recent referral activity.\n */\nexport async function GET() {\n  const supabase = await createClient()\n  const serviceSupabase = createServiceClient()\n\n  try {\n    const { data: { user }, error: userError } = await supabase.auth.getUser()\n    if (userError || !user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    const { data: partnerUser, error: partnerUserError } = await serviceSupabase\n      .from('partner_users')\n      .select('partner_id')\n      .eq('user_id', user.id)\n      .maybeSingle()\n\n    if (partnerUserError) {\n      console.error('[partner-dashboard] Partner lookup error:', partnerUserError)\n      return NextResponse.json({ error: 'Failed to load partner profile' }, { status: 500 })\n    }\n\n    if (!partnerUser?.partner_id) {\n      return NextResponse.json({ error: 'Partner profile not found' }, { status: 404 })\n    }\n\n    const partnerId = partnerUser.partner_id\n\n    const { data: ownMemberships, error: ownMembershipsError } = await serviceSupabase\n      .from('deal_memberships')\n      .select('deal_id, role, dispatched_at')\n      .eq('user_id', user.id)\n      .not('dispatched_at', 'is', null)\n\n    if (ownMembershipsError) {\n      console.error('[partner-dashboard] Membership lookup error:', ownMembershipsError)\n      return NextResponse.json({ error: 'Failed to load deal memberships' }, { status: 500 })\n    }\n\n    const trackedDeals = (ownMemberships || []).filter(m => m.role === 'partner').length\n    const investableDeals = (ownMemberships || []).filter(m => m.role === 'partner_investor').length\n    const ownDealIds = Array.from(new Set((ownMemberships || []).map(m => m.deal_id).filter(Boolean)))\n\n    const { data: referralMemberships, error: referralError } = await serviceSupabase\n      .from('deal_memberships')\n      .select(`\n        deal_id,\n        investor_id,\n        role,\n        dispatched_at,\n        interest_confirmed_at,\n        deal:deal_id (\n          id,\n          name,\n          status\n        ),\n        investor:investor_id (\n          id,\n          legal_name,\n          display_name\n        )\n      `)\n      .eq('referred_by_entity_type', 'partner')\n      .eq('referred_by_entity_id', partnerId)\n      .order('dispatched_at', { ascending: false })\n\n    if (referralError) {\n      console.error('[partner-dashboard] Referral lookup error:', referralError)\n      return NextResponse.json({ error: 'Failed to load referrals' }, { status: 500 })\n    }\n\n    const referrals = (referralMemberships || []) as ReferralRow[]\n    const referralPairs = referrals\n      .filter(r => r.investor_id && r.deal_id)\n      .map(r => `${r.investor_id}:${r.deal_id}`)\n    const referralPairSet = new Set(referralPairs)\n\n    const investorIds = Array.from(new Set(referrals.map(r => r.investor_id).filter(Boolean)))\n    const referralDealIds = Array.from(new Set(referrals.map(r => r.deal_id).filter(Boolean)))\n\n    let matchedSubscriptions: {\n      investor_id: string\n      deal_id: string\n      commitment: number | null\n      status: string | null\n      signed_at: string | null\n      currency: string | null\n    }[] = []\n\n    if (investorIds.length > 0 && referralDealIds.length > 0) {\n      const { data: subs, error: subsError } = await serviceSupabase\n        .from('subscriptions')\n        .select('investor_id, deal_id, commitment, status, signed_at, currency')\n        .in('investor_id', investorIds)\n        .in('deal_id', referralDealIds)\n\n      if (subsError) {\n        console.error('[partner-dashboard] Subscription lookup error:', subsError)\n        return NextResponse.json({ error: 'Failed to load subscription data' }, { status: 500 })\n      }\n\n      matchedSubscriptions = (subs || []).filter(\n        sub => referralPairSet.has(`${sub.investor_id}:${sub.deal_id}`)\n      )\n    }\n\n    const subscriptionMap = new Map(\n      matchedSubscriptions.map(sub => [`${sub.investor_id}:${sub.deal_id}`, sub])\n    )\n\n    const subscribedStatuses = new Set(['committed', 'active'])\n    const pendingStatuses = new Set(['pending'])\n\n    let totalCommitment = 0\n    let subscribedInvestors = 0\n    let pipelineInvestors = 0\n\n    for (const referral of referrals) {\n      if (!referral.investor_id || !referral.deal_id) continue\n      const subscription = subscriptionMap.get(`${referral.investor_id}:${referral.deal_id}`)\n      const status = subscription?.status || null\n\n      if (status && subscribedStatuses.has(status)) {\n        subscribedInvestors += 1\n        totalCommitment += Number(subscription?.commitment || 0)\n        continue\n      }\n\n      if ((status && pendingStatuses.has(status)) || (!status && referral.interest_confirmed_at)) {\n        pipelineInvestors += 1\n      }\n    }\n\n    const commitmentCurrency = matchedSubscriptions.find(sub => sub.currency)?.currency || 'USD'\n\n    let pendingCommissions = 0\n    let pendingCommissionCurrency = 'USD'\n\n    let feePlanQuery = serviceSupabase\n      .from('fee_plans')\n      .select('id')\n\n    const feePlanDealIds = Array.from(new Set([...ownDealIds, ...referralDealIds]))\n\n    if (feePlanDealIds.length > 0) {\n      feePlanQuery = feePlanQuery.or(`partner_id.eq.${partnerId},deal_id.in.(${feePlanDealIds.join(',')})`)\n    } else {\n      feePlanQuery = feePlanQuery.eq('partner_id', partnerId)\n    }\n\n    const { data: feePlans, error: feePlansError } = await feePlanQuery\n\n    if (feePlansError) {\n      console.error('[partner-dashboard] Fee plan lookup error:', feePlansError)\n      return NextResponse.json({ error: 'Failed to load fee plans' }, { status: 500 })\n    }\n\n    const feePlanIds = (feePlans || []).map(plan => plan.id)\n\n    if (feePlanIds.length > 0) {\n      const { data: feeComponents, error: feeComponentsError } = await serviceSupabase\n        .from('fee_components')\n        .select('id, fee_plan_id')\n        .in('fee_plan_id', feePlanIds)\n\n      if (feeComponentsError) {\n        console.error('[partner-dashboard] Fee components lookup error:', feeComponentsError)\n        return NextResponse.json({ error: 'Failed to load fee components' }, { status: 500 })\n      }\n\n      const componentIds = (feeComponents || []).map(component => component.id)\n\n      if (componentIds.length > 0) {\n        const { data: feeEvents, error: feeEventsError } = await serviceSupabase\n          .from('fee_events')\n          .select('computed_amount, status, currency')\n          .in('fee_component_id', componentIds)\n          .in('status', ['accrued', 'invoiced'])\n\n        if (feeEventsError) {\n          console.error('[partner-dashboard] Fee events lookup error:', feeEventsError)\n          return NextResponse.json({ error: 'Failed to load fee events' }, { status: 500 })\n        }\n\n        pendingCommissions = (feeEvents || []).reduce(\n          (sum, event) => sum + Number(event.computed_amount || 0),\n          0\n        )\n        pendingCommissionCurrency = feeEvents?.[0]?.currency || pendingCommissionCurrency\n      }\n    }\n\n    const recentReferrals = referrals.slice(0, 10).map(referral => {\n      const deal = normalizeJoin(referral.deal)\n      const investor = normalizeJoin(referral.investor)\n      const subscription = referral.investor_id && referral.deal_id\n        ? subscriptionMap.get(`${referral.investor_id}:${referral.deal_id}`) || null\n        : null\n\n      return {\n        deal_id: referral.deal_id,\n        deal_name: deal?.name || null,\n        deal_status: deal?.status || null,\n        investor_id: referral.investor_id,\n        investor_name: investor?.display_name || investor?.legal_name || null,\n        dispatched_at: referral.dispatched_at,\n        interest_confirmed_at: referral.interest_confirmed_at,\n        subscription: subscription ? {\n          commitment: subscription.commitment,\n          status: subscription.status,\n          signed_at: subscription.signed_at\n        } : null\n      }\n    })\n\n    // Calculate performance metrics\n    const conversionRate = referrals.length > 0\n      ? Math.round((subscribedInvestors / referrals.length) * 100)\n      : 0\n\n    // Calculate this month vs last month comparison\n    const now = new Date()\n    const startOfThisMonth = new Date(now.getFullYear(), now.getMonth(), 1)\n    const startOfLastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1)\n\n    const thisMonthReferrals = referrals.filter(r =>\n      r.dispatched_at && new Date(r.dispatched_at) >= startOfThisMonth\n    ).length\n\n    const lastMonthReferrals = referrals.filter(r =>\n      r.dispatched_at &&\n      new Date(r.dispatched_at) >= startOfLastMonth &&\n      new Date(r.dispatched_at) < startOfThisMonth\n    ).length\n\n    const referralGrowth = lastMonthReferrals > 0\n      ? Math.round(((thisMonthReferrals - lastMonthReferrals) / lastMonthReferrals) * 100)\n      : thisMonthReferrals > 0 ? 100 : 0\n\n    // Calculate paid vs pending commissions\n    let paidCommissions = 0\n    if (feePlanIds.length > 0) {\n      const { data: paidEvents } = await serviceSupabase\n        .from('fee_events')\n        .select('computed_amount')\n        .in('fee_component_id', (await serviceSupabase\n          .from('fee_components')\n          .select('id')\n          .in('fee_plan_id', feePlanIds)\n        ).data?.map(c => c.id) || [])\n        .eq('status', 'paid')\n\n      paidCommissions = (paidEvents || []).reduce(\n        (sum, event) => sum + Number(event.computed_amount || 0), 0\n      )\n    }\n\n    // Average commitment per investor\n    const avgCommitmentPerInvestor = subscribedInvestors > 0\n      ? Math.round(totalCommitment / subscribedInvestors)\n      : 0\n\n    return NextResponse.json({\n      metrics: {\n        totalReferredInvestors: referrals.length,\n        subscribedInvestors,\n        pipelineInvestors,\n        totalCommitment,\n        commitmentCurrency,\n        pendingCommissions,\n        pendingCommissionCurrency,\n        trackedDeals,\n        investableDeals\n      },\n      performance: {\n        conversionRate,\n        thisMonthReferrals,\n        lastMonthReferrals,\n        referralGrowth,\n        paidCommissions,\n        avgCommitmentPerInvestor,\n        avgCommitmentCurrency: commitmentCurrency\n      },\n      recent_referrals: recentReferrals\n    })\n  } catch (error) {\n    console.error('Unexpected error in GET /api/partners/me/dashboard:', error)\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}