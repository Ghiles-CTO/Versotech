{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\nimport { createClient as createSupabaseClient } from '@supabase/supabase-js'\nimport { cookies } from 'next/headers'\n\nexport const createClient = async () => {\n  const cookieStore = await cookies()\n\n  return createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll()\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) => {\n              cookieStore.set(name, value, options)\n            })\n          } catch (error) {\n            // The `setAll` method was called from a Server Component.\n            // This can be ignored if you have middleware refreshing\n            // user sessions.\n          }\n        },\n      },\n    }\n  )\n}\n\n// Server client with service role for admin operations\n// Uses raw supabase-js client which properly bypasses RLS with service role\nexport const createServiceClient = () => {\n  return createSupabaseClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\n    {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false,\n      },\n    }\n  )\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AACA;;;;AAEO,MAAM,eAAe;IAC1B,MAAM,cAAc,MAAM,IAAA,mKAAO;IAEjC,OAAO,IAAA,wNAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE;wBAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;oBAC/B;gBACF,EAAE,OAAO,OAAO;gBACd,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ;AAIO,MAAM,sBAAsB;IACjC,OAAO,IAAA,gOAAoB,gFAEzB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AAEJ"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/api/vehicles/route.ts"],"sourcesContent":["import { createClient, createServiceClient } from '@/lib/supabase/server'\nimport { NextRequest, NextResponse } from 'next/server'\n\n/**\n * POST /api/vehicles\n * Creates a new vehicle with all associated fields including\n * arranger, lawyer, and managing partner assignments.\n */\nexport async function POST(request: NextRequest) {\n  try {\n    const supabase = await createClient()\n\n    // Check authentication\n    const { data: { user }, error: authError } = await supabase.auth.getUser()\n    if (authError || !user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    const body = await request.json()\n\n    // Validate required fields\n    if (!body.name?.trim()) {\n      return NextResponse.json({ error: 'Vehicle name is required' }, { status: 400 })\n    }\n    if (!body.domicile?.trim()) {\n      return NextResponse.json({ error: 'Domicile is required' }, { status: 400 })\n    }\n\n    // Prepare the vehicle data\n    const vehicleData = {\n      name: body.name.trim(),\n      entity_code: body.entity_code || null,\n      platform: body.platform || null,\n      investment_name: body.investment_name || null,\n      former_entity: body.former_entity || null,\n      type: body.type || 'fund',\n      status: body.status || 'LIVE',\n      domicile: body.domicile.trim(),\n      currency: body.currency || 'USD',\n      formation_date: body.formation_date || null,\n      legal_jurisdiction: body.legal_jurisdiction || null,\n      registration_number: body.registration_number || null,\n      reporting_type: body.reporting_type || 'Not Required',\n      requires_reporting: body.requires_reporting || false,\n      notes: body.notes || null,\n      logo_url: body.logo_url || null,\n      website_url: body.website_url || null,\n      address: body.address || null,\n      arranger_entity_id: body.arranger_entity_id || null,\n      lawyer_id: body.lawyer_id || null,\n      managing_partner_id: body.managing_partner_id || null\n    }\n\n    // Insert the vehicle\n    const serviceSupabase = createServiceClient()\n    const { data: vehicle, error: insertError } = await serviceSupabase\n      .from('vehicles')\n      .insert(vehicleData)\n      .select()\n      .single()\n\n    if (insertError) {\n      console.error('[POST /api/vehicles] Insert error:', insertError)\n      return NextResponse.json(\n        { error: 'Failed to create vehicle', details: insertError.message },\n        { status: 500 }\n      )\n    }\n\n    return NextResponse.json({ vehicle }, { status: 201 })\n\n  } catch (error) {\n    console.error('[POST /api/vehicles] Unexpected error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error', details: error instanceof Error ? error.message : 'Unknown error' },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function GET(request: Request) {\n  try {\n    const supabase = await createClient()\n    const { searchParams } = new URL(request.url)\n    const includeRelated = searchParams.get('related') === 'true'\n\n    // Get the authenticated user\n    const { data: { user }, error: authError } = await supabase.auth.getUser()\n\n    if (authError || !user) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      )\n    }\n\n    // If not requesting related data, return simple list\n    if (!includeRelated) {\n      const { data: vehicles, error } = await supabase\n        .from('vehicles')\n        .select('id, name, type, currency, status')\n        .order('name', { ascending: true })\n\n      if (error) {\n        console.error('Vehicles fetch error:', error)\n        return NextResponse.json(\n          { error: 'Failed to fetch vehicles' },\n          { status: 500 }\n        )\n      }\n\n      return NextResponse.json({\n        vehicles: vehicles || []\n      })\n    }\n\n    // Get investor IDs for this user\n    const serviceSupabase = createServiceClient()\n    const { data: investorLinks } = await serviceSupabase\n      .from('investor_users')\n      .select('investor_id')\n      .eq('user_id', user.id)\n\n    if (!investorLinks || investorLinks.length === 0) {\n      return NextResponse.json({\n        vehicles: []\n      })\n    }\n\n    const investorIds = investorLinks.map(link => link.investor_id)\n\n    // Fetch vehicles with related positions, subscriptions, and valuations\n    // We use LEFT JOIN to get all related data, then filter in JavaScript\n    // This is more efficient than complex database filtering for this use case\n    const { data: vehicles, error } = await serviceSupabase\n      .from('vehicles')\n      .select(`\n        id,\n        name,\n        type,\n        domicile,\n        currency,\n        created_at,\n        status,\n        logo_url,\n        website_url,\n        investment_name,\n        positions!left (\n          id,\n          investor_id,\n          units,\n          cost_basis,\n          last_nav,\n          as_of_date\n        ),\n        subscriptions!left (\n          id,\n          investor_id,\n          commitment,\n          currency,\n          status,\n          effective_date,\n          funding_due_at,\n          units,\n          funded_amount,\n          current_nav\n        ),\n        valuations!left (\n          id,\n          nav_total,\n          nav_per_unit,\n          as_of_date\n        )\n      `)\n      .order('name', { ascending: true })\n\n    if (error) {\n      console.error('Vehicles with related data fetch error:', error)\n      return NextResponse.json(\n        { error: 'Failed to fetch vehicles with related data', details: error.message },\n        { status: 500 }\n      )\n    }\n\n    // Transform the data to match the expected format\n    const transformedVehicles = (vehicles || []).map((vehicle: any) => {\n      // Filter positions and subscriptions for this investor\n      const investorPositions = (vehicle.positions || []).filter((p: any) =>\n        investorIds.includes(p.investor_id)\n      )\n      const investorSubscriptions = (vehicle.subscriptions || []).filter((s: any) =>\n        investorIds.includes(s.investor_id)\n      )\n\n      // Get the most recent valuation\n      const sortedValuations = (vehicle.valuations || []).sort((a: any, b: any) =>\n        new Date(b.as_of_date).getTime() - new Date(a.as_of_date).getTime()\n      )\n      const latestValuation = sortedValuations[0] || null\n\n      // Get primary position and subscription\n      const position = investorPositions[0] || null\n      const subscription = investorSubscriptions[0] || null\n\n      // Calculate derived values\n      let positionData = null\n      if (position) {\n        const units = parseFloat(position.units || 0)\n        const costBasis = parseFloat(position.cost_basis || 0)\n\n        // PRIORITY: position.last_nav FIRST (even if 0), then valuations\n        const posLastNav = position.last_nav !== null && position.last_nav !== undefined\n          ? parseFloat(position.last_nav) : null\n        const valNav = latestValuation?.nav_per_unit ? parseFloat(latestValuation.nav_per_unit) : null\n        const navPerUnit = posLastNav !== null ? posLastNav : (valNav ?? 0)\n\n        // Calculate - use NAV if available, else cost basis\n        const hasNav = posLastNav !== null || valNav !== null\n        const currentValue = hasNav ? units * navPerUnit : costBasis\n        const unrealizedGain = currentValue - costBasis\n        const unrealizedGainPct = costBasis > 0 ? (unrealizedGain / costBasis) * 100 : 0\n\n        positionData = {\n          units,\n          costBasis,\n          currentValue,\n          unrealizedGain,\n          unrealizedGainPct,\n          lastUpdated: position.as_of_date || latestValuation?.as_of_date || null\n        }\n      }\n\n      let subscriptionData = null\n      if (subscription) {\n        subscriptionData = {\n          id: subscription.id,  // Include subscription ID for sell requests\n          commitment: subscription.commitment ? parseFloat(subscription.commitment) : null,\n          currency: subscription.currency || vehicle.currency,\n          status: subscription.status || 'pending',\n          effective_date: subscription.effective_date || null,\n          funding_due_at: subscription.funding_due_at || null,\n          units: subscription.units ? parseFloat(subscription.units) : null,\n          funded_amount: subscription.funded_amount ? parseFloat(subscription.funded_amount) : null,\n          current_nav: subscription.current_nav ? parseFloat(subscription.current_nav) : null\n        }\n      }\n\n      let valuationData = null\n      if (latestValuation) {\n        valuationData = {\n          navTotal: latestValuation.nav_total ? parseFloat(latestValuation.nav_total) : 0,\n          navPerUnit: latestValuation.nav_per_unit ? parseFloat(latestValuation.nav_per_unit) : 0,\n          asOfDate: latestValuation.as_of_date\n        }\n      }\n\n      return {\n        id: vehicle.id,\n        name: vehicle.name,\n        type: vehicle.type,\n        domicile: vehicle.domicile,\n        currency: vehicle.currency,\n        created_at: vehicle.created_at,\n        status: vehicle.status,\n        logo_url: vehicle.logo_url,\n        website_url: vehicle.website_url,\n        investment_name: vehicle.investment_name,\n        position: positionData,\n        subscription: subscriptionData,\n        valuation: valuationData,\n        performance: positionData ? {\n          unrealizedGainPct: positionData.unrealizedGainPct\n        } : null\n      }\n    })\n\n    // Filter out vehicles with no position or subscription\n    const filteredVehicles = transformedVehicles.filter((v: any) =>\n      v.position !== null || v.subscription !== null\n    )\n\n    // Fetch documents for each holding (NDA, Subscription Pack, Certificate)\n    // Documents are linked via subscription_id OR (owner_investor_id + vehicle_id)\n    const vehicleIds = filteredVehicles.map((v: any) => v.id)\n    const subscriptionIds = filteredVehicles\n      .filter((v: any) => v.subscription)\n      .map((v: any) => {\n        // Get the subscription ID from the original vehicle data\n        const vehicle = vehicles?.find((veh: any) => veh.id === v.id)\n        const investorSubs = (vehicle?.subscriptions || []).filter((s: any) =>\n          investorIds.includes(s.investor_id)\n        )\n        return investorSubs[0]?.id\n      })\n      .filter(Boolean)\n\n    // Fetch documents\n    const { data: documents } = await serviceSupabase\n      .from('documents')\n      .select('id, name, type, file_key, subscription_id, owner_investor_id, vehicle_id, created_at')\n      .or(`subscription_id.in.(${subscriptionIds.join(',')}),and(owner_investor_id.in.(${investorIds.join(',')}),vehicle_id.in.(${vehicleIds.join(',')}))`)\n      .in('type', ['nda', 'subscription_pack', 'subscription_draft', 'certificate'])\n      .order('created_at', { ascending: false })\n\n    // Map documents to vehicles\n    const vehiclesWithDocs = filteredVehicles.map((v: any) => {\n      // Find documents for this vehicle\n      const vehicleDocs = (documents || []).filter((doc: any) => {\n        // Match by subscription_id\n        if (doc.subscription_id && subscriptionIds.includes(doc.subscription_id)) {\n          const vehicle = vehicles?.find((veh: any) => veh.id === v.id)\n          const investorSubs = (vehicle?.subscriptions || []).filter((s: any) =>\n            investorIds.includes(s.investor_id)\n          )\n          return investorSubs.some((s: any) => s.id === doc.subscription_id)\n        }\n        // Match by owner_investor_id + vehicle_id (for NDAs)\n        if (doc.owner_investor_id && doc.vehicle_id === v.id) {\n          return investorIds.includes(doc.owner_investor_id)\n        }\n        return false\n      })\n\n      // Group documents by type (take most recent of each type)\n      const docsByType: Record<string, any> = {}\n      vehicleDocs.forEach((doc: any) => {\n        const docType = doc.type === 'subscription_draft' ? 'subscription_pack' : doc.type\n        if (!docsByType[docType]) {\n          docsByType[docType] = {\n            id: doc.id,\n            name: doc.name,\n            type: docType,\n            file_key: doc.file_key,\n            created_at: doc.created_at\n          }\n        }\n      })\n\n      return {\n        ...v,\n        documents: {\n          nda: docsByType['nda'] || null,\n          subscription_pack: docsByType['subscription_pack'] || null,\n          certificate: docsByType['certificate'] || null\n        }\n      }\n    })\n\n    return NextResponse.json({\n      vehicles: vehiclesWithDocs\n    })\n\n  } catch (error) {\n    console.error('API /vehicles error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error', details: error instanceof Error ? error.message : 'Unknown error' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":"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"}}]
}