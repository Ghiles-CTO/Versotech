{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\nimport { createClient as createSupabaseClient } from '@supabase/supabase-js'\nimport { cookies } from 'next/headers'\n\nexport const createClient = async () => {\n  const cookieStore = await cookies()\n\n  return createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll()\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) => {\n              cookieStore.set(name, value, options)\n            })\n          } catch (error) {\n            // The `setAll` method was called from a Server Component.\n            // This can be ignored if you have middleware refreshing\n            // user sessions.\n          }\n        },\n      },\n    }\n  )\n}\n\n// Server client with service role for admin operations\n// Uses raw supabase-js client which properly bypasses RLS with service role\nexport const createServiceClient = () => {\n  return createSupabaseClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\n    {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false,\n      },\n    }\n  )\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AACA;;;;AAEO,MAAM,eAAe;IAC1B,MAAM,cAAc,MAAM,IAAA,mKAAO;IAEjC,OAAO,IAAA,wNAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE;wBAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;oBAC/B;gBACF,EAAE,OAAO,OAAO;gBACd,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ;AAIO,MAAM,sBAAsB;IACjC,OAAO,IAAA,gOAAoB,gFAEzB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AAEJ"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/api/deals/%5Bid%5D/partners/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createClient } from '@/lib/supabase/server'\nimport { createServiceClient } from '@/lib/supabase/server'\n\ninterface RouteContext {\n  params: Promise<{ id: string }>\n}\n\n/**\n * GET /api/deals/[id]/partners\n * Fetches all partners/introducers/commercial partners assigned to a deal via fee_plans\n */\nexport async function GET(request: NextRequest, context: RouteContext) {\n  try {\n    const { id: dealId } = await context.params\n    const supabase = await createClient()\n\n    // Verify user is authenticated\n    const { data: { user }, error: authError } = await supabase.auth.getUser()\n    if (authError || !user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    // Fetch fee_plans with partner assignments for this deal\n    const serviceSupabase = createServiceClient()\n\n    const { data: feePlans, error } = await serviceSupabase\n      .from('fee_plans')\n      .select(`\n        id,\n        name,\n        description,\n        is_active,\n        status,\n        created_at,\n        partner_id,\n        introducer_id,\n        commercial_partner_id,\n        partner:partners(id, name, legal_name, status, contact_email),\n        introducer:introducers(id, legal_name, status, email),\n        commercial_partner:commercial_partners(id, name, legal_name, status, contact_email),\n        fee_components(id, kind, rate_bps, flat_amount, calc_method, frequency)\n      `)\n      .eq('deal_id', dealId)\n      .or('partner_id.not.is.null,introducer_id.not.is.null,commercial_partner_id.not.is.null')\n      .order('created_at', { ascending: false })\n\n    if (error) {\n      console.error('[GET /api/deals/[id]/partners] Error:', error)\n      return NextResponse.json({ error: 'Failed to fetch partners' }, { status: 500 })\n    }\n\n    // Transform the data to a cleaner format\n    const assignments = (feePlans || []).map(fp => {\n      // Determine entity type and data\n      let entityType: string\n      let entity: any\n\n      if (fp.partner_id && fp.partner) {\n        entityType = 'partner'\n        entity = Array.isArray(fp.partner) ? fp.partner[0] : fp.partner\n      } else if (fp.introducer_id && fp.introducer) {\n        entityType = 'introducer'\n        entity = Array.isArray(fp.introducer) ? fp.introducer[0] : fp.introducer\n      } else if (fp.commercial_partner_id && fp.commercial_partner) {\n        entityType = 'commercial_partner'\n        entity = Array.isArray(fp.commercial_partner) ? fp.commercial_partner[0] : fp.commercial_partner\n      } else {\n        return null\n      }\n\n      return {\n        fee_plan_id: fp.id,\n        fee_plan_name: fp.name,\n        fee_plan_status: fp.status || 'draft',\n        is_active: fp.is_active,\n        created_at: fp.created_at,\n        entity_type: entityType,\n        entity_id: entity?.id,\n        entity_name: entity?.name || entity?.legal_name || 'Unknown',\n        entity_status: entity?.status,\n        entity_email: entity?.contact_email || entity?.email, // introducers use 'email', partners/CPs use 'contact_email'\n        fee_components: fp.fee_components || [],\n      }\n    }).filter(Boolean)\n\n    return NextResponse.json({ data: assignments })\n  } catch (error) {\n    console.error('[GET /api/deals/[id]/partners] Unexpected error:', error)\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n\n/**\n * POST /api/deals/[id]/partners\n * Assigns a partner/introducer/commercial partner to a deal by creating a fee_plan\n */\nexport async function POST(request: NextRequest, context: RouteContext) {\n  try {\n    const { id: dealId } = await context.params\n    const supabase = await createClient()\n\n    // Verify user is authenticated\n    const { data: { user }, error: authError } = await supabase.auth.getUser()\n    if (authError || !user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    // Parse request body\n    const body = await request.json()\n    const { entity_type, entity_id, fee_plan_name, fee_components } = body\n\n    // Validate required fields\n    if (!entity_type || !entity_id || !fee_plan_name) {\n      return NextResponse.json(\n        { error: 'Missing required fields: entity_type, entity_id, fee_plan_name' },\n        { status: 400 }\n      )\n    }\n\n    if (!['partner', 'introducer', 'commercial_partner'].includes(entity_type)) {\n      return NextResponse.json(\n        { error: 'Invalid entity_type. Must be partner, introducer, or commercial_partner' },\n        { status: 400 }\n      )\n    }\n\n    const serviceSupabase = createServiceClient()\n\n    // Verify the deal exists\n    const { data: deal, error: dealError } = await serviceSupabase\n      .from('deals')\n      .select('id, name, arranger_entity_id')\n      .eq('id', dealId)\n      .single()\n\n    if (dealError || !deal) {\n      return NextResponse.json({ error: 'Deal not found' }, { status: 404 })\n    }\n\n    // Verify the entity exists\n    const entityTable = entity_type === 'partner' ? 'partners'\n      : entity_type === 'introducer' ? 'introducers'\n      : 'commercial_partners'\n\n    const { data: entity, error: entityError } = await serviceSupabase\n      .from(entityTable)\n      .select('id, status')\n      .eq('id', entity_id)\n      .single()\n\n    if (entityError || !entity) {\n      return NextResponse.json({ error: `${entity_type} not found` }, { status: 404 })\n    }\n\n    // Check if this entity is already assigned to this deal\n    const entityColumn = entity_type === 'partner' ? 'partner_id'\n      : entity_type === 'introducer' ? 'introducer_id'\n      : 'commercial_partner_id'\n\n    const { data: existingAssignment } = await serviceSupabase\n      .from('fee_plans')\n      .select('id')\n      .eq('deal_id', dealId)\n      .eq(entityColumn, entity_id)\n      .single()\n\n    if (existingAssignment) {\n      return NextResponse.json(\n        { error: `This ${entity_type.replace('_', ' ')} is already assigned to this deal` },\n        { status: 409 }\n      )\n    }\n\n    // Create the fee_plan record\n    const feePlanData: any = {\n      deal_id: dealId,\n      name: fee_plan_name,\n      is_active: true,\n      is_default: false,\n      status: 'draft',\n      effective_from: new Date().toISOString().split('T')[0],\n      created_by: user.id,\n    }\n\n    // Set the appropriate entity column\n    if (entity_type === 'partner') {\n      feePlanData.partner_id = entity_id\n    } else if (entity_type === 'introducer') {\n      feePlanData.introducer_id = entity_id\n    } else {\n      feePlanData.commercial_partner_id = entity_id\n    }\n\n    // If the deal has an arranger, set created_by_arranger_id\n    if (deal.arranger_entity_id) {\n      feePlanData.created_by_arranger_id = deal.arranger_entity_id\n    }\n\n    const { data: newFeePlan, error: createError } = await serviceSupabase\n      .from('fee_plans')\n      .insert(feePlanData)\n      .select('id')\n      .single()\n\n    if (createError) {\n      console.error('[POST /api/deals/[id]/partners] Create error:', createError)\n      return NextResponse.json({ error: 'Failed to create fee plan' }, { status: 500 })\n    }\n\n    // Create fee components if provided\n    if (fee_components && Array.isArray(fee_components) && fee_components.length > 0) {\n      const componentsToInsert = fee_components\n        // Filter: must have kind and either rate_bps or flat_amount (including 0 values)\n        .filter(fc => fc.kind && (\n          (fc.rate_bps !== undefined && fc.rate_bps !== null) ||\n          (fc.flat_amount !== undefined && fc.flat_amount !== null)\n        ))\n        .map(fc => ({\n          fee_plan_id: newFeePlan.id,\n          kind: fc.kind,\n          calc_method: fc.calc_method || 'percent_of_investment',\n          rate_bps: fc.rate_bps !== undefined && fc.rate_bps !== null ? fc.rate_bps : null,\n          flat_amount: fc.flat_amount !== undefined && fc.flat_amount !== null ? fc.flat_amount : null,\n          frequency: fc.frequency || 'one_time',\n          has_high_water_mark: fc.has_high_water_mark || false,\n          has_catchup: fc.has_catchup || false,\n        }))\n\n      if (componentsToInsert.length > 0) {\n        const { error: componentsError } = await serviceSupabase\n          .from('fee_components')\n          .insert(componentsToInsert)\n\n        if (componentsError) {\n          console.error('[POST /api/deals/[id]/partners] Components error:', componentsError)\n          // Don't fail the whole operation, just log the error\n        }\n      }\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: { fee_plan_id: newFeePlan.id }\n    }, { status: 201 })\n\n  } catch (error) {\n    console.error('[POST /api/deals/[id]/partners] Unexpected error:', error)\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n\n/**\n * DELETE /api/deals/[id]/partners\n * Removes a partner assignment by deleting the fee_plan\n * Query param: fee_plan_id\n */\nexport async function DELETE(request: NextRequest, context: RouteContext) {\n  try {\n    const { id: dealId } = await context.params\n    const { searchParams } = new URL(request.url)\n    const feePlanId = searchParams.get('fee_plan_id')\n\n    if (!feePlanId) {\n      return NextResponse.json({ error: 'Missing fee_plan_id parameter' }, { status: 400 })\n    }\n\n    const supabase = await createClient()\n\n    // Verify user is authenticated\n    const { data: { user }, error: authError } = await supabase.auth.getUser()\n    if (authError || !user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    const serviceSupabase = createServiceClient()\n\n    // Verify the fee_plan exists and belongs to this deal\n    const { data: feePlan, error: fpError } = await serviceSupabase\n      .from('fee_plans')\n      .select('id, deal_id')\n      .eq('id', feePlanId)\n      .eq('deal_id', dealId)\n      .single()\n\n    if (fpError || !feePlan) {\n      return NextResponse.json({ error: 'Fee plan not found' }, { status: 404 })\n    }\n\n    // Delete fee components first\n    await serviceSupabase\n      .from('fee_components')\n      .delete()\n      .eq('fee_plan_id', feePlanId)\n\n    // Delete the fee plan\n    const { error: deleteError } = await serviceSupabase\n      .from('fee_plans')\n      .delete()\n      .eq('id', feePlanId)\n\n    if (deleteError) {\n      console.error('[DELETE /api/deals/[id]/partners] Delete error:', deleteError)\n      return NextResponse.json({ error: 'Failed to remove partner' }, { status: 500 })\n    }\n\n    return NextResponse.json({ success: true })\n  } catch (error) {\n    console.error('[DELETE /api/deals/[id]/partners] Unexpected error:', error)\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}