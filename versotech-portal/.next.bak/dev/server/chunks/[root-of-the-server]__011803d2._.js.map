{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\nimport { createClient as createSupabaseClient } from '@supabase/supabase-js'\nimport { cookies } from 'next/headers'\n\nexport const createClient = async () => {\n  const cookieStore = await cookies()\n\n  return createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll()\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) => {\n              cookieStore.set(name, value, options)\n            })\n          } catch (error) {\n            // The `setAll` method was called from a Server Component.\n            // This can be ignored if you have middleware refreshing\n            // user sessions.\n          }\n        },\n      },\n    }\n  )\n}\n\n// Server client with service role for admin operations\n// Uses raw supabase-js client which properly bypasses RLS with service role\nexport const createServiceClient = () => {\n  return createSupabaseClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\n    {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false,\n      },\n    }\n  )\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AACA;;;;AAEO,MAAM,eAAe;IAC1B,MAAM,cAAc,MAAM,IAAA,mKAAO;IAEjC,OAAO,IAAA,wNAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE;wBAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;oBAC/B;gBACF,EAAE,OAAO,OAAO;gBACd,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ;AAIO,MAAM,sBAAsB;IACjC,OAAO,IAAA,gOAAoB,gFAEzB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AAEJ"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/lib/audit.ts"],"sourcesContent":["import { createClient } from './supabase/server'\r\n\r\nexport interface AuditLogEntry {\r\n  actor_user_id?: string\r\n  action: string\r\n  entity: string\r\n  entity_id?: string\r\n  metadata?: Record<string, any>\r\n}\r\n\r\nclass AuditLogger {\r\n  private static instance: AuditLogger\r\n\r\n  static getInstance(): AuditLogger {\r\n    if (!AuditLogger.instance) {\r\n      AuditLogger.instance = new AuditLogger()\r\n    }\r\n    return AuditLogger.instance\r\n  }\r\n\r\n  async log(entry: AuditLogEntry): Promise<void> {\r\n    try {\r\n      const supabase = await createClient()\r\n\r\n      // Insert into audit_logs with correct column names\r\n      await supabase.from('audit_logs').insert({\r\n        event_type: 'system',\r\n        actor_id: entry.actor_user_id || null,\r\n        action: entry.action,\r\n        entity_type: entry.entity,\r\n        entity_id: entry.entity_id || null,\r\n        action_details: entry.metadata || null,\r\n        timestamp: new Date().toISOString()\r\n      })\r\n\r\n    } catch (error) {\r\n      console.error('Audit logging failed:', error)\r\n      // Don't throw to avoid breaking the main operation\r\n    }\r\n  }\r\n\r\n  async logMany(entries: AuditLogEntry[]): Promise<void> {\r\n    for (const entry of entries) {\r\n      await this.log(entry)\r\n    }\r\n  }\r\n}\r\n\r\nexport const auditLogger = AuditLogger.getInstance()\r\n\r\n// Common audit actions as constants\r\nexport const AuditActions = {\r\n  // Authentication\r\n  LOGIN: 'login',\r\n  LOGOUT: 'logout',\r\n  PASSWORD_CHANGE: 'password_change',\r\n\r\n  // Data operations\r\n  CREATE: 'create',\r\n  READ: 'read', \r\n  UPDATE: 'update',\r\n  DELETE: 'delete',\r\n\r\n  // Documents\r\n  DOCUMENT_UPLOAD: 'document_upload',\r\n  DOCUMENT_DOWNLOAD: 'document_download',\r\n  DOCUMENT_DELETE: 'document_delete',\r\n\r\n  // Workflows\r\n  WORKFLOW_TRIGGER: 'workflow_trigger',\r\n  WORKFLOW_COMPLETED: 'workflow_completed',\r\n  WORKFLOW_FAILED: 'workflow_failed',\r\n\r\n  // System operations\r\n  USER_CREATED: 'user_created',\r\n  PROFILE_UPDATED: 'profile_updated',\r\n  ROLE_CHANGED: 'role_changed',\r\n\r\n  // Business operations\r\n  SUBSCRIPTION_CREATED: 'subscription_created',\r\n  CAPITAL_CALL_CREATED: 'capital_call_created',\r\n  DISTRIBUTION_CREATED: 'distribution_created',\r\n  REPORT_REQUESTED: 'report_requested',\r\n  MESSAGE_SENT: 'message_sent',\r\n\r\n  // Commission lifecycle (GAP-7)\r\n  COMMISSION_CREATED: 'commission_created',\r\n  COMMISSION_ACCRUED: 'commission_accrued',\r\n  COMMISSION_INVOICE_REQUESTED: 'commission_invoice_requested',\r\n  COMMISSION_INVOICED: 'commission_invoiced',\r\n  COMMISSION_PAID: 'commission_paid',\r\n  COMMISSION_CANCELLED: 'commission_cancelled',\r\n\r\n  // Agreement events (GAP-8)\r\n  AGREEMENT_CREATED: 'agreement_created',\r\n  AGREEMENT_SENT: 'agreement_sent',\r\n  AGREEMENT_APPROVED: 'agreement_approved',\r\n  AGREEMENT_SIGNED: 'agreement_signed',\r\n  AGREEMENT_ACTIVATED: 'agreement_activated',\r\n  AGREEMENT_REJECTED: 'agreement_rejected',\r\n  AGREEMENT_EXPIRED: 'agreement_expired'\r\n} as const\r\n\r\n// Entity types\r\nexport const AuditEntities = {\r\n  USERS: 'users',\r\n  PROFILES: 'profiles',\r\n  INVESTORS: 'investors',\r\n  VEHICLES: 'vehicles',\r\n  SUBSCRIPTIONS: 'subscriptions',\r\n  POSITIONS: 'positions',\r\n  DOCUMENTS: 'documents',\r\n  WORKFLOWS: 'workflows',\r\n  WORKFLOW_RUNS: 'workflow_runs',\r\n  CONVERSATIONS: 'conversations',\r\n  MESSAGES: 'messages',\r\n  REQUEST_TICKETS: 'request_tickets',\r\n  CAPITAL_CALLS: 'capital_calls',\r\n  DISTRIBUTIONS: 'distributions',\r\n  DEALS: 'deals',\r\n  // RESERVATIONS: 'reservations', // Deprecated - removed from workflow\r\n  ALLOCATIONS: 'allocations',\r\n  FEE_EVENTS: 'fee_events',\r\n  INVOICES: 'invoices',\r\n  BANK_TRANSACTIONS: 'bank_transactions',\r\n  PAYMENTS: 'payments',\r\n  ARRANGER: 'arranger_entities',\r\n  INTRODUCER: 'introducers',\r\n  PARTNER: 'partners',\r\n  COMMERCIAL_PARTNER: 'commercial_partners',\r\n  FEE_PLANS: 'arranger_fee_plans',\r\n  CEO_ENTITY: 'ceo_entity',\r\n  CEO_USERS: 'ceo_users',\r\n  // Commission entities (GAP-7)\r\n  INTRODUCER_COMMISSIONS: 'introducer_commissions',\r\n  PARTNER_COMMISSIONS: 'partner_commissions',\r\n  COMMERCIAL_PARTNER_COMMISSIONS: 'commercial_partner_commissions',\r\n  // Agreement entities (GAP-8)\r\n  INTRODUCER_AGREEMENTS: 'introducer_agreements',\r\n  PARTNER_AGREEMENTS: 'partner_agreements',\r\n  COMMERCIAL_PARTNER_AGREEMENTS: 'commercial_partner_agreements',\r\n  // Introductions\r\n  INTRODUCTIONS: 'introductions',\r\n} as const\r\n\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAUA,MAAM;IACJ,OAAe,SAAqB;IAEpC,OAAO,cAA2B;QAChC,IAAI,CAAC,YAAY,QAAQ,EAAE;YACzB,YAAY,QAAQ,GAAG,IAAI;QAC7B;QACA,OAAO,YAAY,QAAQ;IAC7B;IAEA,MAAM,IAAI,KAAoB,EAAiB;QAC7C,IAAI;YACF,MAAM,WAAW,MAAM,IAAA,yKAAY;YAEnC,mDAAmD;YACnD,MAAM,SAAS,IAAI,CAAC,cAAc,MAAM,CAAC;gBACvC,YAAY;gBACZ,UAAU,MAAM,aAAa,IAAI;gBACjC,QAAQ,MAAM,MAAM;gBACpB,aAAa,MAAM,MAAM;gBACzB,WAAW,MAAM,SAAS,IAAI;gBAC9B,gBAAgB,MAAM,QAAQ,IAAI;gBAClC,WAAW,IAAI,OAAO,WAAW;YACnC;QAEF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,mDAAmD;QACrD;IACF;IAEA,MAAM,QAAQ,OAAwB,EAAiB;QACrD,KAAK,MAAM,SAAS,QAAS;YAC3B,MAAM,IAAI,CAAC,GAAG,CAAC;QACjB;IACF;AACF;AAEO,MAAM,cAAc,YAAY,WAAW;AAG3C,MAAM,eAAe;IAC1B,iBAAiB;IACjB,OAAO;IACP,QAAQ;IACR,iBAAiB;IAEjB,kBAAkB;IAClB,QAAQ;IACR,MAAM;IACN,QAAQ;IACR,QAAQ;IAER,YAAY;IACZ,iBAAiB;IACjB,mBAAmB;IACnB,iBAAiB;IAEjB,YAAY;IACZ,kBAAkB;IAClB,oBAAoB;IACpB,iBAAiB;IAEjB,oBAAoB;IACpB,cAAc;IACd,iBAAiB;IACjB,cAAc;IAEd,sBAAsB;IACtB,sBAAsB;IACtB,sBAAsB;IACtB,sBAAsB;IACtB,kBAAkB;IAClB,cAAc;IAEd,+BAA+B;IAC/B,oBAAoB;IACpB,oBAAoB;IACpB,8BAA8B;IAC9B,qBAAqB;IACrB,iBAAiB;IACjB,sBAAsB;IAEtB,2BAA2B;IAC3B,mBAAmB;IACnB,gBAAgB;IAChB,oBAAoB;IACpB,kBAAkB;IAClB,qBAAqB;IACrB,oBAAoB;IACpB,mBAAmB;AACrB;AAGO,MAAM,gBAAgB;IAC3B,OAAO;IACP,UAAU;IACV,WAAW;IACX,UAAU;IACV,eAAe;IACf,WAAW;IACX,WAAW;IACX,WAAW;IACX,eAAe;IACf,eAAe;IACf,UAAU;IACV,iBAAiB;IACjB,eAAe;IACf,eAAe;IACf,OAAO;IACP,sEAAsE;IACtE,aAAa;IACb,YAAY;IACZ,UAAU;IACV,mBAAmB;IACnB,UAAU;IACV,UAAU;IACV,YAAY;IACZ,SAAS;IACT,oBAAoB;IACpB,WAAW;IACX,YAAY;IACZ,WAAW;IACX,8BAA8B;IAC9B,wBAAwB;IACxB,qBAAqB;IACrB,gCAAgC;IAChC,6BAA6B;IAC7B,uBAAuB;IACvB,oBAAoB;IACpB,+BAA+B;IAC/B,gBAAgB;IAChB,eAAe;AACjB"}},
    {"offset": {"line": 259, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/api/portfolio/route.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/server'\r\nimport { auditLogger, AuditActions, AuditEntities } from '@/lib/audit'\r\nimport { NextResponse } from 'next/server'\r\n\r\n// Type definitions for enhanced portfolio response\r\ninterface PortfolioKPIs {\r\n  currentNAV: number\r\n  totalContributed: number\r\n  totalDistributions: number\r\n  unfundedCommitment: number\r\n  totalCommitment: number\r\n  totalCostBasis: number\r\n  unrealizedGain: number\r\n  unrealizedGainPct: number\r\n  dpi: number\r\n  tvpi: number\r\n  irr: number\r\n}\r\n\r\ninterface PortfolioTrends {\r\n  navChange: number\r\n  navChangePct: number\r\n  performanceChange: number\r\n  periodDays: number\r\n}\r\n\r\ninterface VehicleBreakdown {\r\n  vehicleId: string\r\n  vehicleName: string\r\n  vehicleType: string\r\n  logoUrl?: string | null\r\n  currentValue: number\r\n  costBasis: number\r\n  units: number\r\n  unrealizedGain: number\r\n  unrealizedGainPct: number\r\n  commitment: number\r\n  contributed: number\r\n  distributed: number\r\n  navPerUnit: number\r\n  lastValuationDate: string | null\r\n}\r\n\r\nexport async function GET(request: Request) {\r\n  try {\r\n    const supabase = await createClient()\r\n    const { searchParams } = new URL(request.url)\r\n    const includeBreakdown = searchParams.get('breakdown') === 'true'\r\n    const includeTrends = searchParams.get('trends') === 'true'\r\n\r\n    // Get the authenticated user\r\n    const { data: { user }, error: authError } = await supabase.auth.getUser()\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    // Get investor entities linked to this user\r\n    // Check investor_users linkage FIRST - this supports dual-persona users\r\n    // who may have a different profile.role but ARE linked to investor entities\r\n    const { data: investorLinks } = await supabase\r\n      .from('investor_users')\r\n      .select('investor_id')\r\n      .eq('user_id', user.id)\r\n\r\n    // If no investor linkage exists, check if user has investor role as fallback\r\n    // If no investor links, return empty portfolio data\r\n    if (!investorLinks || investorLinks.length === 0) {\r\n      const emptyResponse = {\r\n        kpis: {\r\n          currentNAV: 0,\r\n          totalContributed: 0,\r\n          totalDistributions: 0,\r\n          unfundedCommitment: 0,\r\n          totalCommitment: 0,\r\n          totalCostBasis: 0,\r\n          unrealizedGain: 0,\r\n          unrealizedGainPct: 0,\r\n          dpi: 0,\r\n          tvpi: 0,\r\n          irr: 0\r\n        },\r\n        hasData: false,\r\n        asOfDate: new Date().toISOString(),\r\n        summary: {\r\n          totalPositions: 0,\r\n          totalVehicles: 0,\r\n          lastUpdated: new Date().toISOString()\r\n        }\r\n      }\r\n\r\n      if (includeBreakdown) {\r\n        (emptyResponse as any).vehicleBreakdown = []\r\n      }\r\n\r\n      if (includeTrends) {\r\n        (emptyResponse as any).trends = {\r\n          navChange: 0,\r\n          navChangePct: 0,\r\n          performanceChange: 0,\r\n          periodDays: 30\r\n        }\r\n      }\r\n\r\n      return NextResponse.json(emptyResponse)\r\n    }\r\n\r\n    const investorIds = investorLinks.map(link => link.investor_id)\r\n\r\n    // Calculate comprehensive KPIs using enhanced database function that includes deals\r\n    let kpiData: any\r\n    const { data, error: kpiError } = await supabase\r\n      .rpc('calculate_investor_kpis_with_deals', {\r\n        investor_ids: investorIds\r\n      })\r\n    kpiData = data\r\n\r\n    if (kpiError) {\r\n      console.error('KPI calculation error:', kpiError)\r\n\r\n      // Try fallback to original function if enhanced version fails\r\n      console.log('Attempting fallback to basic KPI calculation...')\r\n      const { data: fallbackKpiData, error: fallbackError } = await supabase\r\n        .rpc('calculate_investor_kpis', {\r\n          investor_ids: investorIds\r\n        })\r\n\r\n      if (fallbackError) {\r\n        console.error('Fallback KPI calculation also failed:', fallbackError)\r\n        throw new Error(`Failed to calculate KPIs: ${kpiError.message}`)\r\n      }\r\n\r\n      // Use fallback data with extended structure (set deal-specific fields to 0)\r\n      const enhancedFallbackData = fallbackKpiData?.map((row: any) => ({\r\n        ...row,\r\n        total_deals: 0,\r\n        total_deal_value: 0,\r\n        pending_allocations: 0\r\n      }))\r\n\r\n      kpiData = enhancedFallbackData\r\n      console.log('Using fallback KPI data')\r\n    }\r\n\r\n    const kpiResult = kpiData?.[0]\r\n    if (!kpiResult) {\r\n      throw new Error('No KPI data returned from calculation')\r\n    }\r\n\r\n    // Prepare KPI response with proper number formatting\r\n    const kpis: PortfolioKPIs = {\r\n      currentNAV: Math.round(parseFloat(kpiResult.current_nav) || 0),\r\n      totalContributed: Math.round(parseFloat(kpiResult.total_contributed) || 0),\r\n      totalDistributions: Math.round(parseFloat(kpiResult.total_distributions) || 0),\r\n      unfundedCommitment: Math.round(parseFloat(kpiResult.unfunded_commitment) || 0),\r\n      totalCommitment: Math.round(parseFloat(kpiResult.total_commitment) || 0),\r\n      totalCostBasis: Math.round(parseFloat(kpiResult.total_cost_basis) || 0),\r\n      unrealizedGain: Math.round(parseFloat(kpiResult.unrealized_gain) || 0),\r\n      unrealizedGainPct: Math.round((parseFloat(kpiResult.unrealized_gain_pct) || 0) * 100) / 100,\r\n      dpi: Math.round((parseFloat(kpiResult.dpi) || 0) * 10000) / 10000,\r\n      tvpi: Math.round((parseFloat(kpiResult.tvpi) || 0) * 10000) / 10000,\r\n      irr: Math.round((parseFloat(kpiResult.irr_estimate) || 0) * 100) / 100\r\n    }\r\n\r\n    // Base response object\r\n    const response: any = {\r\n      kpis,\r\n      hasData: kpis.currentNAV > 0 || kpis.totalContributed > 0,\r\n      asOfDate: new Date().toISOString(),\r\n      summary: {\r\n        totalPositions: parseInt(kpiResult.total_positions) || 0,\r\n        totalVehicles: parseInt(kpiResult.total_vehicles) || 0,\r\n        totalDeals: parseInt(kpiResult.total_deals) || 0,\r\n        totalDealValue: Math.round(parseFloat(kpiResult.total_deal_value) || 0),\r\n        pendingAllocations: parseInt(kpiResult.pending_allocations) || 0,\r\n        lastUpdated: new Date().toISOString()\r\n      }\r\n    }\r\n\r\n    // Optimize: Fetch trends and breakdown in parallel if requested\r\n    const parallelQueries = []\r\n    \r\n    if (includeTrends) {\r\n      parallelQueries.push(\r\n        supabase.rpc('get_portfolio_trends', {\r\n          investor_ids: investorIds,\r\n          days_back: 30\r\n        }).then(result => ({ type: 'trends', result }))\r\n      )\r\n    }\r\n\r\n    if (includeBreakdown) {\r\n      parallelQueries.push(\r\n        supabase.rpc('get_investor_vehicle_breakdown', {\r\n          investor_ids: investorIds\r\n        }).then(result => ({ type: 'breakdown', result }))\r\n      )\r\n    }\r\n\r\n    if (parallelQueries.length > 0) {\r\n      console.time('parallel-optional-queries')\r\n      \r\n      const results = await Promise.allSettled(parallelQueries)\r\n      \r\n      console.timeEnd('parallel-optional-queries')\r\n\r\n      // Process results\r\n      for (const result of results) {\r\n        if (result.status === 'fulfilled') {\r\n          const { type, result: queryResult } = result.value\r\n          \r\n          if (type === 'trends' && !queryResult.error && queryResult.data?.[0]) {\r\n            const trendResult = queryResult.data[0]\r\n            response.trends = {\r\n              navChange: Math.round(parseFloat(trendResult.nav_change) || 0),\r\n              navChangePct: Math.round((parseFloat(trendResult.nav_change_pct) || 0) * 100) / 100,\r\n              performanceChange: Math.round((parseFloat(trendResult.performance_change) || 0) * 100) / 100,\r\n              periodDays: parseInt(trendResult.period_days) || 30\r\n            }\r\n            console.log('✅ Portfolio trends calculated successfully')\r\n          } else if (type === 'trends') {\r\n            console.warn('Portfolio trends failed:', queryResult.error)\r\n          }\r\n          \r\n          if (type === 'breakdown' && !queryResult.error && queryResult.data) {\r\n            response.vehicleBreakdown = queryResult.data.map((vehicle: any): VehicleBreakdown => ({\r\n              vehicleId: vehicle.id,\r\n              vehicleName: vehicle.name,\r\n              vehicleType: vehicle.vehicle_type || 'fund',\r\n              logoUrl: vehicle.logo_url || null,\r\n              currentValue: Math.round(parseFloat(vehicle.current_value) || 0),\r\n              costBasis: Math.round(parseFloat(vehicle.cost_basis) || 0),\r\n              units: parseFloat(vehicle.units) || 0,\r\n              unrealizedGain: Math.round(parseFloat(vehicle.unrealized_gain) || 0),\r\n              unrealizedGainPct: Math.round((parseFloat(vehicle.unrealized_gain_pct) || 0) * 100) / 100,\r\n              commitment: Math.round(parseFloat(vehicle.commitment) || 0),\r\n              contributed: Math.round(parseFloat(vehicle.contributed) || 0),\r\n              distributed: Math.round(parseFloat(vehicle.distributed) || 0),\r\n              navPerUnit: parseFloat(vehicle.nav_per_unit) || 0,\r\n              lastValuationDate: vehicle.as_of_date || null\r\n            }))\r\n            console.log(`✅ Vehicle breakdown calculated successfully: ${response.vehicleBreakdown.length} vehicles`)\r\n          } else if (type === 'breakdown') {\r\n            console.warn('Vehicle breakdown failed:', queryResult.error)\r\n          }\r\n        } else {\r\n          console.warn('Parallel query failed:', result.reason)\r\n        }\r\n      }\r\n    }\r\n\r\n    // Log portfolio access for audit\r\n    await auditLogger.log({\r\n      actor_user_id: user.id,\r\n      action: AuditActions.READ,\r\n      entity: 'portfolio_data',\r\n      entity_id: user.id,\r\n      metadata: {\r\n        endpoint: '/api/portfolio',\r\n        current_nav: kpis.currentNAV,\r\n        position_count: response.summary.totalPositions,\r\n        vehicle_count: response.summary.totalVehicles,\r\n        include_breakdown: includeBreakdown,\r\n        include_trends: includeTrends\r\n      }\r\n    })\r\n\r\n    return NextResponse.json(response)\r\n\r\n  } catch (error) {\r\n    console.error('Portfolio API error:', error)\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Internal server error',\r\n        message: error instanceof Error ? error.message : 'Unknown error'\r\n      },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAyCO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,yKAAY;QACnC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,mBAAmB,aAAa,GAAG,CAAC,iBAAiB;QAC3D,MAAM,gBAAgB,aAAa,GAAG,CAAC,cAAc;QAErD,6BAA6B;QAC7B,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAExE,IAAI,aAAa,CAAC,MAAM;YACtB,OAAO,uKAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,4CAA4C;QAC5C,wEAAwE;QACxE,4EAA4E;QAC5E,MAAM,EAAE,MAAM,aAAa,EAAE,GAAG,MAAM,SACnC,IAAI,CAAC,kBACL,MAAM,CAAC,eACP,EAAE,CAAC,WAAW,KAAK,EAAE;QAExB,6EAA6E;QAC7E,oDAAoD;QACpD,IAAI,CAAC,iBAAiB,cAAc,MAAM,KAAK,GAAG;YAChD,MAAM,gBAAgB;gBACpB,MAAM;oBACJ,YAAY;oBACZ,kBAAkB;oBAClB,oBAAoB;oBACpB,oBAAoB;oBACpB,iBAAiB;oBACjB,gBAAgB;oBAChB,gBAAgB;oBAChB,mBAAmB;oBACnB,KAAK;oBACL,MAAM;oBACN,KAAK;gBACP;gBACA,SAAS;gBACT,UAAU,IAAI,OAAO,WAAW;gBAChC,SAAS;oBACP,gBAAgB;oBAChB,eAAe;oBACf,aAAa,IAAI,OAAO,WAAW;gBACrC;YACF;YAEA,IAAI,kBAAkB;gBACnB,cAAsB,gBAAgB,GAAG,EAAE;YAC9C;YAEA,IAAI,eAAe;gBAChB,cAAsB,MAAM,GAAG;oBAC9B,WAAW;oBACX,cAAc;oBACd,mBAAmB;oBACnB,YAAY;gBACd;YACF;YAEA,OAAO,uKAAY,CAAC,IAAI,CAAC;QAC3B;QAEA,MAAM,cAAc,cAAc,GAAG,CAAC,CAAA,OAAQ,KAAK,WAAW;QAE9D,oFAAoF;QACpF,IAAI;QACJ,MAAM,EAAE,IAAI,EAAE,OAAO,QAAQ,EAAE,GAAG,MAAM,SACrC,GAAG,CAAC,sCAAsC;YACzC,cAAc;QAChB;QACF,UAAU;QAEV,IAAI,UAAU;YACZ,QAAQ,KAAK,CAAC,0BAA0B;YAExC,8DAA8D;YAC9D,QAAQ,GAAG,CAAC;YACZ,MAAM,EAAE,MAAM,eAAe,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,SAC3D,GAAG,CAAC,2BAA2B;gBAC9B,cAAc;YAChB;YAEF,IAAI,eAAe;gBACjB,QAAQ,KAAK,CAAC,yCAAyC;gBACvD,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,SAAS,OAAO,EAAE;YACjE;YAEA,4EAA4E;YAC5E,MAAM,uBAAuB,iBAAiB,IAAI,CAAC,MAAa,CAAC;oBAC/D,GAAG,GAAG;oBACN,aAAa;oBACb,kBAAkB;oBAClB,qBAAqB;gBACvB,CAAC;YAED,UAAU;YACV,QAAQ,GAAG,CAAC;QACd;QAEA,MAAM,YAAY,SAAS,CAAC,EAAE;QAC9B,IAAI,CAAC,WAAW;YACd,MAAM,IAAI,MAAM;QAClB;QAEA,qDAAqD;QACrD,MAAM,OAAsB;YAC1B,YAAY,KAAK,KAAK,CAAC,WAAW,UAAU,WAAW,KAAK;YAC5D,kBAAkB,KAAK,KAAK,CAAC,WAAW,UAAU,iBAAiB,KAAK;YACxE,oBAAoB,KAAK,KAAK,CAAC,WAAW,UAAU,mBAAmB,KAAK;YAC5E,oBAAoB,KAAK,KAAK,CAAC,WAAW,UAAU,mBAAmB,KAAK;YAC5E,iBAAiB,KAAK,KAAK,CAAC,WAAW,UAAU,gBAAgB,KAAK;YACtE,gBAAgB,KAAK,KAAK,CAAC,WAAW,UAAU,gBAAgB,KAAK;YACrE,gBAAgB,KAAK,KAAK,CAAC,WAAW,UAAU,eAAe,KAAK;YACpE,mBAAmB,KAAK,KAAK,CAAC,CAAC,WAAW,UAAU,mBAAmB,KAAK,CAAC,IAAI,OAAO;YACxF,KAAK,KAAK,KAAK,CAAC,CAAC,WAAW,UAAU,GAAG,KAAK,CAAC,IAAI,SAAS;YAC5D,MAAM,KAAK,KAAK,CAAC,CAAC,WAAW,UAAU,IAAI,KAAK,CAAC,IAAI,SAAS;YAC9D,KAAK,KAAK,KAAK,CAAC,CAAC,WAAW,UAAU,YAAY,KAAK,CAAC,IAAI,OAAO;QACrE;QAEA,uBAAuB;QACvB,MAAM,WAAgB;YACpB;YACA,SAAS,KAAK,UAAU,GAAG,KAAK,KAAK,gBAAgB,GAAG;YACxD,UAAU,IAAI,OAAO,WAAW;YAChC,SAAS;gBACP,gBAAgB,SAAS,UAAU,eAAe,KAAK;gBACvD,eAAe,SAAS,UAAU,cAAc,KAAK;gBACrD,YAAY,SAAS,UAAU,WAAW,KAAK;gBAC/C,gBAAgB,KAAK,KAAK,CAAC,WAAW,UAAU,gBAAgB,KAAK;gBACrE,oBAAoB,SAAS,UAAU,mBAAmB,KAAK;gBAC/D,aAAa,IAAI,OAAO,WAAW;YACrC;QACF;QAEA,gEAAgE;QAChE,MAAM,kBAAkB,EAAE;QAE1B,IAAI,eAAe;YACjB,gBAAgB,IAAI,CAClB,SAAS,GAAG,CAAC,wBAAwB;gBACnC,cAAc;gBACd,WAAW;YACb,GAAG,IAAI,CAAC,CAAA,SAAU,CAAC;oBAAE,MAAM;oBAAU;gBAAO,CAAC;QAEjD;QAEA,IAAI,kBAAkB;YACpB,gBAAgB,IAAI,CAClB,SAAS,GAAG,CAAC,kCAAkC;gBAC7C,cAAc;YAChB,GAAG,IAAI,CAAC,CAAA,SAAU,CAAC;oBAAE,MAAM;oBAAa;gBAAO,CAAC;QAEpD;QAEA,IAAI,gBAAgB,MAAM,GAAG,GAAG;YAC9B,QAAQ,IAAI,CAAC;YAEb,MAAM,UAAU,MAAM,QAAQ,UAAU,CAAC;YAEzC,QAAQ,OAAO,CAAC;YAEhB,kBAAkB;YAClB,KAAK,MAAM,UAAU,QAAS;gBAC5B,IAAI,OAAO,MAAM,KAAK,aAAa;oBACjC,MAAM,EAAE,IAAI,EAAE,QAAQ,WAAW,EAAE,GAAG,OAAO,KAAK;oBAElD,IAAI,SAAS,YAAY,CAAC,YAAY,KAAK,IAAI,YAAY,IAAI,EAAE,CAAC,EAAE,EAAE;wBACpE,MAAM,cAAc,YAAY,IAAI,CAAC,EAAE;wBACvC,SAAS,MAAM,GAAG;4BAChB,WAAW,KAAK,KAAK,CAAC,WAAW,YAAY,UAAU,KAAK;4BAC5D,cAAc,KAAK,KAAK,CAAC,CAAC,WAAW,YAAY,cAAc,KAAK,CAAC,IAAI,OAAO;4BAChF,mBAAmB,KAAK,KAAK,CAAC,CAAC,WAAW,YAAY,kBAAkB,KAAK,CAAC,IAAI,OAAO;4BACzF,YAAY,SAAS,YAAY,WAAW,KAAK;wBACnD;wBACA,QAAQ,GAAG,CAAC;oBACd,OAAO,IAAI,SAAS,UAAU;wBAC5B,QAAQ,IAAI,CAAC,4BAA4B,YAAY,KAAK;oBAC5D;oBAEA,IAAI,SAAS,eAAe,CAAC,YAAY,KAAK,IAAI,YAAY,IAAI,EAAE;wBAClE,SAAS,gBAAgB,GAAG,YAAY,IAAI,CAAC,GAAG,CAAC,CAAC,UAAmC,CAAC;gCACpF,WAAW,QAAQ,EAAE;gCACrB,aAAa,QAAQ,IAAI;gCACzB,aAAa,QAAQ,YAAY,IAAI;gCACrC,SAAS,QAAQ,QAAQ,IAAI;gCAC7B,cAAc,KAAK,KAAK,CAAC,WAAW,QAAQ,aAAa,KAAK;gCAC9D,WAAW,KAAK,KAAK,CAAC,WAAW,QAAQ,UAAU,KAAK;gCACxD,OAAO,WAAW,QAAQ,KAAK,KAAK;gCACpC,gBAAgB,KAAK,KAAK,CAAC,WAAW,QAAQ,eAAe,KAAK;gCAClE,mBAAmB,KAAK,KAAK,CAAC,CAAC,WAAW,QAAQ,mBAAmB,KAAK,CAAC,IAAI,OAAO;gCACtF,YAAY,KAAK,KAAK,CAAC,WAAW,QAAQ,UAAU,KAAK;gCACzD,aAAa,KAAK,KAAK,CAAC,WAAW,QAAQ,WAAW,KAAK;gCAC3D,aAAa,KAAK,KAAK,CAAC,WAAW,QAAQ,WAAW,KAAK;gCAC3D,YAAY,WAAW,QAAQ,YAAY,KAAK;gCAChD,mBAAmB,QAAQ,UAAU,IAAI;4BAC3C,CAAC;wBACD,QAAQ,GAAG,CAAC,CAAC,6CAA6C,EAAE,SAAS,gBAAgB,CAAC,MAAM,CAAC,SAAS,CAAC;oBACzG,OAAO,IAAI,SAAS,aAAa;wBAC/B,QAAQ,IAAI,CAAC,6BAA6B,YAAY,KAAK;oBAC7D;gBACF,OAAO;oBACL,QAAQ,IAAI,CAAC,0BAA0B,OAAO,MAAM;gBACtD;YACF;QACF;QAEA,iCAAiC;QACjC,MAAM,2JAAW,CAAC,GAAG,CAAC;YACpB,eAAe,KAAK,EAAE;YACtB,QAAQ,4JAAY,CAAC,IAAI;YACzB,QAAQ;YACR,WAAW,KAAK,EAAE;YAClB,UAAU;gBACR,UAAU;gBACV,aAAa,KAAK,UAAU;gBAC5B,gBAAgB,SAAS,OAAO,CAAC,cAAc;gBAC/C,eAAe,SAAS,OAAO,CAAC,aAAa;gBAC7C,mBAAmB;gBACnB,gBAAgB;YAClB;QACF;QAEA,OAAO,uKAAY,CAAC,IAAI,CAAC;IAE3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,uKAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}