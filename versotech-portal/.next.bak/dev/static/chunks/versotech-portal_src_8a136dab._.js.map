{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/lib/reports/constants.ts"],"sourcesContent":["// Constants and configuration for Reports & Requests feature\n// Business rules: SLAs, report types, categories, workflow mappings\n\nimport type {\n  ReportType,\n  RequestCategory,\n  RequestPriority,\n  ReportTypeConfig,\n  CategoryConfig,\n  RequestStatus,\n} from '@/types/reports'\n\n// ============================================\n// Report Type Configurations\n// ============================================\n\nexport const REPORT_TYPES: Record<ReportType, ReportTypeConfig> = {\n  positions_statement: {\n    label: 'Our Position Statement',\n    description: 'Current holdings and positions across all your investments',\n    icon: 'FileText',\n    estimatedTime: '2-3 minutes',\n    workflowKey: 'positions_statement',\n    sla: 5 * 60 * 1000, // 5 minutes in milliseconds\n    supportedScopes: ['all', 'vehicle', 'custom'],\n    formFields: ['scope', 'vehicle', 'asOfRange', 'currency', 'delivery']\n  },\n  investment_summary: {\n    label: 'Quarterly Report',\n    description: 'Comprehensive quarterly performance and activity summary',\n    icon: 'TrendingUp',\n    estimatedTime: '3-5 minutes',\n    workflowKey: 'quarterly_report',\n    sla: 10 * 60 * 1000, // 10 minutes\n    supportedScopes: ['all', 'vehicle', 'custom'],\n    formFields: ['scope', 'vehicle', 'period', 'includeBenchmark', 'delivery']\n  },\n  capital_activity: {\n    label: 'Monthly Report',\n    description: 'Monthly investment activity, cashflows, and updates',\n    icon: 'Calendar',\n    estimatedTime: '2-4 minutes',\n    workflowKey: 'monthly_report',\n    sla: 10 * 60 * 1000, // 10 minutes\n    supportedScopes: ['all', 'vehicle'],\n    formFields: ['scope', 'vehicle', 'fromTo', 'includeExcel', 'delivery']\n  },\n  tax_pack: {\n    label: 'Yearly Report (Ghiles)',\n    description: 'Annual comprehensive report with all investment details',\n    icon: 'FileBarChart',\n    estimatedTime: '5-10 minutes',\n    workflowKey: 'yearly_report_ghiles',\n    sla: 15 * 60 * 1000, // 15 minutes\n    supportedScopes: ['all', 'vehicle'],\n    formFields: ['scope', 'vehicle', 'taxYear', 'delivery']\n  },\n  custom: {\n    label: 'Custom Request',\n    description: 'Submit a custom request to the team',\n    icon: 'MessageSquare',\n    estimatedTime: 'Varies by request',\n    workflowKey: 'custom_request',\n    sla: 24 * 60 * 60 * 1000, // 24 hours\n    supportedScopes: ['custom'],\n    formFields: ['details']\n  },\n}\n\n// ============================================\n// Request Category Configurations\n// ============================================\n\nexport const REQUEST_CATEGORIES: Record<RequestCategory, CategoryConfig> = {\n  analysis: {\n    label: 'Custom Analysis',\n    description: 'Bespoke investment analysis or portfolio insights',\n  },\n  tax_doc: {\n    label: 'Tax Documentation',\n    description: 'K-1s, tax summaries, and compliance documentation',\n  },\n  data_export: {\n    label: 'Data Export',\n    description: 'Capital activity, holdings, and transaction exports',\n  },\n  presentation: {\n    label: 'Presentation',\n    description: 'Investor decks, IC materials, and bespoke briefings',\n  },\n  communication: {\n    label: 'Communication',\n    description: 'Investor updates, newsletter requests, and follow-ups',\n  },\n  cashflow: {\n    label: 'Cashflow',\n    description: 'Contribution schedules, distribution forecasts, and history',\n  },\n  valuation: {\n    label: 'Valuation',\n    description: 'Asset and portfolio valuation support',\n  },\n  other: {\n    label: 'Other',\n    description: 'General requests not covered by other categories',\n  },\n}\n\n// ============================================\n// SLA Configurations by Priority\n// ============================================\n\nexport const SLA_BY_PRIORITY: Record<RequestPriority, number> = {\n  urgent: 1 * 24 * 60 * 60 * 1000, // 1 day\n  high: 2 * 24 * 60 * 60 * 1000,   // 2 days\n  normal: 3 * 24 * 60 * 60 * 1000, // 3 days\n  low: 5 * 24 * 60 * 60 * 1000,    // 5 days\n}\n\nexport const SLA_LABELS: Record<RequestPriority, string> = {\n  urgent: '1 day',\n  high: '2 days',\n  normal: '3 days',\n  low: '5 days',\n}\n\n// ============================================\n// Status Display Configurations\n// ============================================\n\nexport const REPORT_STATUS_CONFIG = {\n  queued: {\n    label: 'Queued',\n    color: 'gray',\n    icon: 'Clock',\n    description: 'Waiting to process',\n  },\n  processing: {\n    label: 'Processing',\n    color: 'blue',\n    icon: 'Loader',\n    description: 'Generating report',\n  },\n  ready: {\n    label: 'Ready',\n    color: 'green',\n    icon: 'CheckCircle',\n    description: 'Download available',\n  },\n  failed: {\n    label: 'Failed',\n    color: 'red',\n    icon: 'AlertCircle',\n    description: 'Generation failed',\n  },\n}\n\nexport const REQUEST_STATUS_CONFIG: Record<\n  RequestStatus,\n  {\n    label: string\n    color: string\n    icon: string\n    description: string\n  }\n> = {\n  open: {\n    label: 'Open',\n    color: 'gray',\n    icon: 'CircleDot',\n    description: 'Awaiting triage & assignment',\n  },\n  assigned: {\n    label: 'Assigned',\n    color: 'blue',\n    icon: 'UserCheck',\n    description: 'Assigned to staff member',\n  },\n  in_progress: {\n    label: 'In Progress',\n    color: 'blue',\n    icon: 'Play',\n    description: 'Fulfillment in progress',\n  },\n  awaiting_info: {\n    label: 'Awaiting Info',\n    color: 'amber',\n    icon: 'MessageCircle',\n    description: 'Paused while awaiting investor clarification',\n  },\n  ready: {\n    label: 'Ready',\n    color: 'green',\n    icon: 'CheckCircle',\n    description: 'Deliverables ready for review',\n  },\n  closed: {\n    label: 'Closed',\n    color: 'gray',\n    icon: 'Check',\n    description: 'Delivered and closed',\n  },\n  cancelled: {\n    label: 'Cancelled',\n    color: 'gray',\n    icon: 'X',\n    description: 'Cancelled or withdrawn',\n  },\n}\n\nexport const PRIORITY_CONFIG: Record<\n  RequestPriority,\n  {\n    label: string\n    color: string\n    badge: 'default' | 'secondary' | 'destructive' | 'outline'\n  }\n> = {\n  urgent: {\n    label: 'Urgent',\n    color: 'red',\n    badge: 'destructive',\n  },\n  high: {\n    label: 'High',\n    color: 'orange',\n    badge: 'default',\n  },\n  normal: {\n    label: 'Normal',\n    color: 'blue',\n    badge: 'secondary',\n  },\n  low: {\n    label: 'Low',\n    color: 'gray',\n    badge: 'outline',\n  },\n}\n\n// ============================================\n// Business Rules\n// ============================================\n\n/**\n * Window for duplicate detection (milliseconds)\n * If identical report requested within this window, reuse existing\n */\nexport const DUPLICATE_DETECTION_WINDOW = 5 * 60 * 1000 // 5 minutes\n\n/**\n * Maximum number of concurrent report requests per investor\n */\nexport const MAX_CONCURRENT_REPORTS = 10\n\n/**\n * Default pagination limit for request lists\n */\nexport const DEFAULT_PAGE_SIZE = 50\n\n/**\n * Auto-refresh interval for real-time updates (milliseconds)\n */\nexport const REALTIME_POLL_INTERVAL = 30 * 1000 // 30 seconds\n\n/**\n * Time before overdue status kicks in (grace period)\n */\nexport const OVERDUE_GRACE_PERIOD = 60 * 60 * 1000 // 1 hour\n\n// ============================================\n// Validation Rules\n// ============================================\n\nexport const VALIDATION_RULES = {\n  subject: {\n    minLength: 5,\n    maxLength: 200,\n    required: true,\n  },\n  details: {\n    maxLength: 5000,\n    required: false,\n  },\n  completionNote: {\n    minLength: 10,\n    maxLength: 2000,\n    required: false,\n  },\n}\n\n// ============================================\n// API Endpoints\n// ============================================\n\nexport const API_ENDPOINTS = {\n  reportRequests: '/api/report-requests',\n  reportRequestById: (id: string) => `/api/report-requests/${id}`,\n  customRequests: '/api/requests',\n  customRequestById: (id: string) => `/api/requests/${id}`,\n  workflowTrigger: (key: string) => `/api/workflows/${key}/trigger`,\n  documentDownload: (id: string) => `/api/documents/${id}/download`,\n}\n\n// ============================================\n// Helper Functions\n// ============================================\n\n/**\n * Get readable report type label\n */\nexport function getReportTypeLabel(type: ReportType): string {\n  return REPORT_TYPES[type]?.label || type\n}\n\n/**\n * Get category label\n */\nexport function getCategoryLabel(category: RequestCategory): string {\n  return REQUEST_CATEGORIES[category]?.label || category\n}\n\n/**\n * Get SLA in hours for priority\n */\nexport function getSLAHours(priority: RequestPriority): number {\n  return Math.round(SLA_BY_PRIORITY[priority] / (60 * 60 * 1000))\n}\n\n/**\n * Check if request is overdue\n */\nexport function isOverdue(dueDate: string | Date | null | undefined): boolean {\n  if (!dueDate) return false\n  const due = typeof dueDate === 'string' ? new Date(dueDate) : dueDate\n  if (isNaN(due.getTime())) return false\n  return due < new Date(Date.now() - OVERDUE_GRACE_PERIOD)\n}\n\n/**\n * Format time remaining until due date\n */\nexport function formatTimeRemaining(dueDate: string | Date | null | undefined): string {\n  if (!dueDate) return 'No due date'\n  const due = typeof dueDate === 'string' ? new Date(dueDate) : dueDate\n  if (isNaN(due.getTime())) return 'No due date'\n  const now = new Date()\n  const diff = due.getTime() - now.getTime()\n\n  if (diff < 0) {\n    const hours = Math.abs(Math.floor(diff / (60 * 60 * 1000)))\n    return `${hours}h overdue`\n  }\n\n  const days = Math.floor(diff / (24 * 60 * 60 * 1000))\n  const hours = Math.floor((diff % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000))\n\n  if (days > 0) {\n    return `${days}d ${hours}h remaining`\n  }\n  return `${hours}h remaining`\n}\n\nexport const CUSTOM_REQUEST_FORMATS = [\n  { value: 'pdf', label: 'PDF Summary' },\n  { value: 'excel', label: 'Excel Workbook' },\n  { value: 'both', label: 'Both PDF & Excel' }\n] as const\n\nexport const CUSTOM_REQUEST_DATA_FOCUS = [\n  { value: 'performance', label: 'Performance & Returns' },\n  { value: 'cashflows', label: 'Cashflows & Capital Activity' },\n  { value: 'valuations', label: 'Valuations & NAV' },\n  { value: 'holdings', label: 'Detailed Holdings' },\n  { value: 'exits', label: 'Exits & Liquidity Events' },\n  { value: 'other', label: 'Other / Miscellaneous' }\n] as const\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 392, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/staff/requests/request-priority-selector.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from 'react'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { PRIORITY_CONFIG } from '@/lib/reports/constants'\nimport type { RequestPriority } from '@/types/reports'\nimport { toast } from 'sonner'\nimport { Loader2 } from 'lucide-react'\n\ninterface RequestPrioritySelectorProps {\n  requestId: string\n  currentPriority: RequestPriority\n  onUpdate?: () => void\n  variant?: 'inline' | 'dialog'\n}\n\nexport function RequestPrioritySelector({\n  requestId,\n  currentPriority,\n  onUpdate,\n  variant = 'inline',\n}: RequestPrioritySelectorProps) {\n  const [priority, setPriority] = useState<RequestPriority>(currentPriority)\n  const [isUpdating, setIsUpdating] = useState(false)\n  const [showDialog, setShowDialog] = useState(false)\n  const [pendingPriority, setPendingPriority] = useState<RequestPriority | null>(null)\n\n  const priorityOptions: RequestPriority[] = ['urgent', 'high', 'normal', 'low']\n\n  const handlePriorityChange = async (newPriority: RequestPriority) => {\n    if (variant === 'dialog') {\n      setPendingPriority(newPriority)\n      setShowDialog(true)\n      return\n    }\n\n    await updatePriority(newPriority)\n  }\n\n  const updatePriority = async (newPriority: RequestPriority) => {\n    setIsUpdating(true)\n    try {\n      const response = await fetch(`/api/requests/${requestId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ priority: newPriority }),\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to update priority')\n      }\n\n      setPriority(newPriority)\n      toast.success(`Priority updated to ${PRIORITY_CONFIG[newPriority].label}`)\n      onUpdate?.()\n      setShowDialog(false)\n    } catch (error) {\n      console.error('Failed to update priority:', error)\n      toast.error('Failed to update priority')\n    } finally {\n      setIsUpdating(false)\n    }\n  }\n\n  const handleDialogConfirm = () => {\n    if (pendingPriority) {\n      updatePriority(pendingPriority)\n    }\n  }\n\n  return (\n    <>\n      <Select\n        value={priority}\n        onValueChange={handlePriorityChange}\n        disabled={isUpdating}\n      >\n        <SelectTrigger className=\"w-auto gap-2 border-none bg-transparent hover:bg-white/10\">\n          {isUpdating ? (\n            <Loader2 className=\"h-3 w-3 animate-spin\" />\n          ) : (\n            <Badge variant={PRIORITY_CONFIG[priority].badge}>\n              {PRIORITY_CONFIG[priority].label}\n            </Badge>\n          )}\n        </SelectTrigger>\n        <SelectContent>\n          <SelectGroup>\n            <SelectLabel>Change Priority</SelectLabel>\n            {priorityOptions.map((p) => (\n              <SelectItem key={p} value={p}>\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant={PRIORITY_CONFIG[p].badge}>\n                    {PRIORITY_CONFIG[p].label}\n                  </Badge>\n                </div>\n              </SelectItem>\n            ))}\n          </SelectGroup>\n        </SelectContent>\n      </Select>\n\n      {variant === 'dialog' && (\n        <Dialog open={showDialog} onOpenChange={setShowDialog}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>Change Request Priority</DialogTitle>\n              <DialogDescription>\n                Are you sure you want to change the priority from{' '}\n                <Badge variant={PRIORITY_CONFIG[priority].badge}>\n                  {PRIORITY_CONFIG[priority].label}\n                </Badge>{' '}\n                to{' '}\n                {pendingPriority && (\n                  <Badge variant={PRIORITY_CONFIG[pendingPriority].badge}>\n                    {PRIORITY_CONFIG[pendingPriority].label}\n                  </Badge>\n                )}\n                ?\n              </DialogDescription>\n            </DialogHeader>\n            <DialogFooter>\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowDialog(false)}\n                disabled={isUpdating}\n              >\n                Cancel\n              </Button>\n              <Button onClick={handleDialogConfirm} disabled={isUpdating}>\n                {isUpdating && <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />}\n                Confirm\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      )}\n    </>\n  )\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 656, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAIA,MAAM,yBAAW,kMAAgB,MAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,oNAAC;QACC,WAAW,IAAA,mJAAE,EACX,+RACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 690, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/staff/requests/request-status-selector.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from 'react'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { REQUEST_STATUS_CONFIG } from '@/lib/reports/constants'\nimport type { RequestStatus } from '@/types/reports'\nimport { toast } from 'sonner'\nimport { ChevronDown, Loader2, CheckCircle, Play, X, MessageCircle, Clock } from 'lucide-react'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Label } from '@/components/ui/label'\n\ninterface RequestStatusSelectorProps {\n  requestId: string\n  currentStatus: RequestStatus\n  onUpdate?: () => void\n}\n\nconst STATUS_TRANSITIONS: Record<RequestStatus, RequestStatus[]> = {\n  open: ['assigned', 'in_progress', 'cancelled'],\n  assigned: ['in_progress', 'open', 'cancelled'],\n  in_progress: ['ready', 'awaiting_info', 'cancelled'],\n  awaiting_info: ['in_progress'],\n  ready: ['closed', 'in_progress'],\n  closed: [],\n  cancelled: [],\n}\n\nconst STATUS_ICONS: Record<RequestStatus, React.ComponentType<{ className?: string }>> = {\n  open: Clock,\n  assigned: Play,\n  in_progress: Play,\n  awaiting_info: MessageCircle,\n  ready: CheckCircle,\n  closed: CheckCircle,\n  cancelled: X,\n}\n\nexport function RequestStatusSelector({\n  requestId,\n  currentStatus,\n  onUpdate,\n}: RequestStatusSelectorProps) {\n  const [isUpdating, setIsUpdating] = useState(false)\n  const [showDialog, setShowDialog] = useState(false)\n  const [pendingStatus, setPendingStatus] = useState<RequestStatus | null>(null)\n  const [completionNote, setCompletionNote] = useState('')\n\n  const availableTransitions = STATUS_TRANSITIONS[currentStatus] || []\n  const isTerminal = currentStatus === 'closed' || currentStatus === 'cancelled'\n\n  const handleStatusChange = (newStatus: RequestStatus) => {\n    if (newStatus === 'closed') {\n      setPendingStatus(newStatus)\n      setShowDialog(true)\n    } else {\n      updateStatus(newStatus)\n    }\n  }\n\n  const updateStatus = async (newStatus: RequestStatus, note?: string) => {\n    setIsUpdating(true)\n    try {\n      const body: any = { status: newStatus }\n      if (note) {\n        body.completion_note = note\n      }\n\n      const response = await fetch(`/api/requests/${requestId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(body),\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to update status')\n      }\n\n      toast.success(`Status updated to ${REQUEST_STATUS_CONFIG[newStatus].label}`)\n      onUpdate?.()\n      setShowDialog(false)\n      setCompletionNote('')\n    } catch (error) {\n      console.error('Failed to update status:', error)\n      toast.error('Failed to update status')\n    } finally {\n      setIsUpdating(false)\n    }\n  }\n\n  const handleDialogConfirm = () => {\n    if (pendingStatus) {\n      updateStatus(pendingStatus, completionNote)\n    }\n  }\n\n  if (isTerminal) {\n    const StatusIcon = STATUS_ICONS[currentStatus]\n    return (\n      <Badge variant=\"outline\" className=\"gap-1\">\n        <StatusIcon className=\"h-3 w-3\" />\n        {REQUEST_STATUS_CONFIG[currentStatus].label}\n      </Badge>\n    )\n  }\n\n  const CurrentIcon = STATUS_ICONS[currentStatus]\n\n  return (\n    <>\n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            className=\"gap-2\"\n            disabled={isUpdating || availableTransitions.length === 0}\n          >\n            {isUpdating ? (\n              <Loader2 className=\"h-3 w-3 animate-spin\" />\n            ) : (\n              <CurrentIcon className=\"h-3 w-3\" />\n            )}\n            {REQUEST_STATUS_CONFIG[currentStatus].label}\n            {availableTransitions.length > 0 && <ChevronDown className=\"h-3 w-3\" />}\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent align=\"end\">\n          <DropdownMenuLabel>Change Status</DropdownMenuLabel>\n          <DropdownMenuSeparator />\n          {availableTransitions.map((status) => {\n            const Icon = STATUS_ICONS[status]\n            return (\n              <DropdownMenuItem\n                key={status}\n                onClick={() => handleStatusChange(status)}\n              >\n                <Icon className=\"h-4 w-4 mr-2\" />\n                {REQUEST_STATUS_CONFIG[status].label}\n              </DropdownMenuItem>\n            )\n          })}\n        </DropdownMenuContent>\n      </DropdownMenu>\n\n      <Dialog open={showDialog} onOpenChange={setShowDialog}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Close Request</DialogTitle>\n            <DialogDescription>\n              Add a completion note before closing this request. This will be visible to the\n              investor.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"completion-note\">Completion Note</Label>\n              <Textarea\n                id=\"completion-note\"\n                placeholder=\"Describe what was delivered or how the request was resolved...\"\n                value={completionNote}\n                onChange={(e) => setCompletionNote(e.target.value)}\n                rows={4}\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowDialog(false)}\n              disabled={isUpdating}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleDialogConfirm}\n              disabled={isUpdating || !completionNote.trim()}\n            >\n              {isUpdating && <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />}\n              Close Request\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1047, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/staff/requests/request-assignment-dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog'\nimport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { toast } from 'sonner'\nimport { Loader2, User, UserCheck } from 'lucide-react'\n\ninterface StaffProfile {\n  id: string\n  display_name: string\n  email: string\n  role: string\n  title?: string\n}\n\ninterface RequestAssignmentDialogProps {\n  requestId: string\n  currentAssignee?: {\n    id: string\n    display_name: string\n  } | null\n  onUpdate?: () => void\n  trigger?: React.ReactNode\n  currentUserId?: string\n}\n\nexport function RequestAssignmentDialog({\n  requestId,\n  currentAssignee,\n  onUpdate,\n  trigger,\n  currentUserId,\n}: RequestAssignmentDialogProps) {\n  const [open, setOpen] = useState(false)\n  const [staffList, setStaffList] = useState<StaffProfile[]>([])\n  const [selectedStaff, setSelectedStaff] = useState<string>('')\n  const [note, setNote] = useState('')\n  const [isLoading, setIsLoading] = useState(false)\n  const [isAssigning, setIsAssigning] = useState(false)\n\n  useEffect(() => {\n    if (open) {\n      loadStaffList()\n    }\n  }, [open])\n\n  const loadStaffList = async () => {\n    setIsLoading(true)\n    try {\n      const response = await fetch('/api/profiles?role=staff_admin%2Cstaff_ops%2Cstaff_rm', {\n        credentials: 'include',\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to load staff list')\n      }\n\n      const data = await response.json()\n      setStaffList(data.profiles || [])\n    } catch (error) {\n      console.error('Failed to load staff list:', error)\n      toast.error('Failed to load staff members')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const handleAssign = async () => {\n    if (!selectedStaff) {\n      toast.error('Please select a staff member')\n      return\n    }\n\n    setIsAssigning(true)\n    try {\n      const response = await fetch(`/api/staff/requests/${requestId}/assign`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({\n          assigned_to: selectedStaff,\n          note: note || undefined,\n        }),\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to assign request')\n      }\n\n      const assignedStaff = staffList.find((s) => s.id === selectedStaff)\n      toast.success(`Request assigned to ${assignedStaff?.display_name || 'staff member'}`)\n      onUpdate?.()\n      setOpen(false)\n      setSelectedStaff('')\n      setNote('')\n    } catch (error) {\n      console.error('Failed to assign request:', error)\n      toast.error('Failed to assign request')\n    } finally {\n      setIsAssigning(false)\n    }\n  }\n\n  const handleAssignToMe = async () => {\n    if (!currentUserId) {\n      toast.error('User ID not available')\n      return\n    }\n\n    setIsAssigning(true)\n    try {\n      const response = await fetch(`/api/staff/requests/${requestId}/assign`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({\n          assigned_to: currentUserId,\n        }),\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to assign request')\n      }\n\n      toast.success('Request assigned to you')\n      onUpdate?.()\n    } catch (error) {\n      console.error('Failed to assign request:', error)\n      toast.error('Failed to assign request')\n    } finally {\n      setIsAssigning(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        {trigger || (\n          <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n            <User className=\"h-4 w-4\" />\n            {currentAssignee ? 'Reassign' : 'Assign'}\n          </Button>\n        )}\n      </DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {currentAssignee ? 'Reassign Request' : 'Assign Request'}\n          </DialogTitle>\n          <DialogDescription>\n            {currentAssignee ? (\n              <>\n                Currently assigned to <strong>{currentAssignee.display_name}</strong>. Select a\n                new staff member to reassign.\n              </>\n            ) : (\n              'Select a staff member to assign this request to.'\n            )}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          {currentUserId && currentAssignee?.id !== currentUserId && (\n            <Button\n              variant=\"secondary\"\n              className=\"w-full gap-2\"\n              onClick={handleAssignToMe}\n              disabled={isAssigning}\n            >\n              {isAssigning ? (\n                <Loader2 className=\"h-4 w-4 animate-spin\" />\n              ) : (\n                <UserCheck className=\"h-4 w-4\" />\n              )}\n              Assign to Me\n            </Button>\n          )}\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"staff-select\">Staff Member</Label>\n            {isLoading ? (\n              <div className=\"flex items-center justify-center py-8\">\n                <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n              </div>\n            ) : (\n              <Select value={selectedStaff} onValueChange={setSelectedStaff}>\n                <SelectTrigger id=\"staff-select\">\n                  <SelectValue placeholder=\"Select staff member...\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectGroup>\n                    <SelectLabel>Staff Members</SelectLabel>\n                    {staffList.map((staff) => (\n                      <SelectItem key={staff.id} value={staff.id}>\n                        <div className=\"flex flex-col\">\n                          <span>{staff.display_name}</span>\n                          <span className=\"text-xs text-muted-foreground\">\n                            {staff.title || staff.role} â€¢ {staff.email}\n                          </span>\n                        </div>\n                      </SelectItem>\n                    ))}\n                  </SelectGroup>\n                </SelectContent>\n              </Select>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"assignment-note\">Assignment Note (Optional)</Label>\n            <Textarea\n              id=\"assignment-note\"\n              placeholder=\"Add context or instructions for the assignee...\"\n              value={note}\n              onChange={(e) => setNote(e.target.value)}\n              rows={3}\n            />\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => setOpen(false)} disabled={isAssigning}>\n            Cancel\n          </Button>\n          <Button onClick={handleAssign} disabled={isAssigning || !selectedStaff}>\n            {isAssigning && <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />}\n            {currentAssignee ? 'Reassign' : 'Assign'}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1470, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 1590, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,2BAAa,kMAAgB,MAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,oNAAC,4MAAwB;QACvB,KAAK;QACL,WAAW,IAAA,mJAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;0BAET,oNAAC,gNAA4B;gBAAC,WAAU;0BACrC;;;;;;0BAEH,oNAAC;;;;;0BACD,oNAAC,8MAA0B;;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,4MAAwB,CAAC,WAAW;AAE7D,MAAM,0BAAY,kMAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,cAAc,UAAU,EAAE,GAAG,OAAO,EAAE,oBACpD,oNAAC,2NAAuC;QACtC,KAAK;QACL,aAAa;QACb,WAAW,IAAA,mJAAE,EACX,iDACA,gBAAgB,cACd,sDACF,gBAAgB,gBACd,wDACF;QAED,GAAG,KAAK;kBAET,cAAA,oNAAC,uNAAmC;YAAC,WAAU;;;;;;;;;;;MAjB7C;AAoBN,UAAU,WAAW,GAAG,2NAAuC,CAAC,WAAW"}},
    {"offset": {"line": 1667, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,0BAAY,kMAAgB,MAIhC,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,oNAAC,uMAAuB;QACtB,KAAK;QACL,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,mJAAE,EACX,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;;AAIf,UAAU,WAAW,GAAG,uMAAuB,CAAC,WAAW"}},
    {"offset": {"line": 1704, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/staff/requests/request-management-page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useMemo, useState } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport {\n  AlertTriangle,\n  ArrowDownWideNarrow,\n  ArrowUpRight,\n  Calendar,\n  CheckCircle,\n  ClipboardList,\n  FileText,\n  Clock,\n  Filter,\n  Loader2,\n  MessageCircle,\n  Play,\n  RotateCcw,\n  Search,\n  SlidersHorizontal,\n  TrendingUp,\n  User,\n  Workflow,\n  XCircle,\n  UserPlus,\n} from 'lucide-react'\nimport { RequestPrioritySelector } from './request-priority-selector'\nimport { RequestStatusSelector } from './request-status-selector'\nimport { RequestAssignmentDialog } from './request-assignment-dialog'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { ScrollArea } from '@/components/ui/scroll-area'\nimport { Separator } from '@/components/ui/separator'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Label } from '@/components/ui/label'\nimport { toast } from 'sonner'\nimport { createClient } from '@/lib/supabase/client'\nimport {\n  REQUEST_STATUS_CONFIG,\n  REQUEST_CATEGORIES,\n  PRIORITY_CONFIG,\n  formatTimeRemaining,\n  isOverdue,\n} from '@/lib/reports/constants'\nimport type { RequestTicketWithRelations, RequestStatus } from '@/types/reports'\nimport { cn } from '@/lib/utils'\n\ntype RequestFilters = {\n  search: string\n  status: string | 'all'\n  category: string | 'all'\n  priority: string | 'all'\n  assignedTo: 'all' | 'me'\n  overdueOnly: boolean\n  groupByCategory?: boolean\n}\n\ntype RequestStats = {\n  total_requests: number\n  open_count: number\n  in_progress_count: number\n  ready_count: number\n  overdue_count: number\n  avg_fulfillment_time_hours: number | null\n  sla_compliance_rate: number | null\n}\n\ntype RequestsResponse = {\n  requests: RequestTicketWithRelations[]\n  stats: RequestStats | null\n  hasData: boolean\n}\n\nconst defaultFilters: RequestFilters = {\n  search: '',\n  status: 'all',\n  category: 'all',\n  priority: 'all',\n  assignedTo: 'all',\n  overdueOnly: false,\n  groupByCategory: true,\n}\n\nconst statusOptions = [\n  { value: 'all', label: 'All statuses' },\n  { value: 'open', label: 'Open' },\n  { value: 'assigned', label: 'Assigned' },\n  { value: 'in_progress', label: 'In Progress' },\n  { value: 'ready', label: 'Ready' },\n  { value: 'closed', label: 'Closed' },\n]\n\nconst priorityOptions = [\n  { value: 'all', label: 'All priorities' },\n  { value: 'urgent', label: 'Urgent' },\n  { value: 'high', label: 'High' },\n  { value: 'normal', label: 'Normal' },\n  { value: 'low', label: 'Low' },\n]\n\nconst categoryOptions = [\n  { value: 'all', label: 'All categories' },\n  { value: 'tax_doc', label: 'Tax Documents' },\n  { value: 'analysis', label: 'Performance Analysis' },\n  { value: 'data_export', label: 'Data Exports' },\n  { value: 'presentation', label: 'Presentations' },\n  { value: 'communication', label: 'Communications' },\n  { value: 'cashflow', label: 'Cashflow' },\n  { value: 'valuation', label: 'Valuation' },\n  { value: 'other', label: 'Other' },\n]\n\nconst prioritySortOrder: Record<string, number> = {\n  urgent: 0,\n  high: 1,\n  normal: 2,\n  low: 3,\n}\n\nconst realtimeChannelName = 'staff_request_tickets_updates'\n\nexport function RequestManagementPage() {\n  const supabase = createClient()\n  const router = useRouter()\n  const searchParams = useSearchParams()\n\n  const [currentUserId, setCurrentUserId] = useState<string | null>(null)\n  const [filters, setFilters] = useState<RequestFilters>(() => {\n    if (!searchParams) return defaultFilters\n    return {\n      search: searchParams.get('q') || '',\n      status: (searchParams.get('status') as RequestFilters['status']) || 'all',\n      category: (searchParams.get('category') as RequestFilters['category']) || 'all',\n      priority: (searchParams.get('priority') as RequestFilters['priority']) || 'all',\n      assignedTo: (searchParams.get('assigned_to') as RequestFilters['assignedTo']) || 'all',\n      overdueOnly: searchParams.get('overdue') === 'true',\n      groupByCategory: searchParams.get('group_by_category') === 'true',\n    }\n  })\n  const [requests, setRequests] = useState<RequestTicketWithRelations[]>([])\n  const [stats, setStats] = useState<RequestStats | null>(null)\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [authError, setAuthError] = useState<string | null>(null)\n  const [selectedRequest, setSelectedRequest] = useState<RequestTicketWithRelations | null>(null)\n  const [isDialogOpen, setIsDialogOpen] = useState(false)\n\n  useEffect(() => {\n    void loadRequests()\n    void loadCurrentUser()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [filters])\n\n  async function loadCurrentUser() {\n    try {\n      const { data: { user } } = await supabase.auth.getUser()\n      if (user) {\n        setCurrentUserId(user.id)\n      }\n    } catch (error) {\n      console.error('Failed to load current user:', error)\n    }\n  }\n\n  useEffect(() => {\n    const channel = supabase\n      .channel(realtimeChannelName)\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'request_tickets' }, (payload) => {\n        if (payload.eventType === 'INSERT' || payload.eventType === 'UPDATE' || payload.eventType === 'DELETE') {\n          void loadRequests(false)\n        }\n      })\n      .subscribe()\n\n    return () => {\n      supabase.removeChannel(channel)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  // Listen for manual refresh triggers after actions\n  useEffect(() => {\n    const handler = () => {\n      void loadRequests(false)\n    }\n    window.addEventListener('staffRequests:refresh', handler)\n    return () => window.removeEventListener('staffRequests:refresh', handler)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  useEffect(() => {\n    if (!searchParams) return\n    const params = new URLSearchParams()\n    if (filters.search) params.set('q', filters.search)\n    if (filters.status !== 'all') params.set('status', filters.status)\n    if (filters.category !== 'all') params.set('category', filters.category)\n    if (filters.priority !== 'all') params.set('priority', filters.priority)\n    if (filters.assignedTo !== 'all') params.set('assigned_to', filters.assignedTo)\n    if (filters.overdueOnly) params.set('overdue', 'true')\n    if (filters.groupByCategory) params.set('group_by_category', 'true')\n\n    const query = params.toString()\n    router.replace(query ? `?${query}` : '?', { scroll: false })\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [filters])\n\n  async function loadRequests(showLoader = true) {\n    if (showLoader) {\n      setIsLoading(true)\n    }\n    setError(null)\n\n    try {\n      const params = new URLSearchParams()\n      if (filters.search) params.set('q', filters.search)\n      if (filters.status !== 'all') params.set('status', filters.status)\n      if (filters.category !== 'all') params.set('category', filters.category)\n      if (filters.priority !== 'all') params.set('priority', filters.priority)\n      if (filters.assignedTo !== 'all') params.set('assigned_to', filters.assignedTo)\n      if (filters.overdueOnly) params.set('overdue_only', 'true')\n      if (filters.groupByCategory) params.set('group_by_category', 'true')\n\n      const response = await fetch(`/api/staff/requests${params.size ? `?${params.toString()}` : ''}`, {\n        credentials: 'include',\n      })\n\n      if (!response.ok) {\n        let message = 'Failed to load requests'\n        try {\n          const details = await response.json()\n          const parts: string[] = []\n          if (typeof details?.error === 'string' && details.error.trim().length > 0) {\n            parts.push(details.error.trim())\n          }\n          if (typeof details?.details === 'string' && details.details.trim().length > 0) {\n            parts.push(details.details.trim())\n          }\n          if (typeof details?.hint === 'string' && details.hint.trim().length > 0) {\n            parts.push(`Hint: ${details.hint.trim()}`)\n          }\n          if (typeof details?.code === 'string' && details.code.trim().length > 0) {\n            parts.push(`Code: ${details.code.trim()}`)\n          }\n          if (parts.length > 0) {\n            message = parts.join(' â€” ')\n          }\n        } catch {\n          // Ignore JSON parsing failures\n        }\n\n        if (response.status === 401) {\n          const authMessage =\n            'Staff authentication required. Sign in with a staff account or set the demo_auth_user cookie for a staff role.'\n          if (authError !== authMessage) {\n            toast.info(authMessage)\n          }\n          setAuthError(authMessage)\n          setError(null)\n          setRequests([])\n          setStats(null)\n          setIsLoading(false)\n          return\n        }\n\n        console.error('[StaffRequests] API returned error:', message, response.status, { filters, authError })\n        throw new Error(`${message} (status ${response.status})`)\n      }\n\n      const data = (await response.json()) as RequestsResponse\n      setRequests(data.requests || [])\n      setStats(data.stats || null)\n      setAuthError(null)\n\n      if (!data.hasData) {\n        toast.info('Connect Supabase data or run migrations to populate real requests.')\n      }\n    } catch (err) {\n      console.error('[StaffRequests] Failed to load requests', err)\n      const message = err instanceof Error ? err.message : 'Unexpected error occurred'\n      if (message.toLowerCase().includes('staff authentication required')) {\n        if (authError !== message) {\n          toast.info(message)\n        }\n        setAuthError(message)\n        setError(null)\n      } else {\n        setError(message)\n        if (!message.toLowerCase().includes('failed to fetch requests')) {\n          toast.error(message)\n        }\n      }\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const filteredRequests = useMemo(() => {\n    return [...requests].sort((a, b) => {\n      const priorityA = prioritySortOrder[(a as any).priority as keyof typeof prioritySortOrder] ?? 99\n      const priorityB = prioritySortOrder[(b as any).priority as keyof typeof prioritySortOrder] ?? 99\n      if (priorityA !== priorityB) return priorityA - priorityB\n\n      const tsA = a.created_at ? new Date(a.created_at).getTime() : 0\n      const tsB = b.created_at ? new Date(b.created_at).getTime() : 0\n      return tsB - tsA\n    })\n  }, [requests])\n\n  const overdueCount = stats?.overdue_count ?? 0\n\n  const handleFilterChange = (next: Partial<RequestFilters>) => {\n    setFilters((prev) => ({ ...prev, ...next }))\n  }\n\n  const resetFilters = () => {\n    setFilters(defaultFilters)\n  }\n\n  const openRequest = (request: RequestTicketWithRelations) => {\n    setSelectedRequest(request)\n    setIsDialogOpen(true)\n  }\n\n  return (\n    <div className=\"p-6 space-y-6 text-foreground\">\n      {authError && (\n        <Card className=\"border border-amber-400/40 bg-amber-500/10\">\n          <CardHeader>\n            <CardTitle className=\"text-amber-100\">Staff Authentication Required</CardTitle>\n            <CardDescription className=\"text-amber-100/80\">\n              {authError}\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"text-sm text-amber-50/90 space-y-2\">\n            <p>\n              Sign in with a staff account: <strong>admin@versotech.com</strong> / <strong>admin123</strong>\n            </p>\n            <p className=\"text-xs\">\n              Or set the <code>demo_auth_user</code> cookie (must use valid UUID for assigned_to filters):\n            </p>\n            <pre className=\"rounded bg-amber-900/40 border border-amber-400/30 p-2 text-xs text-amber-50 overflow-x-auto\">\n              {`{\"id\":\"2a833fc7-b307-4485-a4c1-4e5c5a010e74\",\"email\":\"admin@versotech.com\",\"role\":\"staff_admin\",\"displayName\":\"Admin Demo\"}`}\n            </pre>\n          </CardContent>\n        </Card>\n      )}\n\n      <PageHeader onRefresh={() => loadRequests()} isRefreshing={isLoading} />\n\n      <StatsOverview\n        stats={stats}\n        totalRequests={filteredRequests.length}\n        overdueCount={overdueCount}\n      />\n\n      {!authError && (\n        <FiltersBar\n          filters={filters}\n          onChange={handleFilterChange}\n          onReset={resetFilters}\n          isLoading={isLoading}\n        />\n      )}\n\n      <RequestQueue\n        requests={filteredRequests}\n        isLoading={isLoading}\n        error={authError ? null : error}\n        onRefresh={() => loadRequests()}\n        onSelectRequest={openRequest}\n        disabled={Boolean(authError)}\n        authError={authError}\n        groupByCategory={!!filters.groupByCategory}\n        currentUserId={currentUserId}\n      />\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-3xl\">\n          <DialogHeader>\n            <DialogTitle>Request Details</DialogTitle>\n          </DialogHeader>\n          <ScrollArea className=\"h-[70vh] pr-4\">\n            {selectedRequest ? (\n              <RequestDetails \n                request={selectedRequest} \n                onUpdate={() => loadRequests()}\n                currentUserId={currentUserId}\n              />\n            ) : (\n              <div className=\"text-muted-foreground\">Select a request to view details</div>\n            )}\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n    </div>\n  )\n}\n\nfunction PageHeader({ onRefresh, isRefreshing }: { onRefresh: () => void; isRefreshing: boolean }) {\n  const router = useRouter()\n  \n  return (\n    <div className=\"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">Request Management</h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Centralized triage for investor tax, performance, and servicing requests.\n        </p>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <Button variant=\"outline\" onClick={onRefresh} className=\"gap-2\" disabled={isRefreshing}>\n          {isRefreshing ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <RotateCcw className=\"h-4 w-4\" />}\n          Refresh\n        </Button>\n        <Button \n          className=\"gap-2\"\n          onClick={() => router.push('/versotech_main/requests/analytics')}\n        >\n          <TrendingUp className=\"h-4 w-4\" />\n          Analytics\n        </Button>\n      </div>\n    </div>\n  )\n}\n\nfunction StatsOverview({\n  stats,\n  totalRequests,\n  overdueCount,\n}: {\n  stats: RequestStats | null\n  totalRequests: number\n  overdueCount: number\n}) {\n  const cards = [\n    {\n      title: 'Total Requests',\n      value: stats?.total_requests ?? totalRequests,\n      description: 'Active in queue',\n    },\n    {\n      title: 'Open',\n      value: stats?.open_count ?? 0,\n      description: 'Awaiting assignment',\n    },\n    {\n      title: 'In Progress',\n      value: stats?.in_progress_count ?? 0,\n      description: 'Assigned & being worked',\n    },\n    {\n      title: 'Ready',\n      value: stats?.ready_count ?? 0,\n      description: 'Awaiting delivery',\n    },\n    {\n      title: 'Overdue',\n      value: overdueCount,\n      description: 'Past SLA deadline',\n      highlight: overdueCount > 0,\n    },\n  ]\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4\">\n      {cards.map((card) => (\n        <Card\n          key={card.title}\n          className={cn(\n            'border border-white/10 bg-white/5 transition-shadow',\n            card.highlight ? 'shadow-lg shadow-red-500/20' : 'hover:shadow-lg',\n          )}\n        >\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-sm text-muted-foreground\">{card.title}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-semibold\">{card.value}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">{card.description}</p>\n          </CardContent>\n        </Card>\n      ))}\n    </div>\n  )\n}\n\nfunction FiltersBar({\n  filters,\n  onChange,\n  onReset,\n  isLoading,\n}: {\n  filters: RequestFilters\n  onChange: (next: Partial<RequestFilters>) => void\n  onReset: () => void\n  isLoading: boolean\n}) {\n  const hasActiveFilters = \n    filters.status !== 'all' || \n    filters.category !== 'all' || \n    filters.priority !== 'all' || \n    filters.assignedTo !== 'all' || \n    filters.overdueOnly ||\n    filters.search.length > 0\n\n  return (\n    <Card className=\"border border-white/10 bg-white/5\">\n      <CardContent className=\"p-4 space-y-4\">\n        <div className=\"flex flex-col gap-4 xl:flex-row xl:items-center xl:justify-between\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search by request ID, investor, title, or assignee\"\n              value={filters.search}\n              onChange={(event) => onChange({ search: event.target.value })}\n              className=\"pl-10\"\n            />\n          </div>\n          <div className=\"flex flex-wrap gap-2\">\n            <Button\n              variant=\"outline\"\n              className=\"gap-2\"\n              onClick={onReset}\n              disabled={isLoading || !hasActiveFilters}\n            >\n              <SlidersHorizontal className=\"h-4 w-4\" />\n              Reset\n            </Button>\n            <Button\n              variant={filters.groupByCategory ? 'default' : 'outline'}\n              className=\"gap-2\"\n              onClick={() => onChange({ groupByCategory: !filters.groupByCategory })}\n            >\n              <ClipboardList className=\"h-4 w-4\" />\n              {filters.groupByCategory ? 'Grouped' : 'Group'}\n            </Button>\n          </div>\n        </div>\n\n        {/* Quick Filter Chips */}\n        <div className=\"flex flex-wrap gap-2\">\n          <Button\n            variant={filters.assignedTo === 'me' ? 'default' : 'outline'}\n            size=\"sm\"\n            className=\"gap-2\"\n            onClick={() => onChange({ assignedTo: filters.assignedTo === 'me' ? 'all' : 'me' })}\n          >\n            <User className=\"h-3 w-3\" /> My Tasks\n          </Button>\n          <Button\n            variant={filters.status === 'open' ? 'default' : 'outline'}\n            size=\"sm\"\n            onClick={() => onChange({ status: filters.status === 'open' ? 'all' : 'open' })}\n          >\n            Unassigned\n          </Button>\n          <Button\n            variant={filters.overdueOnly ? 'default' : 'outline'}\n            size=\"sm\"\n            className=\"gap-2\"\n            onClick={() => onChange({ overdueOnly: !filters.overdueOnly })}\n          >\n            <AlertTriangle className=\"h-3 w-3\" /> Overdue\n          </Button>\n          <Button\n            variant={filters.priority === 'urgent' || filters.priority === 'high' ? 'default' : 'outline'}\n            size=\"sm\"\n            onClick={() => {\n              if (filters.priority === 'urgent' || filters.priority === 'high') {\n                onChange({ priority: 'all' })\n              } else {\n                onChange({ priority: 'urgent' })\n              }\n            }}\n          >\n            High Priority\n          </Button>\n          <Button\n            variant={filters.status === 'in_progress' ? 'default' : 'outline'}\n            size=\"sm\"\n            onClick={() => onChange({ status: filters.status === 'in_progress' ? 'all' : 'in_progress' })}\n          >\n            In Progress\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-5\">\n          <Select\n            value={filters.status}\n            onValueChange={(value) => onChange({ status: value as RequestFilters['status'] })}\n          >\n            <SelectTrigger className=\"gap-2\">\n              <Filter className=\"h-4 w-4\" />\n              <SelectValue placeholder=\"Status\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectGroup>\n                <SelectLabel>Status</SelectLabel>\n                {statusOptions.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    {option.label}\n                  </SelectItem>\n                ))}\n              </SelectGroup>\n            </SelectContent>\n          </Select>\n\n          <Select\n            value={filters.priority}\n            onValueChange={(value) => onChange({ priority: value as RequestFilters['priority'] })}\n          >\n            <SelectTrigger className=\"gap-2\">\n              <ArrowDownWideNarrow className=\"h-4 w-4\" />\n              <SelectValue placeholder=\"Priority\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectGroup>\n                <SelectLabel>Priority</SelectLabel>\n                {priorityOptions.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    {option.label}\n                  </SelectItem>\n                ))}\n              </SelectGroup>\n            </SelectContent>\n          </Select>\n\n          <Select\n            value={filters.category}\n            onValueChange={(value) => onChange({ category: value as RequestFilters['category'] })}\n          >\n            <SelectTrigger className=\"gap-2\">\n              <ClipboardList className=\"h-4 w-4\" />\n              <SelectValue placeholder=\"Category\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectGroup>\n                <SelectLabel>Category</SelectLabel>\n                {categoryOptions.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    {option.label}\n                  </SelectItem>\n                ))}\n              </SelectGroup>\n            </SelectContent>\n          </Select>\n\n          <Select\n            value={filters.assignedTo}\n            onValueChange={(value) => onChange({ assignedTo: value as RequestFilters['assignedTo'] })}\n          >\n            <SelectTrigger className=\"gap-2\">\n              <User className=\"h-4 w-4\" />\n              <SelectValue placeholder=\"Assignee\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectGroup>\n                <SelectLabel>Assignee</SelectLabel>\n                <SelectItem value=\"all\">All staff</SelectItem>\n                <SelectItem value=\"me\">Assigned to me</SelectItem>\n              </SelectGroup>\n            </SelectContent>\n          </Select>\n\n          <Select\n            value={filters.overdueOnly ? 'overdue' : 'any'}\n            onValueChange={(value) => onChange({ overdueOnly: value === 'overdue' })}\n          >\n            <SelectTrigger className=\"gap-2\">\n              <Clock className=\"h-4 w-4\" />\n              <SelectValue placeholder=\"SLA\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectGroup>\n                <SelectLabel>SLA</SelectLabel>\n                <SelectItem value=\"any\">All requests</SelectItem>\n                <SelectItem value=\"overdue\">SLA breaches only</SelectItem>\n              </SelectGroup>\n            </SelectContent>\n          </Select>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\nfunction RequestQueue({\n  requests,\n  isLoading,\n  error,\n  onRefresh,\n  onSelectRequest,\n  disabled = false,\n  authError,\n  groupByCategory = false,\n  currentUserId,\n}: {\n  requests: RequestTicketWithRelations[]\n  isLoading: boolean\n  error: string | null\n  onRefresh: () => void\n  onSelectRequest: (request: RequestTicketWithRelations) => void\n  disabled?: boolean\n  authError?: string | null\n  groupByCategory?: boolean\n  currentUserId?: string | null\n}) {\n  if (isLoading) {\n    return (\n      <Card className=\"border border-white/10 bg-white/5\">\n        <CardContent className=\"p-12 flex flex-col items-center gap-3 text-muted-foreground\">\n          <Loader2 className=\"h-8 w-8 animate-spin\" />\n          <p>Loading request queueâ€¦</p>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  if (error) {\n    return (\n      <Card className=\"border border-red-400/30 bg-red-500/10\">\n        <CardContent className=\"p-6 space-y-3\">\n          <div className=\"flex items-center gap-2 text-sm text-red-200\">\n            <AlertTriangle className=\"h-4 w-4\" />\n            {error}\n          </div>\n          <Button variant=\"outline\" onClick={onRefresh} className=\"gap-2 border-white/20\">\n            <RotateCcw className=\"h-4 w-4\" />\n            Retry\n          </Button>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  if (authError) {\n    return (\n      <Card className=\"border border-dashed border-amber-400/40 bg-amber-500/10\">\n        <CardContent className=\"p-10 text-center space-y-3 text-amber-100\">\n          <ClipboardList className=\"h-12 w-12 text-amber-300/80 mx-auto\" />\n          <div className=\"space-y-1\">\n            <p className=\"text-lg font-semibold\">Authentication Required</p>\n            <p className=\"text-sm text-amber-100/80\">{authError}</p>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  if (!requests.length) {\n    return (\n      <Card className=\"border border-dashed border-white/20 bg-white/5\">\n        <CardContent className=\"p-12 text-center space-y-3\">\n          <ClipboardList className=\"h-12 w-12 text-muted-foreground/80 mx-auto\" />\n          <div className=\"space-y-1\">\n            <p className=\"text-lg font-semibold\">No active requests</p>\n            <p className=\"text-sm text-muted-foreground\">\n              When investors submit requests from the Reports page or inbox automations, they will appear here for triage.\n            </p>\n          </div>\n          <Button variant=\"outline\" onClick={onRefresh} className=\"gap-2 border-white/20\">\n            <RotateCcw className=\"h-4 w-4\" />\n            Check again\n          </Button>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  if (groupByCategory) {\n    const byCategory = new Map<string, RequestTicketWithRelations[]>()\n    for (const req of requests) {\n      const key = (req as any).category || 'other'\n      const arr = byCategory.get(key) || []\n      arr.push(req)\n      byCategory.set(key, arr)\n    }\n    return (\n      <div className={cn('space-y-6', disabled && 'opacity-50 pointer-events-none select-none')}>\n        {Array.from(byCategory.entries()).map(([cat, items]) => (\n          <div key={cat} className=\"space-y-3\">\n            <div className=\"flex items-center gap-2\">\n              <Badge variant=\"outline\" className=\"border-white/20\">\n                {REQUEST_CATEGORIES[cat as keyof typeof REQUEST_CATEGORIES]?.label || cat}\n              </Badge>\n              <span className=\"text-xs text-muted-foreground\">{items.length} items</span>\n            </div>\n            <div className=\"space-y-3\">\n              {items.map((req) => (\n                <RequestCard \n                  key={req.id} \n                  request={req} \n                  onSelect={() => onSelectRequest(req)}\n                  onUpdate={onRefresh}\n                  currentUserId={currentUserId}\n                />\n              ))}\n            </div>\n          </div>\n        ))}\n      </div>\n    )\n  }\n\n  return (\n    <div className={cn('space-y-4', disabled && 'opacity-50 pointer-events-none select-none')}>\n      {requests.map((request) => (\n        <RequestCard \n          key={request.id} \n          request={request} \n          onSelect={() => onSelectRequest(request)}\n          onUpdate={onRefresh}\n          currentUserId={currentUserId}\n        />\n      ))}\n    </div>\n  )\n}\n\nfunction RequestCard({ \n  request, \n  onSelect, \n  onUpdate,\n  currentUserId \n}: { \n  request: RequestTicketWithRelations\n  onSelect: () => void\n  onUpdate?: () => void\n  currentUserId?: string | null\n}) {\n  const statusConfig = REQUEST_STATUS_CONFIG[request.status as keyof typeof REQUEST_STATUS_CONFIG]\n  const overdue = !!(request.due_date && isOverdue(request.due_date))\n\n  return (\n    <Card\n      className={cn(\n        'border border-white/10 bg-white/5 hover:border-white/30 transition-colors',\n        overdue && 'border-red-400/50 bg-red-500/5',\n      )}\n    >\n      <CardContent className=\"p-6\">\n        <div className=\"flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between\">\n          <div className=\"space-y-3 flex-1\">\n            <div className=\"flex flex-wrap items-center gap-2 text-sm\">\n              <Badge variant=\"outline\" className=\"border-white/20 text-xs uppercase tracking-wide\">\n                {request.id.split('-')[0]}\n              </Badge>\n              <div className=\"flex items-center gap-2\">\n                <RequestStatusSelector\n                  requestId={request.id}\n                  currentStatus={request.status as any}\n                  onUpdate={onUpdate}\n                />\n                <RequestPrioritySelector\n                  requestId={request.id}\n                  currentPriority={request.priority as any}\n                  onUpdate={onUpdate}\n                  variant=\"inline\"\n                />\n                <Badge variant=\"outline\" className=\"border-white/20\">\n                  {REQUEST_CATEGORIES[request.category]?.label || request.category}\n                </Badge>\n                {overdue && (\n                  <Badge variant=\"destructive\" className=\"gap-1\">\n                    <AlertTriangle className=\"h-3 w-3\" />\n                    Overdue\n                  </Badge>\n                )}\n              </div>\n            </div>\n\n            <div>\n              <h3 className=\"text-lg font-semibold\">{request.subject}</h3>\n              {request.details && (\n                <p className=\"text-sm text-muted-foreground line-clamp-2 max-w-2xl\">{request.details}</p>\n              )}\n            </div>\n\n            <div className=\"grid grid-cols-1 gap-3 text-sm md:grid-cols-2 xl:grid-cols-4\">\n              <MetadataItem label=\"Investor\" value={request.investor?.legal_name || 'N/A'} />\n              <MetadataItem\n                label=\"Created\"\n                value={new Date(request.created_at).toLocaleString(undefined, {\n                  month: 'short',\n                  day: 'numeric',\n                  hour: '2-digit',\n                  minute: '2-digit',\n                })}\n              />\n              <MetadataItem\n                label=\"Due\"\n                value={\n                  request.due_date\n                    ? new Date(request.due_date).toLocaleString(undefined, {\n                        month: 'short',\n                        day: 'numeric',\n                        hour: '2-digit',\n                        minute: '2-digit',\n                      })\n                    : 'Not set'\n                }\n                emphasis={overdue}\n              />\n              <MetadataItem\n                label=\"Assigned\"\n                value={request.assigned_to_profile?.display_name || 'Unassigned'}\n              />\n            </div>\n\n            <div className=\"flex flex-wrap gap-3 text-xs text-muted-foreground\">\n              {request.due_date && (\n                <div className=\"flex items-center gap-1\">\n                  <Calendar className=\"h-3 w-3\" />\n                  {formatTimeRemaining(request.due_date)}\n                </div>\n              )}\n              {request.linked_workflow_run && (\n                <div className=\"flex items-center gap-1\">\n                  <Play className=\"h-3 w-3\" /> Workflow {shortenId(request.linked_workflow_run)}\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"flex flex-col gap-2 lg:min-w-[160px]\">\n            <Button variant=\"outline\" size=\"sm\" className=\"gap-2\" onClick={onSelect}>\n              <EyeIcon />\n              View Details\n            </Button>\n            \n            <RequestAssignmentDialog\n              requestId={request.id}\n              currentAssignee={request.assigned_to_profile}\n              currentUserId={currentUserId || undefined}\n              onUpdate={onUpdate}\n              trigger={\n                <Button variant=\"ghost\" size=\"sm\" className=\"gap-2 w-full justify-start\">\n                  <UserPlus className=\"h-4 w-4\" />\n                  {request.assigned_to ? 'Reassign' : 'Assign'}\n                </Button>\n              }\n            />\n            \n            <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\" onClick={onSelect}>\n              <MessageCircle className=\"h-4 w-4\" />\n              Conversation\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\nfunction RequestDetails({ request, onUpdate, currentUserId }: { \n  request: RequestTicketWithRelations\n  onUpdate?: () => void\n  currentUserId?: string | null\n}) {\n  const [isCreatingConversation, setIsCreatingConversation] = useState(false)\n  const overdue = !!(request.due_date && request.status !== 'closed' && request.status !== 'ready' && isOverdue(request.due_date))\n  const statusConfig = REQUEST_STATUS_CONFIG[request.status as keyof typeof REQUEST_STATUS_CONFIG]\n\n  const handleCreateConversation = async () => {\n    setIsCreatingConversation(true)\n    try {\n      const res = await fetch('/api/conversations', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({\n          subject: `Request ${request.id}: ${request.subject}`,\n          participant_ids: [request.created_by],\n          type: 'dm',\n          initial_message: `Context: request ${request.id} (${request.category || 'general'}) - ${request.subject}`,\n        }),\n      })\n      if (res.ok) {\n        const result = await res.json()\n        const convId = result?.conversation?.id\n        if (convId) {\n          toast.success('Conversation created')\n          window.location.href = `/versotech_main/messages/${convId}`\n        }\n      } else {\n        throw new Error('Failed to create conversation')\n      }\n    } catch (error) {\n      console.error('Failed to create conversation:', error)\n      toast.error('Failed to create conversation')\n    } finally {\n      setIsCreatingConversation(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <Badge variant=\"outline\" className=\"border-white/20 text-xs\">\n            {request.id}\n          </Badge>\n          <RequestStatusSelector\n            requestId={request.id}\n            currentStatus={request.status as any}\n            onUpdate={onUpdate}\n          />\n          <RequestPrioritySelector\n            requestId={request.id}\n            currentPriority={request.priority as any}\n            onUpdate={onUpdate}\n            variant=\"inline\"\n          />\n          <Badge variant=\"outline\" className=\"border-white/20\">\n            {REQUEST_CATEGORIES[request.category]?.label || request.category}\n          </Badge>\n          {overdue && (\n            <Badge variant=\"destructive\" className=\"gap-1\">\n              <AlertTriangle className=\"h-3 w-3\" /> SLA breach\n            </Badge>\n          )}\n        </div>\n        <h2 className=\"text-2xl font-semibold\">{request.subject}</h2>\n        {request.details && <p className=\"text-sm text-muted-foreground whitespace-pre-line\">{request.details}</p>}\n      </div>\n\n      <Separator className=\"border-white/10\" />\n\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n        <DetailsCard title=\"Investor\">\n          <p className=\"text-sm font-medium\">{request.investor?.legal_name || 'N/A'}</p>\n          <p className=\"text-xs text-muted-foreground\">Created by: {request.created_by_profile?.display_name}</p>\n        </DetailsCard>\n        <DetailsCard title=\"Assignment\">\n          <p className=\"text-sm font-medium\">{request.assigned_to_profile?.display_name || 'Unassigned'}</p>\n          <p className=\"text-xs text-muted-foreground\">\n            {request.assigned_to ? 'Assigned staff member responsible for delivery.' : 'Assign to an available analyst or RM.'}\n          </p>\n        </DetailsCard>\n        {(request as any).due_date && (\n          <DetailsCard title=\"SLA & Due Date\">\n            <p className=\"text-sm font-medium\">\n              {new Date((request as any).due_date).toLocaleString(undefined, {\n                month: 'long',\n                day: 'numeric',\n                hour: '2-digit',\n                minute: '2-digit',\n              })}\n            </p>\n            <p className=\"text-xs text-muted-foreground\">\n              {formatTimeRemaining((request as any).due_date)}\n            </p>\n          </DetailsCard>\n        )}\n        <DetailsCard title=\"Linked Workflow & Deliverables\">\n          {request.linked_workflow_run ? (\n            <p className=\"text-sm font-medium\">Workflow run: {shortenId(request.linked_workflow_run)}</p>\n          ) : (\n            <p className=\"text-sm text-muted-foreground\">No workflow run linked.</p>\n          )}\n          {request.result_doc_id ? (\n            <p className=\"text-xs text-muted-foreground\">Deliverable ready for review.</p>\n          ) : (\n            <p className=\"text-xs text-muted-foreground\">Attach deliverables before closing the request.</p>\n          )}\n        </DetailsCard>\n      </div>\n\n      <Separator className=\"border-white/10\" />\n\n      <div>\n        <h3 className=\"text-lg font-medium mb-2\">Status History & Notes</h3>\n        <ul className=\"space-y-2 text-sm text-muted-foreground\">\n          <li>\n            Created at {new Date(request.created_at).toLocaleString()} by {request.created_by_profile?.display_name}\n          </li>\n          {request.updated_at && (\n            <li>Last updated at {new Date(request.updated_at).toLocaleString()}</li>\n          )}\n          {request.closed_at && <li>Closed at {new Date(request.closed_at).toLocaleString()}</li>}\n          {request.completion_note && (\n            <li className=\"bg-white/5 border border-white/10 rounded-md p-3 text-foreground\">\n              <p className=\"text-sm font-medium mb-1\">Completion Note</p>\n              <p className=\"text-sm text-muted-foreground whitespace-pre-line\">{request.completion_note}</p>\n            </li>\n          )}\n        </ul>\n      </div>\n\n      <Separator className=\"border-white/10\" />\n\n      <div className=\"space-y-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\n          <RequestAssignmentDialog\n            requestId={request.id}\n            currentAssignee={request.assigned_to_profile}\n            currentUserId={currentUserId || undefined}\n            onUpdate={onUpdate}\n            trigger={\n              <Button variant=\"secondary\" className=\"justify-start gap-2 w-full\">\n                <UserPlus className=\"h-4 w-4\" />\n                {request.assigned_to ? 'Reassign Request' : 'Assign Request'}\n              </Button>\n            }\n          />\n          \n          <Button\n            variant=\"outline\"\n            className=\"justify-start gap-2\"\n            onClick={handleCreateConversation}\n            disabled={isCreatingConversation}\n          >\n            {isCreatingConversation ? (\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\n            ) : (\n              <MessageCircle className=\"h-4 w-4\" />\n            )}\n            Create Conversation\n          </Button>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction QuickActionButtons({ request }: { request: RequestTicketWithRelations }) {\n  return (\n    <div className=\"grid grid-cols-1 gap-3 md:grid-cols-2\">\n      <Button variant=\"secondary\" className=\"justify-start gap-2\">\n        <User className=\"h-4 w-4\" /> Assign to team member\n      </Button>\n      <Button variant=\"secondary\" className=\"justify-start gap-2\">\n        <Play className=\"h-4 w-4\" /> Trigger automation\n      </Button>\n      <Button variant=\"outline\" className=\"justify-start gap-2\">\n        <MessageCircle className=\"h-4 w-4\" /> Request clarification\n      </Button>\n      <Button variant=\"outline\" className=\"justify-start gap-2\">\n        <CheckCircle className=\"h-4 w-4\" /> Mark ready for review\n      </Button>\n    </div>\n  )\n}\n\nfunction MetadataItem({ label, value, emphasis }: { label: string; value: string; emphasis?: boolean }) {\n  return (\n    <div>\n      <div className=\"text-xs text-muted-foreground uppercase tracking-wide\">{label}</div>\n      <div className={cn('text-sm font-medium', emphasis && 'text-red-300')}>{value}</div>\n    </div>\n  )\n}\n\nfunction DetailsCard({ title, children }: { title: string; children: React.ReactNode }) {\n  return (\n    <div className=\"rounded-lg border border-white/10 bg-white/5 p-4 space-y-2\">\n      <h4 className=\"text-sm font-medium text-muted-foreground uppercase tracking-wide\">{title}</h4>\n      {children}\n    </div>\n  )\n}\n\nfunction shortenId(id: string) {\n  if (!id) return ''\n  return `${id.slice(0, 6)}â€¦${id.slice(-4)}`\n}\n\nfunction EyeIcon() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"h-4 w-4\">\n      <path d=\"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7\" />\n      <circle cx=\"12\" cy=\"12\" r=\"3\" />\n    </svg>\n  )\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4258, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28main%29/versotech_main/inbox/requests-content.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { RequestManagementPage } from '@/components/staff/requests/request-management-page'\r\n\r\n/**\r\n * Requests Content for Unified Inbox\r\n *\r\n * Renders the RequestManagementPage component which handles\r\n * its own data fetching and state management.\r\n */\r\nexport default function RequestsContent() {\r\n  return <RequestManagementPage />\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAUe,SAAS;IACtB,qBAAO,oNAAC,2NAAqB;;;;;AAC/B;KAFwB"}}]
}