{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"skeleton\"\n      className={cn(\"bg-accent animate-pulse rounded-md\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;;AAAA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAoC;IACpE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;KARS"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/tabs.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Wrapper to provide stable ID for SSR hydration\nconst Tabs = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Root>\n>(({ id, ...props }, ref) => {\n  const generatedId = React.useId()\n  return <TabsPrimitive.Root ref={ref} id={id ?? generatedId} {...props} />\n})\nTabs.displayName = \"Tabs\"\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-11 md:h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 md:py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AAEA;;;AALA;;;;AAOA,iDAAiD;AACjD,MAAM,qBAAO,GAAA,kMAAgB,SAG3B,CAAC,EAAE,EAAE,EAAE,GAAG,OAAO,EAAE;;IACnB,MAAM,cAAc,6LAAW;IAC/B,qBAAO,oNAAC,kMAAkB;QAAC,KAAK;QAAK,IAAI,MAAM;QAAc,GAAG,KAAK;;;;;;AACvE;;AACA,KAAK,WAAW,GAAG;AAEnB,MAAM,yBAAW,kMAAgB,OAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,oNAAC,kMAAkB;QACjB,KAAK;QACL,WAAW,IAAA,mJAAE,EACX,sGACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG,kMAAkB,CAAC,WAAW;AAErD,MAAM,4BAAc,kMAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,oNAAC,qMAAqB;QACpB,KAAK;QACL,WAAW,IAAA,mJAAE,EACX,+YACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,qMAAqB,CAAC,WAAW;AAE3D,MAAM,4BAAc,kMAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,oNAAC,qMAAqB;QACpB,KAAK;QACL,WAAW,IAAA,mJAAE,EACX,mIACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,qMAAqB,CAAC,WAAW"}},
    {"offset": {"line": 240, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/accordion.tsx"],"sourcesContent":["\"use client\"\n\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = AccordionPrimitive.Item\n\nconst AccordionTrigger = ({\n  className,\n  children,\n  ...props\n}: React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200 [data-state=open]:rotate-180\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n)\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = ({\n  className,\n  children,\n  ...props\n}: React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>) => (\n  <AccordionPrimitive.Content\n    className={cn(\n      \"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"pb-4 pt-0\">{children}</div>\n  </AccordionPrimitive.Content>\n)\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,YAAY,uMAAuB;AAEzC,MAAM,gBAAgB,uMAAuB;AAE7C,MAAM,mBAAmB,CAAC,EACxB,SAAS,EACT,QAAQ,EACR,GAAG,OAC+D,iBAClE,oNAAC,yMAAyB;QAAC,WAAU;kBACnC,cAAA,oNAAC,0MAA0B;YACzB,WAAW,IAAA,mJAAE,EACX,oGACA;YAED,GAAG,KAAK;;gBAER;8BACD,oNAAC,6PAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;KAdvB;AAkBN,iBAAiB,WAAW,GAAG,0MAA0B,CAAC,WAAW;AAErE,MAAM,mBAAmB,CAAC,EACxB,SAAS,EACT,QAAQ,EACR,GAAG,OAC+D,iBAClE,oNAAC,0MAA0B;QACzB,WAAW,IAAA,mJAAE,EACX,4HACA;QAED,GAAG,KAAK;kBAET,cAAA,oNAAC;YAAI,WAAU;sBAAa;;;;;;;;;;;MAZ1B;AAeN,iBAAiB,WAAW,GAAG,0MAA0B,CAAC,WAAW"}},
    {"offset": {"line": 317, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/tooltip.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst TooltipProvider = TooltipPrimitive.Provider\r\n\r\nconst Tooltip = TooltipPrimitive.Root\r\n\r\nconst TooltipTrigger = TooltipPrimitive.Trigger\r\n\r\nconst TooltipContent = React.forwardRef<\r\n    React.ElementRef<typeof TooltipPrimitive.Content>,\r\n    React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\r\n>(({ className, sideOffset = 4, ...props }, ref) => (\r\n    <TooltipPrimitive.Content\r\n        ref={ref}\r\n        sideOffset={sideOffset}\r\n        className={cn(\r\n            \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\r\n            className\r\n        )}\r\n        {...props}\r\n    />\r\n))\r\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\r\n\r\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\r\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,kBAAkB,yMAAyB;AAEjD,MAAM,UAAU,qMAAqB;AAErC,MAAM,iBAAiB,wMAAwB;AAE/C,MAAM,+BAAiB,kMAAgB,MAGrC,CAAC,EAAE,SAAS,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBACxC,oNAAC,wMAAwB;QACrB,KAAK;QACL,YAAY;QACZ,WAAW,IAAA,mJAAE,EACT,sYACA;QAEH,GAAG,KAAK;;;;;;;AAGjB,eAAe,WAAW,GAAG,wMAAwB,CAAC,WAAW"}},
    {"offset": {"line": 362, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/investor-journey-bar.tsx"],"sourcesContent":["'use client'\n\nimport { cn } from '@/lib/utils'\nimport { Check, Circle, SkipForward } from 'lucide-react'\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/ui/tooltip'\n\nexport interface JourneyStage {\n  stage_number: number\n  stage_name: string\n  completed_at: string | null\n  is_current: boolean\n}\n\nexport interface JourneySummary {\n  received: string | null\n  viewed: string | null\n  interest_confirmed: string | null\n  nda_signed: string | null\n  data_room_access: string | null\n  pack_generated: string | null\n  pack_sent: string | null\n  signed: string | null\n  funded: string | null\n  active: string | null\n}\n\ninterface InvestorJourneyBarProps {\n  stages?: JourneyStage[]\n  summary?: JourneySummary\n  currentStage?: number\n  className?: string\n  compact?: boolean\n}\n\n// Stage definitions with optional flag\nconst STAGE_DEFINITIONS = [\n  { number: 1, name: 'Received', key: 'received', optional: true },\n  { number: 2, name: 'Viewed', key: 'viewed', optional: false },\n  { number: 3, name: 'Interest', key: 'interest_confirmed', optional: true },\n  { number: 4, name: 'NDA', key: 'nda_signed', optional: true },\n  { number: 5, name: 'Data Room', key: 'data_room_access', optional: true },\n  { number: 6, name: 'Pack Gen', key: 'pack_generated', optional: false },\n  { number: 7, name: 'Pack Sent', key: 'pack_sent', optional: false },\n  { number: 8, name: 'Signed', key: 'signed', optional: false },\n  { number: 9, name: 'Funded', key: 'funded', optional: false },\n  { number: 10, name: 'Active', key: 'active', optional: false },\n] as const\n\ntype StageStatus = 'completed' | 'current' | 'skipped' | 'pending'\n\n/**\n * Detect if investor took Direct Subscribe path\n * Direct Subscribe: pack_generated is set but interest_confirmed is null\n * This means they skipped the Interest and Data Room stages\n */\nfunction isDirectSubscribePath(summary: JourneySummary): boolean {\n  return summary.pack_generated !== null && summary.interest_confirmed === null\n}\n\nfunction getStageStatus(\n  stageDef: typeof STAGE_DEFINITIONS[number],\n  summary: JourneySummary,\n  currentStage: number\n): StageStatus {\n  const completedAt = summary[stageDef.key as keyof JourneySummary]\n\n  if (completedAt) {\n    return 'completed'\n  }\n\n  if (stageDef.number === currentStage) {\n    return 'current'\n  }\n\n  // Special handling for Direct Subscribe path\n  // Interest (stage 3) and Data Room (stage 5) are explicitly skipped\n  const isDirectPath = isDirectSubscribePath(summary)\n  if (isDirectPath) {\n    // For Direct Subscribe: Interest and Data Room are skipped\n    if (stageDef.number === 3 || stageDef.number === 5) {\n      // Only mark as skipped if we're past these stages\n      if (currentStage > stageDef.number || summary.pack_generated) {\n        return 'skipped'\n      }\n    }\n  }\n\n  // Check if this is an optional stage that was skipped\n  // A stage is skipped if it's optional and a later stage is completed\n  if (stageDef.optional && stageDef.number < currentStage) {\n    return 'skipped'\n  }\n\n  return 'pending'\n}\n\nfunction formatDate(dateString: string | null): string {\n  if (!dateString) return ''\n  const date = new Date(dateString)\n  return date.toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric'\n  })\n}\n\nexport function InvestorJourneyBar({\n  stages,\n  summary,\n  currentStage = 0,\n  className,\n  compact = false\n}: InvestorJourneyBarProps) {\n  // Build summary from stages if provided\n  const effectiveSummary: JourneySummary = summary || (stages ? {\n    received: stages.find(s => s.stage_number === 1)?.completed_at || null,\n    viewed: stages.find(s => s.stage_number === 2)?.completed_at || null,\n    interest_confirmed: stages.find(s => s.stage_number === 3)?.completed_at || null,\n    nda_signed: stages.find(s => s.stage_number === 4)?.completed_at || null,\n    data_room_access: stages.find(s => s.stage_number === 5)?.completed_at || null,\n    pack_generated: stages.find(s => s.stage_number === 6)?.completed_at || null,\n    pack_sent: stages.find(s => s.stage_number === 7)?.completed_at || null,\n    signed: stages.find(s => s.stage_number === 8)?.completed_at || null,\n    funded: stages.find(s => s.stage_number === 9)?.completed_at || null,\n    active: stages.find(s => s.stage_number === 10)?.completed_at || null,\n  } : {\n    received: null,\n    viewed: null,\n    interest_confirmed: null,\n    nda_signed: null,\n    data_room_access: null,\n    pack_generated: null,\n    pack_sent: null,\n    signed: null,\n    funded: null,\n    active: null,\n  })\n\n  // Calculate effective current stage if not provided\n  const effectiveCurrentStage = currentStage || (() => {\n    if (effectiveSummary.active) return 10\n    if (effectiveSummary.funded) return 9\n    if (effectiveSummary.signed) return 8\n    if (effectiveSummary.pack_sent) return 7\n    if (effectiveSummary.pack_generated) return 6\n    if (effectiveSummary.data_room_access) return 5\n    if (effectiveSummary.nda_signed) return 4\n    if (effectiveSummary.interest_confirmed) return 3\n    if (effectiveSummary.viewed) return 2\n    if (effectiveSummary.received) return 1\n    return 0\n  })()\n\n  return (\n    <TooltipProvider>\n      <div className={cn('w-full', className)}>\n        {/* Progress Bar */}\n        <div className=\"relative\">\n          {/* Background line */}\n          <div className=\"absolute top-4 left-0 right-0 h-0.5 bg-border\" />\n\n          {/* Progress line */}\n          <div\n            className=\"absolute top-4 left-0 h-0.5 bg-emerald-500 transition-all duration-500\"\n            style={{ width: `${Math.max(0, (effectiveCurrentStage - 1) / 9) * 100}%` }}\n          />\n\n          {/* Stage indicators */}\n          <div className=\"relative flex justify-between\">\n            {STAGE_DEFINITIONS.map((stageDef) => {\n              const status = getStageStatus(stageDef, effectiveSummary, effectiveCurrentStage)\n              const completedAt = effectiveSummary[stageDef.key as keyof JourneySummary]\n\n              return (\n                <Tooltip key={stageDef.number}>\n                  <TooltipTrigger asChild>\n                    <div className=\"flex flex-col items-center\">\n                      {/* Stage circle */}\n                      <div\n                        className={cn(\n                          'w-8 h-8 rounded-full flex items-center justify-center transition-all',\n                          status === 'completed' && 'bg-emerald-500 text-white',\n                          status === 'current' && 'bg-blue-500 text-white ring-4 ring-blue-200 dark:ring-blue-900',\n                          status === 'skipped' && 'bg-muted text-muted-foreground',\n                          status === 'pending' && 'bg-muted/50 text-muted-foreground'\n                        )}\n                      >\n                        {status === 'completed' ? (\n                          <Check className=\"w-4 h-4\" />\n                        ) : status === 'skipped' ? (\n                          <SkipForward className=\"w-3 h-3\" />\n                        ) : (\n                          <span className=\"text-xs font-medium\">{stageDef.number}</span>\n                        )}\n                      </div>\n\n                      {/* Stage label */}\n                      {!compact && (\n                        <span\n                          className={cn(\n                            'mt-2 text-xs font-medium text-center max-w-[60px] leading-tight',\n                            status === 'completed' && 'text-emerald-600 dark:text-emerald-400',\n                            status === 'current' && 'text-blue-600 dark:text-blue-400',\n                            status === 'skipped' && 'text-muted-foreground',\n                            status === 'pending' && 'text-muted-foreground'\n                          )}\n                        >\n                          {stageDef.name}\n                        </span>\n                      )}\n                    </div>\n                  </TooltipTrigger>\n                  <TooltipContent side=\"bottom\" className=\"max-w-[200px]\">\n                    <div className=\"text-sm\">\n                      <div className=\"font-medium\">{stageDef.name}</div>\n                      {status === 'completed' && completedAt && (\n                        <div className=\"text-xs text-muted-foreground mt-1\">\n                          Completed: {formatDate(completedAt)}\n                        </div>\n                      )}\n                      {status === 'current' && (\n                        <div className=\"text-xs text-blue-600 mt-1\">In Progress</div>\n                      )}\n                      {status === 'skipped' && (\n                        <div className=\"text-xs text-muted-foreground mt-1\">Skipped (optional)</div>\n                      )}\n                      {status === 'pending' && (\n                        <div className=\"text-xs text-muted-foreground mt-1\">Pending</div>\n                      )}\n                      {stageDef.optional && (\n                        <div className=\"text-xs text-amber-600 dark:text-amber-400 mt-1\">\n                          Optional stage\n                        </div>\n                      )}\n                    </div>\n                  </TooltipContent>\n                </Tooltip>\n              )\n            })}\n          </div>\n        </div>\n\n        {/* Stage summary text */}\n        {!compact && (\n          <div className=\"mt-4 text-center\">\n            <span className=\"text-sm text-muted-foreground\">\n              {effectiveCurrentStage === 0 && 'Not started'}\n              {effectiveCurrentStage === 1 && 'Opportunity received'}\n              {effectiveCurrentStage === 2 && 'Viewed opportunity'}\n              {effectiveCurrentStage === 3 && 'Interest confirmed'}\n              {effectiveCurrentStage === 4 && 'NDA signed'}\n              {effectiveCurrentStage === 5 && 'Data room access granted'}\n              {effectiveCurrentStage === 6 && 'Subscription pack generated'}\n              {effectiveCurrentStage === 7 && 'Subscription pack sent for signing'}\n              {effectiveCurrentStage === 8 && 'Subscription signed'}\n              {effectiveCurrentStage === 9 && 'Investment funded'}\n              {effectiveCurrentStage === 10 && 'Investment active'}\n            </span>\n          </div>\n        )}\n      </div>\n    </TooltipProvider>\n  )\n}\n\n// Compact version for list cards\nexport function JourneyProgressBadge({\n  currentStage,\n  className\n}: {\n  currentStage: number\n  className?: string\n}) {\n  const stageName = STAGE_DEFINITIONS[currentStage - 1]?.name || 'Not Started'\n\n  return (\n    <div className={cn('flex items-center gap-2', className)}>\n      <div className=\"flex gap-0.5\">\n        {STAGE_DEFINITIONS.map((stage) => (\n          <div\n            key={stage.number}\n            className={cn(\n              'w-2 h-2 rounded-full',\n              stage.number <= currentStage\n                ? 'bg-emerald-500'\n                : 'bg-muted'\n            )}\n          />\n        ))}\n      </div>\n      <span className=\"text-xs text-muted-foreground\">{stageName}</span>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AACA;AAJA;;;;;AAuCA,uCAAuC;AACvC,MAAM,oBAAoB;IACxB;QAAE,QAAQ;QAAG,MAAM;QAAY,KAAK;QAAY,UAAU;IAAK;IAC/D;QAAE,QAAQ;QAAG,MAAM;QAAU,KAAK;QAAU,UAAU;IAAM;IAC5D;QAAE,QAAQ;QAAG,MAAM;QAAY,KAAK;QAAsB,UAAU;IAAK;IACzE;QAAE,QAAQ;QAAG,MAAM;QAAO,KAAK;QAAc,UAAU;IAAK;IAC5D;QAAE,QAAQ;QAAG,MAAM;QAAa,KAAK;QAAoB,UAAU;IAAK;IACxE;QAAE,QAAQ;QAAG,MAAM;QAAY,KAAK;QAAkB,UAAU;IAAM;IACtE;QAAE,QAAQ;QAAG,MAAM;QAAa,KAAK;QAAa,UAAU;IAAM;IAClE;QAAE,QAAQ;QAAG,MAAM;QAAU,KAAK;QAAU,UAAU;IAAM;IAC5D;QAAE,QAAQ;QAAG,MAAM;QAAU,KAAK;QAAU,UAAU;IAAM;IAC5D;QAAE,QAAQ;QAAI,MAAM;QAAU,KAAK;QAAU,UAAU;IAAM;CAC9D;AAID;;;;CAIC,GACD,SAAS,sBAAsB,OAAuB;IACpD,OAAO,QAAQ,cAAc,KAAK,QAAQ,QAAQ,kBAAkB,KAAK;AAC3E;AAEA,SAAS,eACP,QAA0C,EAC1C,OAAuB,EACvB,YAAoB;IAEpB,MAAM,cAAc,OAAO,CAAC,SAAS,GAAG,CAAyB;IAEjE,IAAI,aAAa;QACf,OAAO;IACT;IAEA,IAAI,SAAS,MAAM,KAAK,cAAc;QACpC,OAAO;IACT;IAEA,6CAA6C;IAC7C,oEAAoE;IACpE,MAAM,eAAe,sBAAsB;IAC3C,IAAI,cAAc;QAChB,2DAA2D;QAC3D,IAAI,SAAS,MAAM,KAAK,KAAK,SAAS,MAAM,KAAK,GAAG;YAClD,kDAAkD;YAClD,IAAI,eAAe,SAAS,MAAM,IAAI,QAAQ,cAAc,EAAE;gBAC5D,OAAO;YACT;QACF;IACF;IAEA,sDAAsD;IACtD,qEAAqE;IACrE,IAAI,SAAS,QAAQ,IAAI,SAAS,MAAM,GAAG,cAAc;QACvD,OAAO;IACT;IAEA,OAAO;AACT;AAEA,SAAS,WAAW,UAAyB;IAC3C,IAAI,CAAC,YAAY,OAAO;IACxB,MAAM,OAAO,IAAI,KAAK;IACtB,OAAO,KAAK,kBAAkB,CAAC,SAAS;QACtC,OAAO;QACP,KAAK;QACL,MAAM;IACR;AACF;AAEO,SAAS,mBAAmB,EACjC,MAAM,EACN,OAAO,EACP,eAAe,CAAC,EAChB,SAAS,EACT,UAAU,KAAK,EACS;IACxB,wCAAwC;IACxC,MAAM,mBAAmC,WAAW,CAAC,SAAS;QAC5D,UAAU,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QAClE,QAAQ,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QAChE,oBAAoB,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QAC5E,YAAY,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QACpE,kBAAkB,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QAC1E,gBAAgB,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QACxE,WAAW,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QACnE,QAAQ,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QAChE,QAAQ,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,IAAI,gBAAgB;QAChE,QAAQ,OAAO,IAAI,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,KAAK,gBAAgB;IACnE,IAAI;QACF,UAAU;QACV,QAAQ;QACR,oBAAoB;QACpB,YAAY;QACZ,kBAAkB;QAClB,gBAAgB;QAChB,WAAW;QACX,QAAQ;QACR,QAAQ;QACR,QAAQ;IACV,CAAC;IAED,oDAAoD;IACpD,MAAM,wBAAwB,gBAAgB,CAAC;QAC7C,IAAI,iBAAiB,MAAM,EAAE,OAAO;QACpC,IAAI,iBAAiB,MAAM,EAAE,OAAO;QACpC,IAAI,iBAAiB,MAAM,EAAE,OAAO;QACpC,IAAI,iBAAiB,SAAS,EAAE,OAAO;QACvC,IAAI,iBAAiB,cAAc,EAAE,OAAO;QAC5C,IAAI,iBAAiB,gBAAgB,EAAE,OAAO;QAC9C,IAAI,iBAAiB,UAAU,EAAE,OAAO;QACxC,IAAI,iBAAiB,kBAAkB,EAAE,OAAO;QAChD,IAAI,iBAAiB,MAAM,EAAE,OAAO;QACpC,IAAI,iBAAiB,QAAQ,EAAE,OAAO;QACtC,OAAO;IACT,CAAC;IAED,qBACE,oNAAC,gLAAe;kBACd,cAAA,oNAAC;YAAI,WAAW,IAAA,mJAAE,EAAC,UAAU;;8BAE3B,oNAAC;oBAAI,WAAU;;sCAEb,oNAAC;4BAAI,WAAU;;;;;;sCAGf,oNAAC;4BACC,WAAU;4BACV,OAAO;gCAAE,OAAO,GAAG,KAAK,GAAG,CAAC,GAAG,CAAC,wBAAwB,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC;4BAAC;;;;;;sCAI3E,oNAAC;4BAAI,WAAU;sCACZ,kBAAkB,GAAG,CAAC,CAAC;gCACtB,MAAM,SAAS,eAAe,UAAU,kBAAkB;gCAC1D,MAAM,cAAc,gBAAgB,CAAC,SAAS,GAAG,CAAyB;gCAE1E,qBACE,oNAAC,wKAAO;;sDACN,oNAAC,+KAAc;4CAAC,OAAO;sDACrB,cAAA,oNAAC;gDAAI,WAAU;;kEAEb,oNAAC;wDACC,WAAW,IAAA,mJAAE,EACX,wEACA,WAAW,eAAe,6BAC1B,WAAW,aAAa,kEACxB,WAAW,aAAa,kCACxB,WAAW,aAAa;kEAGzB,WAAW,4BACV,oNAAC,uOAAK;4DAAC,WAAU;;;;;mEACf,WAAW,0BACb,oNAAC,6PAAW;4DAAC,WAAU;;;;;iFAEvB,oNAAC;4DAAK,WAAU;sEAAuB,SAAS,MAAM;;;;;;;;;;;oDAKzD,CAAC,yBACA,oNAAC;wDACC,WAAW,IAAA,mJAAE,EACX,mEACA,WAAW,eAAe,0CAC1B,WAAW,aAAa,oCACxB,WAAW,aAAa,yBACxB,WAAW,aAAa;kEAGzB,SAAS,IAAI;;;;;;;;;;;;;;;;;sDAKtB,oNAAC,+KAAc;4CAAC,MAAK;4CAAS,WAAU;sDACtC,cAAA,oNAAC;gDAAI,WAAU;;kEACb,oNAAC;wDAAI,WAAU;kEAAe,SAAS,IAAI;;;;;;oDAC1C,WAAW,eAAe,6BACzB,oNAAC;wDAAI,WAAU;;4DAAqC;4DACtC,WAAW;;;;;;;oDAG1B,WAAW,2BACV,oNAAC;wDAAI,WAAU;kEAA6B;;;;;;oDAE7C,WAAW,2BACV,oNAAC;wDAAI,WAAU;kEAAqC;;;;;;oDAErD,WAAW,2BACV,oNAAC;wDAAI,WAAU;kEAAqC;;;;;;oDAErD,SAAS,QAAQ,kBAChB,oNAAC;wDAAI,WAAU;kEAAkD;;;;;;;;;;;;;;;;;;mCAxD3D,SAAS,MAAM;;;;;4BAgEjC;;;;;;;;;;;;gBAKH,CAAC,yBACA,oNAAC;oBAAI,WAAU;8BACb,cAAA,oNAAC;wBAAK,WAAU;;4BACb,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,KAAK;4BAC/B,0BAA0B,MAAM;;;;;;;;;;;;;;;;;;;;;;;AAO/C;KA7JgB;AAgKT,SAAS,qBAAqB,EACnC,YAAY,EACZ,SAAS,EAIV;IACC,MAAM,YAAY,iBAAiB,CAAC,eAAe,EAAE,EAAE,QAAQ;IAE/D,qBACE,oNAAC;QAAI,WAAW,IAAA,mJAAE,EAAC,2BAA2B;;0BAC5C,oNAAC;gBAAI,WAAU;0BACZ,kBAAkB,GAAG,CAAC,CAAC,sBACtB,oNAAC;wBAEC,WAAW,IAAA,mJAAE,EACX,wBACA,MAAM,MAAM,IAAI,eACZ,mBACA;uBALD,MAAM,MAAM;;;;;;;;;;0BAUvB,oNAAC;gBAAK,WAAU;0BAAiC;;;;;;;;;;;;AAGvD;MA3BgB"}},
    {"offset": {"line": 776, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/collapsible.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n"],"names":[],"mappings":";;;;;;;;AAGA;AAHA;;AAKA,MAAM,cAAc,yMAAyB;AAE7C,MAAM,qBAAqB,uNAAuC;AAElE,MAAM,qBAAqB,uNAAuC"}},
    {"offset": {"line": 798, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/data-room-viewer.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useMemo, useCallback } from 'react'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from '@/components/ui/collapsible'\nimport { cn } from '@/lib/utils'\nimport { toast } from 'sonner'\nimport {\n  ChevronDown,\n  ChevronRight,\n  Download,\n  ExternalLink,\n  File,\n  FileText,\n  FileSpreadsheet,\n  FileImage,\n  FileVideo,\n  Presentation,\n  Folder,\n  FolderOpen,\n  Star,\n  Lock,\n  Eye,\n  Loader2\n} from 'lucide-react'\n\nexport interface DataRoomDocument {\n  id: string\n  file_name: string\n  file_type: string\n  file_size: number\n  category: string\n  description: string | null\n  uploaded_at: string\n  is_featured: boolean\n  external_link: string | null\n  file_key: string | null\n}\n\ninterface DataRoomViewerProps {\n  documents: DataRoomDocument[]\n  hasAccess: boolean\n  requiresNda: boolean\n  dealId: string\n  onRequestAccess?: () => void\n}\n\n// File type icon mapping\nfunction getFileIcon(mimeType: string) {\n  if (mimeType.includes('pdf')) return FileText\n  if (mimeType.includes('spreadsheet') || mimeType.includes('excel') || mimeType.includes('csv')) return FileSpreadsheet\n  if (mimeType.includes('image')) return FileImage\n  if (mimeType.includes('video')) return FileVideo\n  if (mimeType.includes('presentation') || mimeType.includes('powerpoint')) return Presentation\n  if (mimeType.includes('word') || mimeType.includes('document')) return FileText\n  return File\n}\n\n// Format file size\nfunction formatFileSize(bytes: number): string {\n  if (bytes === 0) return '—'\n  const units = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(1024))\n  return `${(bytes / Math.pow(1024, i)).toFixed(i > 0 ? 1 : 0)} ${units[i]}`\n}\n\n// Format date\nfunction formatDate(dateString: string): string {\n  return new Date(dateString).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric'\n  })\n}\n\n// Check if file type supports preview\nfunction isPreviewableType(mimeType: string): boolean {\n  return (\n    mimeType.includes('pdf') ||\n    mimeType.includes('image') ||\n    mimeType.includes('text') ||\n    mimeType.includes('video')\n  )\n}\n\n// Document row component with download/preview functionality\nfunction DocumentRow({\n  document,\n  dealId,\n  hasAccess\n}: {\n  document: DataRoomDocument\n  dealId: string\n  hasAccess: boolean\n}) {\n  const [isDownloading, setIsDownloading] = useState(false)\n  const [isPreviewing, setIsPreviewing] = useState(false)\n  const FileIcon = getFileIcon(document.file_type)\n  const isExternal = !!document.external_link\n  const canPreview = isPreviewableType(document.file_type)\n\n  const handleDocumentAction = useCallback(async (mode: 'download' | 'preview') => {\n    if (isExternal && document.external_link) {\n      window.open(document.external_link, '_blank', 'noopener,noreferrer')\n      return\n    }\n\n    const isPreview = mode === 'preview'\n    if (isPreview) {\n      setIsPreviewing(true)\n    } else {\n      setIsDownloading(true)\n    }\n\n    try {\n      const response = await fetch(\n        `/api/deals/${dealId}/documents/${document.id}/download?mode=${mode}`\n      )\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}))\n        if (response.status === 401) {\n          toast.error('Please sign in to access documents')\n        } else if (response.status === 403) {\n          toast.error(errorData.error || 'Access denied to this document')\n        } else if (response.status === 404) {\n          toast.error('Document not found')\n        } else {\n          toast.error(errorData.error || 'Failed to access document')\n        }\n        return\n      }\n\n      const data = await response.json()\n      const url = data.download_url || data.url\n\n      if (!url) {\n        toast.error('Failed to generate document link')\n        return\n      }\n\n      // Open in new tab\n      window.open(url, '_blank', 'noopener,noreferrer')\n\n      // Show success toast with watermark info\n      if (data.watermark) {\n        toast.success(\n          isPreview ? 'Document opened for preview' : 'Download started',\n          {\n            description: `Link expires in ${Math.floor(data.expires_in_seconds / 60)} minutes`,\n            duration: 4000\n          }\n        )\n      } else {\n        toast.success(isPreview ? 'Document opened' : 'Download started')\n      }\n    } catch (error) {\n      console.error('Document action error:', error)\n      toast.error('Failed to access document. Please try again.')\n    } finally {\n      setIsDownloading(false)\n      setIsPreviewing(false)\n    }\n  }, [dealId, document.id, document.external_link, isExternal])\n\n  return (\n    <div className=\"flex items-center justify-between py-3 px-4 hover:bg-muted rounded-lg transition-colors group\">\n      <div className=\"flex items-center gap-3 min-w-0 flex-1\">\n        <div className=\"p-2 rounded-lg bg-muted text-muted-foreground\">\n          <FileIcon className=\"h-5 w-5\" />\n        </div>\n        <div className=\"min-w-0\">\n          <p className=\"font-medium text-foreground truncate\">\n            {document.file_name}\n          </p>\n          <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n            <span>{formatFileSize(document.file_size)}</span>\n            <span>•</span>\n            <span>{formatDate(document.uploaded_at)}</span>\n            {document.description && (\n              <>\n                <span>•</span>\n                <span className=\"truncate max-w-[200px]\">{document.description}</span>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {hasAccess && (\n        <div className=\"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n          {isExternal ? (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => handleDocumentAction('preview')}\n            >\n              <ExternalLink className=\"h-4 w-4 mr-1\" />\n              Open\n            </Button>\n          ) : (\n            <>\n              {/* Preview button for supported file types */}\n              {canPreview && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => handleDocumentAction('preview')}\n                  disabled={isPreviewing}\n                  className=\"text-blue-600 hover:text-blue-700 hover:bg-blue-50\"\n                >\n                  {isPreviewing ? (\n                    <Loader2 className=\"h-4 w-4 mr-1 animate-spin\" />\n                  ) : (\n                    <Eye className=\"h-4 w-4 mr-1\" />\n                  )}\n                  Preview\n                </Button>\n              )}\n              {/* Download button */}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handleDocumentAction('download')}\n                disabled={isDownloading}\n              >\n                {isDownloading ? (\n                  <Loader2 className=\"h-4 w-4 mr-1 animate-spin\" />\n                ) : (\n                  <Download className=\"h-4 w-4 mr-1\" />\n                )}\n                Download\n              </Button>\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\n// Folder section component\nfunction FolderSection({\n  folderName,\n  documents,\n  dealId,\n  hasAccess,\n  defaultOpen = false\n}: {\n  folderName: string\n  documents: DataRoomDocument[]\n  dealId: string\n  hasAccess: boolean\n  defaultOpen?: boolean\n}) {\n  const [isOpen, setIsOpen] = useState(defaultOpen)\n\n  return (\n    <Collapsible open={isOpen} onOpenChange={setIsOpen}>\n      <CollapsibleTrigger className=\"w-full\">\n        <div className=\"flex items-center justify-between py-3 px-4 hover:bg-muted rounded-lg transition-colors\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/30 text-blue-600\">\n              {isOpen ? <FolderOpen className=\"h-5 w-5\" /> : <Folder className=\"h-5 w-5\" />}\n            </div>\n            <span className=\"font-medium text-foreground\">{folderName}</span>\n            <Badge variant=\"secondary\" className=\"ml-2\">\n              {documents.length} {documents.length === 1 ? 'file' : 'files'}\n            </Badge>\n          </div>\n          {isOpen ? (\n            <ChevronDown className=\"h-5 w-5 text-muted-foreground\" />\n          ) : (\n            <ChevronRight className=\"h-5 w-5 text-muted-foreground\" />\n          )}\n        </div>\n      </CollapsibleTrigger>\n      <CollapsibleContent>\n        <div className=\"ml-6 pl-4 border-l-2 border-border space-y-1\">\n          {documents.map((doc) => (\n            <DocumentRow\n              key={doc.id}\n              document={doc}\n              dealId={dealId}\n              hasAccess={hasAccess}\n            />\n          ))}\n        </div>\n      </CollapsibleContent>\n    </Collapsible>\n  )\n}\n\nexport function DataRoomViewer({\n  documents,\n  hasAccess,\n  requiresNda,\n  dealId,\n  onRequestAccess\n}: DataRoomViewerProps) {\n  // Group documents by folder with featured section\n  const { featured, folders } = useMemo(() => {\n    const featured: DataRoomDocument[] = []\n    const folderMap: Record<string, DataRoomDocument[]> = {}\n\n    documents.forEach((doc) => {\n      if (doc.is_featured) {\n        featured.push(doc)\n      }\n\n      const folderName = doc.category || 'General'\n      if (!folderMap[folderName]) {\n        folderMap[folderName] = []\n      }\n      folderMap[folderName].push(doc)\n    })\n\n    // Sort folders alphabetically, but put \"General\" last\n    const sortedFolders: Record<string, DataRoomDocument[]> = {}\n    const keys = Object.keys(folderMap).sort((a, b) => {\n      if (a === 'General') return 1\n      if (b === 'General') return -1\n      return a.localeCompare(b)\n    })\n    keys.forEach((key) => {\n      sortedFolders[key] = folderMap[key]\n    })\n\n    return { featured, folders: sortedFolders }\n  }, [documents])\n\n  // No access state\n  if (!hasAccess) {\n    return (\n      <Card className=\"border-amber-200 bg-amber-50 dark:bg-amber-900/20\">\n        <CardContent className=\"py-8 text-center\">\n          <Lock className=\"h-12 w-12 mx-auto text-amber-500 mb-4\" />\n          <h3 className=\"text-lg font-semibold text-amber-800 dark:text-amber-200 mb-2\">\n            Data Room Access Required\n          </h3>\n          <p className=\"text-amber-700 dark:text-amber-300 mb-4 max-w-md mx-auto\">\n            {requiresNda\n              ? 'Sign the NDA to unlock access to the full data room with deal documents, financials, and more.'\n              : 'Express interest in this deal to unlock access to the data room.'}\n          </p>\n          {onRequestAccess && (\n            <Button onClick={onRequestAccess} className=\"bg-amber-600 hover:bg-amber-700\">\n              {requiresNda ? 'Sign NDA to Unlock' : 'Request Access'}\n            </Button>\n          )}\n        </CardContent>\n      </Card>\n    )\n  }\n\n  // Empty state\n  if (documents.length === 0) {\n    return (\n      <Card>\n        <CardContent className=\"py-8 text-center\">\n          <Folder className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n          <h3 className=\"text-lg font-semibold text-foreground mb-2\">\n            No Documents Available\n          </h3>\n          <p className=\"text-muted-foreground max-w-md mx-auto\">\n            Documents for this deal haven&apos;t been uploaded yet. Check back soon.\n          </p>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Featured Documents Section */}\n      {featured.length > 0 && (\n        <Card className=\"border-amber-200 bg-amber-50/50 dark:bg-amber-900/10\">\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-base flex items-center gap-2 text-amber-700 dark:text-amber-300\">\n              <Star className=\"h-5 w-5 fill-amber-400 text-amber-400\" />\n              Featured Documents\n            </CardTitle>\n            <CardDescription className=\"text-amber-600/80 dark:text-amber-400/80\">\n              Key documents highlighted by the deal team\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"pt-0 space-y-1\">\n            {featured.map((doc) => (\n              <DocumentRow\n                key={doc.id}\n                document={doc}\n                dealId={dealId}\n                hasAccess={hasAccess}\n              />\n            ))}\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Folders Section */}\n      <Card>\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-base flex items-center gap-2\">\n            <Eye className=\"h-5 w-5 text-blue-500\" />\n            Data Room\n          </CardTitle>\n          <CardDescription>\n            {documents.length} document{documents.length !== 1 ? 's' : ''} across {Object.keys(folders).length} folder{Object.keys(folders).length !== 1 ? 's' : ''}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"pt-0 space-y-1\">\n          {Object.entries(folders).map(([folderName, docs], index) => (\n            <FolderSection\n              key={folderName}\n              folderName={folderName}\n              documents={docs}\n              dealId={dealId}\n              hasAccess={hasAccess}\n              defaultOpen={index === 0} // Open first folder by default\n            />\n          ))}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1520, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/deal-timeline-card.tsx"],"sourcesContent":["'use client'\n\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Calendar, Clock, CheckCircle2, Circle, AlertTriangle } from 'lucide-react'\nimport { cn } from '@/lib/utils'\n\ninterface DealTimelineCardProps {\n  openAt: string | null\n  closeAt: string | null\n  interestDeadline?: string | null\n  settlementDate?: string | null\n}\n\ninterface TimelineMilestone {\n  label: string\n  date: string | null\n  status: 'past' | 'current' | 'future'\n}\n\nfunction formatDate(dateString: string | null): string {\n  if (!dateString) return 'TBD'\n  return new Date(dateString).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric'\n  })\n}\n\nfunction getDaysRemaining(dateString: string | null): number | null {\n  if (!dateString) return null\n  const target = new Date(dateString)\n  const now = new Date()\n  const diffTime = target.getTime() - now.getTime()\n  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24))\n  return diffDays\n}\n\nfunction getMilestoneStatus(dateString: string | null): 'past' | 'current' | 'future' {\n  if (!dateString) return 'future'\n  const date = new Date(dateString)\n  const now = new Date()\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate())\n  const targetDay = new Date(date.getFullYear(), date.getMonth(), date.getDate())\n\n  if (targetDay < today) return 'past'\n  if (targetDay.getTime() === today.getTime()) return 'current'\n  return 'future'\n}\n\nfunction MilestoneMarker({ status }: { status: 'past' | 'current' | 'future' }) {\n  if (status === 'past') {\n    return (\n      <div className=\"w-8 h-8 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center\">\n        <CheckCircle2 className=\"w-5 h-5 text-emerald-600\" />\n      </div>\n    )\n  }\n  if (status === 'current') {\n    return (\n      <div className=\"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center ring-2 ring-blue-500 ring-offset-2\">\n        <Circle className=\"w-5 h-5 text-blue-600 fill-blue-600\" />\n      </div>\n    )\n  }\n  return (\n    <div className=\"w-8 h-8 rounded-full bg-muted flex items-center justify-center\">\n      <Circle className=\"w-5 h-5 text-muted-foreground\" />\n    </div>\n  )\n}\n\nfunction TimelineConnector({ status }: { status: 'past' | 'current' | 'future' }) {\n  return (\n    <div\n      className={cn(\n        \"flex-1 h-1 rounded-full mx-2\",\n        status === 'past' && \"bg-emerald-400\",\n        status === 'current' && \"bg-gradient-to-r from-emerald-400 to-gray-300\",\n        status === 'future' && \"bg-muted\"\n      )}\n    />\n  )\n}\n\nexport function DealTimelineCard({\n  openAt,\n  closeAt,\n  interestDeadline,\n  settlementDate\n}: DealTimelineCardProps) {\n  const milestones: TimelineMilestone[] = [\n    { label: 'Deal Open', date: openAt, status: getMilestoneStatus(openAt) },\n    ...(interestDeadline ? [{ label: 'Interest Deadline', date: interestDeadline, status: getMilestoneStatus(interestDeadline) }] : []),\n    { label: 'Deal Close', date: closeAt, status: getMilestoneStatus(closeAt) },\n    ...(settlementDate ? [{ label: 'Settlement', date: settlementDate, status: getMilestoneStatus(settlementDate) }] : [])\n  ]\n\n  const daysToClose = getDaysRemaining(closeAt)\n  const isClosingSoon = daysToClose !== null && daysToClose > 0 && daysToClose <= 7\n  const isClosed = daysToClose !== null && daysToClose <= 0\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-base flex items-center gap-2\">\n            <Calendar className=\"h-5 w-5 text-blue-500\" />\n            Deal Timeline\n          </CardTitle>\n          {daysToClose !== null && !isClosed && (\n            <Badge variant={isClosingSoon ? \"destructive\" : \"secondary\"} className=\"flex items-center gap-1\">\n              {isClosingSoon && <AlertTriangle className=\"w-3 h-3\" />}\n              <Clock className=\"w-3 h-3\" />\n              {daysToClose} day{daysToClose !== 1 ? 's' : ''} remaining\n            </Badge>\n          )}\n          {isClosed && (\n            <Badge variant=\"secondary\" className=\"bg-muted\">\n              Closed\n            </Badge>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent>\n        {/* Desktop Timeline */}\n        <div className=\"hidden sm:block\">\n          <div className=\"flex items-center justify-between\">\n            {milestones.map((milestone, index) => (\n              <div key={milestone.label} className=\"flex items-center flex-1\">\n                <div className=\"flex flex-col items-center\">\n                  <MilestoneMarker status={milestone.status} />\n                  <div className=\"mt-2 text-center\">\n                    <p className={cn(\n                      \"text-xs font-medium\",\n                      milestone.status === 'past' && \"text-emerald-600\",\n                      milestone.status === 'current' && \"text-blue-600\",\n                      milestone.status === 'future' && \"text-muted-foreground\"\n                    )}>\n                      {milestone.label}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-0.5\">\n                      {formatDate(milestone.date)}\n                    </p>\n                  </div>\n                </div>\n                {index < milestones.length - 1 && (\n                  <TimelineConnector\n                    status={milestone.status === 'past' && milestones[index + 1]?.status === 'past'\n                      ? 'past'\n                      : milestone.status === 'past' && milestones[index + 1]?.status !== 'past'\n                        ? 'current'\n                        : 'future'\n                    }\n                  />\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Mobile Timeline (Vertical) */}\n        <div className=\"sm:hidden space-y-4\">\n          {milestones.map((milestone, index) => (\n            <div key={milestone.label} className=\"flex items-start gap-3\">\n              <div className=\"flex flex-col items-center\">\n                <MilestoneMarker status={milestone.status} />\n                {index < milestones.length - 1 && (\n                  <div className={cn(\n                    \"w-0.5 h-8 mt-2\",\n                    milestone.status === 'past' ? \"bg-emerald-400\" : \"bg-muted\"\n                  )} />\n                )}\n              </div>\n              <div className=\"pt-1\">\n                <p className={cn(\n                  \"text-sm font-medium\",\n                  milestone.status === 'past' && \"text-emerald-600\",\n                  milestone.status === 'current' && \"text-blue-600\",\n                  milestone.status === 'future' && \"text-muted-foreground\"\n                )}>\n                  {milestone.label}\n                </p>\n                <p className=\"text-xs text-muted-foreground\">\n                  {formatDate(milestone.date)}\n                </p>\n              </div>\n            </div>\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1888, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/deal-key-details-card.tsx"],"sourcesContent":["'use client'\n\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Briefcase,\n  DollarSign,\n  Tag,\n  Globe,\n  MapPin,\n  Building2,\n  TrendingUp,\n  Target,\n  Info\n} from 'lucide-react'\nimport { cn } from '@/lib/utils'\n\ninterface DealKeyDetailsCardProps {\n  dealType: string\n  currency: string\n  stockType: string | null\n  sector: string | null\n  location: string | null\n  vehicleName: string | null\n  stage: string | null\n  round: string | null\n}\n\ninterface DetailItem {\n  label: string\n  value: string | null\n  icon: typeof Briefcase\n  isBadge?: boolean\n  badgeVariant?: 'default' | 'secondary' | 'outline' | 'destructive'\n  badgeColor?: string\n}\n\nfunction formatValue(value: string | null): string {\n  if (!value) return '-'\n  // Replace underscores with spaces and capitalize\n  return value.replace(/_/g, ' ').replace(/\\b\\w/g, (c) => c.toUpperCase())\n}\n\nfunction DetailRow({ item }: { item: DetailItem }) {\n  const Icon = item.icon\n  const displayValue = formatValue(item.value)\n\n  return (\n    <div className=\"flex items-center gap-3 p-3 rounded-lg bg-muted/50\">\n      <div className=\"p-2 rounded-md bg-card shadow-sm\">\n        <Icon className=\"w-4 h-4 text-muted-foreground\" />\n      </div>\n      <div className=\"flex-1 min-w-0\">\n        <p className=\"text-xs text-muted-foreground\">{item.label}</p>\n        {item.isBadge && item.value ? (\n          <Badge\n            variant={item.badgeVariant || 'secondary'}\n            className={cn(\"mt-0.5\", item.badgeColor)}\n          >\n            {displayValue}\n          </Badge>\n        ) : (\n          <p className=\"text-sm font-medium truncate\">{displayValue}</p>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport function DealKeyDetailsCard({\n  dealType,\n  currency,\n  stockType,\n  sector,\n  location,\n  vehicleName,\n  stage,\n  round\n}: DealKeyDetailsCardProps) {\n  const details: DetailItem[] = [\n    {\n      label: 'Deal Type',\n      value: dealType,\n      icon: Briefcase,\n      isBadge: true,\n      badgeColor: 'bg-blue-100 text-blue-700 hover:bg-blue-100'\n    },\n    {\n      label: 'Stock Type',\n      value: stockType,\n      icon: Tag,\n      isBadge: true,\n      badgeColor: 'bg-purple-100 text-purple-700 hover:bg-purple-100'\n    },\n    {\n      label: 'Currency',\n      value: currency,\n      icon: DollarSign\n    },\n    {\n      label: 'Sector',\n      value: sector,\n      icon: Globe\n    },\n    {\n      label: 'Location',\n      value: location,\n      icon: MapPin\n    },\n    {\n      label: 'Vehicle',\n      value: vehicleName,\n      icon: Building2\n    },\n    {\n      label: 'Stage',\n      value: stage,\n      icon: TrendingUp\n    },\n    {\n      label: 'Round',\n      value: round,\n      icon: Target\n    }\n  ]\n\n  // Filter out items with no value (except Deal Type and Currency which are always shown)\n  const visibleDetails = details.filter(\n    (d) => d.value || d.label === 'Deal Type' || d.label === 'Currency'\n  )\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <CardTitle className=\"text-base flex items-center gap-2\">\n          <Info className=\"h-5 w-5 text-muted-foreground\" />\n          Key Details\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\n          {visibleDetails.map((item) => (\n            <DetailRow key={item.label} item={item} />\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAfA;;;;;;AAqCA,SAAS,YAAY,KAAoB;IACvC,IAAI,CAAC,OAAO,OAAO;IACnB,iDAAiD;IACjD,OAAO,MAAM,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,SAAS,CAAC,IAAM,EAAE,WAAW;AACvE;AAEA,SAAS,UAAU,EAAE,IAAI,EAAwB;IAC/C,MAAM,OAAO,KAAK,IAAI;IACtB,MAAM,eAAe,YAAY,KAAK,KAAK;IAE3C,qBACE,oNAAC;QAAI,WAAU;;0BACb,oNAAC;gBAAI,WAAU;0BACb,cAAA,oNAAC;oBAAK,WAAU;;;;;;;;;;;0BAElB,oNAAC;gBAAI,WAAU;;kCACb,oNAAC;wBAAE,WAAU;kCAAiC,KAAK,KAAK;;;;;;oBACvD,KAAK,OAAO,IAAI,KAAK,KAAK,iBACzB,oNAAC,oKAAK;wBACJ,SAAS,KAAK,YAAY,IAAI;wBAC9B,WAAW,IAAA,mJAAE,EAAC,UAAU,KAAK,UAAU;kCAEtC;;;;;6CAGH,oNAAC;wBAAE,WAAU;kCAAgC;;;;;;;;;;;;;;;;;;AAKvD;KAxBS;AA0BF,SAAS,mBAAmB,EACjC,QAAQ,EACR,QAAQ,EACR,SAAS,EACT,MAAM,EACN,QAAQ,EACR,WAAW,EACX,KAAK,EACL,KAAK,EACmB;IACxB,MAAM,UAAwB;QAC5B;YACE,OAAO;YACP,OAAO;YACP,MAAM,mPAAS;YACf,SAAS;YACT,YAAY;QACd;QACA;YACE,OAAO;YACP,OAAO;YACP,MAAM,iOAAG;YACT,SAAS;YACT,YAAY;QACd;QACA;YACE,OAAO;YACP,OAAO;YACP,MAAM,0PAAU;QAClB;QACA;YACE,OAAO;YACP,OAAO;YACP,MAAM,uOAAK;QACb;QACA;YACE,OAAO;YACP,OAAO;YACP,MAAM,8OAAM;QACd;QACA;YACE,OAAO;YACP,OAAO;YACP,MAAM,uPAAS;QACjB;QACA;YACE,OAAO;YACP,OAAO;YACP,MAAM,0PAAU;QAClB;QACA;YACE,OAAO;YACP,OAAO;YACP,MAAM,0OAAM;QACd;KACD;IAED,wFAAwF;IACxF,MAAM,iBAAiB,QAAQ,MAAM,CACnC,CAAC,IAAM,EAAE,KAAK,IAAI,EAAE,KAAK,KAAK,eAAe,EAAE,KAAK,KAAK;IAG3D,qBACE,oNAAC,kKAAI;;0BACH,oNAAC,wKAAU;gBAAC,WAAU;0BACpB,cAAA,oNAAC,uKAAS;oBAAC,WAAU;;sCACnB,oNAAC,oOAAI;4BAAC,WAAU;;;;;;wBAAkC;;;;;;;;;;;;0BAItD,oNAAC,yKAAW;0BACV,cAAA,oNAAC;oBAAI,WAAU;8BACZ,eAAe,GAAG,CAAC,CAAC,qBACnB,oNAAC;4BAA2B,MAAM;2BAAlB,KAAK,KAAK;;;;;;;;;;;;;;;;;;;;;AAMtC;MA/EgB"}},
    {"offset": {"line": 2090, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/progress.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,yBAAW,kMAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,oNAAC,sMAAsB;QACrB,KAAK;QACL,WAAW,IAAA,mJAAE,EACX,iEACA;QAED,GAAG,KAAK;kBAET,cAAA,oNAAC,2MAA2B;YAC1B,WAAU;YACV,OAAO;gBAAE,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;YAAC;;;;;;;;;;;;AAIhE,SAAS,WAAW,GAAG,sMAAsB,CAAC,WAAW"}},
    {"offset": {"line": 2135, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/interest-status-card.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Progress } from '@/components/ui/progress'\r\nimport {\r\n  Heart,\r\n  FileSignature,\r\n  FolderOpen,\r\n  Send,\r\n  CheckCircle2,\r\n  DollarSign,\r\n  Rocket,\r\n  ArrowRight,\r\n  Clock,\r\n  Sparkles\r\n} from 'lucide-react'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface InterestStatusCardProps {\r\n  currentStage: number\r\n  membership: {\r\n    interest_confirmed_at: string | null\r\n    nda_signed_at: string | null\r\n    data_room_granted_at: string | null\r\n  } | null\r\n  subscription: {\r\n    status: string\r\n    pack_sent_at: string | null\r\n    signed_at: string | null\r\n    funded_at: string | null\r\n  } | null\r\n  canExpressInterest: boolean\r\n  canSignNda: boolean\r\n  canSubscribe: boolean\r\n  isTrackingOnly: boolean\r\n  onExpressInterest: () => void\r\n  onSignNda: () => void\r\n  onSubscribe: () => void\r\n}\r\n\r\ninterface StageInfo {\r\n  label: string\r\n  description: string\r\n  icon: typeof Heart\r\n  color: string\r\n  bgColor: string\r\n}\r\n\r\nconst stageMetadata: Record<number, StageInfo> = {\r\n  0: {\r\n    label: 'New',\r\n    description: 'Choose to request a subscription or explore the data room first',\r\n    icon: Sparkles,\r\n    color: 'text-muted-foreground',\r\n    bgColor: 'bg-muted'\r\n  },\r\n  1: {\r\n    label: 'Received',\r\n    description: 'Deal dispatched to you',\r\n    icon: Send,\r\n    color: 'text-blue-600',\r\n    bgColor: 'bg-blue-100 dark:bg-blue-900/30'\r\n  },\r\n  2: {\r\n    label: 'Viewed',\r\n    description: 'You have viewed this deal',\r\n    icon: Clock,\r\n    color: 'text-blue-600',\r\n    bgColor: 'bg-blue-100 dark:bg-blue-900/30'\r\n  },\r\n  3: {\r\n    label: 'Interest Confirmed',\r\n    description: 'Next: Sign NDA to access documents',\r\n    icon: Heart,\r\n    color: 'text-pink-600',\r\n    bgColor: 'bg-pink-100 dark:bg-pink-900/30'\r\n  },\r\n  4: {\r\n    label: 'NDA Signed',\r\n    description: 'Access data room documents',\r\n    icon: FileSignature,\r\n    color: 'text-indigo-600',\r\n    bgColor: 'bg-indigo-100 dark:bg-indigo-900/30'\r\n  },\r\n  5: {\r\n    label: 'Data Room Access',\r\n    description: 'Review documents before subscribing',\r\n    icon: FolderOpen,\r\n    color: 'text-amber-600',\r\n    bgColor: 'bg-amber-100 dark:bg-amber-900/30'\r\n  },\r\n  6: {\r\n    label: 'Pack Generated',\r\n    description: 'Subscription documents prepared',\r\n    icon: CheckCircle2,\r\n    color: 'text-cyan-600',\r\n    bgColor: 'bg-cyan-100 dark:bg-cyan-900/30'\r\n  },\r\n  7: {\r\n    label: 'Pack Sent',\r\n    description: 'Awaiting your signature',\r\n    icon: Send,\r\n    color: 'text-violet-600',\r\n    bgColor: 'bg-violet-100 dark:bg-violet-900/30'\r\n  },\r\n  8: {\r\n    label: 'Signed',\r\n    description: 'Awaiting funding',\r\n    icon: FileSignature,\r\n    color: 'text-purple-600',\r\n    bgColor: 'bg-purple-100 dark:bg-purple-900/30'\r\n  },\r\n  9: {\r\n    label: 'Funded',\r\n    description: 'Awaiting activation',\r\n    icon: DollarSign,\r\n    color: 'text-emerald-600',\r\n    bgColor: 'bg-emerald-100 dark:bg-emerald-900/30'\r\n  },\r\n  10: {\r\n    label: 'Active',\r\n    description: 'Investment is active',\r\n    icon: Rocket,\r\n    color: 'text-green-600',\r\n    bgColor: 'bg-green-100 dark:bg-green-900/30'\r\n  }\r\n}\r\n\r\nfunction formatDate(dateString: string | null): string {\r\n  if (!dateString) return ''\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    month: 'short',\r\n    day: 'numeric',\r\n    year: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  })\r\n}\r\n\r\nfunction getLastAction(\r\n  membership: InterestStatusCardProps['membership'],\r\n  subscription: InterestStatusCardProps['subscription']\r\n): { action: string; timestamp: string } | null {\r\n  const actions: { action: string; timestamp: string | null }[] = [\r\n    { action: 'Investment activated', timestamp: subscription?.funded_at && subscription.status === 'active' ? subscription.funded_at : null },\r\n    { action: 'Funded', timestamp: subscription?.funded_at ?? null },\r\n    { action: 'Subscription signed', timestamp: subscription?.signed_at ?? null },\r\n    { action: 'Pack sent', timestamp: subscription?.pack_sent_at ?? null },\r\n    { action: 'Data room access granted', timestamp: membership?.data_room_granted_at ?? null },\r\n    { action: 'NDA signed', timestamp: membership?.nda_signed_at ?? null },\r\n    { action: 'Interest confirmed', timestamp: membership?.interest_confirmed_at ?? null }\r\n  ]\r\n\r\n  for (const item of actions) {\r\n    if (item.timestamp) {\r\n      return { action: item.action, timestamp: formatDate(item.timestamp) }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\nexport function InterestStatusCard({\r\n  currentStage,\r\n  membership,\r\n  subscription,\r\n  canExpressInterest,\r\n  canSignNda,\r\n  canSubscribe,\r\n  isTrackingOnly,\r\n  onExpressInterest,\r\n  onSignNda,\r\n  onSubscribe\r\n}: InterestStatusCardProps) {\r\n  const stageInfo = stageMetadata[currentStage] || stageMetadata[0]\r\n  const Icon = stageInfo.icon\r\n  const lastAction = getLastAction(membership, subscription)\r\n  const progressPercentage = (currentStage / 10) * 100\r\n\r\n  // Determine if we're in early stages where both options should be shown\r\n  const isEarlyStage = currentStage <= 2 && !subscription\r\n  const showTrackingNotice = isTrackingOnly\r\n  const showSubscribeOption = canSubscribe && !showTrackingNotice\r\n  const showExpressOption = canExpressInterest && !showTrackingNotice\r\n  const showEarlyStageActions = isEarlyStage && (showSubscribeOption || showExpressOption)\r\n\r\n  // Determine primary action based on stage\r\n  const primaryAction: { label: string; onClick: () => void; icon: typeof Heart } | null =\r\n    !showTrackingNotice && canSignNda\r\n      ? { label: 'Sign NDA', onClick: onSignNda, icon: FileSignature }\r\n      : !showTrackingNotice && canSubscribe\r\n        ? { label: 'Subscribe Now', onClick: onSubscribe, icon: Rocket }\r\n        : null\r\n\r\n  return (\r\n    <Card className=\"border-2 border-dashed border-border bg-gradient-to-br from-background to-muted\">\r\n      <CardHeader className=\"pb-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"text-base flex items-center gap-2\">\r\n            <Heart className=\"h-5 w-5 text-pink-500\" />\r\n            Your Interest Status\r\n          </CardTitle>\r\n          <Badge className={cn(stageInfo.bgColor, stageInfo.color, \"border-0\")}>\r\n            Stage {currentStage}/10\r\n          </Badge>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        {/* Current Status */}\r\n        <div className=\"flex items-start gap-4\">\r\n          <div className={cn(\"p-3 rounded-xl\", stageInfo.bgColor)}>\r\n            <Icon className={cn(\"w-6 h-6\", stageInfo.color)} />\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <h3 className={cn(\"font-semibold text-lg\", stageInfo.color)}>\r\n              {stageInfo.label}\r\n            </h3>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              {stageInfo.description}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress Bar */}\r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n            <span>Journey Progress</span>\r\n            <span>{currentStage}/10 stages</span>\r\n          </div>\r\n          <Progress value={progressPercentage} className=\"h-2\" />\r\n        </div>\r\n\r\n        {showTrackingNotice && (\r\n          <div className=\"rounded-lg border border-amber-200 bg-amber-50 p-3 text-amber-900 dark:border-amber-900/40 dark:bg-amber-900/20 dark:text-amber-200\">\r\n            <p className=\"text-sm font-medium\">Tracking Only Access</p>\r\n            <p className=\"text-xs text-amber-700 dark:text-amber-300\">\r\n              You can view this deal, but investment actions are disabled. Contact your relationship manager for investor access.\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Last Action */}\r\n        {lastAction && (\r\n          <div className=\"p-3 rounded-lg bg-muted text-sm\">\r\n            <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n              <Clock className=\"w-4 h-4\" />\r\n              <span className=\"font-medium\">{lastAction.action}</span>\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground mt-1 ml-6\">\r\n              {lastAction.timestamp}\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Two-Path Actions for Early Stages */}\r\n        {showEarlyStageActions && (\r\n          <div className=\"space-y-4\">\r\n            {/* Primary Path: Subscribe Directly */}\r\n            {showSubscribeOption && (\r\n              <button\r\n                onClick={onSubscribe}\r\n                className=\"w-full p-4 rounded-lg border-2 border-emerald-200 dark:border-emerald-800 bg-emerald-50 dark:bg-emerald-900/20 hover:border-emerald-400 dark:hover:border-emerald-600 transition-colors text-left group\"\r\n              >\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-emerald-600 text-white\">\r\n                    <Rocket className=\"w-5 h-5\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-semibold text-emerald-700 dark:text-emerald-300 flex items-center gap-2\">\r\n                      Subscribe to Investment\r\n                      <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\r\n                    </div>\r\n                    <div className=\"text-sm text-emerald-600 dark:text-emerald-400 mt-0.5\">\r\n                      Direct path • NDA + Subscription Pack\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </button>\r\n            )}\r\n\r\n            {/* OR Divider */}\r\n            {showSubscribeOption && showExpressOption && (\r\n              <div className=\"relative flex items-center\">\r\n                <div className=\"flex-1 h-px bg-border\" />\r\n                <span className=\"px-3 text-xs text-muted-foreground font-medium bg-background\">OR</span>\r\n                <div className=\"flex-1 h-px bg-border\" />\r\n              </div>\r\n            )}\r\n\r\n            {/* Secondary Path: Data Room */}\r\n            {showExpressOption && (\r\n              <button\r\n                onClick={onExpressInterest}\r\n                className=\"w-full p-4 rounded-lg border border-dashed border-border hover:border-amber-400 transition-colors text-left group\"\r\n              >\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-600\">\r\n                    <Heart className=\"w-5 h-5\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-medium text-foreground flex items-center gap-2\">\r\n                      Request Data Room Access\r\n                    </div>\r\n                    <div className=\"text-sm text-muted-foreground mt-0.5\">\r\n                      Review documents before committing\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Single Action Button for Later Stages */}\r\n        {!isEarlyStage && primaryAction && (\r\n          <Button\r\n            onClick={primaryAction.onClick}\r\n            className=\"w-full\"\r\n            size=\"lg\"\r\n          >\r\n            <primaryAction.icon className=\"w-4 h-4 mr-2\" />\r\n            {primaryAction.label}\r\n            <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n          </Button>\r\n        )}\r\n\r\n        {/* Completion Message for Active Investments */}\r\n        {currentStage === 10 && (\r\n          <div className=\"p-4 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 text-center\">\r\n            <CheckCircle2 className=\"w-8 h-8 mx-auto text-emerald-600 mb-2\" />\r\n            <p className=\"font-medium text-emerald-700 dark:text-emerald-300\">\r\n              Investment Active\r\n            </p>\r\n            <p className=\"text-sm text-emerald-600 dark:text-emerald-400\">\r\n              View in your Portfolio for NAV tracking\r\n            </p>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2764, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAIA,MAAM,yBAAW,kMAAgB,MAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,oNAAC;QACC,WAAW,IAAA,mJAAE,EACX,+RACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 2798, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/subscription-status-card.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle\n} from '@/components/ui/dialog'\nimport { Progress } from '@/components/ui/progress'\nimport { Textarea } from '@/components/ui/textarea'\nimport {\n  FileSignature,\n  FileText,\n  Download,\n  Clock,\n  CheckCircle2,\n  DollarSign,\n  Rocket,\n  Award,\n  ChevronDown,\n  ExternalLink,\n  Banknote,\n  MessageSquare\n} from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { toast } from 'sonner'\n\r\ninterface DocumentSignatory {\r\n  name: string\r\n  email: string\r\n  status: string\r\n  signed_at: string | null\r\n}\r\n\r\ninterface SubscriptionDocument {\r\n  status: string\r\n  signatories: DocumentSignatory[]\r\n  unsigned_url: string | null\r\n  signed_url: string | null\r\n}\r\n\r\ninterface SubscriptionStatusCardProps {\n  subscription: {\n    id: string\r\n    status: string\r\n    commitment: number | null\r\n    currency: string\r\n    funded_amount: number | null\r\n    pack_generated_at: string | null\r\n    pack_sent_at: string | null\r\n    signed_at: string | null\r\n    funded_at: string | null\r\n    activated_at: string | null\r\n    created_at: string | null\r\n    is_signed: boolean\r\n    is_funded: boolean\r\n    is_active: boolean\r\n    documents: {\r\n      nda: SubscriptionDocument\r\n      subscription_pack: SubscriptionDocument\r\n      certificate: {\r\n        status: string\r\n        url: string | null\r\n      } | null\r\n    } | null\r\n  }\n  dealCurrency?: string\n  dealId?: string\n  dealName?: string\n}\n\r\nfunction formatCurrency(amount: number | null, currency: string = 'USD'): string {\r\n  if (!amount) return '-'\r\n  return new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency,\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0\r\n  }).format(amount)\r\n}\r\n\r\nfunction formatDateShort(dateString: string | null): string {\r\n  if (!dateString) return ''\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    month: 'short',\r\n    day: 'numeric'\r\n  })\r\n}\r\n\r\nfunction getStatusConfig(status: string) {\r\n  switch (status) {\r\n    case 'active':\r\n      return { label: 'Active', color: 'text-emerald-600', bg: 'bg-emerald-100 dark:bg-emerald-900/30', icon: Rocket }\r\n    case 'committed':\r\n      return { label: 'Committed', color: 'text-blue-600', bg: 'bg-blue-100 dark:bg-blue-900/30', icon: CheckCircle2 }\r\n    case 'funded':\r\n      return { label: 'Funded', color: 'text-purple-600', bg: 'bg-purple-100 dark:bg-purple-900/30', icon: DollarSign }\r\n    case 'pending':\r\n    default:\r\n      return { label: 'Pending', color: 'text-amber-600', bg: 'bg-amber-100 dark:bg-amber-900/30', icon: Clock }\r\n  }\r\n}\r\n\r\n// Compact document row with expand/collapse\r\nfunction DocumentRow({\r\n  icon: Icon,\r\n  iconColor,\r\n  label,\r\n  doc\r\n}: {\r\n  icon: typeof FileText\r\n  iconColor: string\r\n  label: string\r\n  doc: SubscriptionDocument\r\n}) {\r\n  const [expanded, setExpanded] = useState(false)\r\n  const signedCount = doc.signatories.filter(s => s.status === 'signed').length\r\n  const totalCount = doc.signatories.length\r\n  const isComplete = doc.status === 'complete'\r\n  const hasUrl = doc.signed_url || doc.unsigned_url\r\n\r\n  return (\r\n    <div>\r\n      <button\r\n        type=\"button\"\r\n        className={cn(\r\n          \"w-full flex items-center gap-2.5 py-2 px-2.5 rounded-md text-left transition-colors\",\r\n          totalCount > 0 && \"hover:bg-muted/50 cursor-pointer\",\r\n          expanded && \"bg-muted/30\"\r\n        )}\r\n        onClick={() => totalCount > 0 && setExpanded(!expanded)}\r\n        disabled={totalCount === 0}\r\n      >\r\n        <Icon className={cn(\"w-4 h-4 shrink-0\", iconColor)} />\r\n        <span className=\"text-sm font-medium flex-1\">{label}</span>\r\n        <div className=\"flex items-center gap-1.5\">\r\n          {totalCount > 0 && (\r\n            <span className={cn(\"text-xs tabular-nums\", isComplete ? \"text-emerald-600\" : \"text-muted-foreground\")}>\r\n              {signedCount}/{totalCount}\r\n            </span>\r\n          )}\r\n          {isComplete ? (\r\n            <CheckCircle2 className=\"w-3.5 h-3.5 text-emerald-500\" />\r\n          ) : (\r\n            <Clock className=\"w-3.5 h-3.5 text-amber-500\" />\r\n          )}\r\n          {totalCount > 0 && (\r\n            <ChevronDown className={cn(\"w-3 h-3 text-muted-foreground transition-transform\", expanded && \"rotate-180\")} />\r\n          )}\r\n        </div>\r\n      </button>\r\n\r\n      {/* Expanded content */}\r\n      {expanded && (\r\n        <div className=\"ml-6 mr-2 mt-1 mb-1.5 space-y-1\">\r\n          {doc.signatories.map((sig, idx) => (\r\n            <div key={idx} className=\"flex items-center justify-between text-xs py-0.5 px-2 rounded bg-muted/40\">\r\n              <span className=\"text-muted-foreground truncate max-w-[120px]\">{sig.name}</span>\r\n              {sig.status === 'signed' ? (\r\n                <span className=\"text-emerald-600 flex items-center gap-1\">\r\n                  <CheckCircle2 className=\"w-2.5 h-2.5\" />\r\n                  {sig.signed_at ? formatDateShort(sig.signed_at) : 'Done'}\r\n                </span>\r\n              ) : (\r\n                <span className=\"text-amber-500 text-[10px]\">Pending</span>\r\n              )}\r\n            </div>\r\n          ))}\r\n          {hasUrl && (\r\n            <Button\r\n              size=\"sm\"\r\n              variant=\"ghost\"\r\n              className=\"h-5 text-[10px] px-2 mt-0.5\"\r\n              onClick={(e) => {\r\n                e.stopPropagation()\r\n                window.open(doc.signed_url || doc.unsigned_url!, '_blank')\r\n              }}\r\n            >\r\n              {doc.signed_url ? <Download className=\"w-2.5 h-2.5 mr-1\" /> : <ExternalLink className=\"w-2.5 h-2.5 mr-1\" />}\r\n              {doc.signed_url ? 'Download' : 'View'}\r\n            </Button>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function SubscriptionStatusCard({\n  subscription,\n  dealCurrency,\n  dealId,\n  dealName\n}: SubscriptionStatusCardProps) {\n  const statusConfig = getStatusConfig(subscription.status)\n  const StatusIcon = statusConfig.icon\n  const currency = subscription.currency || dealCurrency || 'USD'\n  const docs = subscription.documents\n  const [clarificationOpen, setClarificationOpen] = useState(false)\n  const [clarificationSubject, setClarificationSubject] = useState(\n    dealName ? `Subscription pack clarification - ${dealName}` : 'Subscription pack clarification'\n  )\n  const [clarificationDetails, setClarificationDetails] = useState('')\n  const [clarificationSubmitting, setClarificationSubmitting] = useState(false)\n\r\n  // Progress calculation\r\n  const steps = [\r\n    { key: 'generated', done: !!subscription.pack_generated_at },\r\n    { key: 'sent', done: !!subscription.pack_sent_at },\r\n    { key: 'signed', done: !!subscription.signed_at },\r\n    { key: 'funded', done: !!subscription.funded_at },\r\n    { key: 'active', done: !!subscription.activated_at }\r\n  ]\r\n  const completedSteps = steps.filter(s => s.done).length\r\n  const progressPercent = (completedSteps / steps.length) * 100\r\n\r\n  return (\r\n    <Card className=\"border-2 border-dashed border-gray-200 dark:border-gray-800 bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-gray-950\">\r\n      <CardHeader className=\"pb-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"text-base flex items-center gap-2\">\r\n            <Banknote className=\"h-5 w-5 text-emerald-500\" />\r\n            Your Subscription\r\n          </CardTitle>\r\n          <Badge className={cn(statusConfig.bg, statusConfig.color, \"border-0\")}>\r\n            <StatusIcon className=\"w-3 h-3 mr-1\" />\r\n            {statusConfig.label}\r\n          </Badge>\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"space-y-4\">\r\n        {/* Commitment - Compact inline display */}\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className={cn(\"p-2.5 rounded-xl\", statusConfig.bg)}>\r\n            <DollarSign className={cn(\"w-5 h-5\", statusConfig.color)} />\r\n          </div>\r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"text-xl font-bold tracking-tight\">\r\n              {formatCurrency(subscription.commitment, currency)}\r\n            </div>\r\n            {subscription.funded_amount !== null && subscription.funded_amount > 0 && (\r\n              <div className=\"text-xs text-muted-foreground\">\r\n                Funded: {formatCurrency(subscription.funded_amount, currency)}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress Bar */}\r\n        <div className=\"space-y-1.5\">\r\n          <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n            <span>Progress</span>\r\n            <span>{completedSteps}/{steps.length}</span>\r\n          </div>\r\n          <Progress value={progressPercent} className=\"h-1.5\" />\r\n        </div>\r\n\r\n        {/* Documents - Compact collapsible list */}\r\n        {docs && (\n          <div className=\"rounded-lg border divide-y bg-card/50\">\n            <DocumentRow icon={FileSignature} iconColor=\"text-blue-500\" label=\"NDA\" doc={docs.nda} />\n            <DocumentRow icon={FileText} iconColor=\"text-purple-500\" label=\"Subscription Pack\" doc={docs.subscription_pack} />\n            {(docs.certificate || subscription.is_active) && (\r\n              <div className=\"flex items-center gap-2.5 py-2 px-2.5\">\r\n                <Award className={cn(\"w-4 h-4\", docs.certificate?.status === 'available' ? \"text-amber-500\" : \"text-muted-foreground\")} />\r\n                <span className=\"text-sm font-medium flex-1\">Certificate</span>\r\n                {docs.certificate?.status === 'available' ? (\r\n                  <div className=\"flex items-center gap-1.5\">\r\n                    <CheckCircle2 className=\"w-3.5 h-3.5 text-emerald-500\" />\r\n                    {docs.certificate.url && (\r\n                      <Button size=\"sm\" variant=\"ghost\" className=\"h-5 px-1.5\" onClick={() => window.open(docs.certificate!.url!, '_blank')}>\r\n                        <Download className=\"w-3 h-3\" />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                ) : (\r\n                  <span className=\"text-xs text-muted-foreground\">Pending</span>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\n        )}\n\n        {/* Clarification request */}\n        <div className=\"pt-1\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            className=\"w-full\"\n            onClick={() => setClarificationOpen(true)}\n            disabled={!dealId}\n          >\n            <MessageSquare className=\"w-4 h-4 mr-2\" />\n            Request Clarification\n          </Button>\n        </div>\n\n        {/* Active banner */}\n        {subscription.is_active && (\n          <div className=\"flex items-center gap-2.5 p-2.5 rounded-lg bg-emerald-50 dark:bg-emerald-900/20\">\r\n            <Rocket className=\"w-4 h-4 text-emerald-600\" />\r\n            <div className=\"flex-1\">\r\n              <div className=\"text-sm font-medium text-emerald-700 dark:text-emerald-300\">Investment Active</div>\r\n              <div className=\"text-xs text-emerald-600 dark:text-emerald-400\">Track in Portfolio</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* No docs placeholder */}\r\n        {!docs && (\r\n          <div className=\"flex items-center gap-2.5 p-3 rounded-lg bg-muted/30 text-muted-foreground\">\r\n            <FileText className=\"w-4 h-4\" />\r\n            <span className=\"text-sm\">Documents being prepared...</span>\r\n          </div>\r\n        )}\r\n      </CardContent>\n\n      <Dialog open={clarificationOpen} onOpenChange={setClarificationOpen}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Request Clarification</DialogTitle>\n            <DialogDescription>\n              Submit questions or clarification requests about the subscription pack.\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Subject</label>\n              <Input\n                value={clarificationSubject}\n                onChange={(e) => setClarificationSubject(e.target.value)}\n                placeholder=\"Subscription pack clarification\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Details</label>\n              <Textarea\n                value={clarificationDetails}\n                onChange={(e) => setClarificationDetails(e.target.value)}\n                placeholder=\"Share the exact sections or questions you need clarified...\"\n                rows={5}\n              />\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setClarificationOpen(false)}\n              disabled={clarificationSubmitting}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={async () => {\n                if (!dealId) return\n                if (!clarificationSubject.trim()) {\n                  toast.error('Please enter a subject for your clarification request.')\n                  return\n                }\n                if (!clarificationDetails.trim()) {\n                  toast.error('Please include details for your clarification request.')\n                  return\n                }\n\n                try {\n                  setClarificationSubmitting(true)\n                  const response = await fetch('/api/requests', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                      category: 'communication',\n                      subject: clarificationSubject.trim(),\n                      details: clarificationDetails.trim(),\n                      dealId\n                    })\n                  })\n\n                  if (!response.ok) {\n                    const errorData = await response.json()\n                    throw new Error(errorData.error || 'Failed to submit clarification')\n                  }\n\n                  toast.success('Clarification request submitted.')\n                  setClarificationDetails('')\n                  setClarificationOpen(false)\n                } catch (error) {\n                  console.error('[SubscriptionStatusCard] Clarification error:', error)\n                  toast.error(error instanceof Error ? error.message : 'Failed to submit clarification')\n                } finally {\n                  setClarificationSubmitting(false)\n                }\n              }}\n              disabled={clarificationSubmitting}\n            >\n              {clarificationSubmitting ? 'Submitting...' : 'Submit'}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3616, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/documents/DocumentViewerFullscreen.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState, useMemo } from 'react'\r\nimport { createPortal } from 'react-dom'\r\nimport { X, Download, Loader2, AlertCircle, FileText } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { formatFileSize } from '@/lib/utils'\r\nimport { DocumentReference } from '@/types/document-viewer.types'\r\n\r\ninterface DocumentViewerFullscreenProps {\r\n  isOpen: boolean\r\n  document: DocumentReference | null\r\n  previewUrl: string | null\r\n  isLoading: boolean\r\n  error: string | null\r\n  onClose: () => void\r\n  onDownload: () => void\r\n}\r\n\r\n/**\r\n * Check if a file is a PDF based on filename or URL\r\n */\r\nfunction isPdfFile(fileName?: string | null, url?: string | null): boolean {\r\n  if (fileName?.toLowerCase().endsWith('.pdf')) return true\r\n  if (url?.toLowerCase().includes('.pdf')) return true\r\n  // Supabase signed URLs have the file path in them\r\n  if (url?.includes('deal-documents') && url?.includes('.pdf')) return true\r\n  return false\r\n}\r\n\r\n/**\r\n * Append PDF viewer parameters to URL to fix browser rendering issues\r\n * - navpanes=0: Hide thumbnail sidebar (fixes Brave issue)\r\n * - view=FitH: Fit to width for better viewing\r\n * - pagemode=none: Don't show bookmarks/thumbnails\r\n */\r\nfunction getPdfViewerUrl(url: string): string {\r\n  // Don't add hash if URL already has one\r\n  if (url.includes('#')) return url\r\n  return `${url}#navpanes=0&view=FitH&pagemode=none`\r\n}\r\n\r\nexport function DocumentViewerFullscreen({\r\n  isOpen,\r\n  document,\r\n  previewUrl,\r\n  isLoading,\r\n  error,\r\n  onClose,\r\n  onDownload,\r\n}: DocumentViewerFullscreenProps) {\r\n  const [iframeError, setIframeError] = useState(false)\r\n  const [mounted, setMounted] = useState(false)\r\n\r\n  // Track mount state for portal rendering\r\n  useEffect(() => {\r\n    setMounted(true)\r\n    return () => setMounted(false)\r\n  }, [])\r\n\r\n  // Compute the final iframe URL with PDF parameters if needed\r\n  const iframeSrc = useMemo(() => {\r\n    if (!previewUrl) return null\r\n    const fileName = document?.file_name || document?.name\r\n    if (isPdfFile(fileName, previewUrl)) {\r\n      return getPdfViewerUrl(previewUrl)\r\n    }\r\n    return previewUrl\r\n  }, [previewUrl, document])\r\n\r\n  // Handle ESC key to close\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onClose()\r\n      }\r\n      if (e.ctrlKey && e.key === 'd') {\r\n        e.preventDefault()\r\n        onDownload()\r\n      }\r\n    }\r\n\r\n    if (isOpen && typeof window !== 'undefined') {\r\n      window.addEventListener('keydown', handleKeyDown)\r\n      // Prevent body scroll when viewer is open\r\n      if (window.document?.body) {\r\n        window.document.body.style.overflow = 'hidden'\r\n      }\r\n\r\n      return () => {\r\n        window.removeEventListener('keydown', handleKeyDown)\r\n        if (window.document?.body) {\r\n          window.document.body.style.overflow = ''\r\n        }\r\n      }\r\n    }\r\n  }, [isOpen, onClose, onDownload])\r\n\r\n  // Reset iframe error when URL changes\r\n  useEffect(() => {\r\n    setIframeError(false)\r\n  }, [previewUrl])\r\n\r\n  // Don't render until mounted (for portal) or if not open\r\n  if (!isOpen || !mounted) return null\r\n\r\n  // Use portal to render at body level, escaping backdrop-blur containing blocks\r\n  const modalContent = (\r\n    <div className=\"fixed inset-0 z-[9999] bg-black/95 overflow-hidden\">\r\n      {/* Toolbar */}\r\n      <div className=\"h-16 bg-white border-b shadow-md flex items-center justify-between px-6\">\r\n        <div className=\"flex items-center gap-4 flex-1 min-w-0\">\r\n          <FileText className=\"h-5 w-5 text-gray-500 flex-shrink-0\" />\r\n          <div className=\"min-w-0 flex-1\">\r\n            <h2 className=\"text-lg font-semibold text-gray-900 truncate\">\r\n              {document?.file_name || document?.name || 'Document Preview'}\r\n            </h2>\r\n            <div className=\"flex items-center gap-3 text-sm text-gray-500\">\r\n              {document?.type && (\r\n                <span className=\"capitalize\">{document.type}</span>\r\n              )}\r\n              {document?.file_size_bytes && (\r\n                <>\r\n                  <span>•</span>\r\n                  <span>{formatFileSize(document.file_size_bytes)}</span>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={onDownload}\r\n            className=\"gap-2\"\r\n          >\r\n            <Download className=\"h-4 w-4\" />\r\n            Download\r\n          </Button>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={onClose}\r\n            className=\"gap-2\"\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n            Close\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main viewport */}\r\n      <div className=\"h-[calc(100vh-4rem)] bg-gray-900\">\r\n        {/* Loading/error states need centering */}\r\n        {(isLoading || error || iframeError) && (\r\n          <div className=\"w-full h-full flex items-center justify-center\">\r\n            {isLoading && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white\">\r\n                <Loader2 className=\"h-12 w-12 animate-spin\" />\r\n                <p className=\"text-lg\">Loading document...</p>\r\n              </div>\r\n            )}\r\n\r\n            {error && !isLoading && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white max-w-md mx-auto px-4\">\r\n                <AlertCircle className=\"h-16 w-16 text-red-400\" />\r\n                <h3 className=\"text-xl font-semibold\">Failed to Load Preview</h3>\r\n                <p className=\"text-gray-300 text-center\">{error}</p>\r\n                <Button\r\n                  onClick={onDownload}\r\n                  variant=\"secondary\"\r\n                  className=\"gap-2 mt-4\"\r\n                >\r\n                  <Download className=\"h-4 w-4\" />\r\n                  Download Instead\r\n                </Button>\r\n              </div>\r\n            )}\r\n\r\n            {iframeError && !isLoading && !error && (\r\n              <div className=\"flex flex-col items-center gap-4 text-white max-w-md mx-auto px-4\">\r\n                <AlertCircle className=\"h-16 w-16 text-red-400\" />\r\n                <h3 className=\"text-xl font-semibold\">Preview Unavailable</h3>\r\n                <p className=\"text-gray-300 text-center\">\r\n                  This document cannot be previewed in your browser.\r\n                </p>\r\n                <Button\r\n                  onClick={onDownload}\r\n                  variant=\"secondary\"\r\n                  className=\"gap-2 mt-4\"\r\n                >\r\n                  <Download className=\"h-4 w-4\" />\r\n                  Download to View\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Iframe fills the entire viewport when ready */}\r\n        {iframeSrc && !isLoading && !error && !iframeError && (\r\n          <iframe\r\n            src={iframeSrc}\r\n            className=\"w-full h-full border-0\"\r\n            title=\"Document Preview\"\r\n            onError={() => {\r\n              console.error('iframe failed to load preview')\r\n              setIframeError(true)\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer hint */}\r\n      {!isLoading && !error && (\r\n        <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 text-white/60 text-sm bg-black/50 px-4 py-2 rounded-full\">\r\n          Press <kbd className=\"px-2 py-1 bg-white/10 rounded mx-1\">ESC</kbd> to close\r\n          or <kbd className=\"px-2 py-1 bg-white/10 rounded mx-1\">Ctrl+D</kbd> to download\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  // Render portal to document.body to escape backdrop-blur containing blocks\r\n  const portalTarget = typeof window !== 'undefined' ? window.document.body : null\r\n  if (!portalTarget) return null\r\n  return createPortal(modalContent, portalTarget)\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4066, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/commercial-partner/index.ts"],"sourcesContent":["export { ProxyModeProvider, useProxyMode } from './proxy-mode-context'\nexport { ProxyModeBanner } from './proxy-mode-banner'\n"],"names":[],"mappings":";AAAA;AACA"}},
    {"offset": {"line": 4078, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28main%29/versotech_main/opportunities/%5Bid%5D/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { useParams, useRouter, useSearchParams } from 'next/navigation'\r\nimport Image from 'next/image'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Skeleton } from '@/components/ui/skeleton'\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport {\r\n  Accordion,\r\n  AccordionContent,\r\n  AccordionItem,\r\n  AccordionTrigger,\r\n} from '@/components/ui/accordion'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { InvestorJourneyBar } from '@/components/deals/investor-journey-bar'\r\nimport { DataRoomViewer, type DataRoomDocument } from '@/components/deals/data-room-viewer'\r\nimport { DealTimelineCard } from '@/components/deals/deal-timeline-card'\r\nimport { DealKeyDetailsCard } from '@/components/deals/deal-key-details-card'\r\nimport { InterestStatusCard } from '@/components/deals/interest-status-card'\r\nimport { SubscriptionStatusCard } from '@/components/deals/subscription-status-card'\r\nimport {\r\n  ArrowLeft,\r\n  Building2,\r\n  TrendingUp,\r\n  MapPin,\r\n  Globe,\r\n  FileText,\r\n  Download,\r\n  Eye,\r\n  Lock,\r\n  CheckCircle2,\r\n  Clock,\r\n  AlertCircle,\r\n  FileSignature,\r\n  Users,\r\n  ExternalLink,\r\n  HelpCircle,\r\n  MessageSquare,\r\n  Tag,\r\n  FolderOpen,\r\n  Loader2\r\n} from 'lucide-react'\r\nimport { DocumentViewerFullscreen } from '@/components/documents/DocumentViewerFullscreen'\r\nimport type { DocumentReference } from '@/types/document-viewer.types'\r\nimport { usePersona } from '@/contexts/persona-context'\r\nimport { useProxyMode } from '@/components/commercial-partner'\r\n\r\ninterface Document {\r\n  id: string\r\n  file_name: string\r\n  file_type: string\r\n  file_size: number\r\n  category: string\r\n  description: string | null\r\n  uploaded_at: string\r\n  is_featured: boolean\r\n  external_link: string | null\r\n  file_key: string | null\r\n}\r\n\r\ninterface FeeStructure {\r\n  id: string\r\n  status: string\r\n  version: number\r\n  // Opportunity Summary\r\n  opportunity_summary: string | null\r\n  term_sheet_html: string | null\r\n  // Transaction Details\r\n  transaction_type: string | null\r\n  issuer: string | null\r\n  vehicle: string | null\r\n  exclusive_arranger: string | null\r\n  purchaser: string | null\r\n  seller: string | null\r\n  structure: string | null\r\n  // Investment Terms\r\n  allocation_up_to: number | null\r\n  price_per_share_text: string | null\r\n  minimum_ticket: number | null\r\n  // Fee Structure\r\n  subscription_fee_percent: number | null\r\n  management_fee_percent: number | null\r\n  carried_interest_percent: number | null\r\n  management_fee_clause: string | null\r\n  performance_fee_clause: string | null\r\n  // Timeline\r\n  term_sheet_date: string | null\r\n  interest_confirmation_deadline: string | null\r\n  validity_date: string | null\r\n  completion_date: string | null\r\n  completion_date_text: string | null\r\n  // Legal\r\n  legal_counsel: string | null\r\n  // Attachment\r\n  term_sheet_attachment_key: string | null\r\n}\r\n\r\ninterface FAQ {\r\n  id: string\r\n  question: string\r\n  answer: string\r\n  display_order: number\r\n}\r\n\r\ninterface Signatory {\r\n  id: string\r\n  full_name: string\r\n  email: string\r\n  role: string\r\n}\r\n\r\ninterface Opportunity {\r\n  id: string\r\n  name: string\r\n  description: string | null\r\n  investment_thesis: string | null\r\n  status: string\r\n  deal_type: string | null\r\n  currency: string\r\n  minimum_investment: number | null\r\n  maximum_investment: number | null\r\n  target_amount: number | null\r\n  raised_amount: number | null\r\n  offer_unit_price: number | null\r\n  open_at: string | null\r\n  close_at: string | null\r\n  company_name: string | null\r\n  company_logo_url: string | null\r\n  company_website: string | null\r\n  sector: string | null\r\n  stage: string | null\r\n  location: string | null\r\n  stock_type: string | null\r\n  deal_round: string | null\r\n  vehicle: {\r\n    id: string\r\n    name: string\r\n    type: string\r\n  } | null\r\n  has_membership: boolean\r\n  membership: {\r\n    role: string\r\n    dispatched_at: string | null\r\n    viewed_at: string | null\r\n    interest_confirmed_at: string | null\r\n    nda_signed_at: string | null\r\n    data_room_granted_at: string | null\r\n  } | null\r\n  journey: {\r\n    current_stage: number\r\n    stages: any[]\r\n    summary: {\r\n      received: string | null\r\n      viewed: string | null\r\n      interest_confirmed: string | null\r\n      nda_signed: string | null\r\n      data_room_access: string | null\r\n      pack_generated: string | null\r\n      pack_sent: string | null\r\n      signed: string | null\r\n      funded: string | null\r\n      active: string | null\r\n    }\r\n  }\r\n  data_room: {\r\n    has_access: boolean\r\n    access_details: {\r\n      granted_at: string\r\n      expires_at: string | null\r\n      auto_granted: boolean\r\n    } | null\r\n    documents: Document[]\r\n    requires_nda: boolean\r\n  }\r\n  subscription: {\r\n    id: string\r\n    status: string\r\n    commitment: number | null\r\n    currency: string\r\n    funded_amount: number | null\r\n    pack_generated_at: string | null\r\n    pack_sent_at: string | null\r\n    signed_at: string | null\r\n    funded_at: string | null\r\n    activated_at: string | null\r\n    created_at: string | null\r\n    is_signed: boolean\r\n    is_funded: boolean\r\n    is_active: boolean\r\n    documents: {\r\n      nda: {\r\n        status: string\r\n        signatories: Array<{\r\n          name: string\r\n          email: string\r\n          status: string\r\n          signed_at: string | null\r\n        }>\r\n        unsigned_url: string | null\r\n        signed_url: string | null\r\n      }\r\n      subscription_pack: {\r\n        status: string\r\n        signatories: Array<{\r\n          name: string\r\n          email: string\r\n          status: string\r\n          signed_at: string | null\r\n        }>\r\n        unsigned_url: string | null\r\n        signed_url: string | null\r\n      }\r\n      certificate: {\r\n        status: string\r\n        url: string | null\r\n      } | null\r\n    } | null\r\n  } | null\r\n  subscription_submission?: {\r\n    id: string\r\n    status: string\r\n    submitted_at: string | null\r\n  } | null\r\n  fee_structures: FeeStructure[]\r\n  faqs: FAQ[]\r\n  signatories: Signatory[]\r\n  can_express_interest: boolean\r\n  can_sign_nda: boolean\r\n  can_access_data_room: boolean\r\n  can_subscribe: boolean\r\n  can_sign_subscription: boolean\r\n  is_tracking_only?: boolean\r\n  // PERSONA-BASED ACCESS CONTROLS (per Fred's meeting requirements)\r\n  access_controls?: {\r\n    can_view_term_sheet: boolean\r\n    can_view_data_room: boolean\r\n    has_auto_data_room_access: boolean\r\n    restriction_reason: string | null\r\n  }\r\n}\r\n\r\nfunction formatCurrency(amount: number | null, currency: string = 'USD'): string {\r\n  if (!amount) return '-'\r\n  return new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency,\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0\r\n  }).format(amount)\r\n}\r\n\r\nfunction formatDate(dateString: string | null): string {\r\n  if (!dateString) return '-'\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    month: 'short',\r\n    day: 'numeric',\r\n    year: 'numeric'\r\n  })\r\n}\r\n\r\nfunction formatFileSize(bytes: number): string {\r\n  if (bytes < 1024) return `${bytes} B`\r\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`\r\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`\r\n}\r\n\r\nexport default function OpportunityDetailPage() {\r\n  const params = useParams()\r\n  const router = useRouter()\r\n  const searchParams = useSearchParams()\r\n  const dealId = params.id as string\r\n  const actionParam = searchParams.get('action')\r\n  const fromParam = searchParams.get('from') // Track where user came from\r\n\r\n  const { hasAnyPersona, isLoading: personaLoading, activePersona, error: personaError } = usePersona()\r\n  const [opportunity, setOpportunity] = useState<Opportunity | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n\r\n  // Dialog states\r\n  const [showInterestDialog, setShowInterestDialog] = useState(false)\r\n  const [showNdaDialog, setShowNdaDialog] = useState(false)\r\n  const [showSubscribeDialog, setShowSubscribeDialog] = useState(false)\r\n  const [subscribeAmount, setSubscribeAmount] = useState('')\r\n  const [actionLoading, setActionLoading] = useState(false)\r\n  const isPartnerPersona = activePersona?.persona_type === 'partner'\r\n\r\n  // Term sheet preview state\r\n  const [previewOpen, setPreviewOpen] = useState(false)\r\n  const [previewLoading, setPreviewLoading] = useState(false)\r\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null)\r\n  const [previewError, setPreviewError] = useState<string | null>(null)\r\n  const [previewDocument, setPreviewDocument] = useState<DocumentReference | null>(null)\r\n  const { isProxyMode, selectedClient } = useProxyMode()\r\n\r\n  useEffect(() => {\r\n    // CRITICAL: AbortController prevents race conditions when navigating between deals\r\n    // Without this, if you navigate A→B quickly, fetch A might complete AFTER fetch B\r\n    // and overwrite the correct data with stale data\r\n    const abortController = new AbortController()\r\n    let isCancelled = false\r\n\r\n    // Reset state when dealId changes\r\n    setOpportunity(null)\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    async function fetchOpportunity() {\r\n      try {\r\n        console.log(`[OpportunityDetail] Starting fetch for dealId: ${dealId}`)\r\n\r\n        // Record view (fire and forget, don't block on this)\r\n        fetch(`/api/investors/me/opportunities/${dealId}`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ action: 'view' }),\r\n          cache: 'no-store'\r\n        }).catch(() => {}) // Ignore errors from view recording\r\n\r\n        // Fetch opportunity data with abort signal\r\n        const timestamp = Date.now()\r\n        const proxyParam = isProxyMode && selectedClient?.id\r\n          ? `&client_investor_id=${selectedClient.id}`\r\n          : ''\r\n        const response = await fetch(`/api/investors/me/opportunities/${dealId}?_t=${timestamp}${proxyParam}`, {\r\n          cache: 'no-store',\r\n          signal: abortController.signal,\r\n          headers: {\r\n            'Cache-Control': 'no-cache, no-store, must-revalidate',\r\n            'Pragma': 'no-cache'\r\n          }\r\n        })\r\n\r\n        // Check if this request was cancelled (user navigated away)\r\n        if (isCancelled) {\r\n          console.log(`[OpportunityDetail] Fetch for ${dealId} was cancelled (user navigated away)`)\r\n          return\r\n        }\r\n\r\n        const data = await response.json()\r\n        if (!response.ok) {\r\n          throw new Error(data.error || `Failed to fetch opportunity (${response.status})`)\r\n        }\r\n\r\n        // Double-check we're still on the same deal before setting state\r\n        if (isCancelled) {\r\n          console.log(`[OpportunityDetail] Ignoring response for ${dealId} - request was cancelled`)\r\n          return\r\n        }\r\n\r\n        console.log(`[OpportunityDetail] ✅ Setting state for: \"${data.opportunity?.name}\" (ID: ${data.opportunity?.id})`)\r\n\r\n        if (data.opportunity?.id !== dealId) {\r\n          console.error(`[OpportunityDetail] ⚠️ MISMATCH! URL has ${dealId} but API returned ${data.opportunity?.id}`)\r\n        }\r\n\r\n        setOpportunity(data.opportunity)\r\n        const trackingOnlyForPersona = data.opportunity.is_tracking_only || (isPartnerPersona && !data.opportunity.membership?.role)\r\n\r\n        if (actionParam === 'subscribe' && data.opportunity.can_subscribe && !trackingOnlyForPersona) {\r\n          setShowSubscribeDialog(true)\r\n        }\r\n      } catch (err: any) {\r\n        if (err.name === 'AbortError') {\r\n          console.log(`[OpportunityDetail] Fetch aborted for ${dealId}`)\r\n          return\r\n        }\r\n        if (!isCancelled) {\r\n          console.error('Error fetching opportunity:', err)\r\n          setError('Failed to load opportunity details')\r\n        }\r\n      } finally {\r\n        if (!isCancelled) {\r\n          setLoading(false)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (hasAnyPersona && dealId) {\r\n      fetchOpportunity()\r\n    }\r\n\r\n    // Cleanup: Cancel any in-flight requests when dealId changes or component unmounts\r\n    return () => {\r\n      console.log(`[OpportunityDetail] Cleanup: Cancelling fetch for ${dealId}`)\r\n      isCancelled = true\r\n      abortController.abort()\r\n    }\r\n  }, [hasAnyPersona, dealId, actionParam, isPartnerPersona, isProxyMode, selectedClient?.id])\r\n\r\n  const handleExpressInterest = async () => {\r\n    try {\r\n      setActionLoading(true)\r\n      const response = await fetch(`/api/deals/${dealId}/interests`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({})\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const err = await response.json().catch(() => ({}))\r\n        throw new Error(err.error || 'Failed to submit interest')\r\n      }\r\n\r\n      // Refresh data\r\n      const proxyParam = isProxyMode && selectedClient?.id\r\n        ? `?client_investor_id=${selectedClient.id}`\r\n        : ''\r\n      const refreshResponse = await fetch(`/api/investors/me/opportunities/${dealId}${proxyParam}`)\r\n      const data = await refreshResponse.json()\r\n      setOpportunity(data.opportunity)\r\n      setShowInterestDialog(false)\r\n    } catch (err) {\r\n      console.error('Error expressing interest:', err)\r\n    } finally {\r\n      setActionLoading(false)\r\n    }\r\n  }\r\n\r\n  // NDA signing is now handled automatically after CEO approval\r\n  // This function has been removed - NDA documents are generated and sent\r\n  // via the approval workflow, not triggered directly by investors\r\n\r\n  const handleSubscribe = async () => {\r\n    if (!subscribeAmount || !opportunity) return\r\n\r\n    try {\r\n      setActionLoading(true)\r\n\r\n      let response: Response\r\n      if (isProxyMode && selectedClient?.id) {\r\n        response = await fetch('/api/commercial-partners/proxy-subscribe', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            deal_id: dealId,\r\n            client_investor_id: selectedClient.id,\r\n            commitment: parseFloat(subscribeAmount),\r\n            stock_type: opportunity.stock_type || 'common',\r\n            notes: `Submitted in proxy mode by commercial partner`\r\n          })\r\n        })\r\n      } else {\r\n        // Submit subscription for review (creates CEO approval)\r\n        response = await fetch(`/api/deals/${dealId}/subscriptions`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            payload: {\r\n              amount: parseFloat(subscribeAmount),\r\n              currency: opportunity.currency,\r\n              bank_confirmation: false\r\n            },\r\n            subscription_type: 'personal'\r\n          })\r\n        })\r\n      }\r\n\r\n      if (!response.ok) {\r\n        const err = await response.json()\r\n        throw new Error(err.error || 'Failed to submit subscription')\r\n      }\r\n\r\n      await response.json()\r\n\r\n      // Refresh data\r\n      const proxyParam = isProxyMode && selectedClient?.id\r\n        ? `?client_investor_id=${selectedClient.id}`\r\n        : ''\r\n      const refreshResponse = await fetch(`/api/investors/me/opportunities/${dealId}${proxyParam}`)\r\n      const data = await refreshResponse.json()\r\n      setOpportunity(data.opportunity)\r\n      setShowSubscribeDialog(false)\r\n      setSubscribeAmount('')\r\n\r\n      alert('Subscription submitted for review. The VERSO team will follow up shortly.')\r\n    } catch (err: any) {\r\n      console.error('Error subscribing:', err)\r\n      alert(err.message || 'Failed to submit subscription')\r\n    } finally {\r\n      setActionLoading(false)\r\n    }\r\n  }\r\n\r\n\r\n  // Show loading while persona context is initializing\r\n  if (personaLoading) {\r\n    return (\r\n      <div className=\"p-6 space-y-6\">\r\n        <Skeleton className=\"h-8 w-48\" />\r\n        <Skeleton className=\"h-24 w-full\" />\r\n        <Skeleton className=\"h-64 w-full\" />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (!hasAnyPersona) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <Card className=\"max-w-lg mx-auto\">\r\n          <CardHeader>\r\n            <CardTitle>Access Required</CardTitle>\r\n            <CardDescription>\r\n              You need to be associated with an entity to view this opportunity.\r\n            </CardDescription>\r\n          </CardHeader>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-6 space-y-6\">\r\n        <Skeleton className=\"h-8 w-48\" />\r\n        <Skeleton className=\"h-24 w-full\" />\r\n        <Skeleton className=\"h-64 w-full\" />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error || !opportunity) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <Card className=\"max-w-lg mx-auto\">\r\n          <CardHeader>\r\n            <CardTitle>Error</CardTitle>\r\n            <CardDescription>{error || 'Opportunity not found'}</CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Button onClick={() => router.push(\r\n              fromParam === 'introductions'\r\n                ? '/versotech_main/introductions'\r\n                : '/versotech_main/opportunities'\r\n            )}>\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n              {fromParam === 'introductions' ? 'Back to Introductions' : 'Back to Opportunities'}\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const isTrackingOnly = !!opportunity.is_tracking_only || (isPartnerPersona && !opportunity.membership?.role)\r\n  const canSubscribe = opportunity.can_subscribe && !isTrackingOnly\r\n  const canExpressInterest = opportunity.can_express_interest && !isTrackingOnly\r\n  const canSignNda = opportunity.can_sign_nda && !isTrackingOnly\r\n  const showActionChoices =\r\n    opportunity.status !== 'closed' &&\r\n    !opportunity.subscription &&\r\n    (canSubscribe || canExpressInterest)\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      {/* Back button - context-aware navigation */}\r\n      <Button\r\n        variant=\"ghost\"\r\n        onClick={() => {\r\n          // If user came from introductions, go back there specifically\r\n          if (fromParam === 'introductions') {\r\n            router.push('/versotech_main/introductions')\r\n          } else {\r\n            router.back()\r\n          }\r\n        }}\r\n      >\r\n        <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n        {fromParam === 'introductions' ? 'Back to Introductions' : 'Back'}\r\n      </Button>\r\n\r\n      {/* Journey Progress Bar */}\r\n      {!isTrackingOnly ? (\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Investment Journey</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <InvestorJourneyBar\r\n              summary={opportunity.journey.summary}\r\n              currentStage={opportunity.journey.current_stage}\r\n            />\r\n          </CardContent>\r\n        </Card>\r\n      ) : (\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Tracking Access</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"flex items-start gap-3 text-sm text-muted-foreground\">\r\n              <AlertCircle className=\"h-4 w-4 mt-0.5\" />\r\n              <span>\r\n                This deal is available for tracking only. Contact your relationship manager for investor access.\r\n              </span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Deal Timeline */}\r\n      <DealTimelineCard\r\n        openAt={opportunity.open_at}\r\n        closeAt={opportunity.close_at}\r\n      />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex items-start gap-6\">\r\n        {opportunity.company_logo_url ? (\r\n          <Image\r\n            src={opportunity.company_logo_url}\r\n            alt={opportunity.company_name || opportunity.name}\r\n            width={80}\r\n            height={80}\r\n            className=\"rounded-xl object-cover\"\r\n          />\r\n        ) : (\r\n          <div className=\"w-20 h-20 rounded-xl bg-gray-100 dark:bg-gray-800 flex items-center justify-center\">\r\n            <Building2 className=\"w-10 h-10 text-gray-400\" />\r\n          </div>\r\n        )}\r\n        <div className=\"flex-1\">\r\n          <h1 className=\"text-2xl font-bold\">{opportunity.name}</h1>\r\n          {opportunity.company_name && (\r\n            <p className=\"text-muted-foreground\">{opportunity.company_name}</p>\r\n          )}\r\n          <div className=\"flex flex-wrap gap-2 mt-2\">\r\n            {opportunity.sector && (\r\n              <Badge variant=\"secondary\">\r\n                <TrendingUp className=\"w-3 h-3 mr-1\" />\r\n                {opportunity.sector}\r\n              </Badge>\r\n            )}\r\n            {opportunity.stage && (\r\n              <Badge variant=\"outline\">{opportunity.stage}</Badge>\r\n            )}\r\n            {opportunity.location && (\r\n              <Badge variant=\"outline\">\r\n                <MapPin className=\"w-3 h-3 mr-1\" />\r\n                {opportunity.location}\r\n              </Badge>\r\n            )}\r\n            {opportunity.stock_type && (\r\n              <Badge variant=\"outline\" className=\"border-purple-300 text-purple-700 dark:text-purple-300\">\r\n                <Tag className=\"w-3 h-3 mr-1\" />\r\n                {opportunity.stock_type.replace(/_/g, ' ')}\r\n              </Badge>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Action buttons */}\r\n        <div className=\"flex flex-col gap-3 min-w-[280px]\">\r\n          {/* Two Investment Paths for Open Deals */}\r\n          {showActionChoices && (\r\n            <div className=\"space-y-3\">\r\n              {/* Primary: Subscribe Directly */}\r\n              {canSubscribe && (\r\n                <div className=\"relative\">\r\n                  <Button\r\n                    className=\"w-full bg-emerald-600 hover:bg-emerald-700 h-auto py-3\"\r\n                    onClick={() => setShowSubscribeDialog(true)}\r\n                  >\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <TrendingUp className=\"w-5 h-5\" />\r\n                      <div className=\"text-left\">\r\n                        <div className=\"font-semibold\">Subscribe to Investment</div>\r\n                        <div className=\"text-xs opacity-90 font-normal\">Submit for review • NDA + Subscription</div>\r\n                      </div>\r\n                    </div>\r\n                  </Button>\r\n                </div>\r\n              )}\r\n\r\n              {/* OR Divider */}\r\n              {canSubscribe && canExpressInterest && (\r\n                <div className=\"relative flex items-center gap-3\">\r\n                  <div className=\"flex-1 h-px bg-gray-200 dark:bg-gray-700\" />\r\n                  <span className=\"text-xs text-muted-foreground font-medium px-2\">OR</span>\r\n                  <div className=\"flex-1 h-px bg-gray-200 dark:bg-gray-700\" />\r\n                </div>\r\n              )}\r\n\r\n              {/* Secondary: Data Room Interest */}\r\n              {/* PERSONA ACCESS RULE: Hide for introducers and lawyers who can't access data room */}\r\n              {canExpressInterest && opportunity.access_controls?.can_view_data_room !== false && (\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"w-full h-auto py-3 border-dashed\"\r\n                  onClick={() => setShowInterestDialog(true)}\r\n                >\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <FolderOpen className=\"w-5 h-5 text-amber-600\" />\r\n                    <div className=\"text-left\">\r\n                      <div className=\"font-medium\">Request Data Room Access</div>\r\n                      <div className=\"text-xs text-muted-foreground font-normal\">Review documents first</div>\r\n                    </div>\r\n                  </div>\r\n                </Button>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Show NDA info when in NDA stage - signing is triggered after CEO approval */}\r\n          {canSignNda && (\r\n            <Button variant=\"outline\" onClick={() => setShowNdaDialog(true)}>\r\n              <FileSignature className=\"w-4 h-4 mr-2\" />\r\n              About NDA Signing\r\n            </Button>\r\n          )}\r\n\r\n          {/* Subscription Status Badges */}\r\n          {opportunity.subscription && !opportunity.subscription.is_active && (\r\n            <Badge className=\"justify-center py-2\" variant=\"outline\">\r\n              <Clock className=\"w-4 h-4 mr-2\" />\r\n              {opportunity.subscription.is_funded ? 'Awaiting Activation' :\r\n               opportunity.subscription.is_signed ? 'Awaiting Funding' :\r\n               'Awaiting Signature'}\r\n            </Badge>\r\n          )}\r\n          {opportunity.subscription?.is_active && (\r\n            <Badge className=\"justify-center py-2 bg-emerald-500 text-white\">\r\n              <CheckCircle2 className=\"w-4 h-4 mr-2\" />\r\n              Active Investment\r\n            </Badge>\r\n          )}\r\n\r\n          {/* Ask Question - always available */}\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            className=\"text-muted-foreground hover:text-foreground\"\r\n            onClick={() => router.push(`/versotech_main/inbox?deal=${opportunity.id}&deal_name=${encodeURIComponent(opportunity.name)}`)}\r\n          >\r\n            <MessageSquare className=\"w-4 h-4 mr-2\" />\r\n            Ask a Question\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main content tabs */}\r\n      <Tabs defaultValue=\"overview\" className=\"space-y-4\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          {/* PERSONA ACCESS RULE: Hide Data Room tab for introducers and lawyers */}\r\n          {(opportunity.access_controls?.can_view_data_room !== false) && (\r\n            <TabsTrigger value=\"data-room\" className=\"relative\">\r\n              Data Room\r\n              {!opportunity.data_room.has_access && (\r\n                <Lock className=\"w-3 h-3 ml-1\" />\r\n              )}\r\n            </TabsTrigger>\r\n          )}\r\n          <TabsTrigger value=\"faqs\">FAQs</TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* Overview Tab */}\r\n        <TabsContent value=\"overview\" className=\"space-y-6\">\r\n          {/* Subscription Status OR Interest Status + Key Details Row */}\r\n          <div className=\"grid gap-6 lg:grid-cols-3\">\r\n            {/* Show SubscriptionStatusCard when subscription exists, otherwise show InterestStatusCard */}\r\n            {opportunity.subscription ? (\r\n              <SubscriptionStatusCard\r\n                subscription={opportunity.subscription}\r\n                dealCurrency={opportunity.currency}\r\n                dealId={opportunity.id}\r\n                dealName={opportunity.name}\r\n              />\r\n            ) : opportunity.subscription_submission ? (\r\n              <Card className=\"border-2 border-dashed border-amber-200 bg-amber-50\">\r\n                <CardHeader className=\"pb-3\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <CardTitle className=\"text-base flex items-center gap-2 text-amber-900\">\r\n                      <Clock className=\"h-5 w-5 text-amber-600\" />\r\n                      Subscription Under Review\r\n                    </CardTitle>\r\n                    <Badge className=\"bg-amber-200 text-amber-900 border-0\">\r\n                      Pending Review\r\n                    </Badge>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent className=\"text-sm text-amber-800\">\r\n                  {opportunity.subscription_submission.submitted_at\r\n                    ? `Submitted on ${formatDate(opportunity.subscription_submission.submitted_at)}.`\r\n                    : 'Submitted and awaiting CEO approval.'}\r\n                </CardContent>\r\n              </Card>\r\n            ) : (\r\n              <InterestStatusCard\r\n                currentStage={opportunity.journey.current_stage}\r\n                membership={opportunity.membership}\r\n                subscription={null}\r\n                canExpressInterest={canExpressInterest}\r\n                canSignNda={canSignNda}\r\n                canSubscribe={canSubscribe}\r\n                isTrackingOnly={isTrackingOnly}\r\n                onExpressInterest={() => setShowInterestDialog(true)}\r\n                onSignNda={() => setShowNdaDialog(true)}\r\n                onSubscribe={() => setShowSubscribeDialog(true)}\r\n              />\r\n            )}\r\n            <div className=\"lg:col-span-2\">\r\n              <DealKeyDetailsCard\r\n                dealType={opportunity.deal_type || 'N/A'}\r\n                currency={opportunity.currency}\r\n                stockType={opportunity.stock_type}\r\n                sector={opportunity.sector}\r\n                location={opportunity.location}\r\n                vehicleName={opportunity.vehicle?.name || null}\r\n                stage={opportunity.stage}\r\n                round={opportunity.deal_round}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid gap-6 md:grid-cols-2\">\r\n            {/* Investment Details */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Investment Details</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Target Raise</Label>\r\n                    <p className=\"font-medium\">{formatCurrency(opportunity.target_amount, opportunity.currency)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Raised</Label>\r\n                    <p className=\"font-medium\">{formatCurrency(opportunity.raised_amount, opportunity.currency)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Min Investment</Label>\r\n                    <p className=\"font-medium\">{formatCurrency(opportunity.minimum_investment, opportunity.currency)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Max Investment</Label>\r\n                    <p className=\"font-medium\">{formatCurrency(opportunity.maximum_investment, opportunity.currency)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Closing Date</Label>\r\n                    <p className=\"font-medium\">{formatDate(opportunity.close_at)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Deal Type</Label>\r\n                    <p className=\"font-medium\">{opportunity.deal_type || '-'}</p>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Company Info */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Company Information</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                {opportunity.description && (\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Description</Label>\r\n                    <p className=\"mt-1\">{opportunity.description}</p>\r\n                  </div>\r\n                )}\r\n                {opportunity.investment_thesis && (\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Investment Thesis</Label>\r\n                    <p className=\"mt-1\">{opportunity.investment_thesis}</p>\r\n                  </div>\r\n                )}\r\n                {opportunity.company_website && (\r\n                  <div>\r\n                    <Label className=\"text-muted-foreground\">Website</Label>\r\n                    <a\r\n                      href={opportunity.company_website}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"flex items-center gap-1 text-blue-600 hover:underline mt-1\"\r\n                    >\r\n                      <Globe className=\"w-4 h-4\" />\r\n                      {opportunity.company_website}\r\n                      <ExternalLink className=\"w-3 h-3\" />\r\n                    </a>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Term Sheet */}\r\n          {/* PERSONA ACCESS RULE: Hide Term Sheet for introducers and lawyers */}\r\n          {opportunity.access_controls?.can_view_term_sheet !== false && opportunity.fee_structures.length > 0 && (() => {\r\n            const termSheet = opportunity.fee_structures.find(ts => ts.status === 'published') || opportunity.fee_structures[0]\r\n            if (!termSheet) return null\r\n\r\n            const handlePreviewTermSheet = async () => {\r\n              if (!termSheet.term_sheet_attachment_key) return\r\n\r\n              // Set up document reference for viewer\r\n              const fileName = termSheet.term_sheet_attachment_key.split('/').pop() || 'Term Sheet.pdf'\r\n              setPreviewDocument({\r\n                id: termSheet.id,\r\n                file_name: fileName,\r\n                name: fileName,\r\n                mime_type: 'application/pdf',\r\n                type: 'term_sheet'\r\n              })\r\n              setPreviewOpen(true)\r\n              setPreviewLoading(true)\r\n              setPreviewError(null)\r\n              setPreviewUrl(null)\r\n\r\n              try {\r\n                // Use the correct endpoint with structureId\r\n                const response = await fetch(`/api/deals/${opportunity.id}/fee-structures/${termSheet.id}/attachment`)\r\n                const result = await response.json()\r\n                if (!response.ok) throw new Error(result.error || 'Failed to load preview')\r\n                setPreviewUrl(result.url)\r\n              } catch (err) {\r\n                console.error('Error loading term sheet preview:', err)\r\n                setPreviewError(err instanceof Error ? err.message : 'Failed to load preview')\r\n              } finally {\r\n                setPreviewLoading(false)\r\n              }\r\n            }\r\n\r\n            const closePreview = () => {\r\n              setPreviewOpen(false)\r\n              setPreviewUrl(null)\r\n              setPreviewError(null)\r\n              setPreviewDocument(null)\r\n            }\r\n\r\n            const handleDownloadFromPreview = () => {\r\n              if (previewUrl) {\r\n                window.open(previewUrl, '_blank')\r\n              }\r\n            }\r\n\r\n            // Check if any transaction details exist\r\n            const hasTransactionDetails = termSheet.transaction_type || termSheet.structure || termSheet.issuer ||\r\n              termSheet.vehicle || termSheet.exclusive_arranger || termSheet.purchaser || termSheet.seller || termSheet.legal_counsel\r\n\r\n            // Check if any timeline info exists\r\n            const hasTimeline = termSheet.interest_confirmation_deadline || termSheet.validity_date ||\r\n              termSheet.completion_date || termSheet.completion_date_text\r\n\r\n            // Check if any fees exist\r\n            const hasFees = termSheet.subscription_fee_percent !== null ||\r\n              termSheet.management_fee_percent !== null || termSheet.carried_interest_percent !== null\r\n\r\n            return (\r\n              <Card className=\"border-2\">\r\n                <CardHeader className=\"pb-4\">\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"space-y-1\">\r\n                      <CardTitle className=\"text-xl\">Term Sheet</CardTitle>\r\n                      {(termSheet.term_sheet_date || termSheet.version) && (\r\n                        <CardDescription className=\"text-sm\">\r\n                          {termSheet.term_sheet_date && formatDate(termSheet.term_sheet_date)}\r\n                          {termSheet.term_sheet_date && termSheet.version && ' • '}\r\n                          {termSheet.version && `Version ${termSheet.version}`}\r\n                        </CardDescription>\r\n                      )}\r\n                    </div>\r\n                    {termSheet.term_sheet_attachment_key && (\r\n                      <Button onClick={handlePreviewTermSheet} size=\"sm\" className=\"gap-2\">\r\n                        <Eye className=\"w-4 h-4\" />\r\n                        Preview PDF\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </CardHeader>\r\n\r\n                <CardContent className=\"space-y-8\">\r\n                  {/* Price Per Share - Hero display when available */}\r\n                  {termSheet.price_per_share_text && (\r\n                    <div className=\"text-center py-6 px-4 rounded-xl bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-950/50 dark:to-teal-950/50 border border-emerald-200 dark:border-emerald-800\">\r\n                      <div className=\"text-sm font-medium text-emerald-600 dark:text-emerald-400 mb-1\">Price Per Share</div>\r\n                      <div className=\"text-3xl font-bold text-emerald-700 dark:text-emerald-300\">{termSheet.price_per_share_text}</div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Opportunity Summary */}\r\n                  {(termSheet.term_sheet_html || termSheet.opportunity_summary) && (\r\n                    <div>\r\n                      <h4 className=\"text-sm font-semibold text-muted-foreground mb-3\">Opportunity Summary</h4>\r\n                      <div className=\"prose prose-sm dark:prose-invert max-w-none\">\r\n                        {termSheet.term_sheet_html ? (\r\n                          <div dangerouslySetInnerHTML={{ __html: termSheet.term_sheet_html }} />\r\n                        ) : (\r\n                          <p className=\"whitespace-pre-wrap text-foreground/80\">{termSheet.opportunity_summary}</p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Key Terms Grid */}\r\n                  {(termSheet.allocation_up_to || termSheet.minimum_ticket) && (\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                      {termSheet.allocation_up_to && (\r\n                        <div className=\"text-center p-4 rounded-lg bg-muted/50\">\r\n                          <div className=\"text-xs text-muted-foreground mb-1\">Allocation ({opportunity.currency})</div>\r\n                          <div className=\"text-lg font-semibold\">{formatCurrency(termSheet.allocation_up_to, opportunity.currency)}</div>\r\n                        </div>\r\n                      )}\r\n                      {termSheet.minimum_ticket && (\r\n                        <div className=\"text-center p-4 rounded-lg bg-muted/50\">\r\n                          <div className=\"text-xs text-muted-foreground mb-1\">Min. Ticket</div>\r\n                          <div className=\"text-lg font-semibold\">{formatCurrency(termSheet.minimum_ticket, opportunity.currency)}</div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Fee Structure */}\r\n                  {hasFees && (\r\n                    <div>\r\n                      <h4 className=\"text-sm font-semibold text-muted-foreground mb-3\">Fee Structure</h4>\r\n                      <div className=\"grid grid-cols-3 gap-4\">\r\n                        {termSheet.subscription_fee_percent !== null && (\r\n                          <div className=\"p-4 rounded-lg border bg-card\">\r\n                            <div className=\"text-xs text-muted-foreground\">Subscription Fee</div>\r\n                            <div className=\"text-2xl font-bold mt-1\">{termSheet.subscription_fee_percent}%</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.management_fee_percent !== null && (\r\n                          <div className=\"p-4 rounded-lg border bg-card\">\r\n                            <div className=\"text-xs text-muted-foreground\">Management Fee</div>\r\n                            <div className=\"text-2xl font-bold mt-1\">{termSheet.management_fee_percent}%</div>\r\n                            <div className=\"text-xs text-muted-foreground\">per annum</div>\r\n                            {termSheet.management_fee_clause && (\r\n                              <p className=\"text-xs text-muted-foreground mt-2 border-t pt-2\">{termSheet.management_fee_clause}</p>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                        {termSheet.carried_interest_percent !== null && (\r\n                          <div className=\"p-4 rounded-lg border bg-card\">\r\n                            <div className=\"text-xs text-muted-foreground\">Carried Interest</div>\r\n                            <div className=\"text-2xl font-bold mt-1\">{termSheet.carried_interest_percent}%</div>\r\n                            {termSheet.performance_fee_clause && (\r\n                              <p className=\"text-xs text-muted-foreground mt-2 border-t pt-2\">{termSheet.performance_fee_clause}</p>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Transaction Details */}\r\n                  {hasTransactionDetails && (\r\n                    <div>\r\n                      <h4 className=\"text-sm font-semibold text-muted-foreground mb-3\">Transaction Details</h4>\r\n                      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4\">\r\n                        {termSheet.transaction_type && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Type</div>\r\n                            <div className=\"font-medium\">{termSheet.transaction_type}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.structure && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Structure</div>\r\n                            <div className=\"font-medium\">{termSheet.structure}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.issuer && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Issuer</div>\r\n                            <div className=\"font-medium\">{termSheet.issuer}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.vehicle && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Vehicle</div>\r\n                            <div className=\"font-medium\">{termSheet.vehicle}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.exclusive_arranger && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Arranger</div>\r\n                            <div className=\"font-medium\">{termSheet.exclusive_arranger}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.purchaser && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Purchaser</div>\r\n                            <div className=\"font-medium\">{termSheet.purchaser}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.seller && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Seller</div>\r\n                            <div className=\"font-medium\">{termSheet.seller}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.legal_counsel && (\r\n                          <div>\r\n                            <div className=\"text-xs text-muted-foreground\">Legal Counsel</div>\r\n                            <div className=\"font-medium\">{termSheet.legal_counsel}</div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Timeline */}\r\n                  {hasTimeline && (\r\n                    <div>\r\n                      <h4 className=\"text-sm font-semibold text-muted-foreground mb-3\">Timeline</h4>\r\n                      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n                        {termSheet.interest_confirmation_deadline && (\r\n                          <div className=\"p-3 rounded-lg bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800\">\r\n                            <div className=\"text-xs font-medium text-amber-600 dark:text-amber-400\">Interest Deadline</div>\r\n                            <div className=\"font-semibold text-amber-700 dark:text-amber-300 mt-1\">{formatDate(termSheet.interest_confirmation_deadline)}</div>\r\n                          </div>\r\n                        )}\r\n                        {termSheet.validity_date && (\r\n                          <div className=\"p-3 rounded-lg bg-muted/50\">\r\n                            <div className=\"text-xs text-muted-foreground\">Valid Until</div>\r\n                            <div className=\"font-medium mt-1\">{formatDate(termSheet.validity_date)}</div>\r\n                          </div>\r\n                        )}\r\n                        {(termSheet.completion_date || termSheet.completion_date_text) && (\r\n                          <div className=\"p-3 rounded-lg bg-muted/50\">\r\n                            <div className=\"text-xs text-muted-foreground\">Completion</div>\r\n                            <div className=\"font-medium mt-1\">\r\n                              {termSheet.completion_date\r\n                                ? formatDate(termSheet.completion_date)\r\n                                : termSheet.completion_date_text}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </CardContent>\r\n              </Card>\r\n            )\r\n          })()}\r\n\r\n          {/* Signatories */}\r\n          {opportunity.signatories.length > 0 && (\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Users className=\"w-5 h-5\" />\r\n                  Authorized Signatories\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  These signatories will need to sign the NDA and subscription documents\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  {opportunity.signatories.map((signatory) => (\r\n                    <div key={signatory.id} className=\"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800\">\r\n                      <div className=\"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center\">\r\n                        <Users className=\"w-5 h-5 text-gray-500\" />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-medium\">{signatory.full_name}</div>\r\n                        <div className=\"text-sm text-muted-foreground\">{signatory.email}</div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n\r\n        {/* Data Room Tab */}\r\n        {/* PERSONA ACCESS RULE: Hide Data Room content for introducers and lawyers */}\r\n        {(opportunity.access_controls?.can_view_data_room !== false) && (\r\n          <TabsContent value=\"data-room\" className=\"space-y-4\">\r\n            {/* Access details banner when has access */}\r\n            {opportunity.data_room.has_access && opportunity.data_room.access_details && (\r\n              <Card>\r\n                <CardContent className=\"py-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                      <CheckCircle2 className=\"w-4 h-4 text-emerald-500\" />\r\n                      Access granted: {formatDate(opportunity.data_room.access_details.granted_at)}\r\n                      {opportunity.access_controls?.has_auto_data_room_access && (\r\n                        <span className=\"ml-2 text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full\">\r\n                          Auto-granted (Arranger)\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    {opportunity.data_room.access_details.expires_at && (\r\n                      <div className=\"flex items-center gap-2 text-sm text-amber-600\">\r\n                        <Clock className=\"w-4 h-4\" />\r\n                        Expires: {formatDate(opportunity.data_room.access_details.expires_at)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            {/* Data Room Viewer with folder grouping and featured docs */}\r\n            <DataRoomViewer\r\n              documents={opportunity.data_room.documents as DataRoomDocument[]}\r\n              hasAccess={opportunity.data_room.has_access}\r\n              requiresNda={opportunity.data_room.requires_nda}\r\n              dealId={opportunity.id}\r\n              onRequestAccess={opportunity.can_sign_nda ? () => setShowNdaDialog(true) : undefined}\r\n            />\r\n          </TabsContent>\r\n        )}\r\n\r\n        {/* FAQs Tab */}\r\n        <TabsContent value=\"faqs\" className=\"space-y-4\">\r\n          {opportunity.faqs.length === 0 ? (\r\n            <Card>\r\n              <CardContent className=\"py-12 text-center\">\r\n                <HelpCircle className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\r\n                <h3 className=\"text-lg font-medium mb-2\">No FAQs Available</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Frequently asked questions will be added by the deal team.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          ) : (\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Frequently Asked Questions</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <Accordion type=\"single\" collapsible className=\"w-full\">\r\n                  {opportunity.faqs.map((faq, index) => (\r\n                    <AccordionItem key={faq.id} value={`faq-${index}`}>\r\n                      <AccordionTrigger>{faq.question}</AccordionTrigger>\r\n                      <AccordionContent>{faq.answer}</AccordionContent>\r\n                    </AccordionItem>\r\n                  ))}\r\n                </Accordion>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Submit Interest for Data Room Dialog */}\r\n      <Dialog open={showInterestDialog} onOpenChange={setShowInterestDialog}>\r\n        <DialogContent className=\"sm:max-w-md\">\r\n          <DialogHeader>\r\n            <div className=\"flex items-center gap-3 mb-2\">\r\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-amber-100 dark:bg-amber-900/30\">\r\n                <FolderOpen className=\"h-5 w-5 text-amber-600\" />\r\n              </div>\r\n              <DialogTitle className=\"text-lg\">Request Data Room Access</DialogTitle>\r\n            </div>\r\n            <DialogDescription className=\"text-left\">\r\n              Submit your interest to access the data room for {opportunity.name}.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          {/* Process Steps */}\r\n          <div className=\"py-4\">\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-start gap-3 text-sm\">\r\n                <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 text-xs font-medium\">1</div>\r\n                <div>\r\n                  <div className=\"font-medium\">Submit Interest</div>\r\n                  <div className=\"text-muted-foreground\">Team reviews your request</div>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-3 text-sm\">\r\n                <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 text-xs font-medium\">2</div>\r\n                <div>\r\n                  <div className=\"font-medium\">Sign NDA</div>\r\n                  <div className=\"text-muted-foreground\">All signatories sign the NDA</div>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-3 text-sm\">\r\n                <div className=\"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 text-xs font-medium\">3</div>\r\n                <div>\r\n                  <div className=\"font-medium\">Access Data Room</div>\r\n                  <div className=\"text-muted-foreground\">7-day access to all documents</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter className=\"gap-2 sm:gap-0\">\r\n            <Button variant=\"outline\" onClick={() => setShowInterestDialog(false)}>\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleExpressInterest} disabled={actionLoading} className=\"gap-2\">\r\n              {actionLoading ? 'Processing...' : (\r\n                <>\r\n                  <FolderOpen className=\"w-4 h-4\" />\r\n                  Submit Interest\r\n                </>\r\n              )}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* NDA Info Dialog - NDA is sent automatically after CEO approval */}\r\n      <Dialog open={showNdaDialog} onOpenChange={setShowNdaDialog}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>NDA Signing Process</DialogTitle>\r\n            <DialogDescription>\r\n              The NDA will be sent to you automatically once your interest is approved.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"py-4 space-y-4\">\r\n            <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <CheckCircle2 className=\"w-5 h-5 text-blue-600 mt-0.5\" />\r\n                <div className=\"text-sm\">\r\n                  <p className=\"font-medium text-blue-800 dark:text-blue-200\">Automatic NDA Generation</p>\r\n                  <p className=\"text-blue-700 dark:text-blue-300 mt-1\">\r\n                    Once your interest is approved by the VERSO team, each authorized signatory\r\n                    ({opportunity.signatories.length}) will receive their own NDA document to sign.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <AlertCircle className=\"w-5 h-5 text-amber-600 mt-0.5\" />\r\n                <div className=\"text-sm\">\r\n                  <p className=\"font-medium text-amber-800 dark:text-amber-200\">Multi-Signatory Required</p>\r\n                  <p className=\"text-amber-700 dark:text-amber-300 mt-1\">\r\n                    Data room access will be granted only after <strong>all signatories</strong> have\r\n                    completed signing their individual NDAs.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <Button onClick={() => setShowNdaDialog(false)}>\r\n              Got it\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Subscribe to Investment Opportunity Dialog */}\r\n      <Dialog open={showSubscribeDialog} onOpenChange={setShowSubscribeDialog}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Subscribe to Investment Opportunity</DialogTitle>\r\n            <DialogDescription>\r\n              Enter your commitment amount to submit a subscription request for {opportunity.name}. Once reviewed,\r\n              you&apos;ll receive the NDA and subscription documents to sign.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"py-4 space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"amount\">Commitment Amount ({opportunity.currency})</Label>\r\n              <Input\r\n                id=\"amount\"\r\n                type=\"number\"\r\n                placeholder={`Min: ${formatCurrency(opportunity.minimum_investment, opportunity.currency)}`}\r\n                value={subscribeAmount}\r\n                onChange={(e) => setSubscribeAmount(e.target.value)}\r\n              />\r\n              {opportunity.minimum_investment && opportunity.maximum_investment && (\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  Range: {formatCurrency(opportunity.minimum_investment, opportunity.currency)} - {formatCurrency(opportunity.maximum_investment, opportunity.currency)}\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {opportunity.signatories.length > 0 && (\r\n              <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <FileSignature className=\"w-5 h-5 text-blue-600 mt-0.5\" />\r\n                  <div className=\"text-sm\">\r\n                    <p className=\"font-medium text-blue-800 dark:text-blue-200\">\r\n                      {opportunity.signatories.length} Signatory(ies) Required\r\n                    </p>\r\n                    <p className=\"text-blue-700 dark:text-blue-300 mt-1\">\r\n                      Both NDA and Subscription Pack will be sent to all authorized signatories.\r\n                    </p>\r\n                    <p className=\"text-amber-600 dark:text-amber-400 mt-2 text-xs\">\r\n                      Note: This request does not include data room access.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setShowSubscribeDialog(false)}>\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleSubscribe}\r\n              disabled={actionLoading || !subscribeAmount || (opportunity.minimum_investment !== null && parseFloat(subscribeAmount) < opportunity.minimum_investment)}\r\n            >\r\n              {actionLoading ? 'Processing...' : 'Subscribe'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Term Sheet Preview - Fullscreen Viewer */}\r\n      <DocumentViewerFullscreen\r\n        isOpen={previewOpen}\r\n        document={previewDocument}\r\n        previewUrl={previewUrl}\r\n        isLoading={previewLoading}\r\n        error={previewError}\r\n        onClose={() => {\r\n          setPreviewOpen(false)\r\n          setPreviewUrl(null)\r\n          setPreviewError(null)\r\n          setPreviewDocument(null)\r\n        }}\r\n        onDownload={() => {\r\n          if (previewUrl) {\r\n            window.open(previewUrl, '_blank')\r\n          }\r\n        }}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAQA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsBA;AAEA;AACA;AAAA;;;AAzDA;;;;;;;;;;;;;;;;;;;;;;;AA6PA,SAAS,eAAe,MAAqB,EAAE,WAAmB,KAAK;IACrE,IAAI,CAAC,QAAQ,OAAO;IACpB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP;QACA,uBAAuB;QACvB,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAEA,SAAS,WAAW,UAAyB;IAC3C,IAAI,CAAC,YAAY,OAAO;IACxB,OAAO,IAAI,KAAK,YAAY,kBAAkB,CAAC,SAAS;QACtD,OAAO;QACP,KAAK;QACL,MAAM;IACR;AACF;AAEA,SAAS,eAAe,KAAa;IACnC,IAAI,QAAQ,MAAM,OAAO,GAAG,MAAM,EAAE,CAAC;IACrC,IAAI,QAAQ,OAAO,MAAM,OAAO,GAAG,CAAC,QAAQ,IAAI,EAAE,OAAO,CAAC,GAAG,GAAG,CAAC;IACjE,OAAO,GAAG,CAAC,QAAQ,CAAC,OAAO,IAAI,CAAC,EAAE,OAAO,CAAC,GAAG,GAAG,CAAC;AACnD;AAEe,SAAS;;IACtB,MAAM,SAAS,IAAA,yKAAS;IACxB,MAAM,SAAS,IAAA,yKAAS;IACxB,MAAM,eAAe,IAAA,+KAAe;IACpC,MAAM,SAAS,OAAO,EAAE;IACxB,MAAM,cAAc,aAAa,GAAG,CAAC;IACrC,MAAM,YAAY,aAAa,GAAG,CAAC,QAAQ,6BAA6B;;IAExE,MAAM,EAAE,aAAa,EAAE,WAAW,cAAc,EAAE,aAAa,EAAE,OAAO,YAAY,EAAE,GAAG,IAAA,8KAAU;IACnG,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,gMAAQ,EAAqB;IACnE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gMAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gMAAQ,EAAgB;IAGlD,gBAAgB;IAChB,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,gMAAQ,EAAC;IAC7D,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,gMAAQ,EAAC;IACnD,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,gMAAQ,EAAC;IAC/D,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,gMAAQ,EAAC;IACvD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,gMAAQ,EAAC;IACnD,MAAM,mBAAmB,eAAe,iBAAiB;IAEzD,2BAA2B;IAC3B,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,gMAAQ,EAAC;IAC/C,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,gMAAQ,EAAC;IACrD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,gMAAQ,EAAgB;IAC5D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,gMAAQ,EAAgB;IAChE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,gMAAQ,EAA2B;IACjF,MAAM,EAAE,WAAW,EAAE,cAAc,EAAE,GAAG,IAAA,iNAAY;IAEpD,IAAA,iMAAS;2CAAC;YACR,mFAAmF;YACnF,kFAAkF;YAClF,iDAAiD;YACjD,MAAM,kBAAkB,IAAI;YAC5B,IAAI,cAAc;YAElB,kCAAkC;YAClC,eAAe;YACf,SAAS;YACT,WAAW;YAEX,eAAe;gBACb,IAAI;oBACF,QAAQ,GAAG,CAAC,CAAC,+CAA+C,EAAE,QAAQ;oBAEtE,qDAAqD;oBACrD,MAAM,CAAC,gCAAgC,EAAE,QAAQ,EAAE;wBACjD,QAAQ;wBACR,SAAS;4BAAE,gBAAgB;wBAAmB;wBAC9C,MAAM,KAAK,SAAS,CAAC;4BAAE,QAAQ;wBAAO;wBACtC,OAAO;oBACT,GAAG,KAAK;4EAAC,KAAO;4EAAG,oCAAoC;oBAEvD,2CAA2C;oBAC3C,MAAM,YAAY,KAAK,GAAG;oBAC1B,MAAM,aAAa,eAAe,gBAAgB,KAC9C,CAAC,oBAAoB,EAAE,eAAe,EAAE,EAAE,GAC1C;oBACJ,MAAM,WAAW,MAAM,MAAM,CAAC,gCAAgC,EAAE,OAAO,IAAI,EAAE,YAAY,YAAY,EAAE;wBACrG,OAAO;wBACP,QAAQ,gBAAgB,MAAM;wBAC9B,SAAS;4BACP,iBAAiB;4BACjB,UAAU;wBACZ;oBACF;oBAEA,4DAA4D;oBAC5D,IAAI,aAAa;wBACf,QAAQ,GAAG,CAAC,CAAC,8BAA8B,EAAE,OAAO,oCAAoC,CAAC;wBACzF;oBACF;oBAEA,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,IAAI,CAAC,SAAS,EAAE,EAAE;wBAChB,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI,CAAC,6BAA6B,EAAE,SAAS,MAAM,CAAC,CAAC,CAAC;oBAClF;oBAEA,iEAAiE;oBACjE,IAAI,aAAa;wBACf,QAAQ,GAAG,CAAC,CAAC,0CAA0C,EAAE,OAAO,wBAAwB,CAAC;wBACzF;oBACF;oBAEA,QAAQ,GAAG,CAAC,CAAC,0CAA0C,EAAE,KAAK,WAAW,EAAE,KAAK,OAAO,EAAE,KAAK,WAAW,EAAE,GAAG,CAAC,CAAC;oBAEhH,IAAI,KAAK,WAAW,EAAE,OAAO,QAAQ;wBACnC,QAAQ,KAAK,CAAC,CAAC,yCAAyC,EAAE,OAAO,kBAAkB,EAAE,KAAK,WAAW,EAAE,IAAI;oBAC7G;oBAEA,eAAe,KAAK,WAAW;oBAC/B,MAAM,yBAAyB,KAAK,WAAW,CAAC,gBAAgB,IAAK,oBAAoB,CAAC,KAAK,WAAW,CAAC,UAAU,EAAE;oBAEvH,IAAI,gBAAgB,eAAe,KAAK,WAAW,CAAC,aAAa,IAAI,CAAC,wBAAwB;wBAC5F,uBAAuB;oBACzB;gBACF,EAAE,OAAO,KAAU;oBACjB,IAAI,IAAI,IAAI,KAAK,cAAc;wBAC7B,QAAQ,GAAG,CAAC,CAAC,sCAAsC,EAAE,QAAQ;wBAC7D;oBACF;oBACA,IAAI,CAAC,aAAa;wBAChB,QAAQ,KAAK,CAAC,+BAA+B;wBAC7C,SAAS;oBACX;gBACF,SAAU;oBACR,IAAI,CAAC,aAAa;wBAChB,WAAW;oBACb;gBACF;YACF;YAEA,IAAI,iBAAiB,QAAQ;gBAC3B;YACF;YAEA,mFAAmF;YACnF;mDAAO;oBACL,QAAQ,GAAG,CAAC,CAAC,kDAAkD,EAAE,QAAQ;oBACzE,cAAc;oBACd,gBAAgB,KAAK;gBACvB;;QACF;0CAAG;QAAC;QAAe;QAAQ;QAAa;QAAkB;QAAa,gBAAgB;KAAG;IAE1F,MAAM,wBAAwB;QAC5B,IAAI;YACF,iBAAiB;YACjB,MAAM,WAAW,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,UAAU,CAAC,EAAE;gBAC7D,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC,CAAC;YACxB;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,MAAM,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;gBACjD,MAAM,IAAI,MAAM,IAAI,KAAK,IAAI;YAC/B;YAEA,eAAe;YACf,MAAM,aAAa,eAAe,gBAAgB,KAC9C,CAAC,oBAAoB,EAAE,eAAe,EAAE,EAAE,GAC1C;YACJ,MAAM,kBAAkB,MAAM,MAAM,CAAC,gCAAgC,EAAE,SAAS,YAAY;YAC5F,MAAM,OAAO,MAAM,gBAAgB,IAAI;YACvC,eAAe,KAAK,WAAW;YAC/B,sBAAsB;QACxB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC9C,SAAU;YACR,iBAAiB;QACnB;IACF;IAEA,8DAA8D;IAC9D,wEAAwE;IACxE,iEAAiE;IAEjE,MAAM,kBAAkB;QACtB,IAAI,CAAC,mBAAmB,CAAC,aAAa;QAEtC,IAAI;YACF,iBAAiB;YAEjB,IAAI;YACJ,IAAI,eAAe,gBAAgB,IAAI;gBACrC,WAAW,MAAM,MAAM,4CAA4C;oBACjE,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBACnB,SAAS;wBACT,oBAAoB,eAAe,EAAE;wBACrC,YAAY,WAAW;wBACvB,YAAY,YAAY,UAAU,IAAI;wBACtC,OAAO,CAAC,6CAA6C,CAAC;oBACxD;gBACF;YACF,OAAO;gBACL,wDAAwD;gBACxD,WAAW,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,cAAc,CAAC,EAAE;oBAC3D,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBACnB,SAAS;4BACP,QAAQ,WAAW;4BACnB,UAAU,YAAY,QAAQ;4BAC9B,mBAAmB;wBACrB;wBACA,mBAAmB;oBACrB;gBACF;YACF;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,MAAM,MAAM,SAAS,IAAI;gBAC/B,MAAM,IAAI,MAAM,IAAI,KAAK,IAAI;YAC/B;YAEA,MAAM,SAAS,IAAI;YAEnB,eAAe;YACf,MAAM,aAAa,eAAe,gBAAgB,KAC9C,CAAC,oBAAoB,EAAE,eAAe,EAAE,EAAE,GAC1C;YACJ,MAAM,kBAAkB,MAAM,MAAM,CAAC,gCAAgC,EAAE,SAAS,YAAY;YAC5F,MAAM,OAAO,MAAM,gBAAgB,IAAI;YACvC,eAAe,KAAK,WAAW;YAC/B,uBAAuB;YACvB,mBAAmB;YAEnB,MAAM;QACR,EAAE,OAAO,KAAU;YACjB,QAAQ,KAAK,CAAC,sBAAsB;YACpC,MAAM,IAAI,OAAO,IAAI;QACvB,SAAU;YACR,iBAAiB;QACnB;IACF;IAGA,qDAAqD;IACrD,IAAI,gBAAgB;QAClB,qBACE,oNAAC;YAAI,WAAU;;8BACb,oNAAC,0KAAQ;oBAAC,WAAU;;;;;;8BACpB,oNAAC,0KAAQ;oBAAC,WAAU;;;;;;8BACpB,oNAAC,0KAAQ;oBAAC,WAAU;;;;;;;;;;;;IAG1B;IAEA,IAAI,CAAC,eAAe;QAClB,qBACE,oNAAC;YAAI,WAAU;sBACb,cAAA,oNAAC,kKAAI;gBAAC,WAAU;0BACd,cAAA,oNAAC,wKAAU;;sCACT,oNAAC,uKAAS;sCAAC;;;;;;sCACX,oNAAC,6KAAe;sCAAC;;;;;;;;;;;;;;;;;;;;;;IAO3B;IAEA,IAAI,SAAS;QACX,qBACE,oNAAC;YAAI,WAAU;;8BACb,oNAAC,0KAAQ;oBAAC,WAAU;;;;;;8BACpB,oNAAC,0KAAQ;oBAAC,WAAU;;;;;;8BACpB,oNAAC,0KAAQ;oBAAC,WAAU;;;;;;;;;;;;IAG1B;IAEA,IAAI,SAAS,CAAC,aAAa;QACzB,qBACE,oNAAC;YAAI,WAAU;sBACb,cAAA,oNAAC,kKAAI;gBAAC,WAAU;;kCACd,oNAAC,wKAAU;;0CACT,oNAAC,uKAAS;0CAAC;;;;;;0CACX,oNAAC,6KAAe;0CAAE,SAAS;;;;;;;;;;;;kCAE7B,oNAAC,yKAAW;kCACV,cAAA,oNAAC,sKAAM;4BAAC,SAAS,IAAM,OAAO,IAAI,CAChC,cAAc,kBACV,kCACA;;8CAEJ,oNAAC,uPAAS;oCAAC,WAAU;;;;;;gCACpB,cAAc,kBAAkB,0BAA0B;;;;;;;;;;;;;;;;;;;;;;;IAMvE;IAEA,MAAM,iBAAiB,CAAC,CAAC,YAAY,gBAAgB,IAAK,oBAAoB,CAAC,YAAY,UAAU,EAAE;IACvG,MAAM,eAAe,YAAY,aAAa,IAAI,CAAC;IACnD,MAAM,qBAAqB,YAAY,oBAAoB,IAAI,CAAC;IAChE,MAAM,aAAa,YAAY,YAAY,IAAI,CAAC;IAChD,MAAM,oBACJ,YAAY,MAAM,KAAK,YACvB,CAAC,YAAY,YAAY,IACzB,CAAC,gBAAgB,kBAAkB;IAErC,qBACE,oNAAC;QAAI,WAAU;;0BAEb,oNAAC,sKAAM;gBACL,SAAQ;gBACR,SAAS;oBACP,8DAA8D;oBAC9D,IAAI,cAAc,iBAAiB;wBACjC,OAAO,IAAI,CAAC;oBACd,OAAO;wBACL,OAAO,IAAI;oBACb;gBACF;;kCAEA,oNAAC,uPAAS;wBAAC,WAAU;;;;;;oBACpB,cAAc,kBAAkB,0BAA0B;;;;;;;YAI5D,CAAC,+BACA,oNAAC,kKAAI;;kCACH,oNAAC,wKAAU;wBAAC,WAAU;kCACpB,cAAA,oNAAC,uKAAS;4BAAC,WAAU;sCAA4C;;;;;;;;;;;kCAEnE,oNAAC,yKAAW;kCACV,cAAA,oNAAC,yMAAkB;4BACjB,SAAS,YAAY,OAAO,CAAC,OAAO;4BACpC,cAAc,YAAY,OAAO,CAAC,aAAa;;;;;;;;;;;;;;;;qCAKrD,oNAAC,kKAAI;;kCACH,oNAAC,wKAAU;wBAAC,WAAU;kCACpB,cAAA,oNAAC,uKAAS;4BAAC,WAAU;sCAA4C;;;;;;;;;;;kCAEnE,oNAAC,yKAAW;kCACV,cAAA,oNAAC;4BAAI,WAAU;;8CACb,oNAAC,6PAAW;oCAAC,WAAU;;;;;;8CACvB,oNAAC;8CAAK;;;;;;;;;;;;;;;;;;;;;;;0BASd,oNAAC,qMAAgB;gBACf,QAAQ,YAAY,OAAO;gBAC3B,SAAS,YAAY,QAAQ;;;;;;0BAI/B,oNAAC;gBAAI,WAAU;;oBACZ,YAAY,gBAAgB,iBAC3B,oNAAC,kKAAK;wBACJ,KAAK,YAAY,gBAAgB;wBACjC,KAAK,YAAY,YAAY,IAAI,YAAY,IAAI;wBACjD,OAAO;wBACP,QAAQ;wBACR,WAAU;;;;;6CAGZ,oNAAC;wBAAI,WAAU;kCACb,cAAA,oNAAC,uPAAS;4BAAC,WAAU;;;;;;;;;;;kCAGzB,oNAAC;wBAAI,WAAU;;0CACb,oNAAC;gCAAG,WAAU;0CAAsB,YAAY,IAAI;;;;;;4BACnD,YAAY,YAAY,kBACvB,oNAAC;gCAAE,WAAU;0CAAyB,YAAY,YAAY;;;;;;0CAEhE,oNAAC;gCAAI,WAAU;;oCACZ,YAAY,MAAM,kBACjB,oNAAC,oKAAK;wCAAC,SAAQ;;0DACb,oNAAC,0PAAU;gDAAC,WAAU;;;;;;4CACrB,YAAY,MAAM;;;;;;;oCAGtB,YAAY,KAAK,kBAChB,oNAAC,oKAAK;wCAAC,SAAQ;kDAAW,YAAY,KAAK;;;;;;oCAE5C,YAAY,QAAQ,kBACnB,oNAAC,oKAAK;wCAAC,SAAQ;;0DACb,oNAAC,8OAAM;gDAAC,WAAU;;;;;;4CACjB,YAAY,QAAQ;;;;;;;oCAGxB,YAAY,UAAU,kBACrB,oNAAC,oKAAK;wCAAC,SAAQ;wCAAU,WAAU;;0DACjC,oNAAC,iOAAG;gDAAC,WAAU;;;;;;4CACd,YAAY,UAAU,CAAC,OAAO,CAAC,MAAM;;;;;;;;;;;;;;;;;;;kCAO9C,oNAAC;wBAAI,WAAU;;4BAEZ,mCACC,oNAAC;gCAAI,WAAU;;oCAEZ,8BACC,oNAAC;wCAAI,WAAU;kDACb,cAAA,oNAAC,sKAAM;4CACL,WAAU;4CACV,SAAS,IAAM,uBAAuB;sDAEtC,cAAA,oNAAC;gDAAI,WAAU;;kEACb,oNAAC,0PAAU;wDAAC,WAAU;;;;;;kEACtB,oNAAC;wDAAI,WAAU;;0EACb,oNAAC;gEAAI,WAAU;0EAAgB;;;;;;0EAC/B,oNAAC;gEAAI,WAAU;0EAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;oCAQzD,gBAAgB,oCACf,oNAAC;wCAAI,WAAU;;0DACb,oNAAC;gDAAI,WAAU;;;;;;0DACf,oNAAC;gDAAK,WAAU;0DAAiD;;;;;;0DACjE,oNAAC;gDAAI,WAAU;;;;;;;;;;;;oCAMlB,sBAAsB,YAAY,eAAe,EAAE,uBAAuB,uBACzE,oNAAC,sKAAM;wCACL,SAAQ;wCACR,WAAU;wCACV,SAAS,IAAM,sBAAsB;kDAErC,cAAA,oNAAC;4CAAI,WAAU;;8DACb,oNAAC,0PAAU;oDAAC,WAAU;;;;;;8DACtB,oNAAC;oDAAI,WAAU;;sEACb,oNAAC;4DAAI,WAAU;sEAAc;;;;;;sEAC7B,oNAAC;4DAAI,WAAU;sEAA4C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAStE,4BACC,oNAAC,sKAAM;gCAAC,SAAQ;gCAAU,SAAS,IAAM,iBAAiB;;kDACxD,oNAAC,qQAAa;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;4BAM7C,YAAY,YAAY,IAAI,CAAC,YAAY,YAAY,CAAC,SAAS,kBAC9D,oNAAC,oKAAK;gCAAC,WAAU;gCAAsB,SAAQ;;kDAC7C,oNAAC,uOAAK;wCAAC,WAAU;;;;;;oCAChB,YAAY,YAAY,CAAC,SAAS,GAAG,wBACrC,YAAY,YAAY,CAAC,SAAS,GAAG,qBACrC;;;;;;;4BAGJ,YAAY,YAAY,EAAE,2BACzB,oNAAC,oKAAK;gCAAC,WAAU;;kDACf,oNAAC,+PAAY;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;0CAM7C,oNAAC,sKAAM;gCACL,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,SAAS,IAAM,OAAO,IAAI,CAAC,CAAC,2BAA2B,EAAE,YAAY,EAAE,CAAC,WAAW,EAAE,mBAAmB,YAAY,IAAI,GAAG;;kDAE3H,oNAAC,mQAAa;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;;;;;;;;;;;;;0BAOhD,oNAAC,kKAAI;gBAAC,cAAa;gBAAW,WAAU;;kCACtC,oNAAC,sKAAQ;;0CACP,oNAAC,yKAAW;gCAAC,OAAM;0CAAW;;;;;;4BAE5B,YAAY,eAAe,EAAE,uBAAuB,uBACpD,oNAAC,yKAAW;gCAAC,OAAM;gCAAY,WAAU;;oCAAW;oCAEjD,CAAC,YAAY,SAAS,CAAC,UAAU,kBAChC,oNAAC,oOAAI;wCAAC,WAAU;;;;;;;;;;;;0CAItB,oNAAC,yKAAW;gCAAC,OAAM;0CAAO;;;;;;;;;;;;kCAI5B,oNAAC,yKAAW;wBAAC,OAAM;wBAAW,WAAU;;0CAEtC,oNAAC;gCAAI,WAAU;;oCAEZ,YAAY,YAAY,iBACvB,oNAAC,iNAAsB;wCACrB,cAAc,YAAY,YAAY;wCACtC,cAAc,YAAY,QAAQ;wCAClC,QAAQ,YAAY,EAAE;wCACtB,UAAU,YAAY,IAAI;;;;;+CAE1B,YAAY,uBAAuB,iBACrC,oNAAC,kKAAI;wCAAC,WAAU;;0DACd,oNAAC,wKAAU;gDAAC,WAAU;0DACpB,cAAA,oNAAC;oDAAI,WAAU;;sEACb,oNAAC,uKAAS;4DAAC,WAAU;;8EACnB,oNAAC,uOAAK;oEAAC,WAAU;;;;;;gEAA2B;;;;;;;sEAG9C,oNAAC,oKAAK;4DAAC,WAAU;sEAAuC;;;;;;;;;;;;;;;;;0DAK5D,oNAAC,yKAAW;gDAAC,WAAU;0DACpB,YAAY,uBAAuB,CAAC,YAAY,GAC7C,CAAC,aAAa,EAAE,WAAW,YAAY,uBAAuB,CAAC,YAAY,EAAE,CAAC,CAAC,GAC/E;;;;;;;;;;;6DAIR,oNAAC,yMAAkB;wCACjB,cAAc,YAAY,OAAO,CAAC,aAAa;wCAC/C,YAAY,YAAY,UAAU;wCAClC,cAAc;wCACd,oBAAoB;wCACpB,YAAY;wCACZ,cAAc;wCACd,gBAAgB;wCAChB,mBAAmB,IAAM,sBAAsB;wCAC/C,WAAW,IAAM,iBAAiB;wCAClC,aAAa,IAAM,uBAAuB;;;;;;kDAG9C,oNAAC;wCAAI,WAAU;kDACb,cAAA,oNAAC,6MAAkB;4CACjB,UAAU,YAAY,SAAS,IAAI;4CACnC,UAAU,YAAY,QAAQ;4CAC9B,WAAW,YAAY,UAAU;4CACjC,QAAQ,YAAY,MAAM;4CAC1B,UAAU,YAAY,QAAQ;4CAC9B,aAAa,YAAY,OAAO,EAAE,QAAQ;4CAC1C,OAAO,YAAY,KAAK;4CACxB,OAAO,YAAY,UAAU;;;;;;;;;;;;;;;;;0CAKnC,oNAAC;gCAAI,WAAU;;kDAEb,oNAAC,kKAAI;;0DACH,oNAAC,wKAAU;0DACT,cAAA,oNAAC,uKAAS;8DAAC;;;;;;;;;;;0DAEb,oNAAC,yKAAW;0DACV,cAAA,oNAAC;oDAAI,WAAU;;sEACb,oNAAC;;8EACC,oNAAC,oKAAK;oEAAC,WAAU;8EAAwB;;;;;;8EACzC,oNAAC;oEAAE,WAAU;8EAAe,eAAe,YAAY,aAAa,EAAE,YAAY,QAAQ;;;;;;;;;;;;sEAE5F,oNAAC;;8EACC,oNAAC,oKAAK;oEAAC,WAAU;8EAAwB;;;;;;8EACzC,oNAAC;oEAAE,WAAU;8EAAe,eAAe,YAAY,aAAa,EAAE,YAAY,QAAQ;;;;;;;;;;;;sEAE5F,oNAAC;;8EACC,oNAAC,oKAAK;oEAAC,WAAU;8EAAwB;;;;;;8EACzC,oNAAC;oEAAE,WAAU;8EAAe,eAAe,YAAY,kBAAkB,EAAE,YAAY,QAAQ;;;;;;;;;;;;sEAEjG,oNAAC;;8EACC,oNAAC,oKAAK;oEAAC,WAAU;8EAAwB;;;;;;8EACzC,oNAAC;oEAAE,WAAU;8EAAe,eAAe,YAAY,kBAAkB,EAAE,YAAY,QAAQ;;;;;;;;;;;;sEAEjG,oNAAC;;8EACC,oNAAC,oKAAK;oEAAC,WAAU;8EAAwB;;;;;;8EACzC,oNAAC;oEAAE,WAAU;8EAAe,WAAW,YAAY,QAAQ;;;;;;;;;;;;sEAE7D,oNAAC;;8EACC,oNAAC,oKAAK;oEAAC,WAAU;8EAAwB;;;;;;8EACzC,oNAAC;oEAAE,WAAU;8EAAe,YAAY,SAAS,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kDAO7D,oNAAC,kKAAI;;0DACH,oNAAC,wKAAU;0DACT,cAAA,oNAAC,uKAAS;8DAAC;;;;;;;;;;;0DAEb,oNAAC,yKAAW;gDAAC,WAAU;;oDACpB,YAAY,WAAW,kBACtB,oNAAC;;0EACC,oNAAC,oKAAK;gEAAC,WAAU;0EAAwB;;;;;;0EACzC,oNAAC;gEAAE,WAAU;0EAAQ,YAAY,WAAW;;;;;;;;;;;;oDAG/C,YAAY,iBAAiB,kBAC5B,oNAAC;;0EACC,oNAAC,oKAAK;gEAAC,WAAU;0EAAwB;;;;;;0EACzC,oNAAC;gEAAE,WAAU;0EAAQ,YAAY,iBAAiB;;;;;;;;;;;;oDAGrD,YAAY,eAAe,kBAC1B,oNAAC;;0EACC,oNAAC,oKAAK;gEAAC,WAAU;0EAAwB;;;;;;0EACzC,oNAAC;gEACC,MAAM,YAAY,eAAe;gEACjC,QAAO;gEACP,KAAI;gEACJ,WAAU;;kFAEV,oNAAC,uOAAK;wEAAC,WAAU;;;;;;oEAChB,YAAY,eAAe;kFAC5B,oNAAC,gQAAY;wEAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAUnC,YAAY,eAAe,EAAE,wBAAwB,SAAS,YAAY,cAAc,CAAC,MAAM,GAAG,KAAK,CAAC;gCACvG,MAAM,YAAY,YAAY,cAAc,CAAC,IAAI,CAAC,CAAA,KAAM,GAAG,MAAM,KAAK,gBAAgB,YAAY,cAAc,CAAC,EAAE;gCACnH,IAAI,CAAC,WAAW,OAAO;gCAEvB,MAAM,yBAAyB;oCAC7B,IAAI,CAAC,UAAU,yBAAyB,EAAE;oCAE1C,uCAAuC;oCACvC,MAAM,WAAW,UAAU,yBAAyB,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM;oCACzE,mBAAmB;wCACjB,IAAI,UAAU,EAAE;wCAChB,WAAW;wCACX,MAAM;wCACN,WAAW;wCACX,MAAM;oCACR;oCACA,eAAe;oCACf,kBAAkB;oCAClB,gBAAgB;oCAChB,cAAc;oCAEd,IAAI;wCACF,4CAA4C;wCAC5C,MAAM,WAAW,MAAM,MAAM,CAAC,WAAW,EAAE,YAAY,EAAE,CAAC,gBAAgB,EAAE,UAAU,EAAE,CAAC,WAAW,CAAC;wCACrG,MAAM,SAAS,MAAM,SAAS,IAAI;wCAClC,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI;wCAClD,cAAc,OAAO,GAAG;oCAC1B,EAAE,OAAO,KAAK;wCACZ,QAAQ,KAAK,CAAC,qCAAqC;wCACnD,gBAAgB,eAAe,QAAQ,IAAI,OAAO,GAAG;oCACvD,SAAU;wCACR,kBAAkB;oCACpB;gCACF;gCAEA,MAAM,eAAe;oCACnB,eAAe;oCACf,cAAc;oCACd,gBAAgB;oCAChB,mBAAmB;gCACrB;gCAEA,MAAM,4BAA4B;oCAChC,IAAI,YAAY;wCACd,OAAO,IAAI,CAAC,YAAY;oCAC1B;gCACF;gCAEA,yCAAyC;gCACzC,MAAM,wBAAwB,UAAU,gBAAgB,IAAI,UAAU,SAAS,IAAI,UAAU,MAAM,IACjG,UAAU,OAAO,IAAI,UAAU,kBAAkB,IAAI,UAAU,SAAS,IAAI,UAAU,MAAM,IAAI,UAAU,aAAa;gCAEzH,oCAAoC;gCACpC,MAAM,cAAc,UAAU,8BAA8B,IAAI,UAAU,aAAa,IACrF,UAAU,eAAe,IAAI,UAAU,oBAAoB;gCAE7D,0BAA0B;gCAC1B,MAAM,UAAU,UAAU,wBAAwB,KAAK,QACrD,UAAU,sBAAsB,KAAK,QAAQ,UAAU,wBAAwB,KAAK;gCAEtF,qBACE,oNAAC,kKAAI;oCAAC,WAAU;;sDACd,oNAAC,wKAAU;4CAAC,WAAU;sDACpB,cAAA,oNAAC;gDAAI,WAAU;;kEACb,oNAAC;wDAAI,WAAU;;0EACb,oNAAC,uKAAS;gEAAC,WAAU;0EAAU;;;;;;4DAC9B,CAAC,UAAU,eAAe,IAAI,UAAU,OAAO,mBAC9C,oNAAC,6KAAe;gEAAC,WAAU;;oEACxB,UAAU,eAAe,IAAI,WAAW,UAAU,eAAe;oEACjE,UAAU,eAAe,IAAI,UAAU,OAAO,IAAI;oEAClD,UAAU,OAAO,IAAI,CAAC,QAAQ,EAAE,UAAU,OAAO,EAAE;;;;;;;;;;;;;oDAIzD,UAAU,yBAAyB,kBAClC,oNAAC,sKAAM;wDAAC,SAAS;wDAAwB,MAAK;wDAAK,WAAU;;0EAC3D,oNAAC,iOAAG;gEAAC,WAAU;;;;;;4DAAY;;;;;;;;;;;;;;;;;;sDAOnC,oNAAC,yKAAW;4CAAC,WAAU;;gDAEpB,UAAU,oBAAoB,kBAC7B,oNAAC;oDAAI,WAAU;;sEACb,oNAAC;4DAAI,WAAU;sEAAkE;;;;;;sEACjF,oNAAC;4DAAI,WAAU;sEAA6D,UAAU,oBAAoB;;;;;;;;;;;;gDAK7G,CAAC,UAAU,eAAe,IAAI,UAAU,mBAAmB,mBAC1D,oNAAC;;sEACC,oNAAC;4DAAG,WAAU;sEAAmD;;;;;;sEACjE,oNAAC;4DAAI,WAAU;sEACZ,UAAU,eAAe,iBACxB,oNAAC;gEAAI,yBAAyB;oEAAE,QAAQ,UAAU,eAAe;gEAAC;;;;;qFAElE,oNAAC;gEAAE,WAAU;0EAA0C,UAAU,mBAAmB;;;;;;;;;;;;;;;;;gDAO3F,CAAC,UAAU,gBAAgB,IAAI,UAAU,cAAc,mBACtD,oNAAC;oDAAI,WAAU;;wDACZ,UAAU,gBAAgB,kBACzB,oNAAC;4DAAI,WAAU;;8EACb,oNAAC;oEAAI,WAAU;;wEAAqC;wEAAa,YAAY,QAAQ;wEAAC;;;;;;;8EACtF,oNAAC;oEAAI,WAAU;8EAAyB,eAAe,UAAU,gBAAgB,EAAE,YAAY,QAAQ;;;;;;;;;;;;wDAG1G,UAAU,cAAc,kBACvB,oNAAC;4DAAI,WAAU;;8EACb,oNAAC;oEAAI,WAAU;8EAAqC;;;;;;8EACpD,oNAAC;oEAAI,WAAU;8EAAyB,eAAe,UAAU,cAAc,EAAE,YAAY,QAAQ;;;;;;;;;;;;;;;;;;gDAO5G,yBACC,oNAAC;;sEACC,oNAAC;4DAAG,WAAU;sEAAmD;;;;;;sEACjE,oNAAC;4DAAI,WAAU;;gEACZ,UAAU,wBAAwB,KAAK,sBACtC,oNAAC;oEAAI,WAAU;;sFACb,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;;gFAA2B,UAAU,wBAAwB;gFAAC;;;;;;;;;;;;;gEAGhF,UAAU,sBAAsB,KAAK,sBACpC,oNAAC;oEAAI,WAAU;;sFACb,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;;gFAA2B,UAAU,sBAAsB;gFAAC;;;;;;;sFAC3E,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;wEAC9C,UAAU,qBAAqB,kBAC9B,oNAAC;4EAAE,WAAU;sFAAoD,UAAU,qBAAqB;;;;;;;;;;;;gEAIrG,UAAU,wBAAwB,KAAK,sBACtC,oNAAC;oEAAI,WAAU;;sFACb,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;;gFAA2B,UAAU,wBAAwB;gFAAC;;;;;;;wEAC5E,UAAU,sBAAsB,kBAC/B,oNAAC;4EAAE,WAAU;sFAAoD,UAAU,sBAAsB;;;;;;;;;;;;;;;;;;;;;;;;gDAS5G,uCACC,oNAAC;;sEACC,oNAAC;4DAAG,WAAU;sEAAmD;;;;;;sEACjE,oNAAC;4DAAI,WAAU;;gEACZ,UAAU,gBAAgB,kBACzB,oNAAC;;sFACC,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAe,UAAU,gBAAgB;;;;;;;;;;;;gEAG3D,UAAU,SAAS,kBAClB,oNAAC;;sFACC,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAe,UAAU,SAAS;;;;;;;;;;;;gEAGpD,UAAU,MAAM,kBACf,oNAAC;;sFACC,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAe,UAAU,MAAM;;;;;;;;;;;;gEAGjD,UAAU,OAAO,kBAChB,oNAAC;;sFACC,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAe,UAAU,OAAO;;;;;;;;;;;;gEAGlD,UAAU,kBAAkB,kBAC3B,oNAAC;;sFACC,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAe,UAAU,kBAAkB;;;;;;;;;;;;gEAG7D,UAAU,SAAS,kBAClB,oNAAC;;sFACC,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAe,UAAU,SAAS;;;;;;;;;;;;gEAGpD,UAAU,MAAM,kBACf,oNAAC;;sFACC,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAe,UAAU,MAAM;;;;;;;;;;;;gEAGjD,UAAU,aAAa,kBACtB,oNAAC;;sFACC,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAe,UAAU,aAAa;;;;;;;;;;;;;;;;;;;;;;;;gDAQ9D,6BACC,oNAAC;;sEACC,oNAAC;4DAAG,WAAU;sEAAmD;;;;;;sEACjE,oNAAC;4DAAI,WAAU;;gEACZ,UAAU,8BAA8B,kBACvC,oNAAC;oEAAI,WAAU;;sFACb,oNAAC;4EAAI,WAAU;sFAAyD;;;;;;sFACxE,oNAAC;4EAAI,WAAU;sFAAyD,WAAW,UAAU,8BAA8B;;;;;;;;;;;;gEAG9H,UAAU,aAAa,kBACtB,oNAAC;oEAAI,WAAU;;sFACb,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFAAoB,WAAW,UAAU,aAAa;;;;;;;;;;;;gEAGxE,CAAC,UAAU,eAAe,IAAI,UAAU,oBAAoB,mBAC3D,oNAAC;oEAAI,WAAU;;sFACb,oNAAC;4EAAI,WAAU;sFAAgC;;;;;;sFAC/C,oNAAC;4EAAI,WAAU;sFACZ,UAAU,eAAe,GACtB,WAAW,UAAU,eAAe,IACpC,UAAU,oBAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAUtD,CAAC;4BAGA,YAAY,WAAW,CAAC,MAAM,GAAG,mBAChC,oNAAC,kKAAI;;kDACH,oNAAC,wKAAU;;0DACT,oNAAC,uKAAS;gDAAC,WAAU;;kEACnB,oNAAC,uOAAK;wDAAC,WAAU;;;;;;oDAAY;;;;;;;0DAG/B,oNAAC,6KAAe;0DAAC;;;;;;;;;;;;kDAInB,oNAAC,yKAAW;kDACV,cAAA,oNAAC;4CAAI,WAAU;sDACZ,YAAY,WAAW,CAAC,GAAG,CAAC,CAAC,0BAC5B,oNAAC;oDAAuB,WAAU;;sEAChC,oNAAC;4DAAI,WAAU;sEACb,cAAA,oNAAC,uOAAK;gEAAC,WAAU;;;;;;;;;;;sEAEnB,oNAAC;;8EACC,oNAAC;oEAAI,WAAU;8EAAe,UAAU,SAAS;;;;;;8EACjD,oNAAC;oEAAI,WAAU;8EAAiC,UAAU,KAAK;;;;;;;;;;;;;mDANzD,UAAU,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;oBAkBhC,YAAY,eAAe,EAAE,uBAAuB,uBACpD,oNAAC,yKAAW;wBAAC,OAAM;wBAAY,WAAU;;4BAEtC,YAAY,SAAS,CAAC,UAAU,IAAI,YAAY,SAAS,CAAC,cAAc,kBACvE,oNAAC,kKAAI;0CACH,cAAA,oNAAC,yKAAW;oCAAC,WAAU;8CACrB,cAAA,oNAAC;wCAAI,WAAU;;0DACb,oNAAC;gDAAI,WAAU;;kEACb,oNAAC,+PAAY;wDAAC,WAAU;;;;;;oDAA6B;oDACpC,WAAW,YAAY,SAAS,CAAC,cAAc,CAAC,UAAU;oDAC1E,YAAY,eAAe,EAAE,2CAC5B,oNAAC;wDAAK,WAAU;kEAAwE;;;;;;;;;;;;4CAK3F,YAAY,SAAS,CAAC,cAAc,CAAC,UAAU,kBAC9C,oNAAC;gDAAI,WAAU;;kEACb,oNAAC,uOAAK;wDAAC,WAAU;;;;;;oDAAY;oDACnB,WAAW,YAAY,SAAS,CAAC,cAAc,CAAC,UAAU;;;;;;;;;;;;;;;;;;;;;;;0CAShF,oNAAC,iMAAc;gCACb,WAAW,YAAY,SAAS,CAAC,SAAS;gCAC1C,WAAW,YAAY,SAAS,CAAC,UAAU;gCAC3C,aAAa,YAAY,SAAS,CAAC,YAAY;gCAC/C,QAAQ,YAAY,EAAE;gCACtB,iBAAiB,YAAY,YAAY,GAAG,IAAM,iBAAiB,QAAQ;;;;;;;;;;;;kCAMjF,oNAAC,yKAAW;wBAAC,OAAM;wBAAO,WAAU;kCACjC,YAAY,IAAI,CAAC,MAAM,KAAK,kBAC3B,oNAAC,kKAAI;sCACH,cAAA,oNAAC,yKAAW;gCAAC,WAAU;;kDACrB,oNAAC,sQAAU;wCAAC,WAAU;;;;;;kDACtB,oNAAC;wCAAG,WAAU;kDAA2B;;;;;;kDACzC,oNAAC;wCAAE,WAAU;kDAAwB;;;;;;;;;;;;;;;;iDAMzC,oNAAC,kKAAI;;8CACH,oNAAC,wKAAU;8CACT,cAAA,oNAAC,uKAAS;kDAAC;;;;;;;;;;;8CAEb,oNAAC,yKAAW;8CACV,cAAA,oNAAC,4KAAS;wCAAC,MAAK;wCAAS,WAAW;wCAAC,WAAU;kDAC5C,YAAY,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,sBAC1B,oNAAC,gLAAa;gDAAc,OAAO,CAAC,IAAI,EAAE,OAAO;;kEAC/C,oNAAC,mLAAgB;kEAAE,IAAI,QAAQ;;;;;;kEAC/B,oNAAC,mLAAgB;kEAAE,IAAI,MAAM;;;;;;;+CAFX,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAaxC,oNAAC,sKAAM;gBAAC,MAAM;gBAAoB,cAAc;0BAC9C,cAAA,oNAAC,6KAAa;oBAAC,WAAU;;sCACvB,oNAAC,4KAAY;;8CACX,oNAAC;oCAAI,WAAU;;sDACb,oNAAC;4CAAI,WAAU;sDACb,cAAA,oNAAC,0PAAU;gDAAC,WAAU;;;;;;;;;;;sDAExB,oNAAC,2KAAW;4CAAC,WAAU;sDAAU;;;;;;;;;;;;8CAEnC,oNAAC,iLAAiB;oCAAC,WAAU;;wCAAY;wCACW,YAAY,IAAI;wCAAC;;;;;;;;;;;;;sCAKvE,oNAAC;4BAAI,WAAU;sCACb,cAAA,oNAAC;gCAAI,WAAU;;kDACb,oNAAC;wCAAI,WAAU;;0DACb,oNAAC;gDAAI,WAAU;0DAAmI;;;;;;0DAClJ,oNAAC;;kEACC,oNAAC;wDAAI,WAAU;kEAAc;;;;;;kEAC7B,oNAAC;wDAAI,WAAU;kEAAwB;;;;;;;;;;;;;;;;;;kDAG3C,oNAAC;wCAAI,WAAU;;0DACb,oNAAC;gDAAI,WAAU;0DAAmI;;;;;;0DAClJ,oNAAC;;kEACC,oNAAC;wDAAI,WAAU;kEAAc;;;;;;kEAC7B,oNAAC;wDAAI,WAAU;kEAAwB;;;;;;;;;;;;;;;;;;kDAG3C,oNAAC;wCAAI,WAAU;;0DACb,oNAAC;gDAAI,WAAU;0DAA4I;;;;;;0DAC3J,oNAAC;;kEACC,oNAAC;wDAAI,WAAU;kEAAc;;;;;;kEAC7B,oNAAC;wDAAI,WAAU;kEAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAM/C,oNAAC,4KAAY;4BAAC,WAAU;;8CACtB,oNAAC,sKAAM;oCAAC,SAAQ;oCAAU,SAAS,IAAM,sBAAsB;8CAAQ;;;;;;8CAGvE,oNAAC,sKAAM;oCAAC,SAAS;oCAAuB,UAAU;oCAAe,WAAU;8CACxE,gBAAgB,gCACf;;0DACE,oNAAC,0PAAU;gDAAC,WAAU;;;;;;4CAAY;;;;;;;;;;;;;;;;;;;;;;;;;0BAU9C,oNAAC,sKAAM;gBAAC,MAAM;gBAAe,cAAc;0BACzC,cAAA,oNAAC,6KAAa;;sCACZ,oNAAC,4KAAY;;8CACX,oNAAC,2KAAW;8CAAC;;;;;;8CACb,oNAAC,iLAAiB;8CAAC;;;;;;;;;;;;sCAIrB,oNAAC;4BAAI,WAAU;;8CACb,oNAAC;oCAAI,WAAU;8CACb,cAAA,oNAAC;wCAAI,WAAU;;0DACb,oNAAC,+PAAY;gDAAC,WAAU;;;;;;0DACxB,oNAAC;gDAAI,WAAU;;kEACb,oNAAC;wDAAE,WAAU;kEAA+C;;;;;;kEAC5D,oNAAC;wDAAE,WAAU;;4DAAwC;4DAEjD,YAAY,WAAW,CAAC,MAAM;4DAAC;;;;;;;;;;;;;;;;;;;;;;;;8CAKzC,oNAAC;oCAAI,WAAU;8CACb,cAAA,oNAAC;wCAAI,WAAU;;0DACb,oNAAC,6PAAW;gDAAC,WAAU;;;;;;0DACvB,oNAAC;gDAAI,WAAU;;kEACb,oNAAC;wDAAE,WAAU;kEAAiD;;;;;;kEAC9D,oNAAC;wDAAE,WAAU;;4DAA0C;0EACT,oNAAC;0EAAO;;;;;;4DAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAOtF,oNAAC,4KAAY;sCACX,cAAA,oNAAC,sKAAM;gCAAC,SAAS,IAAM,iBAAiB;0CAAQ;;;;;;;;;;;;;;;;;;;;;;0BAQtD,oNAAC,sKAAM;gBAAC,MAAM;gBAAqB,cAAc;0BAC/C,cAAA,oNAAC,6KAAa;;sCACZ,oNAAC,4KAAY;;8CACX,oNAAC,2KAAW;8CAAC;;;;;;8CACb,oNAAC,iLAAiB;;wCAAC;wCACkD,YAAY,IAAI;wCAAC;;;;;;;;;;;;;sCAIxF,oNAAC;4BAAI,WAAU;;8CACb,oNAAC;oCAAI,WAAU;;sDACb,oNAAC,oKAAK;4CAAC,SAAQ;;gDAAS;gDAAoB,YAAY,QAAQ;gDAAC;;;;;;;sDACjE,oNAAC,oKAAK;4CACJ,IAAG;4CACH,MAAK;4CACL,aAAa,CAAC,KAAK,EAAE,eAAe,YAAY,kBAAkB,EAAE,YAAY,QAAQ,GAAG;4CAC3F,OAAO;4CACP,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,KAAK;;;;;;wCAEnD,YAAY,kBAAkB,IAAI,YAAY,kBAAkB,kBAC/D,oNAAC;4CAAE,WAAU;;gDAAgC;gDACnC,eAAe,YAAY,kBAAkB,EAAE,YAAY,QAAQ;gDAAE;gDAAI,eAAe,YAAY,kBAAkB,EAAE,YAAY,QAAQ;;;;;;;;;;;;;gCAKzJ,YAAY,WAAW,CAAC,MAAM,GAAG,mBAChC,oNAAC;oCAAI,WAAU;8CACb,cAAA,oNAAC;wCAAI,WAAU;;0DACb,oNAAC,qQAAa;gDAAC,WAAU;;;;;;0DACzB,oNAAC;gDAAI,WAAU;;kEACb,oNAAC;wDAAE,WAAU;;4DACV,YAAY,WAAW,CAAC,MAAM;4DAAC;;;;;;;kEAElC,oNAAC;wDAAE,WAAU;kEAAwC;;;;;;kEAGrD,oNAAC;wDAAE,WAAU;kEAAkD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAQzE,oNAAC,4KAAY;;8CACX,oNAAC,sKAAM;oCAAC,SAAQ;oCAAU,SAAS,IAAM,uBAAuB;8CAAQ;;;;;;8CAGxE,oNAAC,sKAAM;oCACL,SAAS;oCACT,UAAU,iBAAiB,CAAC,mBAAoB,YAAY,kBAAkB,KAAK,QAAQ,WAAW,mBAAmB,YAAY,kBAAkB;8CAEtJ,gBAAgB,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;0BAO3C,oNAAC,iNAAwB;gBACvB,QAAQ;gBACR,UAAU;gBACV,YAAY;gBACZ,WAAW;gBACX,OAAO;gBACP,SAAS;oBACP,eAAe;oBACf,cAAc;oBACd,gBAAgB;oBAChB,mBAAmB;gBACrB;gBACA,YAAY;oBACV,IAAI,YAAY;wBACd,OAAO,IAAI,CAAC,YAAY;oBAC1B;gBACF;;;;;;;;;;;;AAIR;GAxoCwB;;QACP,yKAAS;QACT,yKAAS;QACH,+KAAe;QAKqD,8KAAU;QAoB3D,iNAAY;;;KA5B9B"}}]
}