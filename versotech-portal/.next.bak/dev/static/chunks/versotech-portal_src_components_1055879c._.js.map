{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAIA,MAAM,yBAAW,kMAAgB,MAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,oNAAC;QACC,WAAW,IAAA,mJAAE,EACX,+RACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 158, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,iMAAG,EACvB,6JACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,kMAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,oNAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,IAAA,mJAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,kMAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,oNAAC;QACC,KAAK;QACL,WAAW,IAAA,mJAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,kMAAgB,OAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,oNAAC;QACC,KAAK;QACL,WAAW,IAAA,mJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG"}},
    {"offset": {"line": 236, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/interest-modal.tsx"],"sourcesContent":["'use client'\n\nimport { useCallback, useState } from 'react'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\nimport { Loader2, CheckCircle2, Sparkles } from 'lucide-react'\n\ninterface InterestModalProps {\n  dealId: string\n  dealName: string\n  currency?: string | null\n  investorId: string\n  defaultAmount?: number | null\n  isClosed?: boolean\n  onSubmitted?: () => Promise<void> | void\n  children: React.ReactNode\n}\n\nexport function InterestModal({\n  dealId,\n  dealName,\n  currency,\n  investorId,\n  defaultAmount,\n  isClosed = false,\n  onSubmitted,\n  children\n}: InterestModalProps) {\n  const [open, setOpen] = useState(false)\n  const [indicativeAmount, setIndicativeAmount] = useState(\n    defaultAmount ? defaultAmount.toString() : ''\n  )\n  const [notes, setNotes] = useState('')\n  const [submitting, setSubmitting] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [success, setSuccess] = useState(false)\n\n  const resetState = useCallback(() => {\n    setIndicativeAmount(defaultAmount ? defaultAmount.toString() : '')\n    setNotes('')\n    setSubmitting(false)\n    setError(null)\n    setSuccess(false)\n  }, [defaultAmount])\n\n  const handleOpenChange = (nextOpen: boolean) => {\n    setOpen(nextOpen)\n    if (!nextOpen) {\n      resetState()\n    }\n  }\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault()\n    setSubmitting(true)\n    setError(null)\n\n    try {\n      const parsedAmount = indicativeAmount.trim()\n      const payload: Record<string, unknown> = {\n        investor_id: investorId,\n        notes: notes.trim() || undefined\n      }\n\n      if (parsedAmount) {\n        const numericAmount = Number(parsedAmount.replace(/[^0-9.]/g, ''))\n        if (Number.isFinite(numericAmount) && numericAmount > 0) {\n          payload.indicative_amount = numericAmount\n          if (currency) {\n            payload.indicative_currency = currency\n          }\n        } else {\n          throw new Error('Enter a valid indicative amount or leave the field blank.')\n        }\n      }\n\n      if (isClosed) {\n        payload.is_post_close = true\n      }\n\n      const response = await fetch(`/api/deals/${dealId}/interests`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      })\n\n      if (!response.ok) {\n        const body = await response.json().catch(() => ({}))\n        throw new Error(body?.error || 'Unable to submit interest right now.')\n      }\n\n      setSuccess(true)\n      if (onSubmitted) {\n        await onSubmitted()\n      }\n\n      setTimeout(() => {\n        setOpen(false)\n        resetState()\n      }, 1500)\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Unexpected error'\n      setError(message)\n    } finally {\n      setSubmitting(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={handleOpenChange}>\n      <DialogTrigger asChild>{children}</DialogTrigger>\n      <DialogContent className=\"max-w-lg\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Sparkles className=\"h-5 w-5 text-blue-600\" />\n            {isClosed ? \"Notify Me About Similar Deals\" : \"Submit Interest for Data Room\"}\n          </DialogTitle>\n          <DialogDescription>\n            {isClosed\n              ? `Let the VERSO team know you're interested in similar opportunities to ${dealName}. We'll notify you when comparable deals become available.`\n              : `Submit your interest to access the data room for ${dealName}. Once approved, you'll receive the NDA to sign.`\n            }\n          </DialogDescription>\n        </DialogHeader>\n\n        {success ? (\n          <div className=\"flex flex-col items-center justify-center py-10 text-center\">\n            <CheckCircle2 className=\"h-12 w-12 text-green-500 mb-4\" />\n            <p className=\"text-lg font-semibold text-green-700\">\n              Interest submitted\n            </p>\n            <p className=\"text-sm text-green-600\">\n              We&apos;ll notify you as soon as the team responds.\n            </p>\n          </div>\n        ) : (\n          <form className=\"space-y-5\" onSubmit={handleSubmit}>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"indicative-amount\">\n                Indicative amount or range\n              </Label>\n              <Input\n                id=\"indicative-amount\"\n                placeholder={`e.g. ${currency ?? ''} 250k`}\n                value={indicativeAmount}\n                onChange={(event) => setIndicativeAmount(event.target.value)}\n                inputMode=\"decimal\"\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Optional â€” helps the team size the allocation. You can share a single number or range.\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"interest-notes\">Notes for the team</Label>\n              <Textarea\n                id=\"interest-notes\"\n                placeholder=\"Add any context or questions you'd like the team to review.\"\n                value={notes}\n                onChange={(event) => setNotes(event.target.value)}\n                rows={4}\n              />\n            </div>\n\n            {error && (\n              <Alert variant=\"destructive\">\n                <AlertDescription>{error}</AlertDescription>\n              </Alert>\n            )}\n\n            <div className=\"flex items-center justify-end gap-3\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => handleOpenChange(false)}\n                disabled={submitting}\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={submitting}>\n                {submitting ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                    Sending\n                  </>\n                ) : (\n                  'Submit interest'\n                )}\n              </Button>\n            </div>\n          </form>\n        )}\n      </DialogContent>\n    </Dialog>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;AAhBA;;;;;;;;;AA6BO,SAAS,cAAc,EAC5B,MAAM,EACN,QAAQ,EACR,QAAQ,EACR,UAAU,EACV,aAAa,EACb,WAAW,KAAK,EAChB,WAAW,EACX,QAAQ,EACW;;IACnB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,gMAAQ,EAAC;IACjC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,gMAAQ,EACtD,gBAAgB,cAAc,QAAQ,KAAK;IAE7C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gMAAQ,EAAC;IACnC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,gMAAQ,EAAC;IAC7C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gMAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gMAAQ,EAAC;IAEvC,MAAM,aAAa,IAAA,mMAAW;iDAAC;YAC7B,oBAAoB,gBAAgB,cAAc,QAAQ,KAAK;YAC/D,SAAS;YACT,cAAc;YACd,SAAS;YACT,WAAW;QACb;gDAAG;QAAC;KAAc;IAElB,MAAM,mBAAmB,CAAC;QACxB,QAAQ;QACR,IAAI,CAAC,UAAU;YACb;QACF;IACF;IAEA,MAAM,eAAe,OAAO;QAC1B,MAAM,cAAc;QACpB,cAAc;QACd,SAAS;QAET,IAAI;YACF,MAAM,eAAe,iBAAiB,IAAI;YAC1C,MAAM,UAAmC;gBACvC,aAAa;gBACb,OAAO,MAAM,IAAI,MAAM;YACzB;YAEA,IAAI,cAAc;gBAChB,MAAM,gBAAgB,OAAO,aAAa,OAAO,CAAC,YAAY;gBAC9D,IAAI,OAAO,QAAQ,CAAC,kBAAkB,gBAAgB,GAAG;oBACvD,QAAQ,iBAAiB,GAAG;oBAC5B,IAAI,UAAU;wBACZ,QAAQ,mBAAmB,GAAG;oBAChC;gBACF,OAAO;oBACL,MAAM,IAAI,MAAM;gBAClB;YACF;YAEA,IAAI,UAAU;gBACZ,QAAQ,aAAa,GAAG;YAC1B;YAEA,MAAM,WAAW,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,UAAU,CAAC,EAAE;gBAC7D,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,OAAO,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;gBAClD,MAAM,IAAI,MAAM,MAAM,SAAS;YACjC;YAEA,WAAW;YACX,IAAI,aAAa;gBACf,MAAM;YACR;YAEA,WAAW;gBACT,QAAQ;gBACR;YACF,GAAG;QACL,EAAE,OAAO,KAAK;YACZ,MAAM,UAAU,eAAe,QAAQ,IAAI,OAAO,GAAG;YACrD,SAAS;QACX,SAAU;YACR,cAAc;QAChB;IACF;IAEA,qBACE,oNAAC,sKAAM;QAAC,MAAM;QAAM,cAAc;;0BAChC,oNAAC,6KAAa;gBAAC,OAAO;0BAAE;;;;;;0BACxB,oNAAC,6KAAa;gBAAC,WAAU;;kCACvB,oNAAC,4KAAY;;0CACX,oNAAC,2KAAW;gCAAC,WAAU;;kDACrB,oNAAC,gPAAQ;wCAAC,WAAU;;;;;;oCACnB,WAAW,kCAAkC;;;;;;;0CAEhD,oNAAC,iLAAiB;0CACf,WACG,CAAC,sEAAsE,EAAE,SAAS,0DAA0D,CAAC,GAC7I,CAAC,iDAAiD,EAAE,SAAS,gDAAgD,CAAC;;;;;;;;;;;;oBAKrH,wBACC,oNAAC;wBAAI,WAAU;;0CACb,oNAAC,+PAAY;gCAAC,WAAU;;;;;;0CACxB,oNAAC;gCAAE,WAAU;0CAAuC;;;;;;0CAGpD,oNAAC;gCAAE,WAAU;0CAAyB;;;;;;;;;;;6CAKxC,oNAAC;wBAAK,WAAU;wBAAY,UAAU;;0CACpC,oNAAC;gCAAI,WAAU;;kDACb,oNAAC,oKAAK;wCAAC,SAAQ;kDAAoB;;;;;;kDAGnC,oNAAC,oKAAK;wCACJ,IAAG;wCACH,aAAa,CAAC,KAAK,EAAE,YAAY,GAAG,KAAK,CAAC;wCAC1C,OAAO;wCACP,UAAU,CAAC,QAAU,oBAAoB,MAAM,MAAM,CAAC,KAAK;wCAC3D,WAAU;;;;;;kDAEZ,oNAAC;wCAAE,WAAU;kDAAgC;;;;;;;;;;;;0CAK/C,oNAAC;gCAAI,WAAU;;kDACb,oNAAC,oKAAK;wCAAC,SAAQ;kDAAiB;;;;;;kDAChC,oNAAC,0KAAQ;wCACP,IAAG;wCACH,aAAY;wCACZ,OAAO;wCACP,UAAU,CAAC,QAAU,SAAS,MAAM,MAAM,CAAC,KAAK;wCAChD,MAAM;;;;;;;;;;;;4BAIT,uBACC,oNAAC,oKAAK;gCAAC,SAAQ;0CACb,cAAA,oNAAC,+KAAgB;8CAAE;;;;;;;;;;;0CAIvB,oNAAC;gCAAI,WAAU;;kDACb,oNAAC,sKAAM;wCACL,MAAK;wCACL,SAAQ;wCACR,SAAS,IAAM,iBAAiB;wCAChC,UAAU;kDACX;;;;;;kDAGD,oNAAC,sKAAM;wCAAC,MAAK;wCAAS,UAAU;kDAC7B,2BACC;;8DACE,oNAAC,sPAAO;oDAAC,WAAU;;;;;;gDAA8B;;2DAInD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASlB;GAjLgB;KAAA"}},
    {"offset": {"line": 567, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/checkbox.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-5 w-5 md:h-4 md:w-4 shrink-0 rounded border border-white/20 bg-white/5 data-[state=checked]:bg-blue-600 data-[state=checked]:border-blue-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-400/20 focus-visible:border-blue-400/50 disabled:cursor-not-allowed disabled:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-white\")}\n    >\n      <Check className=\"h-4 w-4 md:h-3.5 md:w-3.5\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,yBAAW,kMAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,oNAAC,sMAAsB;QACrB,KAAK;QACL,WAAW,IAAA,mJAAE,EACX,uTACA;QAED,GAAG,KAAK;kBAET,cAAA,oNAAC,2MAA2B;YAC1B,WAAW,IAAA,mJAAE,EAAC;sBAEd,cAAA,oNAAC,uOAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,sMAAsB,CAAC,WAAW"}},
    {"offset": {"line": 618, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/radio-group.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { CircleIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction RadioGroup({\n  className,\n  ...props\n}: React.ComponentProps<typeof RadioGroupPrimitive.Root>) {\n  return (\n    <RadioGroupPrimitive.Root\n      data-slot=\"radio-group\"\n      className={cn(\"grid gap-3\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction RadioGroupItem({\n  className,\n  ...props\n}: React.ComponentProps<typeof RadioGroupPrimitive.Item>) {\n  return (\n    <RadioGroupPrimitive.Item\n      data-slot=\"radio-group-item\"\n      className={cn(\n        \"border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-5 md:size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator\n        data-slot=\"radio-group-indicator\"\n        className=\"relative flex items-center justify-center\"\n      >\n        <CircleIcon className=\"fill-primary absolute top-1/2 left-1/2 size-2.5 md:size-2 -translate-x-1/2 -translate-y-1/2\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n}\n\nexport { RadioGroup, RadioGroupItem }\n"],"names":[],"mappings":";;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,WAAW,EAClB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,oNAAC,4MAAwB;QACvB,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,cAAc;QAC3B,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,eAAe,EACtB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,oNAAC,4MAAwB;QACvB,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,oYACA;QAED,GAAG,KAAK;kBAET,cAAA,oNAAC,iNAA6B;YAC5B,aAAU;YACV,WAAU;sBAEV,cAAA,oNAAC,kPAAU;gBAAC,WAAU;;;;;;;;;;;;;;;;AAI9B;MArBS"}},
    {"offset": {"line": 683, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/profile/entity-form-dialog.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Building2, MapPin, User, FileText, Loader2 } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport { toast } from 'sonner'\r\n\r\ninterface CounterpartyEntity {\r\n  id: string\r\n  entity_type: string\r\n  legal_name: string\r\n  registration_number?: string\r\n  jurisdiction?: string\r\n  tax_id?: string\r\n  formation_date?: string\r\n  registered_address?: {\r\n    street?: string\r\n    city?: string\r\n    state?: string\r\n    postal_code?: string\r\n    country?: string\r\n  }\r\n  representative_name?: string\r\n  representative_title?: string\r\n  representative_email?: string\r\n  representative_phone?: string\r\n  notes?: string\r\n}\r\n\r\ninterface EntityFormDialogProps {\r\n  open: boolean\r\n  onClose: () => void\r\n  onSuccess: () => void\r\n  entity?: CounterpartyEntity | null\r\n}\r\n\r\nexport function EntityFormDialog({ open, onClose, onSuccess, entity }: EntityFormDialogProps) {\r\n  const [saving, setSaving] = useState(false)\r\n  const [formData, setFormData] = useState({\r\n    entity_type: '',\r\n    legal_name: '',\r\n    registration_number: '',\r\n    jurisdiction: '',\r\n    tax_id: '',\r\n    formation_date: '',\r\n    address_street: '',\r\n    address_city: '',\r\n    address_state: '',\r\n    address_postal_code: '',\r\n    address_country: '',\r\n    representative_name: '',\r\n    representative_title: '',\r\n    representative_email: '',\r\n    representative_phone: '',\r\n    notes: ''\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (entity) {\r\n      setFormData({\r\n        entity_type: entity.entity_type || '',\r\n        legal_name: entity.legal_name || '',\r\n        registration_number: entity.registration_number || '',\r\n        jurisdiction: entity.jurisdiction || '',\r\n        tax_id: entity.tax_id || '',\r\n        formation_date: entity.formation_date || '',\r\n        address_street: entity.registered_address?.street || '',\r\n        address_city: entity.registered_address?.city || '',\r\n        address_state: entity.registered_address?.state || '',\r\n        address_postal_code: entity.registered_address?.postal_code || '',\r\n        address_country: entity.registered_address?.country || '',\r\n        representative_name: entity.representative_name || '',\r\n        representative_title: entity.representative_title || '',\r\n        representative_email: entity.representative_email || '',\r\n        representative_phone: entity.representative_phone || '',\r\n        notes: entity.notes || ''\r\n      })\r\n    } else {\r\n      setFormData({\r\n        entity_type: '',\r\n        legal_name: '',\r\n        registration_number: '',\r\n        jurisdiction: '',\r\n        tax_id: '',\r\n        formation_date: '',\r\n        address_street: '',\r\n        address_city: '',\r\n        address_state: '',\r\n        address_postal_code: '',\r\n        address_country: '',\r\n        representative_name: '',\r\n        representative_title: '',\r\n        representative_email: '',\r\n        representative_phone: '',\r\n        notes: ''\r\n      })\r\n    }\r\n  }, [entity, open])\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n\r\n    if (!formData.entity_type || !formData.legal_name) {\r\n      toast.error('Please fill in all required fields')\r\n      return\r\n    }\r\n\r\n    setSaving(true)\r\n\r\n    try {\r\n      const payload = {\r\n        entity_type: formData.entity_type,\r\n        legal_name: formData.legal_name,\r\n        registration_number: formData.registration_number || null,\r\n        jurisdiction: formData.jurisdiction || null,\r\n        tax_id: formData.tax_id || null,\r\n        formation_date: formData.formation_date || null,\r\n        registered_address: {\r\n          street: formData.address_street || undefined,\r\n          city: formData.address_city || undefined,\r\n          state: formData.address_state || undefined,\r\n          postal_code: formData.address_postal_code || undefined,\r\n          country: formData.address_country || undefined\r\n        },\r\n        representative_name: formData.representative_name || null,\r\n        representative_title: formData.representative_title || null,\r\n        representative_email: formData.representative_email || null,\r\n        representative_phone: formData.representative_phone || null,\r\n        notes: formData.notes || null\r\n      }\r\n\r\n      const url = entity\r\n        ? `/api/investors/me/counterparty-entities/${entity.id}`\r\n        : '/api/investors/me/counterparty-entities'\r\n\r\n      const method = entity ? 'PATCH' : 'POST'\r\n\r\n      const response = await fetch(url, {\r\n        method,\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const error = await response.json()\r\n        throw new Error(error.error || 'Failed to save entity')\r\n      }\r\n\r\n      toast.success(entity ? 'Entity updated successfully' : 'Entity created successfully')\r\n      onSuccess()\r\n    } catch (error: any) {\r\n      console.error('Save error:', error)\r\n      toast.error(error.message || 'Failed to save entity')\r\n    } finally {\r\n      setSaving(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-hidden flex flex-col p-0\">\r\n        {/* Header */}\r\n        <DialogHeader className=\"px-8 pt-8 pb-6 border-b border-slate-100 bg-gradient-to-b from-slate-50/80 to-white\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"w-12 h-12 rounded-xl bg-emerald-500/10 flex items-center justify-center\">\r\n              <Building2 className=\"w-6 h-6 text-emerald-600\" />\r\n            </div>\r\n            <div>\r\n              <DialogTitle className=\"text-xl font-semibold text-slate-900\">\r\n                {entity ? 'Edit Entity' : 'Add New Entity'}\r\n              </DialogTitle>\r\n              <p className=\"text-sm text-slate-500 mt-1\">\r\n                {entity\r\n                  ? 'Update the details of this legal entity'\r\n                  : 'Add a legal entity that you invest through'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </DialogHeader>\r\n\r\n        {/* Form Content */}\r\n        <form onSubmit={handleSubmit} className=\"flex-1 overflow-y-auto\">\r\n          <div className=\"px-8 py-8 space-y-10\">\r\n\r\n            {/* Section 1: Basic Information */}\r\n            <section className=\"space-y-5\">\r\n              <div className=\"flex items-center gap-3 pb-2\">\r\n                <div className=\"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center\">\r\n                  <Building2 className=\"w-4 h-4 text-slate-600\" />\r\n                </div>\r\n                <h3 className=\"font-medium text-slate-900\">Entity Information</h3>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-5\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"entity_type\" className=\"text-sm font-medium text-slate-700\">\r\n                    Entity Type <span className=\"text-rose-500\">*</span>\r\n                  </Label>\r\n                  <Select\r\n                    value={formData.entity_type}\r\n                    onValueChange={(value) => setFormData({ ...formData, entity_type: value })}\r\n                  >\r\n                    <SelectTrigger className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\">\r\n                      <SelectValue placeholder=\"Select entity type\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"trust\">Trust</SelectItem>\r\n                      <SelectItem value=\"llc\">LLC</SelectItem>\r\n                      <SelectItem value=\"partnership\">Partnership</SelectItem>\r\n                      <SelectItem value=\"family_office\">Family Office</SelectItem>\r\n                      <SelectItem value=\"law_firm\">Law Firm</SelectItem>\r\n                      <SelectItem value=\"investment_bank\">Investment Bank</SelectItem>\r\n                      <SelectItem value=\"fund\">Fund</SelectItem>\r\n                      <SelectItem value=\"corporation\">Corporation</SelectItem>\r\n                      <SelectItem value=\"other\">Other</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"legal_name\" className=\"text-sm font-medium text-slate-700\">\r\n                    Legal Name <span className=\"text-rose-500\">*</span>\r\n                  </Label>\r\n                  <Input\r\n                    id=\"legal_name\"\r\n                    value={formData.legal_name}\r\n                    onChange={(e) => setFormData({ ...formData, legal_name: e.target.value })}\r\n                    placeholder=\"Full legal name\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                    required\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-5\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"registration_number\" className=\"text-sm font-medium text-slate-700\">\r\n                    Registration Number\r\n                  </Label>\r\n                  <Input\r\n                    id=\"registration_number\"\r\n                    value={formData.registration_number}\r\n                    onChange={(e) => setFormData({ ...formData, registration_number: e.target.value })}\r\n                    placeholder=\"Company registration number\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"tax_id\" className=\"text-sm font-medium text-slate-700\">\r\n                    Tax ID / EIN\r\n                  </Label>\r\n                  <Input\r\n                    id=\"tax_id\"\r\n                    value={formData.tax_id}\r\n                    onChange={(e) => setFormData({ ...formData, tax_id: e.target.value })}\r\n                    placeholder=\"Tax ID or EIN\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-5\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"jurisdiction\" className=\"text-sm font-medium text-slate-700\">\r\n                    Jurisdiction\r\n                  </Label>\r\n                  <Input\r\n                    id=\"jurisdiction\"\r\n                    value={formData.jurisdiction}\r\n                    onChange={(e) => setFormData({ ...formData, jurisdiction: e.target.value })}\r\n                    placeholder=\"State or country of formation\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"formation_date\" className=\"text-sm font-medium text-slate-700\">\r\n                    Formation Date\r\n                  </Label>\r\n                  <Input\r\n                    id=\"formation_date\"\r\n                    type=\"date\"\r\n                    value={formData.formation_date}\r\n                    onChange={(e) => setFormData({ ...formData, formation_date: e.target.value })}\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </section>\r\n\r\n            {/* Section 2: Registered Address */}\r\n            <section className=\"space-y-5\">\r\n              <div className=\"flex items-center gap-3 pb-2\">\r\n                <div className=\"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center\">\r\n                  <MapPin className=\"w-4 h-4 text-slate-600\" />\r\n                </div>\r\n                <h3 className=\"font-medium text-slate-900\">Registered Address</h3>\r\n              </div>\r\n\r\n              <div className=\"space-y-5\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"address_street\" className=\"text-sm font-medium text-slate-700\">\r\n                    Street Address\r\n                  </Label>\r\n                  <Input\r\n                    id=\"address_street\"\r\n                    value={formData.address_street}\r\n                    onChange={(e) => setFormData({ ...formData, address_street: e.target.value })}\r\n                    placeholder=\"123 Main Street, Suite 100\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-5\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"address_city\" className=\"text-sm font-medium text-slate-700\">\r\n                      City\r\n                    </Label>\r\n                    <Input\r\n                      id=\"address_city\"\r\n                      value={formData.address_city}\r\n                      onChange={(e) => setFormData({ ...formData, address_city: e.target.value })}\r\n                      placeholder=\"City\"\r\n                      className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"address_state\" className=\"text-sm font-medium text-slate-700\">\r\n                      State / Province\r\n                    </Label>\r\n                    <Input\r\n                      id=\"address_state\"\r\n                      value={formData.address_state}\r\n                      onChange={(e) => setFormData({ ...formData, address_state: e.target.value })}\r\n                      placeholder=\"State or province\"\r\n                      className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-5\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"address_postal_code\" className=\"text-sm font-medium text-slate-700\">\r\n                      Postal Code\r\n                    </Label>\r\n                    <Input\r\n                      id=\"address_postal_code\"\r\n                      value={formData.address_postal_code}\r\n                      onChange={(e) => setFormData({ ...formData, address_postal_code: e.target.value })}\r\n                      placeholder=\"Postal code\"\r\n                      className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"address_country\" className=\"text-sm font-medium text-slate-700\">\r\n                      Country\r\n                    </Label>\r\n                    <Input\r\n                      id=\"address_country\"\r\n                      value={formData.address_country}\r\n                      onChange={(e) => setFormData({ ...formData, address_country: e.target.value })}\r\n                      placeholder=\"Country\"\r\n                      className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </section>\r\n\r\n            {/* Section 3: Authorized Representative */}\r\n            <section className=\"space-y-5\">\r\n              <div className=\"flex items-center gap-3 pb-2\">\r\n                <div className=\"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center\">\r\n                  <User className=\"w-4 h-4 text-slate-600\" />\r\n                </div>\r\n                <h3 className=\"font-medium text-slate-900\">Authorized Representative</h3>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-5\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"representative_name\" className=\"text-sm font-medium text-slate-700\">\r\n                    Full Name\r\n                  </Label>\r\n                  <Input\r\n                    id=\"representative_name\"\r\n                    value={formData.representative_name}\r\n                    onChange={(e) => setFormData({ ...formData, representative_name: e.target.value })}\r\n                    placeholder=\"Representative's full name\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"representative_title\" className=\"text-sm font-medium text-slate-700\">\r\n                    Title / Role\r\n                  </Label>\r\n                  <Input\r\n                    id=\"representative_title\"\r\n                    value={formData.representative_title}\r\n                    onChange={(e) => setFormData({ ...formData, representative_title: e.target.value })}\r\n                    placeholder=\"e.g., Managing Director\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-5\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"representative_email\" className=\"text-sm font-medium text-slate-700\">\r\n                    Email\r\n                  </Label>\r\n                  <Input\r\n                    id=\"representative_email\"\r\n                    type=\"email\"\r\n                    value={formData.representative_email}\r\n                    onChange={(e) => setFormData({ ...formData, representative_email: e.target.value })}\r\n                    placeholder=\"email@example.com\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"representative_phone\" className=\"text-sm font-medium text-slate-700\">\r\n                    Phone\r\n                  </Label>\r\n                  <Input\r\n                    id=\"representative_phone\"\r\n                    value={formData.representative_phone}\r\n                    onChange={(e) => setFormData({ ...formData, representative_phone: e.target.value })}\r\n                    placeholder=\"+1 (555) 123-4567\"\r\n                    className=\"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </section>\r\n\r\n            {/* Section 4: Notes */}\r\n            <section className=\"space-y-5\">\r\n              <div className=\"flex items-center gap-3 pb-2\">\r\n                <div className=\"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center\">\r\n                  <FileText className=\"w-4 h-4 text-slate-600\" />\r\n                </div>\r\n                <h3 className=\"font-medium text-slate-900\">Additional Notes</h3>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"notes\" className=\"text-sm font-medium text-slate-700\">\r\n                  Notes <span className=\"text-slate-400 font-normal\">(Optional)</span>\r\n                </Label>\r\n                <Textarea\r\n                  id=\"notes\"\r\n                  value={formData.notes}\r\n                  onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\r\n                  placeholder=\"Any additional notes about this entity...\"\r\n                  rows={4}\r\n                  className=\"bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20 resize-none\"\r\n                />\r\n              </div>\r\n            </section>\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"sticky bottom-0 px-8 py-5 border-t border-slate-100 bg-slate-50/80 backdrop-blur-sm flex items-center justify-end gap-3\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              onClick={onClose}\r\n              disabled={saving}\r\n              className=\"px-5 border-slate-200 hover:bg-white\"\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              type=\"submit\"\r\n              disabled={saving}\r\n              className=\"px-6 bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm\"\r\n            >\r\n              {saving ? (\r\n                <>\r\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                  Saving...\r\n                </>\r\n              ) : entity ? (\r\n                'Update Entity'\r\n              ) : (\r\n                'Create Entity'\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1844, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/subscriptions/entity-selector.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Label } from '@/components/ui/label'\r\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Plus, Building2, User } from 'lucide-react'\r\nimport { toast } from 'sonner'\r\nimport { EntityFormDialog } from '@/components/profile/entity-form-dialog'\r\n\r\ninterface CounterpartyEntity {\r\n  id: string\r\n  entity_type: string\r\n  legal_name: string\r\n  jurisdiction?: string\r\n  representative_name?: string\r\n}\r\n\r\ninterface EntitySelectorProps {\r\n  value: {\r\n    subscription_type: 'personal' | 'entity'\r\n    counterparty_entity_id?: string | null\r\n  }\r\n  onChange: (value: {\r\n    subscription_type: 'personal' | 'entity'\r\n    counterparty_entity_id?: string | null\r\n  }) => void\r\n}\r\n\r\nexport function EntitySelector({ value, onChange }: EntitySelectorProps) {\r\n  const [entities, setEntities] = useState<CounterpartyEntity[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [formDialogOpen, setFormDialogOpen] = useState(false)\r\n\r\n  useEffect(() => {\r\n    loadEntities()\r\n  }, [])\r\n\r\n  const loadEntities = async () => {\r\n    try {\r\n      const response = await fetch('/api/investors/me/counterparty-entities')\r\n      if (!response.ok) throw new Error('Failed to load entities')\r\n\r\n      const data = await response.json()\r\n      setEntities(data.entities || [])\r\n    } catch (error) {\r\n      console.error('Error loading entities:', error)\r\n      toast.error('Failed to load entities')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleTypeChange = (type: 'personal' | 'entity') => {\r\n    onChange({\r\n      subscription_type: type,\r\n      counterparty_entity_id: type === 'personal' ? null : value.counterparty_entity_id\r\n    })\r\n  }\r\n\r\n  const handleEntityChange = (entityId: string) => {\r\n    onChange({\r\n      subscription_type: 'entity',\r\n      counterparty_entity_id: entityId\r\n    })\r\n  }\r\n\r\n  const handleFormSuccess = async () => {\r\n    setFormDialogOpen(false)\r\n    await loadEntities()\r\n  }\r\n\r\n  const getEntityTypeBadge = (type: string) => {\r\n    const typeLabels: Record<string, string> = {\r\n      trust: 'Trust',\r\n      llc: 'LLC',\r\n      partnership: 'Partnership',\r\n      family_office: 'Family Office',\r\n      law_firm: 'Law Firm',\r\n      investment_bank: 'Investment Bank',\r\n      fund: 'Fund',\r\n      corporation: 'Corporation',\r\n      other: 'Other'\r\n    }\r\n    return typeLabels[type] || type\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"space-y-3\">\r\n        <Label className=\"text-base font-medium\">Investment Type</Label>\r\n        <RadioGroup\r\n          value={value.subscription_type}\r\n          onValueChange={(val) => handleTypeChange(val as 'personal' | 'entity')}\r\n          className=\"space-y-3\"\r\n        >\r\n          <div className=\"flex items-center space-x-3 rounded-lg border p-4 hover:bg-muted transition-colors\">\r\n            <RadioGroupItem value=\"personal\" id=\"personal\" />\r\n            <Label htmlFor=\"personal\" className=\"flex-1 cursor-pointer\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <User className=\"w-4 h-4\" />\r\n                <span className=\"font-medium\">Invest Personally</span>\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground mt-1\">\r\n                Subscribe using your personal investor profile\r\n              </p>\r\n            </Label>\r\n          </div>\r\n\r\n          <div className=\"flex items-center space-x-3 rounded-lg border p-4 hover:bg-muted transition-colors\">\r\n            <RadioGroupItem value=\"entity\" id=\"entity\" />\r\n            <Label htmlFor=\"entity\" className=\"flex-1 cursor-pointer\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Building2 className=\"w-4 h-4\" />\r\n                <span className=\"font-medium\">Invest Through Entity</span>\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground mt-1\">\r\n                Subscribe through a legal entity (trust, LLC, partnership, etc.)\r\n              </p>\r\n            </Label>\r\n          </div>\r\n        </RadioGroup>\r\n      </div>\r\n\r\n      {value.subscription_type === 'entity' && (\r\n        <div className=\"space-y-3 pl-8 border-l-2 border-primary/20\">\r\n          <Label htmlFor=\"entity-select\">Select Entity</Label>\r\n          {loading ? (\r\n            <div className=\"text-sm text-muted-foreground\">Loading entities...</div>\r\n          ) : entities.length === 0 ? (\r\n            <div className=\"space-y-3\">\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                You haven't added any entities yet. Create one to invest through a legal entity.\r\n              </p>\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                onClick={() => setFormDialogOpen(true)}\r\n              >\r\n                <Plus className=\"w-4 h-4 mr-2\" />\r\n                Create Entity\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              <Select\r\n                value={value.counterparty_entity_id || ''}\r\n                onValueChange={handleEntityChange}\r\n              >\r\n                <SelectTrigger id=\"entity-select\" className=\"bg-background text-foreground border-border\">\r\n                  <SelectValue placeholder=\"Select an entity\" />\r\n                </SelectTrigger>\r\n                <SelectContent className=\"bg-background text-foreground border-border\">\r\n                  {entities.map((entity) => (\r\n                    <SelectItem key={entity.id} value={entity.id} className=\"text-foreground focus:bg-muted focus:text-foreground\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-medium\">{entity.legal_name}</span>\r\n                        <span className=\"text-xs text-muted-foreground/70\">\r\n                          ({getEntityTypeBadge(entity.entity_type)})\r\n                        </span>\r\n                      </div>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setFormDialogOpen(true)}\r\n              >\r\n                <Plus className=\"w-4 h-4 mr-2\" />\r\n                Add New Entity\r\n              </Button>\r\n\r\n              {value.counterparty_entity_id && (\r\n                <div className=\"rounded-lg bg-muted border border-border p-3\">\r\n                  {(() => {\r\n                    const selectedEntity = entities.find(\r\n                      (e) => e.id === value.counterparty_entity_id\r\n                    )\r\n                    if (!selectedEntity) return null\r\n\r\n                    return (\r\n                      <div className=\"space-y-1 text-sm\">\r\n                        <div className=\"font-medium text-foreground\">{selectedEntity.legal_name}</div>\r\n                        <div className=\"text-muted-foreground\">\r\n                          Type: {getEntityTypeBadge(selectedEntity.entity_type)}\r\n                        </div>\r\n                        {selectedEntity.jurisdiction && (\r\n                          <div className=\"text-muted-foreground\">\r\n                            Jurisdiction: {selectedEntity.jurisdiction}\r\n                          </div>\r\n                        )}\r\n                        {selectedEntity.representative_name && (\r\n                          <div className=\"text-muted-foreground\">\r\n                            Representative: {selectedEntity.representative_name}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )\r\n                  })()}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      <EntityFormDialog\r\n        open={formDialogOpen}\r\n        onClose={() => setFormDialogOpen(false)}\r\n        onSuccess={handleFormSuccess}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2317, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/progress.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,yBAAW,kMAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,oNAAC,sMAAsB;QACrB,KAAK;QACL,WAAW,IAAA,mJAAE,EACX,iEACA;QAED,GAAG,KAAK;kBAET,cAAA,oNAAC,2MAA2B;YAC1B,WAAU;YACV,OAAO;gBAAE,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;YAAC;;;;;;;;;;;;AAIhE,SAAS,WAAW,GAAG,sMAAsB,CAAC,WAAW"}},
    {"offset": {"line": 2362, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/submit-subscription-form.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Checkbox } from '@/components/ui/checkbox'\r\nimport { Card, CardContent } from '@/components/ui/card'\r\nimport { Loader2, CheckCircle2, AlertTriangle, TrendingUp } from 'lucide-react'\r\nimport { EntitySelector } from '@/components/subscriptions/entity-selector'\r\nimport { Alert, AlertDescription } from '@/components/ui/alert'\r\nimport { Progress } from '@/components/ui/progress'\r\n\r\ninterface DealCapacityInfo {\r\n  target_raise: number | null\r\n  min_ticket: number | null\r\n  max_ticket: number | null\r\n  total_subscribed: number\r\n  subscription_count: number\r\n}\r\n\r\ninterface SubmitSubscriptionFormProps {\r\n  dealId: string\r\n  currency: string\r\n  existingSubmission: {\r\n    id: string\r\n    status: string\r\n    submitted_at: string\r\n    payload_json: Record<string, any>\r\n  } | null\r\n}\r\n\r\nexport function SubmitSubscriptionForm({ dealId, currency, existingSubmission }: SubmitSubscriptionFormProps) {\r\n  const [amount, setAmount] = useState('')\r\n  const [bankConfirmation, setBankConfirmation] = useState(false)\r\n  const [notes, setNotes] = useState('')\r\n  const [entitySelection, setEntitySelection] = useState<{\r\n    subscription_type: 'personal' | 'entity'\r\n    counterparty_entity_id?: string | null\r\n  }>({\r\n    subscription_type: 'personal',\r\n    counterparty_entity_id: null\r\n  })\r\n  const [isSubmitting, setIsSubmitting] = useState(false)\r\n  const [feedback, setFeedback] = useState<string | null>(null)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [dealCapacity, setDealCapacity] = useState<DealCapacityInfo | null>(null)\r\n  const [loadingCapacity, setLoadingCapacity] = useState(true)\r\n\r\n  // Fetch deal capacity information\r\n  useEffect(() => {\r\n    async function fetchDealCapacity() {\r\n      try {\r\n        const response = await fetch(`/api/deals/${dealId}/capacity`)\r\n        if (response.ok) {\r\n          const data = await response.json()\r\n          setDealCapacity(data)\r\n        }\r\n      } catch (err) {\r\n        console.error('Failed to fetch deal capacity:', err)\r\n      } finally {\r\n        setLoadingCapacity(false)\r\n      }\r\n    }\r\n    fetchDealCapacity()\r\n  }, [dealId])\r\n\r\n  // Calculate subscription metrics\r\n  const subscriptionPercentage = dealCapacity?.target_raise\r\n    ? (dealCapacity.total_subscribed / dealCapacity.target_raise) * 100\r\n    : 0\r\n  const isOversubscribed = subscriptionPercentage > 100\r\n  const remainingCapacity = dealCapacity?.target_raise\r\n    ? Math.max(0, dealCapacity.target_raise - dealCapacity.total_subscribed)\r\n    : null\r\n\r\n  // Format currency amounts\r\n  const formatAmount = (value: number) => {\r\n    return new Intl.NumberFormat('en-US', {\r\n      style: 'currency',\r\n      currency: currency,\r\n      minimumFractionDigits: 0,\r\n      maximumFractionDigits: 0,\r\n    }).format(value)\r\n  }\r\n\r\n  // Only lock form during pending review to prevent duplicate submissions\r\n  // Allow new submissions after approval/rejection (follow-on investments, entity changes)\r\n  const isLocked = existingSubmission && existingSubmission.status === 'pending_review'\r\n\r\n  const handleSubmit = async (event: React.FormEvent) => {\r\n    event.preventDefault()\r\n    if (isLocked) return\r\n\r\n    setIsSubmitting(true)\r\n    setFeedback(null)\r\n    setError(null)\r\n\r\n    try {\r\n      const numericAmount = parseFloat(amount)\r\n      if (!numericAmount || Number.isNaN(numericAmount) || numericAmount <= 0) {\r\n        setError('Enter a valid subscription amount.')\r\n        setIsSubmitting(false)\r\n        return\r\n      }\r\n\r\n      // Validate entity selection if entity type is chosen\r\n      if (entitySelection.subscription_type === 'entity' && !entitySelection.counterparty_entity_id) {\r\n        setError('Please select an entity or create one to invest through an entity.')\r\n        setIsSubmitting(false)\r\n        return\r\n      }\r\n\r\n      const response = await fetch(`/api/deals/${dealId}/subscriptions`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          payload: {\r\n            amount: numericAmount,\r\n            currency,\r\n            bank_confirmation: bankConfirmation,\r\n            notes: notes.trim() || null\r\n          },\r\n          subscription_type: entitySelection.subscription_type,\r\n          counterparty_entity_id: entitySelection.counterparty_entity_id || null\r\n        })\r\n      })\r\n\r\n      const data = await response.json()\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to submit subscription')\r\n      }\r\n\r\n      setFeedback('Subscription submitted for review. The VERSO team will follow up shortly.')\r\n      setAmount('')\r\n      setBankConfirmation(false)\r\n      setNotes('')\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Unexpected error submitting subscription')\r\n    } finally {\r\n      setIsSubmitting(false)\r\n    }\r\n  }\r\n\r\n  if (isLocked) {\r\n    const submittedAt = existingSubmission?.submitted_at\r\n      ? new Date(existingSubmission.submitted_at).toLocaleString()\r\n      : 'Recently'\r\n\r\n    return (\r\n      <Card className=\"border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20\">\r\n        <CardContent className=\"py-4 text-sm text-muted-foreground space-y-2\">\r\n          <div className=\"flex items-center gap-2 text-amber-700 dark:text-amber-300\">\r\n            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n            Subscription under review\r\n          </div>\r\n          <p>Submitted on {submittedAt}. The VERSO team is reviewing your request.</p>\r\n          <p className=\"text-xs text-muted-foreground\">\r\n            You&apos;ll be notified once a decision is made. Contact your relationship manager if you need to make urgent changes.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  // Validate amount against deal limits (non-blocking)\r\n  const numericAmount = parseFloat(amount)\r\n  const amountWarnings = []\r\n  if (!isNaN(numericAmount) && numericAmount > 0) {\r\n    if (dealCapacity?.min_ticket && numericAmount < dealCapacity.min_ticket) {\r\n      amountWarnings.push(`Below minimum investment of ${formatAmount(dealCapacity.min_ticket)}`)\r\n    }\r\n    if (dealCapacity?.max_ticket && numericAmount > dealCapacity.max_ticket) {\r\n      amountWarnings.push(`Above maximum investment of ${formatAmount(dealCapacity.max_ticket)}`)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n      {/* Deal Capacity Display */}\r\n      {!loadingCapacity && dealCapacity && dealCapacity.target_raise && (\r\n        <Card className={isOversubscribed ? \"border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20\" : \"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20\"}>\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"text-sm font-medium text-foreground\">Deal Progress</span>\r\n                <span className=\"text-sm font-bold text-foreground\">\r\n                  {subscriptionPercentage.toFixed(1)}% subscribed\r\n                </span>\r\n              </div>\r\n\r\n              <Progress\r\n                value={Math.min(subscriptionPercentage, 100)}\r\n                className={isOversubscribed ? \"bg-orange-200 dark:bg-orange-800\" : \"bg-blue-200 dark:bg-blue-800\"}\r\n              />\r\n\r\n              <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                <span>{formatAmount(dealCapacity.total_subscribed)} committed</span>\r\n                <span>Target: {formatAmount(dealCapacity.target_raise)}</span>\r\n              </div>\r\n\r\n              {isOversubscribed && (\r\n                <Alert className=\"border-orange-300 bg-orange-100\">\r\n                  <TrendingUp className=\"h-4 w-4\" />\r\n                  <AlertDescription className=\"text-xs\">\r\n                    This deal is oversubscribed by {(subscriptionPercentage - 100).toFixed(1)}%.\r\n                    You can still submit your interest, but allocation is not guaranteed.\r\n                  </AlertDescription>\r\n                </Alert>\r\n              )}\r\n\r\n              {dealCapacity.min_ticket && dealCapacity.max_ticket && (\r\n                <div className=\"text-xs text-muted-foreground pt-1 border-t border-border\">\r\n                  Investment range: {formatAmount(dealCapacity.min_ticket)} - {formatAmount(dealCapacity.max_ticket)}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      <EntitySelector\r\n        value={entitySelection}\r\n        onChange={setEntitySelection}\r\n      />\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor={`subscription-amount-${dealId}`} className=\"text-base font-semibold\">\r\n          Subscription Amount ({currency})\r\n        </Label>\r\n        <Input\r\n          id={`subscription-amount-${dealId}`}\r\n          type=\"number\"\r\n          min=\"0\"\r\n          step=\"0.01\"\r\n          value={amount}\r\n          onChange={event => setAmount(event.target.value)}\r\n          placeholder=\"e.g. 250000\"\r\n          className=\"text-foreground text-lg h-12\"\r\n        />\r\n\r\n        {/* Amount validation warnings */}\r\n        {amountWarnings.length > 0 && (\r\n          <Alert className=\"mt-2 border-yellow-300 bg-yellow-50\">\r\n            <AlertTriangle className=\"h-4 w-4 text-yellow-600\" />\r\n            <AlertDescription className=\"text-xs text-yellow-800\">\r\n              {amountWarnings.join('. ')}. You may still submit, but staff review is required.\r\n            </AlertDescription>\r\n          </Alert>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label className=\"text-base font-semibold\">Bank & Compliance</Label>\r\n        <div className=\"flex items-start space-x-3 rounded-md border-2 border-border px-4 py-3 bg-muted\">\r\n          <Checkbox\r\n            id={`bank-confirmation-${dealId}`}\r\n            checked={bankConfirmation}\r\n            onCheckedChange={checked => setBankConfirmation(Boolean(checked))}\r\n            className=\"mt-0.5\"\r\n          />\r\n          <Label htmlFor={`bank-confirmation-${dealId}`} className=\"text-sm text-foreground font-normal cursor-pointer leading-relaxed\">\r\n            I confirm my bank/KYC documentation is ready for the subscription pack.\r\n          </Label>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor={`subscription-notes-${dealId}`} className=\"text-base font-semibold\">Additional Notes (optional)</Label>\r\n        <Textarea\r\n          id={`subscription-notes-${dealId}`}\r\n          value={notes}\r\n          onChange={event => setNotes(event.target.value)}\r\n          rows={3}\r\n          placeholder=\"Share wiring preferences, co-investor details, or other information for the VERSO team.\"\r\n          className=\"text-foreground\"\r\n        />\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"text-sm text-red-600 font-medium bg-red-50 p-3 rounded-md border border-red-200\">{error}</div>\r\n      )}\r\n      {feedback && (\r\n        <div className=\"text-sm text-emerald-600 font-medium bg-emerald-50 p-3 rounded-md border border-emerald-200\">{feedback}</div>\r\n      )}\r\n\r\n      <Button\r\n        type=\"submit\"\r\n        disabled={isSubmitting}\r\n        className=\"w-full h-14 text-lg font-bold bg-blue-600 hover:bg-blue-700 text-white gap-2 shadow-md\"\r\n      >\r\n        {isSubmitting && <Loader2 className=\"h-5 w-5 animate-spin\" />}\r\n        Submit Subscription Request\r\n      </Button>\r\n    </form>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2892, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/subscribe-now-dialog.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { ReactNode, useState } from 'react'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger\r\n} from '@/components/ui/dialog'\r\nimport { SubmitSubscriptionForm } from './submit-subscription-form'\r\nimport { Briefcase } from 'lucide-react'\r\n\r\ninterface SubscribeNowDialogProps {\r\n  dealId: string\r\n  dealName: string\r\n  currency: string\r\n  children: ReactNode\r\n  existingSubmission?: {\r\n    id: string\r\n    status: string\r\n    submitted_at: string\r\n  } | null\r\n}\r\n\r\nexport function SubscribeNowDialog({\r\n  dealId,\r\n  dealName,\r\n  currency,\r\n  children,\r\n  existingSubmission\r\n}: SubscribeNowDialogProps) {\r\n  const [open, setOpen] = useState(false)\r\n\r\n  // Map to the format expected by SubmitSubscriptionForm\r\n  const formattedSubmission = existingSubmission\r\n    ? {\r\n        id: existingSubmission.id,\r\n        status: existingSubmission.status,\r\n        submitted_at: existingSubmission.submitted_at,\r\n        payload_json: {}\r\n      }\r\n    : null\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>{children}</DialogTrigger>\r\n      <DialogContent className=\"max-w-xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-emerald-100\">\r\n              <Briefcase className=\"h-5 w-5 text-emerald-600\" />\r\n            </div>\r\n            <div>\r\n              <DialogTitle className=\"text-xl\">Subscribe to Investment Opportunity</DialogTitle>\r\n              <DialogDescription>\n                Submit a subscription request for {dealName}. The team will review it before sending the NDA and\n                subscription documents.\n                <span className=\"block mt-1 text-amber-600 dark:text-amber-400 text-xs\">\n                  Note: This request does not include data room access.\n                </span>\n              </DialogDescription>\n            </div>\r\n          </div>\r\n        </DialogHeader>\r\n        <div className=\"mt-4\">\r\n          <SubmitSubscriptionForm\r\n            dealId={dealId}\r\n            currency={currency}\r\n            existingSubmission={formattedSubmission}\r\n          />\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAQA;AACA;;;AAZA;;;;;AA0BO,SAAS,mBAAmB,EACjC,MAAM,EACN,QAAQ,EACR,QAAQ,EACR,QAAQ,EACR,kBAAkB,EACM;;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,gMAAQ,EAAC;IAEjC,uDAAuD;IACvD,MAAM,sBAAsB,qBACxB;QACE,IAAI,mBAAmB,EAAE;QACzB,QAAQ,mBAAmB,MAAM;QACjC,cAAc,mBAAmB,YAAY;QAC7C,cAAc,CAAC;IACjB,IACA;IAEJ,qBACE,oNAAC,sKAAM;QAAC,MAAM;QAAM,cAAc;;0BAChC,oNAAC,6KAAa;gBAAC,OAAO;0BAAE;;;;;;0BACxB,oNAAC,6KAAa;gBAAC,WAAU;;kCACvB,oNAAC,4KAAY;kCACX,cAAA,oNAAC;4BAAI,WAAU;;8CACb,oNAAC;oCAAI,WAAU;8CACb,cAAA,oNAAC,mPAAS;wCAAC,WAAU;;;;;;;;;;;8CAEvB,oNAAC;;sDACC,oNAAC,2KAAW;4CAAC,WAAU;sDAAU;;;;;;sDACjC,oNAAC,iLAAiB;;gDAAC;gDACkB;gDAAS;8DAE5C,oNAAC;oDAAK,WAAU;8DAAwD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAOhF,oNAAC;wBAAI,WAAU;kCACb,cAAA,oNAAC,iNAAsB;4BACrB,QAAQ;4BACR,UAAU;4BACV,oBAAoB;;;;;;;;;;;;;;;;;;;;;;;AAMhC;GAlDgB;KAAA"}},
    {"offset": {"line": 3037, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/share-deal-dialog.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Badge } from '@/components/ui/badge'\nimport { Checkbox } from '@/components/ui/checkbox'\nimport { Loader2, Share2, Users, UserPlus, Percent, AlertCircle, CheckCircle2 } from 'lucide-react'\nimport { createClient } from '@/lib/supabase/client'\nimport { toast } from 'sonner'\n\n/**\n * ShareDealDialog - PRD Rows 95-96\n *\n * Row 95: Partner shares deal to INVESTOR only\n * Row 96: Partner shares deal to INVESTOR + INTRODUCER (co-referral)\n *\n * This creates a deal_membership with:\n * - referred_by_entity_id = partner.id\n * - referred_by_entity_type = 'partner'\n * - dispatched_at = now()\n *\n * And automatically applies the partner's fee model from partner_fee_models\n */\n\ninterface Investor {\n  id: string\n  display_name: string | null\n  legal_name: string | null\n  email: string | null\n  type: 'individual' | 'entity'\n}\n\ninterface Introducer {\n  id: string\n  name: string\n  email: string | null\n}\n\ninterface FeeModel {\n  id: string\n  fee_type: string\n  percentage_rate: number | null\n  flat_amount: number | null\n  currency: string | null\n}\n\ninterface ShareDealDialogProps {\n  dealId: string\n  dealName: string\n  partnerId: string\n  children: React.ReactNode\n}\n\nexport function ShareDealDialog({\n  dealId,\n  dealName,\n  partnerId,\n  children\n}: ShareDealDialogProps) {\n  const [open, setOpen] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [submitting, setSubmitting] = useState(false)\n  const [success, setSuccess] = useState(false)\n\n  // Data\n  const [investors, setInvestors] = useState<Investor[]>([])\n  const [introducers, setIntroducers] = useState<Introducer[]>([])\n  const [feeModel, setFeeModel] = useState<FeeModel | null>(null)\n  const [alreadySharedWith, setAlreadySharedWith] = useState<Set<string>>(new Set())\n\n  // Form state\n  const [selectedInvestorId, setSelectedInvestorId] = useState<string>('')\n  const [selectedIntroducerId, setSelectedIntroducerId] = useState<string>('')\n  const [includeIntroducer, setIncludeIntroducer] = useState(false)\n  const [searchInvestor, setSearchInvestor] = useState('')\n\n  useEffect(() => {\n    if (open) {\n      fetchData()\n    }\n  }, [open, partnerId, dealId])\n\n  async function fetchData() {\n    setLoading(true)\n    try {\n      const supabase = createClient()\n\n      // Fetch investors (all investors, partner will pick one to share with)\n      const { data: investorsData, error: investorsError } = await supabase\n        .from('investors')\n        .select('id, display_name, legal_name, email, type')\n        .order('display_name')\n        .limit(100)\n\n      if (investorsError) throw investorsError\n      setInvestors(investorsData || [])\n\n      // Fetch introducers associated with this partner\n      const { data: introducersData, error: introducersError } = await supabase\n        .from('introducers')\n        .select('id, name, email')\n        .order('name')\n        .limit(50)\n\n      if (introducersError) {\n        console.warn('Could not fetch introducers:', introducersError)\n      }\n      setIntroducers(introducersData || [])\n\n      // Fetch partner's fee model for this deal\n      const { data: feeModelData, error: feeModelError } = await supabase\n        .from('partner_fee_models')\n        .select('id, fee_type, percentage_rate, flat_amount, currency')\n        .eq('partner_id', partnerId)\n        .eq('deal_id', dealId)\n        .maybeSingle()\n\n      if (feeModelError) {\n        console.warn('Could not fetch fee model:', feeModelError)\n      }\n      setFeeModel(feeModelData)\n\n      // Check which investors already have deal membership for this deal\n      // (to prevent duplicate shares)\n      const { data: existingMemberships, error: membershipsError } = await supabase\n        .from('deal_memberships')\n        .select('investor_id')\n        .eq('deal_id', dealId)\n        .not('investor_id', 'is', null)\n\n      if (membershipsError) {\n        console.warn('Could not fetch existing memberships:', membershipsError)\n      }\n\n      const sharedSet = new Set<string>()\n      existingMemberships?.forEach(m => {\n        if (m.investor_id) sharedSet.add(m.investor_id)\n      })\n      setAlreadySharedWith(sharedSet)\n\n    } catch (err) {\n      console.error('[ShareDealDialog] Error fetching data:', err)\n      toast.error('Failed to load data')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  async function handleShare() {\n    if (!selectedInvestorId) {\n      toast.error('Please select an investor')\n      return\n    }\n\n    setSubmitting(true)\n    try {\n      const response = await fetch('/api/partners/me/share', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          deal_id: dealId,\n          investor_id: selectedInvestorId,\n          introducer_id: includeIntroducer ? selectedIntroducerId : null\n        })\n      })\n\n      const result = await response.json()\n\n      if (!response.ok) {\n        throw new Error(result.error || 'Failed to share deal')\n      }\n\n      setSuccess(true)\n      toast.success('Deal shared successfully!')\n\n      // Update the already shared list\n      setAlreadySharedWith(prev => new Set([...prev, selectedInvestorId]))\n\n      // Reset form after 2 seconds\n      setTimeout(() => {\n        setOpen(false)\n        setSuccess(false)\n        setSelectedInvestorId('')\n        setSelectedIntroducerId('')\n        setIncludeIntroducer(false)\n      }, 2000)\n\n    } catch (err) {\n      console.error('[ShareDealDialog] Error sharing deal:', err)\n      toast.error(err instanceof Error ? err.message : 'Failed to share deal')\n    } finally {\n      setSubmitting(false)\n    }\n  }\n\n  // Filter investors by search\n  const filteredInvestors = investors.filter(inv => {\n    if (!searchInvestor) return true\n    const name = inv.display_name || inv.legal_name || ''\n    const email = inv.email || ''\n    const search = searchInvestor.toLowerCase()\n    return name.toLowerCase().includes(search) || email.toLowerCase().includes(search)\n  })\n\n  // Available investors (not already shared with)\n  const availableInvestors = filteredInvestors.filter(inv => !alreadySharedWith.has(inv.id))\n\n  const selectedInvestor = investors.find(inv => inv.id === selectedInvestorId)\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        {children}\n      </DialogTrigger>\n      <DialogContent className=\"sm:max-w-[500px]\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Share2 className=\"h-5 w-5 text-blue-600\" />\n            Share Deal with Investor\n          </DialogTitle>\n          <DialogDescription>\n            Share <strong>{dealName}</strong> with an investor in your network.\n            {feeModel && (\n              <span className=\"block mt-1 text-emerald-600\">\n                Your commission: {feeModel.percentage_rate ? `${feeModel.percentage_rate}%` : `${feeModel.currency} ${feeModel.flat_amount}`}\n              </span>\n            )}\n          </DialogDescription>\n        </DialogHeader>\n\n        {success ? (\n          <div className=\"py-8 text-center\">\n            <CheckCircle2 className=\"h-16 w-16 text-emerald-500 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-foreground\">Deal Shared Successfully!</h3>\n            <p className=\"text-muted-foreground mt-1\">\n              The investor will receive an invitation to view this opportunity.\n            </p>\n          </div>\n        ) : loading ? (\n          <div className=\"py-8 flex items-center justify-center\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n          </div>\n        ) : (\n          <div className=\"space-y-4 py-4\">\n            {/* Investor Selection */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"investor\" className=\"flex items-center gap-2\">\n                <Users className=\"h-4 w-4\" />\n                Select Investor *\n              </Label>\n              <Input\n                placeholder=\"Search investors by name or email...\"\n                value={searchInvestor}\n                onChange={(e) => setSearchInvestor(e.target.value)}\n                className=\"mb-2\"\n              />\n              <Select value={selectedInvestorId} onValueChange={setSelectedInvestorId}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Choose an investor\" />\n                </SelectTrigger>\n                <SelectContent className=\"max-h-60\">\n                  {availableInvestors.length === 0 ? (\n                    <div className=\"py-4 text-center text-sm text-muted-foreground\">\n                      {alreadySharedWith.size > 0\n                        ? 'All matching investors already have access'\n                        : 'No investors found'}\n                    </div>\n                  ) : (\n                    availableInvestors.map((investor) => (\n                      <SelectItem key={investor.id} value={investor.id}>\n                        <div className=\"flex items-center gap-2\">\n                          <span>{investor.display_name || investor.legal_name || 'Unknown'}</span>\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {investor.type}\n                          </Badge>\n                        </div>\n                      </SelectItem>\n                    ))\n                  )}\n                </SelectContent>\n              </Select>\n              {selectedInvestor?.email && (\n                <p className=\"text-xs text-muted-foreground pl-1\">{selectedInvestor.email}</p>\n              )}\n            </div>\n\n            {/* Co-referral with Introducer (PRD Row 96) */}\n            {introducers.length > 0 && (\n              <div className=\"border border-border rounded-lg p-4 bg-muted space-y-3\">\n                <div className=\"flex items-center gap-2\">\n                  <Checkbox\n                    id=\"include-introducer\"\n                    checked={includeIntroducer}\n                    onCheckedChange={(checked) => setIncludeIntroducer(checked === true)}\n                  />\n                  <Label htmlFor=\"include-introducer\" className=\"flex items-center gap-2 cursor-pointer\">\n                    <UserPlus className=\"h-4 w-4 text-purple-600\" />\n                    Co-refer with Introducer\n                  </Label>\n                </div>\n\n                {includeIntroducer && (\n                  <Select value={selectedIntroducerId} onValueChange={setSelectedIntroducerId}>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select an introducer\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {introducers.map((introducer) => (\n                        <SelectItem key={introducer.id} value={introducer.id}>\n                          {introducer.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                )}\n              </div>\n            )}\n\n            {/* Fee Model Display (PRD Row 77) */}\n            {feeModel && (\n              <div className=\"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-lg\">\n                <Percent className=\"h-5 w-5 text-emerald-600\" />\n                <div>\n                  <p className=\"text-sm font-medium text-emerald-800\">\n                    Your Commission Rate\n                  </p>\n                  <p className=\"text-xs text-emerald-600\">\n                    {feeModel.fee_type}: {feeModel.percentage_rate\n                      ? `${feeModel.percentage_rate}% of investment`\n                      : `${feeModel.currency} ${feeModel.flat_amount} flat fee`}\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {/* Warning if no fee model */}\n            {!feeModel && (\n              <div className=\"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg\">\n                <AlertCircle className=\"h-5 w-5 text-amber-600\" />\n                <div>\n                  <p className=\"text-sm font-medium text-amber-800\">\n                    No Fee Model Assigned\n                  </p>\n                  <p className=\"text-xs text-amber-600\">\n                    Contact your arranger to set up a commission structure for this deal.\n                  </p>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n\n        {!success && !loading && (\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setOpen(false)}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleShare}\n              disabled={submitting || !selectedInvestorId}\n              className=\"gap-2 bg-blue-600 hover:bg-blue-700\"\n            >\n              {submitting ? (\n                <>\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  Sharing...\n                </>\n              ) : (\n                <>\n                  <Share2 className=\"h-4 w-4\" />\n                  Share Deal\n                </>\n              )}\n            </Button>\n          </DialogFooter>\n        )}\n      </DialogContent>\n    </Dialog>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3667, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/deals/investor-deals-list-client.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useMemo, useEffect } from 'react'\r\nimport Link from 'next/link'\r\nimport { useRouter } from 'next/navigation'\r\nimport Image from 'next/image'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport { cn } from '@/lib/utils'\r\nimport {\r\n  Activity,\r\n  AlertCircle,\r\n  ArrowUpRight,\r\n  Building2,\r\n  CalendarClock,\r\n  ExternalLink,\r\n  ShieldCheck,\r\n  LineChart,\r\n  MailCheck,\r\n  Users,\r\n  Search,\r\n  Filter,\r\n  X,\r\n  SlidersHorizontal,\r\n  FileSignature,\r\n  Clock,\r\n  CheckCircle2,\r\n  DollarSign,\r\n  Package,\r\n  Share2,\r\n  // Partner-specific icons\r\n  UserPlus,\r\n  TrendingUp,\r\n  Wallet,\r\n  BadgeCheck\r\n} from 'lucide-react'\r\nimport { InterestModal } from '@/components/deals/interest-modal'\r\nimport { SubscribeNowDialog } from '@/components/deals/subscribe-now-dialog'\r\nimport { ShareDealDialog } from '@/components/deals/share-deal-dialog'\r\n\r\ntype Nullable<T> = T | null\r\n\r\n// ============================================================================\r\n// Persona Mode Detection\r\n// ============================================================================\r\n\r\ntype PersonaMode = 'INVESTOR_ONLY' | 'PARTNER_ONLY' | 'DUAL_PERSONA' | 'GENERIC'\r\n\r\n// ============================================================================\r\n// Partner Referral Types (US-5.6.1-01 through 07)\r\n// ============================================================================\r\n\r\ninterface PartnerReferral {\r\n  deal_id: string\r\n  investor_id: string\r\n  investor_name: string\r\n  dispatched_at: string | null\r\n  interest_confirmed_at: string | null\r\n}\r\n\r\ninterface ReferralSubscription {\r\n  investor_id: string\r\n  deal_id: string\r\n  status: string\r\n  commitment: number | null\r\n  currency: string | null\r\n  funded_at: string | null\r\n  signed_at: string | null\r\n}\r\n\r\ninterface PartnerCommission {\r\n  deal_id: string\r\n  investor_id: string\r\n  rate_bps: number | null\r\n  accrual_amount: number | null\r\n  currency: string | null\r\n  status: string\r\n}\r\n\r\ninterface PartnerSummary {\r\n  totalReferrals: number\r\n  converted: number\r\n  pipelineValue: number\r\n  pendingCommissions: number\r\n  currency: string\r\n}\r\n\r\n// Investor journey stage for referral tracking\r\ntype ReferralStage = 'dispatched' | 'interested' | 'passed' | 'approved' | 'signed' | 'funded'\r\n\r\nconst referralStageMeta: Record<ReferralStage, {\r\n  label: string\r\n  bgColor: string\r\n  textColor: string\r\n  borderColor: string\r\n}> = {\r\n  dispatched: {\r\n    label: 'Dispatched',\r\n    bgColor: 'bg-muted',\r\n    textColor: 'text-muted-foreground',\r\n    borderColor: 'border-border'\r\n  },\r\n  interested: {\r\n    label: 'Interested',\r\n    bgColor: 'bg-amber-50 dark:bg-amber-900/30',\r\n    textColor: 'text-amber-700 dark:text-amber-300',\r\n    borderColor: 'border-amber-200 dark:border-amber-700'\r\n  },\r\n  passed: {\r\n    label: 'Passed',\r\n    bgColor: 'bg-rose-50 dark:bg-rose-900/30',\r\n    textColor: 'text-rose-600 dark:text-rose-300',\r\n    borderColor: 'border-rose-200 dark:border-rose-700'\r\n  },\r\n  approved: {\r\n    label: 'Approved',\r\n    bgColor: 'bg-indigo-50 dark:bg-indigo-900/30',\r\n    textColor: 'text-indigo-700 dark:text-indigo-300',\r\n    borderColor: 'border-indigo-200 dark:border-indigo-700'\r\n  },\r\n  signed: {\r\n    label: 'Signed',\r\n    bgColor: 'bg-purple-50 dark:bg-purple-900/30',\r\n    textColor: 'text-purple-700 dark:text-purple-300',\r\n    borderColor: 'border-purple-200 dark:border-purple-700'\r\n  },\r\n  funded: {\r\n    label: 'Funded',\r\n    bgColor: 'bg-emerald-50 dark:bg-emerald-900/30',\r\n    textColor: 'text-emerald-700 dark:text-emerald-300',\r\n    borderColor: 'border-emerald-200 dark:border-emerald-700'\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Deal Types\r\n// ============================================================================\r\n\r\ninterface InvestorDeal {\r\n  id: string\r\n  name: string\r\n  deal_type: string\r\n  status: string\r\n  currency: string\r\n  offer_unit_price: number | null\r\n  open_at: string | null\r\n  close_at: string | null\r\n  created_at: string\r\n  description?: string | null\r\n  investment_thesis?: string | null\r\n  minimum_investment?: number | null\r\n  maximum_investment?: number | null\r\n  target_amount?: number | null\r\n  company_name?: string | null\r\n  company_logo_url?: string | null\r\n  company_website?: string | null\r\n  sector?: string | null\r\n  stage?: string | null\r\n  location?: string | null\r\n  vehicles?: {\r\n    id: string\r\n    name: string\r\n    type: string\r\n  }\r\n  deal_memberships: Array<{\r\n    role: string\r\n    accepted_at: string | null\r\n    dispatched_at: string | null\r\n  }>\r\n  fee_plans: Array<{\r\n    id: string\r\n    name: string\r\n    description: string | null\r\n    is_default: boolean\r\n    fee_components: Array<{\r\n      id: string\r\n      kind: string\r\n      calc_method: string\r\n      rate_bps: number | null\r\n      flat_amount: number | null\r\n      frequency: string | null\r\n      notes: string | null\r\n    }>\r\n  }>\r\n}\r\n\r\ninterface FeeStructure {\r\n  id: string\r\n  deal_id: string\r\n  created_at?: string\r\n  effective_at?: string | null\r\n  published_at?: string | null\r\n  allocation_up_to: number | null\r\n  price_per_share_text: string | null\r\n  minimum_ticket: number | null\r\n  term_sheet_date: string | null\r\n  transaction_type: string | null\r\n  opportunity_summary: string | null\r\n  issuer: string | null\r\n  vehicle: string | null\r\n  exclusive_arranger: string | null\r\n  purchaser: string | null\r\n  seller: string | null\r\n  structure: string | null\r\n  subscription_fee_percent: number | null\r\n  management_fee_percent: number | null\r\n  carried_interest_percent: number | null\r\n  legal_counsel: string | null\r\n  interest_confirmation_deadline: string | null\r\n  completion_date: string | null\r\n  completion_date_text: string | null\r\n  validity_date: string | null\r\n  term_sheet_attachment_key: string | null\r\n}\r\n\r\ninterface DealInterest {\r\n  id: string\r\n  deal_id: string\r\n  investor_id: string\r\n  status: 'pending_review' | 'approved' | 'rejected' | 'withdrawn'\r\n  submitted_at: string\r\n  approved_at: string | null\r\n  indicative_amount: number | null\r\n  indicative_currency: string | null\r\n  is_post_close: boolean\r\n}\r\n\r\ninterface DataRoomAccess {\r\n  id: string\r\n  deal_id: string\r\n  investor_id: string\r\n  granted_at: string\r\n  expires_at: string | null\r\n  auto_granted: boolean\r\n  revoked_at: string | null\r\n}\r\n\r\ninterface SubscriptionSubmission {\r\n  id: string\r\n  deal_id: string\r\n  investor_id: string\r\n  status: string\r\n  submitted_at: string\r\n}\r\n\r\ninterface InvestorDealsListClientProps {\r\n  dealsData: InvestorDeal[]\r\n  feeStructureMap: Map<string, FeeStructure>\r\n  interestByDeal: Map<string, DealInterest>\r\n  accessByDeal: Map<string, DataRoomAccess>\r\n  subscriptionByDeal: Map<string, SubscriptionSubmission>\r\n  primaryInvestorId: string | null\r\n  /** Partner ID - if present, user can share deals with investors (PRD Rows 95-96) */\r\n  partnerId?: string | null\r\n  /** Investor-centric summary metrics */\r\n  summary: {\r\n    totalDeals: number\r\n    openDeals: number\r\n    pendingInterests: number\r\n    activeNdas: number\r\n    submittedSubscriptions: number\r\n  }\r\n  /** Base URL for deal detail pages. Defaults to /versoholdings/deal */\r\n  detailUrlBase?: string\r\n\r\n  // ============================================================================\r\n  // Partner-Specific Props (US-5.6.1-01 through 07)\r\n  // ============================================================================\r\n\r\n  /** Partner's referrals grouped by deal_id */\r\n  referralsByDeal?: Record<string, PartnerReferral[]>\r\n  /** Subscription statuses for referred investors, grouped by deal_id */\r\n  referralSubscriptionsByDeal?: Record<string, ReferralSubscription[]>\r\n  /** Partner's commissions grouped by deal_id */\r\n  partnerCommissionsByDeal?: Record<string, PartnerCommission[]>\r\n  /** Aggregated Partner metrics */\r\n  partnerSummary?: PartnerSummary\r\n}\r\n\r\nconst dealTypeLabels: Record<string, string> = {\r\n  equity_secondary: 'Secondary Equity',\r\n  equity_primary: 'Primary Equity',\r\n  credit_trade_finance: 'Credit & Trade Finance',\r\n  other: 'Other'\r\n}\r\n\r\nconst statusBadges: Record<string, string> = {\r\n  draft: 'bg-muted text-muted-foreground',\r\n  open: 'bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300',\r\n  allocation_pending: 'bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300',\r\n  closed: 'bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300',\r\n  cancelled: 'bg-rose-100 dark:bg-rose-900/50 text-rose-700 dark:text-rose-300'\r\n}\r\n\r\nconst INVESTOR_ELIGIBLE_ROLES = new Set([\r\n  'investor',\r\n  'partner_investor',\r\n  'introducer_investor',\r\n  'commercial_partner_investor',\r\n  'co_investor'\r\n])\r\n\r\nfunction isInvestorEligibleRole(role: string | null | undefined) {\r\n  if (!role) return false\r\n  return INVESTOR_ELIGIBLE_ROLES.has(role)\r\n}\r\n\r\nconst interestStatusMeta: Record<\r\n  DealInterest['status'],\r\n  { label: string; tone: string }\r\n> = {\r\n  pending_review: { label: 'Pending review', tone: 'bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300' },\r\n  approved: { label: 'NDA active', tone: 'bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300' },\r\n  rejected: { label: 'Declined', tone: 'bg-rose-100 dark:bg-rose-900/50 text-rose-700 dark:text-rose-300' },\r\n  withdrawn: { label: 'Withdrawn', tone: 'bg-muted text-muted-foreground' }\r\n}\r\n\r\n// Subscription stages 6-9 metadata (before Active/Stage 10)\r\n// Maps actual database status values to journey stages\r\nconst subscriptionStageMeta: Record<string, {\r\n  label: string\r\n  stage: number\r\n  icon: typeof Package\r\n  bgColor: string\r\n  textColor: string\r\n  borderColor: string\r\n}> = {\r\n  // Actual database statuses from deal_subscription_submissions table\r\n  pending_review: {\r\n    label: 'Pending Review',\r\n    stage: 6,\r\n    icon: Clock,\r\n    bgColor: 'bg-amber-50 dark:bg-amber-900/30',\r\n    textColor: 'text-amber-700 dark:text-amber-300',\r\n    borderColor: 'border-amber-200 dark:border-amber-700'\r\n  },\r\n  // Keep 'pending' as alias for backwards compatibility\r\n  pending: {\r\n    label: 'Pending Review',\r\n    stage: 6,\r\n    icon: Clock,\r\n    bgColor: 'bg-amber-50 dark:bg-amber-900/30',\r\n    textColor: 'text-amber-700 dark:text-amber-300',\r\n    borderColor: 'border-amber-200 dark:border-amber-700'\r\n  },\r\n  approved: {\r\n    label: 'Approved',\r\n    stage: 7,\r\n    icon: MailCheck,\r\n    bgColor: 'bg-indigo-50 dark:bg-indigo-900/30',\r\n    textColor: 'text-indigo-700 dark:text-indigo-300',\r\n    borderColor: 'border-indigo-200 dark:border-indigo-700'\r\n  },\r\n  committed: {\r\n    label: 'Committed',\r\n    stage: 8,\r\n    icon: FileSignature,\r\n    bgColor: 'bg-purple-50 dark:bg-purple-900/30',\r\n    textColor: 'text-purple-700 dark:text-purple-300',\r\n    borderColor: 'border-purple-200 dark:border-purple-700'\r\n  },\r\n  partially_funded: {\r\n    label: 'Partially Funded',\r\n    stage: 9,\r\n    icon: DollarSign,\r\n    bgColor: 'bg-teal-50 dark:bg-teal-900/30',\r\n    textColor: 'text-teal-700 dark:text-teal-300',\r\n    borderColor: 'border-teal-200 dark:border-teal-700'\r\n  },\r\n  funded: {\r\n    label: 'Funded',\r\n    stage: 9,\r\n    icon: DollarSign,\r\n    bgColor: 'bg-emerald-50 dark:bg-emerald-900/30',\r\n    textColor: 'text-emerald-700 dark:text-emerald-300',\r\n    borderColor: 'border-emerald-200 dark:border-emerald-700'\r\n  },\r\n  // Legacy/alternative status names (for compatibility)\r\n  pack_generated: {\r\n    label: 'Pack Generated',\r\n    stage: 6,\r\n    icon: Package,\r\n    bgColor: 'bg-blue-50 dark:bg-blue-900/30',\r\n    textColor: 'text-blue-700 dark:text-blue-300',\r\n    borderColor: 'border-blue-200 dark:border-blue-700'\r\n  },\r\n  pack_sent: {\r\n    label: 'Pack Sent',\r\n    stage: 7,\r\n    icon: MailCheck,\r\n    bgColor: 'bg-indigo-50 dark:bg-indigo-900/30',\r\n    textColor: 'text-indigo-700 dark:text-indigo-300',\r\n    borderColor: 'border-indigo-200 dark:border-indigo-700'\r\n  },\r\n  signed: {\r\n    label: 'Signed',\r\n    stage: 8,\r\n    icon: FileSignature,\r\n    bgColor: 'bg-purple-50 dark:bg-purple-900/30',\r\n    textColor: 'text-purple-700 dark:text-purple-300',\r\n    borderColor: 'border-purple-200 dark:border-purple-700'\r\n  },\r\n  submitted: {\r\n    label: 'Submitted',\r\n    stage: 6,\r\n    icon: Clock,\r\n    bgColor: 'bg-amber-50 dark:bg-amber-900/30',\r\n    textColor: 'text-amber-700 dark:text-amber-300',\r\n    borderColor: 'border-amber-200 dark:border-amber-700'\r\n  },\r\n  in_review: {\r\n    label: 'In Review',\r\n    stage: 6,\r\n    icon: Clock,\r\n    bgColor: 'bg-amber-50 dark:bg-amber-900/30',\r\n    textColor: 'text-amber-700 dark:text-amber-300',\r\n    borderColor: 'border-amber-200 dark:border-amber-700'\r\n  },\r\n  // DB enum statuses: rejected, cancelled\r\n  rejected: {\r\n    label: 'Rejected',\r\n    stage: 0,\r\n    icon: AlertCircle,\r\n    bgColor: 'bg-rose-50 dark:bg-rose-900/30',\r\n    textColor: 'text-rose-700 dark:text-rose-300',\r\n    borderColor: 'border-rose-200 dark:border-rose-700'\r\n  },\r\n  cancelled: {\r\n    label: 'Cancelled',\r\n    stage: 0,\r\n    icon: AlertCircle,\r\n    bgColor: 'bg-muted',\r\n    textColor: 'text-muted-foreground',\r\n    borderColor: 'border-border'\r\n  }\r\n}\r\n\r\nfunction normalizeCurrency(code: Nullable<string>) {\r\n  if (!code) return 'USD'\r\n  return code.length === 3 ? code.toUpperCase() : code.toUpperCase().slice(0, 3)\r\n}\r\n\r\nfunction formatCurrency(amount: Nullable<number>, currency: Nullable<string>) {\r\n  if (amount === null || amount === undefined) {\r\n    return 'â€”'\r\n  }\r\n  try {\r\n    return new Intl.NumberFormat('en-US', {\r\n      style: 'currency',\r\n      currency: normalizeCurrency(currency),\r\n      maximumFractionDigits: amount >= 1000 ? 0 : 2\r\n    }).format(amount)\r\n  } catch {\r\n    return `${currency ?? ''} ${amount.toLocaleString()}`\r\n  }\r\n}\r\n\r\nfunction getEffectiveStatus(deal: InvestorDeal): string {\r\n  if (deal.status === 'closed' || deal.status === 'cancelled') {\r\n    return deal.status\r\n  }\r\n\r\n  // Auto-close deals that are past their close date\r\n  if (deal.close_at && new Date(deal.close_at) < new Date()) {\r\n    return 'closed'\r\n  }\r\n\r\n  return deal.status\r\n}\r\n\r\nfunction formatDeadlineCopy(\r\n  closeAt: Nullable<string>,\r\n  effectiveStatus: string\r\n) {\r\n  if (!closeAt) {\r\n    return effectiveStatus === 'closed' ? 'Closed' : 'Timing to be announced'\r\n  }\r\n\r\n  const closeDate = new Date(closeAt)\r\n  const now = new Date()\r\n\r\n  if (effectiveStatus === 'closed' || closeDate < now) {\r\n    return `Closed ${closeDate.toLocaleDateString()}`\r\n  }\r\n\r\n  const diffMs = closeDate.getTime() - now.getTime()\r\n  const diffDays = Math.ceil(diffMs / (1000 * 60 * 60 * 24))\r\n\r\n  if (diffDays <= 0) {\r\n    return 'Closing soon'\r\n  }\r\n\r\n  if (diffDays === 1) {\r\n    return 'Closes tomorrow'\r\n  }\r\n\r\n  if (diffDays <= 14) {\r\n    return `Closes in ${diffDays} days`\r\n  }\r\n\r\n  return `Closes ${closeDate.toLocaleDateString()}`\r\n}\r\n\r\nexport function InvestorDealsListClient({\r\n  dealsData,\r\n  feeStructureMap,\r\n  interestByDeal,\r\n  accessByDeal,\r\n  subscriptionByDeal,\r\n  primaryInvestorId,\r\n  partnerId,\r\n  summary,\r\n  detailUrlBase = '/versotech_main/opportunities',\r\n  // Partner-specific props\r\n  referralsByDeal = {},\r\n  referralSubscriptionsByDeal = {},\r\n  partnerCommissionsByDeal = {},\r\n  partnerSummary\r\n}: InvestorDealsListClientProps) {\r\n  const [mounted, setMounted] = useState(false)\r\n\r\n  // ============================================================================\r\n  // Persona Mode Detection\r\n  // Determines which view(s) to show based on user's personas\r\n  // ============================================================================\r\n\r\n  const personaMode: PersonaMode = useMemo(() => {\r\n    if (partnerId && primaryInvestorId) return 'DUAL_PERSONA'\r\n    if (partnerId) return 'PARTNER_ONLY'\r\n    if (primaryInvestorId) return 'INVESTOR_ONLY'\r\n    return 'GENERIC'\r\n  }, [partnerId, primaryInvestorId])\r\n\r\n  const isPartnerView = personaMode === 'PARTNER_ONLY' || personaMode === 'DUAL_PERSONA'\r\n  const isInvestorView = personaMode === 'INVESTOR_ONLY' || personaMode === 'DUAL_PERSONA'\r\n\r\n  // Helper function to determine referral stage for an investor\r\n  const getReferralStage = (\r\n    referral: PartnerReferral,\r\n    subscriptions: ReferralSubscription[]\r\n  ): ReferralStage => {\r\n    const sub = subscriptions.find(s => s.investor_id === referral.investor_id)\r\n\r\n    if (sub) {\r\n      const status = sub.status?.toLowerCase()\r\n      // Check for funded/active\r\n      if (['funded', 'active', 'activated', 'committed'].includes(status)) {\r\n        return 'funded'\r\n      }\r\n      // Check for signed\r\n      if (status === 'signed' || sub.signed_at) {\r\n        return 'signed'\r\n      }\r\n      // Check for approved\r\n      if (status === 'approved') {\r\n        return 'approved'\r\n      }\r\n      // Check for passed/rejected/cancelled\r\n      if (['rejected', 'cancelled', 'passed', 'declined'].includes(status)) {\r\n        return 'passed'\r\n      }\r\n    }\r\n\r\n    // Check for interest confirmed\r\n    if (referral.interest_confirmed_at) {\r\n      return 'interested'\r\n    }\r\n\r\n    // Default: dispatched only\r\n    return 'dispatched'\r\n  }\r\n  const [searchQuery, setSearchQuery] = useState('')\r\n  const [statusFilter, setStatusFilter] = useState('all')\r\n  const [dealTypeFilter, setDealTypeFilter] = useState('all')\r\n  const [interestStatusFilter, setInterestStatusFilter] = useState('all')\r\n  const [pipelineStageFilter, setPipelineStageFilter] = useState('all')\r\n  const [sectorFilter, setSectorFilter] = useState('all')\r\n  const [stageFilter, setStageFilter] = useState('all')\r\n  const [locationFilter, setLocationFilter] = useState('all')\r\n  const [sortBy, setSortBy] = useState('closing_date')\r\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false)\r\n\r\n  // Wait for client-side hydration to complete before rendering Radix UI components\r\n  useEffect(() => {\r\n    setMounted(true)\r\n  }, [])\r\n\r\n  // Extract unique values for filter dropdowns\r\n  // NOTE: All useMemo hooks MUST be called before any early returns to comply with Rules of Hooks\r\n  const uniqueSectors = useMemo(() => {\r\n    const sectors = new Set<string>()\r\n    dealsData.forEach(deal => {\r\n      if (deal.sector) sectors.add(deal.sector)\r\n    })\r\n    return Array.from(sectors).sort()\r\n  }, [dealsData])\r\n\r\n  const uniqueStages = useMemo(() => {\r\n    const stages = new Set<string>()\r\n    dealsData.forEach(deal => {\r\n      if (deal.stage) stages.add(deal.stage)\r\n    })\r\n    return Array.from(stages).sort()\r\n  }, [dealsData])\r\n\r\n  const uniqueLocations = useMemo(() => {\r\n    const locations = new Set<string>()\r\n    dealsData.forEach(deal => {\r\n      if (deal.location) locations.add(deal.location)\r\n    })\r\n    return Array.from(locations).sort()\r\n  }, [dealsData])\r\n\r\n  // Compute subscriptions in progress (Stages 6-9)\r\n  // These are subscriptions that are not yet activated (Stage 10)\r\n  const subscriptionsInProgress = useMemo(() => {\r\n    const inProgress: Array<{\r\n      deal: InvestorDeal\r\n      subscription: SubscriptionSubmission\r\n      stageMeta: typeof subscriptionStageMeta[string]\r\n    }> = []\r\n\r\n    // Stage 10 (activated) subscriptions go to Portfolio, not here\r\n    const activeStatuses = ['activated', 'active', 'completed']\r\n\r\n    dealsData.forEach(deal => {\r\n      const subscription = subscriptionByDeal.get(deal.id)\r\n      if (subscription && !activeStatuses.includes(subscription.status.toLowerCase())) {\r\n        const stageMeta = subscriptionStageMeta[subscription.status.toLowerCase()] ||\r\n          subscriptionStageMeta.pending\r\n        inProgress.push({ deal, subscription, stageMeta })\r\n      }\r\n    })\r\n\r\n    // Sort by submission date (most recent first)\r\n    inProgress.sort((a, b) => {\r\n      return new Date(b.subscription.submitted_at).getTime() -\r\n        new Date(a.subscription.submitted_at).getTime()\r\n    })\r\n\r\n    return inProgress\r\n  }, [dealsData, subscriptionByDeal])\r\n\r\n  // Filter and sort deals\r\n  const filteredDeals = useMemo(() => {\r\n    let filtered = [...dealsData]\r\n\r\n    // Search filter\r\n    if (searchQuery) {\r\n      const query = searchQuery.toLowerCase()\r\n      filtered = filtered.filter(\r\n        (deal) =>\r\n          deal.name?.toLowerCase().includes(query) ||\r\n          deal.company_name?.toLowerCase().includes(query) ||\r\n          deal.sector?.toLowerCase().includes(query) ||\r\n          deal.location?.toLowerCase().includes(query) ||\r\n          deal.description?.toLowerCase().includes(query)\r\n      )\r\n    }\r\n\r\n    // Deal status filter\r\n    if (statusFilter !== 'all') {\r\n      filtered = filtered.filter((deal) => {\r\n        const effectiveStatus = getEffectiveStatus(deal)\r\n        return effectiveStatus === statusFilter\r\n      })\r\n    }\r\n\r\n    // Deal type filter\r\n    if (dealTypeFilter !== 'all') {\r\n      filtered = filtered.filter((deal) => deal.deal_type === dealTypeFilter)\r\n    }\r\n\r\n    // Interest status filter\r\n    if (interestStatusFilter !== 'all') {\r\n      filtered = filtered.filter((deal) => {\r\n        const interest = interestByDeal.get(deal.id)\r\n        if (interestStatusFilter === 'no_interest') {\r\n          return !interest\r\n        }\r\n        return interest?.status === interestStatusFilter\r\n      })\r\n    }\r\n\r\n    // Pipeline stage filter\r\n    if (pipelineStageFilter !== 'all') {\r\n      filtered = filtered.filter((deal) => {\r\n        const interest = interestByDeal.get(deal.id)\r\n        const ndaAccess = accessByDeal.get(deal.id)\r\n        const subscription = subscriptionByDeal.get(deal.id)\r\n\r\n        switch (pipelineStageFilter) {\r\n          case 'interested':\r\n            return Boolean(interest)\r\n          case 'nda_access':\r\n            return Boolean(ndaAccess)\r\n          case 'subscription_submitted':\r\n            return Boolean(subscription)\r\n          default:\r\n            return true\r\n        }\r\n      })\r\n    }\r\n\r\n    // Sector filter\r\n    if (sectorFilter !== 'all') {\r\n      filtered = filtered.filter((deal) => deal.sector === sectorFilter)\r\n    }\r\n\r\n    // Stage filter\r\n    if (stageFilter !== 'all') {\r\n      filtered = filtered.filter((deal) => deal.stage === stageFilter)\r\n    }\r\n\r\n    // Location filter\r\n    if (locationFilter !== 'all') {\r\n      filtered = filtered.filter((deal) => deal.location === locationFilter)\r\n    }\r\n\r\n    // Sort\r\n    filtered.sort((a, b) => {\r\n      switch (sortBy) {\r\n        case 'closing_date':\r\n          if (!a.close_at) return 1\r\n          if (!b.close_at) return -1\r\n          return new Date(a.close_at).getTime() - new Date(b.close_at).getTime()\r\n        case 'name':\r\n          return a.name.localeCompare(b.name)\r\n        case 'opening_date':\r\n          if (!a.open_at) return 1\r\n          if (!b.open_at) return -1\r\n          return new Date(b.open_at).getTime() - new Date(a.open_at).getTime()\r\n        case 'target_amount':\r\n          return (b.target_amount || 0) - (a.target_amount || 0)\r\n        default:\r\n          return 0\r\n      }\r\n    })\r\n\r\n    return filtered\r\n  }, [\r\n    dealsData,\r\n    searchQuery,\r\n    statusFilter,\r\n    dealTypeFilter,\r\n    interestStatusFilter,\r\n    pipelineStageFilter,\r\n    sectorFilter,\r\n    stageFilter,\r\n    locationFilter,\r\n    sortBy,\r\n    interestByDeal,\r\n    accessByDeal,\r\n    subscriptionByDeal\r\n  ])\r\n\r\n  // Count active filters\r\n  const activeFiltersCount = [\r\n    searchQuery,\r\n    statusFilter !== 'all',\r\n    dealTypeFilter !== 'all',\r\n    interestStatusFilter !== 'all',\r\n    pipelineStageFilter !== 'all',\r\n    sectorFilter !== 'all',\r\n    stageFilter !== 'all',\r\n    locationFilter !== 'all'\r\n  ].filter(Boolean).length\r\n\r\n  // Reset all filters\r\n  const resetFilters = () => {\r\n    setSearchQuery('')\r\n    setStatusFilter('all')\r\n    setDealTypeFilter('all')\r\n    setInterestStatusFilter('all')\r\n    setPipelineStageFilter('all')\r\n    setSectorFilter('all')\r\n    setStageFilter('all')\r\n    setLocationFilter('all')\r\n  }\r\n\r\n  // Render loading state until hydration is complete to prevent Radix UI ID mismatches\r\n  // This must come AFTER all hooks (useState, useEffect, useMemo) to comply with Rules of Hooks\r\n  if (!mounted) {\r\n    return (\r\n      <div className=\"p-6 space-y-8\">\r\n        <div className=\"h-24 bg-muted animate-pulse rounded-lg\" />\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n          {[...Array(4)].map((_, i) => (\r\n            <div key={i} className=\"h-32 bg-muted animate-pulse rounded-lg\" />\r\n          ))}\r\n        </div>\r\n        <div className=\"h-48 bg-muted animate-pulse rounded-lg\" />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-8\">\r\n      <header className=\"flex flex-col gap-4\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-semibold text-foreground\">Investment Opportunities</h1>\r\n          <p className=\"text-muted-foreground\">\r\n            Track active allocations, NDAs, and subscriptions throughout the deal pipeline.\r\n          </p>\r\n        </div>\r\n\r\n        {/* ================================================================ */}\r\n        {/* PARTNER Summary Cards (US-5.6.1-07: Display Partner metrics) */}\r\n        {/* ================================================================ */}\r\n        {isPartnerView && partnerSummary && (\r\n          <>\r\n            {personaMode === 'DUAL_PERSONA' && (\r\n              <div className=\"flex items-center gap-2\">\r\n                <Badge variant=\"outline\" className=\"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-700\">\r\n                  <Share2 className=\"h-3 w-3 mr-1\" />\r\n                  Partner View\r\n                </Badge>\r\n              </div>\r\n            )}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n              <Card className=\"border-blue-100 dark:border-blue-900/50 bg-gradient-to-br from-blue-50/50 to-white dark:from-blue-950/30 dark:to-card\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">Total Referrals</CardTitle>\r\n                  <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                    <UserPlus className=\"h-4 w-4 text-blue-500\" />\r\n                    Investors you&apos;ve shared with\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                  {partnerSummary.totalReferrals}\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"border-emerald-100 dark:border-emerald-900/50 bg-gradient-to-br from-emerald-50/50 to-white dark:from-emerald-950/30 dark:to-card\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">Converted</CardTitle>\r\n                  <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                    <BadgeCheck className=\"h-4 w-4 text-emerald-500\" />\r\n                    Funded investments\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                  {partnerSummary.converted}\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"border-amber-100 dark:border-amber-900/50 bg-gradient-to-br from-amber-50/50 to-white dark:from-amber-950/30 dark:to-card\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">Pipeline Value</CardTitle>\r\n                  <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                    <TrendingUp className=\"h-4 w-4 text-amber-500\" />\r\n                    In-progress commitments\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                  {partnerSummary.pipelineValue > 0\r\n                    ? formatCurrency(partnerSummary.pipelineValue, partnerSummary.currency)\r\n                    : 'â€”'}\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"border-purple-100 dark:border-purple-900/50 bg-gradient-to-br from-purple-50/50 to-white dark:from-purple-950/30 dark:to-card\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">Pending Commissions</CardTitle>\r\n                  <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                    <Wallet className=\"h-4 w-4 text-purple-500\" />\r\n                    Accrued, awaiting invoice\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                  {partnerSummary.pendingCommissions > 0\r\n                    ? formatCurrency(partnerSummary.pendingCommissions, partnerSummary.currency)\r\n                    : 'â€”'}\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n        {/* ================================================================ */}\r\n        {/* INVESTOR Summary Cards (original investor-centric metrics) */}\r\n        {/* ================================================================ */}\r\n        {isInvestorView && (\r\n          <>\r\n            {personaMode === 'DUAL_PERSONA' && (\r\n              <div className=\"flex items-center gap-2 mt-4\">\r\n                <Badge variant=\"outline\" className=\"bg-emerald-50 dark:bg-emerald-900/40 text-emerald-700 dark:text-emerald-300 border-emerald-200 dark:border-emerald-700\">\r\n                  <Activity className=\"h-3 w-3 mr-1\" />\r\n                  Investor View\r\n                </Badge>\r\n              </div>\r\n            )}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n              <Card>\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">Open deals</CardTitle>\r\n                  <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                    <Activity className=\"h-4 w-4 text-emerald-500\" />\r\n                    Ready for exploration\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                  {summary.openDeals} / {summary.totalDeals}\r\n                </CardContent>\r\n              </Card>\r\n              <Card>\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">Pending interests</CardTitle>\r\n                  <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                    <LineChart className=\"h-4 w-4 text-amber-500\" />\r\n                    Awaiting team review\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                  {summary.pendingInterests}\r\n                </CardContent>\r\n              </Card>\r\n              <Card>\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">Active NDAs</CardTitle>\r\n                  <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                    <ShieldCheck className=\"h-4 w-4 text-sky-500\" />\r\n                    Data room unlocked\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                  {summary.activeNdas}\r\n                </CardContent>\r\n              </Card>\r\n              <Card>\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-muted-foreground\">Subscriptions in review</CardTitle>\r\n                  <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                    <MailCheck className=\"h-4 w-4 text-indigo-500\" />\r\n                    Awaiting confirmation\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                  {summary.submittedSubscriptions}\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n        {/* ================================================================ */}\r\n        {/* GENERIC View (no investor/partner - just deal counts) */}\r\n        {/* ================================================================ */}\r\n        {personaMode === 'GENERIC' && (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-sm text-muted-foreground\">Open deals</CardTitle>\r\n                <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                  <Activity className=\"h-4 w-4 text-emerald-500\" />\r\n                  Ready for exploration\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"text-2xl font-semibold text-foreground\">\r\n                {summary.openDeals} / {summary.totalDeals}\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-sm text-muted-foreground\">Your Role</CardTitle>\r\n                <CardDescription className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                  <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n                  Tracking access\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"text-lg font-medium text-muted-foreground\">\r\n                View-only access\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        )}\r\n      </header>\r\n\r\n      {/* Search and Filters */}\r\n      <Card>\r\n        <CardContent className=\"pt-6 space-y-4\">\r\n          {/* Search Bar */}\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"flex-1 relative\">\r\n              <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"Search deals by name, company, sector, location...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className=\"pl-10\"\r\n              />\r\n            </div>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\r\n              className=\"gap-2\"\r\n            >\r\n              <SlidersHorizontal className=\"h-4 w-4\" />\r\n              Filters\r\n              {activeFiltersCount > 0 && (\r\n                <Badge variant=\"secondary\" className=\"ml-1\">\r\n                  {activeFiltersCount}\r\n                </Badge>\r\n              )}\r\n            </Button>\r\n            {activeFiltersCount > 0 && (\r\n              <Button\r\n                variant=\"ghost\"\r\n                onClick={resetFilters}\r\n                className=\"gap-2\"\r\n              >\r\n                <X className=\"h-4 w-4\" />\r\n                Clear\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Primary Filters Row */}\r\n          <div className=\"flex flex-col md:flex-row gap-3\">\r\n            {/* Deal Status */}\r\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n              <SelectTrigger className=\"w-full md:w-[180px]\">\r\n                <Filter className=\"h-4 w-4 mr-2\" />\r\n                <SelectValue placeholder=\"Status\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Status</SelectItem>\r\n                <SelectItem value=\"open\">Open</SelectItem>\r\n                <SelectItem value=\"allocation_pending\">Allocation Pending</SelectItem>\r\n                <SelectItem value=\"closed\">Closed</SelectItem>\r\n                <SelectItem value=\"draft\">Draft</SelectItem>\r\n                <SelectItem value=\"cancelled\">Cancelled</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            {/* Deal Type */}\r\n            <Select value={dealTypeFilter} onValueChange={setDealTypeFilter}>\r\n              <SelectTrigger className=\"w-full md:w-[180px]\">\r\n                <SelectValue placeholder=\"Deal Type\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Types</SelectItem>\r\n                <SelectItem value=\"equity_secondary\">Secondary Equity</SelectItem>\r\n                <SelectItem value=\"equity_primary\">Primary Equity</SelectItem>\r\n                <SelectItem value=\"credit_trade_finance\">Credit & Trade Finance</SelectItem>\r\n                <SelectItem value=\"other\">Other</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            {/* Pipeline Stage */}\r\n            <Select value={pipelineStageFilter} onValueChange={setPipelineStageFilter}>\r\n              <SelectTrigger className=\"w-full md:w-[180px]\">\r\n                <SelectValue placeholder=\"My Pipeline\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Stages</SelectItem>\r\n                <SelectItem value=\"interested\">Interested</SelectItem>\r\n                <SelectItem value=\"nda_access\">NDA Access</SelectItem>\r\n                <SelectItem value=\"subscription_submitted\">Subscription Submitted</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            {/* Sort */}\r\n            <Select value={sortBy} onValueChange={setSortBy}>\r\n              <SelectTrigger className=\"w-full md:w-[180px]\">\r\n                <SelectValue placeholder=\"Sort by\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"closing_date\">Closing Date</SelectItem>\r\n                <SelectItem value=\"name\">Name (A-Z)</SelectItem>\r\n                <SelectItem value=\"opening_date\">Newest First</SelectItem>\r\n                <SelectItem value=\"target_amount\">Target Amount</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {/* Advanced Filters */}\r\n          {showAdvancedFilters && (\r\n            <div className=\"pt-4 border-t border-border space-y-3\">\r\n              <h3 className=\"text-sm font-medium text-foreground\">Advanced Filters</h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-3\">\r\n                {/* Interest Status */}\r\n                <Select value={interestStatusFilter} onValueChange={setInterestStatusFilter}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Interest Status\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">All Interest Status</SelectItem>\r\n                    <SelectItem value=\"no_interest\">No Interest Yet</SelectItem>\r\n                    <SelectItem value=\"pending_review\">Pending Review</SelectItem>\r\n                    <SelectItem value=\"approved\">Approved (NDA)</SelectItem>\r\n                    <SelectItem value=\"rejected\">Declined</SelectItem>\r\n                    <SelectItem value=\"withdrawn\">Withdrawn</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n\r\n                {/* Sector */}\r\n                <Select value={sectorFilter} onValueChange={setSectorFilter}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Sector\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">All Sectors</SelectItem>\r\n                    {uniqueSectors.map((sector) => (\r\n                      <SelectItem key={sector} value={sector}>\r\n                        {sector}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n\r\n                {/* Stage */}\r\n                <Select value={stageFilter} onValueChange={setStageFilter}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Stage\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">All Stages</SelectItem>\r\n                    {uniqueStages.map((stage) => (\r\n                      <SelectItem key={stage} value={stage}>\r\n                        {stage}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n\r\n                {/* Location */}\r\n                <Select value={locationFilter} onValueChange={setLocationFilter}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Location\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">All Locations</SelectItem>\r\n                    {uniqueLocations.map((location) => (\r\n                      <SelectItem key={location} value={location}>\r\n                        {location}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Results Count */}\r\n          <div className=\"flex items-center justify-between pt-2 text-sm text-muted-foreground\">\r\n            <span>\r\n              Showing {filteredDeals.length} of {dealsData.length} deals\r\n            </span>\r\n            {activeFiltersCount > 0 && (\r\n              <span className=\"text-blue-600 dark:text-blue-400\">\r\n                {activeFiltersCount} filter{activeFiltersCount !== 1 ? 's' : ''} active\r\n              </span>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* My Subscriptions Section - Stages 6-9 (In Progress) */}\r\n      {subscriptionsInProgress.length > 0 && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h2 className=\"text-xl font-semibold text-foreground flex items-center gap-2\">\r\n                <Clock className=\"h-5 w-5 text-amber-500\" />\r\n                My Subscriptions\r\n              </h2>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Track your in-progress subscriptions (Stages 6-9)\r\n              </p>\r\n            </div>\r\n            <Badge variant=\"outline\" className=\"text-amber-600 border-amber-300\">\r\n              {subscriptionsInProgress.length} in progress\r\n            </Badge>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\">\r\n            {subscriptionsInProgress.map(({ deal, subscription, stageMeta }) => {\r\n              const StageIcon = stageMeta.icon\r\n\r\n              return (\r\n                <Card\r\n                  key={subscription.id}\r\n                  className={cn(\r\n                    'overflow-hidden border-2 transition-all hover:shadow-md',\r\n                    stageMeta.borderColor,\r\n                    stageMeta.bgColor\r\n                  )}\r\n                >\r\n                  <CardHeader className=\"pb-2\">\r\n                    <div className=\"flex items-start justify-between gap-3\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        {deal.company_logo_url ? (\r\n                          <Image\r\n                            src={deal.company_logo_url}\r\n                            alt={`${deal.company_name ?? deal.name} logo`}\r\n                            width={40}\r\n                            height={40}\r\n                            className=\"rounded-lg object-contain bg-background border border-border p-1\"\r\n                          />\r\n                        ) : (\r\n                          <div className=\"h-10 w-10 rounded-lg bg-background flex items-center justify-center text-muted-foreground text-lg font-semibold border border-border\">\r\n                            {deal.name.charAt(0)}\r\n                          </div>\r\n                        )}\r\n                        <div>\r\n                          <CardTitle className=\"text-base text-foreground\">\r\n                            {deal.name}\r\n                          </CardTitle>\r\n                          <CardDescription className=\"text-xs text-muted-foreground\">\r\n                            {deal.company_name ?? 'Issuer TBA'}\r\n                          </CardDescription>\r\n                        </div>\r\n                      </div>\r\n                      <Badge className={cn('text-xs font-medium', stageMeta.bgColor, stageMeta.textColor, stageMeta.borderColor, 'border')}>\r\n                        <StageIcon className=\"h-3 w-3 mr-1\" />\r\n                        {stageMeta.label}\r\n                      </Badge>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0 space-y-3\">\r\n                    {/* Progress indicator */}\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"flex-1 h-1.5 bg-muted rounded-full overflow-hidden\">\r\n                        <div\r\n                          className={cn(\r\n                            'h-full rounded-full transition-all',\r\n                            stageMeta.stage === 6 ? 'w-1/4 bg-blue-500' :\r\n                            stageMeta.stage === 7 ? 'w-2/4 bg-indigo-500' :\r\n                            stageMeta.stage === 8 ? 'w-3/4 bg-purple-500' :\r\n                            'w-full bg-emerald-500'\r\n                          )}\r\n                        />\r\n                      </div>\r\n                      <span className=\"text-xs text-muted-foreground\">\r\n                        Stage {stageMeta.stage}/10\r\n                      </span>\r\n                    </div>\r\n\r\n                    {/* Submission date */}\r\n                    <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\r\n                      <span>Submitted</span>\r\n                      <span>{new Date(subscription.submitted_at).toLocaleDateString()}</span>\r\n                    </div>\r\n\r\n                    {/* View Details button */}\r\n                    <Link\r\n                      href={`${detailUrlBase}/${deal.id}`}\r\n                      prefetch={false}\r\n                      onClick={() => console.log(`[DealsList] CLICKED: \"${deal.name}\" â†’ navigating to ${detailUrlBase}/${deal.id}`)}\r\n                      data-deal-id={deal.id}\r\n                      data-deal-name={deal.name}\r\n                    >\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"w-full gap-2 mt-2\"\r\n                      >\r\n                        View Details\r\n                        <ArrowUpRight className=\"h-3 w-3\" />\r\n                      </Button>\r\n                    </Link>\r\n                  </CardContent>\r\n                </Card>\r\n              )\r\n            })}\r\n          </div>\r\n\r\n          {/* Divider */}\r\n          <div className=\"flex items-center gap-4 pt-4\">\r\n            <div className=\"flex-1 h-px bg-border\" />\r\n            <span className=\"text-sm text-muted-foreground\">Open Opportunities</span>\r\n            <div className=\"flex-1 h-px bg-border\" />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Deals Grid */}\r\n      {filteredDeals.length === 0 ? (\r\n        <div className=\"text-center py-16\">\r\n          {dealsData.length === 0 ? (\r\n            <>\r\n              <Users className=\"h-14 w-14 text-muted-foreground/50 mx-auto mb-4\" />\r\n              <h2 className=\"text-xl font-semibold text-foreground mb-2\">No deals available yet</h2>\r\n              <p className=\"text-muted-foreground\">\r\n                The team hasn&apos;t invited you to any opportunities. We&apos;ll notify you as soon as a deal opens up.\r\n              </p>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <AlertCircle className=\"h-14 w-14 text-muted-foreground/50 mx-auto mb-4\" />\r\n              <h2 className=\"text-xl font-semibold text-foreground mb-2\">No deals match your filters</h2>\r\n              <p className=\"text-muted-foreground mb-4\">\r\n                Try adjusting your search or filter criteria\r\n              </p>\r\n              <Button onClick={resetFilters} variant=\"outline\">\r\n                Clear all filters\r\n              </Button>\r\n            </>\r\n          )}\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-6\">\r\n          {filteredDeals.map((deal, index) => {\r\n            // DEBUG: Log each deal being rendered\r\n            console.log(`[DealsList] Rendering card #${index}: \"${deal.name}\" (ID: ${deal.id})`)\r\n\r\n            const feeStructure = feeStructureMap.get(deal.id) ?? null\r\n            const interest = interestByDeal.get(deal.id) ?? null\r\n            const ndaAccess = accessByDeal.get(deal.id) ?? null\r\n            const subscription = subscriptionByDeal.get(deal.id) ?? null\r\n            const membershipRole = deal.deal_memberships?.[0]?.role ?? null\r\n            const canInvest = isInvestorEligibleRole(membershipRole)\r\n            const isTrackingOnly = !!membershipRole && !canInvest\r\n\r\n            const effectiveStatus = getEffectiveStatus(deal)\r\n            const statusLabel =\r\n              dealTypeLabels[deal.deal_type] ?? deal.deal_type.replace(/_/g, ' ')\r\n\r\n            const deadlineCopy = formatDeadlineCopy(deal.close_at, effectiveStatus)\r\n\r\n            const indicativeAmount = interest?.indicative_amount ?? null\r\n            const indicativeCurrency =\r\n              interest?.indicative_currency ?? deal.currency ?? null\r\n\r\n            const hasDataRoomAccess = Boolean(ndaAccess)\r\n            const isClosed = effectiveStatus === 'closed'\r\n\r\n            // Check if deal was dispatched within last 7 days\r\n            const dispatchedAt = deal.deal_memberships?.[0]?.dispatched_at\r\n            const isNewlyDispatched = dispatchedAt &&\r\n              (Date.now() - new Date(dispatchedAt).getTime()) < 7 * 24 * 60 * 60 * 1000\r\n\r\n            return (\r\n              <Card key={deal.id} className=\"overflow-hidden border border-border shadow-sm\">\r\n                <CardHeader className=\"space-y-3\">\r\n                  <div className=\"flex items-start justify-between gap-4\">\r\n                    <div className=\"flex items-start gap-3\">\r\n                      {deal.company_logo_url ? (\r\n                        <Image\r\n                          src={deal.company_logo_url}\r\n                          alt={`${deal.company_name ?? deal.name} logo`}\r\n                          width={56}\r\n                          height={56}\r\n                          className=\"rounded-lg object-contain bg-background border border-border p-2\"\r\n                        />\r\n                      ) : (\r\n                        <div className=\"h-14 w-14 rounded-lg bg-muted flex items-center justify-center text-muted-foreground text-xl font-semibold\">\r\n                          {deal.name.charAt(0)}\r\n                        </div>\r\n                      )}\r\n                      <div>\r\n                        <CardTitle className=\"text-xl text-foreground flex items-center gap-2\">\r\n                          {deal.name}\r\n                          <Badge className={cn('text-xs', statusBadges[effectiveStatus] ?? statusBadges.draft)}>\r\n                            {effectiveStatus.replace(/_/g, ' ').toUpperCase()}\r\n                          </Badge>\r\n                          {isNewlyDispatched && (\r\n                            <Badge className=\"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 text-xs\">\r\n                              NEW\r\n                            </Badge>\r\n                          )}\r\n                        </CardTitle>\r\n                        <CardDescription className=\"text-sm text-muted-foreground flex items-center gap-2\">\r\n                          <Building2 className=\"h-4 w-4 text-muted-foreground\" />\r\n                          {deal.company_name ?? 'Issuer TBA'} â€¢ {statusLabel}\r\n                        </CardDescription>\r\n                        <div className=\"flex flex-wrap items-center gap-2 mt-2 text-xs text-muted-foreground\">\r\n                          {deal.stage && <span>Stage: {deal.stage}</span>}\r\n                          {deal.sector && <span>Sector: {deal.sector}</span>}\r\n                          {deal.location && <span>Location: {deal.location}</span>}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-right space-y-1\">\r\n                      <p className=\"text-xs uppercase tracking-wide text-muted-foreground\">Timeline</p>\r\n                      <p className=\"text-sm font-medium text-foreground\">{deadlineCopy}</p>\r\n                      {ndaAccess?.expires_at && (\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          NDA access until {new Date(ndaAccess.expires_at).toLocaleDateString()}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {deal.company_website && (\r\n                    <div className=\"flex items-center gap-2 text-sm\">\r\n                      <ExternalLink className=\"h-4 w-4 text-blue-500\" />\r\n                      <Link\r\n                        href={deal.company_website}\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                        className=\"text-blue-600 hover:text-blue-700 font-medium\"\r\n                      >\r\n                        Visit company site\r\n                      </Link>\r\n                    </div>\r\n                  )}\r\n                </CardHeader>\r\n\r\n                <CardContent className=\"space-y-6\">\r\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n                    <div>\r\n                      <p className=\"text-xs uppercase tracking-wide text-muted-foreground\">Allocation</p>\r\n                      <p className=\"text-lg font-semibold text-foreground\">\r\n                        {feeStructure?.allocation_up_to\r\n                          ? formatCurrency(feeStructure.allocation_up_to, deal.currency)\r\n                          : deal.target_amount\r\n                            ? formatCurrency(deal.target_amount, deal.currency)\r\n                            : '(Pending)'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs uppercase tracking-wide text-muted-foreground\">Minimum ticket</p>\r\n                      <p className=\"text-lg font-semibold text-foreground\">\r\n                        {feeStructure?.minimum_ticket\r\n                          ? formatCurrency(feeStructure.minimum_ticket, deal.currency)\r\n                          : deal.minimum_investment\r\n                            ? formatCurrency(deal.minimum_investment, deal.currency)\r\n                            : '(Pending)'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs uppercase tracking-wide text-muted-foreground\">Unit price</p>\r\n                      <p className=\"text-lg font-semibold text-foreground\">\r\n                        {feeStructure?.price_per_share_text\r\n                          ? feeStructure.price_per_share_text\r\n                          : deal.offer_unit_price\r\n                            ? `${formatCurrency(deal.offer_unit_price, deal.currency)} per unit`\r\n                            : '(Pending)'}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* ============================================================ */}\r\n                  {/* PARTNER VIEW: Your Referrals (US-5.6.1-01 through 06) */}\r\n                  {/* ============================================================ */}\r\n                  {isPartnerView && (() => {\r\n                    const dealReferrals = referralsByDeal[deal.id] || []\r\n                    const dealSubscriptions = referralSubscriptionsByDeal[deal.id] || []\r\n                    const dealCommissions = partnerCommissionsByDeal[deal.id] || []\r\n\r\n                    // Get the commission rate (they should all be the same for this deal)\r\n                    const commissionRate = dealCommissions[0]?.rate_bps\r\n                      ? `${(dealCommissions[0].rate_bps / 100).toFixed(2)}%`\r\n                      : null\r\n\r\n                    // Calculate estimated commission from funded subscriptions\r\n                    const fundedSubs = dealSubscriptions.filter(s =>\r\n                      ['funded', 'active', 'activated', 'committed'].includes(s.status?.toLowerCase())\r\n                    )\r\n                    const totalFundedAmount = fundedSubs.reduce((sum, s) => sum + Number(s.commitment || 0), 0)\r\n                    const rateBps = dealCommissions[0]?.rate_bps ?? 0\r\n                    const estCommission = commissionRate && totalFundedAmount > 0 && rateBps > 0\r\n                      ? totalFundedAmount * (rateBps / 10000)\r\n                      : 0\r\n\r\n                    if (dealReferrals.length === 0) {\r\n                      return (\r\n                        <div className=\"rounded-lg border border-blue-100 dark:border-blue-900/50 bg-blue-50/50 dark:bg-blue-950/30 px-4 py-3\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <UserPlus className=\"h-4 w-4 text-blue-500 dark:text-blue-400\" />\r\n                              <span className=\"text-sm text-blue-700 dark:text-blue-300\">No referrals yet</span>\r\n                            </div>\r\n                            {commissionRate && (\r\n                              <span className=\"text-xs text-blue-600 dark:text-blue-400\">\r\n                                Fee: {commissionRate} of invested\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      )\r\n                    }\r\n\r\n                    return (\r\n                      <div className=\"rounded-lg border border-blue-100 dark:border-blue-900/50 bg-blue-50/50 dark:bg-blue-950/30 px-4 py-3 space-y-3\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <UserPlus className=\"h-4 w-4 text-blue-500 dark:text-blue-400\" />\r\n                            <span className=\"text-sm font-medium text-blue-900 dark:text-blue-100\">\r\n                              Your Referrals ({dealReferrals.length})\r\n                            </span>\r\n                          </div>\r\n                          {commissionRate && (\r\n                            <span className=\"text-xs text-blue-600 dark:text-blue-400\">\r\n                              Fee: {commissionRate} of invested\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n\r\n                        {/* List of referred investors with stage badges */}\r\n                        <div className=\"space-y-2\">\r\n                          {dealReferrals.slice(0, 5).map((referral) => {\r\n                            const stage = getReferralStage(referral, dealSubscriptions)\r\n                            const stageMeta = referralStageMeta[stage]\r\n\r\n                            return (\r\n                              <div\r\n                                key={referral.investor_id}\r\n                                className=\"flex items-center justify-between text-sm\"\r\n                              >\r\n                                <span className=\"text-foreground truncate max-w-[200px]\">\r\n                                  {referral.investor_name}\r\n                                </span>\r\n                                <Badge\r\n                                  variant=\"outline\"\r\n                                  className={cn(\r\n                                    'text-xs',\r\n                                    stageMeta.bgColor,\r\n                                    stageMeta.textColor,\r\n                                    stageMeta.borderColor,\r\n                                    'border'\r\n                                  )}\r\n                                >\r\n                                  {stageMeta.label}\r\n                                </Badge>\r\n                              </div>\r\n                            )\r\n                          })}\r\n                          {dealReferrals.length > 5 && (\r\n                            <p className=\"text-xs text-blue-600 dark:text-blue-400\">\r\n                              +{dealReferrals.length - 5} more referrals\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n\r\n                        {/* Estimated commission summary */}\r\n                        {estCommission > 0 && (\r\n                          <div className=\"pt-2 border-t border-blue-200 dark:border-blue-800 flex items-center justify-between\">\r\n                            <span className=\"text-xs text-blue-600 dark:text-blue-400\">Est. Commission:</span>\r\n                            <span className=\"text-sm font-semibold text-blue-900 dark:text-blue-100\">\r\n                              {formatCurrency(estCommission, dealCommissions[0]?.currency || deal.currency)}\r\n                            </span>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )\r\n                  })()}\r\n\r\n                  {/* ============================================================ */}\r\n                  {/* INVESTOR VIEW: Your Pipeline (original investor tracking) */}\r\n                  {/* ============================================================ */}\r\n                  {isInvestorView && (\r\n                    <div className=\"grid grid-cols-1 gap-4\">\r\n                      <div>\r\n                        <p className=\"text-xs uppercase tracking-wide text-muted-foreground\">Your pipeline</p>\r\n                        <div className=\"flex flex-wrap items-center gap-2\">\r\n                          {interest ? (\r\n                            interest.is_post_close ? (\r\n                              <Badge className=\"w-fit bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300\">\r\n                                Future interest signal\r\n                              </Badge>\r\n                            ) : (\r\n                              <Badge className={cn('w-fit', interestStatusMeta[interest.status].tone)}>\r\n                                {interestStatusMeta[interest.status].label}\r\n                              </Badge>\r\n                            )\r\n                          ) : (\r\n                            <span className=\"text-sm text-muted-foreground\">No signal yet</span>\r\n                          )}\r\n                          {subscription && (\r\n                            <Badge variant=\"outline\" className=\"text-indigo-600 dark:text-indigo-400 border-indigo-300 dark:border-indigo-700\">\r\n                              Subscription {subscription.status.replace(/_/g, ' ')}\r\n                            </Badge>\r\n                          )}\r\n                          {isTrackingOnly && (\r\n                            <Badge variant=\"outline\" className=\"border-amber-200 dark:border-amber-700 text-amber-700 dark:text-amber-300\">\r\n                              Tracking only\r\n                            </Badge>\r\n                          )}\r\n                          {hasDataRoomAccess && (\r\n                            <Badge variant=\"outline\" className=\"text-sky-600 dark:text-sky-400 border-sky-300 dark:border-sky-700\">\r\n                              Data room unlocked\r\n                            </Badge>\r\n                          )}\r\n                          {feeStructure?.interest_confirmation_deadline && (\r\n                            <span className=\"text-xs text-muted-foreground\">\r\n                              Interest deadline: {new Date(feeStructure.interest_confirmation_deadline).toLocaleDateString()}\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* ============================================================ */}\r\n                  {/* GENERIC VIEW: Basic tracking info */}\r\n                  {/* ============================================================ */}\r\n                  {personaMode === 'GENERIC' && (\r\n                    <div className=\"rounded-lg border border-border bg-muted px-4 py-3\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n                        <span className=\"text-sm text-muted-foreground\">View-only access</span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {isInvestorView && interest && indicativeAmount ? (\r\n                    <div className=\"rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30 px-4 py-3 text-sm text-amber-700 dark:text-amber-300\">\r\n                      You indicated interest for approximately{' '}\r\n                      <span className=\"font-semibold\">\r\n                        {formatCurrency(indicativeAmount, indicativeCurrency)}\r\n                      </span>\r\n                      .\r\n                    </div>\r\n                  ) : null}\r\n\r\n                  <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-3\">\r\n                    <div className=\"flex items-center gap-3 text-sm text-muted-foreground\">\r\n                      <CalendarClock className=\"h-4 w-4 text-muted-foreground\" />\r\n                      {deal.open_at\r\n                        ? `Opened ${new Date(deal.open_at).toLocaleDateString()}`\r\n                        : 'Opening window announced soon'}\r\n                    </div>\r\n                    <div className=\"flex flex-wrap items-center gap-3\">\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        className=\"gap-2\"\r\n                        data-deal-id={deal.id}\r\n                        data-deal-name={deal.name}\r\n                        onClick={() => {\r\n                          const url = `${detailUrlBase}/${deal.id}`\r\n                          console.log(`[DealsList] CLICKED: \"${deal.name}\" (ID: ${deal.id}) â†’ HARD navigating to ${url}`)\r\n                          // NUCLEAR OPTION: Force full page reload to bypass ALL Next.js caching\r\n                          window.location.href = url\r\n                        }}\r\n                      >\r\n                        View details\r\n                        <ArrowUpRight className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      {/* Subscribe to Investment - primary CTA for investors with valid investor ID */}\r\n                      {!isClosed && primaryInvestorId && canInvest && (\r\n                        <SubscribeNowDialog\r\n                          dealId={deal.id}\r\n                          dealName={deal.name}\r\n                          currency={deal.currency}\r\n                          existingSubmission={subscription}\r\n                        >\r\n                          <Button className=\"gap-2 bg-emerald-600 hover:bg-emerald-700\">\r\n                            Subscribe to Investment Opportunity\r\n                            <ArrowUpRight className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </SubscribeNowDialog>\r\n                      )}\r\n\r\n                      {/* Submit Interest for Data Room - secondary CTA for investors with a valid investor ID */}\r\n                      {primaryInvestorId && canInvest && (\r\n                        <InterestModal\r\n                          dealId={deal.id}\r\n                          dealName={deal.name}\r\n                          currency={deal.currency}\r\n                          investorId={primaryInvestorId}\r\n                          defaultAmount={indicativeAmount}\r\n                          isClosed={isClosed}\r\n                        >\r\n                          <Button className=\"gap-2\" variant={isClosed ? 'secondary' : 'outline'}>\r\n                            {isClosed ? \"Notify Me About Similar\" : \"Submit Interest for Data Room\"}\r\n                            <ArrowUpRight className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </InterestModal>\r\n                      )}\r\n\r\n                      {/* Partner Share Deal - PRD Rows 95-96 */}\r\n                      {partnerId && !isClosed && (\r\n                        <ShareDealDialog\r\n                          dealId={deal.id}\r\n                          dealName={deal.name}\r\n                          partnerId={partnerId}\r\n                        >\r\n                          <Button className=\"gap-2 bg-blue-600 hover:bg-blue-700\">\r\n                            <Share2 className=\"h-4 w-4\" />\r\n                            Share with Investor\r\n                          </Button>\r\n                        </ShareDealDialog>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )\r\n          })}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}