{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/table.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Table({ className, ...props }: React.ComponentProps<\"table\">) {\n  return (\n    <div\n      data-slot=\"table-container\"\n      className=\"relative w-full overflow-x-auto\"\n    >\n      <table\n        data-slot=\"table\"\n        className={cn(\"w-full caption-bottom text-sm\", className)}\n        {...props}\n      />\n    </div>\n  )\n}\n\nfunction TableHeader({ className, ...props }: React.ComponentProps<\"thead\">) {\n  return (\n    <thead\n      data-slot=\"table-header\"\n      className={cn(\"[&_tr]:border-b\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableBody({ className, ...props }: React.ComponentProps<\"tbody\">) {\n  return (\n    <tbody\n      data-slot=\"table-body\"\n      className={cn(\"[&_tr:last-child]:border-0\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableFooter({ className, ...props }: React.ComponentProps<\"tfoot\">) {\n  return (\n    <tfoot\n      data-slot=\"table-footer\"\n      className={cn(\n        \"bg-muted/50 border-t font-medium [&>tr]:last:border-b-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableRow({ className, ...props }: React.ComponentProps<\"tr\">) {\n  return (\n    <tr\n      data-slot=\"table-row\"\n      className={cn(\n        \"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableHead({ className, ...props }: React.ComponentProps<\"th\">) {\n  return (\n    <th\n      data-slot=\"table-head\"\n      className={cn(\n        // Responsive: smaller text on mobile, allow text wrapping for narrow screens\n        \"text-foreground h-11 md:h-10 px-2 text-left align-middle font-medium text-xs sm:text-sm [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCell({ className, ...props }: React.ComponentProps<\"td\">) {\n  return (\n    <td\n      data-slot=\"table-cell\"\n      className={cn(\n        // Responsive: smaller text on mobile, allow text wrapping for narrow screens\n        \"p-2 align-middle text-xs sm:text-sm [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCaption({\n  className,\n  ...props\n}: React.ComponentProps<\"caption\">) {\n  return (\n    <caption\n      data-slot=\"table-caption\"\n      className={cn(\"text-muted-foreground mt-4 text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAIA;AAJA;;;AAMA,SAAS,MAAM,EAAE,SAAS,EAAE,GAAG,OAAsC;IACnE,qBACE,oNAAC;QACC,aAAU;QACV,WAAU;kBAEV,cAAA,oNAAC;YACC,aAAU;YACV,WAAW,IAAA,mJAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;AAIjB;KAbS;AAeT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,mBAAmB;QAChC,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAsC;IACvE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,2DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAmC;IACnE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,+EACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,6EAA6E;QAC7E,+JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAZS;AAcT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,6EAA6E;QAC7E,2GACA;QAED,GAAG,KAAK;;;;;;AAGf;MAZS;AAcT,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OAC6B;IAChC,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 270, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/lib/format.ts"],"sourcesContent":["export const formatCurrency = (value: number | null | undefined, currency: string = 'USD') => {\n  if (!value) return '$0'\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: currency,\n    maximumFractionDigits: 0,\n  }).format(value)\n}\n\nexport const formatBps = (bps: number | null | undefined) => {\n  if (bps === null || bps === undefined) return '—'\n  return `${bps} bps`\n}\n\nexport const formatPercentage = (value: number | null | undefined) => {\n  if (!value) return '0%'\n  return `${(value * 100).toFixed(1)}%`\n}\n\nexport const formatDate = (value: string | Date | null | undefined) => {\n  if (!value) return '—'\n  const date = typeof value === 'string' ? new Date(value) : value\n  if (Number.isNaN(date?.getTime?.())) return '—'\n  // Use explicit locale to prevent hydration mismatch between server/client\n  return date.toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\n\n\n\n"],"names":[],"mappings":";;;;;;;;;;AAAO,MAAM,iBAAiB,CAAC,OAAkC,WAAmB,KAAK;IACvF,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAEO,MAAM,YAAY,CAAC;IACxB,IAAI,QAAQ,QAAQ,QAAQ,WAAW,OAAO;IAC9C,OAAO,GAAG,IAAI,IAAI,CAAC;AACrB;AAEO,MAAM,mBAAmB,CAAC;IAC/B,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,GAAG,CAAC,QAAQ,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;AACvC;AAEO,MAAM,aAAa,CAAC;IACzB,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,OAAO,OAAO,UAAU,WAAW,IAAI,KAAK,SAAS;IAC3D,IAAI,OAAO,KAAK,CAAC,MAAM,cAAc,OAAO;IAC5C,0EAA0E;IAC1E,OAAO,KAAK,kBAAkB,CAAC,SAAS;QACtC,MAAM;QACN,OAAO;QACP,KAAK;IACP;AACF"}},
    {"offset": {"line": 314, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/app/%28main%29/versotech_main/introducer-agreements/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectGroup,\r\n  SelectItem,\r\n  SelectLabel,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table'\r\nimport {\r\n  FileText,\r\n  Clock,\r\n  CheckCircle2,\r\n  Search,\r\n  Loader2,\r\n  AlertCircle,\r\n  FileSignature,\r\n  Calendar,\r\n  Globe,\r\n  Percent,\r\n  AlertTriangle,\r\n  FileDown,\r\n} from 'lucide-react'\r\nimport { toast } from 'sonner'\r\nimport { cn } from '@/lib/utils'\r\nimport { formatDate } from '@/lib/format'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useRouter } from 'next/navigation'\r\n\r\ntype Agreement = {\r\n  id: string\r\n  agreement_type: string\r\n  signed_date: string | null\r\n  effective_date: string | null\r\n  expiry_date: string | null\r\n  default_commission_bps: number\r\n  commission_cap_amount: number | null\r\n  payment_terms: string | null\r\n  territory: string | null\r\n  deal_types: string[] | null\r\n  exclusivity_level: string | null\r\n  status: string\r\n  created_at: string\r\n  pdf_url: string | null\r\n  reference_number: string | null\r\n}\r\n\r\ntype IntroducerInfo = {\r\n  id: string\r\n  legal_name: string\r\n  status: string\r\n  default_commission_bps: number | null\r\n  logo_url: string | null\r\n}\r\n\r\ntype Summary = {\r\n  totalAgreements: number\r\n  activeAgreements: number\r\n  pendingAgreements: number\r\n  expiringSoon: number\r\n}\r\n\r\nconst STATUS_STYLES: Record<string, { className: string; label: string }> = {\r\n  // Workflow statuses with distinctive colors\r\n  draft: {\r\n    className: 'bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-700',\r\n    label: 'Draft',\r\n  },\r\n  sent: {\r\n    className: 'bg-sky-100 text-sky-700 border-sky-200 dark:bg-sky-900/50 dark:text-sky-300 dark:border-sky-800',\r\n    label: 'Sent',\r\n  },\r\n  pending_approval: {\r\n    className: 'bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/50 dark:text-amber-300 dark:border-amber-800',\r\n    label: 'Pending Approval',\r\n  },\r\n  approved: {\r\n    className: 'bg-teal-100 text-teal-700 border-teal-200 dark:bg-teal-900/50 dark:text-teal-300 dark:border-teal-800',\r\n    label: 'Approved',\r\n  },\r\n  pending_ceo_signature: {\r\n    className: 'bg-indigo-100 text-indigo-700 border-indigo-200 dark:bg-indigo-900/50 dark:text-indigo-300 dark:border-indigo-800',\r\n    label: 'Awaiting CEO',\r\n  },\r\n  pending_introducer_signature: {\r\n    className: 'bg-violet-100 text-violet-700 border-violet-200 dark:bg-violet-900/50 dark:text-violet-300 dark:border-violet-800',\r\n    label: 'Awaiting Introducer',\r\n  },\r\n  active: {\r\n    className: 'bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-900/50 dark:text-emerald-300 dark:border-emerald-800',\r\n    label: 'Active',\r\n  },\r\n  rejected: {\r\n    className: 'bg-rose-100 text-rose-700 border-rose-200 dark:bg-rose-900/50 dark:text-rose-300 dark:border-rose-800',\r\n    label: 'Rejected',\r\n  },\r\n  expired: {\r\n    className: 'bg-orange-100 text-orange-700 border-orange-200 dark:bg-orange-900/50 dark:text-orange-300 dark:border-orange-800',\r\n    label: 'Expired',\r\n  },\r\n  terminated: {\r\n    className: 'bg-red-100 text-red-700 border-red-200 dark:bg-red-900/50 dark:text-red-300 dark:border-red-800',\r\n    label: 'Terminated',\r\n  },\r\n}\r\n\r\nconst STATUS_FILTERS = [\r\n  { label: 'All Agreements', value: 'all', group: null },\r\n  // In Progress\r\n  { label: 'Draft', value: 'draft', group: 'In Progress' },\r\n  { label: 'Sent', value: 'sent', group: 'In Progress' },\r\n  { label: 'Pending Approval', value: 'pending_approval', group: 'In Progress' },\r\n  { label: 'Approved', value: 'approved', group: 'In Progress' },\r\n  // Awaiting Signatures\r\n  { label: 'Awaiting CEO Signature', value: 'pending_ceo_signature', group: 'Signatures' },\r\n  { label: 'Awaiting Introducer Signature', value: 'pending_introducer_signature', group: 'Signatures' },\r\n  // Final States\r\n  { label: 'Active', value: 'active', group: 'Final' },\r\n  { label: 'Rejected', value: 'rejected', group: 'Final' },\r\n  { label: 'Expired', value: 'expired', group: 'Final' },\r\n  { label: 'Terminated', value: 'terminated', group: 'Final' },\r\n]\r\n\r\nconst AGREEMENT_TYPE_LABELS: Record<string, string> = {\r\n  referral: 'Referral Agreement',\r\n  revenue_share: 'Revenue Share',\r\n  fixed_fee: 'Fixed Fee',\r\n  hybrid: 'Hybrid',\r\n}\r\n\r\nexport default function IntroducerAgreementsPage() {\r\n  const router = useRouter()\r\n  const [introducerInfo, setIntroducerInfo] = useState<IntroducerInfo | null>(null)\r\n  const [agreements, setAgreements] = useState<Agreement[]>([])\r\n  const [summary, setSummary] = useState<Summary>({\r\n    totalAgreements: 0,\r\n    activeAgreements: 0,\r\n    pendingAgreements: 0,\r\n    expiringSoon: 0,\r\n  })\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [search, setSearch] = useState('')\r\n  const [statusFilter, setStatusFilter] = useState('all')\r\n  const [downloadingPdf, setDownloadingPdf] = useState<string | null>(null)\r\n\r\n  // Handle PDF download\r\n  const handleDownloadPdf = async (e: React.MouseEvent, pdfUrl: string, referenceNumber: string | null) => {\r\n    e.stopPropagation() // Prevent row click navigation\r\n    setDownloadingPdf(pdfUrl)\r\n    try {\r\n      const response = await fetch(`/api/storage/download?path=${encodeURIComponent(pdfUrl)}&bucket=deal-documents`)\r\n      if (!response.ok) {\r\n        throw new Error('Failed to download file')\r\n      }\r\n      const blob = await response.blob()\r\n      const url = window.URL.createObjectURL(blob)\r\n      const link = document.createElement('a')\r\n      link.href = url\r\n      // Extract actual filename from the storage path, or fall back to reference number\r\n      const actualFilename = pdfUrl.split('/').pop() || `${referenceNumber || 'Fee_Agreement'}.pdf`\r\n      link.download = actualFilename\r\n      document.body.appendChild(link)\r\n      link.click()\r\n      document.body.removeChild(link)\r\n      window.URL.revokeObjectURL(url)\r\n      toast.success('PDF downloaded successfully')\r\n    } catch (error) {\r\n      console.error('Error downloading PDF:', error)\r\n      toast.error('Failed to download PDF')\r\n    } finally {\r\n      setDownloadingPdf(null)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      try {\r\n        setLoading(true)\r\n        const supabase = createClient()\r\n\r\n        // Get current user\r\n        const { data: { user } } = await supabase.auth.getUser()\r\n        if (!user) {\r\n          setError('Not authenticated')\r\n          return\r\n        }\r\n\r\n        // Check if user is an introducer\r\n        const { data: introducerUser, error: introducerUserError } = await supabase\r\n          .from('introducer_users')\r\n          .select('introducer_id')\r\n          .eq('user_id', user.id)\r\n          .single()\r\n\r\n        if (introducerUserError || !introducerUser) {\r\n          // Maybe they're staff - show all agreements as placeholder\r\n          await fetchAllAgreements(supabase)\r\n          return\r\n        }\r\n\r\n        // Fetch introducer info\r\n        const { data: introducer, error: introducerError } = await supabase\r\n          .from('introducers')\r\n          .select('id, legal_name, status, default_commission_bps, logo_url')\r\n          .eq('id', introducerUser.introducer_id)\r\n          .single()\r\n\r\n        if (introducerError) throw introducerError\r\n        setIntroducerInfo(introducer)\r\n\r\n        // Fetch agreements for this introducer\r\n        const { data: agreementsData, error: agreementsError } = await supabase\r\n          .from('introducer_agreements')\r\n          .select('*')\r\n          .eq('introducer_id', introducerUser.introducer_id)\r\n          .order('created_at', { ascending: false })\r\n\r\n        if (agreementsError) throw agreementsError\r\n\r\n        processAgreements(agreementsData || [])\r\n        setError(null)\r\n      } catch (err) {\r\n        console.error('[IntroducerAgreementsPage] Error:', err)\r\n        setError(err instanceof Error ? err.message : 'Failed to load agreements')\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    async function fetchAllAgreements(supabase: any) {\r\n      // Staff view - show all agreements with introducer info\r\n      const { data: agreementsData, error: agreementsError } = await supabase\r\n        .from('introducer_agreements')\r\n        .select(`\r\n          *,\r\n          introducer:introducer_id (\r\n            id,\r\n            legal_name,\r\n            status\r\n          )\r\n        `)\r\n        .order('created_at', { ascending: false })\r\n        .limit(100)\r\n\r\n      if (agreementsError) throw agreementsError\r\n      processAgreements(agreementsData || [])\r\n    }\r\n\r\n    function processAgreements(data: any[]) {\r\n      const now = new Date()\r\n      const thirtyDaysFromNow = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000)\r\n\r\n      const processed: Agreement[] = data.map((agreement) => ({\r\n        id: agreement.id,\r\n        agreement_type: agreement.agreement_type || 'referral',\r\n        signed_date: agreement.signed_date,\r\n        effective_date: agreement.effective_date,\r\n        expiry_date: agreement.expiry_date,\r\n        default_commission_bps: agreement.default_commission_bps || 0,\r\n        commission_cap_amount: agreement.commission_cap_amount,\r\n        payment_terms: agreement.payment_terms,\r\n        territory: agreement.territory,\r\n        deal_types: agreement.deal_types,\r\n        exclusivity_level: agreement.exclusivity_level,\r\n        status: agreement.status || 'draft',\r\n        created_at: agreement.created_at,\r\n        pdf_url: agreement.pdf_url || null,\r\n        reference_number: agreement.reference_number || null,\r\n      }))\r\n\r\n      setAgreements(processed)\r\n\r\n      const active = processed.filter(a => a.status === 'active').length\r\n      // Count all \"in-progress\" statuses as pending\r\n      const pendingStatuses = ['draft', 'sent', 'pending_approval', 'approved', 'pending_ceo_signature', 'pending_introducer_signature']\r\n      const pending = processed.filter(a => pendingStatuses.includes(a.status)).length\r\n      const expiring = processed.filter(a => {\r\n        if (!a.expiry_date) return false\r\n        const expDate = new Date(a.expiry_date)\r\n        return expDate > now && expDate <= thirtyDaysFromNow && a.status === 'active'\r\n      }).length\r\n\r\n      setSummary({\r\n        totalAgreements: processed.length,\r\n        activeAgreements: active,\r\n        pendingAgreements: pending,\r\n        expiringSoon: expiring,\r\n      })\r\n    }\r\n\r\n    fetchData()\r\n  }, [])\r\n\r\n  // Check if agreement is expiring soon\r\n  function isExpiringSoon(expiryDate: string | null): boolean {\r\n    if (!expiryDate) return false\r\n    const now = new Date()\r\n    const expDate = new Date(expiryDate)\r\n    const thirtyDaysFromNow = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000)\r\n    return expDate > now && expDate <= thirtyDaysFromNow\r\n  }\r\n\r\n  // Format commission as percentage\r\n  function formatCommission(bps: number): string {\r\n    return `${(bps / 100).toFixed(2)}%`\r\n  }\r\n\r\n  // Filter agreements\r\n  const filteredAgreements = agreements.filter(agreement => {\r\n    const matchesStatus = statusFilter === 'all' || agreement.status === statusFilter\r\n    const matchesSearch = !search ||\r\n      agreement.agreement_type?.toLowerCase().includes(search.toLowerCase()) ||\r\n      agreement.territory?.toLowerCase().includes(search.toLowerCase())\r\n    return matchesStatus && matchesSearch\r\n  })\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-16\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\r\n        <span className=\"ml-3 text-muted-foreground\">Loading agreements...</span>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"text-center py-16\">\r\n        <AlertCircle className=\"h-12 w-12 text-destructive mx-auto mb-4\" />\r\n        <h3 className=\"text-lg font-medium text-foreground mb-2\">Error Loading Agreements</h3>\r\n        <p className=\"text-muted-foreground\">{error}</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-foreground\">Fee Agreements</h1>\r\n          <p className=\"text-muted-foreground mt-1\">\r\n            {introducerInfo\r\n              ? `Manage your commission agreements as ${introducerInfo.legal_name}`\r\n              : 'View and manage all introducer agreements'}\r\n          </p>\r\n        </div>\r\n        {introducerInfo && introducerInfo.default_commission_bps && (\r\n          <Badge variant=\"outline\" className=\"text-sm\">\r\n            Default: {formatCommission(introducerInfo.default_commission_bps)}\r\n          </Badge>\r\n        )}\r\n      </div>\r\n\r\n      {/* Summary Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <Card className=\"relative overflow-hidden group hover:shadow-md transition-shadow\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-br from-slate-500/5 to-slate-600/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <div className=\"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800\">\r\n                <FileText className=\"h-3.5 w-3.5 text-slate-600 dark:text-slate-400\" />\r\n              </div>\r\n              Total Agreements\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold tracking-tight\">{summary.totalAgreements}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              All fee arrangements\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"relative overflow-hidden group hover:shadow-md transition-shadow\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-green-600/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <div className=\"p-1.5 rounded-lg bg-emerald-100 dark:bg-emerald-900/50\">\r\n                <CheckCircle2 className=\"h-3.5 w-3.5 text-emerald-600 dark:text-emerald-400\" />\r\n              </div>\r\n              Active\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold tracking-tight text-emerald-600 dark:text-emerald-400\">{summary.activeAgreements}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Currently in effect\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"relative overflow-hidden group hover:shadow-md transition-shadow\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-yellow-600/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <div className=\"p-1.5 rounded-lg bg-amber-100 dark:bg-amber-900/50\">\r\n                <Clock className=\"h-3.5 w-3.5 text-amber-600 dark:text-amber-400\" />\r\n              </div>\r\n              In Progress\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold tracking-tight text-amber-600 dark:text-amber-400\">{summary.pendingAgreements}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Awaiting action\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"relative overflow-hidden group hover:shadow-md transition-shadow\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-red-600/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\r\n              <div className=\"p-1.5 rounded-lg bg-orange-100 dark:bg-orange-900/50\">\r\n                <AlertTriangle className=\"h-3.5 w-3.5 text-orange-600 dark:text-orange-400\" />\r\n              </div>\r\n              Expiring Soon\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold tracking-tight text-orange-600 dark:text-orange-400\">{summary.expiringSoon}</div>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Within 30 days\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex flex-col md:flex-row gap-4\">\r\n            <div className=\"flex-1\">\r\n              <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder=\"Search by type or territory...\"\r\n                  value={search}\r\n                  onChange={(e) => setSearch(e.target.value)}\r\n                  className=\"pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n              <SelectTrigger className=\"w-full md:w-56\">\r\n                <SelectValue placeholder=\"Filter by status\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {/* All option */}\r\n                <SelectItem value=\"all\">All Agreements</SelectItem>\r\n\r\n                {/* In Progress group */}\r\n                <SelectGroup>\r\n                  <SelectLabel className=\"text-xs text-muted-foreground font-semibold px-2 py-1.5\">\r\n                    In Progress\r\n                  </SelectLabel>\r\n                  {STATUS_FILTERS.filter(f => f.group === 'In Progress').map((option) => (\r\n                    <SelectItem key={option.value} value={option.value}>\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <span className={cn(\r\n                          'w-2 h-2 rounded-full',\r\n                          option.value === 'draft' && 'bg-slate-500',\r\n                          option.value === 'sent' && 'bg-sky-500',\r\n                          option.value === 'pending_approval' && 'bg-amber-500',\r\n                          option.value === 'approved' && 'bg-teal-500'\r\n                        )} />\r\n                        {option.label}\r\n                      </span>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectGroup>\r\n\r\n                {/* Signatures group */}\r\n                <SelectGroup>\r\n                  <SelectLabel className=\"text-xs text-muted-foreground font-semibold px-2 py-1.5\">\r\n                    Awaiting Signatures\r\n                  </SelectLabel>\r\n                  {STATUS_FILTERS.filter(f => f.group === 'Signatures').map((option) => (\r\n                    <SelectItem key={option.value} value={option.value}>\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <span className={cn(\r\n                          'w-2 h-2 rounded-full',\r\n                          option.value === 'pending_ceo_signature' && 'bg-indigo-500',\r\n                          option.value === 'pending_introducer_signature' && 'bg-violet-500'\r\n                        )} />\r\n                        {option.label}\r\n                      </span>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectGroup>\r\n\r\n                {/* Final States group */}\r\n                <SelectGroup>\r\n                  <SelectLabel className=\"text-xs text-muted-foreground font-semibold px-2 py-1.5\">\r\n                    Final States\r\n                  </SelectLabel>\r\n                  {STATUS_FILTERS.filter(f => f.group === 'Final').map((option) => (\r\n                    <SelectItem key={option.value} value={option.value}>\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <span className={cn(\r\n                          'w-2 h-2 rounded-full',\r\n                          option.value === 'active' && 'bg-emerald-500',\r\n                          option.value === 'rejected' && 'bg-rose-500',\r\n                          option.value === 'expired' && 'bg-orange-500',\r\n                          option.value === 'terminated' && 'bg-red-500'\r\n                        )} />\r\n                        {option.label}\r\n                      </span>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectGroup>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Agreements Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Agreements</CardTitle>\r\n          <CardDescription>\r\n            {filteredAgreements.length} agreement{filteredAgreements.length !== 1 ? 's' : ''} found\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {filteredAgreements.length === 0 ? (\r\n            <div className=\"border-2 border-dashed border-muted/50 rounded-xl py-16 flex flex-col items-center justify-center text-center space-y-4 bg-gradient-to-br from-muted/20 to-muted/5\">\r\n              <div className=\"p-4 rounded-2xl bg-muted/30\">\r\n                <FileSignature className=\"h-12 w-12 text-muted-foreground/60\" />\r\n              </div>\r\n              <div className=\"space-y-1\">\r\n                <p className=\"text-base font-medium text-muted-foreground\">\r\n                  {search || statusFilter !== 'all'\r\n                    ? 'No agreements match your filters'\r\n                    : introducerInfo\r\n                      ? 'No fee agreements on file'\r\n                      : 'No introducer agreements found'}\r\n                </p>\r\n                {introducerInfo && agreements.length === 0 && (\r\n                  <p className=\"text-sm text-muted-foreground/70 max-w-sm\">\r\n                    Contact your relationship manager to set up a fee agreement and start making introductions.\r\n                  </p>\r\n                )}\r\n                {(search || statusFilter !== 'all') && (\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"mt-2\"\r\n                    onClick={() => {\r\n                      setSearch('')\r\n                      setStatusFilter('all')\r\n                    }}\r\n                  >\r\n                    Clear filters\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"rounded-md border\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>Type</TableHead>\r\n                    <TableHead>Commission</TableHead>\r\n                    <TableHead>Territory</TableHead>\r\n                    <TableHead>Effective</TableHead>\r\n                    <TableHead>Expires</TableHead>\r\n                    <TableHead>Status</TableHead>\r\n                    <TableHead className=\"w-12\">PDF</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {filteredAgreements.map((agreement) => (\r\n                    <TableRow\r\n                      key={agreement.id}\r\n                      className=\"cursor-pointer hover:bg-muted/50 transition-colors duration-150 group\"\r\n                      onClick={() => router.push(`/versotech_main/introducer-agreements/${agreement.id}`)}\r\n                    >\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <FileText className=\"h-4 w-4 text-muted-foreground\" />\r\n                          <div>\r\n                            <div className=\"font-medium\">\r\n                              {AGREEMENT_TYPE_LABELS[agreement.agreement_type] || agreement.agreement_type}\r\n                            </div>\r\n                            {agreement.exclusivity_level && (\r\n                              <div className=\"text-xs text-muted-foreground capitalize\">\r\n                                {agreement.exclusivity_level}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <Percent className=\"h-3 w-3 text-muted-foreground\" />\r\n                          <span className=\"font-medium\">\r\n                            {formatCommission(agreement.default_commission_bps)}\r\n                          </span>\r\n                        </div>\r\n                        {agreement.commission_cap_amount && (\r\n                          <div className=\"text-xs text-muted-foreground\">\r\n                            Cap: ${agreement.commission_cap_amount.toLocaleString()}\r\n                          </div>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <Globe className=\"h-3 w-3 text-muted-foreground\" />\r\n                          <span>{agreement.territory || 'Global'}</span>\r\n                        </div>\r\n                        {agreement.deal_types && agreement.deal_types.length > 0 && (\r\n                          <div className=\"text-xs text-muted-foreground\">\r\n                            {agreement.deal_types.slice(0, 2).join(', ')}\r\n                            {agreement.deal_types.length > 2 && ` +${agreement.deal_types.length - 2}`}\r\n                          </div>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <Calendar className=\"h-3 w-3 text-muted-foreground\" />\r\n                          <span className=\"text-sm\">\r\n                            {agreement.effective_date\r\n                              ? formatDate(agreement.effective_date)\r\n                              : 'Not set'}\r\n                          </span>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className={cn(\r\n                          \"flex items-center gap-1\",\r\n                          isExpiringSoon(agreement.expiry_date) && \"text-orange-600\"\r\n                        )}>\r\n                          {isExpiringSoon(agreement.expiry_date) && (\r\n                            <AlertTriangle className=\"h-3 w-3\" />\r\n                          )}\r\n                          <span className=\"text-sm\">\r\n                            {agreement.expiry_date\r\n                              ? formatDate(agreement.expiry_date)\r\n                              : 'No expiry'}\r\n                          </span>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge\r\n                          variant=\"outline\"\r\n                          className={cn(\r\n                            'font-medium',\r\n                            (STATUS_STYLES[agreement.status] || STATUS_STYLES.draft).className\r\n                          )}\r\n                        >\r\n                          {(STATUS_STYLES[agreement.status] || STATUS_STYLES.draft).label}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {agreement.pdf_url ? (\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={(e) => handleDownloadPdf(e, agreement.pdf_url!, agreement.reference_number)}\r\n                            disabled={downloadingPdf === agreement.pdf_url}\r\n                            className=\"h-8 w-8 p-0 text-blue-500 hover:text-blue-400 hover:bg-blue-500/10\"\r\n                            title=\"Download PDF\"\r\n                          >\r\n                            {downloadingPdf === agreement.pdf_url ? (\r\n                              <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                            ) : (\r\n                              <FileDown className=\"h-4 w-4\" />\r\n                            )}\r\n                          </Button>\r\n                        ) : (\r\n                          <span className=\"text-xs text-muted-foreground\">—</span>\r\n                        )}\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}