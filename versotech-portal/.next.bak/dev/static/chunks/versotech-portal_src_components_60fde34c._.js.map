{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,oNAAC;QACC,aAAU;QACV,WAAW,IAAA,mJAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/audit/audit-log-filters.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useRouter, useSearchParams } from 'next/navigation'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Search, Filter, Download, Calendar } from 'lucide-react'\r\nimport { useState } from 'react'\r\nimport { Card, CardContent } from '@/components/ui/card'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\n\r\nexport function AuditLogFilters() {\r\n  const router = useRouter()\r\n  const searchParams = useSearchParams()\r\n  const [search, setSearch] = useState(searchParams.get('search') || '')\r\n\r\n  const handleSearch = (value: string) => {\r\n    const params = new URLSearchParams(searchParams.toString())\r\n    if (value) {\r\n      params.set('search', value)\r\n    } else {\r\n      params.delete('search')\r\n    }\r\n    router.push(`?${params.toString()}`)\r\n  }\r\n\r\n  const handleRiskFilter = (value: string) => {\r\n    const params = new URLSearchParams(searchParams.toString())\r\n    if (value && value !== 'all') {\r\n      params.set('risk', value)\r\n    } else {\r\n      params.delete('risk')\r\n    }\r\n    router.push(`?${params.toString()}`)\r\n  }\r\n\r\n  const handleActionFilter = (value: string) => {\r\n    const params = new URLSearchParams(searchParams.toString())\r\n    if (value && value !== 'all') {\r\n      params.set('action', value)\r\n    } else {\r\n      params.delete('action')\r\n    }\r\n    router.push(`?${params.toString()}`)\r\n  }\r\n\r\n  const handleExport = async () => {\r\n    // Export current filtered audit logs to CSV\r\n    const response = await fetch(`/api/audit/export?${searchParams.toString()}`)\r\n    const blob = await response.blob()\r\n    const url = window.URL.createObjectURL(blob)\r\n    const a = document.createElement('a')\r\n    a.href = url\r\n    a.download = `audit-logs-${new Date().toISOString().split('T')[0]}.csv`\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    window.URL.revokeObjectURL(url)\r\n    document.body.removeChild(a)\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <CardContent className=\"p-4\">\r\n        <div className=\"flex flex-col sm:flex-row gap-4\">\r\n          <div className=\"flex-1\">\r\n            <div className=\"relative\">\r\n              <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"Search audit logs by actor, action, or entity...\"\r\n                className=\"pl-10\"\r\n                value={search}\r\n                onChange={(e) => setSearch(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter') {\r\n                    handleSearch(search)\r\n                  }\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <Select\r\n              defaultValue={searchParams.get('risk') || 'all'}\r\n              onValueChange={handleRiskFilter}\r\n            >\r\n              <SelectTrigger className=\"w-[140px]\">\r\n                <SelectValue placeholder=\"Risk Level\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Risk Levels</SelectItem>\r\n                <SelectItem value=\"low\">Low Risk</SelectItem>\r\n                <SelectItem value=\"medium\">Medium Risk</SelectItem>\r\n                <SelectItem value=\"high\">High Risk</SelectItem>\r\n                <SelectItem value=\"critical\">Critical Risk</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            <Select\r\n              defaultValue={searchParams.get('action') || 'all'}\r\n              onValueChange={handleActionFilter}\r\n            >\r\n              <SelectTrigger className=\"w-[180px]\">\r\n                <SelectValue placeholder=\"Action Type\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Actions</SelectItem>\r\n                <SelectItem value=\"login_success\">Login Success</SelectItem>\r\n                <SelectItem value=\"login_failed\">Login Failed</SelectItem>\r\n                <SelectItem value=\"document_download\">Document Download</SelectItem>\r\n                <SelectItem value=\"document_access\">Document Access</SelectItem>\r\n                <SelectItem value=\"investor_data_modify\">Data Modify</SelectItem>\r\n                <SelectItem value=\"user_role_change\">Role Change</SelectItem>\r\n                <SelectItem value=\"workflow_execution\">Workflow</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            <Button variant=\"outline\" size=\"sm\" onClick={handleExport}>\r\n              <Download className=\"h-4 w-4 mr-2\" />\r\n              Export\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 465, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/audit/audit-log-table.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  Shield,\r\n  User,\r\n  FileText,\r\n  Database,\r\n  Activity,\r\n  Eye,\r\n  Globe,\r\n  AlertTriangle\r\n} from 'lucide-react'\r\nimport { useState } from 'react'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\n\r\ninterface AuditLog {\r\n  id: string\r\n  timestamp: string\r\n  actor_email: string | null\r\n  actor_role: string | null\r\n  action: string\r\n  entity_type: string | null\r\n  entity_id: string | null\r\n  details: string | null\r\n  ip_address: string | null\r\n  user_agent: string | null\r\n  risk_level: string | null\r\n  compliance_flag: boolean | null\r\n  before_value: any\r\n  after_value: any\r\n}\r\n\r\nfunction getActionIcon(action: string) {\r\n  switch (action) {\r\n    case 'login_success':\r\n    case 'login_failed':\r\n    case 'failed_login_attempt':\r\n      return <User className=\"h-4 w-4\" />\r\n    case 'document_download':\r\n    case 'document_access':\r\n      return <FileText className=\"h-4 w-4\" />\r\n    case 'investor_data_modify':\r\n    case 'user_role_change':\r\n      return <Database className=\"h-4 w-4\" />\r\n    case 'workflow_execution':\r\n      return <Activity className=\"h-4 w-4\" />\r\n    default:\r\n      return <Shield className=\"h-4 w-4\" />\r\n  }\r\n}\r\n\r\nfunction getRiskColor(risk: string | null) {\r\n  switch (risk) {\r\n    case 'low':\r\n      return 'bg-green-100 text-green-800'\r\n    case 'medium':\r\n      return 'bg-yellow-100 text-yellow-800'\r\n    case 'high':\r\n      return 'bg-red-100 text-red-800'\r\n    case 'critical':\r\n      return 'bg-red-200 text-red-900'\r\n    default:\r\n      return 'bg-gray-100 text-foreground'\r\n  }\r\n}\r\n\r\nfunction getRoleColor(role: string | null) {\r\n  switch (role) {\r\n    case 'staff_admin':\r\n      return 'bg-purple-100 text-purple-800'\r\n    case 'staff_rm':\r\n      return 'bg-blue-100 text-blue-800'\r\n    case 'staff_ops':\r\n      return 'bg-green-100 text-green-800'\r\n    case 'investor':\r\n      return 'bg-gray-100 text-foreground'\r\n    case 'system':\r\n      return 'bg-orange-100 text-orange-800'\r\n    default:\r\n      return 'bg-gray-100 text-foreground'\r\n  }\r\n}\r\n\r\nexport function AuditLogTable({ logs }: { logs: AuditLog[] }) {\r\n  const [selectedLog, setSelectedLog] = useState<AuditLog | null>(null)\r\n\r\n  if (!logs || logs.length === 0) {\r\n    return (\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Audit Trail</CardTitle>\r\n          <CardDescription>\r\n            Comprehensive log of all system activities and user actions\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-center py-12 text-muted-foreground\">\r\n            No audit logs found. Try adjusting your filters.\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Audit Trail</CardTitle>\r\n          <CardDescription>\r\n            Showing {logs.length} audit events\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {logs.map((log) => (\r\n              <div\r\n                key={log.id}\r\n                className=\"border border-gray-800 rounded-lg p-4 hover:bg-gray-900/50 transition-colors cursor-pointer\"\r\n                onClick={() => setSelectedLog(log)}\r\n              >\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex items-start gap-4 flex-1\">\r\n                    <div\r\n                      className={`w-10 h-10 rounded-lg flex items-center justify-center border ${\r\n                        log.risk_level === 'high' || log.risk_level === 'critical'\r\n                          ? 'bg-red-950/30 border-red-800'\r\n                          : log.risk_level === 'medium'\r\n                          ? 'bg-yellow-950/30 border-yellow-800'\r\n                          : 'bg-green-950/30 border-green-800'\r\n                      }`}\r\n                    >\r\n                      {getActionIcon(log.action)}\r\n                    </div>\r\n\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-2 mb-2\">\r\n                        <h3 className=\"font-semibold text-foreground\">\r\n                          {log.action.replace(/_/g, ' ').replace(/\\b\\w/g, (l) => l.toUpperCase())}\r\n                        </h3>\r\n                        {log.compliance_flag && (\r\n                          <Badge className=\"bg-yellow-100 text-yellow-800\">\r\n                            <AlertTriangle className=\"h-3 w-3 mr-1\" />\r\n                            Compliance\r\n                          </Badge>\r\n                        )}\r\n                        {log.risk_level && (\r\n                          <Badge className={getRiskColor(log.risk_level)}>\r\n                            {log.risk_level} risk\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n\r\n                      <p className=\"text-foreground mb-3\">{log.details || 'No details provided'}</p>\r\n\r\n                      <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4 text-sm\">\r\n                        <div>\r\n                          <div className=\"font-medium text-foreground\">Actor</div>\r\n                          <div className=\"text-muted-foreground\">{log.actor_email || 'Unknown'}</div>\r\n                          {log.actor_role && (\r\n                            <Badge className={`${getRoleColor(log.actor_role)} text-xs`}>\r\n                              {log.actor_role.replace('_', ' ')}\r\n                            </Badge>\r\n                          )}\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"font-medium text-foreground\">Timestamp</div>\r\n                          <div className=\"text-muted-foreground\">\r\n                            {new Date(log.timestamp).toLocaleString()}\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"font-medium text-foreground\">Entity</div>\r\n                          <div className=\"text-muted-foreground\">\r\n                            {log.entity_type || 'N/A'}\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"font-medium text-foreground\">IP Address</div>\r\n                          <div className=\"text-muted-foreground flex items-center gap-1\">\r\n                            <Globe className=\"h-3 w-3\" />\r\n                            {log.ip_address || 'N/A'}\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"font-medium text-foreground\">ID</div>\r\n                          <div className=\"text-muted-foreground font-mono text-xs\">\r\n                            {log.id.substring(0, 8)}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => setSelectedLog(log)}>\r\n                    <Eye className=\"h-4 w-4 mr-2\" />\r\n                    Details\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Dialog open={!!selectedLog} onOpenChange={() => setSelectedLog(null)}>\r\n        <DialogContent className=\"max-w-3xl max-h-[80vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>Audit Log Details</DialogTitle>\r\n            <DialogDescription>\r\n              Complete information for this audit event\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          {selectedLog && (\r\n            <div className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">Event ID</h4>\r\n                  <p className=\"text-sm text-muted-foreground font-mono\">{selectedLog.id}</p>\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">Timestamp</h4>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {new Date(selectedLog.timestamp).toLocaleString()}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">Actor</h4>\r\n                  <p className=\"text-sm text-muted-foreground\">{selectedLog.actor_email}</p>\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">Role</h4>\r\n                  <Badge className={getRoleColor(selectedLog.actor_role)}>\r\n                    {selectedLog.actor_role || 'Unknown'}\r\n                  </Badge>\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">Action</h4>\r\n                  <p className=\"text-sm text-muted-foreground\">{selectedLog.action}</p>\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">Risk Level</h4>\r\n                  <Badge className={getRiskColor(selectedLog.risk_level)}>\r\n                    {selectedLog.risk_level || 'Unknown'}\r\n                  </Badge>\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">IP Address</h4>\r\n                  <p className=\"text-sm text-muted-foreground\">{selectedLog.ip_address || 'N/A'}</p>\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">Entity</h4>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {selectedLog.entity_type} ({selectedLog.entity_id || 'N/A'})\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <h4 className=\"font-medium mb-1\">Details</h4>\r\n                <p className=\"text-sm text-muted-foreground\">{selectedLog.details}</p>\r\n              </div>\r\n\r\n              {selectedLog.user_agent && (\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">User Agent</h4>\r\n                  <p className=\"text-sm text-muted-foreground font-mono text-xs break-all\">\r\n                    {selectedLog.user_agent}\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              {selectedLog.before_value && (\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">Before Value</h4>\r\n                  <pre className=\"text-sm bg-gray-900 p-3 rounded-lg overflow-auto\">\r\n                    {JSON.stringify(selectedLog.before_value, null, 2)}\r\n                  </pre>\r\n                </div>\r\n              )}\r\n\r\n              {selectedLog.after_value && (\r\n                <div>\r\n                  <h4 className=\"font-medium mb-1\">After Value</h4>\r\n                  <pre className=\"text-sm bg-gray-900 p-3 rounded-lg overflow-auto\">\r\n                    {JSON.stringify(selectedLog.after_value, null, 2)}\r\n                  </pre>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;;;AAhBA;;;;;;;AAyCA,SAAS,cAAc,MAAc;IACnC,OAAQ;QACN,KAAK;QACL,KAAK;QACL,KAAK;YACH,qBAAO,oNAAC,oOAAI;gBAAC,WAAU;;;;;;QACzB,KAAK;QACL,KAAK;YACH,qBAAO,oNAAC,oPAAQ;gBAAC,WAAU;;;;;;QAC7B,KAAK;QACL,KAAK;YACH,qBAAO,oNAAC,gPAAQ;gBAAC,WAAU;;;;;;QAC7B,KAAK;YACH,qBAAO,oNAAC,gPAAQ;gBAAC,WAAU;;;;;;QAC7B;YACE,qBAAO,oNAAC,0OAAM;gBAAC,WAAU;;;;;;IAC7B;AACF;AAEA,SAAS,aAAa,IAAmB;IACvC,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;AAEA,SAAS,aAAa,IAAmB;IACvC,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;AAEO,SAAS,cAAc,EAAE,IAAI,EAAwB;;IAC1D,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,gMAAQ,EAAkB;IAEhE,IAAI,CAAC,QAAQ,KAAK,MAAM,KAAK,GAAG;QAC9B,qBACE,oNAAC,kKAAI;;8BACH,oNAAC,wKAAU;;sCACT,oNAAC,uKAAS;sCAAC;;;;;;sCACX,oNAAC,6KAAe;sCAAC;;;;;;;;;;;;8BAInB,oNAAC,yKAAW;8BACV,cAAA,oNAAC;wBAAI,WAAU;kCAA0C;;;;;;;;;;;;;;;;;IAMjE;IAEA,qBACE;;0BACE,oNAAC,kKAAI;;kCACH,oNAAC,wKAAU;;0CACT,oNAAC,uKAAS;0CAAC;;;;;;0CACX,oNAAC,6KAAe;;oCAAC;oCACN,KAAK,MAAM;oCAAC;;;;;;;;;;;;;kCAGzB,oNAAC,yKAAW;kCACV,cAAA,oNAAC;4BAAI,WAAU;sCACZ,KAAK,GAAG,CAAC,CAAC,oBACT,oNAAC;oCAEC,WAAU;oCACV,SAAS,IAAM,eAAe;8CAE9B,cAAA,oNAAC;wCAAI,WAAU;;0DACb,oNAAC;gDAAI,WAAU;;kEACb,oNAAC;wDACC,WAAW,CAAC,6DAA6D,EACvE,IAAI,UAAU,KAAK,UAAU,IAAI,UAAU,KAAK,aAC5C,iCACA,IAAI,UAAU,KAAK,WACnB,uCACA,oCACJ;kEAED,cAAc,IAAI,MAAM;;;;;;kEAG3B,oNAAC;wDAAI,WAAU;;0EACb,oNAAC;gEAAI,WAAU;;kFACb,oNAAC;wEAAG,WAAU;kFACX,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,SAAS,CAAC,IAAM,EAAE,WAAW;;;;;;oEAErE,IAAI,eAAe,kBAClB,oNAAC,oKAAK;wEAAC,WAAU;;0FACf,oNAAC,mQAAa;gFAAC,WAAU;;;;;;4EAAiB;;;;;;;oEAI7C,IAAI,UAAU,kBACb,oNAAC,oKAAK;wEAAC,WAAW,aAAa,IAAI,UAAU;;4EAC1C,IAAI,UAAU;4EAAC;;;;;;;;;;;;;0EAKtB,oNAAC;gEAAE,WAAU;0EAAwB,IAAI,OAAO,IAAI;;;;;;0EAEpD,oNAAC;gEAAI,WAAU;;kFACb,oNAAC;;0FACC,oNAAC;gFAAI,WAAU;0FAA8B;;;;;;0FAC7C,oNAAC;gFAAI,WAAU;0FAAyB,IAAI,WAAW,IAAI;;;;;;4EAC1D,IAAI,UAAU,kBACb,oNAAC,oKAAK;gFAAC,WAAW,GAAG,aAAa,IAAI,UAAU,EAAE,QAAQ,CAAC;0FACxD,IAAI,UAAU,CAAC,OAAO,CAAC,KAAK;;;;;;;;;;;;kFAInC,oNAAC;;0FACC,oNAAC;gFAAI,WAAU;0FAA8B;;;;;;0FAC7C,oNAAC;gFAAI,WAAU;0FACZ,IAAI,KAAK,IAAI,SAAS,EAAE,cAAc;;;;;;;;;;;;kFAG3C,oNAAC;;0FACC,oNAAC;gFAAI,WAAU;0FAA8B;;;;;;0FAC7C,oNAAC;gFAAI,WAAU;0FACZ,IAAI,WAAW,IAAI;;;;;;;;;;;;kFAGxB,oNAAC;;0FACC,oNAAC;gFAAI,WAAU;0FAA8B;;;;;;0FAC7C,oNAAC;gFAAI,WAAU;;kGACb,oNAAC,uOAAK;wFAAC,WAAU;;;;;;oFAChB,IAAI,UAAU,IAAI;;;;;;;;;;;;;kFAGvB,oNAAC;;0FACC,oNAAC;gFAAI,WAAU;0FAA8B;;;;;;0FAC7C,oNAAC;gFAAI,WAAU;0FACZ,IAAI,EAAE,CAAC,SAAS,CAAC,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0DAO/B,oNAAC,sKAAM;gDAAC,SAAQ;gDAAU,MAAK;gDAAK,SAAS,IAAM,eAAe;;kEAChE,oNAAC,iOAAG;wDAAC,WAAU;;;;;;oDAAiB;;;;;;;;;;;;;mCA9E/B,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;0BAwFrB,oNAAC,sKAAM;gBAAC,MAAM,CAAC,CAAC;gBAAa,cAAc,IAAM,eAAe;0BAC9D,cAAA,oNAAC,6KAAa;oBAAC,WAAU;;sCACvB,oNAAC,4KAAY;;8CACX,oNAAC,2KAAW;8CAAC;;;;;;8CACb,oNAAC,iLAAiB;8CAAC;;;;;;;;;;;;wBAIpB,6BACC,oNAAC;4BAAI,WAAU;;8CACb,oNAAC;oCAAI,WAAU;;sDACb,oNAAC;;8DACC,oNAAC;oDAAG,WAAU;8DAAmB;;;;;;8DACjC,oNAAC;oDAAE,WAAU;8DAA2C,YAAY,EAAE;;;;;;;;;;;;sDAExE,oNAAC;;8DACC,oNAAC;oDAAG,WAAU;8DAAmB;;;;;;8DACjC,oNAAC;oDAAE,WAAU;8DACV,IAAI,KAAK,YAAY,SAAS,EAAE,cAAc;;;;;;;;;;;;sDAGnD,oNAAC;;8DACC,oNAAC;oDAAG,WAAU;8DAAmB;;;;;;8DACjC,oNAAC;oDAAE,WAAU;8DAAiC,YAAY,WAAW;;;;;;;;;;;;sDAEvE,oNAAC;;8DACC,oNAAC;oDAAG,WAAU;8DAAmB;;;;;;8DACjC,oNAAC,oKAAK;oDAAC,WAAW,aAAa,YAAY,UAAU;8DAClD,YAAY,UAAU,IAAI;;;;;;;;;;;;sDAG/B,oNAAC;;8DACC,oNAAC;oDAAG,WAAU;8DAAmB;;;;;;8DACjC,oNAAC;oDAAE,WAAU;8DAAiC,YAAY,MAAM;;;;;;;;;;;;sDAElE,oNAAC;;8DACC,oNAAC;oDAAG,WAAU;8DAAmB;;;;;;8DACjC,oNAAC,oKAAK;oDAAC,WAAW,aAAa,YAAY,UAAU;8DAClD,YAAY,UAAU,IAAI;;;;;;;;;;;;sDAG/B,oNAAC;;8DACC,oNAAC;oDAAG,WAAU;8DAAmB;;;;;;8DACjC,oNAAC;oDAAE,WAAU;8DAAiC,YAAY,UAAU,IAAI;;;;;;;;;;;;sDAE1E,oNAAC;;8DACC,oNAAC;oDAAG,WAAU;8DAAmB;;;;;;8DACjC,oNAAC;oDAAE,WAAU;;wDACV,YAAY,WAAW;wDAAC;wDAAG,YAAY,SAAS,IAAI;wDAAM;;;;;;;;;;;;;;;;;;;8CAKjE,oNAAC;;sDACC,oNAAC;4CAAG,WAAU;sDAAmB;;;;;;sDACjC,oNAAC;4CAAE,WAAU;sDAAiC,YAAY,OAAO;;;;;;;;;;;;gCAGlE,YAAY,UAAU,kBACrB,oNAAC;;sDACC,oNAAC;4CAAG,WAAU;sDAAmB;;;;;;sDACjC,oNAAC;4CAAE,WAAU;sDACV,YAAY,UAAU;;;;;;;;;;;;gCAK5B,YAAY,YAAY,kBACvB,oNAAC;;sDACC,oNAAC;4CAAG,WAAU;sDAAmB;;;;;;sDACjC,oNAAC;4CAAI,WAAU;sDACZ,KAAK,SAAS,CAAC,YAAY,YAAY,EAAE,MAAM;;;;;;;;;;;;gCAKrD,YAAY,WAAW,kBACtB,oNAAC;;sDACC,oNAAC;4CAAG,WAAU;sDAAmB;;;;;;sDACjC,oNAAC;4CAAI,WAAU;sDACZ,KAAK,SAAS,CAAC,YAAY,WAAW,EAAE,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUnE;GApNgB;KAAA"}},
    {"offset": {"line": 1293, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghilesmoussaoui/Desktop/Versotech/versotech-portal/src/components/audit/compliance-alerts.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { AlertTriangle } from 'lucide-react'\r\nimport { useRouter } from 'next/navigation'\r\n\r\ninterface ComplianceAlert {\r\n  id: string\r\n  audit_log_id: string | null\r\n  alert_type: string\r\n  severity: string\r\n  description: string | null\r\n  status: string\r\n  assigned_to: string | null\r\n  created_at: string\r\n}\r\n\r\nexport function ComplianceAlerts({ alerts }: { alerts: ComplianceAlert[] }) {\r\n  const router = useRouter()\r\n\r\n  const handleReview = async (alertId: string) => {\r\n    const response = await fetch(`/api/audit/compliance-alerts/${alertId}/review`, {\r\n      method: 'POST'\r\n    })\r\n    if (response.ok) {\r\n      router.refresh()\r\n    }\r\n  }\r\n\r\n  if (!alerts || alerts.length === 0) {\r\n    return (\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Compliance Alerts</CardTitle>\r\n          <CardDescription>Events requiring compliance review</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-center py-6 text-muted-foreground text-sm\">\r\n            No open compliance alerts\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle>Compliance Alerts</CardTitle>\r\n        <CardDescription>\r\n          {alerts.length} events requiring compliance review\r\n        </CardDescription>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"space-y-3\">\r\n          {alerts.slice(0, 5).map((alert) => (\r\n            <div\r\n              key={alert.id}\r\n              className={`flex items-center justify-between p-3 border rounded-lg ${\r\n                alert.severity === 'high' || alert.severity === 'critical'\r\n                  ? 'bg-red-950/20 border-red-800'\r\n                  : 'bg-yellow-950/20 border-yellow-800'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center gap-3 flex-1\">\r\n                <AlertTriangle\r\n                  className={`h-4 w-4 ${\r\n                    alert.severity === 'high' || alert.severity === 'critical'\r\n                      ? 'text-red-400'\r\n                      : 'text-yellow-400'\r\n                  }`}\r\n                />\r\n                <div className=\"flex-1\">\r\n                  <div className=\"font-medium text-foreground\">\r\n                    {alert.alert_type.replace(/_/g, ' ')}\r\n                  </div>\r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    {alert.description || 'No description'}\r\n                  </div>\r\n                  <div className=\"text-xs text-muted-foreground mt-1\">\r\n                    {new Date(alert.created_at).toLocaleString()}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <Button\r\n                size=\"sm\"\r\n                variant=\"outline\"\r\n                onClick={() => handleReview(alert.id)}\r\n              >\r\n                Review\r\n              </Button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAkBO,SAAS,iBAAiB,EAAE,MAAM,EAAiC;;IACxE,MAAM,SAAS,IAAA,yKAAS;IAExB,MAAM,eAAe,OAAO;QAC1B,MAAM,WAAW,MAAM,MAAM,CAAC,6BAA6B,EAAE,QAAQ,OAAO,CAAC,EAAE;YAC7E,QAAQ;QACV;QACA,IAAI,SAAS,EAAE,EAAE;YACf,OAAO,OAAO;QAChB;IACF;IAEA,IAAI,CAAC,UAAU,OAAO,MAAM,KAAK,GAAG;QAClC,qBACE,oNAAC,kKAAI;;8BACH,oNAAC,wKAAU;;sCACT,oNAAC,uKAAS;sCAAC;;;;;;sCACX,oNAAC,6KAAe;sCAAC;;;;;;;;;;;;8BAEnB,oNAAC,yKAAW;8BACV,cAAA,oNAAC;wBAAI,WAAU;kCAAiD;;;;;;;;;;;;;;;;;IAMxE;IAEA,qBACE,oNAAC,kKAAI;;0BACH,oNAAC,wKAAU;;kCACT,oNAAC,uKAAS;kCAAC;;;;;;kCACX,oNAAC,6KAAe;;4BACb,OAAO,MAAM;4BAAC;;;;;;;;;;;;;0BAGnB,oNAAC,yKAAW;0BACV,cAAA,oNAAC;oBAAI,WAAU;8BACZ,OAAO,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,sBACvB,oNAAC;4BAEC,WAAW,CAAC,wDAAwD,EAClE,MAAM,QAAQ,KAAK,UAAU,MAAM,QAAQ,KAAK,aAC5C,iCACA,sCACJ;;8CAEF,oNAAC;oCAAI,WAAU;;sDACb,oNAAC,mQAAa;4CACZ,WAAW,CAAC,QAAQ,EAClB,MAAM,QAAQ,KAAK,UAAU,MAAM,QAAQ,KAAK,aAC5C,iBACA,mBACJ;;;;;;sDAEJ,oNAAC;4CAAI,WAAU;;8DACb,oNAAC;oDAAI,WAAU;8DACZ,MAAM,UAAU,CAAC,OAAO,CAAC,MAAM;;;;;;8DAElC,oNAAC;oDAAI,WAAU;8DACZ,MAAM,WAAW,IAAI;;;;;;8DAExB,oNAAC;oDAAI,WAAU;8DACZ,IAAI,KAAK,MAAM,UAAU,EAAE,cAAc;;;;;;;;;;;;;;;;;;8CAIhD,oNAAC,sKAAM;oCACL,MAAK;oCACL,SAAQ;oCACR,SAAS,IAAM,aAAa,MAAM,EAAE;8CACrC;;;;;;;2BA/BI,MAAM,EAAE;;;;;;;;;;;;;;;;;;;;;AAwC3B;GAhFgB;;QACC,yKAAS;;;KADV"}}]
}