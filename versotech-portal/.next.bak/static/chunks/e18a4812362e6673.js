(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,344904,e=>{"use strict";var a=e.i(722679),t=e.i(340915),i=e.i(90613),n=e.i(316264),l=e.i(191569),r=e.i(129432),s=e.i(237635),o=e.i(510166),d=e.i(538892),c=e.i(401148),m=e.i(263229),u=e.i(750809),p=e.i(849110),x=e.i(496383),g=e.i(773510),v=e.i(335994),h=e.i(501259),y=e.i(691974),j=e.i(971743),_=e.i(201495),f=e.i(59531),f=f,b=e.i(382021),N=e.i(262823),C=e.i(15098),w=e.i(645855),S=e.i(745083),z=e.i(761722),I=e.i(831833),T=e.i(760165),P=e.i(341695),L=e.i(352776),E=e.i(514133),A=e.i(816654),F=e.i(45778),B=e.i(540318),k=e.i(396132),D=e.i(994500);let M={investor:{label:"Investor",description:"Individual or institutional investor entity",icon:h.Users,apiPath:"/api/staff/investors",detailPath:"/versotech_main/investors",color:"bg-blue-500/10 text-blue-500 border-blue-500/20"},introducer:{label:"Introducer",description:"Commission-based deal referral partner",icon:y.Briefcase,apiPath:"/api/staff/introducers",detailPath:"/versotech_main/introducers",color:"bg-purple-500/10 text-purple-500 border-purple-500/20"},lawyer:{label:"Law Firm",description:"Legal counsel for deals and documentation",icon:_.Scale,apiPath:"/api/admin/lawyers",detailPath:"/versotech_main/lawyers",color:"bg-amber-500/10 text-amber-500 border-amber-500/20"},partner:{label:"Partner",description:"Co-investment or syndicate partner",icon:B.Handshake,apiPath:"/api/admin/partners",detailPath:"/versotech_main/partners",color:"bg-green-500/10 text-green-500 border-green-500/20"},commercial_partner:{label:"Commercial Partner",description:"Banks, custodians, and service providers",icon:j.Building2,apiPath:"/api/admin/commercial-partners",detailPath:"/versotech_main/commercial-partners",color:"bg-cyan-500/10 text-cyan-500 border-cyan-500/20"},arranger:{label:"Arranger",description:"Licensed deal arranger entity",icon:j.Building2,apiPath:"/api/admin/arrangers",detailPath:"/versotech_main/arrangers",color:"bg-rose-500/10 text-rose-500 border-rose-500/20"}},R=P.z.object({type:P.z.enum(["individual","institutional","entity","family_office","fund"]),first_name:P.z.string().optional(),middle_name:P.z.string().optional(),last_name:P.z.string().optional(),legal_name:P.z.string().optional(),display_name:P.z.string().optional(),country_of_incorporation:P.z.string().optional(),representative_name:P.z.string().optional(),representative_title:P.z.string().optional(),email:P.z.string().email().optional().or(P.z.literal("")),phone:P.z.string().optional(),country:P.z.string().optional()}).refine(e=>"individual"===e.type?e.first_name&&e.first_name.trim().length>0:e.legal_name&&e.legal_name.trim().length>0,{message:"First name is required for individuals, Legal name is required for entities",path:["legal_name"]}),U=P.z.object({type:P.z.enum(["individual","entity"]),first_name:P.z.string().optional(),middle_name:P.z.string().optional(),last_name:P.z.string().optional(),legal_name:P.z.string().optional(),display_name:P.z.string().optional(),country_of_incorporation:P.z.string().optional(),email:P.z.string().email().optional().or(P.z.literal("")),country:P.z.string().optional(),default_commission_bps:P.z.coerce.number().min(0).max(300).optional(),payment_terms:P.z.enum(["net_15","net_30","net_45","net_60"]).optional(),status:P.z.enum(["active","inactive","suspended"]).default("active"),notes:P.z.string().optional()}).refine(e=>"individual"===e.type?e.first_name&&e.first_name.trim().length>0:e.legal_name&&e.legal_name.trim().length>0,{message:"First name is required for individuals, Legal name is required for entities",path:["legal_name"]}),O=P.z.object({type:P.z.enum(["individual","entity"]),first_name:P.z.string().optional(),middle_name:P.z.string().optional(),last_name:P.z.string().optional(),firm_name:P.z.string().optional(),display_name:P.z.string().optional(),primary_contact_name:P.z.string().optional(),primary_contact_email:P.z.string().email().optional().or(P.z.literal("")),primary_contact_phone:P.z.string().optional(),email:P.z.string().email().optional().or(P.z.literal("")),country:P.z.string().optional()}).refine(e=>"individual"===e.type?e.first_name&&e.first_name.trim().length>0:e.firm_name&&e.firm_name.trim().length>=2,{message:"First name is required for individuals, Firm name is required for law firms",path:["firm_name"]}),$=P.z.object({type:P.z.enum(["entity","individual","institutional"]),first_name:P.z.string().optional(),middle_name:P.z.string().optional(),last_name:P.z.string().optional(),name:P.z.string().optional(),legal_name:P.z.string().optional(),partner_type:P.z.enum(["co_investor","syndicate","strategic","institutional","other"]),status:P.z.enum(["active","inactive","suspended"]).default("active"),contact_name:P.z.string().optional(),contact_email:P.z.string().email().optional().or(P.z.literal("")),email:P.z.string().email().optional().or(P.z.literal("")),country:P.z.string().optional()}).refine(e=>"individual"===e.type?e.first_name&&e.first_name.trim().length>0:e.name&&e.name.trim().length>=2,{message:"First name is required for individuals, Name is required for entities",path:["name"]}),q=P.z.object({type:P.z.enum(["entity","individual","institutional"]),first_name:P.z.string().optional(),middle_name:P.z.string().optional(),last_name:P.z.string().optional(),name:P.z.string().optional(),legal_name:P.z.string().optional(),cp_type:P.z.enum(["placement_agent","distributor","wealth_manager","family_office","bank","other"]),status:P.z.enum(["active","inactive","suspended"]).default("active"),contact_name:P.z.string().optional(),contact_email:P.z.string().email().optional().or(P.z.literal("")),email:P.z.string().email().optional().or(P.z.literal("")),country:P.z.string().optional()}).refine(e=>"individual"===e.type?e.first_name&&e.first_name.trim().length>0:e.name&&e.name.trim().length>=2,{message:"First name is required for individuals, Name is required for entities",path:["name"]}),H=P.z.object({type:P.z.enum(["entity","individual"]),first_name:P.z.string().optional(),middle_name:P.z.string().optional(),last_name:P.z.string().optional(),legal_name:P.z.string().optional(),registration_number:P.z.string().optional(),email:P.z.string().email().optional().or(P.z.literal("")),phone:P.z.string().optional(),regulator:P.z.string().optional(),license_number:P.z.string().optional(),status:P.z.enum(["active","inactive"]).default("active")}).refine(e=>"individual"===e.type?e.first_name&&e.first_name.trim().length>0:e.legal_name&&e.legal_name.trim().length>0,{message:"First name is required for individuals, Legal name is required for entities",path:["legal_name"]}),J=P.z.object({email:P.z.string().email("Valid email required"),display_name:P.z.string().min(2,"Display name required"),title:P.z.string().optional()});function V({open:e,onOpenChange:s,onSuccess:o}){let[c,u]=(0,t.useState)("type"),[p,x]=(0,t.useState)(null),[g,h]=(0,t.useTransition)(),[y,j]=(0,t.useState)(!1),[_,f]=(0,t.useState)({}),[b,N]=(0,t.useState)({email:"",display_name:"",title:""}),[C,w]=(0,t.useState)({}),S=e=>{e||(u("type"),x(null),f({}),N({email:"",display_name:"",title:""}),j(!1),w({})),s(e)},z=(e,a)=>{f(t=>({...t,[e]:a})),C[e]&&w(a=>{let t={...a};return delete t[e],t})},I=(e,t,i="text",n,r)=>(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)(E.Label,{htmlFor:e,className:"text-sm",children:[t,C[e]&&(0,a.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),"select"===i&&n?(0,a.jsxs)(d.Select,{value:"string"==typeof _[e]?_[e]:"",onValueChange:a=>z(e,a),children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:r||`Select ${t.toLowerCase()}`})}),(0,a.jsx)(d.SelectContent,{children:n.map(e=>(0,a.jsx)(d.SelectItem,{value:e.value,children:e.label},e.value))})]}):"textarea"===i?(0,a.jsx)(A.Textarea,{id:e,value:"string"==typeof _[e]?_[e]:"",onChange:a=>z(e,a.target.value),placeholder:r,className:"resize-none",rows:3}):(0,a.jsx)(l.Input,{id:e,type:i,value:"string"==typeof _[e]||"number"==typeof _[e]?_[e]:"",onChange:a=>z(e,"number"===i?parseFloat(a.target.value)||"":a.target.value),placeholder:r}),C[e]&&(0,a.jsx)("p",{className:"text-xs text-destructive",children:C[e]})]},e);return(0,a.jsx)(L.Dialog,{open:e,onOpenChange:S,children:(0,a.jsxs)(L.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(L.DialogHeader,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["details"===c&&p&&(0,a.jsx)(n.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>u("type"),children:(0,a.jsx)(k.ArrowLeft,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(L.DialogTitle,{children:"type"===c?"Add Account":`New ${p?M[p].label:""}`}),(0,a.jsx)(L.DialogDescription,{children:"type"===c?"Select the type of account you want to create":`Enter the details for the new ${p?M[p].label.toLowerCase():"account"}`})]})]}),"details"===c&&p&&(0,a.jsx)(r.Badge,{variant:"outline",className:`w-fit ${M[p].color}`,children:M[p].label})]}),"type"===c?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(M).map(([e,t])=>{let n=t.icon;return(0,a.jsx)(i.Card,{className:`cursor-pointer transition-all hover:border-primary/50 hover:shadow-md ${p===e?"border-primary ring-2 ring-primary/20":""}`,onClick:()=>(x(e),u("details"),void f({investor:{type:"individual",first_name:"",middle_name:"",last_name:"",legal_name:"",display_name:"",country_of_incorporation:"",representative_name:"",representative_title:"",email:"",phone:"",country:""},introducer:{type:"individual",first_name:"",middle_name:"",last_name:"",legal_name:"",display_name:"",country_of_incorporation:"",status:"active",payment_terms:"net_30",email:"",country:"",default_commission_bps:"",notes:""},lawyer:{type:"individual",first_name:"",middle_name:"",last_name:"",firm_name:"",display_name:"",email:"",country:"",primary_contact_name:"",primary_contact_email:"",primary_contact_phone:""},partner:{type:"individual",first_name:"",middle_name:"",last_name:"",name:"",legal_name:"",partner_type:"co_investor",status:"active",email:"",contact_email:"",contact_name:"",contact_phone:"",country:""},commercial_partner:{type:"individual",first_name:"",middle_name:"",last_name:"",name:"",legal_name:"",cp_type:"bank",status:"active",email:"",contact_email:"",contact_name:"",contact_phone:"",country:""},arranger:{type:"entity",first_name:"",middle_name:"",last_name:"",legal_name:"",status:"active",email:"",phone:"",registration_number:"",license_number:"",regulator:""}}[e]||{})),children:(0,a.jsx)(i.CardContent,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:`p-2 rounded-lg ${t.color}`,children:(0,a.jsx)(n,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:t.label}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:t.description})]})]})})},e)})}):(0,a.jsxs)("div",{className:"space-y-4",children:[p?({investor:(0,a.jsxs)("div",{className:"space-y-4",children:[I("type","Investor Type","select",[{value:"individual",label:"Individual"},{value:"entity",label:"Entity"},{value:"institutional",label:"Institutional"},{value:"family_office",label:"Family Office"},{value:"fund",label:"Fund"}]),"individual"===_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("first_name","First Name *","text",void 0,"John"),I("middle_name","Middle Name","text",void 0,"Michael")]}),I("last_name","Last Name","text",void 0,"Smith")]}),"individual"!==_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Entity Information"}),I("legal_name","Legal Name *","text",void 0,"Acme Investment Holdings LP"),I("display_name","Display Name","text",void 0,"Optional short name"),I("country_of_incorporation","Country of Incorporation","text",void 0,"Cayman Islands"),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("representative_name","Representative Name","text",void 0,"Jane Doe"),I("representative_title","Representative Title","text",void 0,"Managing Director")]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("email","Email","email",void 0,"investor@example.com"),I("phone","Phone","text",void 0,"+1 (555) 123-4567")]}),I("country","individual"===_.type?"Country of Residence":"Country","text",void 0,"United States")]}),introducer:(0,a.jsxs)("div",{className:"space-y-4",children:[I("type","Introducer Type","select",[{value:"individual",label:"Individual"},{value:"entity",label:"Entity"}]),"individual"===_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("first_name","First Name *","text",void 0,"John"),I("middle_name","Middle Name","text",void 0,"Michael")]}),I("last_name","Last Name","text",void 0,"Smith")]}),"individual"!==_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Entity Information"}),I("legal_name","Legal Name *","text",void 0,"ABC Advisors Ltd"),I("display_name","Display Name","text",void 0,"Optional short name"),I("country_of_incorporation","Country of Incorporation","text",void 0,"United Kingdom")]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("email","Email","email",void 0,"contact@company.com"),I("country","individual"===_.type?"Country of Residence":"Country","text",void 0,"United States")]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("default_commission_bps","Commission (bps)","number",void 0,"0-300"),I("payment_terms","Payment Terms","select",[{value:"net_15",label:"Net 15"},{value:"net_30",label:"Net 30"},{value:"net_45",label:"Net 45"},{value:"net_60",label:"Net 60"}])]}),I("status","Status","select",[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"suspended",label:"Suspended"}])]}),lawyer:(0,a.jsxs)("div",{className:"space-y-4",children:[I("type","Lawyer Type","select",[{value:"individual",label:"Individual Lawyer"},{value:"entity",label:"Law Firm"}]),"individual"===_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("first_name","First Name *","text",void 0,"Jane"),I("middle_name","Middle Name","text",void 0,"Marie")]}),I("last_name","Last Name","text",void 0,"Smith"),I("display_name","Display Name","text",void 0,"Jane Smith, Esq.")]}),"individual"!==_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Firm Information"}),I("firm_name","Firm Name *","text",void 0,"Smith & Associates LLP"),I("display_name","Display Name","text",void 0,"Smith & Associates"),I("primary_contact_name","Primary Contact","text",void 0,"Jane Smith"),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("primary_contact_email","Contact Email","email",void 0,"jane@firm.com"),I("primary_contact_phone","Contact Phone","text",void 0,"+1 (555) 123-4567")]})]}),"individual"===_.type?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("email","Email","email",void 0,"lawyer@firm.com"),I("country","Country of Residence","text",void 0,"United States")]}):I("country","Country","text",void 0,"United States")]}),partner:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("type","Partner Type","select",[{value:"individual",label:"Individual"},{value:"entity",label:"Entity"},{value:"institutional",label:"Institutional"}]),I("partner_type","Partner Category","select",[{value:"co_investor",label:"Co-Investor"},{value:"syndicate",label:"Syndicate"},{value:"strategic",label:"Strategic"},{value:"institutional",label:"Institutional"},{value:"other",label:"Other"}])]}),"individual"===_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("first_name","First Name *","text",void 0,"John"),I("middle_name","Middle Name","text",void 0,"Michael")]}),I("last_name","Last Name","text",void 0,"Smith")]}),"individual"!==_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Entity Information"}),I("name","Partner Name *","text",void 0,"Partner Capital LLC"),I("legal_name","Legal Name","text",void 0,"Full legal entity name"),I("contact_name","Contact Name","text",void 0,"John Smith"),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("contact_email","Contact Email","email",void 0,"john@partner.com"),I("contact_phone","Contact Phone","text",void 0,"+1 (555) 123-4567")]})]}),"individual"===_.type?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("email","Email","email",void 0,"john@example.com"),I("country","Country of Residence","text",void 0,"United States")]}):I("country","Country","text",void 0,"United States"),I("status","Status","select",[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"suspended",label:"Suspended"}])]}),commercial_partner:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("type","Partner Type","select",[{value:"individual",label:"Individual"},{value:"entity",label:"Entity"},{value:"institutional",label:"Institutional"}]),I("cp_type","Service Type","select",[{value:"placement_agent",label:"Placement Agent"},{value:"distributor",label:"Distributor"},{value:"wealth_manager",label:"Wealth Manager"},{value:"family_office",label:"Family Office"},{value:"bank",label:"Bank"},{value:"other",label:"Other"}])]}),"individual"===_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("first_name","First Name *","text",void 0,"Jane"),I("middle_name","Middle Name","text",void 0,"Marie")]}),I("last_name","Last Name","text",void 0,"Smith")]}),"individual"!==_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Entity Information"}),I("name","Partner Name *","text",void 0,"First National Bank"),I("legal_name","Legal Name","text",void 0,"Full legal entity name"),I("contact_name","Contact Name","text",void 0,"Jane Smith"),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("contact_email","Contact Email","email",void 0,"jane@bank.com"),I("contact_phone","Contact Phone","text",void 0,"+1 (555) 123-4567")]})]}),"individual"===_.type?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("email","Email","email",void 0,"jane@example.com"),I("country","Country of Residence","text",void 0,"United States")]}):I("country","Country","text",void 0,"United States"),I("status","Status","select",[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"suspended",label:"Suspended"}])]}),arranger:(0,a.jsxs)("div",{className:"space-y-4",children:[I("type","Arranger Type","select",[{value:"entity",label:"Entity (Default)"},{value:"individual",label:"Individual"}]),"individual"===_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("first_name","First Name *","text",void 0,"John"),I("middle_name","Middle Name","text",void 0,"Michael")]}),I("last_name","Last Name","text",void 0,"Smith")]}),"individual"!==_.type&&(0,a.jsxs)("div",{className:"space-y-4 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Entity Information"}),I("legal_name","Legal Name *","text",void 0,"VERSO Arranger Ltd")]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("registration_number","Registration Number","text",void 0,"Company reg #"),I("license_number","License Number","text",void 0,"License #")]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I("email","Email","email",void 0,"contact@arranger.com"),I("phone","Phone","text",void 0,"+1 (555) 123-4567")]}),I("regulator","Regulator","text",void 0,"BVI FSC"),I("status","Status","select",[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}])]})})[p]:null,(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.UserPlus,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)(E.Label,{className:"text-sm font-medium",children:"Invite User"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Send a magic link invitation to create an account"})]}),(0,a.jsx)(F.Switch,{checked:y,onCheckedChange:j})]}),y&&(0,a.jsxs)("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)(E.Label,{htmlFor:"invite_email",className:"text-sm",children:["Email Address",C.invite_email&&(0,a.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(0,a.jsx)(l.Input,{id:"invite_email",type:"email",value:b.email,onChange:e=>N(a=>({...a,email:e.target.value})),placeholder:"user@example.com"}),C.invite_email&&(0,a.jsx)("p",{className:"text-xs text-destructive",children:C.invite_email})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)(E.Label,{htmlFor:"invite_display_name",className:"text-sm",children:["Display Name",C.invite_display_name&&(0,a.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(0,a.jsx)(l.Input,{id:"invite_display_name",value:b.display_name,onChange:e=>N(a=>({...a,display_name:e.target.value})),placeholder:"John Smith"}),C.invite_display_name&&(0,a.jsx)("p",{className:"text-xs text-destructive",children:C.invite_display_name})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)(E.Label,{htmlFor:"invite_title",className:"text-sm",children:"Title (Optional)"}),(0,a.jsx)(l.Input,{id:"invite_title",value:b.title,onChange:e=>N(a=>({...a,title:e.target.value})),placeholder:"Director, Partner, etc."})]})]})]})]}),(0,a.jsxs)(L.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,a.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>S(!1),disabled:g,children:"Cancel"}),"details"===c&&(0,a.jsxs)(n.Button,{type:"button",onClick:()=>{p&&h(async()=>{try{let e=({investor:R,introducer:U,lawyer:O,partner:$,commercial_partner:q,arranger:H})[p].safeParse(_);if(!e.success){let a={};e.error.issues.forEach(e=>{a[e.path.join(".")]=e.message}),w(a),D.toast.error("Please fix the form errors");return}if(y){let e=J.safeParse(b);if(!e.success){let a={};e.error.issues.forEach(e=>{a[`invite_${e.path.join(".")}`]=e.message}),w(e=>({...e,...a})),D.toast.error("Please fix the user invite errors");return}}w({});let a={...e.data};if("individual"===_.type){let e=[_.first_name?.trim(),_.middle_name?.trim(),_.last_name?.trim()].filter(Boolean).join(" ");a={...a,first_name:_.first_name?.trim()||"",middle_name:_.middle_name?.trim()||"",last_name:_.last_name?.trim()||""},"investor"===p||"introducer"===p||"arranger"===p?(a.legal_name=e,a.display_name=a.display_name||e):"partner"===p||"commercial_partner"===p?(a.name=e,a.legal_name=e):"lawyer"===p&&(a.firm_name=e,a.display_name=a.display_name||e)}"lawyer"===p&&"individual"!==a.type&&a.primary_contact_email&&(a.email=a.primary_contact_email),"commercial_partner"===p&&"individual"!==a.type&&a.contact_email&&(a.email=a.contact_email),"partner"===p&&"individual"!==a.type&&a.contact_email&&(a.email=a.contact_email);let t=M[p],i=await fetch(t.apiPath,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||`Failed to create ${t.label.toLowerCase()}`)}let n=await i.json(),l=n.id||n.investor?.id||n.introducer?.id||n.arranger?.id||(Array.isArray(n.data)?n.data[0]?.id:n.data?.id);if(y&&l){let e=await fetch("/api/admin/entity-invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_type:{investor:"investor",introducer:"introducer",lawyer:"lawyer",partner:"partner",commercial_partner:"commercial_partner",arranger:"arranger"}[p],entity_id:l,email:b.email,display_name:b.display_name,title:b.title||null,is_primary:!0})}),a=await e.json().catch(()=>({}));e.ok?!1===a.email_sent?D.toast.warning(`${t.label} created, but invitation email failed to send`):D.toast.success(a.message||`${t.label} created and invitation sent!`):(console.warn("Failed to send invitation, but entity was created"),D.toast.warning(a.error||`${t.label} created, but invitation failed to send`))}else D.toast.success(`${t.label} created successfully!`);S(!1),o?.(),l&&(window.location.href=`${t.detailPath}/${l}`)}catch(e){console.error("Create entity error:",e),D.toast.error(e instanceof Error?e.message:"Failed to create account")}})},disabled:g,children:[g&&(0,a.jsx)(m.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),y?"Create & Invite":"Create Account"]})]})]})})}let K={investor:{label:"Investor",icon:h.Users,color:"bg-blue-500/20 text-blue-400 border-blue-500/30"},lawyer:{label:"Lawyer",icon:_.Scale,color:"bg-purple-500/20 text-purple-400 border-purple-500/30"},partner:{label:"Partner",icon:f.default,color:"bg-green-500/20 text-green-400 border-green-500/30"},commercial_partner:{label:"Commercial Partner",icon:j.Building2,color:"bg-orange-500/20 text-orange-400 border-orange-500/30"},introducer:{label:"Introducer",icon:y.Briefcase,color:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30"},arranger:{label:"Arranger",icon:j.Building2,color:"bg-amber-500/20 text-amber-400 border-amber-500/30"}};function Y(){let[e,h]=(0,t.useState)([]),[y,_]=(0,t.useState)(null),[f,P]=(0,t.useState)(!0),[L,E]=(0,t.useState)(null),[A,F]=(0,t.useState)(""),[B,k]=(0,t.useState)("all"),[D,M]=(0,t.useState)("all"),[R,U]=(0,t.useState)(!1),[O,$]=(0,t.useState)(!1),q=async()=>{try{P(!0),E(null);let e=await fetch("/api/admin/unified-users"),a=await e.json();if(!a.success)throw Error(a.error||"Failed to fetch accounts");h(a.data||[]),_(a.stats||null)}catch(e){console.error("[UnifiedAccountsContent] Error:",e),E(e?.message||"Failed to load accounts")}finally{P(!1)}};(0,t.useEffect)(()=>{q()},[]);let H=(0,t.useMemo)(()=>e.filter(e=>{if(A){let a=A.toLowerCase();if(!(e.entityName.toLowerCase().includes(a)||e.userName.toLowerCase().includes(a)||e.userEmail.toLowerCase().includes(a)||e.country?.toLowerCase().includes(a)))return!1}return("all"===B||e.entityType===B)&&("all"===D||e.status===D)}),[e,A,B,D]);return f?(0,a.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,a.jsx)(m.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,a.jsx)("span",{className:"ml-3 text-muted-foreground",children:"Loading all accounts..."})]}):L?(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)(c.AlertCircle,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Error Loading Accounts"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:L}),(0,a.jsxs)(n.Button,{onClick:q,variant:"outline",children:[(0,a.jsx)(N.RefreshCw,{className:"mr-2 h-4 w-4"}),"Try Again"]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-foreground",children:y?.total||0}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Total"})]})}),(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-400",children:y?.active||0}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Active"})]})}),(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:y?.investors||0}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Investors"})]})}),(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:y?.lawyers||0}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Lawyers"})]})}),(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-500",children:y?.partners||0}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Partners"})]})}),(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-400",children:y?.commercialPartners||0}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Commercial"})]})}),(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-cyan-400",children:y?.introducers||0}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Introducers"})]})}),(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-amber-400",children:y?.arrangers||0}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Arrangers"})]})})]}),(0,a.jsx)(i.Card,{children:(0,a.jsx)(i.CardContent,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(u.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(l.Input,{placeholder:"Search by name, email, or country...",value:A,onChange:e=>F(e.target.value),className:"pl-10"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(d.Select,{value:B,onValueChange:k,children:[(0,a.jsxs)(d.SelectTrigger,{className:"w-[180px]",children:[(0,a.jsx)(b.Filter,{className:"h-4 w-4 mr-2"}),(0,a.jsx)(d.SelectValue,{placeholder:"All Types"})]}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"all",children:"All Types"}),(0,a.jsx)(d.SelectItem,{value:"investor",children:"Investors"}),(0,a.jsx)(d.SelectItem,{value:"lawyer",children:"Lawyers"}),(0,a.jsx)(d.SelectItem,{value:"partner",children:"Partners"}),(0,a.jsx)(d.SelectItem,{value:"commercial_partner",children:"Commercial Partners"}),(0,a.jsx)(d.SelectItem,{value:"introducer",children:"Introducers"}),(0,a.jsx)(d.SelectItem,{value:"arranger",children:"Arrangers"})]})]}),(0,a.jsxs)(d.Select,{value:D,onValueChange:M,children:[(0,a.jsx)(d.SelectTrigger,{className:"w-[140px]",children:(0,a.jsx)(d.SelectValue,{placeholder:"All Status"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"all",children:"All Status"}),(0,a.jsx)(d.SelectItem,{value:"active",children:"Active"}),(0,a.jsx)(d.SelectItem,{value:"inactive",children:"Inactive"}),(0,a.jsx)(d.SelectItem,{value:"pending",children:"Pending"})]})]}),(0,a.jsxs)(n.Button,{variant:"outline",onClick:()=>{let e=new Blob([[["Entity Type","Entity Name","User Name","Email","Role","Status","KYC Status","Country","Created"],...H.map(e=>[K[e.entityType].label,e.entityName,e.userName,e.userEmail,e.userRole,e.status,e.kycStatus||"-",e.country||"-",new Date(e.createdAt).toLocaleDateString()])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n")],{type:"text/csv"}),a=window.URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download=`all-accounts-${new Date().toISOString().split("T")[0]}.csv`,t.click(),window.URL.revokeObjectURL(a)},children:[(0,a.jsx)(z.Download,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,a.jsxs)(n.Button,{onClick:()=>$(!0),children:[(0,a.jsx)(I.Plus,{className:"h-4 w-4 mr-2"}),"Add Account"]}),(0,a.jsxs)(n.Button,{variant:"outline",onClick:()=>U(!0),children:[(0,a.jsx)(v.UserPlus,{className:"h-4 w-4 mr-2"}),"Batch Invite"]}),(0,a.jsx)(n.Button,{variant:"outline",onClick:q,children:(0,a.jsx)(N.RefreshCw,{className:"h-4 w-4"})})]})]})})}),(0,a.jsxs)(i.Card,{children:[(0,a.jsxs)(i.CardHeader,{children:[(0,a.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Building2,{className:"h-5 w-5"}),"All Accounts (",H.length,")"]}),(0,a.jsx)(i.CardDescription,{children:"Business entities linked to investments, subscriptions, and deals"})]}),(0,a.jsx)(i.CardContent,{children:(0,a.jsxs)(s.Table,{children:[(0,a.jsx)(s.TableHeader,{children:(0,a.jsxs)(s.TableRow,{children:[(0,a.jsx)(s.TableHead,{children:"Type"}),(0,a.jsx)(s.TableHead,{children:"Entity Name"}),(0,a.jsx)(s.TableHead,{children:"User"}),(0,a.jsx)(s.TableHead,{children:"Email"}),(0,a.jsx)(s.TableHead,{children:"Role"}),(0,a.jsx)(s.TableHead,{children:"Country"}),(0,a.jsx)(s.TableHead,{children:"KYC"}),(0,a.jsx)(s.TableHead,{children:"Status"}),(0,a.jsx)(s.TableHead,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(s.TableBody,{children:0===H.length?(0,a.jsx)(s.TableRow,{children:(0,a.jsx)(s.TableCell,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No accounts found"})}):H.map(e=>{let t=K[e.entityType],i=t.icon;return(0,a.jsxs)(s.TableRow,{children:[(0,a.jsx)(s.TableCell,{children:(0,a.jsxs)(r.Badge,{variant:"outline",className:t.color,children:[(0,a.jsx)(i,{className:"h-3 w-3 mr-1"}),t.label]})}),(0,a.jsx)(s.TableCell,{children:(0,a.jsx)("div",{className:"font-medium text-foreground",children:e.entityName})}),(0,a.jsx)(s.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"No users assigned"===e.userName?"text-muted-foreground italic":"",children:e.userName}),e.isPrimary&&(0,a.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:"Primary"})]})}),(0,a.jsx)(s.TableCell,{children:(0,a.jsx)("span",{className:"-"===e.userEmail?"text-muted-foreground":"",children:e.userEmail})}),(0,a.jsx)(s.TableCell,{children:(0,a.jsx)("span",{className:"capitalize text-sm",children:e.userRole})}),(0,a.jsx)(s.TableCell,{children:(0,a.jsx)("span",{className:e.country?"":"text-muted-foreground",children:e.country||"-"})}),(0,a.jsx)(s.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[function(e){switch(e){case"approved":return(0,a.jsx)(C.CheckCircle2,{className:"h-4 w-4 text-green-400"});case"pending":case"review":return(0,a.jsx)(w.Clock,{className:"h-4 w-4 text-yellow-400"});case"rejected":return(0,a.jsx)(S.XCircle,{className:"h-4 w-4 text-red-400"});default:return(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})}}(e.kycStatus),e.kycStatus&&(0,a.jsx)("span",{className:"text-xs capitalize",children:e.kycStatus})]})}),(0,a.jsx)(s.TableCell,{children:function(e){switch(e){case"active":return(0,a.jsx)(r.Badge,{className:"bg-green-500/20 text-green-400 border-green-500/30",children:"Active"});case"inactive":return(0,a.jsx)(r.Badge,{className:"bg-red-500/20 text-red-400 border-red-500/30",children:"Inactive"});default:return(0,a.jsx)(r.Badge,{className:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",children:"Pending"})}}(e.status)}),(0,a.jsx)(s.TableCell,{className:"text-right",children:(0,a.jsxs)(o.DropdownMenu,{children:[(0,a.jsx)(o.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(n.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(p.MoreHorizontal,{className:"h-4 w-4"})})}),(0,a.jsxs)(o.DropdownMenuContent,{align:"end",children:[(0,a.jsx)(o.DropdownMenuLabel,{children:"Actions"}),(0,a.jsx)(o.DropdownMenuSeparator,{}),(0,a.jsxs)(o.DropdownMenuItem,{onClick:()=>{window.location.href=`/versotech_main/${({investor:"investors",lawyer:"lawyers",partner:"partners",commercial_partner:"commercial-partners",introducer:"introducers",arranger:"arrangers"})[e.entityType]}/${e.entityId}`},children:[(0,a.jsx)(x.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.userEmail&&"-"!==e.userEmail&&(0,a.jsxs)(o.DropdownMenuItem,{onClick:()=>window.location.href=`mailto:${e.userEmail}`,children:[(0,a.jsx)(g.Mail,{className:"mr-2 h-4 w-4"}),"Send Email"]}),(0,a.jsxs)(o.DropdownMenuItem,{children:[(0,a.jsx)(v.UserPlus,{className:"mr-2 h-4 w-4"}),"Invite User"]})]})]})})]},e.id)})})]})})]}),(0,a.jsx)(V,{open:O,onOpenChange:$,onSuccess:q}),(0,a.jsx)(T.BatchInviteDialog,{open:R,onOpenChange:U,onSuccess:q})]})}e.s(["default",()=>Y],344904)},262383,e=>{e.n(e.i(344904))}]);