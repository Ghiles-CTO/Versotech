(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,196767,e=>{"use strict";let a=(0,e.i(410587).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>a],196767)},501495,e=>{"use strict";e.s(["formatBps",0,e=>null==e?"—":`${e} bps`,"formatCurrency",0,(e,a="USD")=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:a,maximumFractionDigits:0}).format(e):"$0","formatDate",0,e=>{if(!e)return"—";let a="string"==typeof e?new Date(e):e;return Number.isNaN(a?.getTime?.())?"—":a.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}])},45778,e=>{"use strict";var a=e.i(722679),t=e.i(340915),r=e.i(679472),s=e.i(886978),l=e.i(47264),i=e.i(68977),n=e.i(657180),d=e.i(460138),c=e.i(362208),o="Switch",[u,m]=(0,l.createContextScope)(o),[h,x]=u(o),g=t.forwardRef((e,l)=>{let{__scopeSwitch:n,name:d,checked:u,defaultChecked:m,required:x,disabled:g,value:p="on",onCheckedChange:v,form:b,...y}=e,[N,w]=t.useState(null),C=(0,s.useComposedRefs)(l,e=>w(e)),S=t.useRef(!1),k=!N||b||!!N.closest("form"),[D,A]=(0,i.useControllableState)({prop:u,defaultProp:m??!1,onChange:v,caller:o});return(0,a.jsxs)(h,{scope:n,checked:D,disabled:g,children:[(0,a.jsx)(c.Primitive.button,{type:"button",role:"switch","aria-checked":D,"aria-required":x,"data-state":f(D),"data-disabled":g?"":void 0,disabled:g,value:p,...y,ref:C,onClick:(0,r.composeEventHandlers)(e.onClick,e=>{A(e=>!e),k&&(S.current=e.isPropagationStopped(),S.current||e.stopPropagation())})}),k&&(0,a.jsx)(j,{control:N,bubbles:!S.current,name:d,value:p,checked:D,required:x,disabled:g,form:b,style:{transform:"translateX(-100%)"}})]})});g.displayName=o;var p="SwitchThumb",v=t.forwardRef((e,t)=>{let{__scopeSwitch:r,...s}=e,l=x(p,r);return(0,a.jsx)(c.Primitive.span,{"data-state":f(l.checked),"data-disabled":l.disabled?"":void 0,...s,ref:t})});v.displayName=p;var j=t.forwardRef(({__scopeSwitch:e,control:r,checked:l,bubbles:i=!0,...c},o)=>{let u=t.useRef(null),m=(0,s.useComposedRefs)(u,o),h=(0,n.usePrevious)(l),x=(0,d.useSize)(r);return t.useEffect(()=>{let e=u.current;if(!e)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(h!==l&&a){let t=new Event("click",{bubbles:i});a.call(e,l),e.dispatchEvent(t)}},[h,l,i]),(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:l,...c,tabIndex:-1,ref:m,style:{...c.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function f(e){return e?"checked":"unchecked"}j.displayName="SwitchBubbleInput";var b=e.i(282141);let y=t.forwardRef(({className:e,...t},r)=>(0,a.jsx)(g,{className:(0,b.cn)("peer inline-flex h-7 md:h-6 w-12 md:w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:(0,a.jsx)(v,{className:(0,b.cn)("pointer-events-none block h-6 w-6 md:h-5 md:w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));y.displayName=g.displayName,e.s(["Switch",()=>y],45778)},396064,e=>{"use strict";let a=(0,e.i(410587).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>a],396064)},554369,e=>{"use strict";let a=(0,e.i(410587).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],554369)},551544,e=>{"use strict";let a=(0,e.i(410587).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>a],551544)},816654,e=>{"use strict";var a=e.i(722679),t=e.i(340915),r=e.i(282141);let s=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));s.displayName="Textarea",e.s(["Textarea",()=>s])},761722,e=>{"use strict";let a=(0,e.i(410587).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>a],761722)},745083,e=>{"use strict";let a=(0,e.i(410587).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>a],745083)},335994,e=>{"use strict";let a=(0,e.i(410587).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>a],335994)},90613,e=>{"use strict";var a=e.i(722679),t=e.i(282141);function r({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function s({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function l({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...r})}function i({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...r})}function n({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...r})}function d({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,t.cn)("flex items-center px-6 [.border-t]:pt-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>n,"CardDescription",()=>i,"CardFooter",()=>d,"CardHeader",()=>s,"CardTitle",()=>l])},129432,e=>{"use strict";var a=e.i(722679),t=e.i(179232),r=e.i(414846),s=e.i(282141);let l=(0,r.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:r,asChild:i=!1,...n}){let d=i?t.Slot:"span";return(0,a.jsx)(d,{"data-slot":"badge",className:(0,s.cn)(l({variant:r}),e),...n})}e.s(["Badge",()=>i])},15098,e=>{"use strict";let a=(0,e.i(410587).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>a],15098)},773510,e=>{"use strict";let a=(0,e.i(410587).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>a],773510)},429482,e=>{"use strict";var a=e.i(722679),t=e.i(340915),r=e.i(795988),s=e.i(476817),l=e.i(341695),i=e.i(352776),n=e.i(316264),d=e.i(191569),c=e.i(514133),o=e.i(538892),u=e.i(45778),m=e.i(263229),h=e.i(773510),x=e.i(704477),g=e.i(691974),p=e.i(994500);let v=l.z.object({email:l.z.string().email("Please enter a valid email address"),display_name:l.z.string().min(2,"Display name must be at least 2 characters"),title:l.z.string().optional(),role:l.z.string(),is_primary:l.z.boolean(),is_signatory:l.z.boolean(),can_sign:l.z.boolean()}),j={investor:"Investor",arranger:"Arranger",lawyer:"Law Firm",introducer:"Introducer",partner:"Partner",commercial_partner:"Commercial Partner"},f={investor:[{value:"admin",label:"Admin"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}],arranger:[{value:"admin",label:"Admin"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}],lawyer:[{value:"admin",label:"Admin"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}],partner:[{value:"admin",label:"Admin"},{value:"member",label:"Member"},{value:"viewer",label:"Viewer"}],introducer:[{value:"admin",label:"Admin"},{value:"contact",label:"Contact"},{value:"payment_contact",label:"Payment Contact"},{value:"legal_contact",label:"Legal Contact"}],commercial_partner:[{value:"admin",label:"Admin"},{value:"contact",label:"Contact"},{value:"billing_contact",label:"Billing Contact"},{value:"technical_contact",label:"Technical Contact"}]},b={investor:"member",arranger:"member",lawyer:"member",partner:"member",introducer:"contact",commercial_partner:"contact"};function y({entityType:e,entityId:l,entityName:y,open:N,onOpenChange:w,onSuccess:C}){let[S,k]=(0,t.useState)(!1),D=f[e],A=b[e],{register:I,handleSubmit:F,reset:T,watch:_,setValue:L,formState:{errors:E}}=(0,r.useForm)({resolver:(0,s.zodResolver)(v),defaultValues:{email:"",display_name:"",title:"",role:A,is_primary:!1,is_signatory:!1,can_sign:!1}}),M=_("is_primary");_("is_signatory");let R=_("can_sign"),B=_("role"),P=async a=>{k(!0);try{let t=await fetch("/api/admin/entity-invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_type:e,entity_id:l,...a})}),r=await t.json();if(!t.ok)throw Error(r.error||"Failed to invite user");p.toast.success(r.message||`User invited to ${y}`),T(),w(!1),C?.()}catch(e){console.error("Invite error:",e),p.toast.error(e instanceof Error?e.message:"Failed to invite user")}finally{k(!1)}},U=()=>{T(),w(!1)};return(0,a.jsx)(i.Dialog,{open:N,onOpenChange:U,children:(0,a.jsxs)(i.DialogContent,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(i.DialogHeader,{children:[(0,a.jsxs)(i.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(h.Mail,{className:"h-5 w-5"}),"Invite User to ",j[e]]}),(0,a.jsxs)(i.DialogDescription,{children:["Send an invitation email to join ",(0,a.jsx)("span",{className:"font-medium",children:y}),". They will receive instructions to set up their account."]})]}),(0,a.jsxs)("form",{onSubmit:F(P),className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"email",children:"Email Address *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.Mail,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(d.Input,{id:"email",type:"email",placeholder:"user@example.com",className:"pl-10",...I("email")})]}),E.email&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:E.email.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"display_name",children:"Display Name *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.User,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(d.Input,{id:"display_name",placeholder:"John Smith",className:"pl-10",...I("display_name")})]}),E.display_name&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:E.display_name.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"title",children:"Title (Optional)"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Briefcase,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(d.Input,{id:"title",placeholder:"Managing Director",className:"pl-10",...I("title")})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"role",children:"Role"}),(0,a.jsxs)(o.Select,{value:B,onValueChange:e=>L("role",e),children:[(0,a.jsx)(o.SelectTrigger,{children:(0,a.jsx)(o.SelectValue,{placeholder:"Select role"})}),(0,a.jsx)(o.SelectContent,{children:D.map(e=>(0,a.jsx)(o.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(c.Label,{htmlFor:"is_primary",className:"text-sm font-medium",children:"Primary Contact"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Set as the main point of contact for this entity"})]}),(0,a.jsx)(u.Switch,{id:"is_primary",checked:M,onCheckedChange:e=>L("is_primary",e)})]}),"lawyer"===e&&(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(c.Label,{htmlFor:"can_sign",className:"text-sm font-medium",children:"Can Sign Documents"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Has authority to sign on behalf of the law firm"})]}),(0,a.jsx)(u.Switch,{id:"can_sign",checked:R,onCheckedChange:e=>L("can_sign",e)})]}),(0,a.jsxs)(i.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,a.jsx)(n.Button,{type:"button",variant:"outline",onClick:U,children:"Cancel"}),(0,a.jsx)(n.Button,{type:"submit",disabled:S,children:S?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending Invite..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Mail,{className:"mr-2 h-4 w-4"}),"Send Invitation"]})})]})]})]})})}e.s(["InviteUserDialog",()=>y])},768697,e=>{"use strict";var a=e.i(722679),t=e.i(340915),r=e.i(352776),s=e.i(316264),l=e.i(191569),i=e.i(514133),n=e.i(816654),d=e.i(538892),c=e.i(994500),o=e.i(603274);function u({open:e,onOpenChange:u,arranger:m}){let[h,x]=(0,t.useState)(""),[g,p]=(0,t.useState)(""),[v,j]=(0,t.useState)(""),[f,b]=(0,t.useState)(""),[y,N]=(0,t.useState)(""),[w,C]=(0,t.useState)(""),[S,k]=(0,t.useState)(""),[D,A]=(0,t.useState)(""),[I,F]=(0,t.useState)(""),[T,_]=(0,t.useState)("active"),[L,E]=(0,t.useTransition)(),M=(0,o.useRouter)();return((0,t.useEffect)(()=>{m&&(x(m.legalName),p(m.registrationNumber||""),j(m.taxId||""),b(m.regulator||"none"),N(m.licenseNumber||""),C(m.licenseType||""),k(m.email||""),A(m.phone||""),F(m.address||""),_(m.status))},[m]),m)?(0,a.jsx)(r.Dialog,{open:e,onOpenChange:u,children:(0,a.jsxs)(r.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(r.DialogHeader,{children:[(0,a.jsx)(r.DialogTitle,{children:"Edit Arranger Entity"}),(0,a.jsxs)(r.DialogDescription,{children:["Update information for ",m.legalName]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Basic Information"}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"legalName",children:"Legal Name *"}),(0,a.jsx)(l.Input,{id:"legalName",value:h,onChange:e=>x(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"registrationNumber",children:"Registration Number"}),(0,a.jsx)(l.Input,{id:"registrationNumber",value:g,onChange:e=>p(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"taxId",children:"Tax ID"}),(0,a.jsx)(l.Input,{id:"taxId",value:v,onChange:e=>j(e.target.value)})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Regulatory Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"regulator",children:"Regulator"}),(0,a.jsxs)(d.Select,{value:f,onValueChange:b,children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"Select regulator"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"none",children:"None / Not Specified"}),(0,a.jsx)(d.SelectItem,{value:"FCA",children:"FCA (UK)"}),(0,a.jsx)(d.SelectItem,{value:"SEC",children:"SEC (US)"}),(0,a.jsx)(d.SelectItem,{value:"FINMA",children:"FINMA (Switzerland)"}),(0,a.jsx)(d.SelectItem,{value:"MAS",children:"MAS (Singapore)"}),(0,a.jsx)(d.SelectItem,{value:"ASIC",children:"ASIC (Australia)"}),(0,a.jsx)(d.SelectItem,{value:"Other",children:"Other"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"licenseNumber",children:"License Number"}),(0,a.jsx)(l.Input,{id:"licenseNumber",value:y,onChange:e=>N(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"licenseType",children:"License Type"}),(0,a.jsx)(l.Input,{id:"licenseType",value:w,onChange:e=>C(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Contact Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"email",children:"Email"}),(0,a.jsx)(l.Input,{id:"email",type:"email",value:S,onChange:e=>k(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"phone",children:"Phone"}),(0,a.jsx)(l.Input,{id:"phone",type:"tel",value:D,onChange:e=>A(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"address",children:"Registered Address"}),(0,a.jsx)(n.Textarea,{id:"address",value:I,onChange:e=>F(e.target.value),rows:2})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{children:"Status"}),(0,a.jsxs)(d.Select,{value:T,onValueChange:_,children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"active",children:"Active"}),(0,a.jsx)(d.SelectItem,{value:"inactive",children:"Inactive"}),(0,a.jsx)(d.SelectItem,{value:"suspended",children:"Suspended"})]})]})]})]}),(0,a.jsxs)(r.DialogFooter,{children:[(0,a.jsx)(s.Button,{variant:"outline",onClick:()=>u(!1),disabled:L,children:"Cancel"}),(0,a.jsx)(s.Button,{onClick:()=>{m&&E(async()=>{if(!h.trim())return void c.toast.error("Legal name is required");try{let e=await fetch(`/api/admin/arrangers/${m.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({legal_name:h.trim(),registration_number:g.trim()||null,tax_id:v.trim()||null,regulator:"none"===f?null:f.trim()||null,license_number:y.trim()||null,license_type:w.trim()||null,email:S.trim()||null,phone:D.trim()||null,address:I.trim()||null,status:T})});if(!e.ok){let a=await e.json().catch(()=>null);console.error("[EditArrangerDialog] Failed to update arranger",a),c.toast.error(a?.error??"Failed to update arranger entity");return}c.toast.success("Arranger entity updated successfully"),u(!1),M.refresh()}catch(e){console.error("[EditArrangerDialog] Unexpected error",e),c.toast.error("Failed to update arranger entity")}})},disabled:L,children:L?"Updating…":"Update"})]})]})}):null}e.s(["EditArrangerDialog",()=>u])},849725,e=>{"use strict";var a=e.i(722679),t=e.i(340915),r=e.i(603274);let s=(0,t.createContext)(void 0);function l({children:e}){let[l,i]=(0,t.useState)(!1),n=(0,r.useRouter)(),d=(0,t.useCallback)(()=>{n.refresh()},[n]);return(0,a.jsx)(s.Provider,{value:{open:l,setOpen:i,refresh:d},children:e})}function i(){let e=(0,t.useContext)(s);if(!e)throw Error("useAddArranger must be used within a AddArrangerProvider");return e}e.s(["AddArrangerProvider",()=>l,"useAddArranger",()=>i])},595519,e=>{"use strict";var a=e.i(722679),t=e.i(340915),r=e.i(90613),s=e.i(129432),l=e.i(316264),i=e.i(191569),n=e.i(538892),d=e.i(691974),c=e.i(971743),o=e.i(734213),u=e.i(15098),m=e.i(831833),h=e.i(750809),x=e.i(551544),g=e.i(119311),p=e.i(196767),v=e.i(335994),j=e.i(282141),f=e.i(501495),b=e.i(849725),y=e.i(768697),N=e.i(352776),w=e.i(514133),C=e.i(816654),S=e.i(994500),k=e.i(603274),D=e.i(745083),A=e.i(645855);function I({open:e,onOpenChange:r,arranger:i}){let[d,c]=(0,t.useState)("draft"),[o,m]=(0,t.useState)(""),[h,x]=(0,t.useTransition)(),g=(0,k.useRouter)();if((0,t.useEffect)(()=>{i&&(c(i.kycStatus),m(i.kycNotes||""))},[i]),!i)return null;let p={draft:{icon:A.Clock,color:"text-yellow-400",label:"Draft / Pending"},approved:{icon:u.CheckCircle2,color:"text-green-400",label:"Approved"},expired:{icon:D.XCircle,color:"text-red-400",label:"Expired"},rejected:{icon:D.XCircle,color:"text-red-400",label:"Rejected"}},v=p[i.kycStatus]||p.draft,j=v.icon;return(0,a.jsx)(N.Dialog,{open:e,onOpenChange:r,children:(0,a.jsxs)(N.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(N.DialogHeader,{children:[(0,a.jsx)(N.DialogTitle,{children:"KYC Management"}),(0,a.jsxs)(N.DialogDescription,{children:["Manage KYC status for ",i.legalName]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border border-white/10 rounded-lg p-4 bg-white/5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Current Status"}),(0,a.jsxs)(s.Badge,{className:`capitalize ${v.color}`,children:[(0,a.jsx)(j,{className:"h-3 w-3 mr-1"}),v.label]})]}),i.kycApprovedAt&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Approved: ",(0,f.formatDate)(i.kycApprovedAt)]}),i.kycExpiresAt&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Expires: ",(0,f.formatDate)(i.kycExpiresAt)]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(w.Label,{children:"Update KYC Status"}),(0,a.jsxs)(n.Select,{value:d,onValueChange:c,children:[(0,a.jsx)(n.SelectTrigger,{children:(0,a.jsx)(n.SelectValue,{})}),(0,a.jsxs)(n.SelectContent,{children:[(0,a.jsx)(n.SelectItem,{value:"draft",children:"Draft / Pending Review"}),(0,a.jsx)(n.SelectItem,{value:"approved",children:"Approved (Valid 1 year)"}),(0,a.jsx)(n.SelectItem,{value:"expired",children:"Expired"}),(0,a.jsx)(n.SelectItem,{value:"rejected",children:"Rejected"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(w.Label,{htmlFor:"kycNotes",children:"KYC Notes"}),(0,a.jsx)(C.Textarea,{id:"kycNotes",value:o,onChange:e=>m(e.target.value),placeholder:"Document verification notes, compliance findings, etc.",rows:4})]}),i.metadata&&Object.keys(i.metadata).length>0&&(0,a.jsxs)("div",{className:"border border-white/10 rounded-lg p-4 bg-white/5",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-foreground mb-2",children:"Additional Metadata"}),(0,a.jsx)("pre",{className:"text-xs text-muted-foreground overflow-auto max-h-32",children:JSON.stringify(i.metadata,null,2)})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Approving KYC will set the approval date to today and expiry date to 1 year from now. Ensure all required documents have been uploaded and verified before approval."})]}),(0,a.jsxs)(N.DialogFooter,{children:[(0,a.jsx)(l.Button,{variant:"outline",onClick:()=>r(!1),disabled:h,children:"Cancel"}),(0,a.jsx)(l.Button,{onClick:()=>{i&&x(async()=>{try{let e=await fetch(`/api/admin/arrangers/${i.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({kyc_status:d,kyc_notes:o.trim()||null,kyc_approved_at:"approved"===d?new Date().toISOString():null,kyc_expires_at:"approved"===d?new Date(Date.now()+31536e6).toISOString():null})});if(!e.ok){let a=await e.json().catch(()=>null);console.error("[ArrangerKYCDialog] Failed to update KYC",a),S.toast.error(a?.error??"Failed to update KYC status");return}S.toast.success("KYC status updated successfully"),r(!1),g.refresh()}catch(e){console.error("[ArrangerKYCDialog] Unexpected error",e),S.toast.error("Failed to update KYC status")}})},disabled:h,children:h?"Updating…":"Update KYC Status"})]})]})})}var F=e.i(396064),T=e.i(761722),_=e.i(554369),L=e.i(378710),E=e.i(263229);let M=[{label:"Certificate of Incorporation",value:"certificate_of_incorporation"},{label:"FCA Authorization Letter / SEC Form ADV",value:"regulatory_license"},{label:"Professional Indemnity Insurance",value:"insurance_certificate"},{label:"AML/CTF Policy Document",value:"aml_policy"},{label:"Latest Financial Statements",value:"financial_statements"},{label:"Beneficial Ownership Declaration",value:"beneficial_ownership"},{label:"Proof of Registered Address",value:"proof_of_address"}];function R({open:e,onOpenChange:r,arranger:s}){let[n,d]=(0,t.useState)([]),[c,o]=(0,t.useState)(!1),[m,h]=(0,t.useState)(!1),x=(0,t.useRef)({}),p=(0,t.useCallback)(async()=>{if(s?.id){o(!0);try{let e=await fetch(`/api/documents?arranger_entity_id=${s.id}&limit=100`);if(!e.ok)throw Error("Failed to fetch documents");let a=await e.json();d(a.documents||[])}catch(e){console.error("Error fetching documents:",e),S.toast.error("Failed to load documents")}finally{o(!1)}}},[s?.id]);(0,t.useEffect)(()=>{e&&s?.id&&p()},[e,s?.id,p]);let v=async(e,a)=>{if(s?.id){if(e.size>0x3200000)return void S.toast.error("File size exceeds 50MB limit");if(!["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","image/jpeg","image/png","text/plain"].includes(e.type))return void S.toast.error("Invalid file type. Please upload PDF, DOC, DOCX, JPG, PNG, or TXT files");h(!0);try{let t=new FormData;t.append("file",e),t.append("type",a),t.append("arranger_entity_id",s.id),t.append("name",e.name.replace(/\.[^/.]+$/,""));let r=await fetch("/api/documents/upload",{method:"POST",body:t});if(!r.ok){let e=await r.json();throw Error(e.error||"Upload failed")}let l=M.find(e=>e.value===a)?.label||a;S.toast.success(`${l} uploaded successfully`),await p()}catch(e){console.error("Upload error:",e),S.toast.error(e.message||"Failed to upload document")}finally{h(!1),x.current[a]&&(x.current[a].value="")}}},j=async e=>{if(confirm(`Delete "${e.name}"? This action cannot be undone.`))try{let a=await fetch(`/api/staff/documents/${e.id}`,{method:"DELETE"});if(!a.ok){let e=await a.json();throw Error(e.error||"Delete failed")}S.toast.success("Document deleted successfully"),await p()}catch(e){console.error("Delete error:",e),S.toast.error(e.message||"Failed to delete document")}},f=async e=>{try{let a=await fetch(`/api/documents/${e.id}/download`);if(!a.ok)throw Error("Download failed");let t=await a.blob(),r=window.URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=e.file_name||e.name,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(r),document.body.removeChild(s),S.toast.success("Document downloaded")}catch(e){console.error("Download error:",e),S.toast.error("Failed to download document")}},b=e=>e?e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`:"Unknown size";return s?(0,a.jsx)(N.Dialog,{open:e,onOpenChange:r,children:(0,a.jsxs)(N.DialogContent,{className:"max-w-3xl max-h-[85vh] overflow-y-auto",children:[(0,a.jsxs)(N.DialogHeader,{children:[(0,a.jsxs)(N.DialogTitle,{children:["Documents - ",s.legalName]}),(0,a.jsx)(N.DialogDescription,{children:"Manage KYC documents, licenses, and certificates for this arranger entity"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border border-white/10 rounded-lg p-4 bg-white/5",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground mb-4",children:"Required Documents"}),c?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(E.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,a.jsx)("div",{className:"space-y-3",children:M.map(e=>{let t=n.find(a=>a.type===e.value);return(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 py-2 px-3 rounded-lg hover:bg-white/5 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t?(0,a.jsx)(u.CheckCircle2,{className:"h-5 w-5 text-green-400 flex-shrink-0"}):(0,a.jsx)(L.Circle,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-foreground truncate",children:e.label}),t&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[t.file_name," • ",b(t.file_size_bytes)]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 flex-shrink-0",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>f(t),className:"h-8 w-8 p-0",children:(0,a.jsx)(T.Download,{className:"h-4 w-4"})}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>j(t),className:"h-8 w-8 p-0 text-red-400 hover:text-red-300",children:(0,a.jsx)(_.Trash2,{className:"h-4 w-4"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Input,{ref:a=>{x.current[e.value]=a},type:"file",className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt",onChange:a=>{let t=a.target.files?.[0];t&&v(t,e.value)},disabled:m}),(0,a.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>x.current[e.value]?.click(),disabled:m,children:[m?(0,a.jsx)(E.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(F.Upload,{className:"h-4 w-4 mr-2"}),"Upload"]})]})})]},e.value)})})]}),n.filter(e=>!M.some(a=>a.value===e.type)).length>0&&(0,a.jsxs)("div",{className:"border border-white/10 rounded-lg p-4 bg-white/5",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Other Documents"}),(0,a.jsx)("div",{className:"space-y-2",children:n.filter(e=>!M.some(a=>a.value===e.type)).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 py-2 px-3 rounded-lg hover:bg-white/5 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,a.jsx)(g.FileText,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-foreground truncate",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[e.file_name," • ",b(e.file_size_bytes)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>f(e),className:"h-8 w-8 p-0",children:(0,a.jsx)(T.Download,{className:"h-4 w-4"})}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>j(e),className:"h-8 w-8 p-0 text-red-400 hover:text-red-300",children:(0,a.jsx)(_.Trash2,{className:"h-4 w-4"})})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between border border-white/10 rounded-lg p-4 bg-white/5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Documents"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-foreground",children:n.length})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Required Uploaded"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-foreground",children:[n.filter(e=>M.some(a=>a.value===e.type)).length," / ",M.length]})]})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1 border-t border-white/10 pt-4",children:[(0,a.jsx)("p",{children:"• Supported formats: PDF, DOC, DOCX, JPG, PNG, TXT"}),(0,a.jsx)("p",{children:"• Maximum file size: 50MB per file"}),(0,a.jsx)("p",{children:"• Documents are stored securely and linked to this arranger entity"}),(0,a.jsx)("p",{children:"• Upload actions are logged for audit trail"})]})]})]})}):null}var B=e.i(429482);let P=[{label:"All status",value:"all"},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"},{label:"Suspended",value:"suspended"}],U=[{label:"All KYC",value:"all"},{label:"Approved",value:"approved"},{label:"Pending",value:"draft"},{label:"Expired",value:"expired"},{label:"Rejected",value:"rejected"}];function O({summary:e,arrangers:s,deals:d=[],vehicles:x=[]}){let[g,v]=(0,t.useState)(""),[j,N]=(0,t.useState)("all"),[w,C]=(0,t.useState)("all"),[S,k]=(0,t.useState)(null),[D,A]=(0,t.useState)(null),[F,T]=(0,t.useState)(null),[_,L]=(0,t.useState)(null),{setOpen:E}=(0,b.useAddArranger)(),M=(0,t.useMemo)(()=>s.filter(e=>{let a="all"===j||e.status===j,t="all"===w||e.kycStatus===w,r=!g||e.legalName.toLowerCase().includes(g.toLowerCase())||(e.registrationNumber?.toLowerCase().includes(g.toLowerCase())??!1)||(e.licenseNumber?.toLowerCase().includes(g.toLowerCase())??!1)||(e.email?.toLowerCase().includes(g.toLowerCase())??!1);return a&&t&&r}),[s,j,w,g]);return(0,a.jsxs)("div",{className:"p-6 space-y-6 text-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Arrangers & Advisors"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage regulated entities arranging deals and managing vehicles"})]}),(0,a.jsxs)(l.Button,{onClick:()=>E(!0),children:[(0,a.jsx)(m.Plus,{className:"h-4 w-4 mr-2"}),"Add Arranger"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)(z,{icon:(0,a.jsx)(c.Building2,{className:"h-4 w-4"}),label:"Active Entities",primary:e.activeEntities,secondary:`${e.totalEntities} total`}),(0,a.jsx)(z,{icon:(0,a.jsx)(u.CheckCircle2,{className:"h-4 w-4"}),label:"KYC Approved",primary:e.kycApproved,secondary:`${e.totalEntities-e.kycApproved} pending`,primaryClassName:"text-green-400"}),(0,a.jsx)(z,{icon:(0,a.jsx)(o.Activity,{className:"h-4 w-4"}),label:"Total Deals",primary:e.totalDeals,secondary:"Arranged"}),(0,a.jsx)(z,{icon:(0,a.jsx)(p.DollarSign,{className:"h-4 w-4"}),label:"Total AUM",primary:(0,f.formatCurrency)(e.totalAum),secondary:`${e.totalVehicles} vehicles`})]}),(0,a.jsxs)(r.Card,{className:"border border-white/10",children:[(0,a.jsxs)(r.CardHeader,{children:[(0,a.jsx)(r.CardTitle,{children:"Search & Filters"}),(0,a.jsx)(r.CardDescription,{children:"Filter arrangers by status, KYC status, or keywords"})]}),(0,a.jsx)(r.CardContent,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(i.Input,{placeholder:"Search legal name, registration #, license #, email...",value:g,onChange:e=>v(e.target.value),className:"pl-10"})]})}),(0,a.jsxs)(n.Select,{value:j,onValueChange:N,children:[(0,a.jsx)(n.SelectTrigger,{className:"w-full md:w-48",children:(0,a.jsx)(n.SelectValue,{placeholder:"Filter status"})}),(0,a.jsx)(n.SelectContent,{children:P.map(e=>(0,a.jsx)(n.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)(n.Select,{value:w,onValueChange:C,children:[(0,a.jsx)(n.SelectTrigger,{className:"w-full md:w-48",children:(0,a.jsx)(n.SelectValue,{placeholder:"Filter KYC"})}),(0,a.jsx)(n.SelectContent,{children:U.map(e=>(0,a.jsx)(n.SelectItem,{value:e.value,children:e.label},e.value))})]})]})})]}),(0,a.jsxs)(r.Card,{className:"border border-white/10",children:[(0,a.jsxs)(r.CardHeader,{children:[(0,a.jsxs)(r.CardTitle,{children:["Arranger Entities (",M.length,")"]}),(0,a.jsx)(r.CardDescription,{children:"Regulated entities with deal and vehicle assignments"})]}),(0,a.jsx)(r.CardContent,{className:"space-y-4",children:0===M.length?(0,a.jsx)(H,{message:g?"No arrangers match your filters.":"No arrangers available yet."}):M.map(e=>(0,a.jsx)(V,{arranger:e,onEdit:()=>k(e),onManageKYC:()=>A(e),onManageDocuments:()=>T(e),onInvite:()=>L(e)},e.id))})]}),(0,a.jsx)(y.EditArrangerDialog,{open:!!S,onOpenChange:e=>!e&&k(null),arranger:S}),(0,a.jsx)(I,{open:!!D,onOpenChange:e=>!e&&A(null),arranger:D}),(0,a.jsx)(R,{open:!!F,onOpenChange:e=>!e&&T(null),arranger:F}),_&&(0,a.jsx)(B.InviteUserDialog,{open:!!_,onOpenChange:e=>!e&&L(null),entityType:"arranger",entityId:_.id,entityName:_.legalName})]})}function z({icon:e,label:t,primary:s,secondary:l,primaryClassName:i}){return(0,a.jsxs)(r.Card,{className:"border border-white/10",children:[(0,a.jsx)(r.CardHeader,{className:"pb-3",children:(0,a.jsxs)(r.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e,t]})}),(0,a.jsxs)(r.CardContent,{children:[(0,a.jsx)("div",{className:(0,j.cn)("text-2xl font-bold",i),children:s}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:l})]})]})}function V({arranger:e,onEdit:t,onManageKYC:r,onManageDocuments:i,onInvite:n}){return(0,a.jsx)("div",{className:"border border-white/10 bg-white/5 rounded-lg p-4 hover:bg-white/10 transition-colors",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg border border-primary/30 bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(d.Briefcase,{className:"h-6 w-6 text-primary"})}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:e.legalName}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:t,className:"h-7 w-7 p-0",children:(0,a.jsx)(x.Edit,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.regulator&&e.licenseNumber&&(0,a.jsxs)("span",{className:"font-medium",children:[e.regulator,": ",e.licenseNumber]}),e.registrationNumber&&(0,a.jsxs)("span",{className:"ml-2",children:["• Reg: ",e.registrationNumber]})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.email||"No email"," • ",e.phone||"No phone"]}),e.licenseType&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Type: ",e.licenseType,e.licenseExpiryDate&&(0,a.jsxs)("span",{className:"ml-2",children:["• Expires: ",(0,f.formatDate)(e.licenseExpiryDate)]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,a.jsx)(K,{label:"Deals",value:e.totalDeals,subtitle:`${e.activeDeals} active`}),(0,a.jsx)(K,{label:"Vehicles",value:e.totalVehicles}),(0,a.jsx)(K,{label:"AUM",value:(0,f.formatCurrency)(e.totalAum)}),(0,a.jsx)(K,{label:"Docs",value:e.documentCount})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsx)(s.Badge,{className:(0,j.cn)("capitalize",{active:"bg-green-500/20 text-green-400 border-green-500/30",inactive:"bg-gray-500/20 text-gray-400 border-gray-500/30",suspended:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"}[e.status]??"bg-gray-500/20 text-gray-400"),children:e.status}),(0,a.jsxs)(s.Badge,{className:(0,j.cn)("capitalize",{approved:"bg-green-500/20 text-green-400 border-green-500/30",draft:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",expired:"bg-red-500/20 text-red-400 border-red-500/30",rejected:"bg-red-500/20 text-red-400 border-red-500/30"}[e.kycStatus]??"bg-gray-500/20 text-gray-400"),children:["KYC: ",e.kycStatus]}),(0,a.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:r,className:"h-7 text-xs",children:[(0,a.jsx)(u.CheckCircle2,{className:"h-3 w-3 mr-1"}),"KYC"]}),(0,a.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:i,className:"h-7 text-xs",children:[(0,a.jsx)(g.FileText,{className:"h-3 w-3 mr-1"}),"Docs"]}),(0,a.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:n,className:"h-7 text-xs",children:[(0,a.jsx)(v.UserPlus,{className:"h-3 w-3 mr-1"}),"Invite"]})]})]})]})})}function K({label:e,value:t,subtitle:r,className:s}){return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:(0,j.cn)("font-semibold tabular-nums",s),children:t}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:e}),r&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:r})]})}function H({message:e}){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)(d.Briefcase,{className:"h-12 w-12 text-muted-foreground mb-4 opacity-50"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:e})]})}e.s(["ArrangersDashboard",()=>O],595519)},452627,e=>{"use strict";var a=e.i(722679),t=e.i(340915),r=e.i(352776),s=e.i(316264),l=e.i(191569),i=e.i(514133),n=e.i(816654),d=e.i(538892),c=e.i(849725),o=e.i(994500);function u(){let[e,u]=(0,t.useState)(""),[m,h]=(0,t.useState)(""),[x,g]=(0,t.useState)(""),[p,v]=(0,t.useState)(""),[j,f]=(0,t.useState)(""),[b,y]=(0,t.useState)(""),[N,w]=(0,t.useState)(""),[C,S]=(0,t.useState)(""),[k,D]=(0,t.useState)(""),[A,I]=(0,t.useState)("active"),[F,T]=(0,t.useTransition)(),{open:_,setOpen:L,refresh:E}=(0,c.useAddArranger)(),M=()=>{u(""),h(""),g(""),v(""),f(""),y(""),w(""),S(""),D(""),I("active")};return(0,a.jsx)(r.Dialog,{open:_,onOpenChange:e=>{L(e),e||M()},children:(0,a.jsxs)(r.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(r.DialogHeader,{children:[(0,a.jsx)(r.DialogTitle,{children:"Add Arranger Entity"}),(0,a.jsx)(r.DialogDescription,{children:"Register a new regulated entity (advisor/arranger) for deal and vehicle management."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Basic Information"}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"legalName",children:"Legal Name *"}),(0,a.jsx)(l.Input,{id:"legalName",value:e,onChange:e=>u(e.target.value),placeholder:"e.g. VERSO MANAGEMENT LTD",autoFocus:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"registrationNumber",children:"Company Registration Number"}),(0,a.jsx)(l.Input,{id:"registrationNumber",value:m,onChange:e=>h(e.target.value),placeholder:"e.g. 12345678"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"taxId",children:"Tax ID"}),(0,a.jsx)(l.Input,{id:"taxId",value:x,onChange:e=>g(e.target.value),placeholder:"e.g. EIN or UTR"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Regulatory Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"regulator",children:"Regulator"}),(0,a.jsxs)(d.Select,{value:p,onValueChange:v,children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"Select regulator"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"FCA",children:"FCA (UK)"}),(0,a.jsx)(d.SelectItem,{value:"SEC",children:"SEC (US)"}),(0,a.jsx)(d.SelectItem,{value:"FINMA",children:"FINMA (Switzerland)"}),(0,a.jsx)(d.SelectItem,{value:"MAS",children:"MAS (Singapore)"}),(0,a.jsx)(d.SelectItem,{value:"ASIC",children:"ASIC (Australia)"}),(0,a.jsx)(d.SelectItem,{value:"Other",children:"Other"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"licenseNumber",children:"License Number"}),(0,a.jsx)(l.Input,{id:"licenseNumber",value:j,onChange:e=>f(e.target.value),placeholder:"e.g. FRN or CRD number"})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"licenseType",children:"License Type"}),(0,a.jsx)(l.Input,{id:"licenseType",value:b,onChange:e=>y(e.target.value),placeholder:"e.g. Investment Advisor, Broker-Dealer, Fund Manager"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Contact Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"email",children:"Email"}),(0,a.jsx)(l.Input,{id:"email",type:"email",value:N,onChange:e=>w(e.target.value),placeholder:"compliance@example.com"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"phone",children:"Phone"}),(0,a.jsx)(l.Input,{id:"phone",type:"tel",value:C,onChange:e=>S(e.target.value),placeholder:"+44 20 1234 5678"})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{htmlFor:"address",children:"Registered Address"}),(0,a.jsx)(n.Textarea,{id:"address",value:k,onChange:e=>D(e.target.value),placeholder:"Street address, city, postal code, country",rows:2})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(i.Label,{children:"Status"}),(0,a.jsxs)(d.Select,{value:A,onValueChange:I,children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"Select status"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"active",children:"Active"}),(0,a.jsx)(d.SelectItem,{value:"inactive",children:"Inactive"}),(0,a.jsx)(d.SelectItem,{value:"suspended",children:"Suspended"})]})]})]})]}),(0,a.jsxs)(r.DialogFooter,{children:[(0,a.jsx)(s.Button,{variant:"outline",onClick:()=>L(!1),disabled:F,children:"Cancel"}),(0,a.jsx)(s.Button,{onClick:()=>{T(async()=>{if(!e.trim())return void o.toast.error("Legal name is required");try{let a=await fetch("/api/admin/arrangers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({legal_name:e.trim(),registration_number:m.trim()||null,tax_id:x.trim()||null,regulator:p.trim()||null,license_number:j.trim()||null,license_type:b.trim()||null,email:N.trim()||null,phone:C.trim()||null,address:k.trim()||null,status:A,kyc_status:"draft"})});if(!a.ok){let e=await a.json().catch(()=>null);console.error("[AddArrangerDialog] Failed to create arranger",e),o.toast.error(e?.error??"Failed to create arranger entity");return}o.toast.success("Arranger entity created successfully"),L(!1),M(),E()}catch(e){console.error("[AddArrangerDialog] Unexpected error",e),o.toast.error("Failed to create arranger entity")}})},disabled:F,children:F?"Creating…":"Create Arranger"})]})]})})}e.s(["AddArrangerDialog",()=>u])}]);