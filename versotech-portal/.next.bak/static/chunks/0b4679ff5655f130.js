(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56213,e=>{"use strict";var s=e.i(722679),t=e.i(282141);function a({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"skeleton",className:(0,t.cn)("bg-accent animate-pulse rounded-md",e),...a})}e.s(["Skeleton",()=>a])},196767,e=>{"use strict";let s=(0,e.i(410587).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>s],196767)},90613,e=>{"use strict";var s=e.i(722679),t=e.i(282141);function a({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function l({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function r({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...a})}function n({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...a})}function o({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...a})}function c({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"card-footer",className:(0,t.cn)("flex items-center px-6 [.border-t]:pt-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>o,"CardDescription",()=>n,"CardFooter",()=>c,"CardHeader",()=>l,"CardTitle",()=>r])},645855,e=>{"use strict";let s=(0,e.i(410587).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>s],645855)},237635,e=>{"use strict";var s=e.i(722679),t=e.i(282141);function a({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,t.cn)("w-full caption-bottom text-sm",e),...a})})}function l({className:e,...a}){return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,t.cn)("[&_tr]:border-b",e),...a})}function r({className:e,...a}){return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,t.cn)("[&_tr:last-child]:border-0",e),...a})}function n({className:e,...a}){return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,t.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...a})}function o({className:e,...a}){return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,t.cn)("text-foreground h-11 md:h-10 px-2 text-left align-middle font-medium text-xs sm:text-sm [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}function c({className:e,...a}){return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,t.cn)("p-2 align-middle text-xs sm:text-sm [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}e.s(["Table",()=>a,"TableBody",()=>r,"TableCell",()=>c,"TableHead",()=>o,"TableHeader",()=>l,"TableRow",()=>n])},185419,e=>{"use strict";let s=(0,e.i(410587).default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);e.s(["ArrowUpDown",()=>s],185419)},432686,e=>{"use strict";var s=e.i(722679),t=e.i(90613),a=e.i(56213);function l(){return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:Array.from({length:3}).map((e,l)=>(0,s.jsxs)(t.Card,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a.Skeleton,{className:"h-4 w-4 rounded"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-24"})]}),(0,s.jsx)(a.Skeleton,{className:"h-8 w-20 mt-2"}),(0,s.jsx)(a.Skeleton,{className:"h-3 w-32 mt-1"})]},l))}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"pb-2",children:[(0,s.jsx)(a.Skeleton,{className:"h-5 w-32"}),(0,s.jsx)(a.Skeleton,{className:"h-3 w-80 mt-1"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-9 gap-4 pb-2 border-b",children:[(0,s.jsx)(a.Skeleton,{className:"h-4 w-20"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-12"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-16"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-24"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-24"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-24"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-20"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-20"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-20"})]}),Array.from({length:8}).map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-9 gap-4 py-3",children:[(0,s.jsx)(a.Skeleton,{className:"h-4 w-24"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-10"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-12"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-14"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-16"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-16"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-12"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-12"}),(0,s.jsx)(a.Skeleton,{className:"h-4 w-12"})]},t))]})})]})]})}e.s(["CohortsSkeleton",()=>l])},876727,e=>{"use strict";var s=e.i(722679),t=e.i(340915),a=e.i(603274),l=e.i(538892),r=e.i(432686),n=e.i(615595),o=e.i(729416),c=e.i(90613),d=e.i(316264),i=e.i(56213),m=e.i(237635),x=e.i(185419),h=e.i(501259),u=e.i(733179),g=e.i(645855),j=e.i(196767),p=e.i(282141);function N(e){return -1===e?"text-muted-foreground":e>=70?"text-emerald-600 dark:text-emerald-400":e>=40?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}function f(e){return e>=50?"text-emerald-600 dark:text-emerald-400":e>=25?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}function w(e){return -1===e?"N/A":`${e}%`}function v({groupBy:e}){let[a,l]=(0,t.useState)(null),[r,v]=(0,t.useState)(!0),[b,S]=(0,t.useState)(null),[k,y]=(0,t.useState)([]);(0,t.useEffect)(()=>{!async function(){v(!0),S(null);try{let s=await fetch(`/api/admin/growth/cohorts?groupBy=${e}`);if(!s.ok)throw Error("Failed to fetch cohort data");let t=await s.json();if(t.success&&t.data)l(t.data.cohorts);else throw Error(t.error||"No data available")}catch(e){S(e instanceof Error?e.message:"Failed to load data")}finally{v(!1)}}()},[e]);let C=(0,t.useMemo)(()=>[{accessorKey:"cohortName",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Cohort",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,s.jsx)("div",{className:"font-medium",children:e.getValue("cohortName")})},{accessorKey:"size",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Size",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(h.Users,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,s.jsx)("span",{children:e.getValue("size").toLocaleString()})]})},{accessorKey:"activationRate",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Activation",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.getValue("activationRate");return(0,s.jsxs)("span",{className:f(t),children:[t,"%"]})}},{accessorKey:"investmentRate",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Investment Rate",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.getValue("investmentRate");return(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(u.TrendingUp,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,s.jsxs)("span",{className:f(t),children:[t,"%"]})]})}},{accessorKey:"avgInvestment",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Avg Investment",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.getValue("avgInvestment");return(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(j.DollarSign,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,s.jsx)("span",{children:t>0?t>=1e6?`$${(t/1e6).toFixed(1)}M`:t>=1e3?`$${(t/1e3).toFixed(0)}K`:`$${t.toLocaleString()}`:"-"})]})}},{accessorKey:"avgTimeToFirstInvestment",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Days to Invest",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.getValue("avgTimeToFirstInvestment");return(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(g.Clock,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,s.jsx)("span",{children:null!==t?`${t} days`:"-"})]})}},{accessorKey:"retention30d",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4 whitespace-nowrap",children:["30d Retention",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.getValue("retention30d");return(0,s.jsx)("span",{className:N(t),children:w(t)})}},{accessorKey:"retention60d",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4 whitespace-nowrap",children:["60d Retention",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.getValue("retention60d");return(0,s.jsx)("span",{className:N(t),children:w(t)})}},{accessorKey:"retention90d",header:({column:e})=>(0,s.jsxs)(d.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4 whitespace-nowrap",children:["90d Retention",(0,s.jsx)(x.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.getValue("retention90d");return(0,s.jsx)("span",{className:N(t),children:w(t)})}}],[]),T=(0,n.useReactTable)({data:a||[],columns:C,getCoreRowModel:(0,o.getCoreRowModel)(),getSortedRowModel:(0,o.getSortedRowModel)(),onSortingChange:y,state:{sorting:k}});if(r)return(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{className:"pb-2",children:[(0,s.jsx)(i.Skeleton,{className:"h-5 w-32"}),(0,s.jsx)(i.Skeleton,{className:"h-3 w-56 mt-1"})]}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("div",{className:"grid grid-cols-9 gap-4 pb-2 border-b",children:Array.from({length:9}).map((e,t)=>(0,s.jsx)(i.Skeleton,{className:"h-4 w-16"},t))}),Array.from({length:8}).map((e,t)=>(0,s.jsx)("div",{className:"grid grid-cols-9 gap-4 py-3",children:Array.from({length:9}).map((e,t)=>(0,s.jsx)(i.Skeleton,{className:"h-4 w-14"},t))},t))]})})]});if(b)return(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{className:"text-base",children:"Cohort Analysis"}),(0,s.jsx)(c.CardDescription,{children:"Failed to load cohort data"})]}),(0,s.jsx)(c.CardContent,{children:(0,s.jsx)("p",{className:"text-destructive text-sm",children:b})})]});if(!a||0===a.length)return(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{className:"text-base",children:"Cohort Analysis"}),(0,s.jsx)(c.CardDescription,{children:"User cohort metrics and retention analysis"})]}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"rounded-full bg-muted p-4 mb-4",children:(0,s.jsx)(h.Users,{className:"h-8 w-8 text-muted-foreground"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"No Cohort Data"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground max-w-md mt-1",children:"There are no users in the selected grouping yet. Try selecting a different cohort grouping."})]})})]});let R=a.reduce((e,s)=>e+s.size,0),A=a.reduce((e,s)=>e+s.activationRate,0)/a.length,B=a.reduce((e,s)=>e+s.investmentRate,0)/a.length;return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,s.jsxs)(c.Card,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[(0,s.jsx)(h.Users,{className:"h-4 w-4"}),"Total Users"]}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1",children:R.toLocaleString()}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["across ",a.length," cohorts"]})]}),(0,s.jsxs)(c.Card,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[(0,s.jsx)(u.TrendingUp,{className:"h-4 w-4"}),"Avg Activation Rate"]}),(0,s.jsxs)("div",{className:(0,p.cn)("text-2xl font-bold mt-1",f(A)),children:[A.toFixed(1),"%"]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"profile completed"})]}),(0,s.jsxs)(c.Card,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[(0,s.jsx)(j.DollarSign,{className:"h-4 w-4"}),"Avg Investment Rate"]}),(0,s.jsxs)("div",{className:(0,p.cn)("text-2xl font-bold mt-1",f(B)),children:[B.toFixed(1),"%"]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"made an investment"})]})]}),(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{className:"text-base",children:"Cohort Metrics"}),(0,s.jsx)(c.CardDescription,{children:"Click column headers to sort. Retention shows user activity at 30/60/90 days after joining."})]}),(0,s.jsx)(c.CardContent,{children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(m.Table,{children:[(0,s.jsx)(m.TableHeader,{children:T.getHeaderGroups().map(e=>(0,s.jsx)(m.TableRow,{children:e.headers.map(e=>(0,s.jsx)(m.TableHead,{className:"whitespace-nowrap",children:e.isPlaceholder?null:(0,n.flexRender)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(m.TableBody,{children:T.getRowModel().rows.map(e=>(0,s.jsx)(m.TableRow,{children:e.getVisibleCells().map(e=>(0,s.jsx)(m.TableCell,{children:(0,n.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})})})]})]})}let b=[{value:"signup_month",label:"By Signup Month"},{value:"signup_week",label:"By Signup Week"},{value:"first_investment_month",label:"By First Investment Month"}];function S(){let e=(0,a.useSearchParams)(),t=(0,a.useRouter)(),r=(0,a.usePathname)(),n=e.get("groupBy")||"signup_month";return(0,s.jsxs)(l.Select,{value:n,onValueChange:s=>{let a=new URLSearchParams(e.toString());a.set("groupBy",s),t.push(`${r}?${a.toString()}`)},children:[(0,s.jsx)(l.SelectTrigger,{className:"w-[220px]",children:(0,s.jsx)(l.SelectValue,{placeholder:"Select grouping"})}),(0,s.jsx)(l.SelectContent,{children:b.map(e=>(0,s.jsx)(l.SelectItem,{value:e.value,children:e.label},e.value))})]})}function k(){let e=(0,a.useSearchParams)().get("groupBy")||"signup_month";return(0,s.jsx)(v,{groupBy:e})}function y(){return(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Cohort Analysis"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-1",children:"Analyze user behavior patterns by signup or investment cohorts"})]}),(0,s.jsx)(t.Suspense,{fallback:(0,s.jsx)("div",{className:"h-10 w-[220px] rounded-md bg-muted animate-pulse"}),children:(0,s.jsx)(S,{})})]}),(0,s.jsx)(t.Suspense,{fallback:(0,s.jsx)(r.CohortsSkeleton,{}),children:(0,s.jsx)(k,{})})]})}e.s(["default",()=>y],876727)}]);