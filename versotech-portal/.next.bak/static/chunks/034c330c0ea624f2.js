(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,496383,e=>{"use strict";let t=(0,e.i(410587).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],496383)},382021,e=>{"use strict";let t=(0,e.i(410587).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],382021)},661521,e=>{"use strict";var t=e.i(722679),l=e.i(340915),r=e.i(362208),s="horizontal",a=["horizontal","vertical"],n=l.forwardRef((e,l)=>{var n;let{decorative:i,orientation:o=s,...c}=e,d=(n=o,a.includes(n))?o:s;return(0,t.jsx)(r.Primitive.div,{"data-orientation":d,...i?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...c,ref:l})});n.displayName="Separator";var i=e.i(282141);let o=l.forwardRef(({className:e,orientation:l="horizontal",decorative:r=!0,...s},a)=>(0,t.jsx)(n,{ref:a,decorative:r,orientation:l,className:(0,i.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",e),...s}));o.displayName=n.displayName,e.s(["Separator",()=>o],661521)},849110,e=>{"use strict";let t=(0,e.i(410587).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>t],849110)},907434,e=>{"use strict";var t=e.i(722679),l=e.i(340915),r=e.i(362208),s=e.i(873358),a=e.i(47264),n=e.i(886978),i=e.i(171094),o=e.i(599205),c=e.i(990290),d=e.i(843189),u=e.i(679472),m="ScrollArea",[h,x]=(0,a.createContextScope)(m),[p,g]=h(m),v=l.forwardRef((e,s)=>{let{__scopeScrollArea:a,type:i="hover",dir:c,scrollHideDelay:d=600,...u}=e,[m,h]=l.useState(null),[x,g]=l.useState(null),[v,f]=l.useState(null),[j,w]=l.useState(null),[b,y]=l.useState(null),[N,C]=l.useState(0),[S,k]=l.useState(0),[A,D]=l.useState(!1),[T,R]=l.useState(!1),E=(0,n.useComposedRefs)(s,e=>h(e)),P=(0,o.useDirection)(c);return(0,t.jsx)(p,{scope:a,type:i,dir:P,scrollHideDelay:d,scrollArea:m,viewport:x,onViewportChange:g,content:v,onContentChange:f,scrollbarX:j,onScrollbarXChange:w,scrollbarXEnabled:A,onScrollbarXEnabledChange:D,scrollbarY:b,onScrollbarYChange:y,scrollbarYEnabled:T,onScrollbarYEnabledChange:R,onCornerWidthChange:C,onCornerHeightChange:k,children:(0,t.jsx)(r.Primitive.div,{dir:P,...u,ref:E,style:{position:"relative","--radix-scroll-area-corner-width":N+"px","--radix-scroll-area-corner-height":S+"px",...e.style}})})});v.displayName=m;var f="ScrollAreaViewport",j=l.forwardRef((e,s)=>{let{__scopeScrollArea:a,children:i,nonce:o,...c}=e,d=g(f,a),u=l.useRef(null),m=(0,n.useComposedRefs)(s,u,d.onViewportChange);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),(0,t.jsx)(r.Primitive.div,{"data-radix-scroll-area-viewport":"",...c,ref:m,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,t.jsx)("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:i})})]})});j.displayName=f;var w="ScrollAreaScrollbar",b=l.forwardRef((e,r)=>{let{forceMount:s,...a}=e,n=g(w,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=n,c="horizontal"===e.orientation;return l.useEffect(()=>(c?i(!0):o(!0),()=>{c?i(!1):o(!1)}),[c,i,o]),"hover"===n.type?(0,t.jsx)(y,{...a,ref:r,forceMount:s}):"scroll"===n.type?(0,t.jsx)(N,{...a,ref:r,forceMount:s}):"auto"===n.type?(0,t.jsx)(C,{...a,ref:r,forceMount:s}):"always"===n.type?(0,t.jsx)(S,{...a,ref:r}):null});b.displayName=w;var y=l.forwardRef((e,r)=>{let{forceMount:a,...n}=e,i=g(w,e.__scopeScrollArea),[o,c]=l.useState(!1);return l.useEffect(()=>{let e=i.scrollArea,t=0;if(e){let l=()=>{window.clearTimeout(t),c(!0)},r=()=>{t=window.setTimeout(()=>c(!1),i.scrollHideDelay)};return e.addEventListener("pointerenter",l),e.addEventListener("pointerleave",r),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",l),e.removeEventListener("pointerleave",r)}}},[i.scrollArea,i.scrollHideDelay]),(0,t.jsx)(s.Presence,{present:a||o,children:(0,t.jsx)(C,{"data-state":o?"visible":"hidden",...n,ref:r})})}),N=l.forwardRef((e,r)=>{var a;let{forceMount:n,...i}=e,o=g(w,e.__scopeScrollArea),c="horizontal"===e.orientation,d=O(()=>h("SCROLL_END"),100),[m,h]=(a={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},l.useReducer((e,t)=>a[e][t]??e,"hidden"));return l.useEffect(()=>{if("idle"===m){let e=window.setTimeout(()=>h("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(e)}},[m,o.scrollHideDelay,h]),l.useEffect(()=>{let e=o.viewport,t=c?"scrollLeft":"scrollTop";if(e){let l=e[t],r=()=>{let r=e[t];l!==r&&(h("SCROLL"),d()),l=r};return e.addEventListener("scroll",r),()=>e.removeEventListener("scroll",r)}},[o.viewport,c,h,d]),(0,t.jsx)(s.Presence,{present:n||"hidden"!==m,children:(0,t.jsx)(S,{"data-state":"hidden"===m?"hidden":"visible",...i,ref:r,onPointerEnter:(0,u.composeEventHandlers)(e.onPointerEnter,()=>h("POINTER_ENTER")),onPointerLeave:(0,u.composeEventHandlers)(e.onPointerLeave,()=>h("POINTER_LEAVE"))})})}),C=l.forwardRef((e,r)=>{let a=g(w,e.__scopeScrollArea),{forceMount:n,...i}=e,[o,c]=l.useState(!1),d="horizontal"===e.orientation,u=O(()=>{if(a.viewport){let e=a.viewport.offsetWidth<a.viewport.scrollWidth,t=a.viewport.offsetHeight<a.viewport.scrollHeight;c(d?e:t)}},10);return X(a.viewport,u),X(a.content,u),(0,t.jsx)(s.Presence,{present:n||o,children:(0,t.jsx)(S,{"data-state":o?"visible":"hidden",...i,ref:r})})}),S=l.forwardRef((e,r)=>{let{orientation:s="vertical",...a}=e,n=g(w,e.__scopeScrollArea),i=l.useRef(null),o=l.useRef(0),[c,d]=l.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=M(c.viewport,c.content),m={...a,sizes:c,onSizesChange:d,hasThumb:!!(u>0&&u<1),onThumbChange:e=>i.current=e,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:e=>o.current=e};function h(e,t){return function(e,t,l,r="ltr"){let s=H(l),a=t||s/2,n=l.scrollbar.paddingStart+a,i=l.scrollbar.size-l.scrollbar.paddingEnd-(s-a),o=l.content-l.viewport;return $([n,i],"ltr"===r?[0,o]:[-1*o,0])(e)}(e,o.current,c,t)}return"horizontal"===s?(0,t.jsx)(k,{...m,ref:r,onThumbPositionChange:()=>{if(n.viewport&&i.current){let e=U(n.viewport.scrollLeft,c,n.dir);i.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{n.viewport&&(n.viewport.scrollLeft=e)},onDragScroll:e=>{n.viewport&&(n.viewport.scrollLeft=h(e,n.dir))}}):"vertical"===s?(0,t.jsx)(A,{...m,ref:r,onThumbPositionChange:()=>{if(n.viewport&&i.current){let e=U(n.viewport.scrollTop,c);i.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{n.viewport&&(n.viewport.scrollTop=e)},onDragScroll:e=>{n.viewport&&(n.viewport.scrollTop=h(e))}}):null}),k=l.forwardRef((e,r)=>{let{sizes:s,onSizesChange:a,...i}=e,o=g(w,e.__scopeScrollArea),[c,d]=l.useState(),u=l.useRef(null),m=(0,n.useComposedRefs)(r,u,o.onScrollbarXChange);return l.useEffect(()=>{u.current&&d(getComputedStyle(u.current))},[u]),(0,t.jsx)(R,{"data-orientation":"horizontal",...i,ref:m,sizes:s,style:{bottom:0,left:"rtl"===o.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===o.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":H(s)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,l)=>{if(o.viewport){var r,s;let a=o.viewport.scrollLeft+t.deltaX;e.onWheelScroll(a),r=a,s=l,r>0&&r<s&&t.preventDefault()}},onResize:()=>{u.current&&o.viewport&&c&&a({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:B(c.paddingLeft),paddingEnd:B(c.paddingRight)}})}})}),A=l.forwardRef((e,r)=>{let{sizes:s,onSizesChange:a,...i}=e,o=g(w,e.__scopeScrollArea),[c,d]=l.useState(),u=l.useRef(null),m=(0,n.useComposedRefs)(r,u,o.onScrollbarYChange);return l.useEffect(()=>{u.current&&d(getComputedStyle(u.current))},[u]),(0,t.jsx)(R,{"data-orientation":"vertical",...i,ref:m,sizes:s,style:{top:0,right:"ltr"===o.dir?0:void 0,left:"rtl"===o.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":H(s)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,l)=>{if(o.viewport){var r,s;let a=o.viewport.scrollTop+t.deltaY;e.onWheelScroll(a),r=a,s=l,r>0&&r<s&&t.preventDefault()}},onResize:()=>{u.current&&o.viewport&&c&&a({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:B(c.paddingTop),paddingEnd:B(c.paddingBottom)}})}})}),[D,T]=h(w),R=l.forwardRef((e,s)=>{let{__scopeScrollArea:a,sizes:o,hasThumb:c,onThumbChange:d,onThumbPointerUp:m,onThumbPointerDown:h,onThumbPositionChange:x,onDragScroll:p,onWheelScroll:v,onResize:f,...j}=e,b=g(w,a),[y,N]=l.useState(null),C=(0,n.useComposedRefs)(s,e=>N(e)),S=l.useRef(null),k=l.useRef(""),A=b.viewport,T=o.content-o.viewport,R=(0,i.useCallbackRef)(v),E=(0,i.useCallbackRef)(x),P=O(f,10);function L(e){S.current&&p({x:e.clientX-S.current.left,y:e.clientY-S.current.top})}return l.useEffect(()=>{let e=e=>{let t=e.target;y?.contains(t)&&R(e,T)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[A,y,T,R]),l.useEffect(E,[o,E]),X(y,P),X(b.content,P),(0,t.jsx)(D,{scope:a,scrollbar:y,hasThumb:c,onThumbChange:(0,i.useCallbackRef)(d),onThumbPointerUp:(0,i.useCallbackRef)(m),onThumbPositionChange:E,onThumbPointerDown:(0,i.useCallbackRef)(h),children:(0,t.jsx)(r.Primitive.div,{...j,ref:C,style:{position:"absolute",...j.style},onPointerDown:(0,u.composeEventHandlers)(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),S.current=y.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),L(e))}),onPointerMove:(0,u.composeEventHandlers)(e.onPointerMove,L),onPointerUp:(0,u.composeEventHandlers)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=k.current,b.viewport&&(b.viewport.style.scrollBehavior=""),S.current=null})})})}),E="ScrollAreaThumb",P=l.forwardRef((e,l)=>{let{forceMount:r,...a}=e,n=T(E,e.__scopeScrollArea);return(0,t.jsx)(s.Presence,{present:r||n.hasThumb,children:(0,t.jsx)(L,{ref:l,...a})})}),L=l.forwardRef((e,s)=>{let{__scopeScrollArea:a,style:i,...o}=e,c=g(E,a),d=T(E,a),{onThumbPositionChange:m}=d,h=(0,n.useComposedRefs)(s,e=>d.onThumbChange(e)),x=l.useRef(void 0),p=O(()=>{x.current&&(x.current(),x.current=void 0)},100);return l.useEffect(()=>{let e=c.viewport;if(e){let t=()=>{p(),x.current||(x.current=F(e,m),m())};return m(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[c.viewport,p,m]),(0,t.jsx)(r.Primitive.div,{"data-state":d.hasThumb?"visible":"hidden",...o,ref:h,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:(0,u.composeEventHandlers)(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),l=e.clientX-t.left,r=e.clientY-t.top;d.onThumbPointerDown({x:l,y:r})}),onPointerUp:(0,u.composeEventHandlers)(e.onPointerUp,d.onThumbPointerUp)})});P.displayName=E;var _="ScrollAreaCorner",I=l.forwardRef((e,l)=>{let r=g(_,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&s?(0,t.jsx)(z,{...e,ref:l}):null});I.displayName=_;var z=l.forwardRef((e,s)=>{let{__scopeScrollArea:a,...n}=e,i=g(_,a),[o,c]=l.useState(0),[d,u]=l.useState(0),m=!!(o&&d);return X(i.scrollbarX,()=>{let e=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(e),u(e)}),X(i.scrollbarY,()=>{let e=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(e),c(e)}),m?(0,t.jsx)(r.Primitive.div,{...n,ref:s,style:{width:o,height:d,position:"absolute",right:"ltr"===i.dir?0:void 0,left:"rtl"===i.dir?0:void 0,bottom:0,...e.style}}):null});function B(e){return e?parseInt(e,10):0}function M(e,t){let l=e/t;return isNaN(l)?0:l}function H(e){let t=M(e.viewport,e.content),l=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-l)*t,18)}function U(e,t,l="ltr"){let r=H(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-s,n=t.content-t.viewport,i=(0,d.clamp)(e,"ltr"===l?[0,n]:[-1*n,0]);return $([0,n],[0,a-r])(i)}function $(e,t){return l=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(l-e[0])}}var F=(e,t=()=>{})=>{let l={left:e.scrollLeft,top:e.scrollTop},r=0;return!function s(){let a={left:e.scrollLeft,top:e.scrollTop},n=l.left!==a.left,i=l.top!==a.top;(n||i)&&t(),l=a,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function O(e,t){let r=(0,i.useCallbackRef)(e),s=l.useRef(0);return l.useEffect(()=>()=>window.clearTimeout(s.current),[]),l.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function X(e,t){let l=(0,i.useCallbackRef)(t);(0,c.useLayoutEffect)(()=>{let t=0;if(e){let r=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(l)});return r.observe(e),()=>{window.cancelAnimationFrame(t),r.unobserve(e)}}},[e,l])}var V=e.i(282141);let W=l.forwardRef(({className:e,children:l,...r},s)=>(0,t.jsxs)(v,{ref:s,className:(0,V.cn)("relative overflow-hidden",e),...r,children:[(0,t.jsx)(j,{className:"h-full w-full rounded-[inherit]",children:l}),(0,t.jsx)(K,{}),(0,t.jsx)(I,{})]}));W.displayName=v.displayName;let K=l.forwardRef(({className:e,orientation:l="vertical",...r},s)=>(0,t.jsx)(b,{ref:s,orientation:l,className:(0,V.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:(0,t.jsx)(P,{className:"relative flex-1 rounded-full bg-border"})}));K.displayName=b.displayName,e.s(["ScrollArea",()=>W],907434)},553426,e=>{"use strict";let t=(0,e.i(410587).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],553426)},185419,e=>{"use strict";let t=(0,e.i(410587).default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);e.s(["ArrowUpDown",()=>t],185419)},695817,e=>{"use strict";let t=(0,e.i(410587).default)("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);e.s(["KeyRound",()=>t],695817)},295588,e=>{"use strict";let t=(0,e.i(410587).default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);e.s(["UserX",()=>t],295588)},760165,e=>{"use strict";var t=e.i(722679),l=e.i(340915),r=e.i(795988),s=e.i(476817),a=e.i(341695),n=e.i(352776),i=e.i(316264),o=e.i(191569),c=e.i(514133),d=e.i(538892),u=e.i(45778),m=e.i(816654),h=e.i(907434),x=e.i(129432),p=e.i(429760),g=e.i(263229),v=e.i(773510),f=e.i(831833),j=e.i(554369),w=e.i(396064),b=e.i(15098),y=e.i(745083),N=e.i(401148),C=e.i(501259),S=e.i(994500);let k=a.z.object({email:a.z.string().email("Invalid email"),display_name:a.z.string().min(2,"Name required"),title:a.z.string().optional(),role:a.z.string().optional(),is_primary:a.z.boolean().optional().default(!1)}),A=a.z.object({entity_type:a.z.enum(["investor","arranger","lawyer","introducer","partner","commercial_partner"]),entity_id:a.z.string().optional(),create_entities:a.z.boolean().optional().default(!0),invites:a.z.array(k).min(1,"At least one invite required")}),D={investor:"Investors",arranger:"Arrangers",lawyer:"Law Firms",introducer:"Introducers",partner:"Partners",commercial_partner:"Commercial Partners"},T={investor:[{value:"admin",label:"Admin"},{value:"member",label:"Member"}],arranger:[{value:"admin",label:"Admin"},{value:"member",label:"Member"}],lawyer:[{value:"admin",label:"Admin"},{value:"member",label:"Member"}],partner:[{value:"admin",label:"Admin"},{value:"member",label:"Member"}],introducer:[{value:"admin",label:"Admin"},{value:"contact",label:"Contact"}],commercial_partner:[{value:"admin",label:"Admin"},{value:"contact",label:"Contact"}]};function R({open:e,onOpenChange:a,onSuccess:k,defaultEntityType:R="investor",existingEntityId:E,existingEntityName:P}){let[L,_]=(0,l.useState)(!1),[I,z]=(0,l.useState)(null),[B,M]=(0,l.useState)(""),{register:H,handleSubmit:U,control:$,watch:F,setValue:O,reset:X,formState:{errors:V}}=(0,r.useForm)({resolver:(0,s.zodResolver)(A),defaultValues:{entity_type:R,entity_id:E,create_entities:!E,invites:[{email:"",display_name:"",title:"",is_primary:!0}]}}),{fields:W,append:K,remove:Y}=(0,r.useFieldArray)({control:$,name:"invites"}),q=F("entity_type"),J=F("create_entities"),G=(0,l.useCallback)(()=>{let e=B.trim().split("\n").filter(e=>e.trim()),t=[];for(let l of e){let e=l.split(",").map(e=>e.trim());if(e.length>=2){let l=e[0],r=e[1],s=e[2]||void 0;l.includes("@")&&r.length>=2&&t.push({email:l,display_name:r,title:s,is_primary:0===t.length})}}t.length>0?(O("invites",t),S.toast.success(`Parsed ${t.length} invites from CSV`)):S.toast.error("No valid invites found. Format: email, name, title (optional)")},[B,O]),Q=async e=>{_(!0),z(null);try{let t=await fetch("/api/admin/batch-invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),l=await t.json();if(!t.ok)throw Error(l.error||"Batch invite failed");z(l.results),0===l.failed?S.toast.success(`Successfully invited ${l.successful} users`):S.toast.warning(`Invited ${l.successful} users, ${l.failed} failed`),k?.()}catch(e){console.error("Batch invite error:",e),S.toast.error(e instanceof Error?e.message:"Batch invite failed")}finally{_(!1)}},Z=()=>{X(),z(null),M(""),a(!1)};if(I){let l=I.filter(e=>e.success).length,r=I.filter(e=>!e.success).length;return(0,t.jsx)(n.Dialog,{open:e,onOpenChange:Z,children:(0,t.jsxs)(n.DialogContent,{className:"sm:max-w-[600px]",children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsxs)(n.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(C.Users,{className:"h-5 w-5"}),"Batch Invite Results"]}),(0,t.jsxs)(n.DialogDescription,{children:[l," successful, ",r," failed"]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 bg-green-50 dark:bg-green-900/20 rounded-lg p-4 text-center",children:[(0,t.jsx)(b.CheckCircle2,{className:"h-8 w-8 mx-auto text-green-600 mb-2"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:l}),(0,t.jsx)("div",{className:"text-sm text-green-700 dark:text-green-400",children:"Successful"})]}),(0,t.jsxs)("div",{className:"flex-1 bg-red-50 dark:bg-red-900/20 rounded-lg p-4 text-center",children:[(0,t.jsx)(y.XCircle,{className:"h-8 w-8 mx-auto text-red-600 mb-2"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:r}),(0,t.jsx)("div",{className:"text-sm text-red-700 dark:text-red-400",children:"Failed"})]})]}),(0,t.jsx)(h.ScrollArea,{className:"h-[300px] border rounded-lg",children:(0,t.jsx)("div",{className:"p-4 space-y-2",children:I.map((e,l)=>(0,t.jsxs)("div",{className:`flex items-center justify-between p-3 rounded-lg ${e.success?"bg-green-50 dark:bg-green-900/10":"bg-red-50 dark:bg-red-900/10"}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e.success?(0,t.jsx)(b.CheckCircle2,{className:"h-5 w-5 text-green-600"}):(0,t.jsx)(y.XCircle,{className:"h-5 w-5 text-red-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.email}),e.error&&(0,t.jsx)("div",{className:"text-sm text-red-600",children:e.error})]})]}),e.success&&(0,t.jsx)(x.Badge,{variant:e.is_new_user?"default":"secondary",children:e.is_new_user?"New User":"Linked"})]},l))})})]}),(0,t.jsx)(n.DialogFooter,{children:(0,t.jsx)(i.Button,{onClick:Z,children:"Close"})})]})})}return(0,t.jsx)(n.Dialog,{open:e,onOpenChange:Z,children:(0,t.jsxs)(n.DialogContent,{className:"sm:max-w-[700px] max-h-[90vh]",children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsxs)(n.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(C.Users,{className:"h-5 w-5"}),"Batch Invite Users"]}),(0,t.jsx)(n.DialogDescription,{children:P?`Invite multiple users to ${P}`:"Invite multiple users and create new entities for each"})]}),(0,t.jsxs)(p.Tabs,{defaultValue:"manual",className:"w-full",id:"batch-invite-tabs",children:[(0,t.jsxs)(p.TabsList,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(p.TabsTrigger,{value:"manual",children:"Manual Entry"}),(0,t.jsx)(p.TabsTrigger,{value:"csv",children:"CSV Import"})]}),(0,t.jsxs)(p.TabsContent,{value:"csv",className:"space-y-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{children:"Paste CSV Data"}),(0,t.jsx)(m.Textarea,{placeholder:"email@example.com, John Smith, Managing Director another@example.com, Jane Doe, Partner ...",value:B,onChange:e=>M(e.target.value),rows:6,className:"font-mono text-sm"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Format: email, display_name, title (optional) - one per line"})]}),(0,t.jsxs)(i.Button,{type:"button",onClick:G,variant:"secondary",children:[(0,t.jsx)(w.Upload,{className:"mr-2 h-4 w-4"}),"Parse CSV"]})]}),(0,t.jsx)(p.TabsContent,{value:"manual",className:"mt-4",children:(0,t.jsxs)("form",{onSubmit:U(Q),className:"space-y-4",children:[!E&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{children:"Entity Type"}),(0,t.jsxs)(d.Select,{value:q,onValueChange:e=>O("entity_type",e),children:[(0,t.jsx)(d.SelectTrigger,{children:(0,t.jsx)(d.SelectValue,{placeholder:"Select type"})}),(0,t.jsx)(d.SelectContent,{children:Object.entries(D).map(([e,l])=>(0,t.jsx)(d.SelectItem,{value:e,children:l},e))})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(c.Label,{className:"text-sm font-medium",children:"Create New Entities"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Create a new ",q," for each invite"]})]}),(0,t.jsx)(u.Switch,{checked:J,onCheckedChange:e=>O("create_entities",e)})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(c.Label,{children:["Invites (",W.length,")"]}),(0,t.jsxs)(i.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{K({email:"",display_name:"",title:"",is_primary:!1})},disabled:W.length>=100,children:[(0,t.jsx)(f.Plus,{className:"mr-1 h-4 w-4"}),"Add"]})]}),(0,t.jsx)(h.ScrollArea,{className:"h-[300px] border rounded-lg p-4",children:(0,t.jsx)("div",{className:"space-y-4",children:W.map((e,l)=>(0,t.jsxs)("div",{className:"grid grid-cols-[1fr,1fr,auto,auto] gap-2 items-start",role:"group","aria-label":`Invite ${l+1}`,children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:`invite-email-${l}`,className:"sr-only",children:["Email address for invite ",l+1]}),(0,t.jsx)(o.Input,{id:`invite-email-${l}`,placeholder:"email@example.com",...H(`invites.${l}.email`),className:V.invites?.[l]?.email?"border-red-500":"","aria-invalid":!!V.invites?.[l]?.email,"aria-describedby":V.invites?.[l]?.email?`email-error-${l}`:void 0}),V.invites?.[l]?.email&&(0,t.jsx)("p",{id:`email-error-${l}`,className:"text-xs text-red-500 mt-1",role:"alert",children:V.invites[l]?.email?.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:`invite-name-${l}`,className:"sr-only",children:["Display name for invite ",l+1]}),(0,t.jsx)(o.Input,{id:`invite-name-${l}`,placeholder:"Display Name",...H(`invites.${l}.display_name`),className:V.invites?.[l]?.display_name?"border-red-500":"","aria-invalid":!!V.invites?.[l]?.display_name})]}),(0,t.jsxs)(d.Select,{value:F(`invites.${l}.role`)||"member",onValueChange:e=>O(`invites.${l}.role`,e),children:[(0,t.jsx)(d.SelectTrigger,{className:"w-[100px]","aria-label":`Role for invite ${l+1}`,children:(0,t.jsx)(d.SelectValue,{})}),(0,t.jsx)(d.SelectContent,{children:T[q].map(e=>(0,t.jsx)(d.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>Y(l),disabled:1===W.length,"aria-label":`Remove invite ${l+1}`,children:(0,t.jsx)(j.Trash2,{className:"h-4 w-4 text-muted-foreground"})})]},e.id))})})]}),(0,t.jsxs)(n.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,t.jsx)(i.Button,{type:"button",variant:"outline",onClick:Z,children:"Cancel"}),(0,t.jsx)(i.Button,{type:"submit",disabled:L,children:L?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending ",W.length," Invites..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Mail,{className:"mr-2 h-4 w-4"}),"Send ",W.length," Invites"]})})]})]})})]}),W.length>1&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-muted rounded-lg flex items-center gap-2",children:[(0,t.jsx)(N.AlertCircle,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[W.length," invites ready to send"]})]})]})})}e.s(["BatchInviteDialog",()=>R])},340567,e=>{"use strict";var t=e.i(722679),l=e.i(340915),r=e.i(603274),s=e.i(615595),a=e.i(729416),n=e.i(237635),i=e.i(316264),o=e.i(129432),c=e.i(312692),d=e.i(74434),u=e.i(191569),m=e.i(510166),h=e.i(908925),x=e.i(335631),p=e.i(93502),g=e.i(56213),v=e.i(661521),f=e.i(758171),j=e.i(197098),w=e.i(849110),b=e.i(704477),y=e.i(496383),N=e.i(295588),C=e.i(553426),S=e.i(695817),k=e.i(185419),A=e.i(501259),D=e.i(750809),T=e.i(432598),R=e.i(310556),E=e.i(913127),P=e.i(382021),L=e.i(761722),_=e.i(619324),I=e.i(335994),z=e.i(971743),B=e.i(994500),M=e.i(820417),H=e.i(771750),U=e.i(137533),$=e.i(282141),F=e.i(760165);let O=[{value:"investor",label:"Investor"},{value:"staff_admin",label:"Staff Admin"},{value:"staff_ops",label:"Staff Ops"},{value:"staff_rm",label:"Staff RM"},{value:"ceo",label:"CEO"}],X=[{value:"active",label:"Active"},{value:"pending",label:"Pending"},{value:"inactive",label:"Inactive"},{value:"deactivated",label:"Deactivated"}],V=[{value:"investor",label:"Investor"},{value:"arranger",label:"Arranger"},{value:"introducer",label:"Introducer"},{value:"partner",label:"Partner"},{value:"lawyer",label:"Lawyer"}],W=[{value:"pending",label:"Pending"},{value:"in_review",label:"In Review"},{value:"completed",label:"Completed"},{value:"rejected",label:"Rejected"}],K=[{value:"yes",label:"Has Entities"},{value:"no",label:"No Entities"}];function Y({title:e,options:r,selected:s,onSelect:a,className:n}){let[c,d]=(0,l.useState)(!1);return(0,t.jsxs)(x.Popover,{open:c,onOpenChange:d,children:[(0,t.jsx)(x.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",className:(0,$.cn)("h-9 border-dashed",s.length>0&&"border-primary",n),children:[(0,t.jsx)(P.Filter,{className:"mr-2 h-4 w-4"}),e,s.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Separator,{orientation:"vertical",className:"mx-2 h-4"}),(0,t.jsx)(o.Badge,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:s.length})]}),(0,t.jsx)(E.ChevronsUpDown,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,t.jsx)(x.PopoverContent,{className:"w-52 p-0",align:"start",children:(0,t.jsxs)(p.Command,{children:[(0,t.jsx)(p.CommandInput,{placeholder:`Search ${e.toLowerCase()}...`}),(0,t.jsxs)(p.CommandList,{children:[(0,t.jsx)(p.CommandEmpty,{children:"No results found."}),(0,t.jsx)(p.CommandGroup,{children:r.map(e=>{let l=s.includes(e.value);return(0,t.jsxs)(p.CommandItem,{onSelect:()=>{var t;return t=e.value,void(s.includes(t)?a(s.filter(e=>e!==t)):a([...s,t]))},children:[(0,t.jsx)("div",{className:(0,$.cn)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",l?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:(0,t.jsx)(R.Check,{className:"h-3 w-3"})}),(0,t.jsx)("span",{children:e.label})]},e.value)})}),s.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.CommandSeparator,{}),(0,t.jsx)(p.CommandGroup,{children:(0,t.jsx)(p.CommandItem,{onSelect:()=>{a([]),d(!1)},className:"justify-center text-center",children:"Clear selection"})})]})]})]})})]})}let q=e=>{if(e.isDeleted)return"Deactivated";let t=new Date(Date.now()-2592e6);return e.lastLoginAt&&new Date(e.lastLoginAt)>t?"Active":e.lastLoginAt?"Inactive":"Pending"},J=e=>({ceo:"CEO",staff_admin:"Staff Admin",staff_ops:"Staff Ops",staff_rm:"Staff RM",investor:"Investor"})[e]||e;function G(){return(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(n.TableHeader,{children:(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableHead,{className:"w-12",children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-4"})}),(0,t.jsx)(n.TableHead,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-24"})}),(0,t.jsx)(n.TableHead,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-32"})}),(0,t.jsx)(n.TableHead,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-16"})}),(0,t.jsx)(n.TableHead,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-16"})}),(0,t.jsx)(n.TableHead,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-24"})}),(0,t.jsx)(n.TableHead,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-24"})}),(0,t.jsx)(n.TableHead,{className:"w-12"})]})}),(0,t.jsx)(n.TableBody,{children:Array.from({length:10}).map((e,l)=>(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-4"})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(g.Skeleton,{className:"h-8 w-8 rounded-full"}),(0,t.jsx)(g.Skeleton,{className:"h-4 w-32"})]})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-40"})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(g.Skeleton,{className:"h-5 w-16 rounded-full"})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(g.Skeleton,{className:"h-5 w-16 rounded-full"})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-24"})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(g.Skeleton,{className:"h-4 w-24"})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(g.Skeleton,{className:"h-8 w-8"})})]},l))})]})})})}function Q(){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[(0,t.jsx)("div",{className:"rounded-full bg-muted p-4 mb-4",children:(0,t.jsx)(A.Users,{className:"h-8 w-8 text-muted-foreground"})}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-1",children:"No users found"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center max-w-sm",children:"No users match the current filters. Try adjusting your search or filter criteria."})]})}function Z(){let e=(0,r.useRouter)(),x=(0,r.usePathname)(),p=(0,r.useSearchParams)(),[g,v]=(0,l.useState)(p.get("search")||""),[A,R]=(0,l.useState)(p.get("role")?.split(",").filter(Boolean)||[]),[E,P]=(0,l.useState)(p.get("status")?.split(",").filter(Boolean)||[]),[Z,ee]=(0,l.useState)(p.get("entityType")?.split(",").filter(Boolean)||[]),[et,el]=(0,l.useState)(p.get("kycStatus")?.split(",").filter(Boolean)||[]),[er,es]=(0,l.useState)(p.get("hasEntities")?.split(",").filter(Boolean)||[]),[ea,en]=(0,l.useState)([]),[ei,eo]=(0,l.useState)(!0),[ec,ed]=(0,l.useState)(null),[eu,em]=(0,l.useState)({page:1,pageSize:50,totalPages:1,totalCount:0}),[eh,ex]=(0,l.useState)([{id:"createdAt",desc:!0}]),[ep,eg]=(0,l.useState)({}),[ev,ef]=(0,l.useState)(!1),[ej,ew]=(0,l.useState)(!1),[eb,ey]=(0,l.useState)(!1),[eN,eC]=(0,l.useState)(null),[eS,ek]=(0,l.useState)(!1),[eA,eD]=(0,l.useState)(!1),[eT,eR]=(0,l.useState)(!1),[eE,eP]=(0,l.useState)(!1),eL=(0,l.useMemo)(()=>{let e=Object.keys(ep);return ea.filter(t=>e.includes(t.id))},[ep,ea]),e_=(0,l.useCallback)(()=>{if(0===eL.length)return;let e=new Blob([["ID,Name,Email,Role,Status",...eL.map(e=>[e.id,e.displayName,e.email,J(e.systemRole),q(e)]).map(e=>e.map(e=>`"${e}"`).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),l=URL.createObjectURL(e);t.setAttribute("href",l),t.setAttribute("download",`users-export-${(0,U.format)(new Date,"yyyy-MM-dd")}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(l)},[eL]),eI=function(e,t){let[r,s]=(0,l.useState)(e);return(0,l.useEffect)(()=>{let t=setTimeout(()=>{s(e)},300);return()=>{clearTimeout(t)}},[e,300]),r}(g,0),ez=(0,l.useMemo)(()=>eI.length>0||A.length>0||E.length>0||Z.length>0||et.length>0||er.length>0,[eI,A,E,Z,et,er]),eB=(0,l.useCallback)(t=>{let l=new URLSearchParams(p.toString());void 0!==t.search&&(t.search?l.set("search",t.search):l.delete("search")),void 0!==t.role&&(t.role.length>0?l.set("role",t.role.join(",")):l.delete("role")),void 0!==t.status&&(t.status.length>0?l.set("status",t.status.join(",")):l.delete("status")),void 0!==t.entityType&&(t.entityType.length>0?l.set("entityType",t.entityType.join(",")):l.delete("entityType")),void 0!==t.page&&(t.page>1?l.set("page",t.page.toString()):l.delete("page"));let r=l.toString();e.push(`${x}${r?`?${r}`:""}`)},[x,e,p]),eM=(0,l.useCallback)(async(e=1)=>{try{eo(!0),ed(null);let t=new URLSearchParams({page:e.toString(),pageSize:eu.pageSize.toString(),sortBy:"createdAt",sortOrder:"desc"});eI&&t.set("search",eI),A.length>0&&t.set("role",A.join(",")),E.length>0&&t.set("status",E.join(",")),Z.length>0&&t.set("entityType",Z.join(","));let l=await fetch(`/api/admin/users?${t}`),r=await l.json();if(!r.success)throw Error(r.error||"Failed to fetch users");en(r.data||[]),r.pagination&&em(r.pagination)}catch(e){ed(e instanceof Error?e.message:"An error occurred")}finally{eo(!1)}},[eu.pageSize,eI,A,E,Z]),eH=(0,l.useCallback)(async()=>{if(0!==eL.length){ew(!0);try{let e=await fetch("/api/admin/users/batch-deactivate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userIds:eL.map(e=>e.id)})}),t=await e.json();if(!t.success)throw Error(t.error||"Failed to deactivate users");B.toast.success("Users deactivated",{description:`${eL.length} user${eL.length>1?"s":""} deactivated successfully.`}),eg({}),ef(!1),eM(eu.page)}catch(e){B.toast.error("Failed to deactivate users",{description:e instanceof Error?e.message:"An error occurred"})}finally{ew(!1)}}},[eL,eM,eu.page]),eU=(0,l.useCallback)(()=>{eM(eu.page)},[eM,eu.page]),e$=(0,l.useCallback)(t=>{e.push(`/versotech_admin/users/${t.id}`)},[e]),eF=(0,l.useCallback)(e=>{eC(e),ek(!0)},[]),eO=(0,l.useCallback)(e=>{eC(e),eD(!0)},[]),eX=(0,l.useCallback)(e=>{eC(e),eR(!0)},[]),eV=(0,l.useCallback)(async()=>{if(eN){eP(!0);try{let e=await fetch(`/api/admin/users/${eN.id}/toggle-lock`,{method:"PATCH"}),t=await e.json();if(!t.success)throw Error(t.error||"Failed to lock user");B.toast.success("Account locked",{description:`${eN.displayName}'s account has been locked.`}),ek(!1),eC(null),eM(eu.page)}catch(e){B.toast.error("Failed to lock account",{description:e instanceof Error?e.message:"An error occurred"})}finally{eP(!1)}}},[eN,eM,eu.page]),eW=(0,l.useCallback)(async()=>{if(eN){eP(!0);try{let e=await fetch(`/api/admin/users/${eN.id}/reset-password`,{method:"POST"}),t=await e.json();if(!t.success)throw Error(t.error||"Failed to send password reset");B.toast.success("Password reset email sent",{description:`A password reset link has been sent to ${eN.email}.`}),eD(!1),eC(null)}catch(e){B.toast.error("Failed to send password reset",{description:e instanceof Error?e.message:"An error occurred"})}finally{eP(!1)}}},[eN]),eK=(0,l.useCallback)(async()=>{if(eN){eP(!0);try{let e=await fetch(`/api/admin/users/${eN.id}/deactivate`,{method:"PATCH"}),t=await e.json();if(!t.success)throw Error(t.error||"Failed to deactivate user");B.toast.success("User deactivated",{description:`${eN.displayName} has been deactivated.`}),eR(!1),eC(null),eM(eu.page)}catch(e){B.toast.error("Failed to deactivate user",{description:e instanceof Error?e.message:"An error occurred"})}finally{eP(!1)}}},[eN,eM,eu.page]),eY=(0,l.useMemo)(()=>{let e;return e={onEdit:e$,onLock:eF,onResetPassword:eO,onDeactivate:eX},[{id:"select",header:({table:e})=>(0,t.jsx)(c.Checkbox,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t),"aria-label":"Select all"}),cell:({row:e})=>(0,t.jsx)(c.Checkbox,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{accessorKey:"displayName",header:({column:e})=>(0,t.jsxs)(i.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["User",(0,t.jsx)(k.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let l=e.original;return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(d.Avatar,{className:"h-8 w-8",children:[(0,t.jsx)(d.AvatarImage,{src:l.avatarUrl||void 0,alt:l.displayName}),(0,t.jsx)(d.AvatarFallback,{className:"text-xs",children:l.displayName.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(M.default,{href:`/versotech_admin/users/${l.id}`,className:"font-medium hover:underline",children:l.displayName}),l.isSuperAdmin&&(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Super Admin"})]})]})}},{accessorKey:"email",header:({column:e})=>(0,t.jsxs)(i.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Email",(0,t.jsx)(k.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,t.jsx)("span",{className:"text-muted-foreground",children:e.original.email})},{accessorKey:"entityCount",header:({column:e})=>(0,t.jsxs)(i.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:[(0,t.jsx)(z.Building2,{className:"mr-1 h-4 w-4"}),"Entities",(0,t.jsx)(k.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let l=e.original.entityCount;return(0,t.jsx)(o.Badge,{variant:l>0?"secondary":"outline",children:l})}},{accessorKey:"systemRole",header:"Role",cell:({row:e})=>{let l=e.original.systemRole;return(0,t.jsx)(o.Badge,{variant:"ceo"===l?"default":l.startsWith("staff_")?"secondary":"outline",children:J(l)})}},{id:"status",header:"Status",cell:({row:e})=>{let l=e.original,{variant:r,className:s}=(e=>{if(e.isDeleted)return{variant:"destructive"};let t=new Date(Date.now()-2592e6);return e.lastLoginAt&&new Date(e.lastLoginAt)>t?{variant:"default",className:"bg-green-500 dark:bg-green-600 hover:bg-green-500/80 dark:hover:bg-green-600/80"}:e.lastLoginAt?{variant:"outline"}:{variant:"secondary",className:"bg-yellow-500 dark:bg-yellow-600 text-white hover:bg-yellow-500/80 dark:hover:bg-yellow-600/80"}})(l);return(0,t.jsx)(o.Badge,{variant:r,className:s,children:q(l)})}},{accessorKey:"lastLoginAt",header:({column:e})=>(0,t.jsxs)(i.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Last Active",(0,t.jsx)(k.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let l=e.original.lastLoginAt;return l?(0,t.jsx)("span",{className:"text-muted-foreground",children:(0,H.formatDistanceToNow)(new Date(l),{addSuffix:!0})}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"Never"})}},{accessorKey:"createdAt",header:({column:e})=>(0,t.jsxs)(i.Button,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"-ml-4",children:["Created",(0,t.jsx)(k.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,t.jsx)("span",{className:"text-muted-foreground",children:(0,U.format)(new Date(e.original.createdAt),"MMM d, yyyy")})},{id:"actions",header:"",cell:({row:l})=>{let r=l.original;return(0,t.jsxs)(m.DropdownMenu,{children:[(0,t.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(i.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(w.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,t.jsxs)(m.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(m.DropdownMenuLabel,{children:"Actions"}),(0,t.jsx)(m.DropdownMenuSeparator,{}),(0,t.jsx)(m.DropdownMenuItem,{asChild:!0,children:(0,t.jsxs)(M.default,{href:`/versotech_admin/users/${r.id}`,children:[(0,t.jsx)(y.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]})}),(0,t.jsxs)(m.DropdownMenuItem,{onClick:()=>e.onEdit(r),children:[(0,t.jsx)(b.User,{className:"mr-2 h-4 w-4"}),"Edit Profile"]}),(0,t.jsx)(m.DropdownMenuSeparator,{}),(0,t.jsxs)(m.DropdownMenuItem,{onClick:()=>e.onLock(r),className:"text-yellow-600 dark:text-yellow-500",children:[(0,t.jsx)(C.Lock,{className:"mr-2 h-4 w-4"}),"Lock Account"]}),(0,t.jsxs)(m.DropdownMenuItem,{onClick:()=>e.onResetPassword(r),children:[(0,t.jsx)(S.KeyRound,{className:"mr-2 h-4 w-4"}),"Reset Password"]}),(0,t.jsx)(m.DropdownMenuSeparator,{}),(0,t.jsxs)(m.DropdownMenuItem,{onClick:()=>e.onDeactivate(r),className:"text-destructive",children:[(0,t.jsx)(N.UserX,{className:"mr-2 h-4 w-4"}),"Deactivate"]})]})]})}}]},[e$,eF,eO,eX]);(0,l.useEffect)(()=>{eM(1),eB({search:eI,role:A,status:E,entityType:Z,page:1})},[eI,A,E,Z]);let eq=(0,s.useReactTable)({data:ea,columns:eY,onSortingChange:ex,getCoreRowModel:(0,a.getCoreRowModel)(),getSortedRowModel:(0,a.getSortedRowModel)(),onRowSelectionChange:eg,state:{sorting:eh,rowSelection:ep},getRowId:e=>e.id}),eJ=(eu.page-1)*eu.pageSize+1,eG=Math.min(eu.page*eu.pageSize,eu.totalCount);return ec?(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4",children:[(0,t.jsx)("h3",{className:"font-medium text-destructive",children:"Error loading users"}),(0,t.jsx)("p",{className:"text-sm text-destructive/80 mt-1",children:ec}),(0,t.jsx)(i.Button,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>eM(),children:"Try Again"})]})}):(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"All Users"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage platform users and their access"})]}),(0,t.jsxs)(i.Button,{onClick:()=>ey(!0),children:[(0,t.jsx)(I.UserPlus,{className:"h-4 w-4 mr-2"}),"Invite"]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,t.jsx)(D.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,t.jsx)(u.Input,{placeholder:"Search by name or email...",value:g,onChange:e=>v(e.target.value),className:"pl-9 h-9"}),g&&(0,t.jsx)(i.Button,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0",onClick:()=>v(""),children:(0,t.jsx)(T.X,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)(Y,{title:"Role",options:O,selected:A,onSelect:R}),(0,t.jsx)(Y,{title:"Status",options:X,selected:E,onSelect:P}),(0,t.jsx)(Y,{title:"KYC Status",options:W,selected:et,onSelect:el}),(0,t.jsx)(Y,{title:"Entities",options:K,selected:er,onSelect:es}),(0,t.jsx)(Y,{title:"Entity Type",options:V,selected:Z,onSelect:ee})]})]}),ez&&(0,t.jsxs)(i.Button,{variant:"ghost",size:"sm",onClick:()=>{v(""),R([]),P([]),ee([]),el([]),es([])},className:"h-9",children:[(0,t.jsx)(T.X,{className:"mr-2 h-4 w-4"}),"Clear filters"]})]}),ez&&(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),eI&&(0,t.jsxs)(o.Badge,{variant:"secondary",className:"rounded-sm px-2 py-1",children:['Search: "',eI,'"',(0,t.jsx)("button",{className:"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20",onClick:()=>v(""),children:(0,t.jsx)(T.X,{className:"h-3 w-3"})})]}),A.map(e=>(0,t.jsxs)(o.Badge,{variant:"secondary",className:"rounded-sm px-2 py-1",children:["Role: ",O.find(t=>t.value===e)?.label||e,(0,t.jsx)("button",{className:"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20",onClick:()=>R(A.filter(t=>t!==e)),children:(0,t.jsx)(T.X,{className:"h-3 w-3"})})]},e)),E.map(e=>(0,t.jsxs)(o.Badge,{variant:"secondary",className:"rounded-sm px-2 py-1",children:["Status: ",X.find(t=>t.value===e)?.label||e,(0,t.jsx)("button",{className:"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20",onClick:()=>P(E.filter(t=>t!==e)),children:(0,t.jsx)(T.X,{className:"h-3 w-3"})})]},e)),Z.map(e=>(0,t.jsxs)(o.Badge,{variant:"secondary",className:"rounded-sm px-2 py-1",children:["Entity: ",V.find(t=>t.value===e)?.label||e,(0,t.jsx)("button",{className:"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20",onClick:()=>ee(Z.filter(t=>t!==e)),children:(0,t.jsx)(T.X,{className:"h-3 w-3"})})]},e)),et.map(e=>(0,t.jsxs)(o.Badge,{variant:"secondary",className:"rounded-sm px-2 py-1",children:["KYC: ",W.find(t=>t.value===e)?.label||e,(0,t.jsx)("button",{className:"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20",onClick:()=>el(et.filter(t=>t!==e)),children:(0,t.jsx)(T.X,{className:"h-3 w-3"})})]},e)),er.map(e=>(0,t.jsxs)(o.Badge,{variant:"secondary",className:"rounded-sm px-2 py-1",children:[K.find(t=>t.value===e)?.label||e,(0,t.jsx)("button",{className:"ml-1.5 ring-offset-background rounded-full outline-none hover:bg-muted-foreground/20",onClick:()=>es(er.filter(t=>t!==e)),children:(0,t.jsx)(T.X,{className:"h-3 w-3"})})]},e))]}),ei?(0,t.jsx)(G,{}):0===ea.length?(0,t.jsx)(Q,{}):(0,t.jsxs)("div",{className:(0,$.cn)("space-y-4",eL.length>0&&"pb-20"),children:[(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(n.TableHeader,{children:eq.getHeaderGroups().map(e=>(0,t.jsx)(n.TableRow,{children:e.headers.map(e=>(0,t.jsx)(n.TableHead,{children:e.isPlaceholder?null:(0,s.flexRender)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,t.jsx)(n.TableBody,{children:eq.getRowModel().rows.length?eq.getRowModel().rows.map(e=>(0,t.jsx)(n.TableRow,{"data-state":e.getIsSelected()&&"selected",className:"hover:bg-muted/50",children:e.getVisibleCells().map(e=>(0,t.jsx)(n.TableCell,{children:(0,s.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,t.jsx)(n.TableRow,{children:(0,t.jsx)(n.TableCell,{colSpan:eY.length,className:"h-24 text-center",children:"No users found."})})})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:eu.totalCount>0?(0,t.jsxs)(t.Fragment,{children:["Showing ",eJ,"-",eG," of ",eu.totalCount," users"]}):(0,t.jsx)(t.Fragment,{children:"No users found"})}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>{if(eu.page>1){let e=eu.page-1;eM(e),eB({page:e})}},disabled:eu.page<=1,children:[(0,t.jsx)(f.ChevronLeft,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground px-2",children:["Page ",eu.page," of ",eu.totalPages]}),(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>{if(eu.page<eu.totalPages){let e=eu.page+1;eM(e),eB({page:e})}},disabled:eu.page>=eu.totalPages,children:["Next",(0,t.jsx)(j.ChevronRight,{className:"h-4 w-4 ml-1"})]})]})]})]}),eL.length>0&&(0,t.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-background border-t shadow-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-3 max-w-[calc(100%-var(--sidebar-width,16rem))] ml-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:[eL.length," user",eL.length>1?"s":""," selected"]}),(0,t.jsx)(i.Button,{variant:"ghost",size:"sm",onClick:()=>eg({}),children:"Clear"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:e_,children:[(0,t.jsx)(L.Download,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),(0,t.jsxs)(i.Button,{variant:"destructive",size:"sm",onClick:()=>ef(!0),children:[(0,t.jsx)(N.UserX,{className:"h-4 w-4 mr-2"}),"Deactivate"]})]})]})}),(0,t.jsx)(h.AlertDialog,{open:ev,onOpenChange:ef,children:(0,t.jsxs)(h.AlertDialogContent,{children:[(0,t.jsxs)(h.AlertDialogHeader,{children:[(0,t.jsxs)(h.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(_.AlertTriangle,{className:"h-5 w-5 text-destructive"}),"Deactivate Users"]}),(0,t.jsx)(h.AlertDialogDescription,{asChild:!0,children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("p",{children:["Are you sure you want to deactivate ",eL.length," user",eL.length>1?"s":"","? They will no longer be able to access the platform."]}),(0,t.jsx)("div",{className:"rounded-md bg-muted p-3 max-h-32 overflow-y-auto",children:(0,t.jsxs)("ul",{className:"text-sm space-y-1",children:[eL.slice(0,10).map(e=>(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium",children:e.displayName}),(0,t.jsxs)("span",{className:"text-muted-foreground",children:["(",e.email,")"]})]},e.id)),eL.length>10&&(0,t.jsxs)("li",{className:"text-muted-foreground",children:["...and ",eL.length-10," more"]})]})})]})})]}),(0,t.jsxs)(h.AlertDialogFooter,{children:[(0,t.jsx)(h.AlertDialogCancel,{disabled:ej,children:"Cancel"}),(0,t.jsx)(h.AlertDialogAction,{onClick:eH,disabled:ej,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:ej?"Deactivating...":"Deactivate"})]})]})}),(0,t.jsx)(F.BatchInviteDialog,{open:eb,onOpenChange:ey,onSuccess:eU}),(0,t.jsx)(h.AlertDialog,{open:eS,onOpenChange:ek,children:(0,t.jsxs)(h.AlertDialogContent,{children:[(0,t.jsxs)(h.AlertDialogHeader,{children:[(0,t.jsxs)(h.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(C.Lock,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-500"}),"Lock Account"]}),(0,t.jsxs)(h.AlertDialogDescription,{children:["Are you sure you want to lock ",(0,t.jsx)("strong",{children:eN?.displayName}),"'s account? They will be temporarily unable to access the platform."]})]}),(0,t.jsxs)(h.AlertDialogFooter,{children:[(0,t.jsx)(h.AlertDialogCancel,{disabled:eE,children:"Cancel"}),(0,t.jsx)(h.AlertDialogAction,{onClick:eV,disabled:eE,className:"bg-yellow-600 text-white hover:bg-yellow-600/90",children:eE?"Locking...":"Lock Account"})]})]})}),(0,t.jsx)(h.AlertDialog,{open:eA,onOpenChange:eD,children:(0,t.jsxs)(h.AlertDialogContent,{children:[(0,t.jsxs)(h.AlertDialogHeader,{children:[(0,t.jsxs)(h.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(S.KeyRound,{className:"h-5 w-5"}),"Reset Password"]}),(0,t.jsxs)(h.AlertDialogDescription,{children:["This will send a password reset email to ",(0,t.jsx)("strong",{children:eN?.email}),". The user will need to click the link in the email to set a new password."]})]}),(0,t.jsxs)(h.AlertDialogFooter,{children:[(0,t.jsx)(h.AlertDialogCancel,{disabled:eE,children:"Cancel"}),(0,t.jsx)(h.AlertDialogAction,{onClick:eW,disabled:eE,children:eE?"Sending...":"Send Reset Email"})]})]})}),(0,t.jsx)(h.AlertDialog,{open:eT,onOpenChange:eR,children:(0,t.jsxs)(h.AlertDialogContent,{children:[(0,t.jsxs)(h.AlertDialogHeader,{children:[(0,t.jsxs)(h.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(_.AlertTriangle,{className:"h-5 w-5 text-destructive"}),"Deactivate User"]}),(0,t.jsxs)(h.AlertDialogDescription,{children:["Are you sure you want to deactivate ",(0,t.jsx)("strong",{children:eN?.displayName}),"? They will no longer be able to access the platform."]})]}),(0,t.jsxs)(h.AlertDialogFooter,{children:[(0,t.jsx)(h.AlertDialogCancel,{disabled:eE,children:"Cancel"}),(0,t.jsx)(h.AlertDialogAction,{onClick:eK,disabled:eE,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:eE?"Deactivating...":"Deactivate"})]})]})})]})}e.s(["default",()=>Z])}]);