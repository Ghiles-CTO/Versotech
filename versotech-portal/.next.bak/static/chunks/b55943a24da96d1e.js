(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,676232,e=>{"use strict";var s=e.i(722679),t=e.i(340915),a=e.i(90613),i=e.i(316264),r=e.i(129432),n=e.i(429760),l=e.i(820417),d=e.i(396132),c=e.i(773510),o=e.i(957114),m=e.i(416469),x=e.i(971743),u=e.i(84065),h=e.i(704477),p=e.i(196767),g=e.i(119311),j=e.i(827178),v=e.i(501259),y=e.i(734213),f=e.i(603274),_=e.i(352776),N=e.i(191569),b=e.i(514133),w=e.i(538892),C=e.i(263229),S=e.i(994500);function T({investor:e,open:a,onOpenChange:r}){let n=(0,f.useRouter)(),[l,d]=(0,t.useState)(!1),[c,o]=(0,t.useState)([]),[m,u]=(0,t.useState)({type:e.type||"individual",email:e.email||"",phone:e.phone||"",country:e.country||"",tax_residency:e.tax_residency||"",primary_rm:e.primary_rm||"",first_name:e.first_name||"",middle_name:e.middle_name||"",last_name:e.last_name||"",legal_name:e.legal_name||"",display_name:e.display_name||"",country_of_incorporation:e.country_of_incorporation||"",representative_name:e.representative_name||"",representative_title:e.representative_title||""});(0,t.useEffect)(()=>{a&&(p(),u({type:e.type||"individual",email:e.email||"",phone:e.phone||"",country:e.country||"",tax_residency:e.tax_residency||"",primary_rm:e.primary_rm||"",first_name:e.first_name||"",middle_name:e.middle_name||"",last_name:e.last_name||"",legal_name:e.legal_name||"",display_name:e.display_name||"",country_of_incorporation:e.country_of_incorporation||"",representative_name:e.representative_name||"",representative_title:e.representative_title||""}))},[a,e]);let p=async()=>{try{let e=await fetch("/api/staff/available");if(e.ok){let s=await e.json();o(s.staff||[])}}catch(e){console.error("Failed to fetch staff members:",e)}},g=async s=>{if(s.preventDefault(),"individual"===m.type){if(!m.first_name.trim())return void S.toast.error("First name is required for individuals")}else if(!m.legal_name.trim())return void S.toast.error("Legal name is required");d(!0);try{let s,t={...m};s=m.type,"individual"===s&&(t.legal_name=[m.first_name.trim(),m.middle_name.trim(),m.last_name.trim()].filter(Boolean).join(" "),t.display_name.trim()||(t.display_name=t.legal_name));let a=await fetch(`/api/staff/investors/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to update investor")}S.toast.success("Investor updated successfully"),r(!1),n.refresh()}catch(s){let e=s instanceof Error?s.message:"Failed to update investor";S.toast.error(e)}finally{d(!1)}};return(0,s.jsx)(_.Dialog,{open:a,onOpenChange:r,children:(0,s.jsxs)(_.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(_.DialogHeader,{children:[(0,s.jsx)(_.DialogTitle,{className:"text-white",children:"Edit Investor"}),(0,s.jsx)(_.DialogDescription,{className:"text-gray-300",children:"Update investor profile information"})]}),(0,s.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"type",className:"text-white",children:["Investor Type ",(0,s.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,s.jsxs)(w.Select,{value:m.type,onValueChange:e=>u({...m,type:e}),children:[(0,s.jsx)(w.SelectTrigger,{children:(0,s.jsx)(w.SelectValue,{})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"individual",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.User,{className:"h-4 w-4"}),"Individual"]})}),(0,s.jsx)(w.SelectItem,{value:"entity",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Building2,{className:"h-4 w-4"}),"Entity"]})}),(0,s.jsx)(w.SelectItem,{value:"institutional",children:"Institutional"}),(0,s.jsx)(w.SelectItem,{value:"family_office",children:"Family Office"}),(0,s.jsx)(w.SelectItem,{value:"fund",children:"Fund"})]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"individual"===m.type?"A natural person investing in their own name":"A company, fund, or institutional entity"})]}),"individual"===m.type&&(0,s.jsxs)("div",{className:"space-y-4 p-4 rounded-lg border border-zinc-800 bg-zinc-900/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-300",children:[(0,s.jsx)(h.User,{className:"h-4 w-4"}),"Personal Information"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"first_name",className:"text-white",children:["First Name ",(0,s.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,s.jsx)(N.Input,{id:"first_name",value:m.first_name,onChange:e=>u({...m,first_name:e.target.value}),placeholder:"John",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"middle_name",className:"text-white",children:"Middle Name"}),(0,s.jsx)(N.Input,{id:"middle_name",value:m.middle_name,onChange:e=>u({...m,middle_name:e.target.value}),placeholder:"Michael",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"last_name",className:"text-white",children:"Last Name"}),(0,s.jsx)(N.Input,{id:"last_name",value:m.last_name,onChange:e=>u({...m,last_name:e.target.value}),placeholder:"Smith",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]}),(m.first_name||m.last_name)&&(0,s.jsxs)("div",{className:"text-xs text-gray-400 bg-zinc-800/50 px-3 py-2 rounded",children:["Legal name will be: ",(0,s.jsx)("span",{className:"text-white font-medium",children:[m.first_name,m.middle_name,m.last_name].filter(Boolean).join(" ")})]})]}),["entity","institutional","family_office","fund"].includes(m.type)&&(0,s.jsxs)("div",{className:"space-y-4 p-4 rounded-lg border border-zinc-800 bg-zinc-900/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-300",children:[(0,s.jsx)(x.Building2,{className:"h-4 w-4"}),"Entity Information"]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"legal_name",className:"text-white",children:["Legal Name ",(0,s.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,s.jsx)(N.Input,{id:"legal_name",value:m.legal_name,onChange:e=>u({...m,legal_name:e.target.value}),placeholder:"Acme Investment Holdings LP",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"display_name",className:"text-white",children:"Display Name"}),(0,s.jsx)(N.Input,{id:"display_name",value:m.display_name,onChange:e=>u({...m,display_name:e.target.value}),placeholder:"Acme Holdings (optional short name)",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"country_of_incorporation",className:"text-white",children:"Country of Incorporation"}),(0,s.jsx)(N.Input,{id:"country_of_incorporation",value:m.country_of_incorporation,onChange:e=>u({...m,country_of_incorporation:e.target.value}),placeholder:"Cayman Islands",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"representative_name",className:"text-white",children:"Representative Name"}),(0,s.jsx)(N.Input,{id:"representative_name",value:m.representative_name,onChange:e=>u({...m,representative_name:e.target.value}),placeholder:"Jane Doe",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"representative_title",className:"text-white",children:"Representative Title"}),(0,s.jsx)(N.Input,{id:"representative_title",value:m.representative_title,onChange:e=>u({...m,representative_title:e.target.value}),placeholder:"Managing Director",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-300",children:"Contact Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"email",className:"text-white",children:"Email"}),(0,s.jsx)(N.Input,{id:"email",type:"email",value:m.email,onChange:e=>u({...m,email:e.target.value}),placeholder:"investor@email.com",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"phone",className:"text-white",children:"Phone"}),(0,s.jsx)(N.Input,{id:"phone",type:"tel",value:m.phone,onChange:e=>u({...m,phone:e.target.value}),placeholder:"+1 (555) 123-4567",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"country",className:"text-white",children:"individual"===m.type?"Country of Residence":"Country"}),(0,s.jsx)(N.Input,{id:"country",value:m.country,onChange:e=>u({...m,country:e.target.value}),placeholder:"United States",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"tax_residency",className:"text-white",children:"Tax Residency"}),(0,s.jsx)(N.Input,{id:"tax_residency",value:m.tax_residency,onChange:e=>u({...m,tax_residency:e.target.value}),placeholder:"United States",className:"bg-zinc-900 border-zinc-700 text-white placeholder:text-gray-500"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(b.Label,{htmlFor:"primary_rm",className:"text-white",children:"Relationship Manager"}),(0,s.jsxs)(w.Select,{value:m.primary_rm||void 0,onValueChange:e=>u({...m,primary_rm:e||""}),children:[(0,s.jsx)(w.SelectTrigger,{children:(0,s.jsx)(w.SelectValue,{placeholder:"Select a relationship manager (optional)"})}),(0,s.jsx)(w.SelectContent,{children:c.length>0?c.map(e=>(0,s.jsxs)(w.SelectItem,{value:e.id,children:[e.display_name," (",e.role,")"]},e.id)):(0,s.jsx)(w.SelectItem,{value:"loading",disabled:!0,children:"Loading staff..."})})]}),m.primary_rm&&(0,s.jsx)(i.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>u({...m,primary_rm:""}),className:"text-xs",children:"Clear selection"})]}),(0,s.jsxs)(_.DialogFooter,{children:[(0,s.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:l,children:"Cancel"}),(0,s.jsxs)(i.Button,{type:"submit",disabled:l,children:[l&&(0,s.jsx)(C.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Save Changes"]})]})]})]})})}function k({investorId:e,open:a,onOpenChange:r}){(0,f.useRouter)();let[l,d]=(0,t.useState)(!1),[c,o]=(0,t.useState)(!1),[m,x]=(0,t.useState)("existing"),[u,h]=(0,t.useState)(""),[p,g]=(0,t.useState)(""),[j,y]=(0,t.useState)([]);(0,t.useEffect)(()=>{a&&T()},[a]);let T=async()=>{o(!0);try{let e=await fetch("/api/profiles?role=investor");if(e.ok){let s=await e.json();y(s.profiles||[])}}catch(e){console.error("Failed to fetch users:",e)}finally{o(!1)}},k=async s=>{if(s.preventDefault(),"existing"===m&&!p)return void S.toast.error("Please select a user");if("invite"===m&&(!u||!u.includes("@")))return void S.toast.error("Valid email is required");d(!0);try{let s="existing"===m?j.find(e=>e.id===p)?.email:u;console.log("[AddUser] Sending request:",{mode:m,email:s,userId:p});let t=await fetch(`/api/staff/investors/${e}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s?.trim().toLowerCase(),user_id:"existing"===m?p:void 0})}),a=await t.json();if(console.log("[AddUser] Response:",a),!t.ok)throw Error(a.error||"Failed to add user");a.invited?S.toast.success(`Invitation sent to ${s}. They will receive an email to set up their account.`):S.toast.success(`User ${s} has been linked to this investor.`),h(""),g(""),x("existing"),r(!1),window.location.reload()}catch(e){console.error("[AddUser] Error:",e),S.toast.error(e.message||"Failed to add user")}finally{d(!1)}};return(0,s.jsx)(_.Dialog,{open:a,onOpenChange:r,children:(0,s.jsxs)(_.DialogContent,{className:"bg-zinc-950 border-white/10 text-white",children:[(0,s.jsxs)(_.DialogHeader,{children:[(0,s.jsx)(_.DialogTitle,{className:"text-white",children:"Add Portal User"}),(0,s.jsx)(_.DialogDescription,{className:"text-gray-400",children:"Link an existing user or send an invitation to create a new account"})]}),(0,s.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,s.jsxs)(n.Tabs,{value:m,onValueChange:e=>x(e),children:[(0,s.jsxs)(n.TabsList,{className:"grid w-full grid-cols-2 bg-white/5 border-white/10",children:[(0,s.jsx)(n.TabsTrigger,{value:"existing",className:"data-[state=active]:bg-white/10 data-[state=active]:text-white",children:"Select Existing User"}),(0,s.jsx)(n.TabsTrigger,{value:"invite",className:"data-[state=active]:bg-white/10 data-[state=active]:text-white",children:"Send Invitation"})]}),(0,s.jsxs)(n.TabsContent,{value:"existing",className:"space-y-4 mt-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"user_select",className:"text-white",children:["Select User ",(0,s.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,s.jsxs)(w.Select,{value:p,onValueChange:g,disabled:c,children:[(0,s.jsx)(w.SelectTrigger,{className:"bg-white/5 border-white/10 text-white",children:(0,s.jsx)(w.SelectValue,{placeholder:c?"Loading users...":"Choose a user"})}),(0,s.jsx)(w.SelectContent,{className:"max-h-[300px] bg-zinc-950 border-white/10",children:j.length>0?j.map(e=>(0,s.jsx)(w.SelectItem,{value:e.id,className:"text-white",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Users,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.display_name}),(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["(",e.email,")"]})]})},e.id)):(0,s.jsx)(w.SelectItem,{value:"no-users",disabled:!0,className:"text-gray-400",children:c?"Loading...":"No users found"})})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Select from existing users in the system"})]}),(0,s.jsxs)("div",{className:"rounded-md bg-blue-500/10 border border-blue-400/20 p-3 text-xs text-blue-100",children:[(0,s.jsx)("strong",{className:"text-blue-100",children:"How it works:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1 text-blue-200",children:[(0,s.jsx)("li",{children:"User is immediately linked to this investor"}),(0,s.jsx)("li",{children:"They can access this investor's data in the portal"})]})]})]}),(0,s.jsxs)(n.TabsContent,{value:"invite",className:"space-y-4 mt-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"email",className:"text-white",children:["Email Address ",(0,s.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,s.jsx)(N.Input,{id:"email",type:"email",value:u,onChange:e=>h(e.target.value),placeholder:"newuser@email.com",className:"bg-white/5 border-white/10 text-white placeholder:text-gray-500"}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"An invitation email will be sent to this address"})]}),(0,s.jsxs)("div",{className:"rounded-md bg-blue-500/10 border border-blue-400/20 p-3 text-xs text-blue-100",children:[(0,s.jsx)("strong",{className:"text-blue-100",children:"How it works:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1 text-blue-200",children:[(0,s.jsx)("li",{children:"Invitation email sent with signup link"}),(0,s.jsx)("li",{children:"They create account and get portal access"}),(0,s.jsx)("li",{children:"Automatically linked to this investor"})]})]})]})]}),(0,s.jsxs)(_.DialogFooter,{children:[(0,s.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:l,className:"border-white/10 text-white hover:bg-white/10 bg-white/5",children:"Cancel"}),(0,s.jsxs)(i.Button,{type:"submit",disabled:l,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[l&&(0,s.jsx)(C.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Add User"]})]})]})]})})}var I=e.i(551544),F=e.i(335994),D=e.i(110686);function U({investor:e}){let a=(0,f.useRouter)(),[r,n]=(0,t.useState)(!1),[l,d]=(0,t.useState)(!1);return(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsxs)(i.Button,{variant:"outline",className:"bg-white text-gray-900 hover:bg-gray-100 border-gray-300",onClick:()=>n(!0),children:[(0,s.jsx)(I.Edit,{className:"h-4 w-4 mr-2"}),"Edit Investor"]}),(0,s.jsxs)(i.Button,{className:"bg-blue-600 text-white hover:bg-blue-700",onClick:()=>d(!0),children:[(0,s.jsx)(F.UserPlus,{className:"h-4 w-4 mr-2"}),"Add User"]}),(0,s.jsxs)(i.Button,{className:"bg-green-600 text-white hover:bg-green-700",onClick:()=>a.push("/versotech_main/subscriptions"),children:[(0,s.jsx)(D.List,{className:"h-4 w-4 mr-2"}),"Manage Subscriptions"]}),(0,s.jsx)(T,{investor:e,open:r,onOpenChange:n}),(0,s.jsx)(k,{investorId:e.id,open:l,onOpenChange:d})]})}function z({investorId:e,users:t}){(0,f.useRouter)();let a=async(s,t)=>{if(confirm(`Remove ${t} from the investor portal?`))try{let t=await fetch(`/api/staff/investors/${e}/users/${s}`,{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to remove user")}S.toast.success("User removed successfully"),window.location.reload()}catch(e){S.toast.error(e.message||"Failed to remove user")}};return t&&0!==t.length?(0,s.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between border border-gray-800 rounded-lg p-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(v.Users,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:e.profiles?.display_name||"Unknown User"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:e.profiles?.email})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:e.profiles?.role}),(0,s.jsx)(i.Button,{variant:"ghost",size:"sm",className:"hover:bg-red-100 hover:text-red-600",onClick:()=>a(e.user_id,e.profiles?.display_name||"this user"),children:"Remove"})]})]},e.user_id))}):(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(v.Users,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No portal users assigned"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:'Click "Add User" to invite someone to access the portal'})]})}function L({investorId:e,users:t}){return(0,s.jsxs)(a.Card,{id:"portal-users-section",children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)(a.CardTitle,{children:"Portal Users"}),(0,s.jsx)(a.CardDescription,{children:'Users with access to the investor portal. Use "Add User" button in the page header to add new users.'})]})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)(z,{investorId:e,users:t})})]})}var B=e.i(56213),E=e.i(827465),A=e.i(30100);function R({investorId:e}){let n=(0,f.useRouter)(),[l,d]=(0,t.useState)(null),[c,o]=(0,t.useState)(!0),[m,u]=(0,t.useState)(null),h=(0,t.useCallback)(async()=>{try{o(!0);let s=await fetch(`/api/investors/${e}/subscriptions`);if(!s.ok){let e=`Failed to fetch subscriptions (status ${s.status})`;try{let t=await s.json();t?.error&&(e=t.details?`${t.error}: ${t.details}`:t.error)}catch{}throw Error(e)}let t=await s.json();d(t),u(null)}catch(e){console.error("Failed to fetch subscriptions:",e),u(e instanceof Error?e.message:"Failed to load subscriptions")}finally{o(!1)}},[e]);(0,t.useEffect)(()=>{h()},[e,h]);let p=(e,s)=>new Intl.NumberFormat("en-US",{style:"currency",currency:s||"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),g=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-";return c?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(B.Skeleton,{className:"h-8 w-48"}),(0,s.jsx)(B.Skeleton,{className:"h-64 w-full"})]}):m?(0,s.jsx)(a.Card,{children:(0,s.jsxs)(a.CardContent,{className:"pt-6",children:[(0,s.jsx)("p",{className:"text-destructive",children:m}),(0,s.jsx)(i.Button,{onClick:h,className:"mt-4",children:"Retry"})]})}):l?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold",children:["Subscriptions (",l.summary.total_subscriptions,")"]}),(0,s.jsxs)("p",{className:"text-muted-foreground",children:[l.summary.total_vehicles,' vehicles. Use "Manage Subscriptions" button to view and manage all subscriptions.']})]}),0===l.grouped_by_vehicle.length?(0,s.jsx)(a.Card,{children:(0,s.jsx)(a.CardContent,{className:"pt-6 text-center",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:'No subscriptions yet. Use the "Manage Subscriptions" button to navigate to the subscriptions page.'})})}):(0,s.jsxs)(s.Fragment,{children:[l.grouped_by_vehicle.map((e,t)=>(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Building2,{className:"h-5 w-5"}),e.vehicle?.name??"No Vehicle Assigned"]}),(0,s.jsxs)(a.CardDescription,{className:"mt-1",children:[e.subscriptions.length," subscription",1!==e.subscriptions.length?"s":""]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Commitment"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:p(e.total_commitment,e.currency)})]})]})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:e.subscriptions.map(e=>{let t=e.commitment>0?e.funded_amount/e.commitment*100:0,a=e.subscription_fee_amount||e.bd_fee_amount||e.spread_fee_amount||e.finra_fee_amount,l=[e.subscription_fee_amount,e.bd_fee_amount,e.spread_fee_amount,e.finra_fee_amount].reduce((e,s)=>e+(s||0),0),d=e.funded_amount>0&&e.current_nav?e.current_nav/e.funded_amount:null;return(0,s.jsxs)("div",{className:"p-4 border rounded-lg hover:bg-accent/50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(E.Hash,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"font-mono font-semibold text-lg",children:e.subscription_number})]}),(0,s.jsx)(r.Badge,{className:(e=>{switch(e){case"active":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"committed":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"closed":default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}})(e.status),children:e.status}),e.opportunity_name&&(0,s.jsx)("span",{className:"text-sm text-muted-foreground italic",children:e.opportunity_name})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>n.push("/versotech_main/subscriptions"),children:["View Details",(0,s.jsx)(A.ArrowRight,{className:"h-4 w-4 ml-2"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Commitment"}),(0,s.jsx)("p",{className:"font-semibold",children:p(e.commitment,e.currency)}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Funded: ",p(e.funded_amount,e.currency)," (",t.toFixed(0),"%)"]}),null!=e.outstanding_amount&&e.outstanding_amount>0&&(0,s.jsxs)("p",{className:"text-xs text-yellow-600 font-medium",children:["Outstanding: ",p(e.outstanding_amount,e.currency)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Important Dates"}),e.committed_at&&(0,s.jsxs)("p",{className:"text-sm",children:["Committed: ",g(e.committed_at)]}),e.created_at&&(0,s.jsxs)("p",{className:"text-sm",children:["Created: ",g(e.created_at)]}),!e.committed_at&&!e.created_at&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No dates set"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Share Structure"}),null!=e.num_shares?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"text-sm font-medium",children:[e.num_shares.toLocaleString()," shares"]}),null!=e.price_per_share&&(0,s.jsxs)("p",{className:"text-xs",children:["@ ",p(e.price_per_share,e.currency)]}),null!=e.spread_per_share&&e.spread_per_share>0&&(0,s.jsxs)("p",{className:"text-xs text-green-600",children:["Spread: ",p(e.spread_per_share,e.currency)]})]}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No share data"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Fees & Performance"}),a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"text-sm font-medium",children:["Total Fees: ",p(l,e.currency)]}),e.subscription_fee_percent&&(0,s.jsxs)("p",{className:"text-xs",children:["Sub: ",e.subscription_fee_percent.toFixed(2),"%"]}),e.bd_fee_percent&&(0,s.jsxs)("p",{className:"text-xs",children:["BD: ",e.bd_fee_percent.toFixed(2),"%"]})]}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No fees"}),null!=d&&(0,s.jsxs)("p",{className:`text-xs font-medium mt-1 ${d>=1?"text-green-600":"text-red-600"}`,children:["MOIC: ",d.toFixed(2),"x"]})]})]}),(e.capital_calls_total>0||e.distributions_total>0||null!=e.current_nav)&&(0,s.jsxs)("div",{className:"mt-3 pt-3 border-t grid grid-cols-3 gap-4 text-sm",children:[e.capital_calls_total>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Capital Calls"}),(0,s.jsx)("p",{className:"font-medium",children:p(e.capital_calls_total,e.currency)})]}),e.distributions_total>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Distributions"}),(0,s.jsx)("p",{className:"font-medium text-green-600",children:p(e.distributions_total,e.currency)})]}),null!=e.current_nav&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current NAV"}),(0,s.jsx)("p",{className:`font-medium ${d&&d>=1?"text-green-600":"text-red-600"}`,children:p(e.current_nav,e.currency)})]})]})]},e.id)})})})]},e.vehicle?.id??`no-vehicle-${t}`)),(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsx)(a.CardTitle,{children:"Grand Total"})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)("div",{className:"space-y-2",children:Object.entries(l.summary.total_commitment_by_currency).map(([e,t])=>(0,s.jsxs)("div",{className:"flex justify-between text-lg",children:[(0,s.jsxs)("span",{className:"font-medium",children:[e,":"]}),(0,s.jsx)("span",{className:"font-bold",children:p(t,e)})]},e))})})]})]})]}):null}var P=e.i(907434),$=e.i(733179),M=e.i(35334),O=e.i(417439),H=e.i(396064),V=e.i(15098),K=e.i(401148),Y=e.i(275034),q=e.i(645855),J=e.i(382021),G=e.i(761722),Q=e.i(771750),W=e.i(137533);let X={subscription:g.FileText,capital_call:p.DollarSign,distribution:$.TrendingUp,kyc:M.UserCheck,document:H.Upload,message:O.MessageSquare,profile:M.UserCheck,system:Y.Info},Z={subscription:"text-blue-600",capital_call:"text-orange-600",distribution:"text-green-600",kyc:"text-purple-600",document:"text-indigo-600",message:"text-pink-600",profile:"text-gray-600",system:"text-gray-500"},ee={subscription:"bg-blue-50",capital_call:"bg-orange-50",distribution:"bg-green-50",kyc:"bg-purple-50",document:"bg-indigo-50",message:"bg-pink-50",profile:"bg-gray-50",system:"bg-gray-50"};function es({investorId:e,compact:n=!1,maxHeight:l="600px"}){let[d,c]=(0,t.useState)([]),[o,m]=(0,t.useState)(!0),[x,u]=(0,t.useState)(null),[h,p]=(0,t.useState)("all");(0,t.useEffect)(()=>{(async()=>{try{m(!0);let s=await fetch(`/api/staff/investors/${e}/activity?type=${h}`);if(!s.ok){if(404===s.status||500===s.status){let e=await s.json().catch(()=>({}));if(e.error?.includes("relation")||e.error?.includes("does not exist")){c([]),u(null),m(!1);return}}throw Error("Failed to fetch activity timeline")}let t=await s.json();c(t.activities||[]),u(null)}catch(e){console.error("Failed to fetch activities:",e),c([]),u(null)}finally{m(!1)}})()},[e,h]);let g=async()=>{try{let s=await fetch(`/api/staff/investors/${e}/activity/export`),t=await s.blob(),a=window.URL.createObjectURL(t),i=document.createElement("a");i.href=a,i.download=`investor-${e}-activity-${(0,W.format)(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(a),document.body.removeChild(i)}catch(e){console.error("Failed to export activities:",e)}};return o?(0,s.jsxs)(a.Card,{children:[(0,s.jsxs)(a.CardHeader,{children:[(0,s.jsx)(B.Skeleton,{className:"h-6 w-32"}),(0,s.jsx)(B.Skeleton,{className:"h-4 w-48"})]}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)("div",{className:"space-y-4",children:[1,2,3,4,5].map(e=>(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(B.Skeleton,{className:"h-10 w-10 rounded-full"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)(B.Skeleton,{className:"h-4 w-3/4"}),(0,s.jsx)(B.Skeleton,{className:"h-3 w-1/2"})]})]},e))})})]}):x?(0,s.jsx)(a.Card,{children:(0,s.jsx)(a.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,s.jsx)(K.AlertCircle,{className:"h-4 w-4"}),(0,s.jsx)("p",{children:x})]})})}):(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(q.Clock,{className:"h-5 w-5"}),"Activity Timeline"]}),(0,s.jsx)(a.CardDescription,{children:"Chronological history of all investor interactions"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(w.Select,{value:h,onValueChange:p,children:[(0,s.jsxs)(w.SelectTrigger,{className:"w-[180px]",children:[(0,s.jsx)(J.Filter,{className:"h-4 w-4 mr-2"}),(0,s.jsx)(w.SelectValue,{})]}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"all",children:"All Activities"}),(0,s.jsx)(w.SelectItem,{value:"subscription",children:"Subscriptions"}),(0,s.jsx)(w.SelectItem,{value:"capital_call",children:"Capital Calls"}),(0,s.jsx)(w.SelectItem,{value:"distribution",children:"Distributions"}),(0,s.jsx)(w.SelectItem,{value:"kyc",children:"KYC Changes"}),(0,s.jsx)(w.SelectItem,{value:"document",children:"Documents"}),(0,s.jsx)(w.SelectItem,{value:"message",children:"Messages"})]})]}),(0,s.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:g,children:[(0,s.jsx)(G.Download,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)(P.ScrollArea,{style:{height:l},className:"pr-4",children:0===d.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(q.Clock,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"No activities found"})]}):(0,s.jsx)("div",{className:"space-y-4",children:d.map((e,t)=>{let a=X[e.type],i=Z[e.type],n=ee[e.type],l=t===d.length-1;return(0,s.jsxs)("div",{className:"relative",children:[!l&&(0,s.jsx)("div",{className:"absolute left-5 top-12 bottom-0 w-px bg-border"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("div",{className:`flex-shrink-0 w-10 h-10 rounded-full ${n} flex items-center justify-center relative z-10`,children:(0,s.jsx)(a,{className:`h-5 w-5 ${i}`})}),(0,s.jsx)("div",{className:"flex-1 pb-8",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("p",{className:"font-semibold text-sm",children:e.action}),(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:e.type.replace("_"," ")})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:e.description}),e.metadata&&Object.keys(e.metadata).length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:Object.entries(e.metadata).map(([e,t])=>(0,s.jsxs)("div",{className:"text-xs bg-muted px-2 py-1 rounded",children:[(0,s.jsxs)("span",{className:"font-medium",children:[e,":"]})," ",(0,s.jsx)("span",{children:String(t)})]},e))}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.created_by&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["by ",e.created_by.display_name]}),(0,s.jsx)("span",{children:"â€¢"})]}),(0,s.jsx)("span",{title:(0,W.format)(new Date(e.created_at),"PPpp"),children:(0,Q.formatDistanceToNow)(new Date(e.created_at),{addSuffix:!0})})]})]}),e.metadata?.status==="success"&&(0,s.jsx)(V.CheckCircle2,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),e.metadata?.status==="error"&&(0,s.jsx)(K.AlertCircle,{className:"h-4 w-4 text-red-600 flex-shrink-0"})]})})]})]},e.id)})})})})]})}function et({investorId:e}){return(0,s.jsx)(es,{investorId:e})}var ea=e.i(475478),ei=e.i(160599);e.i(227041);var er=e.i(1694),en=e.i(465914),el=e.i(923226);function ed({investor:e,capitalMetrics:f,metricsAvailable:_}){let[N,b]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1),S=!1!==_;return(0,t.useEffect)(()=>{b(!0)},[]),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(l.default,{href:"/versotech_main/users",children:(0,s.jsxs)(i.Button,{variant:"ghost",size:"sm",className:"bg-gray-800 text-white hover:bg-gray-700",children:[(0,s.jsx)(d.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Users"]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:e.legal_name}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Investor ID: ",e.id.slice(0,8)]})]})]}),(0,s.jsx)(U,{investor:e})]}),(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsxs)(r.Badge,{variant:"completed"===e.kyc_status||"approved"===e.kyc_status?"default":"secondary",children:["KYC: ",e.kyc_status]}),(0,s.jsx)(r.Badge,{variant:"active"===e.status?"default":"secondary",children:e.status}),(0,s.jsx)(r.Badge,{variant:"outline",className:"capitalize",children:e.type}),e.aml_risk_rating&&(0,s.jsxs)(r.Badge,{variant:"low"===e.aml_risk_rating?"default":"high"===e.aml_risk_rating?"destructive":"secondary",children:["Risk: ",e.aml_risk_rating]}),e.is_pep&&(0,s.jsx)(r.Badge,{variant:"destructive",children:"PEP"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{className:"pb-3",children:(0,s.jsx)(a.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Commitment"})}),(0,s.jsxs)(a.CardContent,{children:[(0,s.jsx)("div",{className:S?"text-2xl font-bold text-foreground":"text-2xl font-semibold text-muted-foreground",children:S?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(f.total_commitment):"Pending"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:S?f.vehicle_count>0?(0,s.jsxs)(s.Fragment,{children:["Across ",f.vehicle_count," vehicle",1!==f.vehicle_count?"s":""]}):(0,s.jsx)(s.Fragment,{children:"No subscriptions yet"}):(0,s.jsx)(s.Fragment,{children:"Metrics pending"})})]})]}),(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{className:"pb-3",children:(0,s.jsx)(a.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Contributed / Unfunded"})}),(0,s.jsxs)(a.CardContent,{children:[(0,s.jsx)("div",{className:S?"text-2xl font-bold text-green-400":"text-2xl font-semibold text-muted-foreground",children:S?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(f.total_contributed):"Pending"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:S?(0,s.jsxs)(s.Fragment,{children:["Unfunded: ",new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(f.unfunded_commitment)]}):(0,s.jsx)(s.Fragment,{children:"Metrics pending"})})]})]}),(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{className:"pb-3",children:(0,s.jsx)(a.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Current NAV"})}),(0,s.jsxs)(a.CardContent,{children:[(0,s.jsx)("div",{className:S?"text-2xl font-bold text-blue-400":"text-2xl font-semibold text-muted-foreground",children:S?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(f.current_nav):"Pending"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:S?(0,s.jsxs)(s.Fragment,{children:["Distributed: ",new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(f.total_distributed)]}):(0,s.jsx)(s.Fragment,{children:"Metrics pending"})})]})]})]}),N?(0,s.jsxs)(n.Tabs,{defaultValue:"overview",className:"space-y-6",id:`investor-tabs-${e.id}`,children:[(0,s.jsxs)(n.TabsList,{className:"grid w-full grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-7 lg:w-auto lg:inline-grid",children:[(0,s.jsxs)(n.TabsTrigger,{value:"overview",className:"gap-2",children:[(0,s.jsx)(x.Building2,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Overview"})]}),(0,s.jsxs)(n.TabsTrigger,{value:"members",className:"gap-2",children:[(0,s.jsx)(h.User,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Members"})]}),(0,s.jsxs)(n.TabsTrigger,{value:"subscriptions",className:"gap-2",children:[(0,s.jsx)(p.DollarSign,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Subscriptions"})]}),(0,s.jsxs)(n.TabsTrigger,{value:"kyc",className:"gap-2",children:[(0,s.jsx)(g.FileText,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"KYC Documents"})]}),(0,s.jsxs)(n.TabsTrigger,{value:"bank",className:"gap-2",children:[(0,s.jsx)(j.Banknote,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Bank Details"})]}),(0,s.jsxs)(n.TabsTrigger,{value:"users",className:"gap-2",children:[(0,s.jsx)(v.Users,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Portal Users"})]}),(0,s.jsxs)(n.TabsTrigger,{value:"activity",className:"gap-2",children:[(0,s.jsx)(y.Activity,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Activity"})]})]}),(0,s.jsxs)(n.TabsContent,{value:"overview",className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsx)(a.CardTitle,{children:"Contact Information"})}),(0,s.jsxs)(a.CardContent,{className:"space-y-4",children:[e.email&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(c.Mail,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Email"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.email})]})]}),e.phone&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(o.Phone,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Phone"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.phone})]})]}),e.country&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(m.Globe,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Country"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.country})]})]}),e.primary_rm_profile&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(h.User,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Relationship Manager"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.primary_rm_profile.display_name})]})]})]})]}),(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsx)(a.CardTitle,{children:"Entity Information"})}),(0,s.jsxs)(a.CardContent,{className:"space-y-4",children:[e.display_name&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(x.Building2,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Display Name"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.display_name})]})]}),e.country_of_incorporation&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(m.Globe,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Country of Incorporation"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.country_of_incorporation})]})]}),e.tax_residency&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(p.DollarSign,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tax Residency"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.tax_residency})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(u.Calendar,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Created"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:new Date(e.created_at).toLocaleDateString()})]})]})]})]})]}),"individual"===e.type&&(0,s.jsx)(er.IndividualKycDisplay,{data:{first_name:e.first_name,middle_name:e.middle_name,last_name:e.last_name,name_suffix:e.name_suffix,date_of_birth:e.date_of_birth,country_of_birth:e.country_of_birth,nationality:e.nationality,email:e.email,phone_mobile:e.phone_mobile,phone_office:e.phone_office,residential_street:e.residential_street,residential_line_2:e.residential_line_2,residential_city:e.residential_city,residential_state:e.residential_state,residential_postal_code:e.residential_postal_code,residential_country:e.residential_country,is_us_citizen:e.is_us_citizen,is_us_taxpayer:e.is_us_taxpayer,us_taxpayer_id:e.us_taxpayer_id,country_of_tax_residency:e.country_of_tax_residency,id_type:e.id_type,id_number:e.id_number,id_issue_date:e.id_issue_date,id_expiry_date:e.id_expiry_date,id_issuing_country:e.id_issuing_country},showEditButton:!0,onEdit:()=>C(!0),title:"Personal KYC Information"})]}),(0,s.jsx)(n.TabsContent,{value:"members",children:(0,s.jsx)(el.StaffEntityMembersTab,{entityType:"investor",entityId:e.id,entityName:e.legal_name})}),(0,s.jsx)(n.TabsContent,{value:"subscriptions",children:(0,s.jsx)(R,{investorId:e.id})}),(0,s.jsx)(n.TabsContent,{value:"kyc",children:(0,s.jsx)(ea.KYCDocumentsTab,{entityType:"investor",entityId:e.id,entityName:e.legal_name})}),(0,s.jsx)(n.TabsContent,{value:"bank",children:(0,s.jsx)(ei.BankDetailsTab,{entityType:"investor",entityId:e.id,entityName:e.legal_name})}),(0,s.jsx)(n.TabsContent,{value:"users",children:(0,s.jsx)(L,{investorId:e.id,users:e.investor_users||[]})}),(0,s.jsx)(n.TabsContent,{value:"activity",children:(0,s.jsx)(et,{investorId:e.id})})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"h-10 rounded-md bg-muted/50"}),(0,s.jsx)("div",{className:"h-64 rounded-lg border border-dashed border-muted-foreground/30 bg-muted/20"})]}),"individual"===e.type&&(0,s.jsx)(en.EntityKYCEditDialog,{open:w,onOpenChange:C,entityType:"investor",entityId:e.id,entityName:e.legal_name,apiEndpoint:`/api/staff/investors/${e.id}`,initialData:{first_name:e.first_name??void 0,middle_name:e.middle_name??void 0,last_name:e.last_name??void 0,name_suffix:e.name_suffix??void 0,date_of_birth:e.date_of_birth??void 0,country_of_birth:e.country_of_birth??void 0,nationality:e.nationality??void 0,email:e.email??void 0,phone_mobile:e.phone_mobile??void 0,phone_office:e.phone_office??void 0,residential_street:e.residential_street??void 0,residential_line_2:e.residential_line_2??void 0,residential_city:e.residential_city??void 0,residential_state:e.residential_state??void 0,residential_postal_code:e.residential_postal_code??void 0,residential_country:e.residential_country??void 0,is_us_citizen:e.is_us_citizen??void 0,is_us_taxpayer:e.is_us_taxpayer??void 0,us_taxpayer_id:e.us_taxpayer_id??void 0,country_of_tax_residency:e.country_of_tax_residency??void 0,id_type:e.id_type??void 0,id_number:e.id_number??void 0,id_issue_date:e.id_issue_date??void 0,id_expiry_date:e.id_expiry_date??void 0,id_issuing_country:e.id_issuing_country??void 0},onSuccess:()=>window.location.reload()})]})}e.s(["InvestorDetailClient",()=>ed],676232)}]);