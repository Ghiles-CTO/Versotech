(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,155975,e=>{"use strict";var t=e.i(722679),r=e.i(340915),a=e.i(820417),s=e.i(337684),l=e.i(90613),d=e.i(129432),n=e.i(316264),i=e.i(191569),o=e.i(538892),c=e.i(282141),m=e.i(734213),x=e.i(401148),u=e.i(994659),g=e.i(971743),h=e.i(985385),b=e.i(398472),p=e.i(117925),j=e.i(624729);let f=(0,e.i(410587).default)("mail-check",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);var N=e.i(501259),C=e.i(750809),v=e.i(382021),w=e.i(432598),S=e.i(837221),k=e.i(711819),y=e.i(645855),_=e.i(196767),D=e.i(244994),I=e.i(481706),A=e.i(335994),T=e.i(733179),L=e.i(10994),P=e.i(612374),E=e.i(721610),R=e.i(954620),V=e.i(352776),B=e.i(514133),F=e.i(312692),$=e.i(263229),O=e.i(360209),U=e.i(15098),H=e.i(59178),M=e.i(994500);function q({dealId:e,dealName:a,partnerId:s,children:l}){let[c,m]=(0,r.useState)(!1),[u,g]=(0,r.useState)(!1),[h,b]=(0,r.useState)(!1),[p,j]=(0,r.useState)(!1),[f,C]=(0,r.useState)([]),[v,w]=(0,r.useState)([]),[S,k]=(0,r.useState)(null),[y,_]=(0,r.useState)(new Set),[D,T]=(0,r.useState)(""),[L,P]=(0,r.useState)(""),[E,R]=(0,r.useState)(!1),[q,Y]=(0,r.useState)("");async function W(){g(!0);try{let t=(0,H.createClient)(),{data:r,error:a}=await t.from("investors").select("id, display_name, legal_name, email, type").order("display_name").limit(100);if(a)throw a;C(r||[]);let{data:l,error:d}=await t.from("introducers").select("id, name, email").order("name").limit(50);d&&console.warn("Could not fetch introducers:",d),w(l||[]);let{data:n,error:i}=await t.from("partner_fee_models").select("id, fee_type, percentage_rate, flat_amount, currency").eq("partner_id",s).eq("deal_id",e).maybeSingle();i&&console.warn("Could not fetch fee model:",i),k(n);let{data:o,error:c}=await t.from("deal_memberships").select("investor_id").eq("deal_id",e).not("investor_id","is",null);c&&console.warn("Could not fetch existing memberships:",c);let m=new Set;o?.forEach(e=>{e.investor_id&&m.add(e.investor_id)}),_(m)}catch(e){console.error("[ShareDealDialog] Error fetching data:",e),M.toast.error("Failed to load data")}finally{g(!1)}}async function G(){if(!D)return void M.toast.error("Please select an investor");b(!0);try{let t=await fetch("/api/partners/me/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deal_id:e,investor_id:D,introducer_id:E?L:null})}),r=await t.json();if(!t.ok)throw Error(r.error||"Failed to share deal");j(!0),M.toast.success("Deal shared successfully!"),_(e=>new Set([...e,D])),setTimeout(()=>{m(!1),j(!1),T(""),P(""),R(!1)},2e3)}catch(e){console.error("[ShareDealDialog] Error sharing deal:",e),M.toast.error(e instanceof Error?e.message:"Failed to share deal")}finally{b(!1)}}(0,r.useEffect)(()=>{c&&W()},[c,s,e]);let K=f.filter(e=>{if(!q)return!0;let t=e.display_name||e.legal_name||"",r=e.email||"",a=q.toLowerCase();return t.toLowerCase().includes(a)||r.toLowerCase().includes(a)}).filter(e=>!y.has(e.id)),z=f.find(e=>e.id===D);return(0,t.jsxs)(V.Dialog,{open:c,onOpenChange:m,children:[(0,t.jsx)(V.DialogTrigger,{asChild:!0,children:l}),(0,t.jsxs)(V.DialogContent,{className:"sm:max-w-[500px]",children:[(0,t.jsxs)(V.DialogHeader,{children:[(0,t.jsxs)(V.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(I.Share2,{className:"h-5 w-5 text-blue-600"}),"Share Deal with Investor"]}),(0,t.jsxs)(V.DialogDescription,{children:["Share ",(0,t.jsx)("strong",{children:a})," with an investor in your network.",S&&(0,t.jsxs)("span",{className:"block mt-1 text-emerald-600",children:["Your commission: ",S.percentage_rate?`${S.percentage_rate}%`:`${S.currency} ${S.flat_amount}`]})]})]}),p?(0,t.jsxs)("div",{className:"py-8 text-center",children:[(0,t.jsx)(U.CheckCircle2,{className:"h-16 w-16 text-emerald-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-foreground",children:"Deal Shared Successfully!"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"The investor will receive an invitation to view this opportunity."})]}):u?(0,t.jsx)("div",{className:"py-8 flex items-center justify-center",children:(0,t.jsx)($.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(B.Label,{htmlFor:"investor",className:"flex items-center gap-2",children:[(0,t.jsx)(N.Users,{className:"h-4 w-4"}),"Select Investor *"]}),(0,t.jsx)(i.Input,{placeholder:"Search investors by name or email...",value:q,onChange:e=>Y(e.target.value),className:"mb-2"}),(0,t.jsxs)(o.Select,{value:D,onValueChange:T,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{placeholder:"Choose an investor"})}),(0,t.jsx)(o.SelectContent,{className:"max-h-60",children:0===K.length?(0,t.jsx)("div",{className:"py-4 text-center text-sm text-muted-foreground",children:y.size>0?"All matching investors already have access":"No investors found"}):K.map(e=>(0,t.jsx)(o.SelectItem,{value:e.id,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.display_name||e.legal_name||"Unknown"}),(0,t.jsx)(d.Badge,{variant:"outline",className:"text-xs",children:e.type})]})},e.id))})]}),z?.email&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground pl-1",children:z.email})]}),v.length>0&&(0,t.jsxs)("div",{className:"border border-border rounded-lg p-4 bg-muted space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(F.Checkbox,{id:"include-introducer",checked:E,onCheckedChange:e=>R(!0===e)}),(0,t.jsxs)(B.Label,{htmlFor:"include-introducer",className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)(A.UserPlus,{className:"h-4 w-4 text-purple-600"}),"Co-refer with Introducer"]})]}),E&&(0,t.jsxs)(o.Select,{value:L,onValueChange:P,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{placeholder:"Select an introducer"})}),(0,t.jsx)(o.SelectContent,{children:v.map(e=>(0,t.jsx)(o.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),S&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-lg",children:[(0,t.jsx)(O.Percent,{className:"h-5 w-5 text-emerald-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-emerald-800",children:"Your Commission Rate"}),(0,t.jsxs)("p",{className:"text-xs text-emerald-600",children:[S.fee_type,": ",S.percentage_rate?`${S.percentage_rate}% of investment`:`${S.currency} ${S.flat_amount} flat fee`]})]})]}),!S&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,t.jsx)(x.AlertCircle,{className:"h-5 w-5 text-amber-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"No Fee Model Assigned"}),(0,t.jsx)("p",{className:"text-xs text-amber-600",children:"Contact your arranger to set up a commission structure for this deal."})]})]})]}),!p&&!u&&(0,t.jsxs)(V.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:G,disabled:h||!D,className:"gap-2 bg-blue-600 hover:bg-blue-700",children:h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Loader2,{className:"h-4 w-4 animate-spin"}),"Sharing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.Share2,{className:"h-4 w-4"}),"Share Deal"]})})]})]})]})}let Y={dispatched:{label:"Dispatched",bgColor:"bg-muted",textColor:"text-muted-foreground",borderColor:"border-border"},interested:{label:"Interested",bgColor:"bg-amber-50 dark:bg-amber-900/30",textColor:"text-amber-700 dark:text-amber-300",borderColor:"border-amber-200 dark:border-amber-700"},passed:{label:"Passed",bgColor:"bg-rose-50 dark:bg-rose-900/30",textColor:"text-rose-600 dark:text-rose-300",borderColor:"border-rose-200 dark:border-rose-700"},approved:{label:"Approved",bgColor:"bg-indigo-50 dark:bg-indigo-900/30",textColor:"text-indigo-700 dark:text-indigo-300",borderColor:"border-indigo-200 dark:border-indigo-700"},signed:{label:"Signed",bgColor:"bg-purple-50 dark:bg-purple-900/30",textColor:"text-purple-700 dark:text-purple-300",borderColor:"border-purple-200 dark:border-purple-700"},funded:{label:"Funded",bgColor:"bg-emerald-50 dark:bg-emerald-900/30",textColor:"text-emerald-700 dark:text-emerald-300",borderColor:"border-emerald-200 dark:border-emerald-700"}},W={equity_secondary:"Secondary Equity",equity_primary:"Primary Equity",credit_trade_finance:"Credit & Trade Finance",other:"Other"},G={draft:"bg-muted text-muted-foreground",open:"bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300",allocation_pending:"bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300",closed:"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300",cancelled:"bg-rose-100 dark:bg-rose-900/50 text-rose-700 dark:text-rose-300"},K=new Set(["investor","partner_investor","introducer_investor","commercial_partner_investor","co_investor"]),z={pending_review:{label:"Pending review",tone:"bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300"},approved:{label:"NDA active",tone:"bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300"},rejected:{label:"Declined",tone:"bg-rose-100 dark:bg-rose-900/50 text-rose-700 dark:text-rose-300"},withdrawn:{label:"Withdrawn",tone:"bg-muted text-muted-foreground"}},J={pending_review:{label:"Pending Review",stage:6,icon:y.Clock,bgColor:"bg-amber-50 dark:bg-amber-900/30",textColor:"text-amber-700 dark:text-amber-300",borderColor:"border-amber-200 dark:border-amber-700"},pending:{label:"Pending Review",stage:6,icon:y.Clock,bgColor:"bg-amber-50 dark:bg-amber-900/30",textColor:"text-amber-700 dark:text-amber-300",borderColor:"border-amber-200 dark:border-amber-700"},approved:{label:"Approved",stage:7,icon:f,bgColor:"bg-indigo-50 dark:bg-indigo-900/30",textColor:"text-indigo-700 dark:text-indigo-300",borderColor:"border-indigo-200 dark:border-indigo-700"},committed:{label:"Committed",stage:8,icon:k.FileSignature,bgColor:"bg-purple-50 dark:bg-purple-900/30",textColor:"text-purple-700 dark:text-purple-300",borderColor:"border-purple-200 dark:border-purple-700"},partially_funded:{label:"Partially Funded",stage:9,icon:_.DollarSign,bgColor:"bg-teal-50 dark:bg-teal-900/30",textColor:"text-teal-700 dark:text-teal-300",borderColor:"border-teal-200 dark:border-teal-700"},funded:{label:"Funded",stage:9,icon:_.DollarSign,bgColor:"bg-emerald-50 dark:bg-emerald-900/30",textColor:"text-emerald-700 dark:text-emerald-300",borderColor:"border-emerald-200 dark:border-emerald-700"},pack_generated:{label:"Pack Generated",stage:6,icon:D.Package,bgColor:"bg-blue-50 dark:bg-blue-900/30",textColor:"text-blue-700 dark:text-blue-300",borderColor:"border-blue-200 dark:border-blue-700"},pack_sent:{label:"Pack Sent",stage:7,icon:f,bgColor:"bg-indigo-50 dark:bg-indigo-900/30",textColor:"text-indigo-700 dark:text-indigo-300",borderColor:"border-indigo-200 dark:border-indigo-700"},signed:{label:"Signed",stage:8,icon:k.FileSignature,bgColor:"bg-purple-50 dark:bg-purple-900/30",textColor:"text-purple-700 dark:text-purple-300",borderColor:"border-purple-200 dark:border-purple-700"},submitted:{label:"Submitted",stage:6,icon:y.Clock,bgColor:"bg-amber-50 dark:bg-amber-900/30",textColor:"text-amber-700 dark:text-amber-300",borderColor:"border-amber-200 dark:border-amber-700"},in_review:{label:"In Review",stage:6,icon:y.Clock,bgColor:"bg-amber-50 dark:bg-amber-900/30",textColor:"text-amber-700 dark:text-amber-300",borderColor:"border-amber-200 dark:border-amber-700"},rejected:{label:"Rejected",stage:0,icon:x.AlertCircle,bgColor:"bg-rose-50 dark:bg-rose-900/30",textColor:"text-rose-700 dark:text-rose-300",borderColor:"border-rose-200 dark:border-rose-700"},cancelled:{label:"Cancelled",stage:0,icon:x.AlertCircle,bgColor:"bg-muted",textColor:"text-muted-foreground",borderColor:"border-border"}};function X(e,t){if(null==e)return"—";try{return new Intl.NumberFormat("en-US",{style:"currency",currency:t?3===t.length?t.toUpperCase():t.toUpperCase().slice(0,3):"USD",maximumFractionDigits:e>=1e3?0:2}).format(e)}catch{return`${t??""} ${e.toLocaleString()}`}}function Z(e){return"closed"===e.status||"cancelled"===e.status?e.status:e.close_at&&new Date(e.close_at)<new Date?"closed":e.status}function Q({dealsData:e,feeStructureMap:k,interestByDeal:_,accessByDeal:D,subscriptionByDeal:V,primaryInvestorId:B,partnerId:F,summary:$,detailUrlBase:O="/versotech_main/opportunities",referralsByDeal:U={},referralSubscriptionsByDeal:H={},partnerCommissionsByDeal:M={},partnerSummary:Q}){let[ee,et]=(0,r.useState)(!1),er=(0,r.useMemo)(()=>F&&B?"DUAL_PERSONA":F?"PARTNER_ONLY":B?"INVESTOR_ONLY":"GENERIC",[F,B]),ea="PARTNER_ONLY"===er||"DUAL_PERSONA"===er,es="INVESTOR_ONLY"===er||"DUAL_PERSONA"===er,[el,ed]=(0,r.useState)(""),[en,ei]=(0,r.useState)("all"),[eo,ec]=(0,r.useState)("all"),[em,ex]=(0,r.useState)("all"),[eu,eg]=(0,r.useState)("all"),[eh,eb]=(0,r.useState)("all"),[ep,ej]=(0,r.useState)("all"),[ef,eN]=(0,r.useState)("all"),[eC,ev]=(0,r.useState)("closing_date"),[ew,eS]=(0,r.useState)(!1);(0,r.useEffect)(()=>{et(!0)},[]);let ek=(0,r.useMemo)(()=>{let t=new Set;return e.forEach(e=>{e.sector&&t.add(e.sector)}),Array.from(t).sort()},[e]),ey=(0,r.useMemo)(()=>{let t=new Set;return e.forEach(e=>{e.stage&&t.add(e.stage)}),Array.from(t).sort()},[e]),e_=(0,r.useMemo)(()=>{let t=new Set;return e.forEach(e=>{e.location&&t.add(e.location)}),Array.from(t).sort()},[e]),eD=(0,r.useMemo)(()=>{let t=[],r=["activated","active","completed"];return e.forEach(e=>{let a=V.get(e.id);if(a&&!r.includes(a.status.toLowerCase())){let r=J[a.status.toLowerCase()]||J.pending;t.push({deal:e,subscription:a,stageMeta:r})}}),t.sort((e,t)=>new Date(t.subscription.submitted_at).getTime()-new Date(e.subscription.submitted_at).getTime()),t},[e,V]),eI=(0,r.useMemo)(()=>{let t=[...e];if(el){let e=el.toLowerCase();t=t.filter(t=>t.name?.toLowerCase().includes(e)||t.company_name?.toLowerCase().includes(e)||t.sector?.toLowerCase().includes(e)||t.location?.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e))}return"all"!==en&&(t=t.filter(e=>Z(e)===en)),"all"!==eo&&(t=t.filter(e=>e.deal_type===eo)),"all"!==em&&(t=t.filter(e=>{let t=_.get(e.id);return"no_interest"===em?!t:t?.status===em})),"all"!==eu&&(t=t.filter(e=>{let t=_.get(e.id),r=D.get(e.id),a=V.get(e.id);switch(eu){case"interested":return!!t;case"nda_access":return!!r;case"subscription_submitted":return!!a;default:return!0}})),"all"!==eh&&(t=t.filter(e=>e.sector===eh)),"all"!==ep&&(t=t.filter(e=>e.stage===ep)),"all"!==ef&&(t=t.filter(e=>e.location===ef)),t.sort((e,t)=>{switch(eC){case"closing_date":if(!e.close_at)return 1;if(!t.close_at)return -1;return new Date(e.close_at).getTime()-new Date(t.close_at).getTime();case"name":return e.name.localeCompare(t.name);case"opening_date":if(!e.open_at)return 1;if(!t.open_at)return -1;return new Date(t.open_at).getTime()-new Date(e.open_at).getTime();case"target_amount":return(t.target_amount||0)-(e.target_amount||0);default:return 0}}),t},[e,el,en,eo,em,eu,eh,ep,ef,eC,_,D,V]),eA=[el,"all"!==en,"all"!==eo,"all"!==em,"all"!==eu,"all"!==eh,"all"!==ep,"all"!==ef].filter(Boolean).length,eT=()=>{ed(""),ei("all"),ec("all"),ex("all"),eg("all"),eb("all"),ej("all"),eN("all")};return ee?(0,t.jsxs)("div",{className:"p-6 space-y-8",children:[(0,t.jsxs)("header",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-semibold text-foreground",children:"Investment Opportunities"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Track active allocations, NDAs, and subscriptions throughout the deal pipeline."})]}),ea&&Q&&(0,t.jsxs)(t.Fragment,{children:["DUAL_PERSONA"===er&&(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(d.Badge,{variant:"outline",className:"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-700",children:[(0,t.jsx)(I.Share2,{className:"h-3 w-3 mr-1"}),"Partner View"]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)(l.Card,{className:"border-blue-100 dark:border-blue-900/50 bg-gradient-to-br from-blue-50/50 to-white dark:from-blue-950/30 dark:to-card",children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Total Referrals"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(A.UserPlus,{className:"h-4 w-4 text-blue-500"}),"Investors you've shared with"]})]}),(0,t.jsx)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:Q.totalReferrals})]}),(0,t.jsxs)(l.Card,{className:"border-emerald-100 dark:border-emerald-900/50 bg-gradient-to-br from-emerald-50/50 to-white dark:from-emerald-950/30 dark:to-card",children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Converted"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(P.BadgeCheck,{className:"h-4 w-4 text-emerald-500"}),"Funded investments"]})]}),(0,t.jsx)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:Q.converted})]}),(0,t.jsxs)(l.Card,{className:"border-amber-100 dark:border-amber-900/50 bg-gradient-to-br from-amber-50/50 to-white dark:from-amber-950/30 dark:to-card",children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Pipeline Value"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(T.TrendingUp,{className:"h-4 w-4 text-amber-500"}),"In-progress commitments"]})]}),(0,t.jsx)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:Q.pipelineValue>0?X(Q.pipelineValue,Q.currency):"—"})]}),(0,t.jsxs)(l.Card,{className:"border-purple-100 dark:border-purple-900/50 bg-gradient-to-br from-purple-50/50 to-white dark:from-purple-950/30 dark:to-card",children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Pending Commissions"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(L.Wallet,{className:"h-4 w-4 text-purple-500"}),"Accrued, awaiting invoice"]})]}),(0,t.jsx)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:Q.pendingCommissions>0?X(Q.pendingCommissions,Q.currency):"—"})]})]})]}),es&&(0,t.jsxs)(t.Fragment,{children:["DUAL_PERSONA"===er&&(0,t.jsx)("div",{className:"flex items-center gap-2 mt-4",children:(0,t.jsxs)(d.Badge,{variant:"outline",className:"bg-emerald-50 dark:bg-emerald-900/40 text-emerald-700 dark:text-emerald-300 border-emerald-200 dark:border-emerald-700",children:[(0,t.jsx)(m.Activity,{className:"h-3 w-3 mr-1"}),"Investor View"]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Open deals"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(m.Activity,{className:"h-4 w-4 text-emerald-500"}),"Ready for exploration"]})]}),(0,t.jsxs)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:[$.openDeals," / ",$.totalDeals]})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Pending interests"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(j.LineChart,{className:"h-4 w-4 text-amber-500"}),"Awaiting team review"]})]}),(0,t.jsx)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:$.pendingInterests})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Active NDAs"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(p.ShieldCheck,{className:"h-4 w-4 text-sky-500"}),"Data room unlocked"]})]}),(0,t.jsx)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:$.activeNdas})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Subscriptions in review"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(f,{className:"h-4 w-4 text-indigo-500"}),"Awaiting confirmation"]})]}),(0,t.jsx)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:$.submittedSubscriptions})]})]})]}),"GENERIC"===er&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Open deals"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(m.Activity,{className:"h-4 w-4 text-emerald-500"}),"Ready for exploration"]})]}),(0,t.jsxs)(l.CardContent,{className:"text-2xl font-semibold text-foreground",children:[$.openDeals," / ",$.totalDeals]})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm text-muted-foreground",children:"Your Role"}),(0,t.jsxs)(l.CardDescription,{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(N.Users,{className:"h-4 w-4 text-muted-foreground"}),"Tracking access"]})]}),(0,t.jsx)(l.CardContent,{className:"text-lg font-medium text-muted-foreground",children:"View-only access"})]})]})]}),(0,t.jsx)(l.Card,{children:(0,t.jsxs)(l.CardContent,{className:"pt-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(C.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(i.Input,{placeholder:"Search deals by name, company, sector, location...",value:el,onChange:e=>ed(e.target.value),className:"pl-10"})]}),(0,t.jsxs)(n.Button,{variant:"outline",onClick:()=>eS(!ew),className:"gap-2",children:[(0,t.jsx)(S.SlidersHorizontal,{className:"h-4 w-4"}),"Filters",eA>0&&(0,t.jsx)(d.Badge,{variant:"secondary",className:"ml-1",children:eA})]}),eA>0&&(0,t.jsxs)(n.Button,{variant:"ghost",onClick:eT,className:"gap-2",children:[(0,t.jsx)(w.X,{className:"h-4 w-4"}),"Clear"]})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-3",children:[(0,t.jsxs)(o.Select,{value:en,onValueChange:ei,children:[(0,t.jsxs)(o.SelectTrigger,{className:"w-full md:w-[180px]",children:[(0,t.jsx)(v.Filter,{className:"h-4 w-4 mr-2"}),(0,t.jsx)(o.SelectValue,{placeholder:"Status"})]}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"All Status"}),(0,t.jsx)(o.SelectItem,{value:"open",children:"Open"}),(0,t.jsx)(o.SelectItem,{value:"allocation_pending",children:"Allocation Pending"}),(0,t.jsx)(o.SelectItem,{value:"closed",children:"Closed"}),(0,t.jsx)(o.SelectItem,{value:"draft",children:"Draft"}),(0,t.jsx)(o.SelectItem,{value:"cancelled",children:"Cancelled"})]})]}),(0,t.jsxs)(o.Select,{value:eo,onValueChange:ec,children:[(0,t.jsx)(o.SelectTrigger,{className:"w-full md:w-[180px]",children:(0,t.jsx)(o.SelectValue,{placeholder:"Deal Type"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"All Types"}),(0,t.jsx)(o.SelectItem,{value:"equity_secondary",children:"Secondary Equity"}),(0,t.jsx)(o.SelectItem,{value:"equity_primary",children:"Primary Equity"}),(0,t.jsx)(o.SelectItem,{value:"credit_trade_finance",children:"Credit & Trade Finance"}),(0,t.jsx)(o.SelectItem,{value:"other",children:"Other"})]})]}),(0,t.jsxs)(o.Select,{value:eu,onValueChange:eg,children:[(0,t.jsx)(o.SelectTrigger,{className:"w-full md:w-[180px]",children:(0,t.jsx)(o.SelectValue,{placeholder:"My Pipeline"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"All Stages"}),(0,t.jsx)(o.SelectItem,{value:"interested",children:"Interested"}),(0,t.jsx)(o.SelectItem,{value:"nda_access",children:"NDA Access"}),(0,t.jsx)(o.SelectItem,{value:"subscription_submitted",children:"Subscription Submitted"})]})]}),(0,t.jsxs)(o.Select,{value:eC,onValueChange:ev,children:[(0,t.jsx)(o.SelectTrigger,{className:"w-full md:w-[180px]",children:(0,t.jsx)(o.SelectValue,{placeholder:"Sort by"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"closing_date",children:"Closing Date"}),(0,t.jsx)(o.SelectItem,{value:"name",children:"Name (A-Z)"}),(0,t.jsx)(o.SelectItem,{value:"opening_date",children:"Newest First"}),(0,t.jsx)(o.SelectItem,{value:"target_amount",children:"Target Amount"})]})]})]}),ew&&(0,t.jsxs)("div",{className:"pt-4 border-t border-border space-y-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-foreground",children:"Advanced Filters"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[(0,t.jsxs)(o.Select,{value:em,onValueChange:ex,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{placeholder:"Interest Status"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"All Interest Status"}),(0,t.jsx)(o.SelectItem,{value:"no_interest",children:"No Interest Yet"}),(0,t.jsx)(o.SelectItem,{value:"pending_review",children:"Pending Review"}),(0,t.jsx)(o.SelectItem,{value:"approved",children:"Approved (NDA)"}),(0,t.jsx)(o.SelectItem,{value:"rejected",children:"Declined"}),(0,t.jsx)(o.SelectItem,{value:"withdrawn",children:"Withdrawn"})]})]}),(0,t.jsxs)(o.Select,{value:eh,onValueChange:eb,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{placeholder:"Sector"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"All Sectors"}),ek.map(e=>(0,t.jsx)(o.SelectItem,{value:e,children:e},e))]})]}),(0,t.jsxs)(o.Select,{value:ep,onValueChange:ej,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{placeholder:"Stage"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"All Stages"}),ey.map(e=>(0,t.jsx)(o.SelectItem,{value:e,children:e},e))]})]}),(0,t.jsxs)(o.Select,{value:ef,onValueChange:eN,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{placeholder:"Location"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"All Locations"}),e_.map(e=>(0,t.jsx)(o.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2 text-sm text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Showing ",eI.length," of ",e.length," deals"]}),eA>0&&(0,t.jsxs)("span",{className:"text-blue-600 dark:text-blue-400",children:[eA," filter",1!==eA?"s":""," active"]})]})]})}),eD.length>0&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-foreground flex items-center gap-2",children:[(0,t.jsx)(y.Clock,{className:"h-5 w-5 text-amber-500"}),"My Subscriptions"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Track your in-progress subscriptions (Stages 6-9)"})]}),(0,t.jsxs)(d.Badge,{variant:"outline",className:"text-amber-600 border-amber-300",children:[eD.length," in progress"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:eD.map(({deal:e,subscription:r,stageMeta:i})=>{let o=i.icon;return(0,t.jsxs)(l.Card,{className:(0,c.cn)("overflow-hidden border-2 transition-all hover:shadow-md",i.borderColor,i.bgColor),children:[(0,t.jsx)(l.CardHeader,{className:"pb-2",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e.company_logo_url?(0,t.jsx)(s.default,{src:e.company_logo_url,alt:`${e.company_name??e.name} logo`,width:40,height:40,className:"rounded-lg object-contain bg-background border border-border p-1"}):(0,t.jsx)("div",{className:"h-10 w-10 rounded-lg bg-background flex items-center justify-center text-muted-foreground text-lg font-semibold border border-border",children:e.name.charAt(0)}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.CardTitle,{className:"text-base text-foreground",children:e.name}),(0,t.jsx)(l.CardDescription,{className:"text-xs text-muted-foreground",children:e.company_name??"Issuer TBA"})]})]}),(0,t.jsxs)(d.Badge,{className:(0,c.cn)("text-xs font-medium",i.bgColor,i.textColor,i.borderColor,"border"),children:[(0,t.jsx)(o,{className:"h-3 w-3 mr-1"}),i.label]})]})}),(0,t.jsxs)(l.CardContent,{className:"pt-0 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex-1 h-1.5 bg-muted rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:(0,c.cn)("h-full rounded-full transition-all",6===i.stage?"w-1/4 bg-blue-500":7===i.stage?"w-2/4 bg-indigo-500":8===i.stage?"w-3/4 bg-purple-500":"w-full bg-emerald-500")})}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Stage ",i.stage,"/10"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:"Submitted"}),(0,t.jsx)("span",{children:new Date(r.submitted_at).toLocaleDateString()})]}),(0,t.jsx)(a.default,{href:`${O}/${e.id}`,prefetch:!1,onClick:()=>console.log(`[DealsList] CLICKED: "${e.name}" → navigating to ${O}/${e.id}`),"data-deal-id":e.id,"data-deal-name":e.name,children:(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",className:"w-full gap-2 mt-2",children:["View Details",(0,t.jsx)(u.ArrowUpRight,{className:"h-3 w-3"})]})})]})]},r.id)})}),(0,t.jsxs)("div",{className:"flex items-center gap-4 pt-4",children:[(0,t.jsx)("div",{className:"flex-1 h-px bg-border"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Open Opportunities"}),(0,t.jsx)("div",{className:"flex-1 h-px bg-border"})]})]}),0===eI.length?(0,t.jsx)("div",{className:"text-center py-16",children:0===e.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Users,{className:"h-14 w-14 text-muted-foreground/50 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"No deals available yet"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"The team hasn't invited you to any opportunities. We'll notify you as soon as a deal opens up."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.AlertCircle,{className:"h-14 w-14 text-muted-foreground/50 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"No deals match your filters"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your search or filter criteria"}),(0,t.jsx)(n.Button,{onClick:eT,variant:"outline",children:"Clear all filters"})]})}):(0,t.jsx)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:eI.map((e,r)=>{let i,o,m,x,p,j,f;console.log(`[DealsList] Rendering card #${r}: "${e.name}" (ID: ${e.id})`);let C=k.get(e.id)??null,v=_.get(e.id)??null,w=D.get(e.id)??null,S=V.get(e.id)??null,y=e.deal_memberships?.[0]?.role??null,T=!!y&&K.has(y),L=!!y&&!T,P=Z(e),$=W[e.deal_type]??e.deal_type.replace(/_/g," "),J=function(e,t){if(!e)return"closed"===t?"Closed":"Timing to be announced";let r=new Date(e),a=new Date;if("closed"===t||r<a)return`Closed ${r.toLocaleDateString()}`;let s=Math.ceil((r.getTime()-a.getTime())/864e5);return s<=0?"Closing soon":1===s?"Closes tomorrow":s<=14?`Closes in ${s} days`:`Closes ${r.toLocaleDateString()}`}(e.close_at,P),Q=v?.indicative_amount??null,ee=v?.indicative_currency??e.currency??null,et=!!w,el="closed"===P,ed=e.deal_memberships?.[0]?.dispatched_at,en=ed&&Date.now()-new Date(ed).getTime()<6048e5;return(0,t.jsxs)(l.Card,{className:"overflow-hidden border border-border shadow-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[e.company_logo_url?(0,t.jsx)(s.default,{src:e.company_logo_url,alt:`${e.company_name??e.name} logo`,width:56,height:56,className:"rounded-lg object-contain bg-background border border-border p-2"}):(0,t.jsx)("div",{className:"h-14 w-14 rounded-lg bg-muted flex items-center justify-center text-muted-foreground text-xl font-semibold",children:e.name.charAt(0)}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.CardTitle,{className:"text-xl text-foreground flex items-center gap-2",children:[e.name,(0,t.jsx)(d.Badge,{className:(0,c.cn)("text-xs",G[P]??G.draft),children:P.replace(/_/g," ").toUpperCase()}),en&&(0,t.jsx)(d.Badge,{className:"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 text-xs",children:"NEW"})]}),(0,t.jsxs)(l.CardDescription,{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(g.Building2,{className:"h-4 w-4 text-muted-foreground"}),e.company_name??"Issuer TBA"," • ",$]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mt-2 text-xs text-muted-foreground",children:[e.stage&&(0,t.jsxs)("span",{children:["Stage: ",e.stage]}),e.sector&&(0,t.jsxs)("span",{children:["Sector: ",e.sector]}),e.location&&(0,t.jsxs)("span",{children:["Location: ",e.location]})]})]})]}),(0,t.jsxs)("div",{className:"text-right space-y-1",children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Timeline"}),(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:J}),w?.expires_at&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["NDA access until ",new Date(w.expires_at).toLocaleDateString()]})]})]}),e.company_website&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(b.ExternalLink,{className:"h-4 w-4 text-blue-500"}),(0,t.jsx)(a.default,{href:e.company_website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Visit company site"})]})]}),(0,t.jsxs)(l.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Allocation"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-foreground",children:C?.allocation_up_to?X(C.allocation_up_to,e.currency):e.target_amount?X(e.target_amount,e.currency):"(Pending)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Minimum ticket"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-foreground",children:C?.minimum_ticket?X(C.minimum_ticket,e.currency):e.minimum_investment?X(e.minimum_investment,e.currency):"(Pending)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Unit price"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-foreground",children:C?.price_per_share_text?C.price_per_share_text:e.offer_unit_price?`${X(e.offer_unit_price,e.currency)} per unit`:"(Pending)"})]})]}),ea&&(i=U[e.id]||[],o=H[e.id]||[],m=M[e.id]||[],x=m[0]?.rate_bps?`${(m[0].rate_bps/100).toFixed(2)}%`:null,p=o.filter(e=>["funded","active","activated","committed"].includes(e.status?.toLowerCase())).reduce((e,t)=>e+Number(t.commitment||0),0),j=m[0]?.rate_bps??0,f=x&&p>0&&j>0?j/1e4*p:0,0===i.length?(0,t.jsx)("div",{className:"rounded-lg border border-blue-100 dark:border-blue-900/50 bg-blue-50/50 dark:bg-blue-950/30 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(A.UserPlus,{className:"h-4 w-4 text-blue-500 dark:text-blue-400"}),(0,t.jsx)("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:"No referrals yet"})]}),x&&(0,t.jsxs)("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Fee: ",x," of invested"]})]})}):(0,t.jsxs)("div",{className:"rounded-lg border border-blue-100 dark:border-blue-900/50 bg-blue-50/50 dark:bg-blue-950/30 px-4 py-3 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(A.UserPlus,{className:"h-4 w-4 text-blue-500 dark:text-blue-400"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:["Your Referrals (",i.length,")"]})]}),x&&(0,t.jsxs)("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Fee: ",x," of invested"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[i.slice(0,5).map(e=>{let r=Y[((e,t)=>{let r=t.find(t=>t.investor_id===e.investor_id);if(r){let e=r.status?.toLowerCase();if(["funded","active","activated","committed"].includes(e))return"funded";if("signed"===e||r.signed_at)return"signed";if("approved"===e)return"approved";if(["rejected","cancelled","passed","declined"].includes(e))return"passed"}return e.interest_confirmed_at?"interested":"dispatched"})(e,o)];return(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-foreground truncate max-w-[200px]",children:e.investor_name}),(0,t.jsx)(d.Badge,{variant:"outline",className:(0,c.cn)("text-xs",r.bgColor,r.textColor,r.borderColor,"border"),children:r.label})]},e.investor_id)}),i.length>5&&(0,t.jsxs)("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:["+",i.length-5," more referrals"]})]}),f>0&&(0,t.jsxs)("div",{className:"pt-2 border-t border-blue-200 dark:border-blue-800 flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Est. Commission:"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:X(f,m[0]?.currency||e.currency)})]})]})),es&&(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Your pipeline"}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[v?v.is_post_close?(0,t.jsx)(d.Badge,{className:"w-fit bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300",children:"Future interest signal"}):(0,t.jsx)(d.Badge,{className:(0,c.cn)("w-fit",z[v.status].tone),children:z[v.status].label}):(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"No signal yet"}),S&&(0,t.jsxs)(d.Badge,{variant:"outline",className:"text-indigo-600 dark:text-indigo-400 border-indigo-300 dark:border-indigo-700",children:["Subscription ",S.status.replace(/_/g," ")]}),L&&(0,t.jsx)(d.Badge,{variant:"outline",className:"border-amber-200 dark:border-amber-700 text-amber-700 dark:text-amber-300",children:"Tracking only"}),et&&(0,t.jsx)(d.Badge,{variant:"outline",className:"text-sky-600 dark:text-sky-400 border-sky-300 dark:border-sky-700",children:"Data room unlocked"}),C?.interest_confirmation_deadline&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Interest deadline: ",new Date(C.interest_confirmation_deadline).toLocaleDateString()]})]})]})}),"GENERIC"===er&&(0,t.jsx)("div",{className:"rounded-lg border border-border bg-muted px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.Users,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"View-only access"})]})}),es&&v&&Q?(0,t.jsxs)("div",{className:"rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30 px-4 py-3 text-sm text-amber-700 dark:text-amber-300",children:["You indicated interest for approximately"," ",(0,t.jsx)("span",{className:"font-semibold",children:X(Q,ee)}),"."]}):null,(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[(0,t.jsx)(h.CalendarClock,{className:"h-4 w-4 text-muted-foreground"}),e.open_at?`Opened ${new Date(e.open_at).toLocaleDateString()}`:"Opening window announced soon"]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,t.jsxs)(n.Button,{variant:"outline",className:"gap-2","data-deal-id":e.id,"data-deal-name":e.name,onClick:()=>{let t=`${O}/${e.id}`;console.log(`[DealsList] CLICKED: "${e.name}" (ID: ${e.id}) → HARD navigating to ${t}`),window.location.href=t},children:["View details",(0,t.jsx)(u.ArrowUpRight,{className:"h-4 w-4"})]}),!el&&B&&T&&(0,t.jsx)(R.SubscribeNowDialog,{dealId:e.id,dealName:e.name,currency:e.currency,existingSubmission:S,children:(0,t.jsxs)(n.Button,{className:"gap-2 bg-emerald-600 hover:bg-emerald-700",children:["Subscribe to Investment Opportunity",(0,t.jsx)(u.ArrowUpRight,{className:"h-4 w-4"})]})}),B&&T&&(0,t.jsx)(E.InterestModal,{dealId:e.id,dealName:e.name,currency:e.currency,investorId:B,defaultAmount:Q,isClosed:el,children:(0,t.jsxs)(n.Button,{className:"gap-2",variant:el?"secondary":"outline",children:[el?"Notify Me About Similar":"Submit Interest for Data Room",(0,t.jsx)(u.ArrowUpRight,{className:"h-4 w-4"})]})}),F&&!el&&(0,t.jsx)(q,{dealId:e.id,dealName:e.name,partnerId:F,children:(0,t.jsxs)(n.Button,{className:"gap-2 bg-blue-600 hover:bg-blue-700",children:[(0,t.jsx)(I.Share2,{className:"h-4 w-4"}),"Share with Investor"]})})]})]})]})]},e.id)})})]}):(0,t.jsxs)("div",{className:"p-6 space-y-8",children:[(0,t.jsx)("div",{className:"h-24 bg-muted animate-pulse rounded-lg"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,r)=>(0,t.jsx)("div",{className:"h-32 bg-muted animate-pulse rounded-lg"},r))}),(0,t.jsx)("div",{className:"h-48 bg-muted animate-pulse rounded-lg"})]})}e.s(["InvestorDealsListClient",()=>Q],155975)}]);