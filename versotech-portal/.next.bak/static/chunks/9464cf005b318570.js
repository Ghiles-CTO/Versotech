(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50209,e=>{"use strict";var a=e.i(722679),t=e.i(340915),s=e.i(90613),r=e.i(129432),l=e.i(316264),n=e.i(191569),i=e.i(538892),c=e.i(237635),d=e.i(971743),o=e.i(15098),m=e.i(750809),x=e.i(263229),u=e.i(401148),h=e.i(773510),p=e.i(416469),g=e.i(501259),j=e.i(119311),f=e.i(196767),_=e.i(540318),v=e.i(197098),N=e.i(282141),y=e.i(501495),C=e.i(59178),b=e.i(820417),w=e.i(150327),S=e.i(429760),T=e.i(661521),k=e.i(957114),P=e.i(645855),D=e.i(733179),F=e.i(117925),B=e.i(201495),E=e.i(122208),H=e.i(561866),q=e.i(932735);e.i(209586);var I=e.i(52571),L=e.i(352776),R=e.i(514133),U=e.i(816654),A=e.i(168474);let O=[{value:"invested_amount",label:"Invested Amount"},{value:"spread",label:"Spread"},{value:"management_fee",label:"Management Fee"},{value:"performance_fee",label:"Performance Fee"}];function V({open:e,onOpenChange:s,commercialPartnerId:r,commercialPartnerName:c,deals:d,feePlans:o,onSuccess:m}){let[u,h]=(0,t.useState)(!1),[p,g]=(0,t.useState)(null),[j,f]=(0,t.useState)("none"),[_,v]=(0,t.useState)("none"),[N,C]=(0,t.useState)("invested_amount"),[b,w]=(0,t.useState)(""),[S,T]=(0,t.useState)(""),[k,P]=(0,t.useState)(""),[D,F]=(0,t.useState)("USD"),[B,E]=(0,t.useState)(""),[H,q]=(0,t.useState)("");(0,t.useEffect)(()=>{e&&(f("none"),v("none"),C("invested_amount"),w(""),T(""),P(""),F("USD"),E(""),q(""),g(null))},[e]),(0,t.useEffect)(()=>{if(b&&S){let e=parseFloat(b)/1e4,a=parseFloat(S);isNaN(e)||isNaN(a)||P((a*e).toFixed(2))}},[b,S]),(0,t.useEffect)(()=>{if(j&&"none"!==j){let e=d.find(e=>e.id===j);e?.currency&&F(e.currency)}},[j,d]),(0,t.useEffect)(()=>{if(_&&"none"!==_){let e=o.find(e=>e.id===_);if(e?.components&&e.components.length>0){let a=e.components.find(e=>e.rate_bps);a?.rate_bps&&w(a.rate_bps.toString())}}},[_,o]);let I=async()=>{if(!b||0>=parseFloat(b))return void g("Rate is required and must be greater than 0");if(!k||0>=parseFloat(k))return void g("Commission amount is required and must be greater than 0");h(!0),g(null);try{let e={commercial_partner_id:r,deal_id:"none"!==j?j:void 0,fee_plan_id:"none"!==_?_:void 0,basis_type:N,rate_bps:parseInt(b,10),base_amount:S?parseFloat(S):void 0,accrual_amount:parseFloat(k),currency:D,payment_due_date:B||void 0,notes:H||void 0},a=await fetch("/api/arrangers/me/commercial-partner-commissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to record commission")}m(),s(!1)}catch(e){console.error("[RecordCPCommissionDialog] Error:",e),g(e instanceof Error?e.message:"Failed to record commission")}finally{h(!1)}},V=b?(parseFloat(b)/100).toFixed(2):"0.00";return(0,a.jsx)(L.Dialog,{open:e,onOpenChange:s,children:(0,a.jsxs)(L.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(L.DialogHeader,{children:[(0,a.jsx)(L.DialogTitle,{children:"Record Commission"}),(0,a.jsxs)(L.DialogDescription,{children:["Record a commission owed to ",c]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[p&&(0,a.jsx)("div",{className:"bg-destructive/10 border border-destructive/30 text-destructive text-sm p-3 rounded",children:p}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R.Label,{children:"Deal (Optional)"}),(0,a.jsxs)(i.Select,{value:j,onValueChange:f,children:[(0,a.jsx)(i.SelectTrigger,{children:(0,a.jsx)(i.SelectValue,{placeholder:"Select deal..."})}),(0,a.jsxs)(i.SelectContent,{children:[(0,a.jsx)(i.SelectItem,{value:"none",children:"No specific deal"}),d.map(e=>(0,a.jsxs)(i.SelectItem,{value:e.id,children:[e.name," ",e.company_name&&`(${e.company_name})`]},e.id))]})]})]}),o.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R.Label,{children:"Fee Plan (Optional)"}),(0,a.jsxs)(i.Select,{value:_,onValueChange:v,children:[(0,a.jsx)(i.SelectTrigger,{children:(0,a.jsx)(i.SelectValue,{placeholder:"Select fee plan..."})}),(0,a.jsxs)(i.SelectContent,{children:[(0,a.jsx)(i.SelectItem,{value:"none",children:"No fee plan"}),o.map(e=>(0,a.jsx)(i.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R.Label,{children:"Commission Basis"}),(0,a.jsxs)(i.Select,{value:N,onValueChange:C,children:[(0,a.jsx)(i.SelectTrigger,{children:(0,a.jsx)(i.SelectValue,{})}),(0,a.jsx)(i.SelectContent,{children:O.map(e=>(0,a.jsx)(i.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R.Label,{children:"Rate (basis points) *"}),(0,a.jsx)(n.Input,{type:"number",value:b,onChange:e=>w(e.target.value),placeholder:"e.g., 100 = 1%"}),b&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["= ",V,"%"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R.Label,{children:["Base Amount (",D,")"]}),(0,a.jsx)(n.Input,{type:"number",value:S,onChange:e=>T(e.target.value),placeholder:"e.g., 100000"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R.Label,{className:"flex items-center gap-2",children:["Commission Amount (",D,") *",b&&S&&(0,a.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(A.Calculator,{className:"h-3 w-3"}),"Auto-calculated"]})]}),(0,a.jsx)(n.Input,{type:"number",value:k,onChange:e=>P(e.target.value),placeholder:"Commission amount"}),k&&(0,a.jsx)("p",{className:"text-sm font-medium text-primary",children:(0,y.formatCurrency)(parseFloat(k),D)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R.Label,{children:"Payment Due Date (Optional)"}),(0,a.jsx)(n.Input,{type:"date",value:B,onChange:e=>E(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R.Label,{children:"Notes (Optional)"}),(0,a.jsx)(U.Textarea,{value:H,onChange:e=>q(e.target.value),placeholder:"Any additional notes...",rows:2})]})]}),(0,a.jsxs)(L.DialogFooter,{children:[(0,a.jsx)(l.Button,{variant:"outline",onClick:()=>s(!1),disabled:u,children:"Cancel"}),(0,a.jsx)(l.Button,{onClick:I,disabled:u,children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Recording..."]}):"Record Commission"})]})]})})}let z={accrued:{icon:P.Clock,color:"text-blue-600"},invoice_requested:{icon:q.Send,color:"text-yellow-600"},invoice_submitted:{icon:j.FileText,color:"text-indigo-600"},invoiced:{icon:j.FileText,color:"text-orange-600"},paid:{icon:o.CheckCircle2,color:"text-green-600"},cancelled:{icon:u.AlertCircle,color:"text-gray-400"},rejected:{icon:u.AlertCircle,color:"text-red-600"}},$={active:"bg-green-100 text-green-800 border-green-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200",inactive:"bg-gray-100 text-gray-800 border-gray-200",suspended:"bg-red-100 text-red-800 border-red-200",draft:"bg-gray-100 text-gray-800 border-gray-200",pending_internal_approval:"bg-orange-100 text-orange-800 border-orange-200",pending_approval:"bg-yellow-100 text-yellow-800 border-yellow-200",approved:"bg-blue-100 text-blue-800 border-blue-200",rejected:"bg-red-100 text-red-800 border-red-200"},M={approved:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",expired:"bg-red-100 text-red-800",not_started:"bg-gray-100 text-gray-800"};function K({commercialPartnerId:e,open:n,onOpenChange:i}){let[c,o]=(0,t.useState)(null),[m,v]=(0,t.useState)(!1),[C,P]=(0,t.useState)(null),[q,L]=(0,t.useState)(!1),[R,U]=(0,t.useState)([]),[A,O]=(0,t.useState)(!1),[K,G]=(0,t.useState)(null),J=async()=>{if(e)try{v(!0),P(null);let a=await fetch(`/api/arrangers/me/commercial-partners/${e}`);if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to fetch commercial partner details")}let t=await a.json();o(t.data)}catch(e){console.error("[CPDetailDrawer] Error:",e),P(e instanceof Error?e.message:"Failed to load details")}finally{v(!1)}},Y=async()=>{if(e)try{O(!0);let a=await fetch(`/api/arrangers/me/commercial-partner-commissions?commercial_partner_id=${e}`);if(a.ok){let e=await a.json();U(e.data||[])}}catch(e){console.error("[CPDetailDrawer] Error fetching commissions:",e)}finally{O(!1)}};(0,t.useEffect)(()=>{if(!e||!n){o(null),U([]);return}J(),Y()},[e,n]);let W=async e=>{G(e.id);try{let a=await fetch(`/api/arrangers/me/commercial-partner-commissions/${e.id}/request-invoice`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to request invoice")}J(),Y()}catch(e){console.error("[CPDetailDrawer] Request invoice error:",e),alert(e instanceof Error?e.message:"Failed to request invoice")}finally{G(null)}},Q=async e=>{G(e.id);try{let a=await fetch(`/api/arrangers/me/commercial-partner-commissions/${e.id}/request-payment`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to request payment")}J(),Y()}catch(e){console.error("[CPDetailDrawer] Request payment error:",e),alert(e instanceof Error?e.message:"Failed to request payment")}finally{G(null)}};return n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.Sheet,{open:n,onOpenChange:i,children:(0,a.jsx)(w.SheetContent,{className:"w-full sm:max-w-xl overflow-y-auto",children:m?(0,a.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,a.jsx)(x.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):C?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[(0,a.jsx)(u.AlertCircle,{className:"h-12 w-12 text-destructive mb-4"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:C})]}):c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.SheetHeader,{className:"pb-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[c.commercial_partner.logo_url?(0,a.jsx)("img",{src:c.commercial_partner.logo_url,alt:c.commercial_partner.name,className:"h-16 w-16 rounded-lg object-cover"}):(0,a.jsx)("div",{className:"h-16 w-16 rounded-lg bg-muted flex items-center justify-center",children:(0,a.jsx)(d.Building2,{className:"h-8 w-8 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(w.SheetTitle,{className:"text-xl",children:c.commercial_partner.name}),(0,a.jsxs)(w.SheetDescription,{className:"flex items-center gap-2 mt-1",children:[c.commercial_partner.cp_type&&(0,a.jsx)(r.Badge,{variant:"secondary",className:"capitalize",children:c.commercial_partner.cp_type.replace("_"," ")}),c.commercial_partner.jurisdiction&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-xs",children:[(0,a.jsx)(p.Globe,{className:"h-3 w-3"}),c.commercial_partner.jurisdiction]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(r.Badge,{variant:"outline",className:(0,N.cn)("capitalize",$[c.commercial_partner.status]),children:c.commercial_partner.status}),c.commercial_partner.kyc_status&&(0,a.jsxs)(r.Badge,{variant:"secondary",className:(0,N.cn)("text-xs",M[c.commercial_partner.kyc_status]),children:["KYC: ",c.commercial_partner.kyc_status.replace("_"," ")]})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-2 py-4",children:[(0,a.jsxs)(s.Card,{className:"p-3",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Deals"}),(0,a.jsx)("div",{className:"text-lg font-semibold",children:c.stats.total_deals})]}),(0,a.jsxs)(s.Card,{className:"p-3",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Referrals"}),(0,a.jsx)("div",{className:"text-lg font-semibold",children:c.stats.total_referrals})]}),(0,a.jsxs)(s.Card,{className:"p-3",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Fee Plans"}),(0,a.jsx)("div",{className:"text-lg font-semibold",children:c.stats.active_fee_plans})]}),(0,a.jsxs)(s.Card,{className:"p-3",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Agreements"}),(0,a.jsx)("div",{className:"text-lg font-semibold",children:c.stats.active_agreements})]})]}),(0,a.jsx)(T.Separator,{}),(0,a.jsxs)(S.Tabs,{defaultValue:"overview",className:"mt-4",children:[(0,a.jsxs)(S.TabsList,{className:"grid w-full grid-cols-5",children:[(0,a.jsx)(S.TabsTrigger,{value:"overview",children:"Overview"}),(0,a.jsx)(S.TabsTrigger,{value:"fee-plans",children:"Fee Plans"}),(0,a.jsx)(S.TabsTrigger,{value:"commissions",children:"Commissions"}),(0,a.jsx)(S.TabsTrigger,{value:"agreements",children:"Agreements"}),(0,a.jsx)(S.TabsTrigger,{value:"referrals",children:"Referrals"})]}),(0,a.jsxs)(S.TabsContent,{value:"overview",className:"space-y-4 mt-4",children:[(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsx)(s.CardTitle,{className:"text-sm",children:"Contact Information"})}),(0,a.jsxs)(s.CardContent,{className:"space-y-2",children:[c.commercial_partner.contact_name&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(g.Users,{className:"h-4 w-4 text-muted-foreground"}),c.commercial_partner.contact_name]}),c.commercial_partner.contact_email&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(h.Mail,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("a",{href:`mailto:${c.commercial_partner.contact_email}`,className:"text-primary hover:underline",children:c.commercial_partner.contact_email})]}),c.commercial_partner.contact_phone&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(k.Phone,{className:"h-4 w-4 text-muted-foreground"}),c.commercial_partner.contact_phone]}),c.commercial_partner.country&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(p.Globe,{className:"h-4 w-4 text-muted-foreground"}),c.commercial_partner.country]})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsx)(s.CardTitle,{className:"text-sm",children:"Regulatory Information"})}),(0,a.jsxs)(s.CardContent,{className:"space-y-2",children:[c.commercial_partner.regulatory_status&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(F.ShieldCheck,{className:"h-4 w-4 text-muted-foreground"}),"Status: ",c.commercial_partner.regulatory_status]}),c.commercial_partner.jurisdiction&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(B.Scale,{className:"h-4 w-4 text-muted-foreground"}),"Jurisdiction: ",c.commercial_partner.jurisdiction]}),c.commercial_partner.contract_end_date&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(E.CalendarDays,{className:"h-4 w-4 text-muted-foreground"}),"Contract expires: ",(0,y.formatDate)(c.commercial_partner.contract_end_date)]})]})]}),c.deals.length>0&&(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsx)(s.CardTitle,{className:"text-sm",children:"Deals Involved"})}),(0,a.jsx)(s.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[c.deals.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)(r.Badge,{variant:"outline",className:"capitalize",children:e.status})]},e.id)),c.deals.length>5&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",c.deals.length-5," more deals"]})]})})]})]}),(0,a.jsx)(S.TabsContent,{value:"fee-plans",className:"space-y-4 mt-4",children:0===c.fee_plans.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(j.FileText,{className:"h-10 w-10 text-muted-foreground mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No fee plans assigned"}),(0,a.jsx)(l.Button,{variant:"outline",size:"sm",className:"mt-4",asChild:!0,children:(0,a.jsx)(b.default,{href:"/versotech_main/fee-plans",children:"Create Fee Plan"})})]}):c.fee_plans.map(e=>(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(s.CardTitle,{className:"text-sm",children:e.name}),(0,a.jsx)(r.Badge,{variant:e.is_active?"default":"secondary",children:e.is_active?"Active":"Inactive"})]}),e.description&&(0,a.jsx)(s.CardDescription,{className:"text-xs",children:e.description})]}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mb-2",children:["Effective: ",(0,y.formatDate)(e.effective_from||""),e.effective_until&&` - ${(0,y.formatDate)(e.effective_until)}`]}),e.components&&e.components.length>0&&(0,a.jsx)("div",{className:"space-y-1",children:e.components.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs bg-muted/50 p-2 rounded",children:[(0,a.jsx)("span",{className:"capitalize",children:e.kind.replace("_"," ")}),(0,a.jsx)("span",{className:"font-medium",children:e.rate_bps?`${(e.rate_bps/100).toFixed(2)}%`:(0,y.formatCurrency)(e.flat_amount||0,"USD")})]},e.id))})]})]},e.id))}),(0,a.jsxs)(S.TabsContent,{value:"commissions",className:"space-y-4 mt-4",children:[(0,a.jsx)(I.PartnerCommissionSummary,{summary:c.commission_summary,variant:"card"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>L(!0),children:[(0,a.jsx)(f.DollarSign,{className:"h-4 w-4 mr-2"}),"Record Commission"]}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,a.jsxs)(b.default,{href:"/versotech_main/lawyer-reconciliation",children:[(0,a.jsx)(D.TrendingUp,{className:"h-4 w-4 mr-2"}),"Reconciliation"]})})]}),A?(0,a.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,a.jsx)(x.Loader2,{className:"h-4 w-4 animate-spin"})}):R.length>0?(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsx)(s.CardTitle,{className:"text-sm",children:"Recent Commissions"})}),(0,a.jsx)(s.CardContent,{className:"space-y-2",children:R.slice(0,10).map(e=>{let t=z[e.status]||z.accrued,s=t.icon;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-md bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(s,{className:(0,N.cn)("h-4 w-4",t.color)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:(0,y.formatCurrency)(e.accrual_amount,e.currency)}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.deal?.name||"No deal"," • ",(0,y.formatDate)(e.created_at)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.Badge,{variant:"outline",className:"text-xs capitalize",children:e.status.replace(/_/g," ")}),"accrued"===e.status&&(0,a.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>W(e),disabled:K===e.id,children:K===e.id?(0,a.jsx)(x.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.FileText,{className:"h-3.5 w-3.5 mr-1"}),"Request Invoice"]})}),"invoiced"===e.status&&(0,a.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>Q(e),disabled:K===e.id,children:K===e.id?(0,a.jsx)(x.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.CreditCard,{className:"h-3.5 w-3.5 mr-1"}),"Request Payment"]})})]})]},e.id)})})]}):(0,a.jsx)(s.Card,{children:(0,a.jsx)(s.CardContent,{className:"py-6 text-center text-muted-foreground text-sm",children:"No commissions recorded yet"})})]}),(0,a.jsx)(S.TabsContent,{value:"agreements",className:"space-y-4 mt-4",children:0===c.placement_agreements.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(_.Handshake,{className:"h-10 w-10 text-muted-foreground mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No placement agreements"})]}):c.placement_agreements.map(e=>(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(s.CardTitle,{className:"text-sm capitalize",children:[e.agreement_type.replace("_"," ")," Agreement"]}),(0,a.jsx)(r.Badge,{variant:"outline",className:(0,N.cn)("capitalize",$[e.status]),children:e.status.replace(/_/g," ")})]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Commission:"}),(0,a.jsxs)("span",{className:"ml-1 font-medium",children:[(e.default_commission_bps/100).toFixed(2),"%"]})]}),e.commission_cap_amount&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Cap:"}),(0,a.jsx)("span",{className:"ml-1 font-medium",children:(0,y.formatCurrency)(e.commission_cap_amount,"USD")})]}),e.territory&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Territory:"}),(0,a.jsx)("span",{className:"ml-1",children:e.territory})]}),e.exclusivity_level&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Exclusivity:"}),(0,a.jsx)("span",{className:"ml-1 capitalize",children:e.exclusivity_level.replace("_"," ")})]})]}),e.effective_date&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Effective: ",(0,y.formatDate)(e.effective_date),e.expiry_date&&` - ${(0,y.formatDate)(e.expiry_date)}`]})]})]},e.id))}),(0,a.jsx)(S.TabsContent,{value:"referrals",className:"space-y-4 mt-4",children:0===c.recent_referrals.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(g.Users,{className:"h-10 w-10 text-muted-foreground mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No referrals yet"})]}):(0,a.jsx)("div",{className:"space-y-2",children:c.recent_referrals.map(e=>(0,a.jsx)(s.Card,{className:"p-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.investor?.name||"Unknown Investor"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.deal?.name||"Unknown Deal"})]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,y.formatDate)(e.created_at)})]})},e.id))})})]})]}):null})}),c&&(0,a.jsx)(V,{open:q,onOpenChange:L,commercialPartnerId:c.commercial_partner.id,commercialPartnerName:c.commercial_partner.name,deals:c.deals,feePlans:c.fee_plans,onSuccess:()=>{J(),Y()}})]}):null}let G={active:"bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 border-green-200 dark:border-green-700",pending:"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300 border-yellow-200 dark:border-yellow-700",inactive:"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-300 border-gray-200 dark:border-gray-600",suspended:"bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300 border-red-200 dark:border-red-700"},J={approved:"bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300",pending:"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300",expired:"bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300",not_started:"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-300"},Y=[{label:"All Status",value:"all"},{label:"Active",value:"active"},{label:"Pending",value:"pending"},{label:"Inactive",value:"inactive"}];function W(){let[e,w]=(0,t.useState)(null),[S,T]=(0,t.useState)(null),[k,P]=(0,t.useState)([]),[D,F]=(0,t.useState)([]),[B,E]=(0,t.useState)({totalCPs:0,activeCPs:0,totalClients:0,totalPlacementValue:0,totalOwed:0,totalPaid:0}),[H,q]=(0,t.useState)(!0),[L,R]=(0,t.useState)(null),[U,A]=(0,t.useState)(""),[O,V]=(0,t.useState)("all"),[z,$]=(0,t.useState)("all"),[M,W]=(0,t.useState)(null),[Q,X]=(0,t.useState)(!1);(0,t.useEffect)(()=>{async function e(e){let{data:a,error:t}=await e.from("commercial_partners").select("*").order("name").limit(100);if(t)throw t;let s={accrued:0,invoice_requested:0,invoiced:0,paid:0,cancelled:0,total_owed:0,currency:"USD"},r=(a||[]).map(e=>({id:e.id,name:e.name||e.legal_name||"Unknown CP",legal_name:e.legal_name,cp_type:e.cp_type,status:e.status||"active",regulatory_status:e.regulatory_status,jurisdiction:e.jurisdiction,contact_name:e.contact_name,contact_email:e.contact_email,contact_phone:e.contact_phone,country:e.country,logo_url:e.logo_url,kyc_status:e.kyc_status,contract_end_date:e.contract_end_date,deals_count:0,clients_count:0,total_placement_value:0,fee_plans:[],commission_summary:s,deal_ids:[]}));P(r),E({totalCPs:r.length,activeCPs:r.filter(e=>"active"===e.status).length,totalClients:0,totalPlacementValue:0,totalOwed:0,totalPaid:0})}!async function(){try{q(!0);let a=(0,C.createClient)(),{data:{user:t}}=await a.auth.getUser();if(!t)return void R("Not authenticated");let{data:s,error:r}=await a.from("arranger_users").select("arranger_id").eq("user_id",t.id).single();if(r||!s)return void await e(a);T(s.arranger_id);let{data:l,error:n}=await a.from("arranger_entities").select("id, legal_name, status").eq("id",s.arranger_id).single();if(n)throw n;w(l);let{data:i,error:c}=await a.from("deals").select("id, name, company_name").eq("arranger_entity_id",s.arranger_id).order("name");if(c)throw c;if(F(i||[]),!i||0===i.length){P([]),E({totalCPs:0,activeCPs:0,totalClients:0,totalPlacementValue:0,totalOwed:0,totalPaid:0});return}let d=i.map(e=>e.id),{data:o,error:m}=await a.from("deal_memberships").select("referred_by_entity_id, investor_id, deal_id, deal:deal_id (id, name)").in("deal_id",d).eq("referred_by_entity_type","commercial_partner").not("referred_by_entity_id","is",null);if(m)throw m;let x=[...new Set((o||[]).map(e=>e.referred_by_entity_id))];if(0===x.length){P([]),E({totalCPs:0,activeCPs:0,totalClients:0,totalPlacementValue:0,totalOwed:0,totalPaid:0});return}let{data:u,error:h}=await a.from("commercial_partners").select("*").in("id",x).order("name");if(h)throw h;let{data:p}=await a.from("commercial_partner_clients").select("commercial_partner_id").in("commercial_partner_id",x),g=new Map;(p||[]).forEach(e=>{let a=g.get(e.commercial_partner_id)||0;g.set(e.commercial_partner_id,a+1)});let j=[...new Set((o||[]).filter(e=>e.investor_id).map(e=>e.investor_id))],{data:f}=await a.from("subscriptions").select("investor_id, commitment").in("investor_id",j),_=new Map;(f||[]).forEach(e=>{let a=_.get(e.investor_id)||0;_.set(e.investor_id,a+(Number(e.commitment)||0))});let{data:v}=await a.from("fee_plans").select("id, name, is_active, commercial_partner_id").in("commercial_partner_id",x).eq("created_by_arranger_id",s.arranger_id),N=new Map;(v||[]).forEach(e=>{let a=N.get(e.commercial_partner_id)||[];a.push({id:e.id,name:e.name,is_active:e.is_active}),N.set(e.commercial_partner_id,a)});let{data:y}=await a.from("commercial_partner_commissions").select("commercial_partner_id, status, accrual_amount, currency").in("commercial_partner_id",x).eq("arranger_id",s.arranger_id),b=new Map;x.forEach(e=>{b.set(e,{accrued:0,invoice_requested:0,invoiced:0,paid:0,cancelled:0,total_owed:0,currency:"USD"})}),(y||[]).forEach(e=>{let a=b.get(e.commercial_partner_id);if(!a)return;let t=Number(e.accrual_amount)||0;"accrued"===e.status?a.accrued+=t:"invoice_requested"===e.status?a.invoice_requested+=t:"invoiced"===e.status?a.invoiced+=t:"paid"===e.status?a.paid+=t:"cancelled"===e.status&&(a.cancelled+=t),["accrued","invoice_requested","invoiced"].includes(e.status)&&(a.total_owed+=t),e.currency&&(a.currency=e.currency)});let S=(u||[]).map(e=>{let a=(o||[]).filter(a=>a.referred_by_entity_id===e.id),t=[...new Set(a.map(e=>{let a=Array.isArray(e.deal)?e.deal[0]:e.deal;return a?.id}).filter(Boolean))],s=a.reduce((e,a)=>a.investor_id?e+(_.get(a.investor_id)||0):e,0);return{id:e.id,name:e.name||e.legal_name||"Unknown CP",legal_name:e.legal_name,cp_type:e.cp_type,status:e.status||"active",regulatory_status:e.regulatory_status,jurisdiction:e.jurisdiction,contact_name:e.contact_name,contact_email:e.contact_email,contact_phone:e.contact_phone,country:e.country,logo_url:e.logo_url,kyc_status:e.kyc_status,contract_end_date:e.contract_end_date,deals_count:t.length,clients_count:g.get(e.id)||0,total_placement_value:s,fee_plans:N.get(e.id)||[],commission_summary:b.get(e.id)||{accrued:0,invoice_requested:0,invoiced:0,paid:0,cancelled:0,total_owed:0,currency:"USD"},deal_ids:t}});P(S);let k=S.filter(e=>"active"===e.status).length,D=S.reduce((e,a)=>e+a.clients_count,0),B=S.reduce((e,a)=>e+a.total_placement_value,0),H=S.reduce((e,a)=>e+a.commission_summary.total_owed,0),I=S.reduce((e,a)=>e+a.commission_summary.paid,0);E({totalCPs:S.length,activeCPs:k,totalClients:D,totalPlacementValue:B,totalOwed:H,totalPaid:I}),R(null)}catch(e){console.error("[MyCommercialPartnersPage] Error:",e),R(e instanceof Error?e.message:"Failed to load commercial partners")}finally{q(!1)}}()},[]);let Z=k.filter(e=>{let a="all"===O||e.status===O,t=!U||e.name?.toLowerCase().includes(U.toLowerCase())||e.legal_name?.toLowerCase().includes(U.toLowerCase())||e.contact_name?.toLowerCase().includes(U.toLowerCase())||e.jurisdiction?.toLowerCase().includes(U.toLowerCase()),s="all"===z||e.deal_ids.includes(z);return a&&t&&s}),ee=new Date,ea=new Date(ee.getTime()+2592e6);return H?(0,a.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,a.jsx)(x.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,a.jsx)("span",{className:"ml-3 text-muted-foreground",children:"Loading commercial partners..."})]}):L?(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)(u.AlertCircle,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Error Loading Commercial Partners"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:L})]}):(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"My Commercial Partners"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:e?`Commercial partners working with ${e.legal_name}`:"View all commercial partners"})]}),(0,a.jsx)(b.default,{href:"/versotech_main/fee-plans",children:(0,a.jsxs)(l.Button,{variant:"outline",size:"sm",children:[(0,a.jsx)(j.FileText,{className:"h-4 w-4 mr-2"}),"Fee Plans"]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(d.Building2,{className:"h-4 w-4"}),"Total CPs"]})}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:B.totalCPs}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"In your network"})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(o.CheckCircle2,{className:"h-4 w-4"}),"Active"]})}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:B.activeCPs}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"With valid contracts"})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(g.Users,{className:"h-4 w-4"}),"Clients"]})}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:B.totalClients}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Total clients served"})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(_.Handshake,{className:"h-4 w-4"}),"Placement Value"]})}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:(0,y.formatCurrency)(B.totalPlacementValue,"USD")}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Total placed"})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(f.DollarSign,{className:"h-4 w-4"}),"Fees Owed"]})}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:(0,y.formatCurrency)(B.totalOwed,"USD")}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Pending payment"})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{className:"pb-2",children:(0,a.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(o.CheckCircle2,{className:"h-4 w-4"}),"Fees Paid"]})}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:(0,y.formatCurrency)(B.totalPaid,"USD")}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Total paid out"})]})]})]}),(0,a.jsx)(s.Card,{children:(0,a.jsx)(s.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(m.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(n.Input,{placeholder:"Search commercial partners...",value:U,onChange:e=>A(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(i.Select,{value:O,onValueChange:V,children:[(0,a.jsx)(i.SelectTrigger,{className:"w-full md:w-48",children:(0,a.jsx)(i.SelectValue,{placeholder:"Filter by status"})}),(0,a.jsx)(i.SelectContent,{children:Y.map(e=>(0,a.jsx)(i.SelectItem,{value:e.value,children:e.label},e.value))})]}),D.length>0&&(0,a.jsxs)(i.Select,{value:z,onValueChange:$,children:[(0,a.jsx)(i.SelectTrigger,{className:"w-full md:w-56",children:(0,a.jsx)(i.SelectValue,{placeholder:"Filter by deal"})}),(0,a.jsxs)(i.SelectContent,{children:[(0,a.jsx)(i.SelectItem,{value:"all",children:"All Deals"}),D.map(e=>(0,a.jsx)(i.SelectItem,{value:e.id,children:e.name},e.id))]})]})]})})}),(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsx)(s.CardTitle,{children:"Commercial Partners"}),(0,a.jsxs)(s.CardDescription,{children:[Z.length," partner",1!==Z.length?"s":""," found",e&&" • Click a row to view details"]})]}),(0,a.jsx)(s.CardContent,{children:0===Z.length?(0,a.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,a.jsx)(d.Building2,{className:"h-10 w-10 text-muted-foreground"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:U||"all"!==O?"No partners match your filters":"No commercial partners in your network yet"})]}):(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(c.Table,{children:[(0,a.jsx)(c.TableHeader,{children:(0,a.jsxs)(c.TableRow,{children:[(0,a.jsx)(c.TableHead,{children:"Partner"}),(0,a.jsx)(c.TableHead,{children:"Type"}),(0,a.jsx)(c.TableHead,{children:"Jurisdiction"}),(0,a.jsx)(c.TableHead,{children:"Fee Plans"}),(0,a.jsx)(c.TableHead,{children:"Placements"}),(0,a.jsx)(c.TableHead,{children:"Payments"}),(0,a.jsx)(c.TableHead,{children:"Status"}),(0,a.jsx)(c.TableHead,{className:"w-10"})]})}),(0,a.jsx)(c.TableBody,{children:Z.map(t=>{let s=t.contract_end_date&&new Date(t.contract_end_date)<=ea&&new Date(t.contract_end_date)>ee,l=t.contract_end_date&&new Date(t.contract_end_date)<=ee;return(0,a.jsxs)(c.TableRow,{className:(0,N.cn)(e&&"cursor-pointer hover:bg-muted/50 transition-colors"),onClick:()=>e&&void(W(t.id),X(!0)),children:[(0,a.jsx)(c.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[t.logo_url?(0,a.jsx)("img",{src:t.logo_url,alt:t.name,className:"h-10 w-10 rounded-lg object-cover"}):(0,a.jsx)("div",{className:"h-10 w-10 rounded-lg bg-muted flex items-center justify-center",children:(0,a.jsx)(d.Building2,{className:"h-5 w-5 text-muted-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:t.name}),t.contact_email&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(h.Mail,{className:"h-3 w-3"}),t.contact_email]})]})]})}),(0,a.jsx)(c.TableCell,{children:t.cp_type?(0,a.jsx)(r.Badge,{variant:"secondary",className:"capitalize",children:t.cp_type.replace("_"," ")}):(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"—"})}),(0,a.jsx)(c.TableCell,{children:t.jurisdiction?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(p.Globe,{className:"h-3 w-3 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:t.jurisdiction})]}):(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"—"})}),(0,a.jsx)(c.TableCell,{children:t.fee_plans.length>0?(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[t.fee_plans.slice(0,2).map(e=>(0,a.jsx)(r.Badge,{variant:e.is_active?"default":"secondary",className:"text-xs",children:e.name},e.id)),t.fee_plans.length>2&&(0,a.jsxs)(r.Badge,{variant:"outline",className:"text-xs",children:["+",t.fee_plans.length-2]})]}):(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"No fee plans"})}),(0,a.jsx)(c.TableCell,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:(0,y.formatCurrency)(t.total_placement_value,"USD")}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[t.deals_count," deal",1!==t.deals_count?"s":""," • ",t.clients_count," client",1!==t.clients_count?"s":""]})]})}),(0,a.jsx)(c.TableCell,{children:(0,a.jsx)(I.PartnerCommissionSummary,{summary:t.commission_summary,variant:"inline"})}),(0,a.jsx)(c.TableCell,{children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(r.Badge,{variant:"outline",className:(0,N.cn)("capitalize",G[t.status]||G.active),children:t.status}),t.kyc_status&&(0,a.jsx)("div",{children:(0,a.jsxs)(r.Badge,{variant:"secondary",className:(0,N.cn)("text-xs",J[t.kyc_status]||""),children:["KYC: ",t.kyc_status.replace("_"," ")]})}),l&&(0,a.jsx)(r.Badge,{variant:"destructive",className:"text-xs",children:"Contract Expired"}),s&&!l&&(0,a.jsx)(r.Badge,{variant:"outline",className:"text-xs bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300",children:"Expiring Soon"})]})}),(0,a.jsx)(c.TableCell,{children:e&&(0,a.jsx)(v.ChevronRight,{className:"h-4 w-4 text-muted-foreground"})})]},t.id)})})]})})})]}),(0,a.jsx)(K,{commercialPartnerId:M,open:Q,onOpenChange:X})]})}e.s(["default",()=>W],50209)}]);