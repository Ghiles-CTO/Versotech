(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,38207,e=>{"use strict";var t=e.i(722679),s=e.i(340915),r=e.i(603274);let a=(0,s.createContext)(void 0);function i({children:e}){let[i,n]=(0,s.useState)(!1),l=(0,r.useRouter)(),o=(0,s.useCallback)(()=>{l.refresh()},[l]);return(0,t.jsx)(a.Provider,{value:{open:i,setOpen:n,refresh:o},children:e})}function n(){let e=(0,s.useContext)(a);if(!e)throw Error("useAddIntroducer must be used within a AddIntroducerProvider");return e}e.s(["AddIntroducerProvider",()=>i,"useAddIntroducer",()=>n])},205601,e=>{"use strict";var t=e.i(722679),s=e.i(340915),r=e.i(603274),a=e.i(994500),i=e.i(820417),n=e.i(90613),l=e.i(129432),o=e.i(316264),d=e.i(191569),c=e.i(538892),u=e.i(180952),m=e.i(501259),x=e.i(196767),h=e.i(645855),p=e.i(831833),j=e.i(382021),g=e.i(750809),v=e.i(733179),f=e.i(551544),N=e.i(335994),C=e.i(119311),b=e.i(932735),y=e.i(849110),S=e.i(510166),w=e.i(786560),I=e.i(282141),T=e.i(501495),D=e.i(15098),A=e.i(38207),P=e.i(489733),k=e.i(352776),F=e.i(514133),E=e.i(816654),L=e.i(80289),O=e.i(619324),_=e.i(263229),V=e.i(59178);function B({open:e,onOpenChange:n,introducers:l,deals:u}){let[m,x]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[j,g]=(0,s.useState)(""),[v,f]=(0,s.useState)(""),[N,C]=(0,s.useState)(""),[b,y]=(0,s.useTransition)(),[S,w]=(0,s.useState)("none"),I=(0,r.useRouter)();(0,s.useEffect)(()=>{m?(async()=>{w("loading");try{let e=(0,V.createClient)(),t=new Date().toISOString().split("T")[0],{data:s,error:r}=await e.from("introducer_agreements").select("id, status, signed_date, expiry_date").eq("introducer_id",m).eq("status","active").not("signed_date","is",null).or(`expiry_date.is.null,expiry_date.gte.${t}`).limit(1);if(r){console.error("Error checking agreement:",r),w("invalid");return}s&&s.length>0?w("valid"):w("invalid")}catch(e){console.error("Error checking agreement:",e),w("invalid")}})():w("none")},[m]);let T=()=>{x(""),p(""),g(""),f(""),C(""),w("none")};return(0,t.jsx)(k.Dialog,{open:e,onOpenChange:e=>{n(e),e||T()},children:(0,t.jsxs)(k.DialogContent,{className:"max-w-lg",children:[(0,t.jsxs)(k.DialogHeader,{children:[(0,t.jsx)(k.DialogTitle,{children:"Record Introduction"}),(0,t.jsx)(k.DialogDescription,{children:"Track a new referral from an introducer partner."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{children:"Introducer"}),(0,t.jsxs)(c.Select,{value:m,onValueChange:x,children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Select introducer"})}),(0,t.jsx)(c.SelectContent,{children:l.map(e=>(0,t.jsx)(c.SelectItem,{value:e.id,children:e.legalName},e.id))})]}),m&&"loading"===S&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-1",children:[(0,t.jsx)(_.Loader2,{className:"h-3 w-3 animate-spin"}),"Checking agreement status..."]}),m&&"valid"===S&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-600 mt-1",children:[(0,t.jsx)(D.CheckCircle2,{className:"h-3 w-3"}),"Valid signed agreement on file"]}),m&&"invalid"===S&&(0,t.jsxs)(L.Alert,{variant:"destructive",className:"mt-2",children:[(0,t.jsx)(O.AlertTriangle,{className:"h-4 w-4"}),(0,t.jsxs)(L.AlertDescription,{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:"This introducer does not have a valid signed agreement."}),(0,t.jsx)(i.default,{href:`/versotech_main/introducers/${m}?tab=agreements`,className:"text-xs underline ml-2 whitespace-nowrap",children:"Create Agreement"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{htmlFor:"prospectEmail",children:"Prospect Email"}),(0,t.jsx)(d.Input,{id:"prospectEmail",type:"email",value:h,onChange:e=>p(e.target.value),placeholder:"prospect@example.com"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{children:"Deal"}),(0,t.jsxs)(c.Select,{value:j,onValueChange:g,children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Select deal"})}),(0,t.jsx)(c.SelectContent,{children:u.map(e=>(0,t.jsx)(c.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{htmlFor:"commissionOverride",children:"Commission Rate Override (bps, optional)"}),(0,t.jsx)(d.Input,{id:"commissionOverride",type:"number",min:0,max:300,value:v,onChange:e=>f(""===e.target.value?"":Number(e.target.value)),placeholder:"Leave empty to use introducer's default rate"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{htmlFor:"notes",children:"Notes"}),(0,t.jsx)(E.Textarea,{id:"notes",value:N,onChange:e=>C(e.target.value),placeholder:"Additional context about this introduction...",rows:3})]})]}),(0,t.jsxs)(k.DialogFooter,{children:[(0,t.jsx)(o.Button,{variant:"outline",onClick:()=>n(!1),disabled:b,children:"Cancel"}),(0,t.jsx)(o.Button,{onClick:()=>{y(async()=>{if(!m||""===m.trim())return void a.toast.error("Please select an introducer");if(!h.trim())return void a.toast.error("Prospect email is required");if(!j||""===j.trim())return void a.toast.error("Please select a deal");if(""!==v&&(0>Number(v)||Number(v)>300))return void a.toast.error("Commission override must be between 0 and 300 bps");try{let e={introducer_id:m,prospect_email:h.trim(),deal_id:j,commission_rate_override_bps:""===v?null:Number(v),notes:N.trim()||null},t=await fetch("/api/staff/introductions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e,s=await t.text();try{e=JSON.parse(s)}catch(e){a.toast.error(`Failed to create introduction: ${s||"Unknown error"}`);return}e?.details?a.toast.error(`Validation failed: ${JSON.stringify(e.details.fieldErrors||e.details)}`):a.toast.error(e?.error??"Failed to create introduction");return}a.toast.success("Introduction recorded"),n(!1),T(),I.refresh()}catch(e){a.toast.error("Failed to create introduction")}})},disabled:b||"invalid"===S||"loading"===S,children:b?"Recording…":"Record Introduction"})]})]})})}function R({open:e,onOpenChange:i,introduction:n,introducers:l=[],deals:u=[]}){let[m,x]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[j,g]=(0,s.useState)(""),[v,f]=(0,s.useState)(""),[N,C]=(0,s.useState)(""),[b,y]=(0,s.useState)(""),[S,w]=(0,s.useTransition)(),I=(0,r.useRouter)();return((0,s.useEffect)(()=>{n&&(x(n.introducerId||""),p(n.prospectEmail),g(n.dealId||""),f(n.status),C(n.commissionRateOverrideBps||""),y(n.notes||""))},[n]),n)?(0,t.jsx)(k.Dialog,{open:e,onOpenChange:i,children:(0,t.jsxs)(k.DialogContent,{className:"max-w-lg",children:[(0,t.jsxs)(k.DialogHeader,{children:[(0,t.jsx)(k.DialogTitle,{children:"Edit Introduction"}),(0,t.jsx)(k.DialogDescription,{children:"Update introduction status and details."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{children:"Introducer"}),l.length>0?(0,t.jsxs)(c.Select,{value:m,onValueChange:x,children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Select introducer"})}),(0,t.jsx)(c.SelectContent,{children:l.map(e=>(0,t.jsx)(c.SelectItem,{value:e.id,children:e.legalName},e.id))})]}):(0,t.jsx)(d.Input,{value:n.introducerName,disabled:!0,className:"bg-muted"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{htmlFor:"prospectEmail",children:"Prospect Email"}),(0,t.jsx)(d.Input,{id:"prospectEmail",type:"email",value:h,onChange:e=>p(e.target.value),placeholder:"prospect@example.com"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{children:"Deal"}),u.length>0?(0,t.jsxs)(c.Select,{value:j,onValueChange:g,children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Select deal"})}),(0,t.jsx)(c.SelectContent,{children:u.map(e=>(0,t.jsx)(c.SelectItem,{value:e.id,children:e.name},e.id))})]}):(0,t.jsx)(d.Input,{value:n.dealName,disabled:!0,className:"bg-muted"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{children:"Status"}),(0,t.jsxs)(c.Select,{value:v,onValueChange:f,children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Select status"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"invited",children:"Invited"}),(0,t.jsx)(c.SelectItem,{value:"joined",children:"Joined"}),(0,t.jsx)(c.SelectItem,{value:"allocated",children:"Allocated"}),(0,t.jsx)(c.SelectItem,{value:"lost",children:"Lost"}),(0,t.jsx)(c.SelectItem,{value:"inactive",children:"Inactive"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{htmlFor:"commissionOverride",children:"Commission Rate Override (bps, optional)"}),(0,t.jsx)(d.Input,{id:"commissionOverride",type:"number",min:0,max:300,value:N,onChange:e=>C(""===e.target.value?"":Number(e.target.value)),placeholder:"Leave empty to use introducer's default rate"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(F.Label,{htmlFor:"notes",children:"Notes"}),(0,t.jsx)(E.Textarea,{id:"notes",value:b,onChange:e=>y(e.target.value),placeholder:"Additional context about this introduction...",rows:3})]})]}),(0,t.jsxs)(k.DialogFooter,{className:"flex justify-between",children:[(0,t.jsx)(o.Button,{variant:"destructive",onClick:()=>{!n||confirm("Are you sure you want to delete this introduction? This action cannot be undone.")&&w(async()=>{try{let e=await fetch(`/api/staff/introductions/${n.id}`,{method:"DELETE"});if(!e.ok){let t=await e.json().catch(()=>null);a.toast.error(t?.error??"Failed to delete introduction");return}a.toast.success("Introduction deleted"),i(!1),I.refresh()}catch(e){a.toast.error("Failed to delete introduction")}})},disabled:S,children:"Delete"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.Button,{variant:"outline",onClick:()=>i(!1),disabled:S,children:"Cancel"}),(0,t.jsx)(o.Button,{onClick:()=>{n&&w(async()=>{if(!h.trim())return void a.toast.error("Prospect email is required");if(""!==N&&(0>Number(N)||Number(N)>300))return void a.toast.error("Commission override must be between 0 and 300 bps");try{let e={status:v,commission_rate_override_bps:""===N?null:Number(N),notes:b.trim()||null};m&&m!==n.introducerId&&(e.introducer_id=m),h.trim()!==n.prospectEmail&&(e.prospect_email=h.trim()),j&&j!==n.dealId&&(e.deal_id=j);let t=await fetch(`/api/staff/introductions/${n.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e,s=await t.text();try{e=JSON.parse(s)}catch(e){a.toast.error(`Failed to update introduction: ${s||"Unknown error"}`);return}e?.details?a.toast.error(`Validation failed: ${JSON.stringify(e.details.fieldErrors||e.details)}`):a.toast.error(e?.error??"Failed to update introduction");return}a.toast.success("Introduction updated"),i(!1),I.refresh()}catch(e){a.toast.error("Failed to update introduction")}})},disabled:S,children:S?"Updating…":"Update Introduction"})]})]})]})}):null}var M=e.i(429482);let U=[{label:"All status",value:"all"},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"},{label:"Suspended",value:"suspended"}];function $({summary:e,introducers:i,recentIntroductions:l,deals:v=[],isDemo:f=!1,showAddButtons:C=!0}){let b=(0,r.useRouter)(),[y,S]=(0,s.useState)(""),[I,D]=(0,s.useState)("all"),[k,F]=(0,s.useState)(null),[E,L]=(0,s.useState)(null),[O,_]=(0,s.useState)(!1),[V,$]=(0,s.useState)(null),{setOpen:z}=(0,A.useAddIntroducer)(),[G,Q]=(0,s.useState)(!1),[W,X]=(0,s.useState)(null),Y=(0,s.useMemo)(()=>i.filter(e=>{let t="all"===I||e.status===I,s=!y||e.legalName.toLowerCase().includes(y.toLowerCase())||(e.contactName?.toLowerCase().includes(y.toLowerCase())??!1)||(e.email?.toLowerCase().includes(y.toLowerCase())??!1);return t&&s}),[i,I,y]);return(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Introducer Management"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage introducer relationships, commissions, and performance tracking"})]}),C&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(o.Button,{variant:"outline",onClick:()=>_(!0),children:[(0,t.jsx)(N.UserPlus,{className:"h-4 w-4 mr-2"}),"Record Introduction"]}),(0,t.jsxs)(o.Button,{onClick:()=>z(!0),children:[(0,t.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Add Introducer"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsx)(H,{icon:(0,t.jsx)(u.HandHeart,{className:"h-4 w-4"}),label:"Active Introducers",primary:e.activeIntroducers,secondary:`${e.totalIntroducers} total`}),(0,t.jsx)(H,{icon:(0,t.jsx)(m.Users,{className:"h-4 w-4"}),label:"Total Introductions",primary:e.totalIntroductions,secondary:`${e.totalAllocations} allocated`}),(0,t.jsx)(H,{icon:(0,t.jsx)(x.DollarSign,{className:"h-4 w-4"}),label:"Commissions Paid",primary:(0,T.formatCurrency)(e.totalCommissionPaid),secondary:"All-time"}),(0,t.jsx)(H,{icon:(0,t.jsx)(h.Clock,{className:"h-4 w-4"}),label:"Pending Commission",primary:(0,T.formatCurrency)(e.pendingCommission),secondary:"Awaiting payment",primaryClassName:"text-orange-500"})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Search & Filters"}),(0,t.jsx)(n.CardDescription,{children:"Narrow down introducers by status, performance, or keywords"})]}),(0,t.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(g.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(d.Input,{placeholder:"Search introducers, contacts, emails...",value:y,onChange:e=>S(e.target.value),className:"pl-10"})]})}),(0,t.jsxs)(c.Select,{value:I,onValueChange:D,children:[(0,t.jsx)(c.SelectTrigger,{className:"w-full md:w-48",children:(0,t.jsx)(c.SelectValue,{placeholder:"Filter status"})}),(0,t.jsx)(c.SelectContent,{children:U.map(e=>(0,t.jsx)(c.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),f&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(j.Filter,{className:"h-4 w-4"}),"Showing demo dataset. Re-run with a staff session to load live data."]})]})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Introducers"}),(0,t.jsx)(n.CardDescription,{children:"Performance summary for each introducer partner"})]}),(0,t.jsx)(n.CardContent,{className:"space-y-4",children:0===Y.length?(0,t.jsx)(K,{message:y?"No introducers match your filters.":"No introducers available yet."}):Y.map(e=>(0,t.jsx)(J,{introducer:e,onEdit:()=>F(e),onInvite:()=>$(e),onCreateFeePlan:()=>{X(e),Q(!0)},onDispatchInvestor:()=>{a.toast.info(`To dispatch an investor through ${e.legalName}, go to a deal's Members tab and use "Add Participant"`)}},e.id))})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Recent Introductions"}),(0,t.jsx)(n.CardDescription,{children:"Latest introducer activity across deals"})]}),(0,t.jsx)(n.CardContent,{className:"space-y-4",children:0===l.length?(0,t.jsx)(K,{message:"No recent introductions "}):l.map(e=>(0,t.jsx)(q,{introduction:e,onEdit:()=>L(e)},e.id))})]}),(0,t.jsx)(P.EditIntroducerDialog,{open:!!k,onOpenChange:e=>!e&&F(null),introducer:k}),(0,t.jsx)(B,{open:O,onOpenChange:_,introducers:i.map(e=>({id:e.id,legalName:e.legalName})),deals:v}),(0,t.jsx)(R,{open:!!E,onOpenChange:e=>!e&&L(null),introduction:E,introducers:i.map(e=>({id:e.id,legalName:e.legalName})),deals:v}),V&&(0,t.jsx)(M.InviteUserDialog,{open:!!V,onOpenChange:e=>!e&&$(null),entityType:"introducer",entityId:V.id,entityName:V.legalName}),(0,t.jsx)(w.default,{open:G,onClose:()=>{Q(!1),X(null)},onSuccess:()=>{Q(!1),X(null),a.toast.success("Fee plan created successfully"),b.refresh()}})]})}function H({icon:e,label:s,primary:r,secondary:a,primaryClassName:i}){return(0,t.jsxs)(n.Card,{children:[(0,t.jsx)(n.CardHeader,{className:"pb-3",children:(0,t.jsxs)(n.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e,s]})}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsx)("div",{className:(0,I.cn)("text-2xl font-bold",i),children:r}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:a})]})]})}function J({introducer:e,onEdit:s,onInvite:r,onCreateFeePlan:a,onDispatchInvestor:n}){return(0,t.jsx)("div",{className:"border border-border rounded-lg p-4 bg-background/60 hover:bg-background/80 transition-colors",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg border border-primary/30 bg-primary/10 flex items-center justify-center",children:(0,t.jsx)(v.TrendingUp,{className:"h-6 w-6 text-primary"})}),(0,t.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i.default,{href:`/versotech_main/introducers/${e.id}`,children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground hover:text-primary transition-colors cursor-pointer",children:e.legalName})}),(0,t.jsxs)(S.DropdownMenu,{children:[(0,t.jsx)(S.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",children:(0,t.jsx)(y.MoreHorizontal,{className:"h-4 w-4"})})}),(0,t.jsxs)(S.DropdownMenuContent,{align:"start",children:[(0,t.jsx)(S.DropdownMenuLabel,{children:"Actions"}),(0,t.jsx)(S.DropdownMenuSeparator,{}),(0,t.jsxs)(S.DropdownMenuItem,{onClick:s,children:[(0,t.jsx)(f.Edit,{className:"mr-2 h-4 w-4"}),"Edit Introducer"]}),(0,t.jsxs)(S.DropdownMenuItem,{onClick:r,children:[(0,t.jsx)(N.UserPlus,{className:"mr-2 h-4 w-4"}),"Invite User"]}),(0,t.jsx)(S.DropdownMenuSeparator,{}),(0,t.jsxs)(S.DropdownMenuItem,{onClick:a,children:[(0,t.jsx)(C.FileText,{className:"mr-2 h-4 w-4"}),"Create Fee Plan"]}),(0,t.jsxs)(S.DropdownMenuItem,{onClick:n,children:[(0,t.jsx)(b.Send,{className:"mr-2 h-4 w-4"}),"Dispatch Investor"]})]})]})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.contactName||"No contact"," • ",e.email||"No email provided"]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground flex flex-wrap gap-2",children:[(0,t.jsxs)("span",{children:["Default commission: ",(0,T.formatBps)(e.defaultCommissionBps)]}),e.commissionCapAmount?(0,t.jsxs)("span",{children:["Cap: ",(0,T.formatCurrency)(e.commissionCapAmount)]}):null,e.paymentTerms?(0,t.jsxs)("span",{children:["Terms: ",e.paymentTerms]}):null]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-6",children:[(0,t.jsx)(z,{label:"Introductions",value:e.totalIntroductions}),(0,t.jsx)(z,{label:"Allocated",value:e.successfulAllocations}),e.feePlans&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 font-semibold tabular-nums",children:[(0,t.jsx)(C.FileText,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,t.jsxs)("span",{children:[e.feePlans.accepted,"/",e.feePlans.total]}),e.feePlans.accepted===e.feePlans.total&&e.feePlans.total>0&&(0,t.jsx)(D.CheckCircle2,{className:"h-3.5 w-3.5 text-green-400"}),e.feePlans.pending>0&&(0,t.jsx)(h.Clock,{className:"h-3.5 w-3.5 text-yellow-400"})]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Fee Plans"})]}),(0,t.jsx)(z,{label:"Paid",value:(0,T.formatCurrency)(e.totalCommissionPaid)}),(0,t.jsx)(z,{label:"Pending",value:(0,T.formatCurrency)(e.pendingCommission),className:"text-orange-500"}),(0,t.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,t.jsx)(l.Badge,{className:(0,I.cn)("capitalize",{active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-yellow-100 text-yellow-800"}[e.status]??"bg-gray-100 text-foreground"),children:e.status}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Last intro: ",e.lastIntroductionAt?(0,T.formatDate)(e.lastIntroductionAt):"—"]})]})]})]})})}function z({label:e,value:s,className:r}){return(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:(0,I.cn)("font-semibold tabular-nums",r),children:s}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:e})]})}function q({introduction:e,onEdit:i}){let[n,l]=(0,s.useState)(e.status),[d,u]=(0,s.useTransition)(),m=(0,r.useRouter)();return(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 border border-border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-foreground",children:e.prospectEmail}),(0,t.jsxs)(c.Select,{value:n,onValueChange:t=>{u(async()=>{try{if(!(await fetch(`/api/staff/introductions/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok)return void a.toast.error("Failed to update introduction status");l(t),a.toast.success("Introduction status updated"),m.refresh()}catch(e){a.toast.error("Failed to update introduction status")}})},disabled:d,children:[(0,t.jsx)(c.SelectTrigger,{className:(0,I.cn)("w-32 h-7 text-xs capitalize",{allocated:"border-green-200 text-green-700",joined:"border-blue-200 text-blue-700",invited:"border-yellow-200 text-yellow-700",lost:"border-red-200 text-red-700",inactive:"border-gray-200 text-gray-700"}[n]??"border-gray-200 text-foreground"),children:(0,t.jsx)(c.SelectValue,{})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"invited",children:"Invited"}),(0,t.jsx)(c.SelectItem,{value:"joined",children:"Joined"}),(0,t.jsx)(c.SelectItem,{value:"allocated",children:"Allocated"}),(0,t.jsx)(c.SelectItem,{value:"lost",children:"Lost"}),(0,t.jsx)(c.SelectItem,{value:"inactive",children:"Inactive"})]})]})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.introducerName," • ",e.dealName]}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Introduced ",e.introducedAt?(0,T.formatDate)(e.introducedAt):"—"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:e.commissionAmount?(0,T.formatCurrency)(e.commissionAmount):"Commission TBD"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.commissionStatus?`Status: ${e.commissionStatus}`:"Awaiting accrual"})]}),(0,t.jsx)(o.Button,{variant:"outline",size:"sm",onClick:i,className:"h-8 w-8 p-0",children:(0,t.jsx)(f.Edit,{className:"h-4 w-4"})})]})]})}function K({message:e}){return(0,t.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,t.jsx)(v.TrendingUp,{className:"h-10 w-10 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e})]})}e.s(["IntroducersDashboard",()=>$],205601)}]);