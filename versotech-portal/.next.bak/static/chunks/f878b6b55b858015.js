(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90613,e=>{"use strict";var s=e.i(722679),t=e.i(282141);function r({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function l({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function a({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...r})}function i({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...r})}function d({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...r})}function n({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-footer",className:(0,t.cn)("flex items-center px-6 [.border-t]:pt-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>d,"CardDescription",()=>i,"CardFooter",()=>n,"CardHeader",()=>l,"CardTitle",()=>a])},619324,e=>{"use strict";let s=(0,e.i(410587).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>s],619324)},761722,e=>{"use strict";let s=(0,e.i(410587).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>s],761722)},496383,e=>{"use strict";let s=(0,e.i(410587).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],496383)},416469,e=>{"use strict";let s=(0,e.i(410587).default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);e.s(["Globe",()=>s],416469)},258729,e=>{"use strict";var s=e.i(722679),t=e.i(603274),r=e.i(191569),l=e.i(316264),a=e.i(750809),i=e.i(761722),d=e.i(340915),n=e.i(90613),c=e.i(538892);function o(){let e=(0,t.useRouter)(),o=(0,t.useSearchParams)(),[m,x]=(0,d.useState)(o.get("search")||""),u=async()=>{let e=await fetch(`/api/audit/export?${o.toString()}`),s=await e.blob(),t=window.URL.createObjectURL(s),r=document.createElement("a");r.href=t,r.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(t),document.body.removeChild(r)};return(0,s.jsx)(n.Card,{children:(0,s.jsx)(n.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(a.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(r.Input,{placeholder:"Search audit logs by actor, action, or entity...",className:"pl-10",value:m,onChange:e=>x(e.target.value),onKeyDown:s=>{let t;"Enter"===s.key&&(t=new URLSearchParams(o.toString()),m?t.set("search",m):t.delete("search"),e.push(`?${t.toString()}`))}})]})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(c.Select,{defaultValue:o.get("risk")||"all",onValueChange:s=>{let t=new URLSearchParams(o.toString());s&&"all"!==s?t.set("risk",s):t.delete("risk"),e.push(`?${t.toString()}`)},children:[(0,s.jsx)(c.SelectTrigger,{className:"w-[140px]",children:(0,s.jsx)(c.SelectValue,{placeholder:"Risk Level"})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"All Risk Levels"}),(0,s.jsx)(c.SelectItem,{value:"low",children:"Low Risk"}),(0,s.jsx)(c.SelectItem,{value:"medium",children:"Medium Risk"}),(0,s.jsx)(c.SelectItem,{value:"high",children:"High Risk"}),(0,s.jsx)(c.SelectItem,{value:"critical",children:"Critical Risk"})]})]}),(0,s.jsxs)(c.Select,{defaultValue:o.get("action")||"all",onValueChange:s=>{let t=new URLSearchParams(o.toString());s&&"all"!==s?t.set("action",s):t.delete("action"),e.push(`?${t.toString()}`)},children:[(0,s.jsx)(c.SelectTrigger,{className:"w-[180px]",children:(0,s.jsx)(c.SelectValue,{placeholder:"Action Type"})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"All Actions"}),(0,s.jsx)(c.SelectItem,{value:"login_success",children:"Login Success"}),(0,s.jsx)(c.SelectItem,{value:"login_failed",children:"Login Failed"}),(0,s.jsx)(c.SelectItem,{value:"document_download",children:"Document Download"}),(0,s.jsx)(c.SelectItem,{value:"document_access",children:"Document Access"}),(0,s.jsx)(c.SelectItem,{value:"investor_data_modify",children:"Data Modify"}),(0,s.jsx)(c.SelectItem,{value:"user_role_change",children:"Role Change"}),(0,s.jsx)(c.SelectItem,{value:"workflow_execution",children:"Workflow"})]})]}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:u,children:[(0,s.jsx)(i.Download,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})})})}e.s(["AuditLogFilters",()=>o])},88303,e=>{"use strict";var s=e.i(722679),t=e.i(90613),r=e.i(129432),l=e.i(316264),a=e.i(981218),i=e.i(704477),d=e.i(119311),n=e.i(900974),c=e.i(734213),o=e.i(496383),m=e.i(416469),x=e.i(619324),u=e.i(340915),h=e.i(352776);function g(e){switch(e){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";case"critical":return"bg-red-200 text-red-900";default:return"bg-gray-100 text-foreground"}}function j(e){switch(e){case"staff_admin":return"bg-purple-100 text-purple-800";case"staff_rm":return"bg-blue-100 text-blue-800";case"staff_ops":return"bg-green-100 text-green-800";case"investor":default:return"bg-gray-100 text-foreground";case"system":return"bg-orange-100 text-orange-800"}}function f({logs:e}){let[f,v]=(0,u.useState)(null);return e&&0!==e.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Audit Trail"}),(0,s.jsxs)(t.CardDescription,{children:["Showing ",e.length," audit events"]})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,s.jsx)("div",{className:"border border-gray-800 rounded-lg p-4 hover:bg-gray-900/50 transition-colors cursor-pointer",onClick:()=>v(e),children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[(0,s.jsx)("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center border ${"high"===e.risk_level||"critical"===e.risk_level?"bg-red-950/30 border-red-800":"medium"===e.risk_level?"bg-yellow-950/30 border-yellow-800":"bg-green-950/30 border-green-800"}`,children:function(e){switch(e){case"login_success":case"login_failed":case"failed_login_attempt":return(0,s.jsx)(i.User,{className:"h-4 w-4"});case"document_download":case"document_access":return(0,s.jsx)(d.FileText,{className:"h-4 w-4"});case"investor_data_modify":case"user_role_change":return(0,s.jsx)(n.Database,{className:"h-4 w-4"});case"workflow_execution":return(0,s.jsx)(c.Activity,{className:"h-4 w-4"});default:return(0,s.jsx)(a.Shield,{className:"h-4 w-4"})}}(e.action)}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("h3",{className:"font-semibold text-foreground",children:e.action.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),e.compliance_flag&&(0,s.jsxs)(r.Badge,{className:"bg-yellow-100 text-yellow-800",children:[(0,s.jsx)(x.AlertTriangle,{className:"h-3 w-3 mr-1"}),"Compliance"]}),e.risk_level&&(0,s.jsxs)(r.Badge,{className:g(e.risk_level),children:[e.risk_level," risk"]})]}),(0,s.jsx)("p",{className:"text-foreground mb-3",children:e.details||"No details provided"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:"Actor"}),(0,s.jsx)("div",{className:"text-muted-foreground",children:e.actor_email||"Unknown"}),e.actor_role&&(0,s.jsx)(r.Badge,{className:`${j(e.actor_role)} text-xs`,children:e.actor_role.replace("_"," ")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:"Timestamp"}),(0,s.jsx)("div",{className:"text-muted-foreground",children:new Date(e.timestamp).toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:"Entity"}),(0,s.jsx)("div",{className:"text-muted-foreground",children:e.entity_type||"N/A"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:"IP Address"}),(0,s.jsxs)("div",{className:"text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(m.Globe,{className:"h-3 w-3"}),e.ip_address||"N/A"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:"ID"}),(0,s.jsx)("div",{className:"text-muted-foreground font-mono text-xs",children:e.id.substring(0,8)})]})]})]})]}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>v(e),children:[(0,s.jsx)(o.Eye,{className:"h-4 w-4 mr-2"}),"Details"]})]})},e.id))})})]}),(0,s.jsx)(h.Dialog,{open:!!f,onOpenChange:()=>v(null),children:(0,s.jsxs)(h.DialogContent,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[(0,s.jsxs)(h.DialogHeader,{children:[(0,s.jsx)(h.DialogTitle,{children:"Audit Log Details"}),(0,s.jsx)(h.DialogDescription,{children:"Complete information for this audit event"})]}),f&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Event ID"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground font-mono",children:f.id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Timestamp"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(f.timestamp).toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Actor"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:f.actor_email})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Role"}),(0,s.jsx)(r.Badge,{className:j(f.actor_role),children:f.actor_role||"Unknown"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Action"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:f.action})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Risk Level"}),(0,s.jsx)(r.Badge,{className:g(f.risk_level),children:f.risk_level||"Unknown"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"IP Address"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:f.ip_address||"N/A"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Entity"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[f.entity_type," (",f.entity_id||"N/A",")"]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Details"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:f.details})]}),f.user_agent&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"User Agent"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground font-mono text-xs break-all",children:f.user_agent})]}),f.before_value&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"Before Value"}),(0,s.jsx)("pre",{className:"text-sm bg-gray-900 p-3 rounded-lg overflow-auto",children:JSON.stringify(f.before_value,null,2)})]}),f.after_value&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-1",children:"After Value"}),(0,s.jsx)("pre",{className:"text-sm bg-gray-900 p-3 rounded-lg overflow-auto",children:JSON.stringify(f.after_value,null,2)})]})]})]})})]}):(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Audit Trail"}),(0,s.jsx)(t.CardDescription,{children:"Comprehensive log of all system activities and user actions"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"No audit logs found. Try adjusting your filters."})})]})}e.s(["AuditLogTable",()=>f])},640321,e=>{"use strict";var s=e.i(722679),t=e.i(90613),r=e.i(316264),l=e.i(619324),a=e.i(603274);function i({alerts:e}){let i=(0,a.useRouter)(),d=async e=>{(await fetch(`/api/audit/compliance-alerts/${e}/review`,{method:"POST"})).ok&&i.refresh()};return e&&0!==e.length?(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Compliance Alerts"}),(0,s.jsxs)(t.CardDescription,{children:[e.length," events requiring compliance review"]})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:e.slice(0,5).map(e=>(0,s.jsxs)("div",{className:`flex items-center justify-between p-3 border rounded-lg ${"high"===e.severity||"critical"===e.severity?"bg-red-950/20 border-red-800":"bg-yellow-950/20 border-yellow-800"}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)(l.AlertTriangle,{className:`h-4 w-4 ${"high"===e.severity||"critical"===e.severity?"text-red-400":"text-yellow-400"}`}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:e.alert_type.replace(/_/g," ")}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description||"No description"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(e.created_at).toLocaleString()})]})]}),(0,s.jsx)(r.Button,{size:"sm",variant:"outline",onClick:()=>d(e.id),children:"Review"})]},e.id))})})]}):(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Compliance Alerts"}),(0,s.jsx)(t.CardDescription,{children:"Events requiring compliance review"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"text-center py-6 text-muted-foreground text-sm",children:"No open compliance alerts"})})]})}e.s(["ComplianceAlerts",()=>i])}]);