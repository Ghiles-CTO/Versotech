(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,398472,e=>{"use strict";let t=(0,e.i(410587).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);e.s(["ExternalLink",()=>t],398472)},501495,e=>{"use strict";e.s(["formatBps",0,e=>null==e?"—":`${e} bps`,"formatCurrency",0,(e,t="USD")=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:t,maximumFractionDigits:0}).format(e):"$0","formatDate",0,e=>{if(!e)return"—";let t="string"==typeof e?new Date(e):e;return Number.isNaN(t?.getTime?.())?"—":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}])},416469,e=>{"use strict";let t=(0,e.i(410587).default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);e.s(["Globe",()=>t],416469)},773510,e=>{"use strict";let t=(0,e.i(410587).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>t],773510)},90613,e=>{"use strict";var t=e.i(722679),a=e.i(282141);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function l({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function r({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...s})}function n({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}function c({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>n,"CardDescription",()=>i,"CardFooter",()=>c,"CardHeader",()=>l,"CardTitle",()=>r])},15098,e=>{"use strict";let t=(0,e.i(410587).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],15098)},237635,e=>{"use strict";var t=e.i(722679),a=e.i(282141);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...s})})}function l({className:e,...s}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...s})}function r({className:e,...s}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...s})}function i({className:e,...s}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function n({className:e,...s}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-11 md:h-10 px-2 text-left align-middle font-medium text-xs sm:text-sm [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function c({className:e,...s}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle text-xs sm:text-sm [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>r,"TableCell",()=>c,"TableHead",()=>n,"TableHeader",()=>l,"TableRow",()=>i])},535337,e=>{"use strict";var t=e.i(722679),a=e.i(340915),s=e.i(90613),l=e.i(129432),r=e.i(316264),i=e.i(191569),n=e.i(538892),c=e.i(237635),d=e.i(201495),o=e.i(733179),m=e.i(15098),u=e.i(750809),x=e.i(263229),h=e.i(401148),f=e.i(398472),g=e.i(773510),p=e.i(416469),_=e.i(691974),y=e.i(282141),j=e.i(501495),b=e.i(59178);let v={approved:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",expired:"bg-red-100 text-red-800",not_started:"bg-gray-100 text-gray-800"},w=[{label:"All Status",value:"all"},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}];function N(){let[e,N]=(0,a.useState)(null),[C,T]=(0,a.useState)([]),[L,k]=(0,a.useState)({totalLawyers:0,activeLawyers:0,totalDeals:0,totalDealValue:0}),[S,D]=(0,a.useState)(!0),[H,z]=(0,a.useState)(null),[B,V]=(0,a.useState)(""),[E,M]=(0,a.useState)("all");(0,a.useEffect)(()=>{async function e(e){let{data:t,error:a}=await e.from("lawyers").select("*").order("firm_name").limit(100);if(a)throw a;let s=(t||[]).map(e=>({id:e.id,firm_name:e.firm_name,display_name:e.display_name,legal_entity_type:e.legal_entity_type,specializations:e.specializations,primary_contact_name:e.primary_contact_name,primary_contact_email:e.primary_contact_email,primary_contact_phone:e.primary_contact_phone,country:e.country,logo_url:e.logo_url,kyc_status:e.kyc_status,is_active:e.is_active,deals_count:0,total_deal_value:0,total_subscriptions:0,funded_subscriptions:0,total_funded_amount:0,total_commitment:0}));T(s),k({totalLawyers:s.length,activeLawyers:s.filter(e=>e.is_active).length,totalDeals:0,totalDealValue:0})}!async function(){try{D(!0);let t=(0,b.createClient)(),{data:{user:a}}=await t.auth.getUser();if(!a)return void z("Not authenticated");let{data:s,error:l}=await t.from("arranger_users").select("arranger_id").eq("user_id",a.id).single();if(l||!s)return void await e(t);let{data:r,error:i}=await t.from("arranger_entities").select("id, legal_name, status").eq("id",s.arranger_id).single();if(i)throw i;N(r);let{data:n,error:c}=await t.from("deals").select("id, target_amount, currency").eq("arranger_entity_id",s.arranger_id);if(c)throw c;if(!n||0===n.length){T([]),k({totalLawyers:0,activeLawyers:0,totalDeals:0,totalDealValue:0});return}let d=n.map(e=>e.id),{data:o,error:m}=await t.from("deal_fee_structures").select("deal_id, legal_counsel").in("deal_id",d).not("legal_counsel","is",null).eq("status","published");if(m)throw m;let u=[...new Set((o||[]).map(e=>e.legal_counsel))];if(0===u.length){T([]),k({totalLawyers:0,activeLawyers:0,totalDeals:0,totalDealValue:0});return}let{data:x,error:h}=await t.from("lawyers").select("*").or(u.map(e=>`firm_name.ilike.%${e}%,display_name.ilike.%${e}%`).join(",")).order("firm_name");if(h)throw h;let f=new Map;n.forEach(e=>f.set(e.id,Number(e.target_amount)||0));let{data:g}=await t.from("subscriptions").select("id, deal_id, commitment, funded_amount, status").in("deal_id",d),p=new Map;(g||[]).forEach(e=>{let t=p.get(e.deal_id)||[];t.push(e),p.set(e.deal_id,t)});let _=(x||[]).map(e=>{let t=(o||[]).filter(t=>{let a=t.legal_counsel?.toLowerCase()||"";return a.includes(e.firm_name?.toLowerCase()||"")||a.includes(e.display_name?.toLowerCase()||"")}),a=[...new Set(t.map(e=>e.deal_id))],s=a.reduce((e,t)=>e+(f.get(t)||0),0),l=0,r=0,i=0,n=0;return a.forEach(e=>{(p.get(e)||[]).forEach(e=>{l++;let t=Number(e.commitment)||0,a=Number(e.funded_amount)||0;n+=t,i+=a,t>0&&a>=t&&r++})}),{id:e.id,firm_name:e.firm_name,display_name:e.display_name,legal_entity_type:e.legal_entity_type,specializations:e.specializations,primary_contact_name:e.primary_contact_name,primary_contact_email:e.primary_contact_email,primary_contact_phone:e.primary_contact_phone,country:e.country,logo_url:e.logo_url,kyc_status:e.kyc_status,is_active:e.is_active,deals_count:a.length,total_deal_value:s,total_subscriptions:l,funded_subscriptions:r,total_funded_amount:i,total_commitment:n}});T(_),k({totalLawyers:_.length,activeLawyers:_.filter(e=>e.is_active).length,totalDeals:_.reduce((e,t)=>e+t.deals_count,0),totalDealValue:_.reduce((e,t)=>e+t.total_deal_value,0)}),z(null)}catch(e){console.error("[MyLawyersPage] Error:",e),z(e instanceof Error?e.message:"Failed to load lawyers")}finally{D(!1)}}()},[]);let U=C.filter(e=>{let t="all"===E||"active"===E&&e.is_active||"inactive"===E&&!e.is_active,a=!B||e.firm_name?.toLowerCase().includes(B.toLowerCase())||e.display_name?.toLowerCase().includes(B.toLowerCase())||e.primary_contact_name?.toLowerCase().includes(B.toLowerCase())||e.specializations?.some(e=>e.toLowerCase().includes(B.toLowerCase()));return t&&a});return S?(0,t.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,t.jsx)(x.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,t.jsx)("span",{className:"ml-3 text-muted-foreground",children:"Loading lawyers..."})]}):H?(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)(h.AlertCircle,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Error Loading Lawyers"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:H})]}):(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"My Lawyers"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:e?`Legal counsel working with ${e.legal_name}`:"View all registered law firms"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(d.Scale,{className:"h-4 w-4"}),"Total Lawyers"]})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:L.totalLawyers}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"In your network"})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(m.CheckCircle2,{className:"h-4 w-4"}),"Active"]})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:L.activeLawyers}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Currently active"})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(_.Briefcase,{className:"h-4 w-4"}),"Deals Handled"]})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:L.totalDeals}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Legal counsel on"})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsxs)(s.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(o.TrendingUp,{className:"h-4 w-4"}),"Deal Value"]})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:(0,j.formatCurrency)(L.totalDealValue,"USD")}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Total handled"})]})]})]}),(0,t.jsx)(s.Card,{children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(u.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(i.Input,{placeholder:"Search lawyers, firms, or specializations...",value:B,onChange:e=>V(e.target.value),className:"pl-10"})]}),(0,t.jsxs)(n.Select,{value:E,onValueChange:M,children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full md:w-48",children:(0,t.jsx)(n.SelectValue,{placeholder:"Filter by status"})}),(0,t.jsx)(n.SelectContent,{children:w.map(e=>(0,t.jsx)(n.SelectItem,{value:e.value,children:e.label},e.value))})]})]})})}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"Lawyers & Law Firms"}),(0,t.jsxs)(s.CardDescription,{children:[U.length," firm",1!==U.length?"s":""," found"]})]}),(0,t.jsx)(s.CardContent,{children:0===U.length?(0,t.jsxs)("div",{className:"border border-dashed border-muted rounded-lg py-12 flex flex-col items-center justify-center text-center space-y-2",children:[(0,t.jsx)(d.Scale,{className:"h-10 w-10 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:B||"all"!==E?"No lawyers match your filters":"No lawyers in your network yet"})]}):(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(c.Table,{children:[(0,t.jsx)(c.TableHeader,{children:(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableHead,{children:"Firm"}),(0,t.jsx)(c.TableHead,{children:"Specializations"}),(0,t.jsx)(c.TableHead,{children:"Contact"}),(0,t.jsx)(c.TableHead,{children:"Deals"}),(0,t.jsx)(c.TableHead,{children:"Escrow Status"}),(0,t.jsx)(c.TableHead,{children:"Deal Value"}),(0,t.jsx)(c.TableHead,{children:"Status"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(c.TableBody,{children:U.map(e=>(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e.logo_url?(0,t.jsx)("img",{src:e.logo_url,alt:e.firm_name,className:"h-10 w-10 rounded-lg object-cover"}):(0,t.jsx)("div",{className:"h-10 w-10 rounded-lg bg-muted flex items-center justify-center",children:(0,t.jsx)(d.Scale,{className:"h-5 w-5 text-muted-foreground"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.firm_name}),e.display_name!==e.firm_name&&(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.display_name}),e.country&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(p.Globe,{className:"h-3 w-3"}),e.country]})]})]})}),(0,t.jsx)(c.TableCell,{children:e.specializations&&e.specializations.length>0?(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.specializations.slice(0,2).map((e,a)=>(0,t.jsx)(l.Badge,{variant:"secondary",className:"capitalize text-xs",children:e},a)),e.specializations.length>2&&(0,t.jsxs)(l.Badge,{variant:"outline",className:"text-xs",children:["+",e.specializations.length-2]})]}):(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"—"})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)("div",{className:"space-y-1",children:[e.primary_contact_name&&(0,t.jsx)("div",{className:"text-sm",children:e.primary_contact_name}),e.primary_contact_email&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(g.Mail,{className:"h-3 w-3"}),e.primary_contact_email]})]})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)(l.Badge,{variant:"outline",children:[e.deals_count," deal",1!==e.deals_count?"s":""]})}),(0,t.jsx)(c.TableCell,{children:e.total_subscriptions>0?(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(l.Badge,{variant:"secondary",className:(0,y.cn)("text-xs",e.funded_subscriptions===e.total_subscriptions?"bg-green-100 text-green-800":e.funded_subscriptions>0?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:[e.funded_subscriptions,"/",e.total_subscriptions," funded"]})}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(0,j.formatCurrency)(e.total_funded_amount,"USD")," / ",(0,j.formatCurrency)(e.total_commitment,"USD")]})]}):(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"No subs"})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsx)("div",{className:"font-medium",children:(0,j.formatCurrency)(e.total_deal_value,"USD")})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(l.Badge,{variant:"outline",className:(0,y.cn)("capitalize",e.is_active?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-800 border-gray-200"),children:e.is_active?"Active":"Inactive"}),e.kyc_status&&(0,t.jsx)("div",{children:(0,t.jsxs)(l.Badge,{variant:"secondary",className:(0,y.cn)("text-xs",v[e.kyc_status]||""),children:["KYC: ",e.kyc_status.replace("_"," ")]})})]})}),(0,t.jsx)(c.TableCell,{className:"text-right",children:(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,t.jsx)("a",{href:`/versotech_main/users?type=lawyer&id=${e.id}`,children:(0,t.jsx)(f.ExternalLink,{className:"h-4 w-4"})})})})]},e.id))})]})})})]})]})}e.s(["default",()=>N])}]);