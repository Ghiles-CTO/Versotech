(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,887786,e=>{"use strict";var s=e.i(722679),t=e.i(90613),a=e.i(316264),r=e.i(129432),i=e.i(429760),n=e.i(820417),l=e.i(396132),d=e.i(773510),c=e.i(957114),o=e.i(704477),m=e.i(84065),x=e.i(119311),u=e.i(827178),h=e.i(734213),g=e.i(196767),p=e.i(733179),f=e.i(971743),j=e.i(551544),b=e.i(335994),v=e.i(645855),N=e.i(360209),_=e.i(711819),y=e.i(849110),w=e.i(496383),C=e.i(932735),k=e.i(896816),T=e.i(831833),S=e.i(15098),D=e.i(745083),F=e.i(401148),I=e.i(758768),B=e.i(501259),P=e.i(691974),A=e.i(398472),U=e.i(761722),E=e.i(646839),$=e.i(230112),L=e.i(249389),R=e.i(263229),M=e.i(275034),O=e.i(510166),H=e.i(340915),z=e.i(475478),K=e.i(160599),V=e.i(764355);e.i(227041);var Y=e.i(1694),J=e.i(465914),X=e.i(923226),q=e.i(489733),G=e.i(304091),Q=e.i(429482),W=e.i(352776),Z=e.i(514133),ee=e.i(538892),es=e.i(30100),et=e.i(603274),ea=e.i(994500),er=e.i(282141);function ei({open:e,onOpenChange:t,introducerId:i,introducerName:n,feePlans:l}){let d=(0,et.useRouter)(),[c,o]=(0,H.useState)(!1),[m,x]=(0,H.useState)(null),[u,h]=(0,H.useState)(""),[g,p]=(0,H.useState)(""),[f,j]=(0,H.useState)(null),[b,v]=(0,H.useState)([]),[N,y]=(0,H.useState)(!1),[w,C]=(0,H.useState)(""),k=(0,H.useMemo)(()=>l.filter(e=>"accepted"===e.status&&e.is_active&&e.introducer_agreement?.status==="active"&&e.introducer_agreement?.signed_date!==null&&null!==e.deal),[l]),T=(0,H.useMemo)(()=>k.reduce((e,s)=>(s.deal&&!e.find(e=>e.id===s.deal.id)&&e.push(s.deal),e),[]),[k]),D=(0,H.useMemo)(()=>u?k.filter(e=>e.deal?.id===u):[],[u,k]);(0,H.useEffect)(()=>{e||(h(""),p(""),j(null),v([]),C(""),x(null))},[e]),(0,H.useEffect)(()=>{p(""),j(null),v([]),C(""),1===D.length&&(p(D[0].id),j(D[0]))},[u]),(0,H.useEffect)(()=>{if(!g){j(null),v([]),C("");return}j(k.find(e=>e.id===g)||null)},[g,k]),(0,H.useEffect)(()=>{let e=f?.deal?.id,s=f?.term_sheet?.id;if(!e||!s){v([]),C("");return}let t=new AbortController;return(async()=>{y(!0),v([]),C("");try{let a=await fetch(`/api/deals/${e}/linkable-investors?term_sheet_id=${s}`,{signal:t.signal});if(a.ok){let e=await a.json();v(e.investors||[])}else console.error("Failed to fetch linkable investors:",a.status,a.statusText),v([])}catch(e){"AbortError"!==e.name&&console.error("Failed to fetch linkable investors:",e)}finally{t.signal.aborted||y(!1)}})(),()=>t.abort()},[f]);let I=async()=>{if(!f||!w)return void x("Please complete all selections");if(!f.deal?.id)return void x("Invalid fee plan selected - missing deal information");o(!0),x(null);try{let e=await fetch(`/api/deals/${f.deal.id}/members/${w}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({referred_by_entity_id:i,referred_by_entity_type:"introducer",assigned_fee_plan_id:g,role:"introducer_investor"})});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to link investor to introducer")}ea.toast.success("Investor successfully linked to introducer"),t(!1),d.refresh()}catch(e){x(e.message)}finally{o(!1)}},A=u&&g&&w;return(0,s.jsx)(W.Dialog,{open:e,onOpenChange:t,children:(0,s.jsxs)(W.DialogContent,{className:"max-w-lg",children:[(0,s.jsxs)(W.DialogHeader,{children:[(0,s.jsxs)(W.DialogTitle,{children:["Dispatch Investor for ",n]}),(0,s.jsx)(W.DialogDescription,{children:"Link an investor to this introducer using an active fee agreement"})]}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[0===k.length?(0,s.jsx)("div",{className:"p-4 rounded-lg border border-amber-500/30 bg-amber-500/5",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(F.AlertCircle,{className:"h-5 w-5 text-amber-400 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-amber-300",children:"No active fee agreements"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[n," has no active fee agreements with signed terms. Create and sign an introducer agreement from a deal first."]})]})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(Z.Label,{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"flex items-center justify-center w-5 h-5 rounded-full bg-primary/20 text-primary text-xs font-medium",children:"1"}),"Select Deal"]}),(0,s.jsxs)(ee.Select,{value:u,onValueChange:h,children:[(0,s.jsx)(ee.SelectTrigger,{className:(0,er.cn)(u&&"border-primary/50"),children:(0,s.jsx)(ee.SelectValue,{placeholder:"Select a deal"})}),(0,s.jsx)(ee.SelectContent,{children:T.map(e=>(0,s.jsx)(ee.SelectItem,{value:e.id,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Briefcase,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{children:e.name})]})},e.id))})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Only deals with active signed agreements are shown"})]}),u&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(Z.Label,{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"flex items-center justify-center w-5 h-5 rounded-full bg-primary/20 text-primary text-xs font-medium",children:"2"}),"Select Fee Plan"]}),1===D.length?(0,s.jsx)("div",{className:"p-3 rounded-lg bg-muted/50 border border-primary/30",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(_.FileSignature,{className:"h-5 w-5 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:D[0].name}),D[0].term_sheet&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Term Sheet v",D[0].term_sheet.version]})]}),(0,s.jsx)(r.Badge,{className:"ml-auto bg-green-500/20 text-green-400",children:"Active"})]})}):(0,s.jsxs)(ee.Select,{value:g,onValueChange:p,children:[(0,s.jsx)(ee.SelectTrigger,{className:(0,er.cn)(g&&"border-primary/50"),children:(0,s.jsx)(ee.SelectValue,{placeholder:"Select a fee plan"})}),(0,s.jsx)(ee.SelectContent,{children:D.map(e=>(0,s.jsx)(ee.SelectItem,{value:e.id,children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium",children:e.name}),e.term_sheet&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Term Sheet v",e.term_sheet.version]})]})},e.id))})]})]}),f&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(Z.Label,{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"flex items-center justify-center w-5 h-5 rounded-full bg-primary/20 text-primary text-xs font-medium",children:"3"}),"Select Investor"]}),N?(0,s.jsxs)("div",{className:"flex items-center gap-2 py-3",children:[(0,s.jsx)(R.Loader2,{className:"h-4 w-4 animate-spin text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading eligible investors..."})]}):0===b.length?(0,s.jsx)("div",{className:"p-3 rounded-lg border border-blue-500/30 bg-blue-500/5",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(F.AlertCircle,{className:"h-4 w-4 text-blue-400 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-300",children:"No eligible investors"}),(0,s.jsx)("p",{className:"text-xs text-blue-300/80 mt-1",children:"No investors on this term sheet are available. They may already be linked to an introducer."})]})]})}):(0,s.jsxs)(ee.Select,{value:w,onValueChange:C,children:[(0,s.jsx)(ee.SelectTrigger,{className:(0,er.cn)(w&&"border-primary/50"),children:(0,s.jsx)(ee.SelectValue,{placeholder:"Select an investor"})}),(0,s.jsx)(ee.SelectContent,{children:b.map(e=>(0,s.jsx)(ee.SelectItem,{value:e.user_id,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(B.Users,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{children:e.display_name}),e.email&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:e.email})]})]})},e.user_id))})]})]}),A&&(0,s.jsx)("div",{className:"p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(S.CheckCircle2,{className:"h-5 w-5 text-emerald-400 mt-0.5"}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"text-emerald-300 font-medium",children:"Ready to dispatch"}),(0,s.jsxs)("p",{className:"text-emerald-300/80 text-xs mt-1",children:["The selected investor will be linked to ",(0,s.jsx)("strong",{children:n})," using the ",(0,s.jsx)("strong",{children:f?.name})," fee plan."]})]})]})})]}),m&&(0,s.jsx)("div",{className:"p-3 rounded-lg bg-destructive/10 text-destructive text-sm",children:m}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)(a.Button,{variant:"outline",onClick:()=>t(!1),disabled:c,children:"Cancel"}),(0,s.jsx)(a.Button,{onClick:I,disabled:c||!A||0===k.length,className:"gap-2",children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.Loader2,{className:"h-4 w-4 animate-spin"}),"Linking..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(es.ArrowRight,{className:"h-4 w-4"}),"Dispatch Investor"]})})]})]})]})})}var en=e.i(501495),el=e.i(747972);function ed({introducer:e,metrics:W,introductions:Z,commissions:ee,agreements:es}){let er=(0,et.useRouter)(),[ed,ec]=(0,H.useState)(!1),[eo,em]=(0,H.useState)(!1),[ex,eu]=(0,H.useState)(!1),[eh,eg]=(0,H.useState)(!1),[ep,ef]=(0,H.useState)(!1),[ej,eb]=(0,H.useState)(null),[ev,eN]=(0,H.useState)(null),e_=async(e,s)=>{eN(e);try{let t=await fetch(`/api/storage/download?path=${encodeURIComponent(e)}&bucket=deal-documents`);if(!t.ok)throw Error("Failed to download file");let a=await t.blob(),r=window.URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download=e.split("/").pop()||`${s||"agreement"}.pdf`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r),ea.toast.success("PDF downloaded successfully")}catch(e){console.error("Error downloading PDF:",e),ea.toast.error("Failed to download PDF")}finally{eN(null)}},ey=async e=>{try{let s=await fetch(`/api/storage/download?path=${encodeURIComponent(e)}&bucket=deal-documents`);if(!s.ok)throw Error("Failed to load file");let t=await s.blob(),a=window.URL.createObjectURL(t);window.open(a,"_blank")}catch(e){console.error("Error previewing PDF:",e),ea.toast.error("Failed to preview PDF")}},[ew,eC]=(0,H.useState)([]),[ek,eT]=(0,H.useState)(!1),[eS,eD]=(0,H.useState)(null),[eF,eI]=(0,H.useState)([]),[eB,eP]=(0,H.useState)(!1),eA={subscription:"Subscription Fee",management:"Management Fee",performance:"Performance Fee",spread_markup:"Spread Markup",flat:"Flat Fee",other:"Other"},eU=(0,H.useCallback)(async()=>{eT(!0);try{let s=await fetch(`/api/introducers/${e.id}/fee-plans`);if(s.ok){let e=await s.json();eC(e.fee_plans||[])}}catch(e){console.error("Error fetching fee plans:",e)}finally{eT(!1)}},[e.id]),eE=(0,H.useCallback)(async()=>{eP(!0);try{let s=await fetch(`/api/introducers/${e.id}/referred-investors`);if(s.ok){let e=await s.json();eI(e.referred_investors||[])}}catch(e){console.error("Error fetching referred investors:",e)}finally{eP(!1)}},[e.id]);(0,H.useEffect)(()=>{eU(),eE()},[eU,eE]);let e$={draft:"bg-slate-500/20 text-slate-400",sent:"bg-blue-500/20 text-blue-400",pending_signature:"bg-purple-500/20 text-purple-400",accepted:"bg-green-500/20 text-green-400",rejected:"bg-red-500/20 text-red-400"},eL={allocated:"bg-green-500/20 text-green-400",converted:"bg-green-500/20 text-green-400",pending:"bg-yellow-500/20 text-yellow-400",expired:"bg-gray-500/20 text-gray-400"},eR={paid:"bg-green-500/20 text-green-400",accrued:"bg-yellow-500/20 text-yellow-400",invoiced:"bg-blue-500/20 text-blue-400",cancelled:"bg-red-500/20 text-red-400"},eM={draft:{bg:"bg-slate-500/20",text:"text-slate-400",icon:(0,s.jsx)(x.FileText,{className:"h-3 w-3"})},sent:{bg:"bg-blue-500/20",text:"text-blue-400",icon:(0,s.jsx)(C.Send,{className:"h-3 w-3"})},pending_approval:{bg:"bg-amber-500/20",text:"text-amber-400",icon:(0,s.jsx)(F.AlertCircle,{className:"h-3 w-3"})},approved:{bg:"bg-indigo-500/20",text:"text-indigo-400",icon:(0,s.jsx)(S.CheckCircle2,{className:"h-3 w-3"})},pending_ceo_signature:{bg:"bg-purple-500/20",text:"text-purple-400",icon:(0,s.jsx)(k.PenLine,{className:"h-3 w-3"})},pending_introducer_signature:{bg:"bg-cyan-500/20",text:"text-cyan-400",icon:(0,s.jsx)(k.PenLine,{className:"h-3 w-3"})},active:{bg:"bg-emerald-500/20",text:"text-emerald-400",icon:(0,s.jsx)(S.CheckCircle2,{className:"h-3 w-3"})},expired:{bg:"bg-gray-500/20",text:"text-gray-400",icon:(0,s.jsx)(v.Clock,{className:"h-3 w-3"})},rejected:{bg:"bg-red-500/20",text:"text-red-400",icon:(0,s.jsx)(D.XCircle,{className:"h-3 w-3"})}},eO={id:e.id,legalName:e.legal_name,contactName:e.contact_name,email:e.email,defaultCommissionBps:e.default_commission_bps||0,commissionCapAmount:e.commission_cap_amount,paymentTerms:e.payment_terms,status:e.status,notes:e.notes};return(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(n.default,{href:"/versotech_main/users",children:(0,s.jsxs)(a.Button,{variant:"ghost",size:"sm",className:"bg-gray-800 text-white hover:bg-gray-700",children:[(0,s.jsx)(l.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Users"]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:e.legal_name}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Introducer ID: ",e.id.slice(0,8)]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(a.Button,{variant:"default",size:"sm",onClick:()=>ef(!0),className:"bg-gradient-to-r from-orange-600 to-amber-600 hover:from-orange-500 hover:to-amber-500 text-white",children:[(0,s.jsx)(C.Send,{className:"h-4 w-4 mr-2"}),"Dispatch Investor"]}),(0,s.jsxs)(a.Button,{variant:"outline",size:"sm",onClick:()=>em(!0),children:[(0,s.jsx)(b.UserPlus,{className:"h-4 w-4 mr-2"}),"Invite User"]}),(0,s.jsxs)(a.Button,{variant:"outline",size:"sm",onClick:()=>ec(!0),children:[(0,s.jsx)(j.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsx)(r.Badge,{className:(0,el.getStatusStyle)(e.status,el.statusStyles),children:e.status}),e.kyc_status&&(0,s.jsxs)(r.Badge,{className:(0,el.getStatusStyle)(e.kyc_status,el.kycStyles),children:["KYC: ",e.kyc_status]}),e.default_commission_bps&&(0,s.jsxs)(r.Badge,{variant:"outline",children:[(0,en.formatBps)(e.default_commission_bps)," Commission"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{className:"pb-3",children:(0,s.jsxs)(t.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,s.jsx)(p.TrendingUp,{className:"h-4 w-4"}),"Introductions"]})}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-foreground",children:W.totalIntroductions}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[W.successfulAllocations," converted"]})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{className:"pb-3",children:(0,s.jsxs)(t.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,s.jsx)(N.Percent,{className:"h-4 w-4"}),"Conversion Rate"]})}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-foreground",children:[W.conversionRate.toFixed(1),"%"]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Success rate"})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{className:"pb-3",children:(0,s.jsxs)(t.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,s.jsx)(g.DollarSign,{className:"h-4 w-4"}),"Paid Commissions"]})}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-400",children:(0,en.formatCurrency)(W.totalCommissionPaid)}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"All time"})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{className:"pb-3",children:(0,s.jsxs)(t.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,s.jsx)(v.Clock,{className:"h-4 w-4"}),"Pending"]})}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-orange-400",children:(0,en.formatCurrency)(W.pendingCommission)}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:"Owed"})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{className:"pb-3",children:(0,s.jsxs)(t.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,s.jsx)(N.Percent,{className:"h-4 w-4"}),"Default Rate"]})}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-foreground",children:(0,en.formatBps)(e.default_commission_bps||0)}),e.commission_cap_amount&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["Cap: ",(0,en.formatCurrency)(e.commission_cap_amount)]})]})]})]}),(0,s.jsxs)(i.Tabs,{defaultValue:"overview",className:"space-y-6",id:`introducer-tabs-${e.id}`,children:[(0,s.jsxs)(i.TabsList,{className:"grid w-full grid-cols-2 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-10 lg:w-auto lg:inline-grid",children:[(0,s.jsxs)(i.TabsTrigger,{value:"overview",className:"gap-2",children:[(0,s.jsx)(f.Building2,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Overview"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"members",className:"gap-2",children:[(0,s.jsx)(o.User,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Members"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"fee-plans",className:"gap-2",children:[(0,s.jsx)(I.FileCheck,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Fee Plans"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"referred-investors",className:"gap-2",children:[(0,s.jsx)(B.Users,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Investors"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"agreements",className:"gap-2",children:[(0,s.jsx)(_.FileSignature,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Agreements"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"introductions",className:"gap-2",children:[(0,s.jsx)(p.TrendingUp,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Introductions"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"commissions",className:"gap-2",children:[(0,s.jsx)(g.DollarSign,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Commissions"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"kyc",className:"gap-2",children:[(0,s.jsx)(x.FileText,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"KYC"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"bank",className:"gap-2",children:[(0,s.jsx)(u.Banknote,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Bank"})]}),(0,s.jsxs)(i.TabsTrigger,{value:"activity",className:"gap-2",children:[(0,s.jsx)(h.Activity,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Activity"})]})]}),(0,s.jsxs)(i.TabsContent,{value:"overview",className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsx)(t.CardTitle,{children:"Contact Information"})}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[e.contact_name&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(o.User,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Primary Contact"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.contact_name})]})]}),e.email&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(d.Mail,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Email"}),(0,s.jsx)("a",{href:`mailto:${e.email}`,className:"text-sm font-medium text-blue-400 hover:underline",children:e.email})]})]}),e.phone_mobile&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(c.Phone,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Mobile"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.phone_mobile})]})]}),e.phone_office&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(c.Phone,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Office"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:e.phone_office})]})]}),e.created_at&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(m.Calendar,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Member Since"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:(0,en.formatDate)(e.created_at)})]})]}),!e.contact_name&&!e.email&&!e.phone_mobile&&!e.phone_office&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No contact information available"})]})]})}),"individual"===e.type&&(0,s.jsx)(Y.IndividualKycDisplay,{data:{first_name:e.first_name,middle_name:e.middle_name,last_name:e.last_name,name_suffix:e.name_suffix,date_of_birth:e.date_of_birth,country_of_birth:e.country_of_birth,nationality:e.nationality,email:e.email,phone_mobile:e.phone_mobile,phone_office:e.phone_office,residential_street:e.residential_street,residential_line_2:e.residential_line_2,residential_city:e.residential_city,residential_state:e.residential_state,residential_postal_code:e.residential_postal_code,residential_country:e.residential_country,is_us_citizen:e.is_us_citizen,is_us_taxpayer:e.is_us_taxpayer,us_taxpayer_id:e.us_taxpayer_id,country_of_tax_residency:e.country_of_tax_residency,id_type:e.id_type,id_number:e.id_number,id_issue_date:e.id_issue_date,id_expiry_date:e.id_expiry_date,id_issuing_country:e.id_issuing_country},showEditButton:!0,onEdit:()=>eg(!0),title:"Personal KYC Information"}),e.notes&&(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsx)(t.CardTitle,{children:"Notes"})}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"text-sm bg-white/5 rounded-lg p-4 whitespace-pre-wrap",children:e.notes})})]})]}),(0,s.jsx)(i.TabsContent,{value:"members",children:(0,s.jsx)(X.StaffEntityMembersTab,{entityType:"introducer",entityId:e.id,entityName:e.legal_name})}),(0,s.jsx)(i.TabsContent,{value:"fee-plans",children:(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Fee Plans"}),(0,s.jsxs)(t.CardDescription,{children:["All fee plans linked to ",e.legal_name," across deals. Click to expand details."]})]}),(0,s.jsx)(t.CardContent,{children:ek?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)(R.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===ew.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-blue-500/10 to-indigo-500/10 border border-blue-500/20 mb-4",children:(0,s.jsx)(I.FileCheck,{className:"h-10 w-10 text-blue-400/60"})}),(0,s.jsx)("p",{className:"text-muted-foreground mb-1",children:"No fee plans yet"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground/70",children:"Fee plans will appear here when created from deals"})]}):(0,s.jsx)("div",{className:"space-y-4",children:ew.map(e=>{let t=eS===e.id,i=e.introducer_agreement?.pdf_url;return(0,s.jsxs)("div",{className:`rounded-xl border transition-all ${t?"border-blue-500/30 bg-blue-500/5":"border-white/10 hover:border-white/20"}`,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>eD(t?null:e.id),children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:`p-2.5 rounded-lg ${"accepted"===e.status?"bg-green-500/20":"bg-slate-500/20"}`,children:(0,s.jsx)(I.FileCheck,{className:`h-5 w-5 ${"accepted"===e.status?"text-green-400":"text-slate-400"}`})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:e.name}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2 mt-0.5",children:[(0,s.jsx)(P.Briefcase,{className:"h-3 w-3"}),e.deal?.name||"Unknown Deal",e.term_sheet&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground/70",children:["• Term Sheet v",e.term_sheet.version]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.investor_count>0&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[(0,s.jsx)(B.Users,{className:"h-4 w-4"}),e.investor_count]}),i&&(0,s.jsx)(r.Badge,{className:"bg-green-500/20 text-green-400 border-green-500/30 text-xs",children:"PDF"}),(0,s.jsx)(r.Badge,{className:e$[e.status]||"bg-gray-500/20 text-gray-400",children:e.status}),t?(0,s.jsx)(L.ChevronUp,{className:"h-5 w-5 text-muted-foreground"}):(0,s.jsx)($.ChevronDown,{className:"h-5 w-5 text-muted-foreground"})]})]}),t&&(0,s.jsx)("div",{className:"px-4 pb-4 pt-0 border-t border-white/10 mt-0",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Fee Components"}),e.fee_components&&e.fee_components.length>0?(0,s.jsx)("div",{className:"space-y-2",children:e.fee_components.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 rounded bg-white/5",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:eA[e.kind]||e.kind}),(0,s.jsx)(r.Badge,{variant:"outline",className:"border-white/20 text-muted-foreground",children:e.rate_bps?`${e.rate_bps/100}%`:e.flat_amount?`$${e.flat_amount.toLocaleString()}`:"—"})]},e.id))}):e.term_sheet?(0,s.jsxs)("div",{className:"space-y-2",children:[e.term_sheet.subscription_fee_percent&&(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 rounded bg-white/5",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Subscription Fee"}),(0,s.jsxs)(r.Badge,{variant:"outline",className:"border-white/20 text-muted-foreground",children:[e.term_sheet.subscription_fee_percent,"%"]})]}),e.term_sheet.management_fee_percent&&(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 rounded bg-white/5",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Management Fee"}),(0,s.jsxs)(r.Badge,{variant:"outline",className:"border-white/20 text-muted-foreground",children:[e.term_sheet.management_fee_percent,"%"]})]}),e.term_sheet.carried_interest_percent&&(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 rounded bg-white/5",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Carried Interest"}),(0,s.jsxs)(r.Badge,{variant:"outline",className:"border-white/20 text-muted-foreground",children:[e.term_sheet.carried_interest_percent,"%"]})]})]}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No fee components defined"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Agreement"}),e.introducer_agreement?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-white/5",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-green-500/10",children:(0,s.jsx)(_.FileSignature,{className:"h-5 w-5 text-green-400"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:e.introducer_agreement.reference_number||"Agreement"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Status: ",e.introducer_agreement.status]})]})]}),e.introducer_agreement.pdf_url&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(a.Button,{variant:"outline",size:"sm",className:"flex-1 text-blue-400 border-blue-400/30 hover:bg-blue-400/10",onClick:s=>{s.stopPropagation(),fetch(`/api/storage/download?path=${encodeURIComponent(e.introducer_agreement.pdf_url)}&bucket=deal-documents`).then(e=>e.blob()).then(e=>{let s=window.URL.createObjectURL(e);window.open(s,"_blank")})},children:[(0,s.jsx)(w.Eye,{className:"h-4 w-4 mr-1"}),"Preview"]}),(0,s.jsxs)(a.Button,{variant:"outline",size:"sm",className:"flex-1 text-green-400 border-green-400/30 hover:bg-green-400/10",onClick:s=>{s.stopPropagation(),e_(e.introducer_agreement.pdf_url,e.introducer_agreement.reference_number)},disabled:ev===e.introducer_agreement.pdf_url,children:[ev===e.introducer_agreement.pdf_url?(0,s.jsx)(R.Loader2,{className:"h-4 w-4 mr-1 animate-spin"}):(0,s.jsx)(U.Download,{className:"h-4 w-4 mr-1"}),"Download"]})]})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[(0,s.jsx)(F.AlertCircle,{className:"h-4 w-4 text-amber-400"}),(0,s.jsx)("p",{className:"text-sm text-amber-400",children:"No agreement generated yet"})]}),(0,s.jsxs)("div",{className:"mt-4 space-y-2",children:[e.accepted_at&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-400",children:[(0,s.jsx)(S.CheckCircle2,{className:"h-4 w-4"}),"Accepted ",(0,en.formatDate)(e.accepted_at)]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,s.jsx)(m.Calendar,{className:"h-4 w-4"}),"Created ",(0,en.formatDate)(e.created_at)]})]}),(0,s.jsxs)(a.Button,{variant:"outline",size:"sm",className:"mt-4 w-full",onClick:s=>{s.stopPropagation(),er.push(`/versotech_main/deals/${e.deal?.id}?tab=fees`)},children:[(0,s.jsx)(A.ExternalLink,{className:"h-4 w-4 mr-2"}),"View in Deal"]})]})]})})]},e.id)})})})]})}),(0,s.jsx)(i.TabsContent,{value:"referred-investors",children:(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Referred Investors"}),(0,s.jsxs)(t.CardDescription,{children:["Investors dispatched through ",e.legal_name]})]}),(0,s.jsx)(t.CardContent,{children:eB?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)(R.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===eF.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20 mb-4",children:(0,s.jsx)(B.Users,{className:"h-10 w-10 text-purple-400/60"})}),(0,s.jsx)("p",{className:"text-muted-foreground mb-1",children:"No referred investors yet"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground/70 mb-4",children:"Investors dispatched through this introducer will appear here"}),(0,s.jsxs)(a.Button,{onClick:()=>ef(!0),className:"mb-4 bg-gradient-to-r from-orange-600 to-amber-600 hover:from-orange-500 hover:to-amber-500 text-white",children:[(0,s.jsx)(C.Send,{className:"h-4 w-4 mr-2"}),"Dispatch Investor"]}),(0,s.jsx)("div",{className:"max-w-md p-4 rounded-lg bg-blue-500/10 border border-blue-500/20 text-left",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(M.Info,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-400 mb-1",children:"How to link investors"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:['Click "Dispatch Investor" above to link an investor from a deal where ',e.legal_name," has an active fee agreement. You can also dispatch from the Deal's Members tab."]})]})]})})]}):(0,s.jsx)("div",{className:"space-y-3",children:eF.map(e=>(0,s.jsxs)("div",{className:"group flex items-center justify-between p-4 rounded-xl border border-white/10 hover:border-white/20 hover:bg-white/5 transition-all cursor-pointer",onClick:()=>er.push(`/versotech_main/deals/${e.deal?.id}?tab=members`),children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2.5 rounded-lg bg-purple-500/20",children:(0,s.jsx)(o.User,{className:"h-5 w-5 text-purple-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:e.investor?.legal_name||e.profile?.display_name||e.profile?.email||"Unknown"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2 mt-0.5",children:[(0,s.jsx)(P.Briefcase,{className:"h-3 w-3"}),e.deal?.name||"Unknown Deal",e.fee_plan&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground/70",children:["• ",e.fee_plan.name]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.subscription?.amount&&(0,s.jsx)("div",{className:"text-sm font-medium text-foreground",children:(0,en.formatCurrency)(e.subscription.amount)}),(0,s.jsx)(r.Badge,{className:e.subscription?.status==="funded"?"bg-green-500/20 text-green-400":e.subscription?.status?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400",children:e.subscription?.status||"Invited"}),(0,s.jsx)(A.ExternalLink,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]})]},e.id))})})]})}),(0,s.jsx)(i.TabsContent,{value:"agreements",children:(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(t.CardTitle,{children:"Fee Agreements"}),(0,s.jsxs)(t.CardDescription,{children:["Manage commission agreements with ",e.legal_name]})]}),(0,s.jsxs)(a.Button,{onClick:()=>eu(!0),className:"bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-500 hover:to-orange-500 text-white",children:[(0,s.jsx)(T.Plus,{className:"h-4 w-4 mr-2"}),"Create Agreement"]})]}),(0,s.jsx)(t.CardContent,{children:0===es.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-amber-500/10 to-orange-500/10 border border-amber-500/20 mb-4",children:(0,s.jsx)(_.FileSignature,{className:"h-10 w-10 text-amber-400/60"})}),(0,s.jsx)("p",{className:"text-muted-foreground mb-1",children:"No agreements yet"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground/70",children:"Create a fee agreement to enable introductions"})]}):(0,s.jsx)("div",{className:"space-y-3",children:es.map(e=>{var t;let i=eM[e.status]||{bg:"bg-gray-500/20",text:"text-gray-400",icon:(0,s.jsx)(x.FileText,{className:"h-3 w-3"})},n="active"===e.status;return e.status,e.status,(0,s.jsxs)("div",{className:`group relative flex items-center justify-between p-4 rounded-xl border transition-all duration-200 cursor-pointer
                          ${n?"border-emerald-500/30 bg-gradient-to-r from-emerald-500/5 to-transparent hover:from-emerald-500/10":"border-white/10 hover:border-white/20 hover:bg-white/5"}`,onClick:()=>er.push(`/versotech_main/introducer-agreements/${e.id}`),children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:`p-2.5 rounded-lg ${i.bg}`,children:(0,s.jsx)(_.FileSignature,{className:`h-5 w-5 ${i.text}`})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.reference_number||`Agreement ${e.id.slice(0,8)}`}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["• ",(0,en.formatBps)(e.default_commission_bps||0)]}),n&&(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-400 font-medium",children:"Current"})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mt-0.5 flex items-center gap-2",children:[e.deal&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(P.Briefcase,{className:"h-3 w-3"}),e.deal.name]}),e.effective_date&&(0,s.jsxs)("span",{children:["• ",(0,en.formatDate)(e.effective_date)]}),e.expiry_date&&(0,s.jsxs)("span",{className:"text-muted-foreground/70",children:["→ ",(0,en.formatDate)(e.expiry_date)]}),!e.deal&&!e.effective_date&&(0,s.jsxs)(s.Fragment,{children:["Created ",(0,en.formatDate)(e.created_at)]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.pdf_url&&(0,s.jsxs)(a.Button,{variant:"outline",size:"sm",className:"h-8 gap-1.5 text-blue-400 border-blue-500/30 hover:bg-blue-500/10 hover:border-blue-500/50",onClick:s=>{s.stopPropagation(),e_(e.pdf_url,e.reference_number)},disabled:ev===e.pdf_url,children:[ev===e.pdf_url?(0,s.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-blue-400"}):(0,s.jsx)(E.FileDown,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"PDF"})]}),(0,s.jsxs)(r.Badge,{className:`${i.bg} ${i.text} gap-1.5 font-medium`,children:[i.icon,{draft:"Draft",sent:"Sent",pending_approval:"Pending Approval",approved:"Approved",pending_ceo_signature:"Awaiting CEO Signature",pending_introducer_signature:"Awaiting Introducer Signature",active:"Active",expired:"Expired",rejected:"Rejected"}[t=e.status]||t]}),e.pdf_url&&(0,s.jsxs)(O.DropdownMenu,{children:[(0,s.jsx)(O.DropdownMenuTrigger,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,s.jsx)(a.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(y.MoreHorizontal,{className:"h-4 w-4"})})}),(0,s.jsxs)(O.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,s.jsxs)(O.DropdownMenuItem,{onClick:s=>{s.stopPropagation(),ey(e.pdf_url)},children:[(0,s.jsx)(w.Eye,{className:"h-4 w-4 mr-2"}),"Preview"]}),(0,s.jsxs)(O.DropdownMenuItem,{onClick:s=>{s.stopPropagation(),e_(e.pdf_url,e.reference_number)},disabled:ev===e.pdf_url,children:[(0,s.jsx)(U.Download,{className:"h-4 w-4 mr-2"}),ev===e.pdf_url?"Downloading...":"Download"]})]})]})]})]},e.id)})})})]})}),(0,s.jsx)(i.TabsContent,{value:"introductions",children:(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Introductions"}),(0,s.jsxs)(t.CardDescription,{children:["All prospects introduced by ",e.legal_name]})]}),(0,s.jsx)(t.CardContent,{children:0===Z.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,s.jsx)(p.TrendingUp,{className:"h-12 w-12 text-muted-foreground mb-4 opacity-50"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"No introductions yet"})]}):(0,s.jsx)("div",{className:"space-y-3",children:Z.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border border-white/10 hover:bg-white/5 transition-colors",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:e.investor?.legal_name||e.prospect_email||"Unknown"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.prospect_email&&e.investor?.legal_name&&(0,s.jsx)("span",{className:"mr-2",children:e.prospect_email}),e.deal?.name||"No deal linked",e.introduced_at&&` • ${(0,en.formatDate)(e.introduced_at)}`]})]}),(0,s.jsx)(r.Badge,{className:eL[e.status]??"bg-gray-500/20 text-gray-400",children:e.status})]},e.id))})})]})}),(0,s.jsx)(i.TabsContent,{value:"commissions",children:(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Commission History"}),(0,s.jsxs)(t.CardDescription,{children:["All commissions earned by ",e.legal_name]})]}),(0,s.jsx)(t.CardContent,{children:0===ee.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,s.jsx)(g.DollarSign,{className:"h-12 w-12 text-muted-foreground mb-4 opacity-50"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"No commissions yet"})]}):(0,s.jsx)("div",{className:"space-y-3",children:ee.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border border-white/10 hover:bg-white/5 transition-colors",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-foreground",children:(0,en.formatCurrency)(e.accrual_amount)}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.investor?.legal_name||"Unknown investor",e.deal&&(0,s.jsxs)(s.Fragment,{children:[" • ",e.deal.name]})]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Created ",(0,en.formatDate)(e.created_at),e.paid_at&&` • Paid ${(0,en.formatDate)(e.paid_at)}`]})]}),(0,s.jsx)(r.Badge,{className:eR[e.status]??"bg-gray-500/20 text-gray-400",children:e.status})]},e.id))})})]})}),(0,s.jsx)(i.TabsContent,{value:"kyc",children:(0,s.jsx)(z.KYCDocumentsTab,{entityType:"introducer",entityId:e.id,entityName:e.legal_name})}),(0,s.jsx)(i.TabsContent,{value:"bank",children:(0,s.jsx)(K.BankDetailsTab,{entityType:"introducer",entityId:e.id,entityName:e.legal_name})}),(0,s.jsx)(i.TabsContent,{value:"activity",children:(0,s.jsx)(V.ActivityTimelineTab,{entityType:"introducer",entityId:e.id,entityName:e.legal_name})})]}),(0,s.jsx)(q.EditIntroducerDialog,{open:ed,onOpenChange:ec,introducer:eO}),(0,s.jsx)(Q.InviteUserDialog,{open:eo,onOpenChange:em,entityType:"introducer",entityId:e.id,entityName:e.legal_name}),(0,s.jsx)(G.CreateAgreementDialog,{open:ex,onOpenChange:eu,introducerId:e.id,introducerName:e.legal_name,defaultCommissionBps:e.default_commission_bps||100}),(0,s.jsx)(ei,{open:ep,onOpenChange:ef,introducerId:e.id,introducerName:e.legal_name,feePlans:ew}),"individual"===e.type&&(0,s.jsx)(J.EntityKYCEditDialog,{open:eh,onOpenChange:eg,entityType:"introducer",entityId:e.id,entityName:e.legal_name,apiEndpoint:`/api/admin/introducers/${e.id}`,initialData:{first_name:e.first_name??void 0,middle_name:e.middle_name??void 0,last_name:e.last_name??void 0,name_suffix:e.name_suffix??void 0,date_of_birth:e.date_of_birth??void 0,country_of_birth:e.country_of_birth??void 0,nationality:e.nationality??void 0,email:e.email??void 0,phone_mobile:e.phone_mobile??void 0,phone_office:e.phone_office??void 0,residential_street:e.residential_street??void 0,residential_line_2:e.residential_line_2??void 0,residential_city:e.residential_city??void 0,residential_state:e.residential_state??void 0,residential_postal_code:e.residential_postal_code??void 0,residential_country:e.residential_country??void 0,is_us_citizen:e.is_us_citizen??void 0,is_us_taxpayer:e.is_us_taxpayer??void 0,us_taxpayer_id:e.us_taxpayer_id??void 0,country_of_tax_residency:e.country_of_tax_residency??void 0,id_type:e.id_type??void 0,id_number:e.id_number??void 0,id_issue_date:e.id_issue_date??void 0,id_expiry_date:e.id_expiry_date??void 0,id_issuing_country:e.id_issuing_country??void 0},onSuccess:()=>er.refresh()})]})}e.s(["IntroducerDetailClient",()=>ed],887786)}]);