(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,768385,e=>{"use strict";let t=(0,e.i(410587).default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);e.s(["Sparkles",()=>t],768385)},460063,e=>{"use strict";var t=e.i(722679),s=e.i(340915),a=e.i(679472),r=e.i(886978),i=e.i(47264),n=e.i(362208),l=e.i(478985),o=e.i(68977),d=e.i(599205),c=e.i(460138),m=e.i(657180),u=e.i(873358),x="Radio",[h,p]=(0,i.createContextScope)(x),[g,b]=h(x),f=s.forwardRef((e,i)=>{let{__scopeRadio:l,name:o,checked:d=!1,required:c,disabled:m,value:u="on",onCheck:x,form:h,...p}=e,[b,f]=s.useState(null),v=(0,r.useComposedRefs)(i,e=>f(e)),y=s.useRef(!1),_=!b||h||!!b.closest("form");return(0,t.jsxs)(g,{scope:l,checked:d,disabled:m,children:[(0,t.jsx)(n.Primitive.button,{type:"button",role:"radio","aria-checked":d,"data-state":N(d),"data-disabled":m?"":void 0,disabled:m,value:u,...p,ref:v,onClick:(0,a.composeEventHandlers)(e.onClick,e=>{d||x?.(),_&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})}),_&&(0,t.jsx)(j,{control:b,bubbles:!y.current,name:o,value:u,checked:d,required:c,disabled:m,form:h,style:{transform:"translateX(-100%)"}})]})});f.displayName=x;var v="RadioIndicator",y=s.forwardRef((e,s)=>{let{__scopeRadio:a,forceMount:r,...i}=e,l=b(v,a);return(0,t.jsx)(u.Presence,{present:r||l.checked,children:(0,t.jsx)(n.Primitive.span,{"data-state":N(l.checked),"data-disabled":l.disabled?"":void 0,...i,ref:s})})});y.displayName=v;var j=s.forwardRef(({__scopeRadio:e,control:a,checked:i,bubbles:l=!0,...o},d)=>{let u=s.useRef(null),x=(0,r.useComposedRefs)(u,d),h=(0,m.usePrevious)(i),p=(0,c.useSize)(a);return s.useEffect(()=>{let e=u.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(h!==i&&t){let s=new Event("click",{bubbles:l});t.call(e,i),e.dispatchEvent(s)}},[h,i,l]),(0,t.jsx)(n.Primitive.input,{type:"radio","aria-hidden":!0,defaultChecked:i,...o,tabIndex:-1,ref:x,style:{...o.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function N(e){return e?"checked":"unchecked"}j.displayName="RadioBubbleInput";var _=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],w="RadioGroup",[S,C]=(0,i.createContextScope)(w,[l.createRovingFocusGroupScope,p]),k=(0,l.createRovingFocusGroupScope)(),F=p(),[I,E]=S(w),L=s.forwardRef((e,s)=>{let{__scopeRadioGroup:a,name:r,defaultValue:i,value:c,required:m=!1,disabled:u=!1,orientation:x,dir:h,loop:p=!0,onValueChange:g,...b}=e,f=k(a),v=(0,d.useDirection)(h),[y,j]=(0,o.useControllableState)({prop:c,defaultProp:i??null,onChange:g,caller:w});return(0,t.jsx)(I,{scope:a,name:r,required:m,disabled:u,value:y,onValueChange:j,children:(0,t.jsx)(l.Root,{asChild:!0,...f,orientation:x,dir:v,loop:p,children:(0,t.jsx)(n.Primitive.div,{role:"radiogroup","aria-required":m,"aria-orientation":x,"data-disabled":u?"":void 0,dir:v,...b,ref:s})})})});L.displayName=w;var D="RadioGroupItem",R=s.forwardRef((e,i)=>{let{__scopeRadioGroup:n,disabled:o,...d}=e,c=E(D,n),m=c.disabled||o,u=k(n),x=F(n),h=s.useRef(null),p=(0,r.useComposedRefs)(i,h),g=c.value===d.value,b=s.useRef(!1);return s.useEffect(()=>{let e=e=>{_.includes(e.key)&&(b.current=!0)},t=()=>b.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),(0,t.jsx)(l.Item,{asChild:!0,...u,focusable:!m,active:g,children:(0,t.jsx)(f,{disabled:m,required:c.required,checked:g,...x,...d,name:c.name,ref:p,onCheck:()=>c.onValueChange(d.value),onKeyDown:(0,a.composeEventHandlers)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,a.composeEventHandlers)(d.onFocus,()=>{b.current&&h.current?.click()})})})});R.displayName=D;var T=s.forwardRef((e,s)=>{let{__scopeRadioGroup:a,...r}=e,i=F(a);return(0,t.jsx)(y,{...i,...r,ref:s})});T.displayName="RadioGroupIndicator";var P=e.i(725176),P=P,A=e.i(282141);function O({className:e,...s}){return(0,t.jsx)(L,{"data-slot":"radio-group",className:(0,A.cn)("grid gap-3",e),...s})}function B({className:e,...s}){return(0,t.jsx)(R,{"data-slot":"radio-group-item",className:(0,A.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-5 md:size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:(0,t.jsx)(T,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,t.jsx)(P.default,{className:"fill-primary absolute top-1/2 left-1/2 size-2.5 md:size-2 -translate-x-1/2 -translate-y-1/2"})})})}e.s(["RadioGroup",()=>O,"RadioGroupItem",()=>B],460063)},259802,e=>{"use strict";var t=e.i(722679),s=e.i(340915),a=e.i(971743),r=e.i(871561),i=e.i(704477),n=e.i(119311),l=e.i(263229),o=e.i(316264),d=e.i(352776),c=e.i(191569),m=e.i(514133),u=e.i(816654),x=e.i(538892),h=e.i(994500);function p({open:e,onClose:p,onSuccess:g,entity:b}){let[f,v]=(0,s.useState)(!1),[y,j]=(0,s.useState)({entity_type:"",legal_name:"",registration_number:"",jurisdiction:"",tax_id:"",formation_date:"",address_street:"",address_city:"",address_state:"",address_postal_code:"",address_country:"",representative_name:"",representative_title:"",representative_email:"",representative_phone:"",notes:""});(0,s.useEffect)(()=>{b?j({entity_type:b.entity_type||"",legal_name:b.legal_name||"",registration_number:b.registration_number||"",jurisdiction:b.jurisdiction||"",tax_id:b.tax_id||"",formation_date:b.formation_date||"",address_street:b.registered_address?.street||"",address_city:b.registered_address?.city||"",address_state:b.registered_address?.state||"",address_postal_code:b.registered_address?.postal_code||"",address_country:b.registered_address?.country||"",representative_name:b.representative_name||"",representative_title:b.representative_title||"",representative_email:b.representative_email||"",representative_phone:b.representative_phone||"",notes:b.notes||""}):j({entity_type:"",legal_name:"",registration_number:"",jurisdiction:"",tax_id:"",formation_date:"",address_street:"",address_city:"",address_state:"",address_postal_code:"",address_country:"",representative_name:"",representative_title:"",representative_email:"",representative_phone:"",notes:""})},[b,e]);let N=async e=>{if(e.preventDefault(),!y.entity_type||!y.legal_name)return void h.toast.error("Please fill in all required fields");v(!0);try{let e={entity_type:y.entity_type,legal_name:y.legal_name,registration_number:y.registration_number||null,jurisdiction:y.jurisdiction||null,tax_id:y.tax_id||null,formation_date:y.formation_date||null,registered_address:{street:y.address_street||void 0,city:y.address_city||void 0,state:y.address_state||void 0,postal_code:y.address_postal_code||void 0,country:y.address_country||void 0},representative_name:y.representative_name||null,representative_title:y.representative_title||null,representative_email:y.representative_email||null,representative_phone:y.representative_phone||null,notes:y.notes||null},t=b?`/api/investors/me/counterparty-entities/${b.id}`:"/api/investors/me/counterparty-entities",s=b?"PATCH":"POST",a=await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to save entity")}h.toast.success(b?"Entity updated successfully":"Entity created successfully"),g()}catch(e){console.error("Save error:",e),h.toast.error(e.message||"Failed to save entity")}finally{v(!1)}};return(0,t.jsx)(d.Dialog,{open:e,onOpenChange:p,children:(0,t.jsxs)(d.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-hidden flex flex-col p-0",children:[(0,t.jsx)(d.DialogHeader,{className:"px-8 pt-8 pb-6 border-b border-slate-100 bg-gradient-to-b from-slate-50/80 to-white",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-emerald-500/10 flex items-center justify-center",children:(0,t.jsx)(a.Building2,{className:"w-6 h-6 text-emerald-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d.DialogTitle,{className:"text-xl font-semibold text-slate-900",children:b?"Edit Entity":"Add New Entity"}),(0,t.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:b?"Update the details of this legal entity":"Add a legal entity that you invest through"})]})]})}),(0,t.jsxs)("form",{onSubmit:N,className:"flex-1 overflow-y-auto",children:[(0,t.jsxs)("div",{className:"px-8 py-8 space-y-10",children:[(0,t.jsxs)("section",{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 pb-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center",children:(0,t.jsx)(a.Building2,{className:"w-4 h-4 text-slate-600"})}),(0,t.jsx)("h3",{className:"font-medium text-slate-900",children:"Entity Information"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(m.Label,{htmlFor:"entity_type",className:"text-sm font-medium text-slate-700",children:["Entity Type ",(0,t.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,t.jsxs)(x.Select,{value:y.entity_type,onValueChange:e=>j({...y,entity_type:e}),children:[(0,t.jsx)(x.SelectTrigger,{className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20",children:(0,t.jsx)(x.SelectValue,{placeholder:"Select entity type"})}),(0,t.jsxs)(x.SelectContent,{children:[(0,t.jsx)(x.SelectItem,{value:"trust",children:"Trust"}),(0,t.jsx)(x.SelectItem,{value:"llc",children:"LLC"}),(0,t.jsx)(x.SelectItem,{value:"partnership",children:"Partnership"}),(0,t.jsx)(x.SelectItem,{value:"family_office",children:"Family Office"}),(0,t.jsx)(x.SelectItem,{value:"law_firm",children:"Law Firm"}),(0,t.jsx)(x.SelectItem,{value:"investment_bank",children:"Investment Bank"}),(0,t.jsx)(x.SelectItem,{value:"fund",children:"Fund"}),(0,t.jsx)(x.SelectItem,{value:"corporation",children:"Corporation"}),(0,t.jsx)(x.SelectItem,{value:"other",children:"Other"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(m.Label,{htmlFor:"legal_name",className:"text-sm font-medium text-slate-700",children:["Legal Name ",(0,t.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,t.jsx)(c.Input,{id:"legal_name",value:y.legal_name,onChange:e=>j({...y,legal_name:e.target.value}),placeholder:"Full legal name",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20",required:!0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"registration_number",className:"text-sm font-medium text-slate-700",children:"Registration Number"}),(0,t.jsx)(c.Input,{id:"registration_number",value:y.registration_number,onChange:e=>j({...y,registration_number:e.target.value}),placeholder:"Company registration number",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"tax_id",className:"text-sm font-medium text-slate-700",children:"Tax ID / EIN"}),(0,t.jsx)(c.Input,{id:"tax_id",value:y.tax_id,onChange:e=>j({...y,tax_id:e.target.value}),placeholder:"Tax ID or EIN",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"jurisdiction",className:"text-sm font-medium text-slate-700",children:"Jurisdiction"}),(0,t.jsx)(c.Input,{id:"jurisdiction",value:y.jurisdiction,onChange:e=>j({...y,jurisdiction:e.target.value}),placeholder:"State or country of formation",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"formation_date",className:"text-sm font-medium text-slate-700",children:"Formation Date"}),(0,t.jsx)(c.Input,{id:"formation_date",type:"date",value:y.formation_date,onChange:e=>j({...y,formation_date:e.target.value}),className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]})]})]}),(0,t.jsxs)("section",{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 pb-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center",children:(0,t.jsx)(r.MapPin,{className:"w-4 h-4 text-slate-600"})}),(0,t.jsx)("h3",{className:"font-medium text-slate-900",children:"Registered Address"})]}),(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"address_street",className:"text-sm font-medium text-slate-700",children:"Street Address"}),(0,t.jsx)(c.Input,{id:"address_street",value:y.address_street,onChange:e=>j({...y,address_street:e.target.value}),placeholder:"123 Main Street, Suite 100",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"address_city",className:"text-sm font-medium text-slate-700",children:"City"}),(0,t.jsx)(c.Input,{id:"address_city",value:y.address_city,onChange:e=>j({...y,address_city:e.target.value}),placeholder:"City",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"address_state",className:"text-sm font-medium text-slate-700",children:"State / Province"}),(0,t.jsx)(c.Input,{id:"address_state",value:y.address_state,onChange:e=>j({...y,address_state:e.target.value}),placeholder:"State or province",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"address_postal_code",className:"text-sm font-medium text-slate-700",children:"Postal Code"}),(0,t.jsx)(c.Input,{id:"address_postal_code",value:y.address_postal_code,onChange:e=>j({...y,address_postal_code:e.target.value}),placeholder:"Postal code",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"address_country",className:"text-sm font-medium text-slate-700",children:"Country"}),(0,t.jsx)(c.Input,{id:"address_country",value:y.address_country,onChange:e=>j({...y,address_country:e.target.value}),placeholder:"Country",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]})]})]})]}),(0,t.jsxs)("section",{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 pb-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center",children:(0,t.jsx)(i.User,{className:"w-4 h-4 text-slate-600"})}),(0,t.jsx)("h3",{className:"font-medium text-slate-900",children:"Authorized Representative"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"representative_name",className:"text-sm font-medium text-slate-700",children:"Full Name"}),(0,t.jsx)(c.Input,{id:"representative_name",value:y.representative_name,onChange:e=>j({...y,representative_name:e.target.value}),placeholder:"Representative's full name",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"representative_title",className:"text-sm font-medium text-slate-700",children:"Title / Role"}),(0,t.jsx)(c.Input,{id:"representative_title",value:y.representative_title,onChange:e=>j({...y,representative_title:e.target.value}),placeholder:"e.g., Managing Director",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"representative_email",className:"text-sm font-medium text-slate-700",children:"Email"}),(0,t.jsx)(c.Input,{id:"representative_email",type:"email",value:y.representative_email,onChange:e=>j({...y,representative_email:e.target.value}),placeholder:"email@example.com",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"representative_phone",className:"text-sm font-medium text-slate-700",children:"Phone"}),(0,t.jsx)(c.Input,{id:"representative_phone",value:y.representative_phone,onChange:e=>j({...y,representative_phone:e.target.value}),placeholder:"+1 (555) 123-4567",className:"h-11 bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20"})]})]})]}),(0,t.jsxs)("section",{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 pb-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center",children:(0,t.jsx)(n.FileText,{className:"w-4 h-4 text-slate-600"})}),(0,t.jsx)("h3",{className:"font-medium text-slate-900",children:"Additional Notes"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(m.Label,{htmlFor:"notes",className:"text-sm font-medium text-slate-700",children:["Notes ",(0,t.jsx)("span",{className:"text-slate-400 font-normal",children:"(Optional)"})]}),(0,t.jsx)(u.Textarea,{id:"notes",value:y.notes,onChange:e=>j({...y,notes:e.target.value}),placeholder:"Any additional notes about this entity...",rows:4,className:"bg-white border-slate-200 focus:border-emerald-500 focus:ring-emerald-500/20 resize-none"})]})]})]}),(0,t.jsxs)("div",{className:"sticky bottom-0 px-8 py-5 border-t border-slate-100 bg-slate-50/80 backdrop-blur-sm flex items-center justify-end gap-3",children:[(0,t.jsx)(o.Button,{type:"button",variant:"outline",onClick:p,disabled:f,className:"px-5 border-slate-200 hover:bg-white",children:"Cancel"}),(0,t.jsx)(o.Button,{type:"submit",disabled:f,className:"px-6 bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm",children:f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):b?"Update Entity":"Create Entity"})]})]})]})})}e.s(["EntityFormDialog",()=>p])},54889,e=>{"use strict";var t=e.i(722679),s=e.i(340915),a=e.i(191569),r=e.i(816654),i=e.i(316264),n=e.i(514133),l=e.i(312692),o=e.i(90613),d=e.i(263229),c=e.i(619324),m=e.i(733179),u=e.i(460063),x=e.i(538892),h=e.i(831833),p=e.i(971743),g=e.i(704477),b=e.i(994500),f=e.i(259802);function v({value:e,onChange:a}){let r,[l,o]=(0,s.useState)([]),[d,c]=(0,s.useState)(!0),[m,v]=(0,s.useState)(!1);(0,s.useEffect)(()=>{y()},[]);let y=async()=>{try{let e=await fetch("/api/investors/me/counterparty-entities");if(!e.ok)throw Error("Failed to load entities");let t=await e.json();o(t.entities||[])}catch(e){console.error("Error loading entities:",e),b.toast.error("Failed to load entities")}finally{c(!1)}},j=async()=>{v(!1),await y()},N=e=>({trust:"Trust",llc:"LLC",partnership:"Partnership",family_office:"Family Office",law_firm:"Law Firm",investment_bank:"Investment Bank",fund:"Fund",corporation:"Corporation",other:"Other"})[e]||e;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(n.Label,{className:"text-base font-medium",children:"Investment Type"}),(0,t.jsxs)(u.RadioGroup,{value:e.subscription_type,onValueChange:t=>{a({subscription_type:t,counterparty_entity_id:"personal"===t?null:e.counterparty_entity_id})},className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 rounded-lg border p-4 hover:bg-muted transition-colors",children:[(0,t.jsx)(u.RadioGroupItem,{value:"personal",id:"personal"}),(0,t.jsxs)(n.Label,{htmlFor:"personal",className:"flex-1 cursor-pointer",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.User,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"font-medium",children:"Invest Personally"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Subscribe using your personal investor profile"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 rounded-lg border p-4 hover:bg-muted transition-colors",children:[(0,t.jsx)(u.RadioGroupItem,{value:"entity",id:"entity"}),(0,t.jsxs)(n.Label,{htmlFor:"entity",className:"flex-1 cursor-pointer",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Building2,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"font-medium",children:"Invest Through Entity"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Subscribe through a legal entity (trust, LLC, partnership, etc.)"})]})]})]})]}),"entity"===e.subscription_type&&(0,t.jsxs)("div",{className:"space-y-3 pl-8 border-l-2 border-primary/20",children:[(0,t.jsx)(n.Label,{htmlFor:"entity-select",children:"Select Entity"}),d?(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading entities..."}):0===l.length?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"You haven't added any entities yet. Create one to invest through a legal entity."}),(0,t.jsxs)(i.Button,{type:"button",variant:"outline",onClick:()=>v(!0),children:[(0,t.jsx)(h.Plus,{className:"w-4 h-4 mr-2"}),"Create Entity"]})]}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)(x.Select,{value:e.counterparty_entity_id||"",onValueChange:e=>{a({subscription_type:"entity",counterparty_entity_id:e})},children:[(0,t.jsx)(x.SelectTrigger,{id:"entity-select",className:"bg-background text-foreground border-border",children:(0,t.jsx)(x.SelectValue,{placeholder:"Select an entity"})}),(0,t.jsx)(x.SelectContent,{className:"bg-background text-foreground border-border",children:l.map(e=>(0,t.jsx)(x.SelectItem,{value:e.id,className:"text-foreground focus:bg-muted focus:text-foreground",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium",children:e.legal_name}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground/70",children:["(",N(e.entity_type),")"]})]})},e.id))})]}),(0,t.jsxs)(i.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>v(!0),children:[(0,t.jsx)(h.Plus,{className:"w-4 h-4 mr-2"}),"Add New Entity"]}),e.counterparty_entity_id&&(0,t.jsx)("div",{className:"rounded-lg bg-muted border border-border p-3",children:(r=l.find(t=>t.id===e.counterparty_entity_id))?(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsx)("div",{className:"font-medium text-foreground",children:r.legal_name}),(0,t.jsxs)("div",{className:"text-muted-foreground",children:["Type: ",N(r.entity_type)]}),r.jurisdiction&&(0,t.jsxs)("div",{className:"text-muted-foreground",children:["Jurisdiction: ",r.jurisdiction]}),r.representative_name&&(0,t.jsxs)("div",{className:"text-muted-foreground",children:["Representative: ",r.representative_name]})]}):null})]})]}),(0,t.jsx)(f.EntityFormDialog,{open:m,onClose:()=>v(!1),onSuccess:j})]})}var y=e.i(80289),j=e.i(937368);function N({dealId:e,currency:u,existingSubmission:x}){let[h,p]=(0,s.useState)(""),[g,b]=(0,s.useState)(!1),[f,N]=(0,s.useState)(""),[_,w]=(0,s.useState)({subscription_type:"personal",counterparty_entity_id:null}),[S,C]=(0,s.useState)(!1),[k,F]=(0,s.useState)(null),[I,E]=(0,s.useState)(null),[L,D]=(0,s.useState)(null),[R,T]=(0,s.useState)(!0);(0,s.useEffect)(()=>{!async function(){try{let t=await fetch(`/api/deals/${e}/capacity`);if(t.ok){let e=await t.json();D(e)}}catch(e){console.error("Failed to fetch deal capacity:",e)}finally{T(!1)}}()},[e]);let P=L?.target_raise?L.total_subscribed/L.target_raise*100:0,A=P>100;L?.target_raise&&(L.target_raise,L.total_subscribed);let O=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:u,minimumFractionDigits:0,maximumFractionDigits:0}).format(e),B=x&&"pending_review"===x.status,$=async t=>{if(t.preventDefault(),!B){C(!0),F(null),E(null);try{let t=parseFloat(h);if(!t||Number.isNaN(t)||t<=0){E("Enter a valid subscription amount."),C(!1);return}if("entity"===_.subscription_type&&!_.counterparty_entity_id){E("Please select an entity or create one to invest through an entity."),C(!1);return}let s=await fetch(`/api/deals/${e}/subscriptions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:{amount:t,currency:u,bank_confirmation:g,notes:f.trim()||null},subscription_type:_.subscription_type,counterparty_entity_id:_.counterparty_entity_id||null})}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to submit subscription");F("Subscription submitted for review. The VERSO team will follow up shortly."),p(""),b(!1),N("")}catch(e){E(e instanceof Error?e.message:"Unexpected error submitting subscription")}finally{C(!1)}}};if(B){let e=x?.submitted_at?new Date(x.submitted_at).toLocaleString():"Recently";return(0,t.jsx)(o.Card,{className:"border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20",children:(0,t.jsxs)(o.CardContent,{className:"py-4 text-sm text-muted-foreground space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-amber-700 dark:text-amber-300",children:[(0,t.jsx)(d.Loader2,{className:"h-4 w-4 animate-spin"}),"Subscription under review"]}),(0,t.jsxs)("p",{children:["Submitted on ",e,". The VERSO team is reviewing your request."]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"You'll be notified once a decision is made. Contact your relationship manager if you need to make urgent changes."})]})})}let q=parseFloat(h),U=[];return!isNaN(q)&&q>0&&(L?.min_ticket&&q<L.min_ticket&&U.push(`Below minimum investment of ${O(L.min_ticket)}`),L?.max_ticket&&q>L.max_ticket&&U.push(`Above maximum investment of ${O(L.max_ticket)}`)),(0,t.jsxs)("form",{onSubmit:$,className:"space-y-5",children:[!R&&L&&L.target_raise&&(0,t.jsx)(o.Card,{className:A?"border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20":"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20",children:(0,t.jsx)(o.CardContent,{className:"pt-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Deal Progress"}),(0,t.jsxs)("span",{className:"text-sm font-bold text-foreground",children:[P.toFixed(1),"% subscribed"]})]}),(0,t.jsx)(j.Progress,{value:Math.min(P,100),className:A?"bg-orange-200 dark:bg-orange-800":"bg-blue-200 dark:bg-blue-800"}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:[O(L.total_subscribed)," committed"]}),(0,t.jsxs)("span",{children:["Target: ",O(L.target_raise)]})]}),A&&(0,t.jsxs)(y.Alert,{className:"border-orange-300 bg-orange-100",children:[(0,t.jsx)(m.TrendingUp,{className:"h-4 w-4"}),(0,t.jsxs)(y.AlertDescription,{className:"text-xs",children:["This deal is oversubscribed by ",(P-100).toFixed(1),"%. You can still submit your interest, but allocation is not guaranteed."]})]}),L.min_ticket&&L.max_ticket&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground pt-1 border-t border-border",children:["Investment range: ",O(L.min_ticket)," - ",O(L.max_ticket)]})]})})}),(0,t.jsx)(v,{value:_,onChange:w}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(n.Label,{htmlFor:`subscription-amount-${e}`,className:"text-base font-semibold",children:["Subscription Amount (",u,")"]}),(0,t.jsx)(a.Input,{id:`subscription-amount-${e}`,type:"number",min:"0",step:"0.01",value:h,onChange:e=>p(e.target.value),placeholder:"e.g. 250000",className:"text-foreground text-lg h-12"}),U.length>0&&(0,t.jsxs)(y.Alert,{className:"mt-2 border-yellow-300 bg-yellow-50",children:[(0,t.jsx)(c.AlertTriangle,{className:"h-4 w-4 text-yellow-600"}),(0,t.jsxs)(y.AlertDescription,{className:"text-xs text-yellow-800",children:[U.join(". "),". You may still submit, but staff review is required."]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{className:"text-base font-semibold",children:"Bank & Compliance"}),(0,t.jsxs)("div",{className:"flex items-start space-x-3 rounded-md border-2 border-border px-4 py-3 bg-muted",children:[(0,t.jsx)(l.Checkbox,{id:`bank-confirmation-${e}`,checked:g,onCheckedChange:e=>b(!!e),className:"mt-0.5"}),(0,t.jsx)(n.Label,{htmlFor:`bank-confirmation-${e}`,className:"text-sm text-foreground font-normal cursor-pointer leading-relaxed",children:"I confirm my bank/KYC documentation is ready for the subscription pack."})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:`subscription-notes-${e}`,className:"text-base font-semibold",children:"Additional Notes (optional)"}),(0,t.jsx)(r.Textarea,{id:`subscription-notes-${e}`,value:f,onChange:e=>N(e.target.value),rows:3,placeholder:"Share wiring preferences, co-investor details, or other information for the VERSO team.",className:"text-foreground"})]}),I&&(0,t.jsx)("div",{className:"text-sm text-red-600 font-medium bg-red-50 p-3 rounded-md border border-red-200",children:I}),k&&(0,t.jsx)("div",{className:"text-sm text-emerald-600 font-medium bg-emerald-50 p-3 rounded-md border border-emerald-200",children:k}),(0,t.jsxs)(i.Button,{type:"submit",disabled:S,className:"w-full h-14 text-lg font-bold bg-blue-600 hover:bg-blue-700 text-white gap-2 shadow-md",children:[S&&(0,t.jsx)(d.Loader2,{className:"h-5 w-5 animate-spin"}),"Submit Subscription Request"]})]})}e.s(["SubmitSubscriptionForm",()=>N],54889)},721610,e=>{"use strict";var t=e.i(722679),s=e.i(340915),a=e.i(352776),r=e.i(316264),i=e.i(191569),n=e.i(514133),l=e.i(816654),o=e.i(80289),d=e.i(263229),c=e.i(15098),m=e.i(768385);function u({dealId:e,dealName:u,currency:x,investorId:h,defaultAmount:p,isClosed:g=!1,onSubmitted:b,children:f}){let[v,y]=(0,s.useState)(!1),[j,N]=(0,s.useState)(p?p.toString():""),[_,w]=(0,s.useState)(""),[S,C]=(0,s.useState)(!1),[k,F]=(0,s.useState)(null),[I,E]=(0,s.useState)(!1),L=(0,s.useCallback)(()=>{N(p?p.toString():""),w(""),C(!1),F(null),E(!1)},[p]),D=e=>{y(e),e||L()},R=async t=>{t.preventDefault(),C(!0),F(null);try{let t=j.trim(),s={investor_id:h,notes:_.trim()||void 0};if(t){let e=Number(t.replace(/[^0-9.]/g,""));if(Number.isFinite(e)&&e>0)s.indicative_amount=e,x&&(s.indicative_currency=x);else throw Error("Enter a valid indicative amount or leave the field blank.")}g&&(s.is_post_close=!0);let a=await fetch(`/api/deals/${e}/interests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e?.error||"Unable to submit interest right now.")}E(!0),b&&await b(),setTimeout(()=>{y(!1),L()},1500)}catch(e){F(e instanceof Error?e.message:"Unexpected error")}finally{C(!1)}};return(0,t.jsxs)(a.Dialog,{open:v,onOpenChange:D,children:[(0,t.jsx)(a.DialogTrigger,{asChild:!0,children:f}),(0,t.jsxs)(a.DialogContent,{className:"max-w-lg",children:[(0,t.jsxs)(a.DialogHeader,{children:[(0,t.jsxs)(a.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Sparkles,{className:"h-5 w-5 text-blue-600"}),g?"Notify Me About Similar Deals":"Submit Interest for Data Room"]}),(0,t.jsx)(a.DialogDescription,{children:g?`Let the VERSO team know you're interested in similar opportunities to ${u}. We'll notify you when comparable deals become available.`:`Submit your interest to access the data room for ${u}. Once approved, you'll receive the NDA to sign.`})]}),I?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 text-center",children:[(0,t.jsx)(c.CheckCircle2,{className:"h-12 w-12 text-green-500 mb-4"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-green-700",children:"Interest submitted"}),(0,t.jsx)("p",{className:"text-sm text-green-600",children:"We'll notify you as soon as the team responds."})]}):(0,t.jsxs)("form",{className:"space-y-5",onSubmit:R,children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"indicative-amount",children:"Indicative amount or range"}),(0,t.jsx)(i.Input,{id:"indicative-amount",placeholder:`e.g. ${x??""} 250k`,value:j,onChange:e=>N(e.target.value),inputMode:"decimal"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Optional â€” helps the team size the allocation. You can share a single number or range."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"interest-notes",children:"Notes for the team"}),(0,t.jsx)(l.Textarea,{id:"interest-notes",placeholder:"Add any context or questions you'd like the team to review.",value:_,onChange:e=>w(e.target.value),rows:4})]}),k&&(0,t.jsx)(o.Alert,{variant:"destructive",children:(0,t.jsx)(o.AlertDescription,{children:k})}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>D(!1),disabled:S,children:"Cancel"}),(0,t.jsx)(r.Button,{type:"submit",disabled:S,children:S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Loader2,{className:"h-4 w-4 animate-spin mr-2"}),"Sending"]}):"Submit interest"})]})]})]})]})}e.s(["InterestModal",()=>u])},954620,e=>{"use strict";var t=e.i(722679),s=e.i(340915),a=e.i(352776),r=e.i(54889),i=e.i(691974);function n({dealId:e,dealName:n,currency:l,children:o,existingSubmission:d}){let[c,m]=(0,s.useState)(!1),u=d?{id:d.id,status:d.status,submitted_at:d.submitted_at,payload_json:{}}:null;return(0,t.jsxs)(a.Dialog,{open:c,onOpenChange:m,children:[(0,t.jsx)(a.DialogTrigger,{asChild:!0,children:o}),(0,t.jsxs)(a.DialogContent,{className:"max-w-xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(a.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-emerald-100",children:(0,t.jsx)(i.Briefcase,{className:"h-5 w-5 text-emerald-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(a.DialogTitle,{className:"text-xl",children:"Subscribe to Investment Opportunity"}),(0,t.jsxs)(a.DialogDescription,{children:["Submit a subscription request for ",n,". The team will review it before sending the NDA and subscription documents.",(0,t.jsx)("span",{className:"block mt-1 text-amber-600 dark:text-amber-400 text-xs",children:"Note: This request does not include data room access."})]})]})]})}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(r.SubmitSubscriptionForm,{dealId:e,currency:l,existingSubmission:u})})]})]})}e.s(["SubscribeNowDialog",()=>n])}]);