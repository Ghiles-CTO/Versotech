(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,663216,e=>{"use strict";var t=e.i(340915),r=e.i(994500),s=e.i(722318),a=e.i(676967);let l=["application/pdf","image/png","image/jpeg","image/jpg","image/gif","image/webp","text/plain"],o=["pdf","png","jpeg","jpg","gif","webp","txt","text"];function i(){let[e,i]=(0,t.useState)(!1),[n,d]=(0,t.useState)(null),[c,m]=(0,t.useState)(null),[u,h]=(0,t.useState)(!1),[x,p]=(0,t.useState)(null),g=(0,t.useCallback)(async(e,t)=>{p(null),m(null);let n=(e=>{let t;if(e.file_size_bytes&&!(e.file_size_bytes<=0xa00000))return"File is too large for preview (maximum 10MB). Please download to view.";let r=e.file_name||e.name||"",s=!!r&&!!(t=r.split(".").pop()?.toLowerCase())&&o.includes(t),a=e.mime_type||"",i=!!a&&l.includes(a);return["docx","doc","xlsx","xls","pptx","ppt","odt","ods","odp"].includes(r.split(".").pop()?.toLowerCase()||"")||a&&(a.includes("officedocument")||a.includes("msword")||a.includes("ms-excel")||a.includes("ms-powerpoint")||a.includes("opendocument"))?"Office documents cannot be previewed. Please download to view.":s||i?null:"Preview not supported for this file type. Please download to view."})(e);if(n)return void r.toast.error(n);d(e),i(!0),h(!0);try{let r=t?await s.DocumentService.getDealDocumentPreviewUrl(t,e.id):await s.DocumentService.getPreviewUrl(e.id);m(r.download_url),h(!1)}catch(t){console.error("Failed to load document preview:",t);let e=t instanceof a.DocumentError?s.DocumentService.getErrorMessage(t):"Failed to load document preview. Please try downloading instead.";p(e),h(!1),r.toast.error(e)}},[]),b=(0,t.useCallback)(()=>{i(!1),setTimeout(()=>{d(null),m(null),p(null),h(!1)},300)},[]),f=(0,t.useCallback)(async()=>{if(n)try{if(c)return void window.open(c,"_blank");let e=await s.DocumentService.getDownloadUrl(n.id);window.open(e.download_url,"_blank")}catch(t){console.error("Failed to download document:",t);let e=t instanceof a.DocumentError?s.DocumentService.getErrorMessage(t):"Failed to download document";r.toast.error(e)}},[n,c]);return{isOpen:e,document:n,previewUrl:c,isLoading:u,error:x,openPreview:g,closePreview:b,downloadDocument:f}}e.s(["useDocumentViewer",()=>i],663216)},619962,e=>{"use strict";var t=e.i(722679),r=e.i(340915),s=e.i(400557),a=e.i(432598),l=e.i(761722),o=e.i(263229),i=e.i(401148),n=e.i(119311),d=e.i(316264),c=e.i(282141);function m({isOpen:e,document:m,previewUrl:u,isLoading:h,error:x,onClose:p,onDownload:g}){let[b,f]=(0,r.useState)(!1),[w,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>(v(!0),()=>v(!1)),[]);let j=(0,r.useMemo)(()=>{var e;return u?(e=m?.file_name||m?.name,e?.toLowerCase().endsWith(".pdf")||u?.toLowerCase().includes(".pdf")||u?.includes("deal-documents")&&u?.includes(".pdf")||0)?u.includes("#")?u:`${u}#navpanes=0&view=FitH&pagemode=none`:u:null},[u,m]);if((0,r.useEffect)(()=>{let t=e=>{"Escape"===e.key&&p(),e.ctrlKey&&"d"===e.key&&(e.preventDefault(),g())};if(e&&1)return window.addEventListener("keydown",t),window.document?.body&&(window.document.body.style.overflow="hidden"),()=>{window.removeEventListener("keydown",t),window.document?.body&&(window.document.body.style.overflow="")}},[e,p,g]),(0,r.useEffect)(()=>{f(!1)},[u]),!e||!w)return null;let N=(0,t.jsxs)("div",{className:"fixed inset-0 z-[9999] bg-black/95 overflow-hidden",children:[(0,t.jsxs)("div",{className:"h-16 bg-white border-b shadow-md flex items-center justify-between px-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[(0,t.jsx)(n.FileText,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:m?.file_name||m?.name||"Document Preview"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[m?.type&&(0,t.jsx)("span",{className:"capitalize",children:m.type}),m?.file_size_bytes&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{children:(0,c.formatFileSize)(m.file_size_bytes)})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,t.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:g,className:"gap-2",children:[(0,t.jsx)(l.Download,{className:"h-4 w-4"}),"Download"]}),(0,t.jsxs)(d.Button,{variant:"ghost",size:"sm",onClick:p,className:"gap-2",children:[(0,t.jsx)(a.X,{className:"h-4 w-4"}),"Close"]})]})]}),(0,t.jsxs)("div",{className:"h-[calc(100vh-4rem)] bg-gray-900",children:[(h||x||b)&&(0,t.jsxs)("div",{className:"w-full h-full flex items-center justify-center",children:[h&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 text-white",children:[(0,t.jsx)(o.Loader2,{className:"h-12 w-12 animate-spin"}),(0,t.jsx)("p",{className:"text-lg",children:"Loading document..."})]}),x&&!h&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 text-white max-w-md mx-auto px-4",children:[(0,t.jsx)(i.AlertCircle,{className:"h-16 w-16 text-red-400"}),(0,t.jsx)("h3",{className:"text-xl font-semibold",children:"Failed to Load Preview"}),(0,t.jsx)("p",{className:"text-gray-300 text-center",children:x}),(0,t.jsxs)(d.Button,{onClick:g,variant:"secondary",className:"gap-2 mt-4",children:[(0,t.jsx)(l.Download,{className:"h-4 w-4"}),"Download Instead"]})]}),b&&!h&&!x&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 text-white max-w-md mx-auto px-4",children:[(0,t.jsx)(i.AlertCircle,{className:"h-16 w-16 text-red-400"}),(0,t.jsx)("h3",{className:"text-xl font-semibold",children:"Preview Unavailable"}),(0,t.jsx)("p",{className:"text-gray-300 text-center",children:"This document cannot be previewed in your browser."}),(0,t.jsxs)(d.Button,{onClick:g,variant:"secondary",className:"gap-2 mt-4",children:[(0,t.jsx)(l.Download,{className:"h-4 w-4"}),"Download to View"]})]})]}),j&&!h&&!x&&!b&&(0,t.jsx)("iframe",{src:j,className:"w-full h-full border-0",title:"Document Preview",onError:()=>{console.error("iframe failed to load preview"),f(!0)}})]}),!h&&!x&&(0,t.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 text-white/60 text-sm bg-black/50 px-4 py-2 rounded-full",children:["Press ",(0,t.jsx)("kbd",{className:"px-2 py-1 bg-white/10 rounded mx-1",children:"ESC"})," to close or ",(0,t.jsx)("kbd",{className:"px-2 py-1 bg-white/10 rounded mx-1",children:"Ctrl+D"})," to download"]})]}),y=window.document.body;return y?(0,s.createPortal)(N,y):null}e.s(["DocumentViewerFullscreen",()=>m])},722318,676967,e=>{"use strict";class t extends Error{statusCode;originalError;constructor(e,t,r){super(e),this.statusCode=t,this.originalError=r,this.name="DocumentError"}}e.s(["DocumentError",()=>t],676967);class r{static isValidStorageUrl(e){return!!e&&!!e.startsWith("https://")&&(e.includes("supabase.co/storage")||e.includes("supabase.com/storage")||e.startsWith("blob:"))}static async parseResponse(e){let r;try{r=await e.json()}catch(r){throw new t("Invalid response from server",e.status,r)}if(!e.ok)throw new t(r.error||r.message||"Failed to load document",e.status,r);let s=r.url||r.download_url;if(!s)throw new t("No download URL in response",500,r);if(!this.isValidStorageUrl(s))throw new t("Invalid download URL format",500,r);return r.url=s,r.download_url=s,r}static async getPreviewUrl(e){try{let t=await fetch(`/api/documents/${e}/download?mode=preview`,{method:"GET",headers:{"Content-Type":"application/json"}});return await this.parseResponse(t)}catch(e){if(e instanceof t)throw e;throw new t("Network error while loading preview",0,e)}}static async getDownloadUrl(e){try{let t=await fetch(`/api/documents/${e}/download?mode=download`,{method:"GET",headers:{"Content-Type":"application/json"}});return await this.parseResponse(t)}catch(e){if(e instanceof t)throw e;throw new t("Network error while loading download",0,e)}}static async getDealDocumentPreviewUrl(e,r){try{let t=await fetch(`/api/deals/${e}/documents/${r}/download?mode=preview`,{method:"GET",headers:{"Content-Type":"application/json"}});return await this.parseResponse(t)}catch(e){if(e instanceof t)throw e;throw new t("Network error while loading deal document preview",0,e)}}static async getDealDocumentDownloadUrl(e,r){try{let t=await fetch(`/api/deals/${e}/documents/${r}/download?mode=download`,{method:"GET",headers:{"Content-Type":"application/json"}});return await this.parseResponse(t)}catch(e){if(e instanceof t)throw e;throw new t("Network error while loading deal document download",0,e)}}static getErrorMessage(e){switch(e.statusCode){case 401:return"You do not have permission to view this document.";case 403:return"Access to this document is forbidden.";case 404:return"Document not found or has been deleted.";case 413:return"File is too large to process.";case 500:return"Server error while loading document. Please try again.";case 0:return"Network error. Please check your connection and try again.";default:return e.message||"Failed to load document preview."}}}e.s(["DocumentService",()=>r],722318)},49664,e=>{"use strict";let t=(0,e.i(410587).default)("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);e.s(["FolderOpen",()=>t],49664)},959768,e=>{"use strict";let t=(0,e.i(410587).default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);e.s(["Folder",()=>t],959768)},595870,e=>{"use strict";let t=(0,e.i(410587).default)("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);e.s(["FileSpreadsheet",()=>t],595870)},413934,e=>{"use strict";let t=(0,e.i(410587).default)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);e.s(["Home",()=>t],413934)},337028,e=>{"use strict";var t=e.i(722679),r=e.i(129432),s=e.i(761722),a=e.i(981218),l=e.i(645855),o=e.i(971743),i=e.i(959768),n=e.i(496383),d=e.i(119311),c=e.i(595870),m=e.i(758768),u=e.i(201495),h=e.i(572826),x=e.i(553426),p=e.i(711819);let g=(0,e.i(410587).default)("clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);var b=e.i(35334),f=e.i(64927),w=e.i(551544),v=e.i(554369),j=e.i(340915),N=e.i(994500),y=e.i(282141),k=e.i(510166);function C({document:e,onPreview:C,onRename:D,onDelete:S,variant:_="default",className:T}){var E,F;let[M,A]=(0,j.useState)(!1),[P,B]=(0,j.useState)(!1),L=async()=>{A(!0);try{let t=await fetch(`/api/documents/${e.id}/download`);if(!t.ok)return void(404===t.status?N.toast.error("Document not found or access denied"):401===t.status?N.toast.error("Please sign in to download documents"):N.toast.error("Failed to generate download link"));let{download_url:r,watermark:s,expires_in_seconds:a}=await t.json();s&&N.toast.info(`Document will be watermarked with: ${s.downloaded_by}`,{duration:5e3}),window.open(r,"_blank"),N.toast.success(`Download link generated. Expires in ${Math.floor(a/60)} minutes`,{duration:5e3})}catch(e){N.toast.error("Failed to download document. Please try again.")}finally{A(!1)}},R=e.file_name||e.name||"Untitled Document",U=(E=e.file_size_bytes)?E<1024?E+" B":E<1048576?(E/1024).toFixed(1)+" KB":(E/1048576).toFixed(1)+" MB":"Unknown size",I=(e.type||"Document").toString().replace(/_/g," ").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "),O=e.scope?.vehicle,V=new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),z=(F=e.type,({statement:c.FileSpreadsheet,report:m.FileCheck,legal:u.Scale,tax:h.Receipt,nda:x.Lock,subscription:p.FileSignature,agreement:p.FileSignature,term_sheet:g,kyc:b.UserCheck,other:d.FileText})[F.toLowerCase()]||d.FileText);return"compact"===_?(0,t.jsxs)("button",{onClick:()=>C?.(e),className:(0,y.cn)("group flex items-center gap-3 w-full px-4 py-3 rounded-md","hover:bg-muted transition-colors duration-150","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-1",T),children:[(0,t.jsx)(z,{className:"w-5 h-5 text-primary flex-shrink-0",strokeWidth:2}),(0,t.jsx)("span",{className:"text-sm font-medium text-foreground flex-1 text-left break-words line-clamp-1",children:R}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:U})]}):(0,t.jsxs)("div",{className:(0,y.cn)("group relative bg-card border border-border rounded-lg shadow-sm","hover:bg-muted/50 hover:border-border hover:shadow-md","transition-all duration-200","cursor-pointer",T),onClick:()=>C?.(e),children:[(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:(0,y.cn)("w-14 h-14 rounded-lg border border-border flex items-center justify-center","flex-shrink-0 transition-all duration-200","bg-muted/50"),children:(0,t.jsx)(z,{className:"w-6 h-6 text-primary",strokeWidth:2})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 overflow-hidden",children:[(0,t.jsx)("h3",{className:"font-semibold text-foreground text-sm leading-tight mb-2 break-words line-clamp-2",children:R}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-2",children:[(0,t.jsx)("span",{children:I}),(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{children:U}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(l.Clock,{className:"w-3.5 h-3.5",strokeWidth:2}),V]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[O&&(0,t.jsxs)(r.Badge,{variant:"outline",className:"text-xs border-blue-200 bg-blue-50 text-blue-700",children:[(0,t.jsx)(o.Building2,{className:"w-3.5 h-3.5 mr-1",strokeWidth:2}),O.name]}),e.folder&&(0,t.jsxs)(r.Badge,{variant:"outline",className:"text-xs border-purple-200 bg-purple-50 text-purple-700",children:[(0,t.jsx)(i.Folder,{className:"w-3.5 h-3.5 mr-1",strokeWidth:2}),e.folder.path]}),e.watermark&&(0,t.jsxs)(r.Badge,{variant:"outline",className:"text-xs border-emerald-200 bg-emerald-50 text-emerald-700",children:[(0,t.jsx)(a.Shield,{className:"w-3.5 h-3.5 mr-1",strokeWidth:2}),"Watermarked"]})]})]}),(0,t.jsxs)(k.DropdownMenu,{open:P,onOpenChange:B,children:[(0,t.jsxs)(k.DropdownMenuTrigger,{className:(0,y.cn)("opacity-0 group-hover:opacity-100 transition-opacity duration-150","p-1 rounded hover:bg-muted","focus:outline-none focus:ring-2 focus:ring-primary",P&&"opacity-100"),onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(f.MoreVertical,{className:"w-4 h-4 text-muted-foreground",strokeWidth:2}),(0,t.jsx)("span",{className:"sr-only",children:"Document actions"})]}),(0,t.jsxs)(k.DropdownMenuContent,{align:"end",className:"w-48",children:[C&&(0,t.jsxs)(k.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),C(e)},children:[(0,t.jsx)(n.Eye,{className:"w-4 h-4 mr-2 text-primary",strokeWidth:2}),(0,t.jsx)("span",{children:"Preview"})]}),(0,t.jsx)(k.DropdownMenuItem,{onClick:e=>{e.stopPropagation(),L()},disabled:M,children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Clock,{className:"w-4 h-4 mr-2 animate-spin text-muted-foreground",strokeWidth:2}),(0,t.jsx)("span",{children:"Generating..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Download,{className:"w-4 h-4 mr-2 text-muted-foreground",strokeWidth:2}),(0,t.jsx)("span",{children:"Download"})]})}),D&&(0,t.jsxs)(k.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),D(e.id)},children:[(0,t.jsx)(w.Edit,{className:"w-4 h-4 mr-2 text-muted-foreground",strokeWidth:2}),(0,t.jsx)("span",{children:"Rename"})]}),S&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.DropdownMenuSeparator,{}),(0,t.jsxs)(k.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),S(e.id)},className:"text-destructive focus:text-destructive",children:[(0,t.jsx)(v.Trash2,{className:"w-4 h-4 mr-2",strokeWidth:2}),(0,t.jsx)("span",{children:"Delete"})]})]})]})]})]})}),(0,t.jsx)("div",{className:(0,y.cn)("absolute bottom-0 left-0 right-0 h-0.5 bg-primary","transform scale-x-0 group-hover:scale-x-100","transition-transform duration-200 origin-left","rounded-b-lg")})]})}e.s(["DocumentCard",()=>C],337028)},970383,e=>{"use strict";let t=(0,e.i(410587).default)("file-chart-column-increasing",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]]);e.s(["FileBarChart",()=>t],970383)},272465,e=>{"use strict";var t,r=e.i(722679),s=e.i(340915),a=e.i(337684),l=e.i(337028),o=((t={}).NDA="NDA",t.SUBSCRIPTION="Subscription",t.AGREEMENT="Agreement",t.REPORT="Report",t.STATEMENT="Statement",t.KYC="KYC",t.TAX="Tax",t.TERM_SHEET="Term Sheet",t.LEGAL="Legal",t.OTHER="Other",t),i=e.i(90613),n=e.i(191569),d=e.i(316264),c=e.i(129432),m=e.i(750809),u=e.i(382021),h=e.i(432598),x=e.i(235717),p=e.i(970383),g=e.i(572826),b=e.i(201495),f=e.i(553426),w=e.i(818798),v=e.i(758768),j=e.i(429747),N=e.i(35334),y=e.i(959768),k=e.i(538892);function C({vehicles:e,deals:t,typeCounts:a,appliedFilters:l,onChange:C}){let D="__all_vehicles__",S="__all_deals__",[_,T]=(0,s.useState)(l.search||""),[E,F]=(0,s.useState)(l.type||""),[M,A]=(0,s.useState)(l.vehicle_id??D),[P,B]=(0,s.useState)(l.deal_id??S),L=()=>{C({search:_||void 0,type:E||void 0,vehicle_id:M===D?void 0:M,deal_id:P===S?void 0:P})},R=!!(_&&_.trim()||E||M!==D||P!==S),U=[{value:o.STATEMENT,label:"Statements",icon:x.BarChart3},{value:o.REPORT,label:"Reports",icon:p.FileBarChart},{value:o.TAX,label:"Tax",icon:g.Receipt},{value:o.LEGAL,label:"Legal",icon:b.Scale},{value:o.NDA,label:"NDAs",icon:f.Lock},{value:o.SUBSCRIPTION,label:"Subscriptions",icon:w.PenTool},{value:o.AGREEMENT,label:"Agreements",icon:v.FileCheck},{value:o.TERM_SHEET,label:"Term Sheets",icon:j.ClipboardList},{value:o.KYC,label:"KYC",icon:N.UserCheck},{value:o.OTHER,label:"Other",icon:y.Folder}];return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:U.map(e=>{let t=a[e.value]||0,s=E===e.value;return(0,r.jsxs)(c.Badge,{variant:s?"default":"outline",className:`
                cursor-pointer px-4 py-2 text-sm font-medium transition-all duration-200
                ${s?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md":"border-2 hover:border-blue-300 hover:bg-blue-50"}
              `,onClick:()=>{F(s?"":e.value),C({...l,type:s?void 0:e.value})},children:[(0,r.jsx)(e.icon,{className:"h-4 w-4 mr-1.5"}),e.label,t>0&&(0,r.jsxs)("span",{className:"ml-2 text-xs opacity-75",children:["(",t,")"]})]},e.value)})}),(0,r.jsx)(i.Card,{children:(0,r.jsxs)(i.CardContent,{className:"p-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(m.Search,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,r.jsx)(n.Input,{placeholder:"Search documents...",value:_,onChange:e=>T(e.target.value),onKeyDown:e=>{"Enter"===e.key&&L()},className:"pl-10"})]})}),e.length>0&&(0,r.jsx)("div",{children:(0,r.jsxs)(k.Select,{value:M,onValueChange:A,children:[(0,r.jsx)(k.SelectTrigger,{children:(0,r.jsx)(k.SelectValue,{placeholder:"All vehicles"})}),(0,r.jsxs)(k.SelectContent,{children:[(0,r.jsx)(k.SelectItem,{value:D,children:"All vehicles"}),e.map(e=>(0,r.jsx)(k.SelectItem,{value:e.id,children:e.name},e.id))]})]})}),t.length>0&&(0,r.jsx)("div",{children:(0,r.jsxs)(k.Select,{value:P,onValueChange:B,children:[(0,r.jsx)(k.SelectTrigger,{children:(0,r.jsx)(k.SelectValue,{placeholder:"All deals"})}),(0,r.jsxs)(k.SelectContent,{children:[(0,r.jsx)(k.SelectItem,{value:S,children:"All deals"}),t.map(e=>(0,r.jsx)(k.SelectItem,{value:e.id,children:e.name},e.id))]})]})}),(0,r.jsxs)("div",{className:"flex gap-2 lg:col-span-4 md:col-span-2",children:[(0,r.jsxs)(d.Button,{onClick:L,className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:[(0,r.jsx)(u.Filter,{className:"h-4 w-4 mr-2"}),"Apply Filters"]}),R&&(0,r.jsxs)(d.Button,{variant:"outline",onClick:()=>{T(""),F(""),A(D),B(S),C({})},className:"border-2 hover:bg-red-50 hover:border-red-300",children:[(0,r.jsx)(h.X,{className:"h-4 w-4 mr-2"}),"Clear"]})]})]}),R&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600 font-medium",children:"Active filters:"}),E&&(0,r.jsxs)(c.Badge,{variant:"secondary",className:"gap-1",children:["Type: ",E,(0,r.jsx)(h.X,{className:"h-3 w-3 cursor-pointer hover:text-red-600",onClick:()=>{F(""),L()}})]}),M!==D&&(0,r.jsxs)(c.Badge,{variant:"secondary",className:"gap-1",children:["Vehicle: ",e.find(e=>e.id===M)?.name||"Unknown",(0,r.jsx)(h.X,{className:"h-3 w-3 cursor-pointer hover:text-red-600",onClick:()=>{A(D),L()}})]}),P!==S&&(0,r.jsxs)(c.Badge,{variant:"secondary",className:"gap-1",children:["Deal: ",t.find(e=>e.id===P)?.name||"Unknown",(0,r.jsx)(h.X,{className:"h-3 w-3 cursor-pointer hover:text-red-600",onClick:()=>{B(S),L()}})]}),_&&(0,r.jsxs)(c.Badge,{variant:"secondary",className:"gap-1",children:["Search: ",_,(0,r.jsx)(h.X,{className:"h-3 w-3 cursor-pointer hover:text-red-600",onClick:()=>{T(""),L()}})]})]})]})})]})}var D=e.i(663216),S=e.i(619962),_=e.i(396132),T=e.i(971743),E=e.i(230112),F=e.i(197098),M=e.i(119311),A=e.i(49664),P=e.i(413934),B=e.i(981218),L=e.i(691974);let R={agreements:{id:"agreements",name:"Agreements",icon:v.FileCheck,color:"blue",description:"Subscription agreements, LPAs, side letters",types:["Subscription","Agreement","subscription","agreement","subscription_pack","subscription_draft"]},statements:{id:"statements",name:"Statements",icon:x.BarChart3,color:"purple",description:"Position statements, capital calls, distributions",types:["Statement","statement","capital_call"]},ndas:{id:"ndas",name:"NDAs",icon:f.Lock,color:"amber",description:"Non-disclosure agreements",types:["NDA","nda"]},reports:{id:"reports",name:"Reports & Tax",icon:M.FileText,color:"indigo",description:"Performance reports, tax packs, investor letters",types:["Report","report","Tax","tax","memo"]}};function U(e){let t={blue:"bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-700",purple:"bg-purple-100 dark:bg-purple-900/40 text-purple-700 dark:text-purple-300 border-purple-200 dark:border-purple-700",amber:"bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300 border-amber-200 dark:border-amber-700",indigo:"bg-indigo-100 dark:bg-indigo-900/40 text-indigo-700 dark:text-indigo-300 border-indigo-200 dark:border-indigo-700"};return t[e]||t.blue}function I(e){let t={blue:"text-blue-600 dark:text-blue-400",purple:"text-purple-600 dark:text-purple-400",amber:"text-amber-600 dark:text-amber-400",indigo:"text-indigo-600 dark:text-indigo-400"};return t[e]||t.blue}function O({initialDocuments:e,vehicles:t}){let[o,n]=(0,s.useState)(null),[m,u]=(0,s.useState)(new Set),[h,x]=(0,s.useState)({}),p=(0,D.useDocumentViewer)(),g=(0,s.useMemo)(()=>{let t=e.filter(e=>"kyc"!==e.type.toLowerCase()&&(!e.scope.deal||"nda"===e.type||"subscription_pack"===e.type||"subscription"===e.type));if(h.vehicle_id&&(t=t.filter(e=>e.scope.vehicle?.id===h.vehicle_id)),h.type&&(t=t.filter(e=>e.type.toLowerCase()===h.type?.toLowerCase())),h.search){let e=h.search.toLowerCase();t=t.filter(t=>t.file_name?.toLowerCase().includes(e)||t.name?.toLowerCase().includes(e))}return t},[e,h]),b=(0,s.useMemo)(()=>{let e={};return g.forEach(t=>{e[t.type]=(e[t.type]||0)+1}),e},[g]),f=(0,s.useMemo)(()=>{let e=new Map;return g.forEach(t=>{let r=t.scope.vehicle,s=r?.id??"general",a=r?.investment_name||r?.name||"General Documents",l=r?.type??null;e.has(s)||e.set(s,{id:s,name:a,type:l,vehicle:r,categories:{agreements:[],statements:[],ndas:[],reports:[]},totalDocuments:0});let o=e.get(s),i=function(e){for(let[t,r]of Object.entries(R))if(r.types.includes(e))return t;return"reports"}(t.type)??"reports";o.categories[i].push(t),o.totalDocuments++}),Array.from(e.values()).sort((e,t)=>"general"===e.id?1:"general"===t.id?-1:e.name.localeCompare(t.name))},[g]),w=g.length;if(!o)return(0,r.jsxs)("div",{className:"p-6 space-y-8",children:[(0,r.jsxs)("div",{className:"relative border-b border-border pb-8 mb-2",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900/50 dark:via-blue-900/30 dark:to-indigo-900/30 opacity-60 rounded-t-2xl"}),(0,r.jsxs)("div",{className:"relative flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg",children:(0,r.jsx)(L.Briefcase,{className:"h-6 w-6 text-white"})}),(0,r.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent",children:"Investment Documents"})]}),(0,r.jsx)("p",{className:"text-lg text-muted-foreground ml-15",children:"Access documents organized by your investments"})]}),(0,r.jsxs)("div",{className:"text-right bg-background/80 backdrop-blur-sm rounded-xl px-6 py-4 shadow-sm border border-border",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Total Documents"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-foreground mt-1",children:w})]})]})]}),(0,r.jsx)(C,{vehicles:t,deals:[],typeCounts:b,appliedFilters:h,onChange:x}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-6",children:"Your Investments"}),0===f.length?(0,r.jsx)(i.Card,{className:"border-2 border-border",children:(0,r.jsxs)(i.CardContent,{className:"p-12 text-center",children:[(0,r.jsx)(y.Folder,{className:"h-16 w-16 text-muted-foreground mx-auto mb-6"}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-foreground mb-3",children:"No documents available"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Documents will appear here once they are uploaded by the VERSO team."})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:f.map(e=>(0,r.jsx)(i.Card,{className:"border-2 border-border hover:border-blue-400 dark:hover:border-blue-600 hover:shadow-xl transition-all duration-300 cursor-pointer group bg-card overflow-hidden",onClick:()=>n(e.id),children:(0,r.jsxs)(i.CardContent,{className:"p-0",children:[(0,r.jsx)("div",{className:"p-6 bg-gradient-to-r from-slate-50 to-blue-50 dark:from-slate-900/50 dark:to-blue-900/30 border-b border-border",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform overflow-hidden",children:e.vehicle?.logo_url?(0,r.jsx)(a.default,{src:e.vehicle.logo_url,alt:e.name,width:56,height:56,className:"object-cover w-full h-full"}):(0,r.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center",children:(0,r.jsx)(T.Building2,{className:"h-7 w-7 text-white"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-foreground group-hover:text-blue-700 dark:group-hover:text-blue-400 transition-colors",children:e.name}),e.type&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground uppercase tracking-wide mt-0.5",children:e.type})]})]}),(0,r.jsx)(F.ChevronRight,{className:"h-6 w-6 text-muted-foreground group-hover:text-blue-600 dark:group-hover:text-blue-400 group-hover:translate-x-1 transition-all"})]})}),(0,r.jsxs)("div",{className:"p-6 space-y-3",children:[(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(R).map(([t,s])=>{let a=e.categories[t];if(0===a.length)return null;let l=s.icon;return(0,r.jsxs)("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border ${U(s.color)}`,children:[(0,r.jsx)(l,{className:`h-4 w-4 ${I(s.color)}`}),(0,r.jsx)("span",{className:"text-sm font-medium",children:s.name}),(0,r.jsx)(c.Badge,{variant:"secondary",className:"ml-auto text-xs",children:a.length})]},t)})}),(0,r.jsxs)("div",{className:"pt-3 border-t border-border flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total documents"}),(0,r.jsx)(c.Badge,{variant:"outline",className:"font-semibold border-2",children:e.totalDocuments})]})]})]})},e.id))})]}),(0,r.jsx)(i.Card,{className:"border-blue-200 dark:border-blue-800 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/50 dark:to-indigo-950/50 border-2",children:(0,r.jsx)(i.CardContent,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/50 rounded-xl",children:(0,r.jsx)(B.Shield,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold text-blue-900 dark:text-blue-100 text-lg mb-1",children:"Document Security & Compliance"}),(0,r.jsx)("div",{className:"text-blue-700 dark:text-blue-300 leading-relaxed",children:"All documents are watermarked with your name and download timestamp. Access is logged for compliance and security purposes as required by BVI FSC and GDPR regulations. Download links expire after 15 minutes for security."})]})]})})})]});let v=f.find(e=>e.id===o);return v?(0,r.jsxs)("div",{className:"p-6 space-y-8",children:[(0,r.jsxs)("div",{className:"relative border-b border-border pb-8 mb-2",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900/50 dark:via-blue-900/30 dark:to-indigo-900/30 opacity-60 rounded-t-2xl"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsxs)(d.Button,{variant:"ghost",size:"sm",onClick:()=>n(null),className:"text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(P.Home,{className:"h-4 w-4 mr-2"}),"Investments"]}),(0,r.jsx)(F.ChevronRight,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:v.name})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(d.Button,{variant:"outline",size:"lg",onClick:()=>n(null),className:"border-2",children:[(0,r.jsx)(_.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center shadow-lg overflow-hidden",children:v.vehicle?.logo_url?(0,r.jsx)(a.default,{src:v.vehicle.logo_url,alt:v.name,width:56,height:56,className:"object-cover w-full h-full"}):(0,r.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center",children:(0,r.jsx)(T.Building2,{className:"h-7 w-7 text-white"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:v.name}),v.type&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground uppercase tracking-wide mt-0.5",children:v.type})]})]})]}),(0,r.jsxs)(c.Badge,{variant:"outline",className:"text-lg px-4 py-2 bg-background/80 backdrop-blur-sm border-2",children:[v.totalDocuments," document",1!==v.totalDocuments?"s":""]})]})]})]}),(0,r.jsx)("div",{className:"space-y-4",children:Object.entries(R).map(([e,t])=>{let s=v.categories[e];if(0===s.length)return null;let a=t.icon,o=m.has(e);return(0,r.jsxs)("div",{className:"border-2 border-border rounded-xl bg-card overflow-hidden shadow-sm",children:[(0,r.jsxs)("button",{onClick:()=>{let t;(t=new Set(m)).has(e)?t.delete(e):t.add(e),u(t)},className:"w-full px-6 py-4 flex items-center justify-between hover:bg-muted/50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[o?(0,r.jsx)(E.ChevronDown,{className:"h-5 w-5 text-muted-foreground"}):(0,r.jsx)(F.ChevronRight,{className:"h-5 w-5 text-muted-foreground"}),(0,r.jsx)("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${U(t.color)} border`,children:o?(0,r.jsx)(A.FolderOpen,{className:`h-5 w-5 ${I(t.color)}`}):(0,r.jsx)(a,{className:`h-5 w-5 ${I(t.color)}`})}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:t.name}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:t.description})]})]}),(0,r.jsxs)(c.Badge,{variant:"outline",className:"text-sm font-semibold border-2",children:[s.length," document",1!==s.length?"s":""]})]}),o&&(0,r.jsx)("div",{className:"border-t border-border bg-muted/30",children:(0,r.jsx)("div",{className:"p-4 space-y-3",children:s.map(e=>(0,r.jsx)(l.DocumentCard,{document:e,onPreview:p.openPreview},e.id))})})]},e)})}),(0,r.jsx)(i.Card,{className:"border-blue-200 dark:border-blue-800 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/50 dark:to-indigo-950/50 border-2",children:(0,r.jsx)(i.CardContent,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/50 rounded-xl",children:(0,r.jsx)(B.Shield,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold text-blue-900 dark:text-blue-100 text-lg mb-1",children:"Document Security"}),(0,r.jsx)("div",{className:"text-blue-700 dark:text-blue-300 leading-relaxed",children:"All documents are watermarked and tracked. Download links expire after 15 minutes."})]})]})})}),(0,r.jsx)(S.DocumentViewerFullscreen,{isOpen:p.isOpen,document:p.document,previewUrl:p.previewUrl,isLoading:p.isLoading,error:p.error,onClose:p.closePreview,onDownload:p.downloadDocument})]}):null}e.s(["CategorizedDocumentsClient",()=>O],272465)}]);