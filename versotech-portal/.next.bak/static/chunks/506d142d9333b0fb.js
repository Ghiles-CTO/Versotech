(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,881238,e=>{"use strict";var t=e.i(722679),s=e.i(340915),a=e.i(59178),r=e.i(90613),n=e.i(316264),i=e.i(129432),l=e.i(937368),o=e.i(661521),c=e.i(723884),d=e.i(230112),m=e.i(249389);let u=["#1e3a5f","#0d9488","#6366f1","#d97706","#dc2626","#059669","#8b5cf6","#0891b2"],x=(e,t="$")=>e>=1e6?`${t}${(e/1e6).toFixed(2)}M`:e>=1e3?`${t}${(e/1e3).toFixed(0)}K`:`${t}${e.toFixed(0)}`;function h({data:e,maxVisibleItems:a=6,currency:i="USD"}){let[l,o]=(0,s.useState)(!1),[h,p]=(0,s.useState)(null),f=!e||0===e.length,g=(0,s.useMemo)(()=>e?.reduce((e,t)=>e+t.value,0)||0,[e]),{displayData:b,hiddenCount:j}=(0,s.useMemo)(()=>{if(!e||0===e.length)return{displayData:[],hiddenCount:0};let t=[...e].filter(e=>e.value>0).sort((e,t)=>t.value-e.value);return l||t.length<=a?{displayData:t,hiddenCount:0}:{displayData:t.slice(0,a),hiddenCount:t.length-a}},[e,a,l]),v=(0,s.useMemo)(()=>{let e=0;return b.map((t,s)=>{let a=g>0?t.value/g*100:0,r=3.6*e;return e+=a,{...t,percentage:a,startAngle:r,endAngle:3.6*e,color:u[s%u.length]}})},[b,g]);if(f)return(0,t.jsxs)(r.Card,{className:"border shadow-sm",children:[(0,t.jsx)(r.CardHeader,{className:"pb-3",children:(0,t.jsxs)(r.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(c.PieChart,{className:"h-4 w-4 text-muted-foreground"}),"Portfolio Allocation"]})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-[200px] text-muted-foreground",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(c.PieChart,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),(0,t.jsx)("p",{className:"text-sm",children:"No allocation data"})]})})})]});let N=2*Math.PI*74;return(0,t.jsxs)(r.Card,{className:"border shadow-sm",children:[(0,t.jsx)(r.CardHeader,{className:"pb-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(r.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(c.PieChart,{className:"h-4 w-4 text-muted-foreground"}),"Portfolio Allocation"]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-lg font-bold",children:x(g)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.filter(e=>e.value>0).length," positions"]})]})]})}),(0,t.jsx)(r.CardContent,{className:"pt-0",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-6",children:[(0,t.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,t.jsxs)("svg",{width:180,height:180,className:"transform -rotate-90",children:[(0,t.jsx)("circle",{cx:90,cy:90,r:74,fill:"none",stroke:"hsl(var(--muted))",strokeWidth:32}),v.map((e,s)=>{let a=e.percentage/100*N,r=v.slice(0,s).reduce((e,t)=>e+t.percentage,0)/100*N,n=h===s;return(0,t.jsx)("circle",{cx:90,cy:90,r:74,fill:"none",stroke:e.color,strokeWidth:n?36:32,strokeDasharray:`${a} ${N-a}`,strokeDashoffset:-r,className:"transition-all duration-200 cursor-pointer",style:{filter:n?"brightness(1.1)":"none"},onMouseEnter:()=>p(s),onMouseLeave:()=>p(null)},`${e.name}-${s}`)})]}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-center",children:null!==h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"text-lg font-bold",children:[v[h]?.percentage.toFixed(1),"%"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate max-w-[80px]",children:v[h]?.name.split(" ").pop()})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-lg font-bold",children:b.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Holdings"})]})})})]}),(0,t.jsxs)("div",{className:"flex-1 w-full space-y-2",children:[v.map((e,s)=>(0,t.jsxs)("div",{className:`flex items-center justify-between py-1.5 px-2 rounded-md transition-colors cursor-pointer ${h===s?"bg-muted/50":"hover:bg-muted/30"}`,onMouseEnter:()=>p(s),onMouseLeave:()=>p(null),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-sm flex-shrink-0",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"text-sm truncate",title:e.name,children:e.name.length>25?e.name.substring(0,25)+"...":e.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0 ml-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:x(e.value)}),(0,t.jsxs)("span",{className:"text-xs px-1.5 py-0.5 rounded font-medium min-w-[45px] text-center",style:{backgroundColor:`${e.color}15`,color:e.color},children:[e.percentage.toFixed(1),"%"]})]})]},`legend-${e.name}-${s}`)),(j>0||l&&e.filter(e=>e.value>0).length>a)&&(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",className:"w-full h-8 text-xs text-muted-foreground hover:text-foreground mt-2",onClick:()=>o(!l),children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.ChevronUp,{className:"h-3 w-3 mr-1.5"}),"Show Less"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.ChevronDown,{className:"h-3 w-3 mr-1.5"}),"Show ",j," More"]})})]})]})})]})}var p=e.i(255468),f=e.i(980841),g=e.i(47065),b=e.i(707714),j=e.i(869221),v=e.i(847645),N=e.i(627544),w=e.i(733179),y=e.i(560044);let C={grid:"#e5e7eb",axis:"#6b7280",axisLine:"#e5e7eb",tooltip:{bg:"#ffffff",border:"#e5e7eb",text:"#111827",label:"#6b7280"},primary:"#3b82f6",secondary:"#8b5cf6",success:"#10b981",warning:"#f59e0b",danger:"#ef4444",info:"#0ea5e9",gradientStart:"#3b82f6",gradientEnd:"rgba(59, 130, 246, 0.1)",area:{fill:"rgba(59, 130, 246, 0.1)",stroke:"#3b82f6"},bar:{fill:"#3b82f6",hover:"#2563eb"},line:{stroke:"#3b82f6",dot:"#ffffff",activeDot:"#3b82f6"},pie:{stroke:"#ffffff"}},S={grid:"#27272a",axis:"#a1a1aa",axisLine:"#3f3f46",tooltip:{bg:"#18181b",border:"#3f3f46",text:"#fafafa",label:"#a1a1aa"},primary:"#60a5fa",secondary:"#a78bfa",success:"#34d399",warning:"#fbbf24",danger:"#f87171",info:"#38bdf8",gradientStart:"#60a5fa",gradientEnd:"rgba(96, 165, 250, 0.1)",area:{fill:"rgba(96, 165, 250, 0.15)",stroke:"#60a5fa"},bar:{fill:"#60a5fa",hover:"#3b82f6"},line:{stroke:"#60a5fa",dot:"#18181b",activeDot:"#60a5fa"},pie:{stroke:"#18181b"}},D=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0,notation:e>=1e6?"compact":"standard",compactDisplay:"short"}).format(e);function k({data:e}){let a=function(){let{theme:e}=(0,y.useTheme)();return(0,s.useMemo)(()=>"staff-dark"===e?S:C,[e])}();return e&&0!==e.length?(0,t.jsxs)(r.Card,{className:"border-0 shadow-md bg-gradient-to-br from-muted/50 to-background",children:[(0,t.jsxs)(r.CardHeader,{className:"pb-4",children:[(0,t.jsxs)(r.CardTitle,{className:"text-base font-semibold flex items-center gap-2 text-foreground",children:[(0,t.jsx)(w.TrendingUp,{className:"h-5 w-5 text-emerald-600"}),"NAV Performance"]}),(0,t.jsx)(r.CardDescription,{className:"text-muted-foreground",children:"Portfolio value over time"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)(N.ResponsiveContainer,{width:"100%",height:320,children:(0,t.jsxs)(p.LineChart,{data:e,margin:{top:5,right:20,left:10,bottom:5},children:[(0,t.jsx)(j.CartesianGrid,{strokeDasharray:"3 3",stroke:a.grid,vertical:!1}),(0,t.jsx)(g.XAxis,{dataKey:"displayDate",tick:{fontSize:12,fill:a.axis},tickLine:!1,axisLine:{stroke:a.axisLine}}),(0,t.jsx)(b.YAxis,{tick:{fontSize:12,fill:a.axis},tickLine:!1,axisLine:{stroke:a.axisLine},tickFormatter:D}),(0,t.jsx)(v.Tooltip,{content:({active:e,payload:s})=>{if(e&&s&&s.length){let e=s[0].payload;return(0,t.jsxs)("div",{className:"bg-background p-4 border border-border rounded-lg shadow-lg",children:[(0,t.jsx)("p",{className:"font-semibold text-foreground mb-2",children:e.displayDate}),(0,t.jsxs)("p",{className:"text-sm text-emerald-600 dark:text-emerald-400 font-medium",children:["NAV: ",D(e.value)]})]})}return null}}),(0,t.jsx)(f.Line,{type:"monotone",dataKey:"value",stroke:a.success,strokeWidth:3,dot:{fill:a.success,r:4,strokeWidth:2,stroke:a.line.dot},activeDot:{r:6,strokeWidth:2,stroke:a.line.dot}})]})})})]}):(0,t.jsxs)(r.Card,{className:"border-0 shadow-md bg-gradient-to-br from-muted/50 to-background",children:[(0,t.jsxs)(r.CardHeader,{className:"pb-4",children:[(0,t.jsxs)(r.CardTitle,{className:"text-base font-semibold flex items-center gap-2 text-foreground",children:[(0,t.jsx)(w.TrendingUp,{className:"h-5 w-5 text-emerald-600"}),"NAV Performance"]}),(0,t.jsx)(r.CardDescription,{className:"text-muted-foreground",children:"Portfolio value over time"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-[320px] text-muted-foreground/50",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(w.TrendingUp,{className:"h-16 w-16 mx-auto mb-3 opacity-20"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:"No performance data available"})]})})})]})}var _=e.i(935791),P=e.i(646773),F=e.i(957602),R=e.i(196767);let T=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0,notation:Math.abs(e)>=1e6?"compact":"standard",compactDisplay:"short"}).format(e);function A({data:e}){return e&&0!==e.length?(0,t.jsxs)(r.Card,{className:"border-0 shadow-md bg-gradient-to-br from-background to-muted/30 dark:from-gray-800 dark:to-gray-900",children:[(0,t.jsxs)(r.CardHeader,{className:"pb-4",children:[(0,t.jsxs)(r.CardTitle,{className:"text-base font-semibold flex items-center gap-2 text-foreground",children:[(0,t.jsx)(R.DollarSign,{className:"h-5 w-5 text-violet-600"}),"Cash Flow History"]}),(0,t.jsx)(r.CardDescription,{className:"text-muted-foreground",children:"Contributions vs distributions over time"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)(N.ResponsiveContainer,{width:"100%",height:320,children:(0,t.jsxs)(_.BarChart,{data:e,margin:{top:5,right:20,left:10,bottom:5},children:[(0,t.jsx)(j.CartesianGrid,{strokeDasharray:"3 3",className:"stroke-border",vertical:!1}),(0,t.jsx)(g.XAxis,{dataKey:"displayPeriod",tick:{fontSize:12},tickLine:!1,axisLine:!1,className:"fill-muted-foreground"}),(0,t.jsx)(b.YAxis,{tick:{fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:T,className:"fill-muted-foreground"}),(0,t.jsx)(v.Tooltip,{content:({active:e,payload:s})=>{if(e&&s&&s.length){let e=s[0].payload;return(0,t.jsxs)("div",{className:"bg-card p-4 border border-border rounded-lg shadow-lg",children:[(0,t.jsx)("p",{className:"font-semibold text-foreground mb-3",children:e.displayPeriod}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Contributions"})]}),(0,t.jsx)("span",{className:"text-sm font-medium text-red-600",children:T(e.contributions)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-emerald-500 rounded"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Distributions"})]}),(0,t.jsx)("span",{className:"text-sm font-medium text-emerald-600",children:T(e.distributions)})]}),(0,t.jsxs)("div",{className:"pt-2 border-t border-border flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Net Cash"}),(0,t.jsx)("span",{className:`text-sm font-semibold ${e.distributions-e.contributions>=0?"text-emerald-600":"text-red-600"}`,children:T(e.distributions-e.contributions)})]})]})]})}return null}}),(0,t.jsx)(F.Legend,{wrapperStyle:{fontSize:"12px",paddingTop:"20px"},iconType:"circle",formatter:e=>"contributions"===e?"Capital Calls":"Distributions"}),(0,t.jsx)(P.Bar,{dataKey:"contributions",fill:"#dc2626",name:"contributions",radius:[6,6,0,0]}),(0,t.jsx)(P.Bar,{dataKey:"distributions",fill:"#059669",name:"distributions",radius:[6,6,0,0]})]})})})]}):(0,t.jsxs)(r.Card,{className:"border-0 shadow-md bg-gradient-to-br from-background to-muted/30 dark:from-gray-800 dark:to-gray-900",children:[(0,t.jsxs)(r.CardHeader,{className:"pb-4",children:[(0,t.jsxs)(r.CardTitle,{className:"text-base font-semibold flex items-center gap-2 text-foreground",children:[(0,t.jsx)(R.DollarSign,{className:"h-5 w-5 text-violet-600"}),"Cash Flow History"]}),(0,t.jsx)(r.CardDescription,{className:"text-muted-foreground",children:"Contributions vs distributions over time"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-[320px] text-muted-foreground/70",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(R.DollarSign,{className:"h-16 w-16 mx-auto mb-3 opacity-20"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:"No cash flow data available"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground/80 mt-2",children:"Staff must add distributions via API"})]})})})]})}var V=e.i(868428);let L=(0,e.i(410587).default)("piggy-bank",[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]]);var I=e.i(416200),z=e.i(262823),E=e.i(761722),U=e.i(10994),B=e.i(734213),M=e.i(282141);let $=e=>{let t=null==e||isNaN(e)?0:e;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0,notation:Math.abs(t)>=1e6?"compact":"standard",compactDisplay:"short"}).format(t)},H=(e,t=1)=>{let s=null==e||isNaN(e)?0:e;return`${s>0?"+":""}${s.toFixed(t)}%`},O=(e,t=2)=>{let s=null==e||isNaN(e)?0:e;return`${s.toFixed(t)}x`};function G({title:e,value:s,subtitle:a,change:n,icon:i,trend:l,className:o}){return(0,t.jsx)(r.Card,{className:(0,M.cn)("border shadow-sm",o),children:(0,t.jsx)(r.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:e}),(0,t.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold",children:s}),void 0!==n&&(0,t.jsxs)("div",{className:(0,M.cn)("flex items-center gap-1 text-sm font-medium","text-muted-foreground"),children:[n>=0?(0,t.jsx)(w.TrendingUp,{className:"h-3 w-3"}):(0,t.jsx)(V.TrendingDown,{className:"h-3 w-3"}),H(n)]})]}),a&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:a})]}),i&&(0,t.jsx)("div",{className:"p-2 rounded-lg bg-muted",children:(0,t.jsx)(i,{className:"h-5 w-5 text-muted-foreground"})})]})})})}function K({kpis:e,trends:s,summary:a,asOfDate:c,isLoading:d=!1,onRefresh:m,onExport:u,className:x,vehicleBreakdown:p=[],allocationData:f=[],performanceData:g=[],cashFlowData:b=[]}){return(0,t.jsxs)("div",{className:(0,M.cn)("space-y-6",x),children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Portfolio Analytics"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:[a.totalVehicles," vehicles, ",a.totalPositions," positions"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:[(0,t.jsx)(B.Activity,{className:"h-3 w-3 mr-1"}),new Date(c).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})]}),(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:m,disabled:d,children:(0,t.jsx)(z.RefreshCw,{className:(0,M.cn)("h-4 w-4",d&&"animate-spin")})}),(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:u,disabled:!u,children:(0,t.jsx)(E.Download,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(G,{title:"Portfolio Value",value:$(e.currentNAV),subtitle:"Current NAV",change:s?.navChangePct,icon:U.Wallet}),(0,t.jsx)(G,{title:"Invested",value:$(e.totalContributed),subtitle:`${e.totalCommitment>0?(e.totalContributed/e.totalCommitment*100).toFixed(0):0}% deployed`,icon:L}),(0,t.jsx)(G,{title:"Distributions",value:$(e.totalDistributions),subtitle:`DPI: ${O(e.dpi)}`,icon:w.TrendingUp}),(0,t.jsx)(G,{title:"Unrealized",value:$(e.unrealizedGain),subtitle:`${(e.unrealizedGainPct??0).toFixed(1)}% return`,change:e.unrealizedGainPct,icon:I.Target})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)(r.Card,{className:"border shadow-sm",children:[(0,t.jsx)(r.CardHeader,{className:"pb-3",children:(0,t.jsx)(r.CardTitle,{className:"text-base font-medium",children:"Performance Metrics"})}),(0,t.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"TVPI"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:O(e.tvpi)})]}),(0,t.jsx)(l.Progress,{value:e.tvpi/3*100,className:"h-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"DPI"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:O(e.dpi)})]}),(0,t.jsx)(l.Progress,{value:e.dpi/2*100,className:"h-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Net IRR"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:H(e.irr)})]}),(0,t.jsx)(l.Progress,{value:Math.min(e.irr/30*100,100),className:"h-2"})]})]})]}),(0,t.jsxs)(r.Card,{className:"border shadow-sm",children:[(0,t.jsx)(r.CardHeader,{className:"pb-3",children:(0,t.jsx)(r.CardTitle,{className:"text-base font-medium",children:"Capital Deployment"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Deployed"}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[e.totalCommitment>0?(e.totalContributed/e.totalCommitment*100).toFixed(0):0,"%"]})]}),(0,t.jsx)(l.Progress,{value:e.totalCommitment>0?e.totalContributed/e.totalCommitment*100:0,className:"h-2"})]}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Commitment"}),(0,t.jsx)("span",{children:$(e.totalCommitment)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Contributed"}),(0,t.jsx)("span",{children:$(e.totalContributed)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Unfunded"}),(0,t.jsx)("span",{children:$(e.unfundedCommitment)})]})]})]})})]}),(0,t.jsxs)(r.Card,{className:"border shadow-sm",children:[(0,t.jsx)(r.CardHeader,{className:"pb-3",children:(0,t.jsx)(r.CardTitle,{className:"text-base font-medium",children:"Portfolio Stats"})}),(0,t.jsxs)(r.CardContent,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:a.totalVehicles}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Vehicles"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:a.totalPositions}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Positions"})]})]}),(0,t.jsx)(o.Separator,{className:"my-4"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Deal Allocations"}),(0,t.jsx)("span",{children:a.totalDeals})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Deal Value"}),(0,t.jsx)("span",{children:$(a.totalDealValue)})]})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,t.jsx)(k,{data:g}),(0,t.jsx)(h,{data:f})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,t.jsx)(A,{data:b})})]})}var q=e.i(191569),Y=e.i(514133),W=e.i(538892),X=e.i(335631),Z=e.i(93502),J=e.i(843189),Q=e.i(679472),ee=e.i(886978),et=e.i(47264),es=e.i(68977),ea=e.i(599205),er=e.i(657180),en=e.i(460138),ei=e.i(362208),el=e.i(998382),eo=["PageUp","PageDown"],ec=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ed={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},em="Slider",[eu,ex,eh]=(0,el.createCollection)(em),[ep,ef]=(0,et.createContextScope)(em,[eh]),[eg,eb]=ep(em),ej=s.forwardRef((e,a)=>{let{name:r,min:n=0,max:i=100,step:l=1,orientation:o="horizontal",disabled:c=!1,minStepsBetweenThumbs:d=0,defaultValue:m=[n],value:u,onValueChange:x=()=>{},onValueCommit:h=()=>{},inverted:p=!1,form:f,...g}=e,b=s.useRef(new Set),j=s.useRef(0),v="horizontal"===o,[N=[],w]=(0,es.useControllableState)({prop:u,defaultProp:m,onChange:e=>{let t=[...b.current];t[j.current]?.focus(),x(e)}}),y=s.useRef(N);function C(e,t,{commit:s}={commit:!1}){let a,r=(String(l).split(".")[1]||"").length,o=Math.round((Math.round((e-n)/l)*l+n)*(a=Math.pow(10,r)))/a,c=(0,J.clamp)(o,[n,i]);w((e=[])=>{let a=function(e=[],t,s){let a=[...e];return a[s]=t,a.sort((e,t)=>e-t)}(e,c,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,s)=>e[s+1]-t))>=t;return!0}(a,d*l))return e;{j.current=a.indexOf(c);let t=String(a)!==String(e);return t&&s&&h(a),t?a:e}})}return(0,t.jsx)(eg,{scope:e.__scopeSlider,name:r,disabled:c,min:n,max:i,valueIndexToChangeRef:j,thumbs:b.current,values:N,orientation:o,form:f,children:(0,t.jsx)(eu.Provider,{scope:e.__scopeSlider,children:(0,t.jsx)(eu.Slot,{scope:e.__scopeSlider,children:(0,t.jsx)(v?ew:ey,{"aria-disabled":c,"data-disabled":c?"":void 0,...g,ref:a,onPointerDown:(0,Q.composeEventHandlers)(g.onPointerDown,()=>{c||(y.current=N)}),min:n,max:i,inverted:p,onSlideStart:c?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let s=e.map(e=>Math.abs(e-t)),a=Math.min(...s);return s.indexOf(a)}(N,e);C(e,t)},onSlideMove:c?void 0:function(e){C(e,j.current)},onSlideEnd:c?void 0:function(){let e=y.current[j.current];N[j.current]!==e&&h(N)},onHomeKeyDown:()=>!c&&C(n,0,{commit:!0}),onEndKeyDown:()=>!c&&C(i,N.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!c){let s=eo.includes(e.key)||e.shiftKey&&ec.includes(e.key),a=j.current;C(N[a]+l*(s?10:1)*t,a,{commit:!0})}}})})})})});ej.displayName=em;var[ev,eN]=ep(em,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ew=s.forwardRef((e,a)=>{let{min:r,max:n,dir:i,inverted:l,onSlideStart:o,onSlideMove:c,onSlideEnd:d,onStepKeyDown:m,...u}=e,[x,h]=s.useState(null),p=(0,ee.useComposedRefs)(a,e=>h(e)),f=s.useRef(void 0),g=(0,ea.useDirection)(i),b="ltr"===g,j=b&&!l||!b&&l;function v(e){let t=f.current||x.getBoundingClientRect(),s=eV([0,t.width],j?[r,n]:[n,r]);return f.current=t,s(e-t.left)}return(0,t.jsx)(ev,{scope:e.__scopeSlider,startEdge:j?"left":"right",endEdge:j?"right":"left",direction:j?1:-1,size:"width",children:(0,t.jsx)(eC,{dir:g,"data-orientation":"horizontal",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=v(e.clientX);o?.(t)},onSlideMove:e=>{let t=v(e.clientX);c?.(t)},onSlideEnd:()=>{f.current=void 0,d?.()},onStepKeyDown:e=>{let t=ed[j?"from-left":"from-right"].includes(e.key);m?.({event:e,direction:t?-1:1})}})})}),ey=s.forwardRef((e,a)=>{let{min:r,max:n,inverted:i,onSlideStart:l,onSlideMove:o,onSlideEnd:c,onStepKeyDown:d,...m}=e,u=s.useRef(null),x=(0,ee.useComposedRefs)(a,u),h=s.useRef(void 0),p=!i;function f(e){let t=h.current||u.current.getBoundingClientRect(),s=eV([0,t.height],p?[n,r]:[r,n]);return h.current=t,s(e-t.top)}return(0,t.jsx)(ev,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:(0,t.jsx)(eC,{"data-orientation":"vertical",...m,ref:x,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=f(e.clientY);l?.(t)},onSlideMove:e=>{let t=f(e.clientY);o?.(t)},onSlideEnd:()=>{h.current=void 0,c?.()},onStepKeyDown:e=>{let t=ed[p?"from-bottom":"from-top"].includes(e.key);d?.({event:e,direction:t?-1:1})}})})}),eC=s.forwardRef((e,s)=>{let{__scopeSlider:a,onSlideStart:r,onSlideMove:n,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:o,onStepKeyDown:c,...d}=e,m=eb(em,a);return(0,t.jsx)(ei.Primitive.span,{...d,ref:s,onKeyDown:(0,Q.composeEventHandlers)(e.onKeyDown,e=>{"Home"===e.key?(l(e),e.preventDefault()):"End"===e.key?(o(e),e.preventDefault()):eo.concat(ec).includes(e.key)&&(c(e),e.preventDefault())}),onPointerDown:(0,Q.composeEventHandlers)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),m.thumbs.has(t)?t.focus():r(e)}),onPointerMove:(0,Q.composeEventHandlers)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&n(e)}),onPointerUp:(0,Q.composeEventHandlers)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),i(e))})})}),eS="SliderTrack",eD=s.forwardRef((e,s)=>{let{__scopeSlider:a,...r}=e,n=eb(eS,a);return(0,t.jsx)(ei.Primitive.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...r,ref:s})});eD.displayName=eS;var ek="SliderRange",e_=s.forwardRef((e,a)=>{let{__scopeSlider:r,...n}=e,i=eb(ek,r),l=eN(ek,r),o=s.useRef(null),c=(0,ee.useComposedRefs)(a,o),d=i.values.length,m=i.values.map(e=>eA(e,i.min,i.max)),u=d>1?Math.min(...m):0,x=100-Math.max(...m);return(0,t.jsx)(ei.Primitive.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...n,ref:c,style:{...e.style,[l.startEdge]:u+"%",[l.endEdge]:x+"%"}})});e_.displayName=ek;var eP="SliderThumb",eF=s.forwardRef((e,a)=>{let r=ex(e.__scopeSlider),[n,i]=s.useState(null),l=(0,ee.useComposedRefs)(a,e=>i(e)),o=s.useMemo(()=>n?r().findIndex(e=>e.ref.current===n):-1,[r,n]);return(0,t.jsx)(eR,{...e,ref:l,index:o})}),eR=s.forwardRef((e,a)=>{var r,n,i,l,o;let c,d,{__scopeSlider:m,index:u,name:x,...h}=e,p=eb(eP,m),f=eN(eP,m),[g,b]=s.useState(null),j=(0,ee.useComposedRefs)(a,e=>b(e)),v=!g||p.form||!!g.closest("form"),N=(0,en.useSize)(g),w=p.values[u],y=void 0===w?0:eA(w,p.min,p.max),C=(r=u,(n=p.values.length)>2?`Value ${r+1} of ${n}`:2===n?["Minimum","Maximum"][r]:void 0),S=N?.[f.size],D=S?(i=S,l=y,o=f.direction,d=eV([0,50],[0,c=i/2]),(c-d(l)*o)*o):0;return s.useEffect(()=>{if(g)return p.thumbs.add(g),()=>{p.thumbs.delete(g)}},[g,p.thumbs]),(0,t.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[f.startEdge]:`calc(${y}% + ${D}px)`},children:[(0,t.jsx)(eu.ItemSlot,{scope:e.__scopeSlider,children:(0,t.jsx)(ei.Primitive.span,{role:"slider","aria-label":e["aria-label"]||C,"aria-valuemin":p.min,"aria-valuenow":w,"aria-valuemax":p.max,"aria-orientation":p.orientation,"data-orientation":p.orientation,"data-disabled":p.disabled?"":void 0,tabIndex:p.disabled?void 0:0,...h,ref:j,style:void 0===w?{display:"none"}:e.style,onFocus:(0,Q.composeEventHandlers)(e.onFocus,()=>{p.valueIndexToChangeRef.current=u})})}),v&&(0,t.jsx)(eT,{name:x??(p.name?p.name+(p.values.length>1?"[]":""):void 0),form:p.form,value:w},u)]})});eF.displayName=eP;var eT=s.forwardRef(({__scopeSlider:e,value:a,...r},n)=>{let i=s.useRef(null),l=(0,ee.useComposedRefs)(i,n),o=(0,er.usePrevious)(a);return s.useEffect(()=>{let e=i.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(o!==a&&t){let s=new Event("input",{bubbles:!0});t.call(e,a),e.dispatchEvent(s)}},[o,a]),(0,t.jsx)(ei.Primitive.input,{style:{display:"none"},...r,ref:l,defaultValue:a})});function eA(e,t,s){return(0,J.clamp)(100/(s-t)*(e-t),[0,100])}function eV(e,t){return s=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(s-e[0])}}function eL({className:e,defaultValue:a,value:r,min:n=0,max:i=100,...l}){let o=s.useMemo(()=>Array.isArray(r)?r:Array.isArray(a)?a:[n,i],[r,a,n,i]);return(0,t.jsxs)(ej,{"data-slot":"slider",defaultValue:a,value:r,min:n,max:i,className:(0,M.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...l,children:[(0,t.jsx)(eD,{"data-slot":"slider-track",className:(0,M.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,t.jsx)(e_,{"data-slot":"slider-range",className:(0,M.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:o.length},(e,s)=>(0,t.jsx)(eF,{"data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-6 md:size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},s))]})}eT.displayName="RadioBubbleInput";var eI=e.i(750809),ez=e.i(382021),eE=e.i(432598),eU=e.i(971743),eB=e.i(84065),eM=e.i(235717),e$=e.i(768385),eH=e.i(310556);let eO=[{value:"all",label:"All Types",icon:eU.Building2},{value:"fund",label:"Funds",icon:eU.Building2},{value:"spv",label:"SPVs",icon:eU.Building2},{value:"co_investment",label:"Co-Investments",icon:eU.Building2},{value:"direct",label:"Direct Investments",icon:eU.Building2}],eG=[{value:"all",label:"All Status"},{value:"active",label:"Active",color:"green"},{value:"pending",label:"Pending",color:"yellow"},{value:"closed",label:"Closed",color:"gray"}],eK=[{value:"all",label:"All Performance",icon:eM.BarChart3},{value:"positive",label:"Positive Returns",icon:w.TrendingUp,color:"green"},{value:"negative",label:"Negative Returns",icon:V.TrendingDown,color:"red"},{value:"breakeven",label:"Break Even",icon:eM.BarChart3,color:"gray"}],eq=[{value:"all",label:"All Sizes"},{value:"large",label:"Large (>$1M)",icon:R.DollarSign},{value:"medium",label:"Medium ($100K-$1M)",icon:R.DollarSign},{value:"small",label:"Small (<$100K)",icon:R.DollarSign}],eY=[{value:"all",label:"All Vintages"},{value:"recent",label:"Recent (< 2 years)",icon:eB.Calendar},{value:"mature",label:"Mature (2-5 years)",icon:eB.Calendar},{value:"legacy",label:"Legacy (> 5 years)",icon:eB.Calendar}],eW=[{value:"all",label:"All Locations"},{value:"luxembourg",label:"Luxembourg",flag:"ðŸ‡±ðŸ‡º"},{value:"british virgin islands",label:"British Virgin Islands",flag:"ðŸ‡»ðŸ‡¬"},{value:"cayman islands",label:"Cayman Islands",flag:"ðŸ‡°ðŸ‡¾"},{value:"united states",label:"United States",flag:"ðŸ‡ºðŸ‡¸"},{value:"singapore",label:"Singapore",flag:"ðŸ‡¸ðŸ‡¬"},{value:"other",label:"Other",flag:"ðŸŒ"}],eX=[{value:"value_desc",label:"Highest Value",icon:w.TrendingUp},{value:"value_asc",label:"Lowest Value",icon:V.TrendingDown},{value:"performance_desc",label:"Best Performance",icon:w.TrendingUp},{value:"performance_asc",label:"Worst Performance",icon:V.TrendingDown},{value:"name_asc",label:"Name (A-Z)"},{value:"name_desc",label:"Name (Z-A)"},{value:"date_desc",label:"Newest First",icon:eB.Calendar},{value:"date_asc",label:"Oldest First",icon:eB.Calendar},{value:"commitment_desc",label:"Largest Commitment",icon:R.DollarSign},{value:"commitment_asc",label:"Smallest Commitment",icon:R.DollarSign}];function eZ({filters:e,onFiltersChange:a,sortBy:r,onSortChange:i,onClearFilters:l,activeFiltersCount:c,totalResults:m=0,className:u}){let[x,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)([e.minValue??0,e.maxValue??1e7]),[g,b]=(0,s.useState)([e.minReturn??-50,e.maxReturn??100]),j=(t,s)=>{a({...e,[t]:s})},v=eX.find(e=>e.value===r)||eX[0];return(0,t.jsxs)("div",{className:(0,M.cn)("space-y-4",u),children:[(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,t.jsx)(eI.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(q.Input,{placeholder:"Search by name, type, or location...",value:e.search,onChange:e=>j("search",e.target.value),className:"pl-10 pr-10"}),e.search&&(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0",onClick:()=>j("search",""),children:(0,t.jsx)(eE.X,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsxs)(W.Select,{value:e.type,onValueChange:e=>j("type",e),children:[(0,t.jsx)(W.SelectTrigger,{className:"w-full sm:w-[160px]",children:(0,t.jsx)(W.SelectValue,{placeholder:"Vehicle Type"})}),(0,t.jsx)(W.SelectContent,{children:eO.map(e=>(0,t.jsx)(W.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)(W.Select,{value:e.performance,onValueChange:e=>j("performance",e),children:[(0,t.jsx)(W.SelectTrigger,{className:"w-full sm:w-[160px]",children:(0,t.jsx)(W.SelectValue,{placeholder:"Performance"})}),(0,t.jsx)(W.SelectContent,{children:eK.map(e=>(0,t.jsx)(W.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)(W.Select,{value:e.size,onValueChange:e=>j("size",e),children:[(0,t.jsx)(W.SelectTrigger,{className:"w-full sm:w-[140px]",children:(0,t.jsx)(W.SelectValue,{placeholder:"Size"})}),(0,t.jsx)(W.SelectContent,{children:eq.map(e=>(0,t.jsx)(W.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)(n.Button,{variant:x?"default":"outline",size:"sm",onClick:()=>h(!x),className:"gap-2",children:[(0,t.jsx)(e$.Sparkles,{className:"h-4 w-4"}),"Advanced",(0,t.jsx)(d.ChevronDown,{className:(0,M.cn)("h-4 w-4 transition-transform",x&&"rotate-180")})]}),(0,t.jsxs)(X.Popover,{children:[(0,t.jsx)(X.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",className:"gap-2",children:[v.icon&&(0,t.jsx)(v.icon,{className:"h-4 w-4"}),v.label,(0,t.jsx)(d.ChevronDown,{className:"h-4 w-4"})]})}),(0,t.jsx)(X.PopoverContent,{className:"w-56",align:"end",children:(0,t.jsxs)(Z.Command,{children:[(0,t.jsx)(Z.CommandInput,{placeholder:"Search sort options..."}),(0,t.jsxs)(Z.CommandList,{children:[(0,t.jsx)(Z.CommandEmpty,{children:"No sort option found."}),(0,t.jsx)(Z.CommandGroup,{children:eX.map(e=>(0,t.jsx)(Z.CommandItem,{value:e.value,onSelect:()=>i(e.value),children:(0,t.jsxs)("div",{className:"flex items-center w-full",children:[e.icon&&(0,t.jsx)(e.icon,{className:"h-4 w-4 mr-2"}),(0,t.jsx)("span",{className:"flex-1",children:e.label}),r===e.value&&(0,t.jsx)(eH.Check,{className:"h-4 w-4"})]})},e.value))})]})]})})]})]})]}),x&&(0,t.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 bg-muted/30",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Y.Label,{className:"text-sm font-medium",children:"Status"}),(0,t.jsxs)(W.Select,{value:e.status,onValueChange:e=>j("status",e),children:[(0,t.jsx)(W.SelectTrigger,{children:(0,t.jsx)(W.SelectValue,{placeholder:"Select status"})}),(0,t.jsx)(W.SelectContent,{children:eG.map(e=>(0,t.jsx)(W.SelectItem,{value:e.value,children:(0,t.jsxs)("div",{className:"flex items-center",children:[e.color&&(0,t.jsx)("div",{className:(0,M.cn)("h-2 w-2 rounded-full mr-2","green"===e.color&&"bg-green-500","yellow"===e.color&&"bg-yellow-500","gray"===e.color&&"bg-gray-500")}),e.label]})},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Y.Label,{className:"text-sm font-medium",children:"Vintage"}),(0,t.jsxs)(W.Select,{value:e.vintage,onValueChange:e=>j("vintage",e),children:[(0,t.jsx)(W.SelectTrigger,{children:(0,t.jsx)(W.SelectValue,{placeholder:"Select vintage"})}),(0,t.jsx)(W.SelectContent,{children:eY.map(e=>(0,t.jsx)(W.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Y.Label,{className:"text-sm font-medium",children:"Domicile"}),(0,t.jsxs)(W.Select,{value:e.domicile,onValueChange:e=>j("domicile",e),children:[(0,t.jsx)(W.SelectTrigger,{children:(0,t.jsx)(W.SelectValue,{placeholder:"Select location"})}),(0,t.jsx)(W.SelectContent,{children:eW.map(e=>(0,t.jsxs)(W.SelectItem,{value:e.value,children:[(0,t.jsx)("span",{className:"mr-2",children:e.flag}),e.label]},e.value))})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(Y.Label,{className:"text-sm font-medium",children:"Value Range"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["$",(p[0]/1e3).toFixed(0),"K - $",(p[1]/1e3).toFixed(0),"K"]})]}),(0,t.jsx)(eL,{value:p,onValueChange:t=>{f(t);let s=0===t[0]&&1e7===t[1];a({...e,minValue:s?void 0:t[0],maxValue:s?void 0:t[1]})},max:1e7,step:1e5,className:"w-full"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(Y.Label,{className:"text-sm font-medium",children:"Return Range"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[g[0],"% - ",g[1],"%"]})]}),(0,t.jsx)(eL,{value:g,onValueChange:t=>{b(t);let s=-50===t[0]&&100===t[1];a({...e,minReturn:s?void 0:t[0],maxReturn:s?void 0:t[1]})},min:-50,max:100,step:5,className:"w-full"})]})]})]}),c>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ez.Filter,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[c," filter",1!==c?"s":""," active"]}),m>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Separator,{orientation:"vertical",className:"h-4"}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[m," result",1!==m?"s":""]})]})]}),(0,t.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:l,className:"text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(eE.X,{className:"h-4 w-4 mr-2"}),"Clear all"]})]})]})}var eJ=e.i(603274),eQ=e.i(337684),e0=e.i(150327),e1=e.i(510166),e2=e.i(496383),e3=e.i(64927),e4=e.i(816654),e5=e.i(80289),e6=e.i(263229),e8=e.i(619324),e7=e.i(275034),e9=e.i(360209),te=e.i(994500);function tt({subscriptionId:e,vehicleName:a,fundedAmount:r,currency:i,onSuccess:l,onCancel:c}){let d=(0,eJ.useRouter)(),[m,u]=(0,s.useState)(!1),[x,h]=(0,s.useState)(""),[p,f]=(0,s.useState)(""),[g,b]=(0,s.useState)(""),[j,v]=(0,s.useState)(null),N=parseFloat(x)||0,w=r>0?N/r*100:0,y=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:i||"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(e);async function C(t){if(t.preventDefault(),v(null),!x||N<=0)return void v("Please enter a valid amount");if(N>r)return void v(`Amount cannot exceed your position value of ${y(r)}`);u(!0);try{let t=await fetch("/api/investor/sell-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription_id:e,amount_to_sell:N,asking_price_per_unit:p?parseFloat(p):void 0,notes:g||void 0})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to submit request");te.toast.success("Sale request submitted successfully"),l?l():(d.push("/versotech_main/portfolio"),d.refresh())}catch(t){console.error("Submit error:",t);let e=t instanceof Error?t.message:"Failed to submit request";v(e),te.toast.error(e)}finally{u(!1)}}return(0,t.jsxs)("div",{className:"w-full space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-amber-500/10 to-orange-500/10 border border-amber-200/50",children:(0,t.jsx)(V.TrendingDown,{className:"h-5 w-5 text-amber-600"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg tracking-tight",children:"Sell Position"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5",children:a})]})]}),(0,t.jsx)("div",{className:"p-4 rounded-xl bg-gradient-to-br from-slate-50 to-slate-100/50 dark:from-slate-900 dark:to-slate-800/50 border border-slate-200/50 dark:border-slate-700/50",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Position Value"}),(0,t.jsx)("span",{className:"text-xl font-semibold tabular-nums tracking-tight",children:y(r)})]})})]}),(0,t.jsx)(o.Separator,{className:"bg-border/50"}),(0,t.jsxs)("form",{onSubmit:C,className:"space-y-5",children:[(0,t.jsxs)(e5.Alert,{className:"border-amber-200/50 bg-amber-50/50 dark:bg-amber-950/20",children:[(0,t.jsx)(e8.AlertTriangle,{className:"h-4 w-4 text-amber-600"}),(0,t.jsx)(e5.AlertDescription,{className:"text-sm text-amber-800 dark:text-amber-200",children:"Sale requests are subject to review and buyer matching. The process typically takes 2-4 weeks."})]}),j&&(0,t.jsx)(e5.Alert,{variant:"destructive",className:"animate-in fade-in-0 slide-in-from-top-1",children:(0,t.jsx)(e5.AlertDescription,{children:j})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(Y.Label,{htmlFor:"amount",className:"text-sm font-medium",children:"Amount to Sell"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground tabular-nums",children:i||"USD"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(q.Input,{id:"amount",type:"number",step:"0.01",min:"0",max:r,value:x,onChange:e=>h(e.target.value),placeholder:"0.00",required:!0,disabled:m,className:"text-lg h-12 pr-20 font-medium tabular-nums"}),N>0&&(0,t.jsxs)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1 text-xs text-muted-foreground bg-background px-1.5 py-0.5 rounded",children:[(0,t.jsx)(e9.Percent,{className:"h-3 w-3"}),(0,t.jsxs)("span",{className:"tabular-nums",children:[w.toFixed(1),"%"]})]})]}),(0,t.jsx)("div",{className:"flex gap-2",children:[25,50,75,100].map(e=>(0,t.jsxs)(n.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{h((r*e/100).toFixed(2))},disabled:m,className:(0,M.cn)("flex-1 text-xs h-8 transition-all",w===e&&"bg-primary/5 border-primary/30 text-primary"),children:[e,"%"]},e))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.Label,{htmlFor:"askingPrice",className:"text-sm font-medium",children:"Asking Price per Unit"}),(0,t.jsx)("span",{className:"text-[10px] font-medium text-muted-foreground bg-muted px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),(0,t.jsx)(q.Input,{id:"askingPrice",type:"number",step:"0.0001",min:"0",value:p,onChange:e=>f(e.target.value),placeholder:"Leave blank for market price",disabled:m,className:"h-11"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1.5",children:[(0,t.jsx)(e7.Info,{className:"h-3 w-3"}),"If not specified, current market valuation will be used"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.Label,{htmlFor:"notes",className:"text-sm font-medium",children:"Additional Notes"}),(0,t.jsx)("span",{className:"text-[10px] font-medium text-muted-foreground bg-muted px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),(0,t.jsx)(e4.Textarea,{id:"notes",value:g,onChange:e=>b(e.target.value),placeholder:"Any special requirements or context for your request...",rows:3,maxLength:1e3,disabled:m,className:"resize-none"}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)("span",{className:"text-[10px] text-muted-foreground tabular-nums",children:[g.length,"/1000"]})})]}),(0,t.jsx)(o.Separator,{className:"bg-border/50"}),N>0&&(0,t.jsxs)("div",{className:"p-4 rounded-xl bg-muted/30 border border-border/50 space-y-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Request Summary"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Selling"}),(0,t.jsx)("span",{className:"font-semibold tabular-nums",children:y(N)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-muted-foreground",children:[(0,t.jsx)("span",{className:"text-sm",children:"of position"}),(0,t.jsxs)("span",{className:"text-sm tabular-nums",children:[w.toFixed(1),"%"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)(n.Button,{type:"submit",disabled:m||N<=0,className:"flex-1 h-11 font-medium",children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e6.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Sale Request"}),c&&(0,t.jsx)(n.Button,{type:"button",variant:"outline",onClick:c,disabled:m,className:"h-11",children:"Cancel"})]})]})]})}function ts({holding:e,detailsBasePath:a="/versotech_main/portfolio"}){let l=(0,eJ.useRouter)(),[o,c]=(0,s.useState)(!1),d=e.position&&e.position.units>0,m=d&&e.subscription?.id,u=!!e.position?.unrealizedGainPct&&e.position.unrealizedGainPct>=0,x=(e.status||e.allocation_status||e.subscription?.status||(d?"active":"pending")).toLowerCase(),h=x.replace(/_/g," ").toUpperCase(),p=()=>{l.push(`${a}/${e.id}`)},f=async e=>{try{let t=await fetch(`/api/documents/${e.id}/download`),s=await t.json();s.url&&window.open(s.url,"_blank")}catch(e){console.error("Download failed:",e)}};return(0,t.jsxs)(r.Card,{className:"group relative overflow-hidden border shadow-sm hover:shadow-md transition-shadow duration-200 min-h-[420px] flex flex-col",children:[(0,t.jsx)(r.CardHeader,{className:"pb-3 flex-shrink-0",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e.logo_url?(0,t.jsx)(eQ.default,{src:e.logo_url,alt:e.investment_name||"Investment",width:48,height:48,className:"h-12 w-12 rounded-lg object-contain bg-muted p-1.5"}):(0,t.jsx)("div",{className:"h-12 w-12 rounded-lg bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center shadow-sm",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg",children:(e.investment_name||e.name||"V").charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{children:[e.investment_name&&(0,t.jsx)("span",{className:"text-sm font-medium text-muted-foreground block",children:e.investment_name}),(0,t.jsx)(r.CardTitle,{className:"text-lg font-semibold line-clamp-1",children:e.name})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)(i.Badge,{variant:"secondary",className:"text-xs",children:e.type.replace(/_/g," ")}),e.domicile&&(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs",children:e.domicile}),(0,t.jsx)(i.Badge,{className:(0,M.cn)("text-xs",(e=>{switch(e){case"active":case"committed":return"bg-emerald-600 border-emerald-500 text-white font-medium";case"pending":return"bg-amber-600 border-amber-500 text-white font-medium";case"closed":return"bg-blue-600 border-blue-500 text-white font-medium";case"cancelled":return"bg-red-600 border-red-500 text-white font-medium";default:return"bg-muted border-border text-foreground font-medium"}})(x)),children:h})]})]}),(0,t.jsxs)(e1.DropdownMenu,{children:[(0,t.jsx)(e1.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,t.jsx)(e3.MoreVertical,{className:"h-4 w-4"})})}),(0,t.jsxs)(e1.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(e1.DropdownMenuLabel,{children:"Actions"}),(0,t.jsx)(e1.DropdownMenuSeparator,{}),(0,t.jsxs)(e1.DropdownMenuItem,{onClick:p,children:[(0,t.jsx)(e2.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),m&&(0,t.jsxs)(e1.DropdownMenuItem,{onClick:()=>c(!0),children:[(0,t.jsx)(V.TrendingDown,{className:"mr-2 h-4 w-4"}),"Request Sale"]})]})]})]})}),(0,t.jsxs)(r.CardContent,{className:"flex-1 flex flex-col",children:[(0,t.jsx)("div",{className:"flex-1 space-y-4",children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Current Value"}),(0,t.jsx)("span",{className:"text-lg font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(e.position.currentValue)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unrealized Gain"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:(0,M.cn)("text-sm font-medium",u?"text-foreground":"text-muted-foreground"),children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency,minimumFractionDigits:0,maximumFractionDigits:0,signDisplay:"always"}).format(e.position.unrealizedGain)}),(0,t.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:[u?"+":"-",Math.abs(e.position.unrealizedGainPct).toFixed(1),"%"]})]})]})]}),(0,t.jsx)("div",{className:"pt-3 border-t mt-3",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Units"}),(0,t.jsx)("p",{className:"font-medium",children:e.position.units.toLocaleString()})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Cost Basis"}),(0,t.jsx)("p",{className:"font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(e.position.costBasis)})]})]})}),e.valuation&&(0,t.jsx)("div",{className:"pt-3 border-t mt-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"NAV per Unit"}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency}).format(e.valuation.navPerUnit)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center justify-end gap-1",children:[(0,t.jsx)(eB.Calendar,{className:"h-3 w-3"}),new Date(e.valuation.asOfDate).toLocaleDateString()]})]})]})})]}):(0,t.jsxs)("div",{className:"text-center py-6 space-y-3",children:[(0,t.jsx)(R.DollarSign,{className:"h-12 w-12 text-muted-foreground/20 mx-auto mb-1"}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Awaiting Funding"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your commitment has been recorded. We will notify you once units are issued."})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)(i.Badge,{variant:"outline",className:"bg-muted/50 border-border text-xs capitalize",children:["Allocation Status: ",(e.allocation_status||e.subscription?.status||"pending").replace(/_/g," ")]}),e.subscription?.commitment!==null&&e.subscription?.commitment!==void 0&&(0,t.jsxs)(i.Badge,{variant:"outline",className:"bg-muted/50 border-border text-xs",children:["Commitment:"," ",new Intl.NumberFormat("en-US",{style:"currency",currency:e.subscription?.currency||e.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(e.subscription.commitment??0)]}),e.subscription?.funding_due_at&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Funding due ",new Date(e.subscription.funding_due_at).toLocaleDateString()]}),e.invite_sent_at&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Invite sent ",new Date(e.invite_sent_at).toLocaleDateString()]})]})]})}),e.documents&&(0,t.jsxs)("div",{className:"pt-3 border-t",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"Documents"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3 text-sm",children:[e.documents.nda&&(0,t.jsx)("button",{onClick:()=>f(e.documents.nda),className:"text-emerald-500 hover:text-emerald-400 hover:underline",children:"NDA"}),e.documents.subscription_pack&&(0,t.jsx)("button",{onClick:()=>f(e.documents.subscription_pack),className:"text-emerald-500 hover:text-emerald-400 hover:underline",children:"Sub Pack"}),e.documents.certificate&&(0,t.jsx)("button",{onClick:()=>f(e.documents.certificate),className:"text-emerald-500 hover:text-emerald-400 hover:underline",children:"Certificate"}),!e.documents.nda&&!e.documents.subscription_pack&&!e.documents.certificate&&(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"No documents"})]})]}),(0,t.jsxs)("div",{className:"pt-2 mt-auto space-y-2",children:[m&&(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",className:"w-full border-amber-200 text-amber-700 hover:bg-amber-50 hover:text-amber-800",onClick:()=>c(!0),children:[(0,t.jsx)(V.TrendingDown,{className:"h-4 w-4 mr-2"}),"Request Sale"]}),(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",className:"w-full",onClick:p,children:[(0,t.jsx)(e2.Eye,{className:"h-4 w-4 mr-2"}),"View Details"]})]})]}),m&&(0,t.jsx)(e0.Sheet,{open:o,onOpenChange:c,children:(0,t.jsxs)(e0.SheetContent,{className:"sm:max-w-md overflow-y-auto",children:[(0,t.jsx)(e0.SheetHeader,{className:"mb-4",children:(0,t.jsx)(e0.SheetTitle,{children:"Request Position Sale"})}),(0,t.jsx)(tt,{subscriptionId:e.subscription.id,vehicleName:e.name,fundedAmount:e.position.costBasis,currency:e.currency,onSuccess:()=>c(!1),onCancel:()=>c(!1)})]})})]})}function ta({children:e,investorIds:r,onDataUpdate:n,enableNotifications:i=!0,holdingsPath:l="/versotech_main/portfolio"}){var o;let c,[d,m]=(0,s.useState)(!1),[u,x]=(0,s.useState)(null),h=(0,s.useRef)([]),p=(0,s.useRef)(0),f=(0,s.useRef)(1e3),g=(0,s.useRef)(()=>{}),b=(0,eJ.useRouter)();(0,s.useEffect)(()=>()=>{h.current.forEach(e=>{e.unsubscribe()}),h.current=[]},[]);let j=(0,s.useCallback)((o=e=>{if(x(new Date().toISOString()),n?.(e),i)switch(e.type){case"position_update":te.toast.info("Portfolio position updated",{description:"Your holdings have been updated with the latest data.",duration:3e3});break;case"valuation_update":te.toast.info("Valuation updated",{description:"New NAV data is available for your investments.",duration:3e3});break;case"allocation_update":te.toast.success("Allocation confirmed",{description:"Your deal allocation has been processed.",duration:5e3});break;case"capital_call":te.toast.warning("Capital call issued",{description:"A new capital call has been issued for one of your investments.",duration:1e4,action:{label:"View Details",onClick:()=>b.push(l)}});break;case"distribution":te.toast.success("Distribution received",{description:"A distribution has been processed for your investment.",duration:8e3,action:{label:"View Details",onClick:()=>b.push(l)}});break;case"fee_accrual":te.toast.info("Fee accrued",{description:"New fees have been accrued for your investments.",duration:5e3})}},c=null,(...e)=>{c&&clearTimeout(c),c=setTimeout(()=>{o(...e)},2e3)}),[n,i,l,b]);return(0,s.useEffect)(()=>{let e;if(!r.length)return;let t=async()=>{try{e=(0,a.createClient)(),h.current.forEach(e=>{e.unsubscribe()}),h.current=[];let t=`investor_id=in.(${r.join(",")})`,n=e.channel("positions_updates").on("postgres_changes",{event:"*",schema:"public",table:"positions",filter:t},e=>{console.log("Position update:",e),j({type:"position_update",data:e,timestamp:new Date().toISOString()})}).subscribe(e=>{console.log("Positions channel status:",e),"SUBSCRIBED"===e?(m(!0),p.current=0,f.current=1e3):"CHANNEL_ERROR"===e&&(m(!1),s())}),i=e.channel("valuations_updates").on("postgres_changes",{event:"*",schema:"public",table:"valuations"},e=>{console.log("Valuation update:",e),j({type:"valuation_update",data:e,timestamp:new Date().toISOString()})}).subscribe(),l=e.channel("allocations_updates").on("postgres_changes",{event:"*",schema:"public",table:"allocations",filter:t},e=>{console.log("Allocation update:",e),j({type:"allocation_update",data:e,timestamp:new Date().toISOString()})}).subscribe(),o=e.channel("capital_calls_updates").on("postgres_changes",{event:"INSERT",schema:"public",table:"capital_calls"},e=>{console.log("Capital call update:",e),j({type:"capital_call",data:e,timestamp:new Date().toISOString()})}).subscribe(),c=e.channel("distributions_updates").on("postgres_changes",{event:"INSERT",schema:"public",table:"distributions"},e=>{console.log("Distribution update:",e),j({type:"distribution",data:e,timestamp:new Date().toISOString()})}).subscribe(),d=e.channel("fee_events_updates").on("postgres_changes",{event:"*",schema:"public",table:"fee_events",filter:t},e=>{console.log("Fee event update:",e),j({type:"fee_accrual",data:e,timestamp:new Date().toISOString()})}).subscribe();h.current=[n,i,l,o,c,d],console.log("Realtime subscriptions established for investors:",r)}catch(e){console.error("Error setting up realtime subscriptions:",e),m(!1),s()}},s=()=>{p.current<5?setTimeout(()=>{console.log(`Attempting to reconnect... (attempt ${p.current+1})`),p.current++,f.current=Math.min(2*f.current,3e4),t()},f.current):(console.error("Max reconnection attempts reached"),te.toast.error("Connection lost",{description:"Unable to maintain real-time updates. Please refresh the page.",duration:1e4,action:{label:"Refresh",onClick:()=>b.refresh()}}))};return g.current=s,t(),()=>{h.current.forEach(e=>{e.unsubscribe()}),h.current=[],m(!1)}},[r,j,b]),(0,s.useEffect)(()=>{let e=setInterval(()=>{!d&&p.current<5&&(console.log("Health check: Connection lost, attempting reconnection..."),p.current=0,g.current())},6e4);return()=>clearInterval(e)},[d]),(0,t.jsxs)("div",{className:"relative",children:[e,(0,t.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,t.jsxs)("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full text-xs font-medium transition-all duration-300 ${d?"bg-green-100 text-green-700 border border-green-200":"bg-red-100 text-red-700 border border-red-200"}`,children:[(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${d?"bg-green-500 animate-pulse":"bg-red-500"}`}),d?"Live":"Offline",u&&d&&(0,t.jsxs)("span",{className:"opacity-70",children:["â€¢ ",new Date(u).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})]})]})})]})}var tr=e.i(56213),tn=e.i(401148);let ti=e=>{if(e.status)return e.status;let t=e.allocation_status?.toLowerCase();if("active"===t||"committed"===t||"pending"===t)return t;if("closed"===t||"cancelled"===t)return"closed";let s=e.subscription?.status?.toLowerCase();return"active"===s?"active":"committed"===s||"pending"===s?"pending":"closed"===s||"cancelled"===s?"closed":e.position&&e.position.currentValue>0?"active":"pending"};function tl({initialData:e,detailsBasePath:i="/versotech_main/portfolio",holdingsPath:l="/versotech_main/portfolio",dealsPath:o="/versotech_main/opportunities",positionsOnly:c=!1}){let[d,m]=(0,s.useState)([]),[u,x]=(0,s.useState)(e),[h,p]=(0,s.useState)(!0),[f,g]=(0,s.useState)(null),[b,j]=(0,s.useState)(!1),[v,N]=(0,s.useState)([]),[w,y]=(0,s.useState)([]),[C,S]=(0,s.useState)([]),[D,k]=(0,s.useState)([]),[_,P]=(0,s.useState)({search:"",type:"all",status:"all",performance:"all",size:"all",vintage:"all",domicile:"all"}),[F,R]=(0,s.useState)("value_desc"),T=(0,s.useCallback)(async(e=!0,t=!0,s=!0)=>{try{let a=new URLSearchParams;e&&a.append("breakdown","true"),t&&a.append("trends","true");let r={method:"GET",headers:{"Content-Type":"application/json"}};s||(r.cache="no-store");let n=await fetch(`/api/portfolio?${a.toString()}`,r);if(!n.ok){let e=await n.text();throw Error(`Failed to fetch portfolio data: ${e}`)}return await n.json()}catch(e){throw console.error("Portfolio fetch error:",e),e}},[]),A=(0,s.useCallback)(async(e=!0)=>{try{let t={method:"GET",headers:{"Content-Type":"application/json"}};e||(t.cache="no-store");let s=await fetch("/api/vehicles?related=true",t);if(!s.ok){let e=await s.text();throw Error(`Failed to fetch holdings: ${e}`)}let a=((await s.json()).vehicles||[]).map(e=>{let t=ti(e),s=e.subscription?{...e.subscription,commitment:null===e.subscription.commitment||void 0===e.subscription.commitment?null:Number(e.subscription.commitment),currency:e.subscription.currency||e.currency,status:e.subscription.status||e.allocation_status||t}:e.subscription;return{...e,status:t,allocation_status:e.allocation_status||s?.status||t,subscription:s}}),r=c?a.filter(e=>(e.position?.units??0)>0):a;m(r)}catch(e){throw console.error("Holdings fetch error:",e),e}},[c]);(0,s.useEffect)(()=>{(async()=>{p(!0),g(null);try{let t=(0,a.createClient)(),{data:{user:s}}=await t.auth.getUser();if(s){let{data:e}=await t.from("investor_users").select("investor_id").eq("user_id",s.id);if(e){let t=e.map(e=>e.investor_id);N(t)}}if(e)x(e),await A();else{let[e]=await Promise.all([T(),A()]);x(e)}}catch(e){console.error("Data load error:",e),g(e instanceof Error?e.message:"Failed to load portfolio data")}finally{p(!1)}})()},[e,T,A]);let V=async()=>{j(!0),g(null);try{let[e]=await Promise.all([T(!0,!0,!1),A(!1)]);x(e)}catch(e){console.error("Refresh error:",e),g(e instanceof Error?e.message:"Failed to refresh data")}finally{j(!1)}};(0,s.useEffect)(()=>{(async()=>{if(!u||!v.length)return;let e=(0,a.createClient)();try{if(u.vehicleBreakdown&&u.vehicleBreakdown.length>0){let e=u.vehicleBreakdown.reduce((e,t)=>e+(t.currentValue||0),0),t=u.vehicleBreakdown.map(t=>({name:t.vehicleName||"Unknown",value:t.currentValue||0,percentage:e>0?(t.currentValue||0)/e*100:0}));y(t)}let{data:t}=await e.from("valuations").select("vehicle_id, nav_total, as_of_date").in("vehicle_id",d.map(e=>e.id)).order("as_of_date",{ascending:!0}).limit(50);if(t&&t.length>0){let e=t.reduce((e,t)=>{let s=t.as_of_date.split("T")[0];return e[s]||(e[s]=0),e[s]+=t.nav_total||0,e},{}),s=Object.entries(e).map(([e,t])=>({date:e,value:t,displayDate:new Date(e).toLocaleDateString("en-US",{month:"short",year:"numeric"})}));S(s)}let{data:s}=await e.from("cashflows").select("type, amount, date").in("investor_id",v).order("date",{ascending:!0}).limit(100),a={};s?.forEach(e=>{let t=new Date(e.date).toISOString().substring(0,7);a[t]||(a[t]={period:t,contributions:0,distributions:0}),"call"===e.type?a[t].contributions+=e.amount||0:"distribution"===e.type&&(a[t].distributions+=e.amount||0)});let r=Object.values(a).map(e=>({...e,displayPeriod:new Date(e.period+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"})}));k(r)}catch(e){console.error("Chart data preparation error:",e)}})()},[u,v,d]);let L=(0,s.useMemo)(()=>{let e=[...d];if(_.search){let t=_.search.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.type.toLowerCase().includes(t)||e.domicile&&e.domicile.toLowerCase().includes(t))}if("all"!==_.type&&(e=e.filter(e=>e.type===_.type)),"all"!==_.status&&(e=e.filter(e=>ti(e)===_.status)),"all"!==_.performance&&(e=e.filter(e=>{let t=e.position?.unrealizedGainPct||0;switch(_.performance){case"positive":return t>0;case"negative":return t<0;case"breakeven":return 1>=Math.abs(t);default:return!0}})),"all"!==_.size&&(e=e.filter(e=>{let t=e.position?.currentValue||0;switch(_.size){case"large":return t>1e6;case"medium":return t>=1e5&&t<=1e6;case"small":return t<1e5;default:return!0}})),"all"!==_.domicile&&(e=e.filter(e=>(e.domicile?.toLowerCase()||"other")===_.domicile)),"all"!==_.vintage){let t=new Date;e=e.filter(e=>{let s=new Date(e.created_at),a=(t.getTime()-s.getTime())/31536e6;switch(_.vintage){case"recent":return a<2;case"mature":return a>=2&&a<=5;case"legacy":return a>5;default:return!0}})}return(void 0!==_.minValue||void 0!==_.maxValue)&&(e=e.filter(e=>{let t=e.position?.currentValue||0,s=_.minValue??0,a=_.maxValue??1/0;return t>=s&&t<=a})),(void 0!==_.minReturn||void 0!==_.maxReturn)&&(e=e.filter(e=>{let t=e.position?.unrealizedGainPct||0,s=_.minReturn??-1/0,a=_.maxReturn??1/0;return t>=s&&t<=a})),e.sort((e,t)=>{switch(F){case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"value_asc":return(e.position?.currentValue||0)-(t.position?.currentValue||0);case"value_desc":return(t.position?.currentValue||0)-(e.position?.currentValue||0);case"performance_asc":return(e.position?.unrealizedGainPct||0)-(t.position?.unrealizedGainPct||0);case"performance_desc":return(t.position?.unrealizedGainPct||0)-(e.position?.unrealizedGainPct||0);case"commitment_asc":return(e.subscription?.commitment||0)-(t.subscription?.commitment||0);case"commitment_desc":return(t.subscription?.commitment||0)-(e.subscription?.commitment||0);case"date_asc":return new Date(e.created_at).getTime()-new Date(t.created_at).getTime();case"date_desc":return new Date(t.created_at).getTime()-new Date(e.created_at).getTime();default:return 0}}),e},[d,_,F]),E=Object.entries(_).filter(([e,t])=>"search"!==e&&"all"!==t).length+ +!!_.search,U=()=>{P({search:"",type:"all",status:"all",performance:"all",size:"all",vintage:"all",domicile:"all"})},B=(0,s.useCallback)(()=>{if(0===L.length)return;let e=new Blob([["Name,Type,Domicile,Status,Currency,Current Value,Cost Basis,Unrealized Gain,Unrealized Gain %,Units,Commitment,Created Date",...L.map(e=>[e.name,e.type.replace(/_/g," "),e.domicile||"",ti(e),e.currency,e.position?.currentValue?.toFixed(2)||"0",e.position?.costBasis?.toFixed(2)||"0",e.position?.unrealizedGain?.toFixed(2)||"0",e.position?.unrealizedGainPct?.toFixed(2)||"0",e.position?.units?.toString()||"0",e.subscription?.commitment?.toFixed(2)||"0",new Date(e.created_at).toLocaleDateString()]).map(e=>e.map(e=>`"${String(e).replace(/"/g,'""')}"`).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),s=URL.createObjectURL(e);t.setAttribute("href",s),t.setAttribute("download",`portfolio-holdings-${new Date().toISOString().split("T")[0]}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},[L]);if(h)return(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsx)(tr.Skeleton,{className:"h-8 w-64"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:8}).map((e,s)=>(0,t.jsx)(tr.Skeleton,{className:"h-32"},s))})]});if(f&&!u)return(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)(e5.Alert,{children:[(0,t.jsx)(tn.AlertCircle,{className:"h-4 w-4"}),(0,t.jsxs)(e5.AlertDescription,{children:[f,(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:V,className:"ml-4",disabled:b,children:[(0,t.jsx)(z.RefreshCw,{className:(0,M.cn)("h-4 w-4 mr-2",b&&"animate-spin")}),"Retry"]})]})]})});let $=L.length;return(0,t.jsx)(ta,{investorIds:v,onDataUpdate:()=>V(),enableNotifications:!0,holdingsPath:l,children:(0,t.jsx)("div",{className:"min-h-screen bg-background",children:(0,t.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Portfolio Holdings"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Complete overview of your investments"})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsxs)(n.Button,{variant:"default",size:"sm",onClick:()=>window.location.href=o,children:[(0,t.jsx)(I.Target,{className:"h-4 w-4 mr-2"}),"Explore Active Deals"]})})]}),u&&(0,t.jsx)(K,{kpis:u.kpis,trends:u.trends,summary:u.summary,asOfDate:u.asOfDate,isLoading:b,onRefresh:V,onExport:B,vehicleBreakdown:u.vehicleBreakdown,allocationData:w,performanceData:C,cashFlowData:D}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Your Holdings"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[L.length," total holdings"]})]}),(0,t.jsx)(eZ,{filters:_,onFiltersChange:P,sortBy:F,onSortChange:R,onClearFilters:U,activeFiltersCount:E,totalResults:$}),0===$?(0,t.jsx)(r.Card,{className:"border-dashed",children:(0,t.jsxs)(r.CardContent,{className:"flex flex-col items-center justify-center py-16",children:[(0,t.jsx)(tn.AlertCircle,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No holdings found"}),(0,t.jsx)("p",{className:"text-muted-foreground text-center max-w-sm",children:E>0?"Try adjusting your filters to see more results":"Your holdings will appear here once investments are made"}),E>0&&(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:U,className:"mt-4",children:"Clear filters"})]})}):(0,t.jsx)("div",{className:"grid gap-6 grid-cols-1 lg:grid-cols-2",children:L.map(e=>(0,t.jsx)(ts,{holding:e,detailsBasePath:i},e.id))})]})]})})})}e.s(["HoldingsPage",()=>tl],881238)}]);