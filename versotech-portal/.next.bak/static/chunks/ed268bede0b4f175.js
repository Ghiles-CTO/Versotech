(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,275630,e=>{"use strict";var s=e.i(722679),t=e.i(340915),a=e.i(603274),l=e.i(994500),r=e.i(615595),i=e.i(729416),n=e.i(90613),o=e.i(316264),c=e.i(191569),d=e.i(129432),m=e.i(312692),h=e.i(74434),x=e.i(237635),g=e.i(510166),u=e.i(538892),j=e.i(335631),p=e.i(352776),w=e.i(908925),N=e.i(401148),S=e.i(263229),v=e.i(750809),C=e.i(849110),f=e.i(496383),y=e.i(773510),b=e.i(501259),A=e.i(971743),D=e.i(382021),I=e.i(262823),k=e.i(15098),R=e.i(645855),T=e.i(745083),L=e.i(761722),M=e.i(758171),E=e.i(197098),U=e.i(946738),z=e.i(16479),P=e.i(185419),B=e.i(398739),O=e.i(478416),_=e.i(545322),$=e.i(396064),K=e.i(619324),F=e.i(104548),V=e.i(981218),H=e.i(818798);let Y=(0,e.i(410587).default)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);var G=e.i(398472),J=e.i(35334),W=e.i(295588),X=e.i(91065);let q={investor:"/versotech_main/investors",partner:"/versotech_main/partners",lawyer:"/versotech_main/lawyers",commercial_partner:"/versotech_main/commercial-partners",introducer:"/versotech_main/introducers",arranger:"/versotech_main/arrangers"};function Q({kyc:e}){if(!e?.status)return(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"});let t=X.KYC_STATUS_CONFIG[e.status];if(!t)return(0,s.jsx)("span",{className:"text-muted-foreground",children:e.status});let a={check:k.CheckCircle2,clock:R.Clock,upload:$.Upload,x:T.XCircle,alert:K.AlertTriangle}[t.icon];return(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(a,{className:`h-4 w-4 ${t.className}`}),(0,s.jsx)("span",{className:`text-xs ${t.className}`,children:t.label}),e.idExpiryWarning&&(0,s.jsx)(K.AlertTriangle,{className:`h-3 w-3 ${"expired"===e.idExpiryWarning?"text-red-400":"text-orange-400"}`})]})}function Z({entities:e}){return 0===e.length?(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"}):(0,s.jsxs)(j.Popover,{children:[(0,s.jsx)(j.PopoverTrigger,{asChild:!0,children:(0,s.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"h-auto py-1 px-2",children:[(0,s.jsx)("span",{className:"font-medium",children:e.length}),(0,s.jsx)(E.ChevronRight,{className:"h-3 w-3 ml-1"})]})}),(0,s.jsxs)(j.PopoverContent,{className:"w-80 p-0",align:"start",children:[(0,s.jsx)("div",{className:"p-3 border-b",children:(0,s.jsxs)("h4",{className:"font-medium",children:["Entities (",e.length,")"]})}),(0,s.jsx)("div",{className:"max-h-64 overflow-y-auto",children:e.map(e=>{let t=X.ENTITY_TYPE_CONFIG[e.type];return(0,s.jsxs)("div",{className:"p-3 border-b last:border-0 hover:bg-muted/50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("span",{className:"font-medium text-sm",children:e.name}),(0,s.jsx)(d.Badge,{variant:"outline",className:`text-xs ${t?.className||""}`,children:t?.label||e.type})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)("span",{className:"capitalize",children:e.role}),e.isPrimary&&(0,s.jsx)(d.Badge,{variant:"outline",className:"text-xs py-0",children:"Primary"}),e.canSign&&(0,s.jsx)(d.Badge,{variant:"outline",className:"text-xs py-0",children:"Can Sign"})]})]},`${e.type}-${e.id}`)})})]})]})}function ee({stats:e,loading:t}){if(t||!e)return(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[...Array(6)].map((e,t)=>(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"pt-4",children:[(0,s.jsx)("div",{className:"h-8 w-16 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-3 w-12 bg-muted animate-pulse rounded mt-2"})]})},t))});let a=[{label:"Total Users",value:e.total,color:"text-foreground"},{label:"Active (30d)",value:e.active,color:"text-green-400"},{label:"Staff",value:e.staff,color:"text-blue-400"},{label:"Investors",value:e.investors,color:"text-emerald-400"},{label:"Partners",value:e.partners,color:"text-cyan-400"},{label:"Pending KYC",value:e.pendingKyc,color:"text-yellow-400"}];return(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:a.map(e=>(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"pt-4",children:[(0,s.jsx)("div",{className:`text-2xl font-bold ${e.color}`,children:e.value}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:e.label})]})},e.label))})}function es(){let e=(0,a.useRouter)(),[j,k]=(0,t.useState)([]),[R,T]=(0,t.useState)(null),[$,K]=(0,t.useState)(!0),[es,et]=(0,t.useState)(null),[ea,el]=(0,t.useState)(""),[er,ei]=(0,t.useState)("all"),[en,eo]=(0,t.useState)("all"),[ec,ed]=(0,t.useState)("all"),[em,eh]=(0,t.useState)({page:1,pageSize:50,totalPages:1,totalCount:0}),[ex,eg]=(0,t.useState)([{id:"createdAt",desc:!0}]),[eu,ej]=(0,t.useState)(()=>{let e={};return X.ALL_COLUMNS.forEach(s=>{e[s]=X.DEFAULT_VISIBLE_COLUMNS.includes(s)}),e}),[ep,ew]=(0,t.useState)({}),[eN,eS]=(0,t.useState)(null),[ev,eC]=(0,t.useState)(!1),[ef,ey]=(0,t.useState)(!1),[eb,eA]=(0,t.useState)(!1),[eD,eI]=(0,t.useState)(!1),[ek,eR]=(0,t.useState)(!1),eT=(0,t.useCallback)(async()=>{try{K(!0),et(null);let e=new URLSearchParams({page:em.page.toString(),pageSize:em.pageSize.toString(),...ea&&{search:ea},...er&&"all"!==er&&{role:er},...en&&"all"!==en&&{entityType:en},...ec&&"all"!==ec&&{kycStatus:ec},sortBy:ex[0]?.id||"createdAt",sortOrder:ex[0]?.desc?"desc":"asc"}),s=await fetch(`/api/admin/users?${e}`),t=await s.json();if(!t.success)throw Error(t.error||"Failed to fetch users");k(t.data||[]),T(t.stats||null),t.pagination&&eh(e=>({...e,totalPages:t.pagination.totalPages,totalCount:t.pagination.totalCount}))}catch(s){let e=s instanceof Error?s.message:"Failed to load users";console.error("[UsersPageClient] Error:",s),et(e)}finally{K(!1)}},[em.page,em.pageSize,ea,er,en,ec,ex]);(0,t.useEffect)(()=>{eT()},[eT]),(0,t.useEffect)(()=>{eh(e=>({...e,page:1}))},[ea,er,en,ec]);let eL=(0,t.useCallback)(e=>{eS(e),eC(!0)},[]),eM=(0,t.useCallback)(e=>{eS(e),ey(!0)},[]),eE=(0,t.useCallback)(e=>{eS(e),eA(!0)},[]),eU=(0,t.useCallback)(e=>{eS(e),eI(!0)},[]),ez=async()=>{if(eN){eR(!0);try{let e=await fetch(`/api/admin/users/${eN.id}/reset-password`,{method:"POST"}),s=await e.json().catch(()=>({}));e.ok&&s?.success?(l.toast.success("Password reset email sent successfully"),ey(!1),eS(null)):l.toast.error(s?.error||"Failed to send password reset email")}catch(e){console.error("Reset password error:",e),l.toast.error("An error occurred while sending password reset email")}finally{eR(!1)}}},eP=async()=>{if(eN){eR(!0);try{let e=await fetch(`/api/admin/users/${eN.id}/deactivate`,{method:"PATCH"}),s=await e.json().catch(()=>({}));e.ok&&s?.success?(l.toast.success("User deactivated successfully"),eA(!1),eS(null),eT()):l.toast.error(s?.error||"Failed to deactivate user")}catch(e){console.error("Deactivate error:",e),l.toast.error("An error occurred while deactivating user")}finally{eR(!1)}}},eB=async()=>{if(eN){eR(!0);try{let e=await fetch(`/api/admin/users/${eN.id}/reactivate`,{method:"PATCH"}),s=await e.json().catch(()=>({}));e.ok&&s?.success?(l.toast.success("User reactivated successfully"),eI(!1),eS(null),eT()):l.toast.error(s?.error||"Failed to reactivate user")}catch(e){console.error("Reactivate error:",e),l.toast.error("An error occurred while reactivating user")}finally{eR(!1)}}},eO=(0,t.useMemo)(()=>[{id:"select",header:({table:e})=>(0,s.jsx)(m.Checkbox,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:s=>e.toggleAllPageRowsSelected(!!s),"aria-label":"Select all"}),cell:({row:e})=>(0,s.jsx)(m.Checkbox,{checked:e.getIsSelected(),onCheckedChange:s=>e.toggleSelected(!!s),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1,size:40},{id:"user",accessorKey:"displayName",header:({column:e})=>(0,s.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"-ml-3 h-8",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["User","asc"===e.getIsSorted()?(0,s.jsx)(B.ArrowUp,{className:"ml-2 h-4 w-4"}):"desc"===e.getIsSorted()?(0,s.jsx)(O.ArrowDown,{className:"ml-2 h-4 w-4"}):(0,s.jsx)(P.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.original;return(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(h.Avatar,{className:"h-8 w-8",children:[t.avatarUrl&&(0,s.jsx)(h.AvatarImage,{src:t.avatarUrl,alt:t.displayName}),(0,s.jsx)(h.AvatarFallback,{className:"text-xs",children:t.displayName.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-medium text-foreground flex items-center gap-1.5",children:[t.displayName,t.isSuperAdmin&&(0,s.jsx)(V.Shield,{className:"h-3.5 w-3.5 text-purple-400"})]}),t.title&&(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:t.title})]})]})},size:200},{id:"email",accessorKey:"email",header:({column:e})=>(0,s.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"-ml-3 h-8",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Email","asc"===e.getIsSorted()?(0,s.jsx)(B.ArrowUp,{className:"ml-2 h-4 w-4"}):"desc"===e.getIsSorted()?(0,s.jsx)(O.ArrowDown,{className:"ml-2 h-4 w-4"}):(0,s.jsx)(P.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,s.jsx)("span",{className:"text-sm",children:e.original.email}),size:180},{id:"systemRole",accessorKey:"systemRole",header:({column:e})=>(0,s.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"-ml-3 h-8",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Role","asc"===e.getIsSorted()?(0,s.jsx)(B.ArrowUp,{className:"ml-2 h-4 w-4"}):"desc"===e.getIsSorted()?(0,s.jsx)(O.ArrowDown,{className:"ml-2 h-4 w-4"}):(0,s.jsx)(P.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{let t=e.original.systemRole,a=X.ROLE_BADGE_CONFIG[t]||{label:t,className:"bg-gray-500/20 text-gray-400"};return(0,s.jsx)(d.Badge,{variant:"outline",className:a.className,children:a.label})},size:140},{id:"title",accessorKey:"title",header:"Title",cell:({row:e})=>(0,s.jsx)("span",{className:e.original.title?"":"text-muted-foreground",children:e.original.title||"—"}),size:150},{id:"phone",accessorKey:"phone",header:"Phone",cell:({row:e})=>(0,s.jsx)("span",{className:e.original.phone?"":"text-muted-foreground",children:e.original.phone||"—"}),size:130},{id:"officeLocation",accessorKey:"officeLocation",header:"Office",cell:({row:e})=>(0,s.jsx)("span",{className:e.original.officeLocation?"":"text-muted-foreground",children:e.original.officeLocation||"—"}),size:120},{id:"entities",accessorKey:"entityCount",header:({column:e})=>(0,s.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"-ml-3 h-8",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Entities","asc"===e.getIsSorted()?(0,s.jsx)(B.ArrowUp,{className:"ml-2 h-4 w-4"}):"desc"===e.getIsSorted()?(0,s.jsx)(O.ArrowDown,{className:"ml-2 h-4 w-4"}):(0,s.jsx)(P.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,s.jsx)(Z,{entities:e.original.entities}),size:100},{id:"kyc",accessorKey:"kyc",header:"KYC",cell:({row:e})=>(0,s.jsx)(Q,{kyc:e.original.kyc}),size:100},{id:"createdAt",accessorKey:"createdAt",header:({column:e})=>(0,s.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"-ml-3 h-8",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Joined","asc"===e.getIsSorted()?(0,s.jsx)(B.ArrowUp,{className:"ml-2 h-4 w-4"}):"desc"===e.getIsSorted()?(0,s.jsx)(O.ArrowDown,{className:"ml-2 h-4 w-4"}):(0,s.jsx)(P.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:new Date(e.original.createdAt).toLocaleDateString()}),size:100},{id:"lastLoginAt",accessorKey:"lastLoginAt",header:({column:e})=>(0,s.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"-ml-3 h-8",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Last Active","asc"===e.getIsSorted()?(0,s.jsx)(B.ArrowUp,{className:"ml-2 h-4 w-4"}):"desc"===e.getIsSorted()?(0,s.jsx)(O.ArrowDown,{className:"ml-2 h-4 w-4"}):(0,s.jsx)(P.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:function(e){if(!e)return"Never";let s=new Date(e),t=Math.floor((new Date().getTime()-s.getTime())/864e5);return 0===t?"Today":1===t?"Yesterday":t<7?`${t} days ago`:t<30?`${Math.floor(t/7)} weeks ago`:t<365?`${Math.floor(t/30)} months ago`:`${Math.floor(t/365)} years ago`}(e.original.lastLoginAt)}),size:120},{id:"passwordSet",accessorKey:"passwordSet",header:"Password",cell:({row:e})=>e.original.passwordSet?(0,s.jsx)(F.Key,{className:"h-4 w-4 text-green-400"}):(0,s.jsx)(F.Key,{className:"h-4 w-4 text-muted-foreground/30"}),size:80},{id:"isSuperAdmin",accessorKey:"isSuperAdmin",header:"Super Admin",cell:({row:e})=>e.original.isSuperAdmin?(0,s.jsx)(V.Shield,{className:"h-4 w-4 text-purple-400"}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"}),size:100},{id:"hasSignature",accessorKey:"hasSignature",header:"Signature",cell:({row:e})=>e.original.hasSignature?(0,s.jsx)(H.PenTool,{className:"h-4 w-4 text-green-400"}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"}),size:90},{id:"actions",header:"",cell:({row:t})=>{let a=t.original;return(0,s.jsxs)(g.DropdownMenu,{children:[(0,s.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(o.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,s.jsx)(C.MoreHorizontal,{className:"h-4 w-4"})})}),(0,s.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,s.jsx)(g.DropdownMenuLabel,{children:"Actions"}),(0,s.jsx)(g.DropdownMenuSeparator,{}),(0,s.jsxs)(g.DropdownMenuItem,{onClick:()=>e.push(`/versotech_main/users/${a.id}`),children:[(0,s.jsx)(f.Eye,{className:"mr-2 h-4 w-4"}),"View Profile"]}),(0,s.jsxs)(g.DropdownMenuItem,{onClick:()=>window.location.href=`mailto:${a.email}`,children:[(0,s.jsx)(y.Mail,{className:"mr-2 h-4 w-4"}),"Send Email"]}),(0,s.jsxs)(g.DropdownMenuItem,{onClick:()=>navigator.clipboard.writeText(a.email),children:[(0,s.jsx)(Y,{className:"mr-2 h-4 w-4"}),"Copy Email"]}),(0,s.jsx)(g.DropdownMenuSeparator,{}),a.entities.length>0&&(0,s.jsxs)(g.DropdownMenuItem,{onClick:()=>eL(a),children:[(0,s.jsx)(A.Building2,{className:"mr-2 h-4 w-4"}),"View Entities (",a.entities.length,")"]}),(0,s.jsx)(g.DropdownMenuSeparator,{}),(0,s.jsxs)(g.DropdownMenuItem,{onClick:()=>eM(a),disabled:a.isDeleted,children:[(0,s.jsx)(F.Key,{className:"mr-2 h-4 w-4"}),"Reset Password"]}),a.isDeleted?(0,s.jsxs)(g.DropdownMenuItem,{className:"text-green-400",onClick:()=>eU(a),children:[(0,s.jsx)(J.UserCheck,{className:"mr-2 h-4 w-4"}),"Reactivate"]}):(0,s.jsxs)(g.DropdownMenuItem,{className:"text-red-400",onClick:()=>eE(a),children:[(0,s.jsx)(W.UserX,{className:"mr-2 h-4 w-4"}),"Deactivate"]})]})]})},enableSorting:!1,enableHiding:!1,size:60}],[e,eL,eM,eE,eU]),e_=(0,r.useReactTable)({data:j,columns:eO,state:{sorting:ex,columnVisibility:eu,rowSelection:ep},onSortingChange:eg,onColumnVisibilityChange:ej,onRowSelectionChange:ew,getCoreRowModel:(0,i.getCoreRowModel)(),getSortedRowModel:(0,i.getSortedRowModel)(),getFilteredRowModel:(0,i.getFilteredRowModel)(),manualPagination:!0,manualSorting:!0,pageCount:em.totalPages}),e$=()=>{let e=new Blob([[["Name","Email","Role","Title","Entities","KYC Status","Last Login","Joined"],...j.map(e=>[e.displayName,e.email,X.ROLE_BADGE_CONFIG[e.systemRole]?.label||e.systemRole,e.title||"",e.entityCount.toString(),e.kyc?.status||"",e.lastLoginAt?new Date(e.lastLoginAt).toLocaleDateString():"Never",new Date(e.createdAt).toLocaleDateString()])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n")],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download=`users-${new Date().toISOString().split("T")[0]}.csv`,t.click(),window.URL.revokeObjectURL(s)};if(es&&!$)return(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsx)(N.AlertCircle,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Error Loading Users"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:es}),(0,s.jsxs)(o.Button,{onClick:eT,variant:"outline",children:[(0,s.jsx)(I.RefreshCw,{className:"mr-2 h-4 w-4"}),"Try Again"]})]});let eK=Object.keys(ep).length;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(ee,{stats:R,loading:$}),(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(v.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(c.Input,{placeholder:"Search by name, email, or title...",value:ea,onChange:e=>el(e.target.value),className:"pl-10"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)(u.Select,{value:er,onValueChange:ei,children:[(0,s.jsxs)(u.SelectTrigger,{className:"w-full sm:w-[160px]",children:[(0,s.jsx)(D.Filter,{className:"h-4 w-4 mr-2"}),(0,s.jsx)(u.SelectValue,{placeholder:"Role"})]}),(0,s.jsxs)(u.SelectContent,{children:[(0,s.jsx)(u.SelectItem,{value:"all",children:"All Roles"}),(0,s.jsx)(u.SelectItem,{value:"staff_admin",children:"Staff Admin"}),(0,s.jsx)(u.SelectItem,{value:"staff_ops",children:"Staff Ops"}),(0,s.jsx)(u.SelectItem,{value:"staff_rm",children:"Staff RM"}),(0,s.jsx)(u.SelectItem,{value:"ceo",children:"CEO"}),(0,s.jsx)(u.SelectItem,{value:"investor",children:"Investor"}),(0,s.jsx)(u.SelectItem,{value:"partner",children:"Partner"}),(0,s.jsx)(u.SelectItem,{value:"lawyer",children:"Lawyer"}),(0,s.jsx)(u.SelectItem,{value:"introducer",children:"Introducer"}),(0,s.jsx)(u.SelectItem,{value:"arranger",children:"Arranger"})]})]}),(0,s.jsxs)(u.Select,{value:en,onValueChange:eo,children:[(0,s.jsx)(u.SelectTrigger,{className:"w-full sm:w-[160px]",children:(0,s.jsx)(u.SelectValue,{placeholder:"Entity Type"})}),(0,s.jsxs)(u.SelectContent,{children:[(0,s.jsx)(u.SelectItem,{value:"all",children:"All Entity Types"}),(0,s.jsx)(u.SelectItem,{value:"investor",children:"Investor"}),(0,s.jsx)(u.SelectItem,{value:"partner",children:"Partner"}),(0,s.jsx)(u.SelectItem,{value:"lawyer",children:"Lawyer"}),(0,s.jsx)(u.SelectItem,{value:"introducer",children:"Introducer"}),(0,s.jsx)(u.SelectItem,{value:"arranger",children:"Arranger"})]})]}),(0,s.jsxs)(u.Select,{value:ec,onValueChange:ed,children:[(0,s.jsx)(u.SelectTrigger,{className:"w-full sm:w-[140px]",children:(0,s.jsx)(u.SelectValue,{placeholder:"KYC Status"})}),(0,s.jsxs)(u.SelectContent,{children:[(0,s.jsx)(u.SelectItem,{value:"all",children:"All KYC"}),(0,s.jsx)(u.SelectItem,{value:"approved",children:"Approved"}),(0,s.jsx)(u.SelectItem,{value:"pending",children:"Pending"}),(0,s.jsx)(u.SelectItem,{value:"submitted",children:"Submitted"}),(0,s.jsx)(u.SelectItem,{value:"rejected",children:"Rejected"}),(0,s.jsx)(u.SelectItem,{value:"expired",children:"Expired"})]})]}),(0,s.jsx)(()=>(0,s.jsxs)(g.DropdownMenu,{children:[(0,s.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(_.Columns3,{className:"h-4 w-4 mr-2"}),"Columns"]})}),(0,s.jsxs)(g.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,s.jsx)(g.DropdownMenuLabel,{children:"Toggle columns"}),(0,s.jsx)(g.DropdownMenuSeparator,{}),e_.getAllColumns().filter(e=>e.getCanHide()).map(e=>{let t=X.REQUIRED_COLUMNS.includes(e.id);return(0,s.jsx)(g.DropdownMenuCheckboxItem,{className:"capitalize",checked:e.getIsVisible(),onCheckedChange:s=>e.toggleVisibility(!!s),disabled:t,children:"systemRole"===e.id?"Role":e.id},e.id)}),(0,s.jsx)(g.DropdownMenuSeparator,{}),(0,s.jsx)(g.DropdownMenuItem,{onClick:()=>{let e={};X.ALL_COLUMNS.forEach(s=>{e[s]=!0}),ej(e)},children:"Show All"}),(0,s.jsx)(g.DropdownMenuItem,{onClick:()=>{let e={};X.ALL_COLUMNS.forEach(s=>{e[s]=X.DEFAULT_VISIBLE_COLUMNS.includes(s)}),ej(e)},children:"Reset to Default"})]})]}),{}),(0,s.jsxs)(o.Button,{variant:"outline",onClick:e$,children:[(0,s.jsx)(L.Download,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,s.jsx)(o.Button,{variant:"outline",onClick:eT,disabled:$,children:(0,s.jsx)(I.RefreshCw,{className:`h-4 w-4 ${$?"animate-spin":""}`})})]})]}),eK>0&&(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-4 p-3 bg-muted/50 rounded-lg",children:[(0,s.jsxs)("span",{className:"text-sm font-medium",children:[eK," selected"]}),(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{let e=e_.getSelectedRowModel().rows;if(0===e.length)return;let s=e.map(e=>e.original.email).join(",");window.location.href=`mailto:?bcc=${encodeURIComponent(s)}`},children:[(0,s.jsx)(y.Mail,{className:"h-4 w-4 mr-2"}),"Send Bulk Email"]}),(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{let e=e_.getSelectedRowModel().rows;if(0===e.length)return void e$();let s=new Blob([[["Name","Email","Role","Title","Entities","KYC Status","Last Login","Joined"],...e.map(e=>{let s=e.original;return[s.displayName,s.email,X.ROLE_BADGE_CONFIG[s.systemRole]?.label||s.systemRole,s.title||"",s.entityCount.toString(),s.kyc?.status||"",s.lastLoginAt?new Date(s.lastLoginAt).toLocaleDateString():"Never",new Date(s.createdAt).toLocaleDateString()]})].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`users-selected-${new Date().toISOString().split("T")[0]}.csv`,a.click(),window.URL.revokeObjectURL(t)},children:[(0,s.jsx)(L.Download,{className:"h-4 w-4 mr-2"}),"Export Selected"]}),(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>ew({}),children:"Clear Selection"})]})]})}),(0,s.jsxs)(n.Card,{children:[(0,s.jsxs)(n.CardHeader,{className:"pb-3",children:[(0,s.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(b.Users,{className:"h-5 w-5"}),"Platform Users (",em.totalCount,")"]}),(0,s.jsx)(n.CardDescription,{children:"All people with platform logins. For business entities, see the Accounts page."})]}),(0,s.jsxs)(n.CardContent,{children:[(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(x.Table,{children:[(0,s.jsx)(x.TableHeader,{children:e_.getHeaderGroups().map(e=>(0,s.jsx)(x.TableRow,{children:e.headers.map(e=>(0,s.jsx)(x.TableHead,{style:{width:e.getSize()},children:e.isPlaceholder?null:(0,r.flexRender)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(x.TableBody,{children:$?(0,s.jsx)(x.TableRow,{children:(0,s.jsx)(x.TableCell,{colSpan:eO.length,className:"h-24 text-center",children:(0,s.jsx)(S.Loader2,{className:"h-6 w-6 animate-spin mx-auto text-muted-foreground"})})}):0===e_.getRowModel().rows.length?(0,s.jsx)(x.TableRow,{children:(0,s.jsx)(x.TableCell,{colSpan:eO.length,className:"h-24 text-center text-muted-foreground",children:"No users found"})}):e_.getRowModel().rows.map(e=>(0,s.jsx)(x.TableRow,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,s.jsx)(x.TableCell,{children:(0,r.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(em.page-1)*em.pageSize+1," to"," ",Math.min(em.page*em.pageSize,em.totalCount)," of"," ",em.totalCount," users"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(u.Select,{value:em.pageSize.toString(),onValueChange:e=>eh(s=>({...s,pageSize:parseInt(e),page:1})),children:[(0,s.jsx)(u.SelectTrigger,{className:"w-[100px]",children:(0,s.jsx)(u.SelectValue,{})}),(0,s.jsxs)(u.SelectContent,{children:[(0,s.jsx)(u.SelectItem,{value:"10",children:"10 rows"}),(0,s.jsx)(u.SelectItem,{value:"25",children:"25 rows"}),(0,s.jsx)(u.SelectItem,{value:"50",children:"50 rows"}),(0,s.jsx)(u.SelectItem,{value:"100",children:"100 rows"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(o.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>eh(e=>({...e,page:1})),disabled:1===em.page,children:(0,s.jsx)(U.ChevronsLeft,{className:"h-4 w-4"})}),(0,s.jsx)(o.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>eh(e=>({...e,page:e.page-1})),disabled:1===em.page,children:(0,s.jsx)(M.ChevronLeft,{className:"h-4 w-4"})}),(0,s.jsxs)("span",{className:"text-sm px-2",children:["Page ",em.page," of ",em.totalPages]}),(0,s.jsx)(o.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>eh(e=>({...e,page:e.page+1})),disabled:em.page===em.totalPages,children:(0,s.jsx)(E.ChevronRight,{className:"h-4 w-4"})}),(0,s.jsx)(o.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>eh(e=>({...e,page:em.totalPages})),disabled:em.page===em.totalPages,children:(0,s.jsx)(z.ChevronsRight,{className:"h-4 w-4"})})]})]})]})]})]}),(0,s.jsx)(p.Dialog,{open:ev,onOpenChange:eC,children:(0,s.jsxs)(p.DialogContent,{className:"max-w-lg",children:[(0,s.jsxs)(p.DialogHeader,{children:[(0,s.jsx)(p.DialogTitle,{children:"Entity Associations"}),(0,s.jsxs)(p.DialogDescription,{children:[eN?.displayName,"'s entity associations"]})]}),(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-3",children:eN?.entities.map(t=>{let a=X.ENTITY_TYPE_CONFIG[t.type],l=q[t.type];return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-muted/30 hover:bg-muted/50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:t.name}),(0,s.jsx)(d.Badge,{variant:"outline",className:`text-xs ${a?.className||""}`,children:a?.label||t.type})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground capitalize",children:t.role}),t.isPrimary&&(0,s.jsx)(d.Badge,{variant:"outline",className:"text-xs py-0 bg-blue-500/10 text-blue-400 border-blue-500/30",children:"Primary"}),t.canSign&&(0,s.jsx)(d.Badge,{variant:"outline",className:"text-xs py-0 bg-green-500/10 text-green-400 border-green-500/30",children:"Can Sign"})]})]}),l&&(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>e.push(`${l}/${t.id}`),children:(0,s.jsx)(G.ExternalLink,{className:"h-4 w-4"})})]},`${t.type}-${t.id}`)})})]})}),(0,s.jsx)(w.AlertDialog,{open:ef,onOpenChange:ey,children:(0,s.jsxs)(w.AlertDialogContent,{children:[(0,s.jsxs)(w.AlertDialogHeader,{children:[(0,s.jsx)(w.AlertDialogTitle,{children:"Reset Password"}),(0,s.jsxs)(w.AlertDialogDescription,{children:["This will send a password reset email to ",(0,s.jsx)("strong",{children:eN?.email}),". The user will need to click the link in the email to set a new password."]})]}),(0,s.jsxs)(w.AlertDialogFooter,{children:[(0,s.jsx)(w.AlertDialogCancel,{children:"Cancel"}),(0,s.jsx)(w.AlertDialogAction,{onClick:ez,disabled:ek,children:ek?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):"Send Reset Email"})]})]})}),(0,s.jsx)(w.AlertDialog,{open:eb,onOpenChange:eA,children:(0,s.jsxs)(w.AlertDialogContent,{children:[(0,s.jsxs)(w.AlertDialogHeader,{children:[(0,s.jsx)(w.AlertDialogTitle,{children:"Deactivate User"}),(0,s.jsxs)(w.AlertDialogDescription,{children:["Are you sure you want to deactivate ",(0,s.jsx)("strong",{children:eN?.displayName}),"? This user will no longer be able to access the platform. This action can be reversed by reactivating the user."]})]}),(0,s.jsxs)(w.AlertDialogFooter,{children:[(0,s.jsx)(w.AlertDialogCancel,{children:"Cancel"}),(0,s.jsx)(w.AlertDialogAction,{onClick:eP,disabled:ek,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:ek?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Deactivating..."]}):"Deactivate"})]})]})}),(0,s.jsx)(w.AlertDialog,{open:eD,onOpenChange:eI,children:(0,s.jsxs)(w.AlertDialogContent,{children:[(0,s.jsxs)(w.AlertDialogHeader,{children:[(0,s.jsx)(w.AlertDialogTitle,{children:"Reactivate User"}),(0,s.jsxs)(w.AlertDialogDescription,{children:["Are you sure you want to reactivate ",(0,s.jsx)("strong",{children:eN?.displayName}),"? This will restore their access to the platform."]})]}),(0,s.jsxs)(w.AlertDialogFooter,{children:[(0,s.jsx)(w.AlertDialogCancel,{children:"Cancel"}),(0,s.jsx)(w.AlertDialogAction,{onClick:eB,disabled:ek,className:"bg-green-600 text-white hover:bg-green-700",children:ek?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Reactivating..."]}):"Reactivate"})]})]})})]})}e.s(["default",()=>es],275630)},953117,e=>{e.n(e.i(275630))}]);