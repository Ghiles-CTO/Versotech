(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73215,e=>{"use strict";var t=e.i(722679),s=e.i(340915),a=e.i(90613),r=e.i(316264),l=e.i(129432),n=e.i(429760),d=e.i(661521),i=e.i(396132),o=e.i(551544),c=e.i(971743),m=e.i(704477),u=e.i(84065),x=e.i(196767),h=e.i(119311),g=e.i(733179),p=e.i(788135),f=e.i(820417),b=e.i(352776),j=e.i(191569),N=e.i(514133),_=e.i(538892),v=e.i(816654),y=e.i(994500),C=e.i(907434);function w({subscription:e,open:a,onOpenChange:l,onSuccess:d}){let[i,o]=(0,s.useState)(!1),[c,m]=(0,s.useState)({status:e.status||"pending",effective_date:e.effective_date||"",committed_at:e.committed_at||"",funding_due_at:e.funding_due_at||"",contract_date:e.contract_date||"",opportunity_name:e.opportunity_name||"",sourcing_contract_ref:e.sourcing_contract_ref||"",commitment:e.commitment?.toString()||"0",currency:e.currency||"USD",units:e.units?.toString()||"",num_shares:e.num_shares?.toString()||"",price_per_share:e.price_per_share?.toString()||"",cost_per_share:e.cost_per_share?.toString()||"",spread_per_share:e.spread_per_share?.toString()||"",spread_fee_amount:e.spread_fee_amount?.toString()||"",subscription_fee_percent:e.subscription_fee_percent?.toString()||"",subscription_fee_amount:e.subscription_fee_amount?.toString()||"",bd_fee_percent:e.bd_fee_percent?.toString()||"",bd_fee_amount:e.bd_fee_amount?.toString()||"",finra_fee_amount:e.finra_fee_amount?.toString()||"",performance_fee_tier1_percent:e.performance_fee_tier1_percent?.toString()||"",performance_fee_tier1_threshold:e.performance_fee_tier1_threshold?.toString()||"",performance_fee_tier2_percent:e.performance_fee_tier2_percent?.toString()||"",performance_fee_tier2_threshold:e.performance_fee_tier2_threshold?.toString()||"",funded_amount:e.funded_amount?.toString()||"0",outstanding_amount:e.outstanding_amount?.toString()||"",capital_calls_total:e.capital_calls_total?.toString()||"0",distributions_total:e.distributions_total?.toString()||"0",current_nav:e.current_nav?.toString()||"",introducer_id:e.introducer_id||"",introduction_id:e.introduction_id||"",acknowledgement_notes:e.acknowledgement_notes||""});(0,s.useEffect)(()=>{let e=parseFloat(c.price_per_share)||0,t=parseFloat(c.cost_per_share)||0,s=parseFloat(c.num_shares)||0;if(e>0&&t>0){let a=e-t,r=a*s;m(e=>({...e,spread_per_share:a.toFixed(6),spread_fee_amount:r.toFixed(2)}))}},[c.price_per_share,c.cost_per_share,c.num_shares]);let u=async t=>{t.preventDefault(),o(!0);try{let t={status:c.status,effective_date:c.effective_date||null,committed_at:c.committed_at||null,funding_due_at:c.funding_due_at||null,contract_date:c.contract_date||null,opportunity_name:c.opportunity_name||null,sourcing_contract_ref:c.sourcing_contract_ref||null,commitment:parseFloat(c.commitment),currency:c.currency,units:c.units?parseFloat(c.units):null,num_shares:c.num_shares?parseFloat(c.num_shares):null,price_per_share:c.price_per_share?parseFloat(c.price_per_share):null,cost_per_share:c.cost_per_share?parseFloat(c.cost_per_share):null,spread_per_share:c.spread_per_share?parseFloat(c.spread_per_share):null,spread_fee_amount:c.spread_fee_amount?parseFloat(c.spread_fee_amount):null,subscription_fee_percent:c.subscription_fee_percent?parseFloat(c.subscription_fee_percent):null,subscription_fee_amount:c.subscription_fee_amount?parseFloat(c.subscription_fee_amount):null,bd_fee_percent:c.bd_fee_percent?parseFloat(c.bd_fee_percent):null,bd_fee_amount:c.bd_fee_amount?parseFloat(c.bd_fee_amount):null,finra_fee_amount:c.finra_fee_amount?parseFloat(c.finra_fee_amount):null,performance_fee_tier1_percent:c.performance_fee_tier1_percent?parseFloat(c.performance_fee_tier1_percent):null,performance_fee_tier1_threshold:c.performance_fee_tier1_threshold?parseFloat(c.performance_fee_tier1_threshold):null,performance_fee_tier2_percent:c.performance_fee_tier2_percent?parseFloat(c.performance_fee_tier2_percent):null,performance_fee_tier2_threshold:c.performance_fee_tier2_threshold?parseFloat(c.performance_fee_tier2_threshold):null,funded_amount:parseFloat(c.funded_amount),outstanding_amount:c.outstanding_amount?parseFloat(c.outstanding_amount):null,capital_calls_total:parseFloat(c.capital_calls_total),distributions_total:parseFloat(c.distributions_total),current_nav:c.current_nav?parseFloat(c.current_nav):null,introducer_id:c.introducer_id||null,introduction_id:c.introduction_id||null,acknowledgement_notes:c.acknowledgement_notes||null},s=await fetch(`/api/subscriptions/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to update subscription")}y.toast.success("Subscription updated successfully"),d(),l(!1)}catch(e){console.error("Update error:",e),y.toast.error(e instanceof Error?e.message:"Failed to update subscription")}finally{o(!1)}};return(0,t.jsx)(b.Dialog,{open:a,onOpenChange:l,children:(0,t.jsxs)(b.DialogContent,{className:"w-[calc(100vw-2rem)] sm:max-w-5xl max-h-[90vh] bg-card text-foreground border-border",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsxs)(b.DialogTitle,{className:"text-foreground",children:["Edit Subscription #",e.subscription_number]}),(0,t.jsxs)(b.DialogDescription,{className:"text-muted-foreground",children:["Update all subscription details for ",e.investor?.legal_name||"Unknown Investor"]})]}),(0,t.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,t.jsxs)(n.Tabs,{defaultValue:"basic",className:"w-full",id:`subscription-edit-tabs-${e.id}`,children:[(0,t.jsxs)(n.TabsList,{className:"grid w-full grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-7 bg-muted",children:[(0,t.jsx)(n.TabsTrigger,{value:"basic",className:"text-xs",children:"Basic"}),(0,t.jsx)(n.TabsTrigger,{value:"financial",className:"text-xs",children:"Financial"}),(0,t.jsx)(n.TabsTrigger,{value:"shares",className:"text-xs",children:"Shares"}),(0,t.jsx)(n.TabsTrigger,{value:"fees",className:"text-xs",children:"Fees"}),(0,t.jsx)(n.TabsTrigger,{value:"tracking",className:"text-xs",children:"Tracking"}),(0,t.jsx)(n.TabsTrigger,{value:"relationships",className:"text-xs",children:"Relations"}),(0,t.jsx)(n.TabsTrigger,{value:"notes",className:"text-xs",children:"Notes"})]}),(0,t.jsxs)(C.ScrollArea,{className:"h-[400px] pr-4",children:[(0,t.jsx)(n.TabsContent,{value:"basic",className:"space-y-4 mt-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"status",className:"text-foreground",children:"Status *"}),(0,t.jsxs)(_.Select,{value:c.status,onValueChange:e=>m({...c,status:e}),children:[(0,t.jsx)(_.SelectTrigger,{id:"status",className:"bg-muted border-border text-foreground",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{className:"bg-muted border-border",children:[(0,t.jsx)(_.SelectItem,{value:"pending",className:"text-foreground",children:"Pending"}),(0,t.jsx)(_.SelectItem,{value:"committed",className:"text-foreground",children:"Committed"}),(0,t.jsx)(_.SelectItem,{value:"partially_funded",className:"text-foreground",children:"Partially Funded"}),(0,t.jsx)(_.SelectItem,{value:"funded",className:"text-foreground",children:"Funded"}),(0,t.jsx)(_.SelectItem,{value:"active",className:"text-foreground",children:"Active"}),(0,t.jsx)(_.SelectItem,{value:"closed",className:"text-foreground",children:"Closed"}),(0,t.jsx)(_.SelectItem,{value:"cancelled",className:"text-foreground",children:"Cancelled"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"opportunity_name",className:"text-foreground",children:"Opportunity Name"}),(0,t.jsx)(j.Input,{id:"opportunity_name",type:"text",value:c.opportunity_name,onChange:e=>m({...c,opportunity_name:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Deal or opportunity name"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"effective_date",className:"text-foreground",children:"Effective Date"}),(0,t.jsx)(j.Input,{id:"effective_date",type:"date",value:c.effective_date,onChange:e=>m({...c,effective_date:e.target.value}),className:"bg-muted border-border text-foreground"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"committed_at",className:"text-foreground",children:"Committed Date"}),(0,t.jsx)(j.Input,{id:"committed_at",type:"date",value:c.committed_at,onChange:e=>m({...c,committed_at:e.target.value}),className:"bg-muted border-border text-foreground"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"funding_due_at",className:"text-foreground",children:"Funding Due Date"}),(0,t.jsx)(j.Input,{id:"funding_due_at",type:"date",value:c.funding_due_at,onChange:e=>m({...c,funding_due_at:e.target.value}),className:"bg-muted border-border text-foreground"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"contract_date",className:"text-foreground",children:"Contract Date"}),(0,t.jsx)(j.Input,{id:"contract_date",type:"date",value:c.contract_date,onChange:e=>m({...c,contract_date:e.target.value}),className:"bg-muted border-border text-foreground"})]}),(0,t.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,t.jsx)(N.Label,{htmlFor:"sourcing_contract_ref",className:"text-foreground",children:"Sourcing Contract Reference"}),(0,t.jsx)(j.Input,{id:"sourcing_contract_ref",type:"text",value:c.sourcing_contract_ref,onChange:e=>m({...c,sourcing_contract_ref:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"External contract reference"})]})]})}),(0,t.jsx)(n.TabsContent,{value:"financial",className:"space-y-4 mt-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"commitment",className:"text-foreground",children:"Commitment Amount *"}),(0,t.jsx)(j.Input,{id:"commitment",type:"number",step:"0.01",value:c.commitment,onChange:e=>m({...c,commitment:e.target.value}),className:"bg-muted border-border text-foreground",required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"currency",className:"text-foreground",children:"Currency *"}),(0,t.jsxs)(_.Select,{value:c.currency,onValueChange:e=>m({...c,currency:e}),children:[(0,t.jsx)(_.SelectTrigger,{id:"currency",className:"bg-muted border-border text-foreground",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{className:"bg-muted border-border",children:[(0,t.jsx)(_.SelectItem,{value:"USD",className:"text-foreground",children:"USD"}),(0,t.jsx)(_.SelectItem,{value:"EUR",className:"text-foreground",children:"EUR"}),(0,t.jsx)(_.SelectItem,{value:"GBP",className:"text-foreground",children:"GBP"}),(0,t.jsx)(_.SelectItem,{value:"AUD",className:"text-foreground",children:"AUD"}),(0,t.jsx)(_.SelectItem,{value:"CAD",className:"text-foreground",children:"CAD"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,t.jsx)(N.Label,{htmlFor:"units",className:"text-foreground",children:"Units"}),(0,t.jsx)(j.Input,{id:"units",type:"number",step:"0.01",value:c.units,onChange:e=>m({...c,units:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Number of units"})]})]})}),(0,t.jsx)(n.TabsContent,{value:"shares",className:"space-y-4 mt-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"num_shares",className:"text-foreground",children:"Number of Shares"}),(0,t.jsx)(j.Input,{id:"num_shares",type:"number",step:"1",value:c.num_shares,onChange:e=>m({...c,num_shares:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Total shares"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"price_per_share",className:"text-foreground",children:"Price Per Share"}),(0,t.jsx)(j.Input,{id:"price_per_share",type:"number",step:"0.01",value:c.price_per_share,onChange:e=>m({...c,price_per_share:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Sell price"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"cost_per_share",className:"text-foreground",children:"Cost Per Share"}),(0,t.jsx)(j.Input,{id:"cost_per_share",type:"number",step:"0.01",value:c.cost_per_share,onChange:e=>m({...c,cost_per_share:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Acquisition cost"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(N.Label,{htmlFor:"spread_per_share",className:"text-foreground",children:["Spread Per Share",(0,t.jsx)("span",{className:"ml-2 text-xs text-amber-400",children:"(auto-calculated)"})]}),(0,t.jsx)(j.Input,{id:"spread_per_share",type:"number",step:"0.01",value:c.spread_per_share,onChange:e=>m({...c,spread_per_share:e.target.value}),className:"bg-muted border-amber-500/30 text-foreground",placeholder:"Spread markup"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground/70",children:"Price − Cost (can override)"})]}),(0,t.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,t.jsxs)(N.Label,{htmlFor:"spread_fee_amount",className:"text-foreground",children:["Spread Fee Amount",(0,t.jsx)("span",{className:"ml-2 text-xs text-amber-400",children:"(auto-calculated)"})]}),(0,t.jsx)(j.Input,{id:"spread_fee_amount",type:"number",step:"0.01",value:c.spread_fee_amount,onChange:e=>m({...c,spread_fee_amount:e.target.value}),className:"bg-muted border-amber-500/30 text-foreground",placeholder:"Total spread fee"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground/70",children:"Spread × Shares (can override)"})]})]})}),(0,t.jsx)(n.TabsContent,{value:"fees",className:"space-y-4 mt-4",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Subscription Fees"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"subscription_fee_percent",className:"text-foreground",children:"Subscription Fee %"}),(0,t.jsx)(j.Input,{id:"subscription_fee_percent",type:"number",step:"0.01",value:c.subscription_fee_percent,onChange:e=>m({...c,subscription_fee_percent:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"e.g., 2.0"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"subscription_fee_amount",className:"text-foreground",children:"Subscription Fee Amount"}),(0,t.jsx)(j.Input,{id:"subscription_fee_amount",type:"number",step:"0.01",value:c.subscription_fee_amount,onChange:e=>m({...c,subscription_fee_amount:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Fixed amount"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Broker-Dealer Fees"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"bd_fee_percent",className:"text-foreground",children:"BD Fee %"}),(0,t.jsx)(j.Input,{id:"bd_fee_percent",type:"number",step:"0.01",value:c.bd_fee_percent,onChange:e=>m({...c,bd_fee_percent:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"e.g., 1.5"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"bd_fee_amount",className:"text-foreground",children:"BD Fee Amount"}),(0,t.jsx)(j.Input,{id:"bd_fee_amount",type:"number",step:"0.01",value:c.bd_fee_amount,onChange:e=>m({...c,bd_fee_amount:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Fixed amount"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Regulatory Fees"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"finra_fee_amount",className:"text-foreground",children:"FINRA Fee Amount"}),(0,t.jsx)(j.Input,{id:"finra_fee_amount",type:"number",step:"0.01",value:c.finra_fee_amount,onChange:e=>m({...c,finra_fee_amount:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"FINRA regulatory fee"})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Performance Fees (Tier Structure)"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"performance_fee_tier1_percent",className:"text-foreground",children:"Tier 1 %"}),(0,t.jsx)(j.Input,{id:"performance_fee_tier1_percent",type:"number",step:"0.01",value:c.performance_fee_tier1_percent,onChange:e=>m({...c,performance_fee_tier1_percent:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"e.g., 20.0"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"performance_fee_tier1_threshold",className:"text-foreground",children:"Tier 1 Threshold"}),(0,t.jsx)(j.Input,{id:"performance_fee_tier1_threshold",type:"number",step:"0.01",value:c.performance_fee_tier1_threshold,onChange:e=>m({...c,performance_fee_tier1_threshold:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Hurdle amount"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"performance_fee_tier2_percent",className:"text-foreground",children:"Tier 2 %"}),(0,t.jsx)(j.Input,{id:"performance_fee_tier2_percent",type:"number",step:"0.01",value:c.performance_fee_tier2_percent,onChange:e=>m({...c,performance_fee_tier2_percent:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"e.g., 30.0"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"performance_fee_tier2_threshold",className:"text-foreground",children:"Tier 2 Threshold"}),(0,t.jsx)(j.Input,{id:"performance_fee_tier2_threshold",type:"number",step:"0.01",value:c.performance_fee_tier2_threshold,onChange:e=>m({...c,performance_fee_tier2_threshold:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Higher hurdle"})]})]})]})]})}),(0,t.jsx)(n.TabsContent,{value:"tracking",className:"space-y-4 mt-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"funded_amount",className:"text-foreground",children:"Funded Amount"}),(0,t.jsx)(j.Input,{id:"funded_amount",type:"number",step:"0.01",value:c.funded_amount,onChange:e=>m({...c,funded_amount:e.target.value}),className:"bg-muted border-border text-foreground"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"outstanding_amount",className:"text-foreground",children:"Outstanding Amount"}),(0,t.jsx)(j.Input,{id:"outstanding_amount",type:"number",step:"0.01",value:c.outstanding_amount,onChange:e=>m({...c,outstanding_amount:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Unfunded commitment"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"capital_calls_total",className:"text-foreground",children:"Capital Calls Total"}),(0,t.jsx)(j.Input,{id:"capital_calls_total",type:"number",step:"0.01",value:c.capital_calls_total,onChange:e=>m({...c,capital_calls_total:e.target.value}),className:"bg-muted border-border text-foreground"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"distributions_total",className:"text-foreground",children:"Distributions Total"}),(0,t.jsx)(j.Input,{id:"distributions_total",type:"number",step:"0.01",value:c.distributions_total,onChange:e=>m({...c,distributions_total:e.target.value}),className:"bg-muted border-border text-foreground"})]}),(0,t.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,t.jsx)(N.Label,{htmlFor:"current_nav",className:"text-foreground",children:"Current NAV"}),(0,t.jsx)(j.Input,{id:"current_nav",type:"number",step:"0.01",value:c.current_nav,onChange:e=>m({...c,current_nav:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"Current net asset value"})]})]})}),(0,t.jsx)(n.TabsContent,{value:"relationships",className:"space-y-4 mt-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,t.jsx)(N.Label,{htmlFor:"introducer_id",className:"text-foreground",children:"Introducer ID"}),(0,t.jsx)(j.Input,{id:"introducer_id",type:"text",value:c.introducer_id,onChange:e=>m({...c,introducer_id:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"UUID of introducer"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground/70",children:"Link to introducer who referred this subscription"})]}),(0,t.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,t.jsx)(N.Label,{htmlFor:"introduction_id",className:"text-foreground",children:"Introduction ID"}),(0,t.jsx)(j.Input,{id:"introduction_id",type:"text",value:c.introduction_id,onChange:e=>m({...c,introduction_id:e.target.value}),className:"bg-muted border-border text-foreground",placeholder:"UUID of introduction record"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground/70",children:"Link to specific introduction event"})]})]})}),(0,t.jsx)(n.TabsContent,{value:"notes",className:"space-y-4 mt-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"notes",className:"text-foreground",children:"Acknowledgement Notes"}),(0,t.jsx)(v.Textarea,{id:"notes",value:c.acknowledgement_notes,onChange:e=>m({...c,acknowledgement_notes:e.target.value}),className:"bg-muted border-border text-foreground min-h-[300px]",placeholder:"Add any notes, acknowledgements, or special terms for this subscription..."})]})})]})]}),(0,t.jsxs)(b.DialogFooter,{children:[(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:i,className:"bg-muted text-foreground border-border hover:bg-muted/80",children:"Cancel"}),(0,t.jsx)(r.Button,{type:"submit",disabled:i,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:i?"Saving...":"Save All Changes"})]})]})]})})}var S=e.i(908925),F=e.i(237635),T=e.i(410587);let k=(0,T.default)("circle-arrow-down",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]),D=(0,T.default)("circle-arrow-up",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);var I=e.i(703281),L=e.i(831833),A=e.i(554369),B=e.i(603274);function U({cashflows:e,capitalCalls:a,distributions:d,currency:i,vehicleId:o,investorId:c,isStaff:m=!1}){let u=(0,B.useRouter)(),[x,h]=(0,s.useState)({open:!1,type:null}),[g,p]=(0,s.useState)({open:!1,type:null,data:null}),[f,v]=(0,s.useState)({open:!1,type:null,id:null}),[C,w]=(0,s.useState)({}),[T,U]=(0,s.useState)(!1),E=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:i||"USD",minimumFractionDigits:2}).format(e),P=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),R=async()=>{if(x.type){U(!0);try{let e="cashflow"===x.type?"/api/cashflows":"capitalCall"===x.type?"/api/capital-calls":"/api/distributions",t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to create");y.toast.success(`${"cashflow"===x.type?"Cashflow":"capitalCall"===x.type?"Capital call":"Distribution"} created successfully`),h({open:!1,type:null}),w({}),u.refresh()}catch(e){y.toast.error(e.message||"Failed to create")}finally{U(!1)}}},H=async()=>{if(g.type&&g.data?.id){U(!0);try{let e="cashflow"===g.type?`/api/cashflows/${g.data.id}`:"capitalCall"===g.type?`/api/capital-calls/${g.data.id}`:`/api/distributions/${g.data.id}`,t=await fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to update");y.toast.success(`${"cashflow"===g.type?"Cashflow":"capitalCall"===g.type?"Capital call":"Distribution"} updated successfully`),p({open:!1,type:null,data:null}),w({}),u.refresh()}catch(e){y.toast.error(e.message||"Failed to update")}finally{U(!1)}}},O=async()=>{if(f.type&&f.id){U(!0);try{let e="cashflow"===f.type?`/api/cashflows/${f.id}`:"capitalCall"===f.type?`/api/capital-calls/${f.id}`:`/api/distributions/${f.id}`,t=await fetch(e,{method:"DELETE"}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to delete");y.toast.success(`${"cashflow"===f.type?"Cashflow":"capitalCall"===f.type?"Capital call":"Distribution"} deleted successfully`),v({open:!1,type:null,id:null}),u.refresh()}catch(e){y.toast.error(e.message||"Failed to delete")}finally{U(!1)}}},$=e=>{w("cashflow"===e?{investor_id:c,vehicle_id:o,type:"call",amount:0,date:""}:"capitalCall"===e?{vehicle_id:o,name:"",call_pct:0,due_date:"",status:"draft"}:{vehicle_id:o,name:"",amount:0,date:"",classification:""}),h({open:!0,type:e})},V=(e,t)=>{w(t),p({open:!0,type:e,data:t})},z=(e,t)=>{v({open:!0,type:e,id:t})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.Tabs,{defaultValue:"cashflows",className:"w-full",id:`capital-activity-tabs-${o}-${c}`,children:[(0,t.jsxs)(n.TabsList,{className:"bg-muted",children:[(0,t.jsxs)(n.TabsTrigger,{value:"cashflows",className:"data-[state=active]:bg-muted text-foreground",children:["Cashflows (",e.length,")"]}),(0,t.jsxs)(n.TabsTrigger,{value:"calls",className:"data-[state=active]:bg-muted text-foreground",children:["Capital Calls (",a.length,")"]}),(0,t.jsxs)(n.TabsTrigger,{value:"distributions",className:"data-[state=active]:bg-muted text-foreground",children:["Distributions (",d.length,")"]})]}),(0,t.jsxs)(n.TabsContent,{value:"cashflows",className:"mt-4",children:[m&&(0,t.jsx)("div",{className:"mb-4 flex justify-end",children:(0,t.jsxs)(r.Button,{onClick:()=>$("cashflow"),className:"bg-blue-600 hover:bg-blue-700",children:[(0,t.jsx)(L.Plus,{className:"h-4 w-4 mr-2"}),"Add Cashflow"]})}),(0,t.jsx)("div",{className:"rounded-md border border-border",children:(0,t.jsxs)(F.Table,{children:[(0,t.jsx)(F.TableHeader,{children:(0,t.jsxs)(F.TableRow,{className:"border-border hover:bg-muted/50",children:[(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Type"}),(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Date"}),(0,t.jsx)(F.TableHead,{className:"text-right text-muted-foreground",children:"Amount"}),m&&(0,t.jsx)(F.TableHead,{className:"text-right text-muted-foreground",children:"Actions"})]})}),(0,t.jsx)(F.TableBody,{children:e.length>0?e.map(e=>(0,t.jsxs)(F.TableRow,{className:"border-border hover:bg-muted/50",children:[(0,t.jsx)(F.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["contribution"===e.type||"call"===e.type?(0,t.jsx)(k,{className:"h-4 w-4 text-green-400"}):(0,t.jsx)(D,{className:"h-4 w-4 text-blue-400"}),(0,t.jsx)("span",{className:"capitalize text-foreground",children:e.type})]})}),(0,t.jsx)(F.TableCell,{className:"text-muted-foreground",children:P(e.date)}),(0,t.jsx)(F.TableCell,{className:"text-right font-semibold text-foreground",children:E(e.amount)}),m&&(0,t.jsx)(F.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>V("cashflow",e),className:"text-blue-400 hover:text-blue-300 hover:bg-blue-900/20",children:(0,t.jsx)(I.Edit2,{className:"h-4 w-4"})}),(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>z("cashflow",e.id),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:(0,t.jsx)(A.Trash2,{className:"h-4 w-4"})})]})})]},e.id)):(0,t.jsx)(F.TableRow,{children:(0,t.jsx)(F.TableCell,{colSpan:m?4:3,className:"text-center text-muted-foreground py-8",children:"No cashflows recorded yet"})})})]})})]}),(0,t.jsxs)(n.TabsContent,{value:"calls",className:"mt-4",children:[m&&(0,t.jsx)("div",{className:"mb-4 flex justify-end",children:(0,t.jsxs)(r.Button,{onClick:()=>$("capitalCall"),className:"bg-blue-600 hover:bg-blue-700",children:[(0,t.jsx)(L.Plus,{className:"h-4 w-4 mr-2"}),"Add Capital Call"]})}),(0,t.jsx)("div",{className:"rounded-md border border-border",children:(0,t.jsxs)(F.Table,{children:[(0,t.jsx)(F.TableHeader,{children:(0,t.jsxs)(F.TableRow,{className:"border-border hover:bg-muted/50",children:[(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Call Name"}),(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Call %"}),(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Due Date"}),(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Status"}),m&&(0,t.jsx)(F.TableHead,{className:"text-right text-muted-foreground",children:"Actions"})]})}),(0,t.jsx)(F.TableBody,{children:a.length>0?a.map(e=>(0,t.jsxs)(F.TableRow,{className:"border-border hover:bg-muted/50",children:[(0,t.jsx)(F.TableCell,{className:"font-medium text-foreground",children:e.name}),(0,t.jsxs)(F.TableCell,{className:"text-muted-foreground",children:[e.call_pct,"%"]}),(0,t.jsx)(F.TableCell,{className:"text-muted-foreground",children:P(e.due_date)}),(0,t.jsx)(F.TableCell,{children:(0,t.jsx)(l.Badge,{variant:"completed"===e.status?"default":"secondary",className:"completed"===e.status?"bg-green-900 text-green-200":"bg-yellow-900 text-yellow-200",children:e.status})}),m&&(0,t.jsx)(F.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>V("capitalCall",e),className:"text-blue-400 hover:text-blue-300 hover:bg-blue-900/20",children:(0,t.jsx)(I.Edit2,{className:"h-4 w-4"})}),(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>z("capitalCall",e.id),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:(0,t.jsx)(A.Trash2,{className:"h-4 w-4"})})]})})]},e.id)):(0,t.jsx)(F.TableRow,{children:(0,t.jsx)(F.TableCell,{colSpan:m?5:4,className:"text-center text-muted-foreground py-8",children:"No capital calls issued yet"})})})]})})]}),(0,t.jsxs)(n.TabsContent,{value:"distributions",className:"mt-4",children:[m&&(0,t.jsx)("div",{className:"mb-4 flex justify-end",children:(0,t.jsxs)(r.Button,{onClick:()=>$("distribution"),className:"bg-blue-600 hover:bg-blue-700",children:[(0,t.jsx)(L.Plus,{className:"h-4 w-4 mr-2"}),"Add Distribution"]})}),(0,t.jsx)("div",{className:"rounded-md border border-border",children:(0,t.jsxs)(F.Table,{children:[(0,t.jsx)(F.TableHeader,{children:(0,t.jsxs)(F.TableRow,{className:"border-border hover:bg-muted/50",children:[(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Distribution Name"}),(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Date"}),(0,t.jsx)(F.TableHead,{className:"text-muted-foreground",children:"Classification"}),(0,t.jsx)(F.TableHead,{className:"text-right text-muted-foreground",children:"Amount"}),m&&(0,t.jsx)(F.TableHead,{className:"text-right text-muted-foreground",children:"Actions"})]})}),(0,t.jsx)(F.TableBody,{children:d.length>0?d.map(e=>(0,t.jsxs)(F.TableRow,{className:"border-border hover:bg-muted/50",children:[(0,t.jsx)(F.TableCell,{className:"font-medium text-foreground",children:e.name}),(0,t.jsx)(F.TableCell,{className:"text-muted-foreground",children:P(e.date)}),(0,t.jsx)(F.TableCell,{children:(0,t.jsx)(l.Badge,{variant:"outline",className:"capitalize text-blue-300 border-blue-700",children:e.classification})}),(0,t.jsx)(F.TableCell,{className:"text-right font-semibold text-foreground",children:E(e.amount)}),m&&(0,t.jsx)(F.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>V("distribution",e),className:"text-blue-400 hover:text-blue-300 hover:bg-blue-900/20",children:(0,t.jsx)(I.Edit2,{className:"h-4 w-4"})}),(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>z("distribution",e.id),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:(0,t.jsx)(A.Trash2,{className:"h-4 w-4"})})]})})]},e.id)):(0,t.jsx)(F.TableRow,{children:(0,t.jsx)(F.TableCell,{colSpan:m?5:4,className:"text-center text-muted-foreground py-8",children:"No distributions made yet"})})})]})})]})]}),(0,t.jsx)(b.Dialog,{open:x.open||g.open,onOpenChange:e=>{e||(h({open:!1,type:null}),p({open:!1,type:null,data:null}),w({}))},children:(0,t.jsxs)(b.DialogContent,{className:"bg-card text-foreground border-border",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsxs)(b.DialogTitle,{children:[g.open?"Edit":"Create"," ","cashflow"===x.type||"cashflow"===g.type?"Cashflow":"capitalCall"===x.type||"capitalCall"===g.type?"Capital Call":"Distribution"]}),(0,t.jsx)(b.DialogDescription,{className:"text-muted-foreground",children:g.open?"Update the details below":"Fill in the details below"})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[("cashflow"===x.type||"cashflow"===g.type)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"type",children:"Type"}),(0,t.jsxs)(_.Select,{value:C.type||"call",onValueChange:e=>w({...C,type:e}),children:[(0,t.jsx)(_.SelectTrigger,{className:"bg-muted border-border",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{className:"bg-muted border-border",children:[(0,t.jsx)(_.SelectItem,{value:"call",children:"Call"}),(0,t.jsx)(_.SelectItem,{value:"distribution",children:"Distribution"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"amount",children:"Amount"}),(0,t.jsx)(j.Input,{id:"amount",type:"number",step:"0.01",value:C.amount||0,onChange:e=>w({...C,amount:parseFloat(e.target.value)}),className:"bg-muted border-border"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"date",children:"Date"}),(0,t.jsx)(j.Input,{id:"date",type:"date",value:C.date||"",onChange:e=>w({...C,date:e.target.value}),className:"bg-muted border-border"})]})]}),("capitalCall"===x.type||"capitalCall"===g.type)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"name",children:"Name"}),(0,t.jsx)(j.Input,{id:"name",value:C.name||"",onChange:e=>w({...C,name:e.target.value}),className:"bg-muted border-border"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"call_pct",children:"Call %"}),(0,t.jsx)(j.Input,{id:"call_pct",type:"number",step:"0.01",min:"0",max:"100",value:C.call_pct||0,onChange:e=>w({...C,call_pct:parseFloat(e.target.value)}),className:"bg-muted border-border"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"due_date",children:"Due Date"}),(0,t.jsx)(j.Input,{id:"due_date",type:"date",value:C.due_date||"",onChange:e=>w({...C,due_date:e.target.value}),className:"bg-muted border-border"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"status",children:"Status"}),(0,t.jsxs)(_.Select,{value:C.status||"draft",onValueChange:e=>w({...C,status:e}),children:[(0,t.jsx)(_.SelectTrigger,{className:"bg-muted border-border",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{className:"bg-muted border-border",children:[(0,t.jsx)(_.SelectItem,{value:"draft",children:"Draft"}),(0,t.jsx)(_.SelectItem,{value:"pending",children:"Pending"}),(0,t.jsx)(_.SelectItem,{value:"completed",children:"Completed"}),(0,t.jsx)(_.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]})]}),("distribution"===x.type||"distribution"===g.type)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"name",children:"Name"}),(0,t.jsx)(j.Input,{id:"name",value:C.name||"",onChange:e=>w({...C,name:e.target.value}),className:"bg-muted border-border"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"amount",children:"Amount"}),(0,t.jsx)(j.Input,{id:"amount",type:"number",step:"0.01",value:C.amount||0,onChange:e=>w({...C,amount:parseFloat(e.target.value)}),className:"bg-muted border-border"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"date",children:"Date"}),(0,t.jsx)(j.Input,{id:"date",type:"date",value:C.date||"",onChange:e=>w({...C,date:e.target.value}),className:"bg-muted border-border"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(N.Label,{htmlFor:"classification",children:"Classification"}),(0,t.jsx)(j.Input,{id:"classification",value:C.classification||"",onChange:e=>w({...C,classification:e.target.value}),className:"bg-muted border-border",placeholder:"e.g., Return of Capital, Income"})]})]})]}),(0,t.jsxs)(b.DialogFooter,{children:[(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>{h({open:!1,type:null}),p({open:!1,type:null,data:null}),w({})},disabled:T,className:"border-border text-muted-foreground hover:bg-muted",children:"Cancel"}),(0,t.jsx)(r.Button,{onClick:g.open?H:R,disabled:T,className:"bg-blue-600 hover:bg-blue-700",children:T?"Saving...":g.open?"Update":"Create"})]})]})}),(0,t.jsx)(S.AlertDialog,{open:f.open,onOpenChange:e=>{e||v({open:!1,type:null,id:null})},children:(0,t.jsxs)(S.AlertDialogContent,{className:"bg-card text-foreground border-border",children:[(0,t.jsxs)(S.AlertDialogHeader,{children:[(0,t.jsx)(S.AlertDialogTitle,{children:"Are you sure?"}),(0,t.jsxs)(S.AlertDialogDescription,{className:"text-muted-foreground",children:["This action cannot be undone. This will permanently delete this"," ","cashflow"===f.type?"cashflow":"capitalCall"===f.type?"capital call":"distribution","."]})]}),(0,t.jsxs)(S.AlertDialogFooter,{children:[(0,t.jsx)(S.AlertDialogCancel,{className:"border-border text-muted-foreground hover:bg-muted",children:"Cancel"}),(0,t.jsx)(S.AlertDialogAction,{onClick:O,disabled:T,className:"bg-red-600 hover:bg-red-700",children:T?"Deleting...":"Delete"})]})]})})]})}var E=e.i(396064),P=e.i(761722),R=e.i(80465),H=e.i(645855),O=e.i(401148),$=e.i(263229),V=e.i(932735),z=e.i(496383),M=e.i(262823),q=e.i(612374),J=e.i(780);let G=(0,T.default)("file-type",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 13v-1h6v1",key:"1bb014"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M11 18h2",key:"12mj7e"}]]);var K=e.i(663216),W=e.i(619962),X=e.i(56213),Y=e.i(80289),Z=e.i(35334),Q=e.i(501259),ee=e.i(773510),et=e.i(691974),es=e.i(310556);function ea({open:e,onOpenChange:a,subscriptionId:n,documentId:d,documentName:i,onConfirm:o}){let[m,u]=(0,s.useState)([]),[x,h]=(0,s.useState)(!0),[g,p]=(0,s.useState)(!1),[f,j]=(0,s.useState)(null),[_,v]=(0,s.useState)("individual"),[y,C]=(0,s.useState)(null),[w,S]=(0,s.useState)("ceo"),[F,T]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&k()},[e,n]);let k=async()=>{h(!0),j(null);try{let[e,t]=await Promise.all([fetch(`/api/subscriptions/${n}/signatories`),fetch(`/api/documents/${d}`)]);if(!e.ok)throw Error("Failed to fetch signatories");let s=await e.json(),a=(s.signatories||[]).filter(e=>e.is_signatory||e.is_primary);if(u(a),v(s.investor_type||"individual"),s.arranger?(C(s.arranger),S("arranger")):(C(null),S("ceo")),t.ok){let e=await t.json();e.countersigner_type&&(T({countersigner_type:e.countersigner_type,countersigner_name:e.countersigner_name,countersigner_title:e.countersigner_title}),S(e.countersigner_type))}}catch(e){j(e instanceof Error?e.message:"Unknown error")}finally{h(!1)}},D=async()=>{if(0===m.length)return void j("No signatories found for this investor");p(!0);try{let e=m.map(e=>e.id);await o(e,w,"arranger"===w&&y?y.id:void 0),a(!1)}catch(e){j(e instanceof Error?e.message:"Failed to send for signature")}finally{p(!1)}};return(0,t.jsx)(b.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(b.DialogContent,{className:"sm:max-w-[500px] bg-background border-border",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsxs)(b.DialogTitle,{className:"flex items-center gap-2 text-foreground",children:[(0,t.jsx)(Z.UserCheck,{className:"h-5 w-5 text-emerald-500"}),"Confirm Signatories"]}),(0,t.jsxs)(b.DialogDescription,{children:['The following signatories will receive signature requests for "',i,'"']})]}),(0,t.jsx)("div",{className:"py-4 space-y-4",children:x?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(X.Skeleton,{className:"h-12 w-full"}),(0,t.jsx)(X.Skeleton,{className:"h-12 w-full"})]}):f?(0,t.jsxs)(Y.Alert,{variant:"destructive",children:[(0,t.jsx)(O.AlertCircle,{className:"h-4 w-4"}),(0,t.jsx)(Y.AlertDescription,{children:f})]}):0===m.length?(0,t.jsxs)(Y.Alert,{className:"bg-amber-500/10 border-amber-500/30",children:[(0,t.jsx)(O.AlertCircle,{className:"h-4 w-4 text-amber-500"}),(0,t.jsx)(Y.AlertDescription,{className:"text-amber-700 dark:text-amber-200",children:"No designated signatories found for this investor. Please add signatories to the investor entity first."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(l.Badge,{variant:"outline",className:"border-emerald-500/50 text-emerald-400 bg-emerald-500/10",children:[(0,t.jsx)(Q.Users,{className:"h-3 w-3 mr-1"}),m.length," ",1===m.length?"Signatory":"Signatories"]})}),(0,t.jsx)("div",{className:"space-y-2 max-h-[250px] overflow-y-auto pr-2",children:m.map(e=>(0,t.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg border border-emerald-500/30 bg-emerald-500/10",children:[(0,t.jsx)(es.Check,{className:"h-5 w-5 text-emerald-500 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"font-medium text-foreground",children:e.full_name}),e.is_primary&&(0,t.jsx)(l.Badge,{variant:"outline",className:"text-xs border-blue-500/50 text-blue-400 bg-blue-500/10",children:"Primary"}),e.is_signatory&&!e.is_primary&&(0,t.jsx)(l.Badge,{variant:"outline",className:"text-xs border-emerald-500/50 text-emerald-400 bg-emerald-500/10",children:"Signatory"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(ee.Mail,{className:"h-3 w-3 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground truncate",children:e.email||"No email"})]}),e.role_title&&(0,t.jsx)("span",{className:"text-xs text-muted-foreground capitalize block mt-1",children:e.role_title})]})]},e.id))}),(0,t.jsxs)("div",{className:"space-y-3 pt-4 border-t border-border",children:[(0,t.jsx)(N.Label,{className:"text-sm font-medium text-foreground",children:"VERSO Signatories (Added Automatically)"}),(0,t.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg border border-blue-500/30 bg-blue-500/10",children:[(0,t.jsx)(es.Check,{className:"h-5 w-5 text-blue-500 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Building2,{className:"h-4 w-4 text-blue-400"}),(0,t.jsx)("span",{className:"font-medium text-foreground",children:"VERSO Capital 2 GP SARL"}),(0,t.jsx)(l.Badge,{variant:"outline",className:"text-xs border-blue-500/50 text-blue-400 bg-blue-500/10",children:"Issuer"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Signed by CEO on behalf of the Issuer"})]})]}),y&&(0,t.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg border border-emerald-500/30 bg-emerald-500/10",children:[(0,t.jsx)(es.Check,{className:"h-5 w-5 text-emerald-500 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(et.Briefcase,{className:"h-4 w-4 text-emerald-400"}),(0,t.jsx)("span",{className:"font-medium text-foreground",children:y.company_name||y.legal_name}),(0,t.jsx)(l.Badge,{variant:"outline",className:"text-xs border-emerald-500/50 text-emerald-400 bg-emerald-500/10",children:"Arranger"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Signed as Attorney under Clause 6"})]})]})]}),(0,t.jsxs)(Y.Alert,{className:"bg-blue-500/10 border-blue-500/30",children:[(0,t.jsx)(Q.Users,{className:"h-4 w-4 text-blue-500"}),(0,t.jsxs)(Y.AlertDescription,{className:"text-blue-700 dark:text-blue-200 text-sm",children:[m.length+1+ +!!y," signature requests will be created. The document will be marked complete after all parties have signed."]})]})]})}),(0,t.jsxs)(b.DialogFooter,{className:"flex-col sm:flex-row gap-2",children:[(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>a(!1),disabled:g,children:"Cancel"}),(0,t.jsx)(r.Button,{onClick:D,disabled:x||g||0===m.length,className:"gap-2 bg-emerald-500 hover:bg-emerald-600",children:g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Loader2,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.Send,{className:"h-4 w-4"}),"Send for Signature"]})})]})]})})}function er({subscriptionId:e}){let[n,d]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[c,m]=(0,s.useState)(!1),[u,x]=(0,s.useState)(null),[g,p]=(0,s.useState)(null),[f,v]=(0,s.useState)(!1),[C,w]=(0,s.useState)(null),[S,F]=(0,s.useState)(!1),[T,k]=(0,s.useState)(null),[D,I]=(0,s.useState)(!1),[L,A]=(0,s.useState)(null),[B,U]=(0,s.useState)("docx"),{isOpen:X,document:Y,previewUrl:Z,isLoading:Q,error:ee,openPreview:et,closePreview:es,downloadDocument:er}=(0,K.useDocumentViewer)(),el={draft:"bg-purple-100 dark:bg-purple-500/20 text-purple-700 dark:text-purple-200",final:"bg-cyan-100 dark:bg-cyan-500/20 text-cyan-700 dark:text-cyan-200",published:"bg-cyan-100 dark:bg-cyan-500/20 text-cyan-700 dark:text-cyan-200",pending_signature:"bg-amber-100 dark:bg-amber-500/20 text-amber-700 dark:text-amber-200",signed:"bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-200"},en={draft:(0,t.jsx)(H.Clock,{className:"h-4 w-4"}),final:(0,t.jsx)(R.CheckCircle,{className:"h-4 w-4"}),published:(0,t.jsx)(R.CheckCircle,{className:"h-4 w-4"}),pending_signature:(0,t.jsx)(O.AlertCircle,{className:"h-4 w-4"}),signed:(0,t.jsx)(R.CheckCircle,{className:"h-4 w-4"})},ed={draft:"Draft",final:"Final (Ready)",published:"Final (Ready)",pending_signature:"Pending Signatures",signed:"Fully Executed"},ei=(0,s.useCallback)(async()=>{o(!0);try{let t=await fetch(`/api/subscriptions/${e}/documents`);if(!t.ok)throw Error("Failed to fetch documents");let s=await t.json();d(s.documents||[])}catch(e){console.error("Error fetching documents:",e),y.toast.error("Failed to load documents")}finally{o(!1)}},[e]);(0,s.useEffect)(()=>{ei()},[e,ei]);let eo=async e=>{x(e.id);try{let t=await fetch(`/api/storage/download?bucket=deal-documents&path=${encodeURIComponent(e.file_key)}`);if(!t.ok)throw Error("Failed to download document");let s=await t.blob(),a=window.URL.createObjectURL(s),r=window.document.createElement("a");r.href=a,r.download=e.file_key.split("/").pop()||"document",window.document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(a),window.document.body.removeChild(r),y.toast.success("Document downloaded successfully")}catch(e){console.error("Error downloading document:",e),y.toast.error("Failed to download document")}finally{x(null)}},ec=async()=>{if(!C)return void y.toast.error("Please select a file to upload");m(!0);try{let t=new FormData;if(t.append("file",C),t.append("documentType","subscription_pack"),!(await fetch(`/api/subscriptions/${e}/documents/upload`,{method:"POST",body:t})).ok)throw Error("Failed to upload document");y.toast.success("Final subscription pack uploaded successfully"),v(!1),w(null),ei()}catch(e){console.error("Error uploading document:",e),y.toast.error("Failed to upload document")}finally{m(!1)}},em=async(t,s,a)=>{if(T){p(T.id);try{let r=t.filter(e=>"investor_primary"!==e),l=await fetch(`/api/subscriptions/${e}/documents/${T.id}/ready-for-signature`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signatory_member_ids:r.length>0?r:void 0,countersigner_type:s,arranger_id:a})});if(!l.ok){let e=await l.json();throw Error(e.error||"Failed to send for signature")}let n=await l.json(),d="arranger"===n.countersigner_type?`arranger (${n.countersigner_name})`:"CEO";y.toast.success(`Document sent to ${n.total_signatories} signatories for signature. Countersigner: ${d}`),console.log("Signature requests created:",n),ei()}catch(e){throw console.error("Error sending for signature:",e),y.toast.error(e instanceof Error?e.message:"Failed to send for signature"),e}finally{p(null),k(null)}}},eu=async()=>{I(!0);try{let t=await fetch(`/api/subscriptions/${e}/regenerate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({format:B})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to regenerate subscription pack")}let s=await t.json(),a=s.format?.toUpperCase()||B.toUpperCase();y.toast.success(`Subscription pack regenerated as ${a}`),console.log("Regeneration result:",s),ei()}catch(e){console.error("Error regenerating subscription pack:",e),y.toast.error(e instanceof Error?e.message:"Failed to regenerate subscription pack")}finally{I(!1)}},ex=async(t,s)=>{A(t);try{let s=await fetch(`/api/subscriptions/${e}/documents/${t}/mark-final`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to update document status")}let a=await s.json();"finalized"===a.action?y.toast.success("Document marked as final - ready for signature"):y.toast.success("Document reverted to draft"),ei()}catch(e){console.error("Error updating document status:",e),y.toast.error(e instanceof Error?e.message:"Failed to update document status")}finally{A(null)}},eh=e=>e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`;return(n.some(e=>"final"===e.status||"published"===e.status||"pending_signature"===e.status||"signed"===e.status),i)?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)($.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(a.Card,{className:"border border-border bg-muted/50",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(a.CardTitle,{className:"text-foreground flex items-center gap-2",children:[(0,t.jsx)(h.FileText,{className:"h-5 w-5"}),"Subscription Pack Documents"]}),(0,t.jsx)(a.CardDescription,{children:"Manage draft and final subscription pack documents"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)(_.Select,{value:B,onValueChange:e=>U(e),disabled:D,children:[(0,t.jsx)(_.SelectTrigger,{className:"w-[100px] h-9 bg-muted/50 border-border",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{className:"bg-background border-border",children:[(0,t.jsx)(_.SelectItem,{value:"docx",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(G,{className:"h-3 w-3"}),"DOCX"]})}),(0,t.jsx)(_.SelectItem,{value:"pdf",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(h.FileText,{className:"h-3 w-3"}),"PDF"]})})]})]}),(0,t.jsx)(r.Button,{variant:"outline",className:"gap-2",onClick:eu,disabled:D,children:D?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Loader2,{className:"h-4 w-4 animate-spin"}),"Regenerating..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M.RefreshCw,{className:"h-4 w-4"}),"Regenerate"]})})]}),(0,t.jsxs)(b.Dialog,{open:f,onOpenChange:v,children:[(0,t.jsx)(b.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(r.Button,{className:"gap-2",children:[(0,t.jsx)(E.Upload,{className:"h-4 w-4"}),"Upload Final Pack"]})}),(0,t.jsxs)(b.DialogContent,{className:"bg-background border border-border",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsx)(b.DialogTitle,{className:"text-foreground",children:"Upload Final Subscription Pack"}),(0,t.jsx)(b.DialogDescription,{children:"Upload the edited and finalized subscription pack PDF"})]}),(0,t.jsx)("div",{className:"space-y-4 py-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N.Label,{htmlFor:"file",className:"text-foreground",children:"Document File"}),(0,t.jsx)(j.Input,{id:"file",type:"file",accept:".pdf",onChange:e=>{let t=e.target.files?.[0];if(t){if(!("application/pdf"===t.type||t.name.toLowerCase().endsWith(".pdf")))return void y.toast.error("Please upload a PDF file");w(t)}},className:"bg-muted/50 border-border text-foreground"}),C&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Selected: ",C.name," (",eh(C.size),")"]})]})}),(0,t.jsxs)(b.DialogFooter,{children:[(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>v(!1),disabled:c,children:"Cancel"}),(0,t.jsx)(r.Button,{onClick:ec,disabled:!C||c,className:"gap-2",children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Loader2,{className:"h-4 w-4 animate-spin"}),"Uploading..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.Upload,{className:"h-4 w-4"}),"Upload Final"]})})]})]})]})]})]})}),(0,t.jsx)(a.CardContent,{children:0===n.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(h.FileText,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-2",children:"No documents generated yet"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Draft subscription pack will be generated automatically when subscription is approved"})]}):(0,t.jsx)("div",{className:"space-y-3",children:n.map(e=>(0,t.jsxs)("div",{className:"flex items-start justify-between py-4 px-4 rounded-lg border border-border bg-muted/50 hover:bg-muted transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,t.jsx)(h.FileText,{className:"h-5 w-5 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"font-medium text-foreground",children:e.name}),(0,t.jsx)(l.Badge,{className:el[e.status],children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[en[e.status],ed[e.status]]})})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[eh(e.file_size_bytes)," •",e.mime_type.includes("pdf")?" PDF":" DOCX"]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Uploaded ",new Date(e.created_at).toLocaleDateString()," at"," ",new Date(e.created_at).toLocaleTimeString(),e.created_by_profile&&` by ${e.created_by_profile.display_name}`]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(r.Button,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>et({id:e.id,name:e.name,file_name:e.name,mime_type:e.mime_type,file_size_bytes:e.file_size_bytes,type:e.type}),children:[(0,t.jsx)(z.Eye,{className:"h-4 w-4"}),"View"]}),(0,t.jsx)(r.Button,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>eo(e),disabled:u===e.id,children:u===e.id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Loader2,{className:"h-4 w-4 animate-spin"}),"Downloading..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Download,{className:"h-4 w-4"}),"Download"]})}),("draft"===e.status||"final"===e.status||"published"===e.status)&&(0,t.jsx)(r.Button,{variant:"final"===e.status||"published"===e.status?"outline":"default",size:"sm",className:"final"===e.status||"published"===e.status?"gap-2 border-amber-500/50 text-amber-400 hover:bg-amber-500/10":"gap-2 bg-cyan-600 hover:bg-cyan-700",onClick:()=>ex(e.id,e.status),disabled:L===e.id,children:L===e.id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Loader2,{className:"h-4 w-4 animate-spin"}),"final"===e.status||"published"===e.status?"Reverting...":"Marking..."]}):"final"===e.status||"published"===e.status?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(J.RotateCcw,{className:"h-4 w-4"}),"Revert to Draft"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q.BadgeCheck,{className:"h-4 w-4"}),"Mark as Final"]})}),("final"===e.status||"published"===e.status)&&!e.ready_for_signature&&(0,t.jsx)(r.Button,{variant:"default",size:"sm",className:"gap-2 bg-emerald-500 hover:bg-emerald-600",onClick:()=>{k(e),F(!0)},disabled:g===e.id,children:g===e.id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Loader2,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.Send,{className:"h-4 w-4"}),"Ready for Signature"]})})]})]},e.id))})})]}),(0,t.jsxs)(a.Card,{className:"border border-border bg-muted/50",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-sm text-foreground",children:"Subscription Pack Workflow"})}),(0,t.jsx)(a.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-purple-500/20 text-purple-200 flex items-center justify-center text-xs font-bold",children:"1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-foreground",children:"Draft Generation"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"System automatically generates draft subscription pack when subscription is approved"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-cyan-500/20 text-cyan-200 flex items-center justify-center text-xs font-bold",children:"2"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-foreground",children:"Staff Review & Edit"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Download draft, work with lawyers to finalize, then upload the final PDF"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-amber-500/20 text-amber-200 flex items-center justify-center text-xs font-bold",children:"3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-foreground",children:"Send for Signatures"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:'Click "Ready for Signature" to initiate dual-signature workflow (investor + staff)'})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-emerald-500/20 text-emerald-200 flex items-center justify-center text-xs font-bold",children:"4"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-foreground",children:"Execution Complete"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:'Once both parties sign, subscription status automatically changes to "committed"'})]})]})]})})]}),(0,t.jsx)(W.DocumentViewerFullscreen,{isOpen:X,document:Y,previewUrl:Z,isLoading:Q,error:ee,onClose:es,onDownload:er}),T&&(0,t.jsx)(ea,{open:S,onOpenChange:e=>{F(e),e||k(null)},subscriptionId:e,documentId:T.id,documentName:T.name,onConfirm:em})]})}function el({subscription:e,cashflows:b,capitalCalls:j,distributions:N,metrics:_}){let[v,y]=(0,s.useState)(!1),C=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency||"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),S=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-";return(0,t.jsxs)("div",{className:"min-h-screen bg-background text-foreground p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(f.default,{href:"/versotech_main/subscriptions",children:(0,t.jsxs)(r.Button,{variant:"outline",size:"sm",className:"bg-muted text-foreground border-border hover:bg-muted",children:[(0,t.jsx)(i.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Subscriptions"]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-foreground",children:["Subscription #",e.subscription_number]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[e.investor?.legal_name||"Unknown Investor"," · ",e.vehicle?.name||"No Vehicle"]})]})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsxs)(r.Button,{onClick:()=>y(!0),className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[(0,t.jsx)(o.Edit,{className:"h-4 w-4 mr-2"}),"Edit Subscription"]})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(l.Badge,{className:{active:"bg-green-500/20 text-green-600 dark:text-green-400",committed:"bg-blue-500/20 text-blue-600 dark:text-blue-400",pending:"bg-yellow-500/20 text-yellow-600 dark:text-yellow-400",closed:"bg-muted text-muted-foreground",cancelled:"bg-red-500/20 text-red-600 dark:text-red-400"}[e.status]||"bg-muted text-muted-foreground",children:e.status.toUpperCase()}),e.investor?.kyc_status&&(0,t.jsxs)(l.Badge,{variant:"outline",className:"border-border text-muted-foreground",children:["KYC: ",e.investor.kyc_status]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{className:"pb-3",children:(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Commitment"})}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-foreground",children:C(_.total_commitment)}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[(0,t.jsx)(x.DollarSign,{className:"h-3 w-3"}),e.currency]})]})]}),(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{className:"pb-3",children:(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Contributed"})}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-400",children:C(_.total_contributed)}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[(0,t.jsx)(g.TrendingUp,{className:"h-3 w-3"}),_.total_contributed>0?`${(_.total_contributed/_.total_commitment*100).toFixed(1)}% funded`:"No contributions"]})]})]}),(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{className:"pb-3",children:(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Unfunded"})}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:C(_.unfunded_commitment)}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[(0,t.jsx)(p.Minus,{className:"h-3 w-3"}),"Remaining commitment"]})]})]}),(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{className:"pb-3",children:(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Current NAV"})}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:C(_.current_nav)}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[(0,t.jsx)(g.TrendingUp,{className:"h-3 w-3"}),"Distributed: ",C(_.total_distributed)]})]})]})]}),(0,t.jsxs)(n.Tabs,{defaultValue:"details",className:"w-full",id:`subscription-tabs-${e.id}`,children:[(0,t.jsxs)(n.TabsList,{className:"bg-card border-border",children:[(0,t.jsx)(n.TabsTrigger,{value:"details",className:"data-[state=active]:bg-muted text-foreground",children:"Details"}),(0,t.jsx)(n.TabsTrigger,{value:"activity",className:"data-[state=active]:bg-muted text-foreground",children:"Capital Activity"}),(0,t.jsx)(n.TabsTrigger,{value:"documents",className:"data-[state=active]:bg-muted text-foreground",children:"Documents"})]}),(0,t.jsx)(n.TabsContent,{value:"details",className:"mt-6 space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Subscription Details"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(h.FileText,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Subscription Number"}),(0,t.jsxs)("div",{className:"text-sm font-semibold text-foreground",children:["#",String(e.subscription_number).padStart(5,"0")]})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(u.Calendar,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Effective Date"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:S(e.effective_date)})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(u.Calendar,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Funding Due Date"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:S(e.funding_due_at)})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(u.Calendar,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Committed At"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:S(e.committed_at)})]})]}),e.units&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(x.DollarSign,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Units"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.units.toLocaleString()})]})]})]}),e.acknowledgement_notes&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground mb-2",children:"Notes"}),(0,t.jsx)("div",{className:"text-sm text-foreground bg-muted p-3 rounded-md",children:e.acknowledgement_notes})]})]})]})]}),(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Investor Information"})}),(0,t.jsx)(a.CardContent,{className:"space-y-4",children:e.investor?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(m.User,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Legal Name"}),(0,t.jsx)(f.default,{href:`/versotech_main/investors/${e.investor.id}`,className:"text-sm font-semibold text-foreground hover:underline",children:e.investor.legal_name})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(c.Building2,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Type"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground capitalize",children:e.investor.type})]})]}),e.investor.country&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(c.Building2,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Country"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.investor.country})]})]}),e.investor.email&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(m.User,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Email"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.investor.email})]})]})]}):(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"No investor linked"})})]}),(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Vehicle Information"})}),(0,t.jsx)(a.CardContent,{className:"space-y-4",children:e.vehicle?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(c.Building2,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Vehicle Name"}),(0,t.jsx)("div",{className:"text-sm font-semibold text-foreground",children:e.vehicle.name})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"}),e.vehicle.entity_code&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(h.FileText,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Entity Code"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.vehicle.entity_code})]})]}),e.vehicle.type&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(c.Building2,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Type"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground capitalize",children:e.vehicle.type.replace("_"," ")})]})]}),e.vehicle.currency&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(x.DollarSign,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Currency"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.vehicle.currency})]})]}),e.vehicle.domicile&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(c.Building2,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Domicile"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.vehicle.domicile})]})]})]}):(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"No vehicle linked"})})]}),(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Capital Summary"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total Calls"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:_.total_calls})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Pending Calls"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-yellow-400",children:_.pending_calls})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Contribution Rate"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:_.total_commitment>0?`${(_.total_contributed/_.total_commitment*100).toFixed(1)}%`:"0%"})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Capital Calls Total"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:C(e.capital_calls_total||0)})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Distributions Total"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-green-400",children:C(e.distributions_total||0)})]}),null!=e.outstanding_amount&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Separator,{className:"bg-muted"}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Outstanding Amount"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-yellow-400",children:C(e.outstanding_amount)})]})]})]})]}),(null!=e.num_shares||null!=e.price_per_share||null!=e.cost_per_share)&&(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Share Structure"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[null!=e.num_shares&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Number of Shares"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.num_shares.toLocaleString()})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),null!=e.price_per_share&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Price Per Share"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:C(e.price_per_share)})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),null!=e.cost_per_share&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Cost Per Share"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:C(e.cost_per_share)})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),null!=e.spread_per_share&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Spread Per Share"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-green-400",children:C(e.spread_per_share)})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),null!=e.spread_fee_amount&&(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Spread Fee Amount"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:C(e.spread_fee_amount)})]})]})]}),(null!=e.subscription_fee_amount||null!=e.bd_fee_amount||null!=e.finra_fee_amount)&&(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Fee Structure"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[null!=e.subscription_fee_percent&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Subscription Fee"}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-foreground",children:C(e.subscription_fee_amount||0)}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground/70",children:[e.subscription_fee_percent,"%"]})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),null!=e.bd_fee_percent&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Broker-Dealer Fee"}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-foreground",children:C(e.bd_fee_amount||0)}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground/70",children:[e.bd_fee_percent,"%"]})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),null!=e.finra_fee_amount&&(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"FINRA Fee"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-foreground",children:C(e.finra_fee_amount)})]})]})]}),(null!=e.performance_fee_tier1_percent||null!=e.performance_fee_tier2_percent)&&(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Performance Fees"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[null!=e.performance_fee_tier1_percent&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Tier 1"}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-sm font-semibold text-purple-400",children:[e.performance_fee_tier1_percent,"%"]}),null!=e.performance_fee_tier1_threshold&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground/70",children:["Threshold: ",C(e.performance_fee_tier1_threshold)]})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),null!=e.performance_fee_tier2_percent&&(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Tier 2"}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-sm font-semibold text-purple-300",children:[e.performance_fee_tier2_percent,"%"]}),null!=e.performance_fee_tier2_threshold&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground/70",children:["Threshold: ",C(e.performance_fee_tier2_threshold)]})]})]})]})]}),(e.opportunity_name||e.contract_date||e.sourcing_contract_ref)&&(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Opportunity & Contract"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[e.opportunity_name&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(h.FileText,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Opportunity Name"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.opportunity_name})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),e.contract_date&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(u.Calendar,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Contract Date"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:S(e.contract_date)})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),e.sourcing_contract_ref&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(h.FileText,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Sourcing Contract Reference"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground font-mono",children:e.sourcing_contract_ref})]})]})]})]}),(e.introducer_id||e.introduction_id)&&(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Relationships"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[e.introducer_id&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(m.User,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Introducer ID"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground font-mono text-xs",children:e.introducer_id})]})]}),(0,t.jsx)(d.Separator,{className:"bg-muted"})]}),e.introduction_id&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(m.User,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Introduction ID"}),(0,t.jsx)("div",{className:"text-sm font-medium text-foreground font-mono text-xs",children:e.introduction_id})]})]})]})]})]})}),(0,t.jsx)(n.TabsContent,{value:"activity",className:"mt-6",children:(0,t.jsxs)(a.Card,{className:"bg-card border-border",children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{className:"text-foreground",children:"Capital Activity"}),(0,t.jsx)(a.CardDescription,{className:"text-muted-foreground",children:"View all cashflows, capital calls, and distributions for this subscription"})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsx)(U,{cashflows:b,capitalCalls:j,distributions:N,currency:e.currency,vehicleId:e.vehicle_id,investorId:e.investor_id,isStaff:!0})})]})}),(0,t.jsx)(n.TabsContent,{value:"documents",className:"mt-6",children:(0,t.jsx)(er,{subscriptionId:e.id})})]}),(0,t.jsx)(w,{subscription:e,open:v,onOpenChange:y,onSuccess:()=>{window.location.reload()}})]})}e.s(["SubscriptionDetailClient",()=>el],73215)}]);