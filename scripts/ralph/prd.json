{
  "project": "VERSO Admin Portal",
  "branchName": "ralph/admin-portal",
  "description": "Admin Portal (/versotech_admin) - Platform administration interface with user management, growth analytics dashboard, and real-time KPIs. Most backend APIs exist; primarily frontend implementation.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Create admin sidebar navigation component",
      "description": "As an admin, I want a dedicated sidebar navigation so I can access all admin features from any page.",
      "acceptanceCriteria": [
        "Create admin-sidebar.tsx in /src/app/(admin)/versotech_admin/components/",
        "Navigation items: Dashboard, Users (sub-items: All Users, Staff), Growth (sub-items: Overview, Engagement, Retention, Funnels, Cohorts), Agents (with 'Soon' badge), Settings",
        "Use Lucide icons: LayoutDashboard, Users, TrendingUp, Bot, Settings",
        "Active route highlighting with nested route support (e.g., /users/staff highlights Users)",
        "Collapsible sub-navigation for Users and Growth sections",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Completed: admin-sidebar.tsx created with all nav items, collapsible sections, active route highlighting, and responsive mobile support"
    },
    {
      "id": "US-002",
      "title": "Integrate admin sidebar into layout",
      "description": "As a developer, I need the admin layout to use the new sidebar so all admin pages have consistent navigation.",
      "acceptanceCriteria": [
        "Update /src/app/(admin)/versotech_admin/layout.tsx to include AdminSidebar",
        "Sidebar on left, main content area on right with proper padding",
        "Header shows current page title based on route",
        "Existing auth guard preserved (CEO/staff_admin only)",
        "Responsive: sidebar collapses to hamburger on mobile",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Completed: admin-layout-content.tsx created with AdminSidebar integration, dynamic page title header, theme toggle, notifications, identity menu. Auth guard preserved."
    },
    {
      "id": "US-003",
      "title": "Redirect admin root to dashboard",
      "description": "As an admin, when I visit /versotech_admin, I should be redirected to the dashboard.",
      "acceptanceCriteria": [
        "Update /src/app/(admin)/versotech_admin/page.tsx",
        "Use Next.js redirect() to /versotech_admin/dashboard",
        "Server-side redirect (no client flash)",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Completed: Updated redirect from /settings to /dashboard using Next.js server-side redirect"
    },
    {
      "id": "US-004",
      "title": "Create dashboard page structure",
      "description": "As an admin, I want a dashboard page that shows platform health at a glance.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/dashboard/page.tsx",
        "Page title 'Platform Overview'",
        "Date range selector component (Last 7 days, 30 days, 90 days) stored in URL params",
        "Loading skeleton while data fetches using Suspense",
        "Error boundary for API failures",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Completed: Dashboard page structure with date range selector (URL params), Suspense loading skeleton, error boundary, and placeholder grids for upcoming widgets"
    },
    {
      "id": "US-005",
      "title": "Add dashboard KPI cards",
      "description": "As an admin, I want to see key metrics (Total Users, Active Users, Total AUM, Investors) as cards with trend indicators.",
      "acceptanceCriteria": [
        "Fetch data from GET /api/admin/metrics/dashboard",
        "Display 4 KPI cards in responsive grid (1 col mobile, 2 col tablet, 4 col desktop)",
        "Each card shows: metric name, value, percentage change with up/down arrow icon",
        "Format numbers: 1,247 for counts, $45.2M for currency",
        "Use shadcn Card component",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Completed: DashboardKPICards component created, fetches from /api/admin/metrics/dashboard, responsive grid layout, reuses existing KPICard component"
    },
    {
      "id": "US-006",
      "title": "Add dashboard activity chart",
      "description": "As an admin, I want to see a line chart of user activity over the selected time period.",
      "acceptanceCriteria": [
        "Line chart showing daily active users using Recharts",
        "X-axis: dates, Y-axis: user count",
        "Chart responds to date range selector from US-004",
        "Tooltip on hover showing exact date and count",
        "Use existing chart.tsx wrapper if available",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Completed: DashboardActivityChart component created with Recharts LineChart, custom tooltip, responsive design. API extended with fetchUserActivityTrend to track daily active users from audit_logs."
    },
    {
      "id": "US-007",
      "title": "Add dashboard approval queue widget",
      "description": "As an admin, I want to see pending approvals so I know what needs attention.",
      "acceptanceCriteria": [
        "Card titled 'Approval Queue'",
        "List items: KYC Review, Subscriptions, Documents with Badge showing count",
        "Data from /api/admin/metrics/dashboard (pending items already included)",
        "Each item clickable (href can be placeholder '#' initially)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "Completed: DashboardApprovalQueue component created with KYC Review, Subscriptions, and Documents items. Each shows count badge, is clickable with proper hrefs. Used LucideIcon type for proper TypeScript support."
    },
    {
      "id": "US-008",
      "title": "Add dashboard recent activity feed",
      "description": "As an admin, I want to see recent platform activity so I can monitor operations.",
      "acceptanceCriteria": [
        "Fetch from GET /api/admin/activity-feed",
        "Display last 10 activities in scrollable list (max-height with overflow)",
        "Each item shows: relative timestamp (e.g., '2 hours ago'), actor name, action description",
        "Use formatDistanceToNow from date-fns for timestamps",
        "'View All' link at bottom (can be placeholder)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "Completed: DashboardActivityFeed component created with scrollable list, relative timestamps via date-fns formatDistanceToNow, action description transformation, View All link."
    },
    {
      "id": "US-009",
      "title": "Add dashboard compliance alerts widget",
      "description": "As an admin, I want to see compliance alerts categorized by severity.",
      "acceptanceCriteria": [
        "Fetch from GET /api/admin/compliance/alerts",
        "Group by severity with colored indicators: Critical (red/destructive), Warning (yellow/warning), Clear (green/success)",
        "Show count for each severity level",
        "Collapsible/expandable to show individual alert details",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "Completed: DashboardComplianceAlerts component created with severity grouping (Critical/Warning/Low Priority), collapsible sections using Radix Collapsible, colored indicators, and All Clear empty state."
    },
    {
      "id": "US-010",
      "title": "Create users list page with data table",
      "description": "As an admin, I want to see all platform users in a searchable, filterable table.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/users/page.tsx",
        "Fetch from GET /api/admin/users with pagination (page, limit params)",
        "Table columns: Checkbox, User (Avatar + name), Email, Role (Badge), Status (colored Badge), Last Active (relative), Created (date), Actions (DropdownMenu)",
        "Pagination controls at bottom showing 'X-Y of Z'",
        "Default sort by created_at descending",
        "Empty state when no users match",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "Completed: Users list page with @tanstack/react-table, avatar+name, email, role badge, status badge (active/pending/inactive/deactivated), relative last active time, created date, actions dropdown, server-side pagination with 'X-Y of Z' display, empty state"
    },
    {
      "id": "US-011",
      "title": "Add users search and filters",
      "description": "As an admin, I want to search and filter users so I can find specific people quickly.",
      "acceptanceCriteria": [
        "Search input searching name and email (debounced 300ms)",
        "Multi-select filter for Role: investor, staff_admin, staff_ops, staff_rm, ceo",
        "Multi-select filter for Status: active, pending, deactivated, locked",
        "Multi-select filter for Entity Type: investor, arranger, introducer, partner, lawyer",
        "Filters update URL search params (shareable links)",
        "Clear all filters button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "Completed: Search input with 300ms debounce, multi-select filters for Role/Status/Entity Type using Popover+Command pattern, URL param sync for shareable links, clear all filters button, API extended for multi-value filters and status filter"
    },
    {
      "id": "US-012",
      "title": "Add users batch actions",
      "description": "As an admin, I want to perform actions on multiple users at once.",
      "acceptanceCriteria": [
        "Checkbox in table header selects/deselects all visible rows",
        "When users selected, show batch action bar fixed at bottom with: 'X selected' count, Deactivate button, Export CSV button",
        "Deactivate shows AlertDialog confirmation listing selected user names",
        "Export downloads CSV of selected users (id, name, email, role, status)",
        "Bar hidden when no selection",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": true,
      "notes": "Completed: Fixed bottom batch action bar with selection count, Export CSV (downloads id/name/email/role/status), and Deactivate button with AlertDialog confirmation showing selected user names. Uses useMemo for selectedUsers, proper hook ordering to avoid block-scoped variable issues."
    },
    {
      "id": "US-013",
      "title": "Create user detail page header",
      "description": "As an admin, I want to see a user's key info at the top of their detail page.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/users/[id]/page.tsx",
        "Fetch from GET /api/admin/users/[id]",
        "Header card: large Avatar, display_name, email, Status badge, Role badge, 'Last seen: X ago'",
        "Edit button (functionality in US-014)",
        "Actions DropdownMenu: Deactivate/Reactivate, Lock/Unlock, Reset Password",
        "Back link '← Back to Users' to /versotech_admin/users",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "Completed: User detail page with header card showing large Avatar, display_name, email, Status/Role badges, Last seen timestamp. Actions dropdown with Deactivate/Reactivate, Lock/Unlock, Reset Password with AlertDialog confirmations and toast notifications. Back link to users list. Super Admin badge display. Placeholder for future tabs."
    },
    {
      "id": "US-014",
      "title": "Add user detail profile tab with edit",
      "description": "As an admin, I want to view and edit a user's profile information.",
      "acceptanceCriteria": [
        "Tab navigation with 4 tabs: Profile (default active), Entities, Activity, Security",
        "Profile tab: 'Personal Information' card (display_name, email, phone, title) and 'Account Settings' card (role, MFA status, created date, last login)",
        "Edit button opens Dialog with form for: display_name, title, phone, office_location",
        "Form uses react-hook-form + zod validation",
        "Save calls PATCH /api/admin/users/[id], shows success/error toast",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 14,
      "passes": true,
      "notes": "Completed: Tab navigation with Profile/Entities/Activity/Security tabs. Profile tab has Personal Information card (display_name, email, phone, title, office_location) and Account Settings card (role, MFA status, created date, last login). Edit dialog with react-hook-form + zod validation for display_name, title, phone, office_location. PATCH to /api/admin/users/[id] with toast notifications."
    },
    {
      "id": "US-015",
      "title": "Add user detail entities tab",
      "description": "As an admin, I want to see which entities a user is linked to.",
      "acceptanceCriteria": [
        "Entities tab shows table of linked entities from GET /api/admin/users/[id] response",
        "Columns: Entity icon (by type), Entity name, Type (investor/partner/etc), Role (Primary/Member), Remove button",
        "Add button '+' opens search modal to link new entity (can be placeholder functionality)",
        "Remove shows AlertDialog confirmation",
        "Empty state 'No linked entities' with Add button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 15,
      "passes": true,
      "notes": "Completed: Entities tab with table showing entity icon by type (6 types mapped), name, type badge, Primary/Member role badge, Can Sign badge. Remove button with AlertDialog confirmation. Add Entity dialog placeholder with search input and coming soon message. Empty state with centered icon, message, and Add button."
    },
    {
      "id": "US-016",
      "title": "Add user detail activity tab",
      "description": "As an admin, I want to see a user's activity history.",
      "acceptanceCriteria": [
        "Fetch from GET /api/admin/users/[id]/activity",
        "Timeline view: timestamp (relative), action description, entity affected",
        "Filter Select for action types",
        "Export button downloads activity as CSV",
        "'Load more' button for pagination",
        "Empty state 'No activity recorded'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 16,
      "passes": true,
      "notes": "Completed: Activity tab with timeline view showing relative timestamps, action descriptions, and entity affected. API extended to support pagination (offset/limit) and action type filtering. Select filter populated from user's actual action types. CSV export downloads all loaded activities. Load more button with hasMore indicator. Empty state with clear filter option when filtering."
    },
    {
      "id": "US-017",
      "title": "Add user detail security tab",
      "description": "As an admin, I want to manage a user's security settings.",
      "acceptanceCriteria": [
        "Security tab sections: Account Status (Active/Inactive with Switch), Account Lock (Locked/Unlocked with Switch), Password (last changed + Reset Password button), Sessions (count + Revoke All button), Failed Logins (count in 24hrs)",
        "Status Switch calls PATCH /api/admin/users/[id]/deactivate or /reactivate",
        "Lock Switch calls PATCH /api/admin/users/[id]/toggle-lock",
        "Reset Password button shows AlertDialog, calls POST /api/admin/users/[id]/reset-password",
        "All actions show success/error toast",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 17,
      "passes": true,
      "notes": "Completed: Security tab with Account Status (Active/Inactive Switch), Account Lock (Locked/Unlocked Switch), Password section with Reset Password button, Sessions section with count and Revoke All button, Failed Logins section with 24hr count and severity indicators. Uses existing API endpoints and lazy-loads security data."
    },
    {
      "id": "US-018",
      "title": "Create staff users sub-page",
      "description": "As an admin, I want a dedicated view for staff members with staff-specific data.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/users/staff/page.tsx",
        "Fetch from GET /api/admin/staff",
        "Table columns: User, Email, Role, Permissions (comma-separated list), Assigned Investors (count), Activity Score (7d), Status, Actions",
        "Reuse table pattern from US-010",
        "Actions include: View Details, Manage Permissions (placeholder)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 18,
      "passes": true,
      "notes": "Completed: Staff users page at /versotech_admin/users/staff with data table showing User, Email, Role, Permissions (comma-separated), Assigned Investors count, Activity Score (7d), Status, and Actions dropdown. API extended with assigned_investors and activity_score_7d fields. Stats cards at top. Reuses @tanstack/react-table pattern from US-010."
    },
    {
      "id": "US-019",
      "title": "Create growth overview API endpoint",
      "description": "As a developer, I need an API endpoint for growth overview metrics.",
      "acceptanceCriteria": [
        "Create /src/app/api/admin/growth/overview/route.ts",
        "GET returns: dau, wau, mau, stickiness (dau/mau*100), avgSessionDuration, activeUsersTrend (array of {date, count}), featureUsage (array of {feature, count}), userSegments (array of {segment, count})",
        "Accepts 'days' query param (7, 30, 90) defaulting to 30",
        "Query audit_logs for activity metrics using SQL from PRD appendix",
        "Requires super_admin permission check",
        "Typecheck passes"
      ],
      "priority": 19,
      "passes": true,
      "notes": "Completed: Growth overview API at /api/admin/growth/overview. Returns DAU, WAU, MAU, stickiness ratio, avgSessionDuration (estimated from audit log timestamps), activeUsersTrend (daily unique users), featureUsage (top 10 actions), and userSegments (Power/Regular/Occasional/At Risk based on activity frequency). Uses super_admin permission check and queries audit_logs."
    },
    {
      "id": "US-020",
      "title": "Create growth overview page",
      "description": "As an admin, I want an overview of growth metrics so I can understand platform health.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/growth/page.tsx",
        "Fetch from GET /api/admin/growth/overview",
        "KPI cards row: DAU, WAU, MAU, Stickiness (DAU/MAU %), Avg Session Duration",
        "Active Users Trend line chart (30 days default)",
        "Feature Usage horizontal bar chart",
        "User Segments pie/donut chart (Power Users, Regular, Occasional, At Risk)",
        "Date range selector affects all metrics",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 20,
      "passes": true,
      "notes": "Completed: Growth overview page with date range selector (URL params), 5 KPI cards (DAU, WAU, MAU, Stickiness, Avg Session), Active Users Trend LineChart, Feature Usage horizontal BarChart, User Segments donut chart with interactive hover. Includes loading.tsx and error.tsx per Next.js conventions."
    },
    {
      "id": "US-021",
      "title": "Create engagement API endpoint",
      "description": "As a developer, I need an API endpoint for engagement metrics.",
      "acceptanceCriteria": [
        "Create /src/app/api/admin/growth/engagement/route.ts",
        "GET returns: actionsByType (top 10 actions with counts), engagementByDay (day 0-6, count), peakHours (hour 0-23, count), topEngagedUsers (array of {id, name, actions, sessions})",
        "Accepts 'days' query param",
        "Queries audit_logs grouped by action, day of week, hour",
        "Requires super_admin permission",
        "Typecheck passes"
      ],
      "priority": 21,
      "passes": true,
      "notes": "Completed: Engagement API at /api/admin/growth/engagement. Returns actionsByType (top 10 with formatActionName helper), engagementByDay (0-6 with day names), peakHours (0-23), and topEngagedUsers (id, name from profiles, actions count, sessions count based on unique dates). Uses super_admin permission check and queries audit_logs."
    },
    {
      "id": "US-022",
      "title": "Create engagement page",
      "description": "As an admin, I want to see detailed engagement metrics.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/growth/engagement/page.tsx",
        "Fetch from GET /api/admin/growth/engagement",
        "Actions by Type horizontal bar chart (top 10)",
        "Engagement by Day bar chart (Mon-Sun)",
        "Peak Activity Hours bar chart (0-23 hours)",
        "Top Engaged Users table: rank, user name, actions count, sessions count",
        "Date range selector",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 22,
      "passes": true,
      "notes": "Completed: Engagement page at /versotech_admin/growth/engagement with Actions by Type horizontal bar chart, Engagement by Day bar chart (Mon-Sun, weekday vs weekend coloring), Peak Hours bar chart (0-23 with business hours highlighting), Top Engaged Users table with rank icons and link to user details. Includes loading.tsx and error.tsx per Next.js conventions."
    },
    {
      "id": "US-023",
      "title": "Create retention API endpoint",
      "description": "As a developer, I need an API endpoint for retention metrics.",
      "acceptanceCriteria": [
        "Create /src/app/api/admin/growth/retention/route.ts",
        "GET returns: retentionRates ({day7, day30, day90}), churnRate (%), cohortMatrix (2D array: cohort_week, week_0 through week_4 percentages), atRiskUsers (array of {id, name, email, lastActive, totalInvested})",
        "At-risk: users with no audit_log entry in 30+ days",
        "Requires super_admin permission",
        "Typecheck passes"
      ],
      "priority": 23,
      "passes": true,
      "notes": "Completed: Retention API at /api/admin/growth/retention. Returns retentionRates (day7, day30, day90), churnRate (%), cohortMatrix (5 weeks × 5 weeks with retention %), and atRiskUsers (id, name, email, lastActive, totalInvested sorted by investment). Uses audit_logs for activity, investor_users + subscriptions for invested amounts. Super_admin permission check."
    },
    {
      "id": "US-024",
      "title": "Create retention page",
      "description": "As an admin, I want to analyze user retention and identify at-risk users.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/growth/retention/page.tsx",
        "Fetch from GET /api/admin/growth/retention",
        "Retention KPI cards: 7-Day, 30-Day, 90-Day Retention %, Churn Rate %",
        "Retention Cohort Matrix: rows=weekly cohorts, cols=week 0-4, cells show retention % with color gradient (green=high, red=low)",
        "At-Risk Users table: User, Last Active (relative), Total Invested, Contact button (mailto link)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 24,
      "passes": true,
      "notes": "Completed: Retention page at /versotech_admin/growth/retention with 4 KPI cards (7-Day, 30-Day, 90-Day Retention, Churn Rate) with semantic coloring. Cohort Matrix shows 5x5 weekly retention data with color gradient (emerald for high, amber/orange/red for low). At-Risk Users table with avatar, name, email, relative last active time, total invested, and mailto Contact button."
    },
    {
      "id": "US-025",
      "title": "Create funnel API endpoint",
      "description": "As a developer, I need an API endpoint for funnel data.",
      "acceptanceCriteria": [
        "Create /src/app/api/admin/growth/funnel/route.ts",
        "GET returns: investmentFunnel (array of {stage, count, pctOfTotal, pctOfPrevious}), onboardingFunnel (same structure), biggestDropoff ({fromStage, toStage, dropRate})",
        "Investment stages: Viewed Deal, Showed Interest, Started Subscription, Completed Subscription, Allocated",
        "Onboarding stages: Account Created, Profile Completed, KYC Submitted, KYC Approved, First Investment",
        "Queries deals, deal_commitments, subscriptions, allocations, investors, profiles",
        "Requires super_admin permission",
        "Typecheck passes"
      ],
      "priority": 25,
      "passes": true,
      "notes": "Completed: Funnel API at /api/admin/growth/funnel. Returns investmentFunnel (Viewed Deal, Showed Interest, Started Subscription, Completed Subscription, Allocated) and onboardingFunnel (Account Created, Profile Completed, KYC Submitted, KYC Approved, First Investment). Each stage has count, pctOfTotal, pctOfPrevious. biggestDropoff identifies largest conversion drop. Uses deal_memberships, investor_deal_interest, subscriptions, allocations, profiles, investors tables. Super_admin permission check."
    },
    {
      "id": "US-026",
      "title": "Create funnel page",
      "description": "As an admin, I want to visualize conversion funnels.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/growth/funnel/page.tsx",
        "Fetch from GET /api/admin/growth/funnel",
        "Investment Funnel: horizontal bars with decreasing widths, each showing stage name, count, % of previous",
        "Onboarding Funnel: same visualization pattern",
        "Drop-off Analysis card: shows biggest drop-off point with stage names and percentage",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 26,
      "passes": true,
      "notes": "Completed: Funnel page at /versotech_admin/growth/funnel with Investment and Onboarding funnel visualizations. Horizontal bars with proportional widths, conversion rate badges (color-coded), stage names and counts. Drop-off Analysis card with severity indicators and actionable insights. Includes loading.tsx and error.tsx per Next.js conventions."
    },
    {
      "id": "US-027",
      "title": "Create cohorts API endpoint",
      "description": "As a developer, I need an API endpoint for cohort analysis.",
      "acceptanceCriteria": [
        "Create /src/app/api/admin/growth/cohorts/route.ts",
        "GET accepts 'groupBy' param: signup_week, signup_month, first_investment_month",
        "Returns array of cohorts: {cohortName, size, activationRate, investmentRate, avgInvestment, avgTimeToFirstInvestment (days), retention30d, retention60d, retention90d}",
        "Activation = completed onboarding, Investment = has subscription",
        "Requires super_admin permission",
        "Typecheck passes"
      ],
      "priority": 27,
      "passes": true,
      "notes": "Completed: Cohorts API at /api/admin/growth/cohorts. Accepts groupBy param (signup_week, signup_month, first_investment_month). Returns cohort metrics: cohortName, size, activationRate (% with display_name), investmentRate (% with subscriptions), avgInvestment, avgTimeToFirstInvestment (days from signup to first subscription), retention30d/60d/90d. Uses reduce pattern for TypeScript type narrowing with forEach callbacks. Super_admin permission check."
    },
    {
      "id": "US-028",
      "title": "Create cohorts page",
      "description": "As an admin, I want to analyze user behavior by signup cohort.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/growth/cohorts/page.tsx",
        "Fetch from GET /api/admin/growth/cohorts",
        "Cohort grouping selector: By Signup Week, By Signup Month, By First Investment Month",
        "Data table: Cohort, Size, Activation Rate, Investment Rate, Avg Investment, Avg Days to First Investment, 30/60/90 Day Retention",
        "Sortable columns",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 28,
      "passes": true,
      "notes": "Completed: Cohorts page at /versotech_admin/growth/cohorts with grouping selector (signup_week, signup_month, first_investment_month via URL params). Summary stats cards showing total users, avg activation rate, avg investment rate. Data table with @tanstack/react-table featuring sortable columns (cohort, size, activation rate, investment rate, avg investment, days to invest, 30/60/90d retention). Color-coded metrics with semantic colors. Handles N/A retention values (-1 from API) gracefully. Includes loading.tsx and error.tsx per Next.js conventions."
    },
    {
      "id": "US-029",
      "title": "Create agents placeholder page",
      "description": "As an admin, I want to see a placeholder for upcoming AI/automation features.",
      "acceptanceCriteria": [
        "Create /src/app/(admin)/versotech_admin/agents/page.tsx",
        "Centered layout with Bot icon (Lucide) and 'AI-Powered Automation' heading",
        "'Coming Soon' subheading text",
        "4 placeholder cards in grid: KYC Review Bot, Deal Matching, Risk Alerts, Report Generator",
        "Each card: icon, title, brief description, 'Planned' Badge",
        "'Contact Product Team' link at bottom",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 29,
      "passes": true,
      "notes": "Completed: Agents placeholder page at /versotech_admin/agents with Bot icon hero section, 'AI-Powered Automation' heading, 'Coming Soon' subheading, 4 placeholder cards (KYC Review Bot, Deal Matching, Risk Alerts, Report Generator) each with icon, title, description, and 'Planned' badge. Contact Product Team mailto link at bottom. Extensible status system for future 'in-development' and 'beta' states."
    },
    {
      "id": "US-030",
      "title": "Expand settings page with tabs",
      "description": "As an admin, I want the settings page to have organized sections instead of just placeholders.",
      "acceptanceCriteria": [
        "Update /src/app/(admin)/versotech_admin/settings/page.tsx",
        "Tab navigation: General, Security, Notifications, Integrations, Audit",
        "General tab: Platform name, timezone, default currency (read-only display)",
        "Security tab: MFA policy status, session timeout display (read-only)",
        "Notifications tab: Email template list placeholder",
        "Integrations tab: API keys list (masked), webhook URLs",
        "Audit tab: Log retention policy display, Export logs button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 30,
      "passes": false,
      "notes": ""
    }
  ]
}
